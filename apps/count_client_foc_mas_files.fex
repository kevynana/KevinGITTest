-*======================================================================
-*  DATE        PROGRAMMER  CHANGE
-*  ----        ----------  ---------------------------------
-*  08/23/2015  GSE         S-22465 Initial version
-*  05/19/2017  GSE         S-30062 Changed correct file number counts 
-*                          to account for FSxxxxxx.mas/.foc
-*======================================================================
-TYPE count_client_foc_mas_files.fex
-SET &LOOPSTART = 0;
-SET &LOOPEND = 11;
-SET &NOW = HHMMSS('A8');
-RUN
-TYPE BEGINNING &NOW
-RUN
-*
SET HOLDLIST = PRINTONLY
SET ASNAMES = ON
SET PCOMMA = ON
SET FIXFRMINPUT = NONCOND
SET MESSAGE = OFF
SET EXCELSERVURL = ' '
-*
APP QUERY TTDATA HOLD
-RUN
-*
DEFINE FILE FOCAPPQ
UP_FILENAME/A70 = UPCASE(70, FILENAME, 'A70');
REAL_FILENAME/A8 = GETTOK(UP_FILENAME, 70, 1, '.', 8, 'A8');
EXTENSION/A70 = GETTOK(UP_FILENAME, 70, 2, '.', 70, 'A70');
FILECOMP/A6 = EDIT(REAL_FILENAME,'$$999999');
END
TABLE FILE FOCAPPQ
COUNT REAL_FILENAME/I11 AS FILECOUNT
BY FILECOMP
WHERE FILECOMP NE ' '
WHERE EXTENSION EQ 'FOC' OR 'MAS'
ON TABLE HOLD AS FILECNTS FORMAT FOCUS INDEX FILECOMP
END
-RUN
-*
TABLE FILE ROLLUP
PRINT
      UPD_ENABLE
      QTR_ENABLE
BY COMP
BY ROLLUP_CODE
ON TABLE HOLD AS ROLLLIST FORMAT FOCUS INDEX COMP ROLLUP_CODE
END
-RUN
-*
JOIN FILECOMP IN FILECNTS TO UNIQUE COMP IN ROLLLIST TAG J0 AS J0
-*
TABLE FILE FILECNTS
PRINT
      FILECOUNT
      UPD_ENABLE
      QTR_ENABLE
BY ROLLUP_CODE
BY COMP
WHERE ROLLUP_CODE GT ' '
WHERE (QTR_ENABLE NE ' ' AND FILECOUNT NE 212) OR (QTR_ENABLE EQ ' ' AND FILECOUNT NE 36)
WHERE ROLLUP_CODE NE 'TOTAL-R' OR 'ABCD2-R' OR 'ABCD3-R'
HEADING
"FOC/MAS incorrect file counts by Rollup/COMP"
" "
"Quartered Rollups should have 212 files."
"Non-quartered Rollups should have 36 files."
ON TABLE PCHOLD FORMAT EXL07
ON TABLE SET STYLE *
     UNITS=IN,
     PAGESIZE='Letter',
     LEFTMARGIN=0.250000,
     RIGHTMARGIN=0.250000,
     TOPMARGIN=0.250000,
     BOTTOMMARGIN=0.250000,
     SQUEEZE=ON,
     ORIENTATION=PORTRAIT,
$
TYPE=REPORT,
     FONT='ARIAL',
     SIZE=10,
     COLOR='BLACK',
     BACKCOLOR='NONE',
     STYLE=NORMAL,
$
TYPE=DATA,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=9,
     BACKCOLOR=( RGB(242 242 242) 'WHITE' ),
	 JUSTIFY=LEFT,
$
TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=9,
     COLOR='WHITE',
     BACKCOLOR=RGB(154 175 212),
     STYLE=BOLD,
     JUSTIFY=CENTER,
$
TYPE=HEADING,
     SIZE=11,
     COLOR=RGB(36 43 114),
     STYLE=BOLD,
     JUSTIFY=CENTER,
$
TYPE=REPORT,
     COLUMN=N1,
     WRAP=0.750000,
$
TYPE=REPORT,
     COLUMN=N2,
     WRAP=0.750000,
$
TYPE=REPORT,
     COLUMN=N3,
     WRAP=0.750000,
$
TYPE=FOOTING,
     HEADALIGN=BODY,
$
TYPE=FOOTING,
     LINE=1,
	 STYLE=BOLD,
	 COLSPAN=3,
	 JUSTIFY=LEFT,
$
TYPE=FOOTING,
     LINE=2,
	 STYLE=BOLD,
	 COLSPAN=3,
	 JUSTIFY=LEFT,
$
TYPE=FOOTING,
     LINE=3,
	 STYLE=BOLD,
	 COLSPAN=3,
	 JUSTIFY=LEFT,
$
TYPE=FOOTING,
     LINE=4,
	 STYLE=BOLD,
	 COLSPAN=3,
	 JUSTIFY=LEFT,
$
TYPE=FOOTING,
     LINE=5,
	 STYLE=BOLD,
	 COLSPAN=3,
	 JUSTIFY=LEFT,
$
TYPE=FOOTING,
     LINE=7,
	 ITEM=1,
	 COLSPAN=2,
	 JUSTIFY=LEFT,
$
TYPE=FOOTING,
     LINE=7,
	 ITEM=2,
	 JUSTIFY=RIGHT,
$
TYPE=SUBHEAD,
     SIZE=9,
     STYLE=BOLD,
$
ENDSTYLE
END
-*
-EXIT
