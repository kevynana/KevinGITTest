-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* current and YTD pages were exactly the same changed defines on YTD to use correct fields so
-* ytd numbers would appear  - Deb 10/8/12
EX SELDESC2
-RUN
-*-INCLUDE SETECHO
-* File TCEXSUM1.FEX
-*************************************************************************
-*DATE         NAME             DESCRIPTION
-* 7/2/04      DEB              THIS PROGRAM PRODUCES FINAL REPORT FOR
-*                              TOTAL COMPANY REPORTING TRAVEL SUMMARY
-*
-*************************************************************************
-*-SET &&OUTPUT1 = 'TRVLSMRY.FRF';
-*-SET &&OUTPUT2 = 'YRTVLSUM.FRF';

-INCLUDE DTRANGE
-RUN
-INCLUDE SetParmtime
-RUN
-IF &&SETF EQ 'TCTSONL' OR 'TCTSTRAD' THEN GOTO TITLE2;

-*-SET &&OUTLN1A = &&OUTPUTDEST.EVAL || &&OUTPUT1;
-*-SET &&OUTLN2A = &&OUTPUTDEST.EVAL || &&OUTPUT2;
-* -SET &&BITMP1 = &&BITMAPP || &&BITMAP;
-* -SET &&BITMP2 = &&BITMAPP || &&TANDT;
-SET &&HEADING = 'TRAVEL SUMMARY';
-SET &&SP = '|';
-SET &&SP3 = IF &&ROLLCNCT EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP4 = IF &&ROLLPHN EQ ' ' THEN ' ' ELSE &&SP;
-SET &&RCNCT = &&ROLLCNCT.LENGTH;
-SET &&CSL = &&ROLLCS.LENGTH;
-SET &&CSLP = IF &&RCNCT.EVAL GE 15 OR &&CSL.EVAL GE 10 THEN 61 ELSE 68;
-SET &&ROLLCS11 = TRUNCATE(&&ROLLCS);
-SET &&RCNCT1 = TRUNCATE(&&ROLLCNCT);
-RUN


-GOTO NEXT;

-TITLE2;
-IF &&SETF EQ 'TCTSTRAD' THEN GOTO TITLE3;

-SET &&HEADING = 'ONLINE TRAVEL SUMMARY'

-GOTO NEXT;


-TITLE3;
-SET &&HEADING = 'TRADITIONAL TRAVEL SUMMARY';



-NEXT;

-SET &&RPTSUF = 'TRVLSMRY';
-INCLUDE FDEFRPTS
-RUN

DEFINE FILE TC1_MAIN

-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*10/03/00    IBISTL-SB         ADDED KEY FIELD TO ES1_MAIN
-*************************************************************************
 KEY/A1 = IF TC1_MAIN.CAT_ORDER EQ 1 OR 2 THEN 'A'
 ELSE IF TC1_MAIN.CAT_ORDER EQ 3 THEN 'B'
 ELSE IF TC1_MAIN.CAT_ORDER EQ 4 THEN 'C' ELSE 'D';
 
 KEY1/A1 = IF TC1_MAIN.ROW_LABEL CONTAINS '%' THEN 'C' ELSE 
           IF TC1_MAIN.ROW_LABEL CONTAINS 'Volume' OR 'Amount' OR 'Cost' OR 'ATP' OR 'Price' OR 'Amt' OR 'RATE' OR 'Rate' OR 'Taxes' OR 'Fee' OR 'Savings' OR 'Expense' THEN 'A'
           ELSE 'B';  


-* DOM_CURR Conversion                       
DOMCURRA/D10M = DOM_CURR;
DOM_CURRA/A16 = FTOA(DOMCURRA, '(D10M)', 'A16');
DOM_CURRA1/A12 = TRIM('L', DOM_CURRA, 16, ' ', 4, 'A12'); 
DOMCURRB/D10C = DOM_CURR;
DOM_CURRB/A16 = FTOA(DOMCURRB, '(D10C)', 'A16');
DOM_CURRB1/A12 = TRIM('L', DOM_CURRB, 16, ' ', 4, 'A12');
DOMCURRC/D10% = DOM_CURR;
DOM_CURRC/A16 = FTOA(DOMCURRC, '(D10%)', 'A16');
DOM_CURRC1/A12 = TRIM('L', DOM_CURRC, 16, ' ', 4, 'A12');


DOM_CURRXX/A12 = IF KEY1 EQ 'A' THEN DOM_CURRA1 ELSE
                 IF KEY1 EQ 'C' THEN DOM_CURRC1 ELSE DOM_CURRB1;   
                 
-* DOM_PRIOR Conversion                 

DOMPRIORA/D10M = DOM_PRIOR;
DOM_PRIORA/A16 = FTOA(DOMPRIORA, '(D10M)', 'A16');
DOM_PRIORA1/A12 = TRIM('L', DOM_PRIORA, 16, ' ', 4, 'A12'); 
DOMPRIORB/D10C = DOM_PRIOR;
DOM_PRIORB/A16 = FTOA(DOMPRIORB, '(D10C)', 'A16');
DOM_PRIORB1/A12 = TRIM('L', DOM_PRIORB, 16, ' ', 4, 'A12');
DOMPRIORC/D10% = DOM_PRIOR;
DOM_PRIORC/A16 = FTOA(DOMPRIORC, '(D10%)', 'A16');
DOM_PRIORC1/A12 = TRIM('L', DOM_PRIORC, 16, ' ', 4, 'A12');


DOM_PRIORXX/A12 = IF KEY1 EQ 'A' THEN DOM_PRIORA1 ELSE
                  IF KEY1 EQ 'C' THEN DOM_PRIORC1 ELSE DOM_PRIORB1;     
                  
                     

-* INT_CURR Conversion                       
INTCURRA/D10M = INT_CURR;
INT_CURRA/A16 = FTOA(INTCURRA, '(D10M)', 'A16');
INT_CURRA1/A12 = TRIM('L', INT_CURRA, 16, ' ', 4, 'A12'); 
INTCURRB/D10C = INT_CURR;
INT_CURRB/A16 = FTOA(INTCURRB, '(D10C)', 'A16');
INT_CURRB1/A12 = TRIM('L', INT_CURRB, 16, ' ', 4, 'A12');
INTCURRC/D10% = INT_CURR;
INT_CURRC/A16 = FTOA(INTCURRC, '(D10%)', 'A16');
INT_CURRC1/A12 = TRIM('L', INT_CURRC, 16, ' ', 4, 'A12');


INT_CURRXX/A12 = IF KEY1 EQ 'A' THEN INT_CURRA1 ELSE
                 IF KEY1 EQ 'C' THEN INT_CURRC1 ELSE INT_CURRB1;   
                 
-* INT_PRIOR Conversion                 

INTPRIORA/D10M = INT_PRIOR;
INT_PRIORA/A16 = FTOA(INTPRIORA, '(D10M)', 'A16');
INT_PRIORA1/A12 = TRIM('L', INT_PRIORA, 16, ' ', 4, 'A12'); 
INTPRIORB/D10C = INT_PRIOR;
INT_PRIORB/A16 = FTOA(INTPRIORB, '(D10C)', 'A16');
INT_PRIORB1/A12 = TRIM('L', INT_PRIORB, 16, ' ', 4, 'A12');
INTPRIORC/D10% = INT_PRIOR;
INT_PRIORC/A16 = FTOA(INTPRIORC, '(D10%)', 'A16');
INT_PRIORC1/A12 = TRIM('L', INT_PRIORC, 16, ' ', 4, 'A12');


INT_PRIORXX/A12 = IF KEY1 EQ 'A' THEN INT_PRIORA1 ELSE
                  IF KEY1 EQ 'C' THEN INT_PRIORC1 ELSE INT_PRIORB1;     
                  
                 
                 
-* DI_CURR Conversion                       
DICURRA/D10M = DI_CURR;
DI_CURRA/A16 = FTOA(DICURRA, '(D10M)', 'A16');
DI_CURRA1/A12 = TRIM('L', DI_CURRA, 16, ' ', 4, 'A12'); 
DICURRB/D10C = DI_CURR;
DI_CURRB/A16 = FTOA(DICURRB, '(D10C)', 'A16');
DI_CURRB1/A12 = TRIM('L', DI_CURRB, 16, ' ', 4, 'A12');
DICURRC/D10% = DI_CURR;
DI_CURRC/A16 = FTOA(DICURRC, '(D10%)', 'A16');
DI_CURRC1/A12 = TRIM('L', DI_CURRC, 16, ' ', 4, 'A12');


DI_CURRXX/A12 = IF KEY1 EQ 'A' THEN DI_CURRA1 ELSE
                IF KEY1 EQ 'C' THEN DI_CURRC1 ELSE DI_CURRB1;   
                 
-* DI_PRIOR Conversion                 

DIPRIORA/D10M = DI_PRIOR;
DI_PRIORA/A16 = FTOA(DIPRIORA, '(D10M)', 'A16');
DI_PRIORA1/A12 = TRIM('L', DI_PRIORA, 16, ' ', 4, 'A12'); 
DIPRIORB/D10C = DI_PRIOR;
DI_PRIORB/A16 = FTOA(DIPRIORB, '(D10C)', 'A16');
DI_PRIORB1/A12 = TRIM('L', DI_PRIORB, 16, ' ', 4, 'A12');
DIPRIORC/D10% = DI_PRIOR;
DI_PRIORC/A16 = FTOA(DIPRIORC, '(D10%)', 'A16');
DI_PRIORC1/A12 = TRIM('L', DI_PRIORC, 16, ' ', 4, 'A12');


DI_PRIORXX/A12 = IF KEY1 EQ 'A' THEN DI_PRIORA1 ELSE
                 IF KEY1 EQ 'C' THEN DI_PRIORC1 ELSE DI_PRIORB1;     
                  


   BLANK/A1='';
-*  T_DOM_VAR_VAL/D10C = ES1_MAIN.DOM_CURR - ES1_MAIN.DOM_PRIOR;
-*  T_DOM_VAR_PCT/P4   = IF ((ES1_MAIN.DOM_PRIOR LT 1) AND
-*			(ES1_MAIN.DOM_PRIOR GT (-1))) THEN 0 ELSE 
-*                      ((T_DOM_VAR_VAL / ES1_MAIN.DOM_PRIOR) * 100) ;
-* T_INT_VAR_VAL/D10C = ES1_MAIN.INT_CURR - ES1_MAIN.INT_PRIOR;
-* T_INT_VAR_PCT/P4   = IF ((ES1_MAIN.INT_PRIOR LT 1) AND 
-*	(ES1_MAIN.INT_PRIOR GT (-1))) THEN 0 ELSE
-*                      ((T_INT_VAR_VAL / ES1_MAIN.INT_PRIOR) * 100) ;
-* 
-*    T_DI_VAR_VAL/D10C  = ES1_MAIN.DI_CURR - ES1_MAIN.DI_PRIOR;
-*    T_DI_VAR_PCT/P4    = IF ((ES1_MAIN.DI_PRIOR LT 1) AND 
-*			(ES1_MAIN.DI_PRIOR GT (-1))) THEN 0 ELSE
-*                        ((T_DI_VAR_VAL / ES1_MAIN.DI_PRIOR) * 100) ;

CR/A8 = 'Current:';
PR/A8 = 'Prior:  ';
RN/A60=TRIM('B', '&&RPT_TTL1.EVAL', 60, ' ', 1, 'A60');


-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*7/31/00    IBISTL-KR          ADDED DEFINE FOR NOWTOD
-*************************************************************************
   NOWTOD/A8 WITH CAT_ORDER = HHMMSS (NOWTOD);
END

TABLE FILE TC1_MAIN
SUM   DOM_CURRXX    AS 'Current' 
      DOM_PRIORXX   AS 'Prior'
      BLANK AS ' '
      
      INT_CURRXX    AS 'Current' 
      INT_PRIORXX   AS 'Prior'
      BLANK AS ' '
      
      DI_CURRXX     AS 'Current' 
      DI_PRIORXX    AS 'Prior'
      
      
BY CAT_ORDER NOPRINT
BY ROW_ORDER NOPRINT
BY ROW_LABEL  AS '' 

ON CAT_ORDER SUBHEAD

-* " "
"<CATEGORY"

ON TABLE NOTOTAL
&&OUTLINE1
-*&&OUTLN1A
&&OUTLINE2
ON TABLE SET PAGE-NUM OFF


HEADING
"<78 &&DTDESC"
"<37 <RN <75 <CR &CMFMM/&CMFMD/&CMFMY - &CMTOM/&CMTOD/&CMTOY  
"        <75 <PR     &PMFMM/&PMFMD/&PMFMY - &PMTOM/&PMTOD/&PMTOY"
"<&&CSLP &&ROLLNME <+0> &&SP <+0> &&ROLLCS11 <+0> &&SP3 <+0> &&RCNCT1 <+0> &&SP4 <+0> &&ROLLPHN"
"</1"
"<15 Domestic <32 International <50 Combined"

-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*7/31/00    IBISTL-KR          REPLACED &FOCSYSTOD WITH NOWTOD
-*************************************************************************

FOOTING 
"Tickets issued do not include MCO's, Average ticket cost includes taxes"
"Net tickets = tickets issued - full refunds - voids - full exchanges"
-INCLUDE CRIGHT_FOOTER
"<67 Tctrvlsm <75 &M1.EVAL"
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *



-******************DRILL DOWN END************************************

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.030000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.010000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $    
    
TYPE=REPORT, FOCEXEC=NONE, GRID=OFF, FONT='ARIAL', SIZE=8, COLOR=BLACK,
             BACKCOLOR=NONE, STYLE=NORMAL, $   
TYPE=HEADING,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR=RGB(0 0 138),  
     STYLE=BOLD,
     FONT='ARIAL',
$

TYPE=HEADING,
     SIZE=10,
     LINE=2,
     ITEM=1,
     JUSTIFY=LEFT,
     COLOR=RGB(70 136 177),
     STYLE=BOLD,
     FONT='ARIAL',
$


TYPE=TITLE,
     GRID=OFF,
     FONT='ARIAL',
     STYLE=BOLD,
     SIZE=8,
     COLOR=RGB(0 0 138),  
$


TYPE=SUBHEAD,
     FONT='ARIAL',
     STYLE=BOLD,
     SIZE=9,
     COLOR=RGB(0 0 138),  
$     

     
TYPE=FOOTING,
     SIZE=6,
     FONT=ARIAL,
     COLOR=RGB(70 136 177),
$ 

TYPE=TABFOOTING,
     SIZE=7,
     FONT=ARIAL,
     COLOR=RGB(70 136 177),
$   


TYPE=DATA, 
     COLUMN=N3,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$ 

TYPE=DATA, 
     COLUMN=N4,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$ 

TYPE=DATA, 
     COLUMN=N5,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$ 

TYPE=REPORT, 
     COLUMN=N6,
     GRID=OFF,
     SIZE=1,
$ 

TYPE=DATA, 
     COLUMN=N6,
     GRID=OFF,
     BACKCOLOR=NONE,
$          
             
             
TYPE=DATA, 
     COLUMN=N7,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$    

TYPE=DATA, 
     COLUMN=N8,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$ 

TYPE=REPORT, 
     COLUMN=N9,
     GRID=OFF,
     SIZE=1,
$ 

TYPE=DATA, 
     COLUMN=N9,
     GRID=OFF,
     BACKCOLOR=NONE,
$  

TYPE=DATA, 
     COLUMN=N10,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$    

TYPE=DATA, 
     COLUMN=N11,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$ 

TYPE=DATA,
     BACKCOLOR=(RGB(239 239 239)'WHITE'), 
     FONT='TIMES NEW ROMAN',
$      

TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0), $
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.2), $ 



ENDSTYLE
END
-RUN

-TYPE YEARLY EXECSUM STARTS HERE

-*-SET &LJUSTLVL_DSC = LJUST (37, &&LVL_DSC, 'A30');
-*-TYPE LJUST IS &LJUSTLVL_DSC
-SET &&RPTSUF = 'YRTVLSUM';
-INCLUDE FDEFRPTS
-RUN
DEFINE FILE TC1_MAIN

-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*10/3/00    IBISTL-SB          ADDED BY KEY FIELD
-*************************************************************************
 KEY/A1 = IF TC1_MAIN.CAT_ORDER EQ 1 OR 2 THEN 'A'
 ELSE IF TC1_MAIN.CAT_ORDER EQ 3 THEN 'B'
 ELSE IF TC1_MAIN.CAT_ORDER EQ 4 THEN 'C' ELSE '';
 
 KEY1/A1 = IF TC1_MAIN.ROW_LABEL CONTAINS '%' THEN 'C' ELSE 
            IF TC1_MAIN.ROW_LABEL CONTAINS 'Volume' OR 'Amount' OR 'Cost' OR 'ATP' OR 'Price' OR 'Amt' OR 'RATE' OR 'Rate' OR 'Taxes' OR 'Fee' OR 'Savings' OR 'Expense' THEN 'A'
            ELSE 'B';  


-* DOM_CURR Conversion                       
DOMCURRA/D10M = DYTD_CURR;
DOM_CURRA/A16 = FTOA(DOMCURRA, '(D10M)', 'A16');
DOM_CURRA1/A12 = TRIM('L', DOM_CURRA, 16, ' ', 4, 'A12'); 
DOMCURRB/D10C = DYTD_CURR;
DOM_CURRB/A16 = FTOA(DOMCURRB, '(D10C)', 'A16');
DOM_CURRB1/A12 = TRIM('L', DOM_CURRB, 16, ' ', 4, 'A12');
DOMCURRC/D10% = DYTD_CURR;
DOM_CURRC/A16 = FTOA(DOMCURRC, '(D10%)', 'A16');
DOM_CURRC1/A12 = TRIM('L', DOM_CURRC, 16, ' ', 4, 'A12');


DOM_CURRXX/A12 = IF KEY1 EQ 'A' THEN DOM_CURRA1 ELSE
                 IF KEY1 EQ 'C' THEN DOM_CURRC1 ELSE DOM_CURRB1;   
                 
-* DOM_PRIOR Conversion                 

DOMPRIORA/D10M = DYTD_PRIOR;
DOM_PRIORA/A16 = FTOA(DOMPRIORA, '(D10M)', 'A16');
DOM_PRIORA1/A12 = TRIM('L', DOM_PRIORA, 16, ' ', 4, 'A12'); 
DOMPRIORB/D10C = DYTD_PRIOR;
DOM_PRIORB/A16 = FTOA(DOMPRIORB, '(D10C)', 'A16');
DOM_PRIORB1/A12 = TRIM('L', DOM_PRIORB, 16, ' ', 4, 'A12');
DOMPRIORC/D10% = DYTD_PRIOR;
DOM_PRIORC/A16 = FTOA(DOMPRIORC, '(D10%)', 'A16');
DOM_PRIORC1/A12 = TRIM('L', DOM_PRIORC, 16, ' ', 4, 'A12');


DOM_PRIORXX/A12 = IF KEY1 EQ 'A' THEN DOM_PRIORA1 ELSE
                  IF KEY1 EQ 'C' THEN DOM_PRIORC1 ELSE DOM_PRIORB1;     
                  
                     

-* INT_CURR Conversion                       
INTCURRA/D10M = IYTD_CURR;
INT_CURRA/A16 = FTOA(INTCURRA, '(D10M)', 'A16');
INT_CURRA1/A12 = TRIM('L', INT_CURRA, 16, ' ', 4, 'A12'); 
INTCURRB/D10C = IYTD_CURR;
INT_CURRB/A16 = FTOA(INTCURRB, '(D10C)', 'A16');
INT_CURRB1/A12 = TRIM('L', INT_CURRB, 16, ' ', 4, 'A12');
INTCURRC/D10% = IYTD_CURR;
INT_CURRC/A16 = FTOA(INTCURRC, '(D10%)', 'A16');
INT_CURRC1/A12 = TRIM('L', INT_CURRC, 16, ' ', 4, 'A12');


INT_CURRXX/A12 = IF KEY1 EQ 'A' THEN INT_CURRA1 ELSE
                 IF KEY1 EQ 'C' THEN INT_CURRC1 ELSE INT_CURRB1;   
                 
-* INT_PRIOR Conversion                 

INTPRIORA/D10M = IYTD_PRIOR;
INT_PRIORA/A16 = FTOA(INTPRIORA, '(D10M)', 'A16');
INT_PRIORA1/A12 = TRIM('L', INT_PRIORA, 16, ' ', 4, 'A12'); 
INTPRIORB/D10C = IYTD_PRIOR;
INT_PRIORB/A16 = FTOA(INTPRIORB, '(D10C)', 'A16');
INT_PRIORB1/A12 = TRIM('L', INT_PRIORB, 16, ' ', 4, 'A12');
INTPRIORC/D10% = IYTD_PRIOR;
INT_PRIORC/A16 = FTOA(INTPRIORC, '(D10%)', 'A16');
INT_PRIORC1/A12 = TRIM('L', INT_PRIORC, 16, ' ', 4, 'A12');


INT_PRIORXX/A12 = IF KEY1 EQ 'A' THEN INT_PRIORA1 ELSE
                  IF KEY1 EQ 'C' THEN INT_PRIORC1 ELSE INT_PRIORB1;     
                  
                 
                 
-* DI_CURR Conversion                       
DICURRA/D10M = DIYTD_CURR;
DI_CURRA/A16 = FTOA(DICURRA, '(D10M)', 'A16');
DI_CURRA1/A12 = TRIM('L', DI_CURRA, 16, ' ', 4, 'A12'); 
DICURRB/D10C = DIYTD_CURR;
DI_CURRB/A16 = FTOA(DICURRB, '(D10C)', 'A16');
DI_CURRB1/A12 = TRIM('L', DI_CURRB, 16, ' ', 4, 'A12');
DICURRC/D10% = DIYTD_CURR;
DI_CURRC/A16 = FTOA(DICURRC, '(D10%)', 'A16');
DI_CURRC1/A12 = TRIM('L', DI_CURRC, 16, ' ', 4, 'A12');


DI_CURRXX/A12 = IF KEY1 EQ 'A' THEN DI_CURRA1 ELSE
                IF KEY1 EQ 'C' THEN DI_CURRC1 ELSE DI_CURRB1;   
                 
-* DI_PRIOR Conversion                 

DIPRIORA/D10M = DIYTD_PRIOR;
DI_PRIORA/A16 = FTOA(DIPRIORA, '(D10M)', 'A16');
DI_PRIORA1/A12 = TRIM('L', DI_PRIORA, 16, ' ', 4, 'A12'); 
DIPRIORB/D10C = DIYTD_PRIOR;
DI_PRIORB/A16 = FTOA(DIPRIORB, '(D10C)', 'A16');
DI_PRIORB1/A12 = TRIM('L', DI_PRIORB, 16, ' ', 4, 'A12');
DIPRIORC/D10% = DIYTD_PRIOR;
DI_PRIORC/A16 = FTOA(DIPRIORC, '(D10%)', 'A16');
DI_PRIORC1/A12 = TRIM('L', DI_PRIORC, 16, ' ', 4, 'A12');


DI_PRIORXX/A12 = IF KEY1 EQ 'A' THEN DI_PRIORA1 ELSE
                 IF KEY1 EQ 'C' THEN DI_PRIORC1 ELSE DI_PRIORB1;     
                  


   BLANK/A1='';
-*  T_DOM_VAR_VAL/D10C = ES1_MAIN.DOM_CURR - ES1_MAIN.DOM_PRIOR;
-*  T_DOM_VAR_PCT/P4   = IF ((ES1_MAIN.DOM_PRIOR LT 1) AND
-*			(ES1_MAIN.DOM_PRIOR GT (-1))) THEN 0 ELSE 
-*                      ((T_DOM_VAR_VAL / ES1_MAIN.DOM_PRIOR) * 100) ;
-* T_INT_VAR_VAL/D10C = ES1_MAIN.INT_CURR - ES1_MAIN.INT_PRIOR;
-* T_INT_VAR_PCT/P4   = IF ((ES1_MAIN.INT_PRIOR LT 1) AND 
-*	(ES1_MAIN.INT_PRIOR GT (-1))) THEN 0 ELSE
-*                      ((T_INT_VAR_VAL / ES1_MAIN.INT_PRIOR) * 100) ;
-* 
-*    T_DI_VAR_VAL/D10C  = ES1_MAIN.DI_CURR - ES1_MAIN.DI_PRIOR;
-*    T_DI_VAR_PCT/P4    = IF ((ES1_MAIN.DI_PRIOR LT 1) AND 
-*			(ES1_MAIN.DI_PRIOR GT (-1))) THEN 0 ELSE
-*                        ((T_DI_VAR_VAL / ES1_MAIN.DI_PRIOR) * 100) ;

CR/A8 = 'Current:';
PR/A8 = 'Prior:  ';
RN/A60=TRIM('B', '&&RPT_TTL1.EVAL', 60, ' ', 1, 'A60');

NOWTOD/A8 WITH CAT_ORDER = HHMMSS (NOWTOD);

END
-RUN


TABLE FILE TC1_MAIN
SUM DOM_CURRXX    AS 'Current' 
    DOM_PRIORXX   AS 'Prior'
    BLANK AS ' '
      
    INT_CURRXX    AS 'Current' 
    INT_PRIORXX   AS 'Prior'
    BLANK AS ' '
      
    DI_CURRXX     AS 'Current' 
    DI_PRIORXX    AS 'Prior'
      
      
BY CAT_ORDER NOPRINT
BY ROW_ORDER NOPRINT
BY ROW_LABEL  AS '' 

ON CAT_ORDER SUBHEAD



-* " "
"<CATEGORY"

ON TABLE NOTOTAL
&&OUTLINE1
-*&&OUTLN1A
&&OUTLINE2
ON TABLE SET PAGE-NUM OFF


&&OUTLINE1
&&OUTLINE2
HEADING
"<78 &&DTDESC"
"<37 <RN <75 <CR &CYFMM/&CYFMD/&CYFMY - &CYTOM/&CYTOD/&CYTOY  
"        <75 <PR     &PYFMM/&PYFMD/&PYFMY - &PYTOM/&PYTOD/&PYTOY"
"<&&CSLP &&ROLLNME <+0> &&SP <+0> &&ROLLCS11 <+0> &&SP3 <+0> &&RCNCT1 <+0> &&SP4 <+0> &&ROLLPHN"
"</1"
"<15 Domestic <32 International <50 Combined"
-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*7/31/00    IBISTL-KR          REPLACED &FOCSYSTOD WITH NOWTOD
-*************************************************************************
FOOTING 
"Tickets issued do not include MCO's, Average ticket cost includes taxes"
"Net tickets = tickets issued - full refunds - voids - full exchanges"
-INCLUDE CRIGHT_FOOTER
"<67 Tcyrtvlsm <75 &M1.EVAL"
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *



UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.030000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.010000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $    
    
TYPE=REPORT, FOCEXEC=NONE, GRID=OFF, FONT='ARIAL', SIZE=8, COLOR=BLACK,
             BACKCOLOR=NONE, STYLE=NORMAL, $   
TYPE=HEADING,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR=RGB(0 0 138),  
     STYLE=BOLD,
     FONT='ARIAL',
$

TYPE=HEADING,
     SIZE=10,
     LINE=2,
     ITEM=1,
     JUSTIFY=LEFT,
     COLOR=RGB(70 136 177),
     STYLE=BOLD,
     FONT='ARIAL',
$


TYPE=TITLE,
     GRID=OFF,
     FONT='ARIAL',
     STYLE=BOLD,
     SIZE=8,
     COLOR=RGB(0 0 138),  
$


TYPE=SUBHEAD,
     FONT='ARIAL',
     STYLE=BOLD,
     SIZE=9,
     COLOR=RGB(0 0 138),  
$     

     
TYPE=FOOTING,
     SIZE=6,
     FONT=ARIAL,
     COLOR=RGB(70 136 177),
$ 

TYPE=TABFOOTING,
     SIZE=7,
     FONT=ARIAL,
     COLOR=RGB(70 136 177),
$   


TYPE=DATA, 
     COLUMN=N3,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$ 

TYPE=DATA, 
     COLUMN=N4,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$ 

TYPE=DATA, 
     COLUMN=N5,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$ 

TYPE=REPORT, 
     COLUMN=N6,
     GRID=OFF,
     SIZE=1,
$ 

TYPE=DATA, 
     COLUMN=N6,
     GRID=OFF,
     BACKCOLOR=NONE,
$          
             
             
TYPE=DATA, 
     COLUMN=N7,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$    

TYPE=DATA, 
     COLUMN=N8,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$ 

TYPE=REPORT, 
     COLUMN=N9,
     GRID=OFF,
     SIZE=1,
$ 

TYPE=DATA, 
     COLUMN=N9,
     GRID=OFF,
     BACKCOLOR=NONE,
$  

TYPE=DATA, 
     COLUMN=N10,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$    

TYPE=DATA, 
     COLUMN=N11,
     GRID=OFF,
     SIZE=8, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,
$ 

TYPE=DATA,
     BACKCOLOR=(RGB(239 239 239)'WHITE'), 
     FONT='TIMES NEW ROMAN',
$      

TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0), $
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.2), $ 



ENDSTYLE
END
-RUN


-EXIT




