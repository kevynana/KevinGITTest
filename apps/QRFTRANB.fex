CQ/Q = TRN_DATE;
CY/Y = TRN_DATE;
CM/M  = TRN_DATE;
FM/M = &&ROLLFY;
DM/I2 = CM - FM;

-*FDATE1/YYMD='&&FXDATE.EVAL';
-*TDATE1/YYMD='&&TXDATE.EVAL';
  
-*FDATE2/YYMD='&&FROMDT.EVAL';
-*TDATE2/YYMD='&&TODT.EVAL';

-*FDYR1/Y = FDATE1;
-*TDYR1/Y = TDATE1;
-*FDYR2/Y = FMDATE2;
-*TDYR2/Y = TDATE2;

TRANYR/YY= TRN_DATE;
AYEAR/A4YY = TRANYR;

THEYR/I1 = IF (TRN_DATE GE '&&FROMDT.EVAL') AND (TRN_DATE LE '&&TODT.EVAL') THEN 2
  ELSE IF (TRN_DATE GE '&&FXDATE.EVAL') AND (TRN_DATE LE '&&TXDATE.EVAL') THEN 1;

-*first year as fiscal year label
FMDATE1/YYMD='&&FXDATE.EVAL';
FMDATE2/YYMD='&&FROMDT.EVAL';
FYYR1/Y=FMDATE1;
FYYR2/Y=FMDATE2;

-*second year as fiscal year label
Y2DATE/YYMD = DATEADD(FMDATE2, 'Y', 1);
FYYR3/Y=Y2DATE;

FY_YR/A4= IF '&&FYFLAG.EVAL' EQ '1' AND THEYR EQ 1 THEN 'FY' | EDIT(FYYR1) 
  ELSE IF '&&FYFLAG.EVAL' EQ '1' AND THEYR EQ 2 THEN 'FY' | EDIT(FYYR2) 
  ELSE IF '&&FYFLAG.EVAL' EQ '2' AND THEYR EQ 1 THEN 'FY' | EDIT(FYYR2) 
  ELSE IF '&&FYFLAG.EVAL' EQ '2' AND THEYR EQ 2 THEN 'FY' | EDIT(FYYR3) 
  ELSE AYEAR;
  
-*FY_YR/A4= IF '&&FYFLAG.EVAL' EQ '1' THEN 'FY' | EDIT(FYYR2) 
-*  ELSE IF '&&FYFLAG.EVAL' EQ '2' THEN 'FY' | EDIT(FYYR3) 
-*  ELSE AYEAR;
  

-*Y1/A4 = IF FDYR1 EQ TDYR1 THEN AYEAR ELSE EDIT(FDYR1) | EDIT(TDYR1);
-*Y2/A4 = IF FDYR2 EQ TDYR2 THEN AYEAR ELSE EDIT(FDYR2) | EDIT(TDYR2);


YEAR/A4 = IF FM EQ 01 THEN AYEAR ELSE FY_YR;

-*YEAR/A4 = IF FM EQ 01 THEN AYEAR 
-*  ELSE IF THEYR EQ 1 THEN Y1 ELSE Y2; 
  
FTRAN1/A2 = IF FM EQ 01 THEN 'Q' | EDIT(CQ)  
  ELSE IF (DM GE 9 OR (DM GE -3 AND DM LE -1)) THEN 'Q4'
  ELSE IF (DM GE 6 OR (DM GE -6 AND DM LE -4)) THEN 'Q3' 
  ELSE IF (DM GE 3 OR (DM GE -9 AND DM LE -7))  THEN 'Q2'
  ELSE IF DM LE 0 AND FM GE 11 THEN 'Q1' 
  ELSE 'Q1';    
  
-*FTRAN/A6 = IF FM EQ 01 THEN FTRAN1 | ' ' | EDIT(CY)
-*  ELSE IF THEYR EQ 1 THEN FTRAN1 | Y1 ELSE FTRAN1 | Y2;

FTRAN/A6 = IF FM EQ 01 THEN FTRAN1 | ' ' | EDIT(CY)
  ELSE FTRAN1 | FY_YR;
  
TRAN/A7 = IF THEYR EQ 1 THEN ' ' | FTRAN ELSE FTRAN;



-*Y2DATE/YYMD = DATEADD(FMDATE2, 'Y', 1);
-*FYYR2/Y=Y2DATE;
-*FY_YR/A4= IF '&&FYFLAG.EVAL' EQ '1' THEN 'FY' | EDIT(FDYR1) 
-*  ELSE IF '&&FYFLAG.EVAL' EQ '2' THEN 'FY' | EDIT(FYYR2) 
-*  ELSE AYEAR;



