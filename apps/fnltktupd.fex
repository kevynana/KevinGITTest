SET ASNAMES=ON

USE ADD
D:\TNT\TTRACKER\DATA\T1METX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\T2METX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\T3METX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\T4METX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\T5METX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\T6METX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\T7METX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\T8METX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\T9METX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\T0METX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\TYMETX.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\TZMETX.FOC AS TKT_MAIN
END

-* -GOTO JOY2
-* USE ADD
-* D:\TNT\TTRACKER\DATA\S_BCBS.FOC AS SR_50
-* D:\TNT\TTRACKER\DATA\A_BCBS.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\T_BCBS.FOC AS TKT_MAIN
-* END


DEFINE FILE TKT_MAIN
FDCC/A3 = IF FNL_DEST_CNTY_CODE  EQ ' ' THEN FST_DEST_CNTRY_CODE ELSE FNL_DEST_CNTY_CODE;
FDSC/A2 = IF FNL_DEST_STATE_CODE EQ ' ' THEN FST_DEST_STATE_CODE ELSE FNL_DEST_STATE_CODE;
FDAP/A3 = IF FNL_DEST_AIRPORT    EQ ' ' THEN ORG_APC ELSE FNL_DEST_AIRPORT;
END
-RUN
TABLE FILE TKT_MAIN
PRINT FDAP AS 'FNL_DEST_AIRPORT'
      FDSC AS 'FNL_DEST_STATE_CODE'
      FDCC AS 'FNL_DEST_CNTY_CODE' 
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END
-RUN

TABLE FILE HOLD1
PRINT FNL_DEST_AIRPORT FNL_DEST_STATE_CODE FNL_DEST_CNTY_CODE 
BY AIR_KEY
ON TABLE HOLD AS HOLD2
END
-RUN      

-***********  T1 MODIFY

MODIFY FILE T1METX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T2 MODIFY

MODIFY FILE T2METX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T3 MODIFY

MODIFY FILE T3METX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T4 MODIFY

MODIFY FILE T4METX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T5 MODIFY

MODIFY FILE T5METX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T6MODIFY

MODIFY FILE T6METX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T7 MODIFY

MODIFY FILE T7METX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T8 MODIFY

MODIFY FILE T8METX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T9 MODIFY

MODIFY FILE T9METX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T0 MODIFY

MODIFY FILE T0METX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  TY MODIFY

MODIFY FILE TYMETX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  TZ MODIFY

MODIFY FILE TZMETX
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN
-QUIT

TABLE FILE TKT_MAIN
PRINT FST_DEST_CNTRY_CODE FNL_DEST_CNTY_CODE
BY AIR_KEY
-* WHERE FNL_DEST_CNTY_CODE EQ ' '
WHERE AIR_KEY CONTAINS '73620608801'

END
-RUN
-QUIT