SET ASNAMES = ON
-RUN 
DEFINE FILE RPT_QUE
ROLL/A8='ALL     ';
END
TABLE FILE RPT_QUE
PRINT ROLL AS RC
BY ROLL
BY ROLLUP_CODE NOPRINT
WHERE RECORDLIMIT EQ 1
ON TABLE HOLD FORMAT FOCUS AS HOLDALL
END
-RUN
DEFINE FILE RPT_QUE
FIL/I5=0;
END
TABLE FILE RPT_QUE
SUM ROLLUP_CODE AS RC
BY ROLLUP_CODE 
BY FIL
ON TABLE HOLD FORMAT FOCUS AS HOLDCODE 
END
 
-SET &TEMP_PATH=TEMPPATH(50,'A50');
-SET &HA = &TEMP_PATH || 'HOLDALL.FOC';
-SET &HC = &TEMP_PATH || 'HOLDCODE.FOC';
-RUN 
USE
&HC AS HOLDCODE
&HA AS HOLDCODE
END
-RUN
DEFINE FILE HOLDCODE
SORT1/A1=IF RC EQ 'ALL     ' THEN '1' ELSE '2';
END
TABLE FILE HOLDCODE
PRINT RC AS ROLLUP_CODE
BY SORT1
BY ROLLUP_CODE NOPRINT
ON TABLE PCHOLD 
END

