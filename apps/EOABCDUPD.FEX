
SET ASNAMES=ON
JOIN INST_KEY IN RPT_INST TO INST_KEY IN RPT_FLDS
END
DEFINE FILE RPT_INST
SLEV/I2 = IF SEL_LEVEL EQ '01' THEN 1 ELSE
          IF SEL_LEVEL EQ '02' THEN 2 ELSE
          IF SEL_LEVEL EQ '03' THEN 3 ELSE
          IF SEL_LEVEL EQ '04' THEN 4 ELSE
          IF SEL_LEVEL EQ '05' THEN 5 ELSE
          IF SEL_LEVEL EQ '06' THEN 6 ELSE
          IF SEL_LEVEL EQ '07' THEN 7 ELSE
          IF SEL_LEVEL EQ '08' THEN 8 ELSE
          IF SEL_LEVEL EQ '09' THEN 9 ELSE
          IF SEL_LEVEL EQ '10' THEN 10 ELSE
          IF SEL_LEVEL EQ '11' THEN 11 ELSE
          IF SEL_LEVEL EQ '12' THEN 12 ELSE
          IF SEL_LEVEL EQ '13' THEN 13 ELSE
          IF SEL_LEVEL EQ '14' THEN 14 ELSE 
          IF SEL_LEVEL EQ '15' THEN 15 ELSE 1;
         
RNAME/A50 = IF RPT_NAME EQ 'EXECUTIVE OVERVIEW' OR 'Executive Overview' THEN 'Executive Overview by Hierarchy' ELSE 
            IF RPT_NAME CONTAINS 'PERIOD' OR 'Period' THEN 'Executive Overview by Hierarchy' ELSE RPT_NAME;
RTITLE1/A60 = IF RPT_TITLE1 EQ 'EXECUTIVE OVERVIEW' OR 'Executive Overview' THEN 'Executive Overview by Hierarchy' ELSE
              IF RPT_TITLE1 CONTAINS 'PERIOD' OR 'Period' THEN 'Executive Overview by Hierarchy' ELSE RPT_TITLE1;
SLEV1/I2 = SELECT_LEV;
BBY/I1 = 2;
END     

TABLE FILE RPT_INST
PRINT RPT_STREAM GLOBAL_PARM RNAME AS 'RPT_NAME' ID RTITLE1 AS 'RPT_TITLE1' SLEV AS 'SELECT_LEV' BBY AS 'BREAKBY'
BY INST_KEY
WHERE GLOBAL_PARM EQ 'OVABCD'
-* WHERE RPT_NAME OMITS 'GLOBAL' OR 'Global'
WHERE INST_KEY NE 84394 OR 97723 OR 97549 OR 59018 OR 103077 OR 103072 OR 98300 OR 98466 OR 91720 OR 97542
WHERE ROLLUP_CODE NE 'LAKE-R'
ON TABLE HOLD AS HOLD1
END
-RUN

TABLE FILE HOLD1
PRINT INST_KEY RPT_STREAM GLOBAL_PARM RPT_NAME ID RPT_TITLE1 SELECT_LEV BREAKBY
BY INST_KEY NOPRINT
BY ID NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE RPT_INST
FIXFORM FROM HOLD
MATCH INST_KEY 
ON MATCH COMPUTE RPT_STREAM/A8 = 'EO_BHIER';
ON MATCH COMPUTE GLOBAL_PARM/A8 = 'EOABCD';
ON MATCH CONTINUE
MATCH ID
ON MATCH UPDATE RPT_STREAM GLOBAL_PARM RPT_NAME RPT_TITLE1 SELECT_LEV BREAKBY
DATA ON HOLD
END   
-RUN










