
-INCLUDE SETECHO
SET ASNAMES=ON
SET PAGE-NUM=OFF
SET EMPTYREPORT=ON


-DEFAULT &&IKEY = 0;

-SET &&IKEY = 326807;


TABLE FILE RPT_INST
PRINT ROLLUP_CODE INST_KEY RPT_NAME SET_KEY
BY GLOBAL_PARM
WHERE INST_KEY EQ &&IKEY.EVAL
ON TABLE HOLD AS RIHLD
END
-RUN

JOIN RIHLD.GLOBAL_PARM IN RIHLD TO ROLLSET.GLOBAL_PARM IN ROLLSET AS J1
-RUN

TABLE FILE RIHLD
PRINT INST_KEY ROLLUP_CODE GLOBAL_PARM RPT_NAME DESC1 DESC2 DESC3 DESC4
BY SET_KEY
ON TABLE HOLD AS RIHLD2
END
-RUN

JOIN RIHLD2.SET_KEY IN RIHLD2 TO RPT_SET.SET_KEY IN RPT_SET AS J2
-RUN

TABLE FILE RIHLD2
PRINT RPT_NAME DESC1 DESC2 DESC3 DESC4
BY INST_KEY
BY ROLLUP_CODE
BY USER_NAME
BY SET_NAME
BY GLOBAL_PARM
ON TABLE HOLD AS RIHLD3
END
-RUN



TABLE FILE RIHLD3
HEADING CENTER
" "
" "
" "
"REPORT LISTING"
" "
" "
PRINT RPT_NAME AS 'REPORT NAME' 
      DESC1 AS 'REPORT,DESCRIPTION 1' 
      DESC2 AS 'REPORT,DESCRIPTION 2'
      DESC3 AS 'SPECIAL,SELECTION 1'
      DESC4 AS 'SPECIAL,SELECTION 2'
BY ROLLUP_CODE AS 'ROLLUP'
BY USER_NAME AS 'USER NAME'
BY SET_NAME AS 'SET NAME'
BY GLOBAL_PARM AS 'PROGRAM ID'
FOOTING BOTTOM 
" "
" "
"INCLUSIVE OF INSTANCE KEY &&IKEY.EVAL"
ON TABLE SET ONLINE-FMT PDF
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.200000, RIGHTMARGIN=0.200000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=7, STYLE=NORMAL, $
TYPE=HEADING, SIZE=10, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=FOOTING, SIZE=7, STYLE=BOLD, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=REPORT, IMAGE=LOGO15, POSITION=(.5 .5 ), SIZE=(1.5 .4), $
END
-RUN
-QUIT


TABLE FILE RPTSET1

BY USR_NAM          AS 'USER NAME'
BY SET_FREQ         AS 'FREQUENCY'
BY SET_NM           AS 'SET NAME'
BY GLOBAL_PARM      AS 'REPORT ID'
PRINT RPT_NM        AS 'REPORT NAME'
      MEMBER        AS 'HIERARCHY'
      SEL_LEVEL     AS 'LEVEL'
      OTYPE         AS 'FORMAT'
      DISTRB        AS 'OUTPUT'
      CATG          AS 'CATEGORY'
      INCCAT1       AS 'INC/EXL'
      CLIENT        AS 'CLIENT'
      INCCLI1       AS 'INC/EXL'
      
-* IF USER_NAME NE ' '    
-*WHERE HIEORG2.SEQ_NO EQ 1
WHERE SET_KEY NE 0
ON SET_NM SKIP-LINE
 
ON USR_NAM 
    SUBFOOT
    "&BLANK.EVAL"
ON TABLE SET ONLINE-FMT PDF
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.200000, RIGHTMARGIN=0.200000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=6, STYLE=NORMAL, $
TYPE=DATA, COLUMN=N4, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N5, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N6, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N7, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N8, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N9, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N10, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=HEADING, OBJECT=TEXT, SIZE=8, COLOR=BLACK, STYLE = BOLD ,$
TYPE=HEADING, LINE=4, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBFOOT, SIZE=1, STYLE=BOLD, BACKCOLOR=SILVER, GRID=ON, JUSTIFY=CENTER,  $
TYPE=GRANDTOTAL, SIZE=9, STYLE=BOLD, $
-* TYPE=REPORT, IMAGE=&&TNTPIC, POSITION=(.5 .5 ), SIZE=(1.5 .4), $
TYPE=REPORT, IMAGE=&LOGO2, POSITION=(.5 .5 ), SIZE=(1.5 .4), $
END
-RUN


-GOTO DONE;


-TOTAL


TABLE FILE RPT_FLDS
PRINT ROLL2.SEQ_NO AS 'SEQ_NO'
BY INST_KEY
-* WHERE INST_KEY IN FILE SAVE
ON TABLE HOLD AS XTWO
END
-RUN



MATCH FILE XONE
PRINT DISTRB
      OTYPE
      SET_FREQ
      SET_NAME
      GLOBAL_PARM 
      RPT_NAME
      ROLLUP_CODE
      USER_NAME
BY INST_KEY 
ON TABLE HOLD
RUN
FILE XTWO
PRINT SEQ_NO
BY INST_KEY
AFTER MATCH HOLD AS TOTSET1 OLD
END
-RUN



DEFINE FILE TOTSET1
USR_NAM/A30 = IF USER_NAME EQ ' ' THEN 'unassigned' ELSE USER_NAME;
END
-RUN 

TABLE FILE TOTSET1
HEADING
" "
" "
" "
"eTTek Review"
"&DATE ........ &TOD        REPORT LISTING FOR : &&RLUP"
"REPORT NAME:  RPT_LSTA.FEX"
" "
" "
BY USR_NAM          AS 'USER NAME'
BY SET_FREQ         AS 'FREQUENCY'
BY SET_NAME         AS 'SET NAME'
BY GLOBAL_PARM      AS 'REPORT ID'
PRINT RPT_NAME      AS 'REPORT NAME'
      OTYPE         AS 'FORMAT'
      DISTRB        AS 'OUTPUT'
WHERE SEQ_NO EQ 1
ON SET_NAME SKIP-LINE
ON USR_NAM 
    SUBFOOT
    "&BLANK.EVAL"
ON TABLE SET ONLINE-FMT PDF
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=6, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=HEADING, OBJECT=TEXT, SIZE=8, COLOR=BLACK, STYLE = BOLD ,$
TYPE=HEADING, LINE=4, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=DATA, COLUMN=N4, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N5, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N6, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N7, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N8, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N9, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, COLUMN=N10, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBFOOT, SIZE=1, STYLE=BOLD, BACKCOLOR=SILVER, GRID=ON, JUSTIFY=CENTER,  $
TYPE=SUBTOTAL, SIZE=9, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=9, STYLE=BOLD, $
-* TYPE=REPORT, IMAGE=&&TNTPIC, POSITION=(.5 .5 ), SIZE=(1.5 .4), $
TYPE=REPORT, IMAGE=&LOGO2, POSITION=(.5 .5 ), SIZE=(1.5 .4), $
END

-GOTO DONE;

-NORECORDS

DEFINE FILE RPT_SET
EMPTY/A60 = 'NO REPORTS CURRENTLY SET UP FOR ANY USER                             ';
EMPTY/A60 WITH USER_NAME = 'NO REPORTS CURRENTLY SET UP FOR ANY USER';
 
END


TABLE FILE RPT_SET 
PRINT EMPTY AS '' 
BY USER_NAME NOPRINT
WHERE RECORDLIMIT EQ 1
ON TABLE SET ONLINE-FMT PDF
ON TABLE SET STYLE *
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=12, BACKCOLOR=NONE, STYLE=NORMAL, $
-* TYPE=REPORT, IMAGE=&&TNTPIC, POSITION=(.2 .2 ), SIZE=(1.5 .4), $
TYPE=REPORT, IMAGE=&LOGO2, POSITION=(.5 .5 ), SIZE=(1.5 .4), $
END
-RUN


-DONE
