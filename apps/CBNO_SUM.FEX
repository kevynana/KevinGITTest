-* CBNO_SUM
-*  02/02/2015  REJ  S-05681 Changes to the no data report to prepare for the Available
-*                           Report changes.  Rollup Code is being removed from BRPTINST in
-*                           ER5, so I'm removing the reference to the ROLLUP_CODE in that report.
-* 02/24/2017 - DLV - S-22486 CHANGED ettek Review to Post-trip Reporting
-* 06/27/2017 - RSB - S-36530 Report stream to be updated with standard footer
-* 09/13/2017 CA S-38044 Place the footer datetime stamp text in a separate file to be -INCLUDED in the stylesheets
-*                       Backed out changes for S-36530 
-*
-*
-INCLUDE SETECHO

SET ASNAMES = ON
-SET &&CBNO_OFF = &&WEB_PATH || 'CBNO_OFF.FOC';
-RUN
FILEDEF CBNO_OFF DISK &&CBNO_OFF 
-RUN

CREATE FILE CBN_OFF
-RUN

TABLE FILE CBNAIR
SUM YNET_TKT YMILES YTON_C02 PYNET_TKT PYMILES PYTON_C02  2VYTON_C02 2VPYTON_C02
BY LEVEL_DESC
-*BY PASSNGR_NAME
BY AIRLINE
BY DATE 
BY P_DATE
BY NOMONTHS
BY PNOMONTHS
BY RPTT2
IF AIRLINE NE '2V' OR 'XA'
ON TABLE HOLD AS CBNAIR2
END
-RUN


TABLE FILE CBNAIR
SUM YNET_TKT YMILES YTON_C02 PYNET_TKT PYMILES PYTON_C02 2VYTON_C02 2VPYTON_C02
BY LEVEL_DESC
-*BY PASSNGR_NAME
BY AIRLINE
BY DATE 
BY P_DATE
BY NOMONTHS
BY PNOMONTHS
BY RPTT2
IF AIRLINE EQ '2V' OR 'XA'
ON TABLE HOLD AS CBNAIR2V
END
-RUN

DEFINE FILE CBNAIR
NMOS/I3 = IF NOMONTHS NE LAST NOMONTHS THEN NOMONTHS ELSE 0;
PNMOS/I3 = IF PNOMONTHS NE LAST PNOMONTHS THEN PNOMONTHS ELSE 0;
CURYR/YY = ANNUAL_BEGIN;
PRYR/YY = P_ANNUAL_BEGIN;
END
TABLE FILE CBNAIR
SUM NMOS PNMOS CURYR PRYR

ON TABLE SAVE AS CBNDATES
END
-RUN

-READ CBNDATES &NMOS.3, &PNMOS.3, &CURYR.A4, &PRYR.A4

-TYPE &NMOS
-TYPE &PNMOS
-TYPE &CURYR
-TYPE &PRYR




DEFINE FILE CBNAIR2
LABEL1/A40 = 'Air miles per year                     ';
LABEL2/A40 = 'Air miles per month (average)          ';
LABEL3/A40 = 'Number of trips                        ';
LABEL4/A40 = 'Air miles per trip (average)           ';
LABEL5/A40 = 'Total annual emissions in tons         ';
LABEL6/A40 = 'Total monthly emissions in tons        ';
LABEL7/A40 = 'Yearly number of trees to offset       ';
LABEL8/A40 = 'Monthly number of trees to offset      ';
LABEL9/A40 = 'Amtrak miles per year                  ';
LABEL10/A40 = 'Amtrak miles per month (average)      ';
LABEL11/A40 = 'Car rental miles per year             ';
LABEL12/A40 = 'Car rental miles per month (average)  ';
LABEL13/A40 = 'Amtrak miles per trip (average)       ';
LABEL14/A40 = '                                      ';
NOMTH/D3 = IF LEVEL_DESC NE LAST LEVEL_DESC THEN NOMONTHS ELSE 0;
PNOMTH/D3 = IF LEVEL_DESC NE LAST LEVEL_DESC THEN PNOMONTHS ELSE 0;
END
TABLE FILE CBNAIR2
SUM  LABEL1 LABEL2 LABEL3 LABEL4 LABEL5 LABEL6 LABEL7 LABEL8 LABEL9 LABEL10 LABEL11 LABEL12 LABEL13 LABEL14
     YNET_TKT/D12CS YMILES/D12CS YTON_C02/D12.2CS PYNET_TKT/D12CS PYMILES/D12CS PYTON_C02/D12.2CS NOMTH PNOMTH DATE P_DATE
COMPUTE YMAVG/D12 = IF ((NOMTH LT 1) AND (NOMTH GT (-1))) THEN 0 ELSE (YMILES/NOMTH); 
COMPUTE PYMAVG/D12 = IF ((PNOMTH LT 1) AND (PNOMTH GT (-1))) THEN 0 ELSE (PYMILES/PNOMTH); 
COMPUTE YMPTAVG/D12 = IF ((YNET_TKT LT 1) AND (YNET_TKT GT (-1))) THEN 0 ELSE (YMILES/YNET_TKT); 
COMPUTE PYMPTAVG/D12 = IF ((PYNET_TKT LT 1) AND (PYNET_TKT GT (-1))) THEN 0 ELSE (PYMILES/PYNET_TKT); 
COMPUTE YC02AVG/D12.2 = IF ((NOMTH LT 1) AND (NOMTH GT (-1))) THEN 0 ELSE (YTON_C02/NOMTH); 
COMPUTE PYC02AVG/D12.2 = IF ((PNOMTH LT 1) AND (PNOMTH GT (-1))) THEN 0 ELSE (PYTON_C02/PNOMTH); 
COMPUTE YTREE/D12 = IF ((YTON_C02 LT 1) AND (YTON_C02 GT (-1))) THEN 0 ELSE (YTON_C02*5); 
COMPUTE PYTREE/D12 = IF ((PYTON_C02 LT 1) AND (PYTON_C02 GT (-1))) THEN 0 ELSE (PYTON_C02*5); 
COMPUTE TREEAVG/D12 = IF ((NOMTH LT 1) AND (NOMTH GT (-1))) THEN 0 ELSE (YTREE/NOMTH); 
COMPUTE PTREEAVG/D12 = IF ((PNOMTH LT 1) AND (PNOMTH GT (-1))) THEN 0 ELSE (PYTREE/PNOMTH); 

BY LEVEL_DESC
ON TABLE HOLD AS CBNAIR3
END
-RUN

 
TABLE FILE CBNAIR2V
SUM YNET_TKT/D12CS AS '2VTKT'
    YMILES/D12CS AS '2VMILES'
    2VYTON_C02/D12.2CS
    PYNET_TKT/D12CS AS '2VPTKT'
    PYMILES/D12CS AS '2VPMILES'
    2VPYTON_C02/D12.2CS 
BY LEVEL_DESC
ON TABLE HOLD AS 2VAIR
END
-RUN

MATCH FILE CBNAIR3
PRINT LABEL1 LABEL2 LABEL3 LABEL4 LABEL5 LABEL6 LABEL7 LABEL8 LABEL9 LABEL10 LABEL11 LABEL12 LABEL13 LABEL14
     YNET_TKT YMILES YTON_C02 PYNET_TKT PYMILES PYTON_C02 NOMTH PNOMTH 
     YMAVG PYMAVG YMPTAVG  PYMPTAVG YC02AVG PYC02AVG DATE P_DATE YTREE PYTREE TREEAVG PTREEAVG
BY LEVEL_DESC
ON TABLE HOLD
RUN
FILE 2VAIR
SUM 2VTKT 2VMILES 2VPTKT 2VPMILES 2VYTON_C02 2VPYTON_C02  
BY LEVEL_DESC
AFTER MATCH HOLD AS CBNHOLD OLD-OR-NEW
END
-RUN
-IF &LINES EQ 0 THEN GOTO NORECORDS;


TABLE FILE CBNHOLD
PRINT LABEL1 LABEL2 LABEL3 LABEL4 LABEL5 LABEL6 LABEL7 LABEL8 LABEL9 LABEL10 LABEL11 LABEL12 LABEL13 LABEL14
     YNET_TKT YMILES YTON_C02 PYNET_TKT PYMILES PYTON_C02 NOMTH PNOMTH  YTREE PYTREE TREEAVG PTREEAVG
     YMAVG PYMAVG YMPTAVG  PYMPTAVG YC02AVG PYC02AVG
     2VTKT 2VMILES 2VPTKT 2VPMILES 2VYTON_C02 2VPYTON_C02 DATE P_DATE  
COMPUTE 2VYMAVG /D12 = IF ((NOMTH LT 1) AND (NOMTH GT (-1))) THEN 0 ELSE (2VMILES/NOMTH); 
COMPUTE 2VPYMAVG/D12 = IF ((PNOMTH LT 1) AND (PNOMTH GT (-1))) THEN 0 ELSE (2VPMILES/PNOMTH); 
COMPUTE 2VYMPTAVG /D12 = IF ((2VTKT LT 1) AND (2VTKT GT (-1))) THEN 0 ELSE (2VMILES/2VTKT); 
COMPUTE 2VPYMPTAVG /D12 = IF ((2VPTKT LT 1) AND (2VPTKT GT (-1))) THEN 0 ELSE (2VPMILES/2VPTKT); 
COMPUTE 2VYC02AVG /D12.2 = IF ((NOMTH LT 1) AND (NOMTH GT (-1))) THEN 0 ELSE (2VYTON_C02/NOMTH); 
COMPUTE 2VPYC02AVG/D12.2 = IF ((PNOMTH LT 1) AND (PNOMTH GT (-1))) THEN 0 ELSE (2VPYTON_C02/PNOMTH); 
COMPUTE MIDIF/D12 = YMILES - PYMILES;
COMPUTE MIPCT/D15.2 = IF ((YMILES LT 1) AND (YMILES GT (-1))) THEN 0 ELSE (((YMILES-PYMILES)/YMILES) * 100);
COMPUTE MAVGDIF/D12 = YMAVG - PYMAVG;
COMPUTE MAVGPCT/D15.2 = IF ((YMAVG LT 1) AND (YMAVG GT (-1))) THEN 0 ELSE (((YMAVG-PYMAVG)/YMAVG) * 100);

COMPUTE TRPDIF/D12 = YNET_TKT - PYNET_TKT;
COMPUTE TRPPCT/D15.2 = IF ((YNET_TKT LT 1) AND (YNET_TKT GT (-1))) THEN 0 ELSE (((YNET_TKT-PYNET_TKT)/YNET_TKT) * 100);
COMPUTE MPTDIF/D12 = YMPTAVG - PYMPTAVG;
COMPUTE MPTPCT/D15.2 = IF ((YMPTAVG LT 1) AND (YMPTAVG GT (-1))) THEN 0 ELSE (((YMPTAVG-PYMPTAVG)/YMPTAVG) * 100);

COMPUTE C02DIF/D12 = YTON_C02 - PYTON_C02;
COMPUTE C02PCT/D15.2 = IF ((YTON_C02 LT 1) AND (YTON_C02 GT (-1))) THEN 0 ELSE (((YTON_C02-PYTON_C02)/YTON_C02) * 100);
COMPUTE C02AVGDIF/D12 = YC02AVG - PYC02AVG;
COMPUTE C02AVGPCT/D15.2 = IF ((YC02AVG LT 1) AND (YC02AVG GT (-1))) THEN 0 ELSE (((YC02AVG-PYC02AVG)/YC02AVG) * 100);
COMPUTE TREEDIF/D12 = YTREE - PYTREE;
COMPUTE TREEPCT/D15.2 =  IF ((YTREE LT 1) AND (YTREE GT (-1))) THEN 0 ELSE (((YTREE-PYTREE)/YTREE) * 100);
COMPUTE TREEAVGDIF/D12 = TREEAVG - PTREEAVG;
COMPUTE TREEAVGPCT/D15.2 =  IF ((TREEAVG LT 1) AND (TREEAVG GT (-1))) THEN 0 ELSE (((TREEAVG-PTREEAVG)/TREEAVG) * 100);

-* 2v fields
COMPUTE 2VMDIF/D12 = 2VMILES - 2VPMILES;
COMPUTE 2VMPCT/D15.2 = IF ((2VMILES LT 1) AND (2VMILES GT (-1))) THEN 0 ELSE (((2VMILES-2VPMILES)/2VMILES) * 100);
COMPUTE 2VMAVGDIF/D12 = 2VYMAVG - 2VPYMAVG;
COMPUTE 2VMAVGPCT/D15.2 = IF ((2VYMAVG LT 1) AND (2VYMAVG GT (-1))) THEN 0 ELSE (((2VYMAVG-2VPYMAVG)/2VYMAVG) * 100);

COMPUTE 2VTRPDIF/D12 = 2VTKT - 2VPTKT;
COMPUTE 2VTRPPCT/D15.2 = IF ((2VTKT LT 1) AND (2VTKT GT (-1))) THEN 0 ELSE (((2VTKT-2VPTKT)/2VTKT) * 100);
COMPUTE 2VMPTDIF/D12 = 2VYMPTAVG - 2VPYMPTAVG;
COMPUTE 2VMPTPCT/D15.2 = IF ((2VYMPTAVG LT 1) AND (2VYMPTAVG GT (-1))) THEN 0 ELSE (((2VYMPTAVG-2VPYMPTAVG)/2VYMPTAVG) * 100);

COMPUTE 2VC02DIF/D12 = 2VYTON_C02 - 2VPYTON_C02;
COMPUTE 2VC02PCT/D15.2 = IF ((2VYTON_C02 LT 1) AND (2VYTON_C02 GT (-1))) THEN 0 ELSE (((2VYTON_C02-2VPYTON_C02)/2VYTON_C02) * 100);
COMPUTE 2VC02AVGDIF/D12 = 2VYC02AVG - 2VPYC02AVG;
COMPUTE 2VC02AVGPCT/D15.2 = IF ((2VYC02AVG LT 1) AND (2VYC02AVG GT (-1))) THEN 0 ELSE (((2VYC02AVG-2VPYC02AVG)/2VYC02AVG) * 100);
COMPUTE 2VYTREE/D12 = IF ((2VYTON_C02 LT 1) AND (2VYTON_C02 GT (-1))) THEN 0 ELSE (2VYTON_C02*5); 
COMPUTE 2VPYTREE/D12 = IF ((2VPYTON_C02 LT 1) AND (2VPYTON_C02 GT (-1))) THEN 0 ELSE (2VPYTON_C02*5); 
COMPUTE 2VTREEAVG/D12 = IF ((NOMTH LT 1) AND (NOMTH GT (-1))) THEN 0 ELSE (2VYTREE/NOMTH); 
COMPUTE 2VPTREEAVG/D12 = IF ((PNOMTH LT 1) AND (PNOMTH GT (-1))) THEN 0 ELSE (2VPYTREE/PNOMTH); 

COMPUTE 2VTREEDIF/D12 = 2VYTREE - 2VPYTREE;
COMPUTE 2VTREEPCT/D15.2 =  IF ((2VYTREE LT 1) AND (2VYTREE GT (-1))) THEN 0 ELSE (((2VYTREE-2VPYTREE)/2VYTREE) * 100);
COMPUTE 2VTREEAVGDIF/D12 = 2VTREEAVG - 2VPTREEAVG;
COMPUTE 2VTREEAVGPCT/D15.2 =  IF ((2VTREEAVG LT 1) AND (2VTREEAVG GT (-1))) THEN 0 ELSE (((2VTREEAVG-2VPTREEAVG)/2VTREEAVG) * 100);

BY LEVEL_DESC
ON TABLE HOLD AS CBNHOLD2
END
-RUN


TABLE FILE CBNHOLD2
PRINT LABEL1 LABEL2 LABEL3 LABEL4 LABEL5 LABEL6 LABEL7 LABEL8 LABEL9 LABEL10 LABEL11 LABEL12 LABEL13 LABEL14
     YNET_TKT YMILES YTON_C02 PYNET_TKT PYMILES PYTON_C02 NOMTH PNOMTH  
     YMAVG PYMAVG YMPTAVG  PYMPTAVG YC02AVG PYC02AVG
     YTREE PYTREE TREEAVG PTREEAVG TREEDIF TREEPCT TREEAVGDIF TREEAVGPCT
     MIDIF MIPCT MAVGDIF MAVGPCT TRPDIF TRPPCT MPTDIF MPTPCT C02DIF C02PCT C02AVGDIF C02AVGPCT
     2VTKT 2VMILES 2VPTKT 2VPMILES 2VYTON_C02 2VPYTON_C02 2VMDIF 2VMPCT 2VMAVGDIF 2VMAVGPCT
     2VTRPDIF 2VTRPPCT 2VMPTDIF 2VMPTPCT 2VC02DIF 2VC02PCT 2VC02AVGDIF 2VC02AVGPCT
     2VYMAVG 2VPYMAVG 2VYMPTAVG 2VPYMPTAVG 2VYC02AVG 2VPYC02AVG 2VYTREE 2VPYTREE 2VTREEAVG 2VPTREEAVG
     2VTREEDIF 2VTREEPCT 2VTREEAVGDIF 2VTREEAVGPCT
BY LEVEL_DESC
ON TABLE HOLD AS CBNHOLD3
END
-RUN
 

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AIR';
CAT_ORDER/I2 = 1;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND YMILES/D12 AS 'CURYR' AND
PYMILES/D12 AS 'PRYR' AND MIDIF/D12 AS 'DIFF' MIPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 1;
ON TABLE HOLD AS MILES
END
-RUN

TABLE FILE MILES
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS MILES2
END
MODIFY FILE CBN_OFF
FIXFORM FROM MILES2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON MILES2
END
-RUN

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AIR';
CAT_ORDER/I2 = 1;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND YMAVG/D12 AS 'CURYR' AND
PYMAVG/D12 AS 'PRYR' AND MAVGDIF/D12 AS 'DIFF' MAVGPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 2;
ON TABLE HOLD AS MONMILES
END
-RUN

TABLE FILE MONMILES
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS MONMILES2
END
MODIFY FILE CBN_OFF
FIXFORM FROM MONMILES2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON MONMILES2
END
-RUN
 

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AIR';
CAT_ORDER/I2 = 1;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND YNET_TKT/D12 AS 'CURYR' AND
PYNET_TKT/D12 AS 'PRYR' AND TRPDIF/D12 AS 'DIFF' TRPPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 3;
ON TABLE HOLD AS TRIPS
END
-RUN

TABLE FILE TRIPS
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS TRIPS2
END
MODIFY FILE CBN_OFF
FIXFORM FROM TRIPS2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON TRIPS2
END
-RUN

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AIR';
CAT_ORDER/I2 = 1;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND YMPTAVG/D12 AS 'CURYR' AND
PYMPTAVG/D12 AS 'PRYR' AND MPTDIF/D12 AS 'DIFF' MPTPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 4;
ON TABLE HOLD AS TRIPMILES
END
-RUN

TABLE FILE TRIPMILES
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS TRIPMILES2
END
MODIFY FILE CBN_OFF
FIXFORM FROM TRIPMILES2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON TRIPMILES2
END
-RUN
 
DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AIR';
CAT_ORDER/I2 = 1;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND YTON_C02/D12 AS 'CURYR' AND
PYTON_C02/D12 AS 'PRYR' AND C02DIF/D12 AS 'DIFF' C02PCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 5;
ON TABLE HOLD AS YRC02
END
-RUN

TABLE FILE YRC02
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS YRC02A
END
MODIFY FILE CBN_OFF
FIXFORM FROM YRC02A
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON YRC02A
END
-RUN
 
  
DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AIR';
CAT_ORDER/I2 = 1;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND YC02AVG/D12 AS 'CURYR' AND
PYC02AVG/D12 AS 'PRYR' AND C02AVGDIF/D12 AS 'DIFF' C02AVGPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 6;
ON TABLE HOLD AS MTHC02
END
-RUN

TABLE FILE MTHC02
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS MTHC02A
END
MODIFY FILE CBN_OFF
FIXFORM FROM MTHC02A
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON MTHC02A
END
-RUN


DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AIR';
CAT_ORDER/I2 = 1;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND  YTREE/D12 AS 'CURYR' AND
PYTREE/D12 AS 'PRYR' AND TREEDIF/D12 AS 'DIFF' TREEPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 7;
ON TABLE HOLD AS YEARTREE
END
-RUN

TABLE FILE YEARTREE
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS YEARTREE2
END
MODIFY FILE CBN_OFF
FIXFORM FROM YEARTREE2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON YEARTREE2
END
-RUN 

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AIR';
CAT_ORDER/I2 = 1;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND  TREEAVG/D12 AS 'CURYR' AND
PTREEAVG/D12 AS 'PRYR' AND TREEAVGDIF/D12 AS 'DIFF' TREEAVGPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 8;
ON TABLE HOLD AS MTHTREE
END
-RUN

TABLE FILE MTHTREE
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS MTHTREE2
END
MODIFY FILE CBN_OFF
FIXFORM FROM MTHTREE2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON MTHTREE2
END
-RUN 

-*-GOTO SkipBlank
DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AIR';
CAT_ORDER/I2 = 1;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL14/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2  
COMPUTE ROW_ORDER/I2 = 9;
ON TABLE HOLD AS AIRBLANK
END
-RUN

TABLE FILE AIRBLANK
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER 
ON TABLE HOLD AS AIRBLANK2
END
MODIFY FILE CBN_OFF
FIXFORM FROM AIRBLANK2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON AIRBLANK2
END
-RUN 
-*-SkipBlank
-* Amtrak

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AMTRAK';
CAT_ORDER/I2 = 2;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND 2VMILES/D12 AS 'CURYR' AND
2VPMILES/D12 AS 'PRYR' AND 2VMDIF/D12 AS 'DIFF' 2VMPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 1;
ON TABLE HOLD AS 2VMILES
END
-RUN

TABLE FILE 2VMILES
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS 2VMILES2
END
MODIFY FILE CBN_OFF
FIXFORM FROM 2VMILES2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON 2VMILES2
END
-RUN

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AMTRAK';
CAT_ORDER/I2 = 2;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND 2VYMAVG/D12 AS 'CURYR' AND
2VPYMAVG/D12 AS 'PRYR' AND 2VMAVGDIF/D12 AS 'DIFF' 2VMAVGPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 2;
ON TABLE HOLD AS 2VMONMILES
END
-RUN

TABLE FILE 2VMONMILES
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS 2VMONMILES2
END
MODIFY FILE CBN_OFF
FIXFORM FROM 2VMONMILES2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON 2VMONMILES2
END
-RUN
 

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AMTRAK';
CAT_ORDER/I2 = 2;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND 2VTKT/D12 AS 'CURYR' AND
2VPTKT/D12 AS 'PRYR' AND 2VTRPDIF/D12 AS 'DIFF' 2VTRPPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 3;
ON TABLE HOLD AS 2VTRIPS
END
-RUN

TABLE FILE 2VTRIPS
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS 2VTRIPS2
END
MODIFY FILE CBN_OFF
FIXFORM FROM 2VTRIPS2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON 2VTRIPS2
END
-RUN

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AMTRAK';
CAT_ORDER/I2 = 2;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL13/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND 2VYMPTAVG/D12 AS 'CURYR' AND
2VPYMPTAVG/D12 AS 'PRYR' AND 2VMPTDIF/D12 AS 'DIFF' 2VMPTPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 4;
ON TABLE HOLD AS 2VTPMIL
END
-RUN

TABLE FILE 2VTPMIL
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS 2VTPMIL2
END
MODIFY FILE CBN_OFF
FIXFORM FROM 2VTPMIL2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON 2VTPMIL2
END
-RUN
 
DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AMTRAK';
CAT_ORDER/I2 = 2;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND 2VYTON_C02/D12 AS 'CURYR' AND
2VPYTON_C02/D12 AS 'PRYR' AND 2VC02DIF/D12 AS 'DIFF' 2VC02PCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 5;
ON TABLE HOLD AS 2VYRC02
END
-RUN

TABLE FILE 2VYRC02
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS 2VYRC02A
END
MODIFY FILE CBN_OFF
FIXFORM FROM 2VYRC02A
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON 2VYRC02A
END
-RUN
 
  
DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AMTRAK';
CAT_ORDER/I2 = 2;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND 2VYC02AVG/D12 AS 'CURYR' AND
2VPYC02AVG/D12 AS 'PRYR' AND 2VC02DIF/D12 AS 'DIFF' 2VC02PCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 6;
ON TABLE HOLD AS 2VMTHC02
END
-RUN

TABLE FILE 2VMTHC02
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS 2VMTHC02A
END
MODIFY FILE CBN_OFF
FIXFORM FROM 2VMTHC02A
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON 2VMTHC02A
END
-RUN


DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AMTRAK';
CAT_ORDER/I2 = 2;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND  2VYTREE/D12 AS 'CURYR' AND
2VPYTREE/D12 AS 'PRYR' AND 2VTREEDIF/D12 AS 'DIFF' 2VTREEPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 7;
ON TABLE HOLD AS 2VYEARTREE
END
-RUN

TABLE FILE 2VYEARTREE
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS 2VYEARTREE2
END
MODIFY FILE CBN_OFF
FIXFORM FROM 2VYEARTREE2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON 2VYEARTREE2
END
-RUN 

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AMTRAK';
CAT_ORDER/I2 = 2;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND  2VTREEAVG/D12 AS 'CURYR' AND
2VPTREEAVG/D12 AS 'PRYR' AND 2VTREEAVGDIF/D12 AS 'DIFF' 2VTREEAVGPCT/D15.2 AS 'IDPERCENT' AND 
COMPUTE ROW_ORDER/I2 = 8;
ON TABLE HOLD AS 2VMNTREE
END
-RUN

TABLE FILE 2VMNTREE
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND
      CURYR AND PRYR AND DIFF AND IDPERCENT
ON TABLE HOLD AS 2VMNTREE2
END
MODIFY FILE CBN_OFF
FIXFORM FROM 2VMNTREE2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON 2VMNTREE2
END
-RUN  

-*-GOTO SkipAblank
DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'AMTRAK';
CAT_ORDER/I2 = 2;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL14/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 
COMPUTE ROW_ORDER/I2 = 9;
ON TABLE HOLD AS AMTRKBLANK
END
-RUN

TABLE FILE AMTRKBLANK
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER 
ON TABLE HOLD AS AMTRKBLANK2
END
MODIFY FILE CBN_OFF
FIXFORM FROM AMTRKBLANK2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON AMTRKBLANK2
END
-RUN 

-*-SkipAblank
-* Car
 
DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'CAR RENTAL';
CAT_ORDER/I2 = 3;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 
COMPUTE ROW_ORDER/I2 = 1;
ON TABLE HOLD AS CARMILES
END
-RUN

TABLE FILE CARMILES
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER
ON TABLE HOLD AS CARMILES2
END
MODIFY FILE CBN_OFF
FIXFORM FROM CARMILES2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON CARMILES2
END
-RUN

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'CAR RENTAL';
CAT_ORDER/I2 = 3;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 
COMPUTE ROW_ORDER/I2 = 2;
ON TABLE HOLD AS CARMIL2
END
-RUN

TABLE FILE CARMIL2
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER
ON TABLE HOLD AS CARMIL3
END
MODIFY FILE CBN_OFF
FIXFORM FROM CARMIL3
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON CARMIL3
END
-RUN

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'CAR RENTAL';
CAT_ORDER/I2 = 3;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 
COMPUTE ROW_ORDER/I2 = 3;
ON TABLE HOLD AS CARYREM 
END
-RUN

TABLE FILE CARYREM
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER
ON TABLE HOLD AS CARYREM2
END
MODIFY FILE CBN_OFF
FIXFORM FROM CARYREM2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON CARYREM2
END
-RUN

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'CAR RENTAL';
CAT_ORDER/I2 = 3;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 
COMPUTE ROW_ORDER/I2 = 4;
ON TABLE HOLD AS CARMEM
END
-RUN

TABLE FILE CARMEM
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER
ON TABLE HOLD AS CARMEM2
END
MODIFY FILE CBN_OFF
FIXFORM FROM CARMEM2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON CARMEM2
END
-RUN

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'CAR RENTAL';
CAT_ORDER/I2 = 3;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 
COMPUTE ROW_ORDER/I2 = 5;
ON TABLE HOLD AS CARYRTREE 
END 
-RUN

TABLE FILE CARYRTREE
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER
ON TABLE HOLD AS CARYRTREE2
END
MODIFY FILE CBN_OFF
FIXFORM FROM CARYRTREE2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON CARYRTREE2
END
-RUN

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'CAR RENTAL';
CAT_ORDER/I2 = 3;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 
COMPUTE ROW_ORDER/I2 = 6;
ON TABLE HOLD AS CARMTREE 
END 
-RUN

TABLE FILE CARMTREE
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER
ON TABLE HOLD AS CARMTREE2
END
MODIFY FILE CBN_OFF
FIXFORM FROM CARMTREE2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON CARMTREE2
END
-RUN
-*-GOTO SkipCblank

DEFINE FILE CBNHOLD3
CATEGORY/A18 = 'CAR RENTAL';
CAT_ORDER/I2 = 3;
END
TABLE FILE CBNHOLD3
PRINT CATEGORY/A18 AND LABEL14/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 
COMPUTE ROW_ORDER/I2 = 7;
ON TABLE HOLD AS CARBLANK
END 
-RUN

TABLE FILE CARBLANK
PRINT CATEGORY ROW_LABEL AND CAT_ORDER AND ROW_ORDER
ON TABLE HOLD AS CARBLANK2
END
MODIFY FILE CBN_OFF
FIXFORM FROM CARBLANK2
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON CARBLANK2
END
-RUN
-*
-*-SkipCblank

-SET &&RPTSUF = 'CBNOFF';
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');

-SET &CURLBL = 'YTD' | ' ' | '&CURYR.EVAL';
-SET &PRLBL = 'YTD' | ' ' | '&PRYR.EVAL';
-RUN

 

-INCLUDE FDEFRPTS
-RUN

 
-SET &&PAHDR  = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXLS'; 
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL'   ELSE &&DTSTY;
-*
DEFINE FILE CBN_OFF
 NOWTOD/A8 WITH CAT_ORDER = HHMMSS (NOWTOD);
END
-*
TABLE FILE CBN_OFF
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPCID;
" "
-NOSPCID;
PRINT CBN_OFF.ROW_LABEL AS ' '
      CBN_OFF.CURYR AS '&CURLBL.EVAL' 
      CBN_OFF.PRYR AS  '&PRLBL.EVAL' 
      CBN_OFF.DIFF AS 'Difference'
      CBN_OFF.IDPERCENT AS 'YTD % CHANGE'
  
BY CBN_OFF.CAT_ORDER NOPRINT
BY CBN_OFF.CATEGORY NOPRINT  
BY CBN_OFF.ROW_ORDER  NOPRINT
ON CBN_OFF.CAT_ORDER SUBHEAD
-*ON CBN_OFF.CATEGORY SKIP-LINE
-*" "
"<ST.CBN_OFF.CATEGORY"
-*
FOOTING BOTTOM
"Notes on CO2 emissions/offset calculator: The calculator is not designed to be 100% accurate as there are too many variables required in order to give a reliable emissions total."
"It is simply to give you an indication on how much carbon dioxide you generate."
"Carbonfund.org used for carbon calcuations"
"Post-trip Reporting &DATE AT <NOWTOD  &&FOOTR"

ON TABLE SET PAGE-NUM OFF
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE NOTOTAL
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=1.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=1.000000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=DATA,FONT=TIMES NEW ROMAN, SIZE=8, COLOR=BLACK, 
    BACKCOLOR=NONE, GRID=ON, STYLE=NORMAL, $
    TYPE=REPORT, COLUMN=N4, WRAP= 2.0,$
    TYPE=REPORT, COLUMN=N5, WRAP= 1.25,$
    TYPE=REPORT, COLUMN=N6, WRAP= 1.25,$
    TYPE=REPORT, COLUMN=N7, WRAP= 1.25,$ 
    TYPE=REPORT, COLUMN=N8, WRAP= 1.25,$
    TYPE=REPORT, COLUMN=N9, WRAP= 1.25,$    
TYPE=TITLE, FONT=TIMES NEW ROMAN, SIZE=9, BACKCOLOR=RGB(128 255 255), $
-* TYPE=HEADING, FONT=TIMES NEW ROMAN, SIZE=9, LINE=5, BACKCOLOR=RGB(128 255 255), $

-* TYPE=HEADING, FONT=TIMES NEW ROMAN, SIZE=9, LINE=6, BACKCOLOR=RGB(128 255 255), $

TYPE=FOOTING, SIZE=6, $
TYPE=TITLE, SIZE=9, STYLE=BOLD+UNDERLINE, $
TYPE=HEADING, SIZE=9, STYLE=BOLD, FONT=TIMES NEW ROMAN,$
-*TYPE=REPORT, WRAP= 1,$
 
TYPE=SUBHEAD, FONT=TIMES NEW ROMAN, SIZE=9, BACKCOLOR=RGB(128 255 255), $

-* TYPE=REPORT, IMAGE=&&TNTPIC, POSITION=(&&TNTTRPOS), SIZE=(&&TNTTRSIZ), $
-* TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLTRPOS), SIZE=(&&ROLTRSIZ), $
TYPE=SUBTOTAL, SIZE=9, STYLE=BOLD, COLOR=BLACK, BACKCOLOR=RGB(128 255 255),$

TYPE=GRANDTOTAL, SIZE=9, STYLE=BOLD, COLOR=BLACK, BACKCOLOR=RGB(128 255 255),$
-*
-INCLUDE &&PASTYD
-*TYPE=FOOTING, LINE=4, STYLE=BOLD,POSITION=(&FTR_DATEPOS),$ 
-*
ENDSTYLE


&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
-*
END
-RUN

-GOTO XXIT;


-NORECORDS
-SET &&RPTSUF = 'MSG';
-INCLUDE FDEFRPTS
-RUN
JOIN SET_KEY IN BRPTINST TO SET_KEY IN BRPT_SET AS J1
DEFINE FILE BRPTINST
EMPTY/A35 = 'NO RECORDS FOUND FOR THIS SELECTION';
NOWTOD/A8 WITH INST_KEY = HHMMSS (NOWTOD);
END
TABLE FILE BRPTINST
-INCLUDE HEADAIR
PRINT EMPTY AS 'REPORT,MESSAGE' 
BY ROLLUP_CODE AS 'ROLLUP,CODE'
BY RPT_NAME AS 'REPORT,NAME'
BY SELECT_LEV AS 'BREAK,LEVEL'
IF INST_KEY EQ &&IKEY
IF RECORDLIMIT EQ 1
-INCLUDE FOOTERDT
ON TABLE SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET PAGE-NUM OFF
ON TABLE SET STYLE *
-INCLUDE &&DTSTY
-*
-*TYPE=FOOTING, LINE=4, STYLE=BOLD,POSITION=(&FTR_DATEPOS),$ 
-*
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN



-XXIT

