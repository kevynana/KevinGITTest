SET ASNAMES = ON

-GOTO HTL;
JOIN AIR_KEY IN A_NATIX TO AIR_KEY IN S_NATIX AS J1

TABLE FILE A_NATIX
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF LEVEL1 CONTAINS 'GAUS146-53'

ON TABLE HOLD
END
-RUN



TABLE FILE HOLD
PRINT AIR_KEY
BY AIR_KEY NOPRINT
ON TABLE HOLD AS AIRHOLD
END
-RUN



MODIFY FILE S_NATIX
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='GAUS';
ON MATCH COMPUTE AROLL_LEV4='OTHER GAUS';
ON MATCH COMPUTE AROLL_LEV5='GAUS146';
ON MATCH COMPUTE AROLL_LEV6='GAUS146';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN AIR_KEY IN D_NATIX TO AIR_KEY IN A_NATIX AS J1
TABLE FILE D_NATIX
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF LEVEL1 CONTAINS 'GAUS146-53'

ON TABLE HOLD
END
-RUN

 

MODIFY FILE D_NATIX
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='GAUS';
ON MATCH COMPUTE AROLL_LEV4='OTHER GAUS';
ON MATCH COMPUTE AROLL_LEV5='GAUS146';
ON MATCH COMPUTE AROLL_LEV6='GAUS146';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN AIR_KEY IN M_NATIX TO AIR_KEY IN A_NATIX AS J1
TABLE FILE M_NATIX
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF LEVEL1 CONTAINS 'GAUS146-53'

ON TABLE HOLD
END
-RUN

MODIFY FILE M_NATIX
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='GAUS';
ON MATCH COMPUTE AROLL_LEV4='OTHER GAUS';
ON MATCH COMPUTE AROLL_LEV5='GAUS146';
ON MATCH COMPUTE AROLL_LEV6='GAUS146';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

 

MODIFY FILE A_NATIX
FIXFORM FROM AIRHOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='GAUS146';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON AIRHOLD
END
-RUN


 
 

TABLE FILE C_NATIX
PRINT CAR_KEY  
BY CAR_KEY NOPRINT
IF INT_CODE CONTAINS 'GAUS-174-40'

ON TABLE HOLD AS CARHOLD
END
-RUN



MODIFY FILE C_NATIX
FIXFORM FROM CARHOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='DEFDEP';
ON MATCH COMPUTE AROLL_LEV4='DEFDEPS';
ON MATCH COMPUTE AROLL_LEV5='DEFDEP';
ON MATCH COMPUTE AROLL_LEV6='DEFDEP';
ON MATCH UPDATE LEVEL1
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CARHOLD
END
-RUN
GAIL-00-010	DEFDEP-010	00	010	NATIXB	DEFENT	DEFDEP		

-HTL

TABLE FILE H_NATIX
PRINT HTL_KEY  
BY HTL_KEY NOPRINT
IF INT_CODE CONTAINS 'NGAM-199'

ON TABLE HOLD AS HTLHOLD
END
-RUN



MODIFY FILE H_NATIX
FIXFORM FROM HTLHOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='NGAM199';
ON MATCH COMPUTE AROLL_LEV3='NGAM';
ON MATCH COMPUTE AROLL_LEV4='OTHER NGAM';
ON MATCH COMPUTE AROLL_LEV5='NGAM199';
ON MATCH COMPUTE AROLL_LEV6='NGAM199';
ON MATCH UPDATE LEVEL1
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HTLHOLD
END
-RUN

-XXIT