-*-INCLUDE SETECHO
-***************************************************************
-* Car data
-***************************************************************
-SET &GWHERE=IF '&&RUP.EVAL' EQ 'KIEWIT-R' THEN '-*' ELSE 'WHERE CATEGORY NE ' | '''' | 'GLOBAL' | '''';
 
USE CLEAR *
USE
&&USE_CAR AS CR_50
END
-RUN
 
DEFINE FILE CR_50
 RENTAL_COST/P15.2 = RENTAL_AMT;
 T_MONTH/YYM=INVOICE_DATE;
END
TABLE FILE CR_50
SUM NUM_DAYS AS CAR_DAYS
    RENTAL_COST
BY ROLLUP_CODE
BY T_MONTH AS MONTH
BY CATEGORY
BY VENDOR_CODE
BY PICKUP_CITY
&GWHERE.EVAL
ON TABLE SET ASNAMES ON
ON TABLE HOLD AS HLDCAR01
END
 
MODIFY FILE ROLLUP_SUMMARY
FIXFORM FROM HLDCAR01
MATCH ROLLUP_CODE MONTH CATEGORY VENDOR_CODE PICKUP_CITY
 ON NOMATCH INCLUDE
 ON MATCH UPDATE CAR_DAYS RENTAL_COST
DATA ON HLDCAR01
END
-RUN
