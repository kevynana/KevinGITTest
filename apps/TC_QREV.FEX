-* 10/26/2004 - STEVE - Changed VOIDS to include voided MCOs
-*04/20/10   DEB                CHANGED ORIG_SALE DEFINE
-*5/23/14    DEB   ADDED EX5 TO REFUND_TOTAL DEFINE
-*  08/23/2016  REJ  S-17914 Changes for ER5.
-*  12/29/2016  REJ  S-28553 Move ER5 My Reports to production.
-* 03/08/17 JEM S-22486 - updated position of header and footer NEW_HDR NEW_FTR

 
-INCLUDE SETECHO
 
 
CREATE FILE TCAREV
CREATE FILE TCCREV
CREATE FILE TCHREV
-RUN
 
-INCLUDE TCGETROLL
-RUN
 
-SET &CNT = 1;
-REPEAT Loop2 &TOTROLLS TIMES
-SET &&ROLL = &ROLL.&CNT;
EX TCAIRDB
-RUN
- IF &FOCERRNUM EQ 36 THEN GOTO IncLoop2;
 
EX TCQRAEX
-RUN
 
EX TCCARDB
-RUN
 
EX TCQRCEX
-RUN
 
EX TCHTLDB
-RUN
 
EX TCQRHEX
-RUN
 
-IncLoop2
-SET &CNT = &CNT + 1;
-Loop2
 
-INCLUDE SetParmtime
-RUN
 
-IF &&FROMAVRP NE 'Y' GOTO :AVSF0;
-INCLUDE AVRP_SUBFOOT
-:AVSF0
 
-**************************************************************
-* GET THE FINAL REPORT
-**************************************************************
DEFINE FILE TCAREV
CURRENT/A1 = IF TRN_DATE GE &&FROMDT.EVAL AND
                TRN_DATE LE &&TODT.EVAL THEN 'Y' ELSE 'N';
PRIOR/A1 =  IF TRN_DATE GE &&FXDATE.EVAL AND
               TRN_DATE LE &&TXDATE.EVAL THEN 'Y' ELSE 'N';
CP/A1 = IF TRN_DATE GE &&FROMDT.EVAL AND
           TRN_DATE LE &&TODT.EVAL THEN 'C' ELSE 'P';
 
END
 
TABLE FILE TCAREV
PRINT DISSAVINGS
  CURRENT
  CP
  DOC_TYPE
  DOD_TYPE
  EMBARK
  EX_FLAG
  EXCHG_SALE
  FARE_PAID
  INTL_DOM
  NET_TKT_CNT
  PRIOR
  RF_FLAG
  ROLLCD
  SEG_AMT
  SEG_COM
  SEG_COUNT
  SEG_NBR
  SEG_TAX
  TKT_NUM
  TKT_PURCH
  TRN_DATE
  VASAVINGS
  VOID_DATE
  VOID_STATUS
BY TKT_NUM
BY SEG_COUNT
ON TABLE HOLD AS TRANONE
END
-RUN
 
DEFINE FILE TRANONE
EXCH/A50 = 'Total Exchanges';
GRND/A50 = 'Total Transactions';
RFND/A50 = 'Total Refunds';
RFNDF/A50 = 'Dollar Amount of Refunds';
VOID/A50 = 'Total Voids';
VOIDF/A50 = 'Dollar Amount of Voids';
AIRF/A50 = 'Total Airline Spend';
NETT/A50 = 'Net Tickets';
TKTP/A50 = 'Tickets Issued';
VASAV/A50 = 'Contract Savings';
VSVPT/A50 = 'Savings Per Net Ticket Issued';
VSVPT1/A50 = 'Savings Per Net Tkt From Increased Contract Svgs';
PVSV/A50 = 'Percentage Savings Per Net Ticket';
AVGT/A50 = 'Domestic Average Ticket Cost';
AVGT1/A50 = 'International Average Ticket Cost';
LST/A50 = 'Lost Savings';
LSTPT/A50 = 'Lost Savings Per Net Ticket';
PCLST/A50 = 'Percentage Lost Savings Per Ticket';
PCLST1/A50 = 'Savings Per Net Ticket From Decreased LS';
 
EXMCOS/D9 = IF (EX_FLAG NE ' ') AND (DOC_TYPE EQ '1') THEN 1 ELSE 0;
FLAG/A1 = 'A';
FULL_RFNDS/D9 = IF ((VOID_DATE EQ 0) AND (RF_FLAG EQ 'F') AND (TKT_NUM
  NE LAST TKT_NUM) AND (SEG_COUNT LT 0)) THEN 1 ELSE 0;
PART_RFNDS/D9 = IF ((VOID_DATE EQ 0) AND (RF_FLAG EQ 'P') AND (TKT_NUM
  NE LAST TKT_NUM) AND (SEG_COUNT LE 0)) THEN 1 ELSE 0;
 
-*ORIG_SALE/D9 = IF (SEG_NBR EQ '01') AND (FARE_PAID GE 0) AND (SEG_COUNT
-* EQ 1) AND (EXCHG_SALE EQ ' ') THEN 1 ELSE IF (DOC_TYPE EQ '1') AND
-* (EX_FLAG EQ ' ') AND (EXCHG_SALE NE ' ') THEN 1 ELSE 0;
 
 
ORIG_SALE/D9 = IF (SEG_NBR EQ '01') AND (FARE_PAID GE 0) AND
     (SEG_COUNT EQ 1) AND (EXCHG_SALE EQ ' ') THEN 1 ELSE
     IF (DOC_TYPE EQ '1') AND (EX_FLAG EQ ' ') AND (EXCHG_SALE NE ' ') AND
     (RF_FLAG EQ ' ') THEN 1 ELSE 0;
 
REFUNDS/D9 = FULL_RFNDS + PART_RFNDS;
 
TKT_CNT/D8CS = IF (SEG_NBR EQ '01') AND (FARE_PAID GE 0) AND (SEG_COUNT
  EQ 1) THEN 1 ELSE 0;
 
VOIDS/D9 = IF (VOID_DATE NE 0) AND (SEG_COUNT EQ 1) AND (SEG_NBR EQ '01')
  	     THEN 1 ELSE IF (DOC_TYPE EQ '1' AND VOID_DATE NE 0)
	     THEN 1 ELSE 0;
 
-* Defines on previous DEFINEs
 
EXCHGS/D9 = IF (EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND (EMBARK
  NE 'DT1' OR 'RF1' OR 'FP3') THEN TKT_CNT ELSE
  IF (DOC_TYPE EQ '1') AND (EXCHG_SALE EQ 'E') THEN 0 ELSE
  IF (SEG_COUNT GE 0) AND (EXCHG_SALE NE ' ') THEN TKT_CNT ELSE 0;
REFUND_TOTAL/D12 = IF ((RF_FLAG EQ 'F' OR 'P') AND (EMBARK NE 'EX1' OR
  'FP2' OR 'EX5') AND (DOC_TYPE NE '1') AND (SEG_COUNT LE 0)) OR (EMBARK EQ 'RF1')
   THEN (FARE_PAID * (-1)) ELSE 0;
-* AND (SEG_COUNT LE 0)) OR (EMBARK EQ 'RF1') THEN (FARE_PAID * (-1))
TOT_ECNT/D9 = EXCHGS + EXMCOS;
TOT_TRANS/D9 = ORIG_SALE + VOIDS + TOT_ECNT + REFUNDS;
VOID_AMT/D12 = IF VOID_DATE NE 0 THEN FARE_PAID ELSE 0;
-* DEFINES ON PREVIOUS DEFINES TO DETERMINE CURRENT
CTOT_TRANS/D9CS = IF CURRENT EQ 'Y' THEN TOT_TRANS ELSE 0;
CVOIDS/D9CS = IF CURRENT EQ 'Y' THEN VOIDS ELSE 0;
CREFUNDS/D9CS = IF CURRENT EQ 'Y' THEN REFUNDS ELSE 0;
CTOT_ECNT/D9CS = IF CURRENT EQ 'Y' THEN TOT_ECNT ELSE 0;
CNET_TKT/D9CS = IF (VOID_DATE EQ 0) AND (CURRENT EQ 'Y') THEN NET_TKT_CNT ELSE 0;
CNTTKTD/D9CS = IF (VOID_DATE EQ 0) AND (CURRENT EQ 'Y') AND (INTL_DOM EQ 'D')
                  THEN NET_TKT_CNT ELSE 0;
CNTTKTI/D9CS = IF (VOID_DATE EQ 0) AND (CURRENT EQ 'Y') AND (INTL_DOM EQ 'I')
                  THEN NET_TKT_CNT ELSE 0;
CFARE/D12CSM = IF (VOID_DATE EQ 0) AND (CURRENT EQ 'Y') THEN FARE_PAID ELSE 0;
CFARED/D12CSM = IF (VOID_DATE EQ 0) AND (INTL_DOM EQ 'D') AND (CURRENT EQ 'Y')
                  THEN  FARE_PAID ELSE 0;
CFAREI/D12CSM = IF (VOID_DATE EQ 0) AND (INTL_DOM EQ 'I') AND (CURRENT EQ 'Y')
                  THEN FARE_PAID ELSE 0;
CTKTP/D9CS = IF (CURRENT EQ 'Y') THEN TKT_PURCH ELSE 0;
CVOIDF/D12CSM = IF CURRENT EQ 'Y' THEN VOID_AMT ELSE 0;
CREFUNDF/D12CSM = IF CURRENT EQ 'Y' THEN REFUND_TOTAL ELSE 0;
CVASAV/D12CSM = IF (VOID_DATE EQ 0) AND (CURRENT EQ 'Y') THEN VASAVINGS ELSE 0;
CLST/D12CSM = IF (VOID_DATE EQ 0) AND (CURRENT EQ 'Y') THEN DISSAVINGS ELSE 0;
-* DEFINES ON PREVIOUS DEFINES TO DETERMINE PRIOR
PTOT_TRANS/D9CS = IF PRIOR EQ 'Y' THEN TOT_TRANS ELSE 0;
PVOIDS/D9CS = IF PRIOR EQ 'Y' THEN VOIDS ELSE 0;
PREFUNDS/D9CS = IF PRIOR EQ 'Y' THEN REFUNDS ELSE 0;
PTOT_ECNT/D9CS = IF PRIOR EQ 'Y' THEN TOT_ECNT ELSE 0;
PNET_TKT/D9CS = IF (VOID_DATE EQ 0) AND (PRIOR EQ 'Y') THEN NET_TKT_CNT ELSE 0;
PNTTKTD/D9CS = IF (VOID_DATE EQ 0) AND (PRIOR EQ 'Y') AND (INTL_DOM EQ 'D')
                  THEN NET_TKT_CNT ELSE 0;
PNTTKTI/D9CS = IF (VOID_DATE EQ 0) AND (PRIOR EQ 'Y') AND (INTL_DOM EQ 'I')
                  THEN NET_TKT_CNT ELSE 0;
PFARE/D12CSM = IF (VOID_DATE EQ 0) AND (PRIOR EQ 'Y') THEN FARE_PAID ELSE 0;
PFARED/D12CSM = IF (VOID_DATE EQ 0) AND (INTL_DOM EQ 'D') AND (PRIOR EQ 'Y')
                  THEN  FARE_PAID ELSE 0;
PFAREI/D12CSM = IF (VOID_DATE EQ 0) AND (INTL_DOM EQ 'I') AND (PRIOR EQ 'Y')
                  THEN FARE_PAID ELSE 0;
PTKTP/D9CS = IF (PRIOR EQ 'Y') THEN TKT_PURCH ELSE 0;
PVOIDF/D12CSM = IF PRIOR EQ 'Y' THEN VOID_AMT ELSE 0;
PREFUNDF/D12CSM = IF PRIOR EQ 'Y' THEN REFUND_TOTAL ELSE 0;
PVASAV/D12CSM = IF (VOID_DATE EQ 0) AND (PRIOR EQ 'Y') THEN VASAVINGS ELSE 0;
PLST/D12CSM = IF (VOID_DATE EQ 0) AND (PRIOR EQ 'Y') THEN DISSAVINGS ELSE 0;
END
 
 
TABLE FILE TRANONE
SUM
  AIRF
  AVGT
  AVGT1
  CLST
  CREFUNDS
  CTOT_ECNT
  CTOT_TRANS
  CVOIDS
  CFARE
  CFARED
  CFAREI
  CNET_TKT
  CNTTKTD
  CNTTKTI
  CTKTP
  CVOIDF
  CREFUNDF
  CVASAV
  EXCHG_SALE
  EXCH
  EXMCOS
  FARE_PAID
  FULL_RFNDS
  PART_RFNDS
  GRND
  LST
  LSTPT
  NET_TKT_CNT
  NETT
  ORIG_SALE
  PCLST
  PCLST1
  PLST
  PTOT_TRANS
  PVOIDS
  PREFUNDS
  PTOT_ECNT
  PNET_TKT
  PNTTKTD
  PNTTKTI
  PFARE
  PFARED
  PFAREI
  PTKTP
  PVOIDF
  PVSV
  PREFUNDF
  PVASAV
  REFUNDS
  RFND
  RFNDF
  TKTP
  VOID
  VOIDS
  VOIDF
  VOID_DATE
  EXCHGS
  TOT_ECNT
  TOT_TRANS
  VASAV
  VSVPT
  VSVPT1
COMPUTE CVSVPT/P12.2CSM = IF ((CNET_TKT LT 1) AND (CNET_TKT GT (-1)))
                          THEN 0 ELSE (CVASAV/CNET_TKT);
COMPUTE PVSVPT/P12.2CSM = IF ((PNET_TKT LT 1) AND (PNET_TKT GT (-1)))
                          THEN 0 ELSE (PVASAV/PNET_TKT);
COMPUTE TVSVPT1/D12CM = ((CVSVPT - PVSVPT) * CNET_TKT);
COMPUTE PCTCVS/P12.1% = IF ((CFARE LT 1) AND (CFARE GT (-1))) THEN 0 ELSE
                          ((CVASAV/CFARE)*100);
COMPUTE PCTPVS/P12.1% = IF ((PFARE LT 1) AND (PFARE GT (-1))) THEN 0 ELSE
                          ((PVASAV/PFARE)*100);
COMPUTE CAVGD/P12.2CSM = IF ((CNTTKTD LT 1) AND (CNTTKTD GT (-1)))
                          THEN 0 ELSE (CFARED/CNTTKTD);
COMPUTE PAVGD/P12.2CSM = IF ((PNTTKTD LT 1) AND (PNTTKTD GT (-1)))
                          THEN 0 ELSE (PFARED/PNTTKTD);
COMPUTE CAVGI/P12.2CSM = IF ((CNTTKTI LT 1) AND (CNTTKTI GT (-1)))
                          THEN 0 ELSE (CFAREI/CNTTKTI);
COMPUTE PAVGI/P12.2CSM = IF ((PNTTKTI LT 1) AND (PNTTKTI GT (-1)))
                          THEN 0 ELSE (PFAREI/PNTTKTI);
COMPUTE CLSTPT/P12.2CSM = IF ((CNET_TKT LT 1) AND (CNET_TKT GT (-1)))
                         THEN 0 ELSE (CLST/CNET_TKT);
COMPUTE PLSTPT/P12.2CSM = IF ((PNET_TKT LT 1) AND (PNET_TKT GT (-1)))
                         THEN 0 ELSE (PLST/PNET_TKT);
COMPUTE CPCTLSV/P12.1% = IF ((CFARE LT 1) AND (CFARE GT (-1))) THEN 0 ELSE
                           ((CLST/CFARE)*100);
COMPUTE PPCTLSV/P12.1% = IF ((PFARE LT 1) AND (PFARE GT (-1))) THEN 0 ELSE
                           ((PLST/PFARE)*100);
COMPUTE TLST/D12CSM =  ((PLSTPT - CLSTPT)*CNET_TKT);
-* INCREASE DECREASE PERCENTAGE CALCULATIONS
IDFARE/P12.2% = IF ((PFARE LT 1) AND (PFARE GT (-1))) THEN 0 ELSE
                  (((CFARE-PFARE)/PFARE)*100);
IDTKTI/P12.2% = IF ((PTKTP LT 1) AND (PTKTP GT (-1))) THEN 0 ELSE
                  (((CTKTP-PTKTP)/PTKTP)*100);
IDTOTT/P12.2% = IF ((PTOT_TRAN LT 1) AND (PTOT_TRAN GT (-1))) THEN 0 ELSE
                  (((CTOT_TRAN-PTOT_TRAN)/PTOT_TRAN)*100);
IDNETT/P12.2% = IF ((PNET_TKT LT 1) AND (PNET_TKT GT (-1))) THEN 0 ELSE
                  (((CNET_TKT-PNET_TKT)/PNET_TKT)*100);
IDVSV/P12.2%= IF  ((PVASAV LT 1) AND (PVASAV GT (-1))) THEN 0 ELSE
                  (((CVASAV-PVASAV)/PVASAV)*100);
IDVSVPT/P12.2% = IF ((PVSVPT LT 1) AND (PVSVPT GT (-1))) THEN 0 ELSE
                   (((CVSVPT-PVSVPT)/PVSVPT)*100);
IDEXCH/P12.2% = IF ((PTOT_ECNT LT 1) AND (PTOT_ECNT GT (-1))) THEN 0 ELSE
                  (((CTOT_ECNT-PTOT_ECNT)/PTOT_ECNT)*100);
IDRFND/P12.2% = IF ((PREFUNDS LT 1) AND (PREFUNDS GT (-1))) THEN 0 ELSE
                  (((CREFUNDS-PREFUNDS)/PREFUNDS)*100);
IDRFF/P12.2% = IF ((PREFUNDF LT 1) AND (PREFUNDF GT (-1))) THEN 0 ELSE
                 (((CREFUNDF-PREFUNDF)/PREFUNDF)*100);
IDVOIDS/P12.2% = IF ((PVOIDS LT 1) AND (PVOIDS GT (-1))) THEN 0 ELSE
                   (((CVOIDS-PVOIDS)/PVOIDS)*100);
IDVOIDF/P12.2% = IF ((PVOIDF LT 1) AND (PVOIDF GT (-1))) THEN 0 ELSE
                   (((CVOIDF-PVOIDF)/PVOIDF)*100);
IDPCTVS/P12.2% = (PCTCVS-PCTPVS);
IDAVGD/P12.2% = IF ((PAVGD LT 1) AND (PAVGD GT (-1))) THEN 0 ELSE
                 (((CAVGD-PAVGD)/PAVGD)*100);
IDAVGI/P12.2% = IF ((PAVGI LT 1) AND (PAVGI GT (-1))) THEN 0 ELSE
                 (((CAVGI-PAVGI)/PAVGI)*100);
 
IDLST/P12.2% = IF ((PLST LT 1) AND (PLST GT (-1))) THEN 0 ELSE
                 (((CLST-PLST)/PLST)*100);
 
IDPCTLS/P12.2S% = (CPCTLSV-PPCTLSV);
BY ROLLCD
ON TABLE HOLD AS JHOLD
END
-RUN
 
TABLE FILE JHOLD
SUM AIRF
  AVGT
  AVGT1
  CLST
  CREFUNDS
  CTOT_ECNT
  CTOT_TRANS
  CVOIDS
  CFARE
  CFARED
  CFAREI
  CNET_TKT
  CNTTKTD
  CNTTKTI
  CTKTP
  CVOIDF
  CREFUNDF
  CVASAV
  EXCHG_SALE
  EXCH
  EXMCOS
  FARE_PAID
  FULL_RFNDS
  PART_RFNDS
  GRND
  LST
  LSTPT
  NET_TKT_CNT
  NETT
  ORIG_SALE
  PCLST
  PCLST1
  PLST
  PTOT_TRANS
  PVOIDS
  PREFUNDS
  PTOT_ECNT
  PNET_TKT
  PNTTKTD
  PNTTKTI
  PFARE
  PFARED
  PFAREI
  PTKTP
  PVOIDF
  PVSV
  PREFUNDF
  PVASAV
  REFUNDS
  RFND
  RFNDF
  TKTP
  VOID
  VOIDS
  VOIDF
  VOID_DATE
  EXCHGS
  TOT_ECNT
  TOT_TRANS
  VASAV
  VSVPT
  VSVPT1
  CVSVPT
  PVSVPT
  TVSVPT1
  PCTCVS
  PCTPVS
  CAVGD
  PAVGD
  CAVGI
  PAVGI
  CLSTPT
  PLSTPT
  CPCTLSV
  PPCTLSV
  TLST
 IDFARE
 IDTKTI
 IDTOTT
 IDNETT
 IDVSV
 IDVSVPT
 IDEXCH
 IDPCTLS
 IDRFND
 IDRFF
 IDVOIDS
 IDVOIDF
 IDPCTVS
 IDAVGD
 IDAVGI
 IDLST
COMPUTE IDPLSTPT/P12.2% = (CLSTPT-PLSTPT);
BY ROLLCD
ON TABLE HOLD AS JHOLD1
END
-RUN
 
TABLE FILE JHOLD1
SUM AIRF
  AVGT
  AVGT1
  CLST
  CREFUNDS
  CTOT_ECNT
  CTOT_TRANS
  CVOIDS
  CFARE
  CFARED
  CFAREI
  CNET_TKT
  CNTTKTD
  CNTTKTI
  CTKTP
  CVOIDF
  CREFUNDF
  CVASAV
  EXCHG_SALE
  EXCH
  EXMCOS
  FARE_PAID
  FULL_RFNDS
  PART_RFNDS
  GRND
  LST
  LSTPT
  NET_TKT_CNT
  NETT
  ORIG_SALE
  PCLST
  PCLST1
  PLST
  PTOT_TRANS
  PVOIDS
  PREFUNDS
  PTOT_ECNT
  PNET_TKT
  PNTTKTD
  PNTTKTI
  PFARE
  PFARED
  PFAREI
  PTKTP
  PVOIDF
  PVSV
  PREFUNDF
  PVASAV
  REFUNDS
  RFND
  RFNDF
  TKTP
  VOID
  VOIDS
  VOIDF
  VOID_DATE
  EXCHGS
  TOT_ECNT
  TOT_TRANS
  VASAV
  VSVPT
  VSVPT1
  CVSVPT
  PVSVPT
  TVSVPT1
  PCTCVS
  PCTPVS
  CAVGD
  PAVGD
  CAVGI
  PAVGI
  CLSTPT
  PLSTPT
  CPCTLSV
  PPCTLSV
  TLST
 IDFARE
 IDTKTI
 IDTOTT
 IDNETT
 IDPCTLS
 IDVSV
 IDVSVPT
 IDEXCH
 IDRFND
 IDRFF
 IDVOIDS
 IDVOIDF
 IDPCTVS
 IDAVGD
 IDAVGI
 IDLST
 IDPLSTPT
-*COMPUTE IDLSTPT1/P12.2 = ((IDPLSTPT/PLSTPT)*100);
COMPUTE IDLSTPT1/P12.2% = IF PLSTPT NE 0 THEN ((IDPLSTPT/PLSTPT)*100) ELSE 0;
BY ROLLCD
ON TABLE HOLD AS TRANTWO
END
-RUN
 
 
 
 
DEFINE FILE TCCREV
CURRENT/A1 = IF INVOICE_DATE GE &&FROMDT.EVAL AND
                INVOICE_DATE LE &&TODT.EVAL THEN 'Y' ELSE 'N';
PRIOR/A1 =  IF INVOICE_DATE GE &&FXDATE.EVAL AND
               INVOICE_DATE LE &&TXDATE.EVAL THEN 'Y' ELSE 'N';
END
 
TABLE FILE TCCREV
PRINT BOOKINGS
  CAR_DESC
  CAR_KEY
  CAR_RATE
  CAR_TYPE
  CURRENT
  DAILY_RATE
  MIDBOOK
  MID_DAYS
  NBR_DAYS
  PRIOR
  RENTAL_AMT
  RENTAL_DAYS
BY ROLLCD
ON TABLE HOLD AS CARTWO
END
-RUN
 
 
DEFINE FILE CARTWO
-* DEFINES FOR HEADINGS
CARDAY/A50 = 'Number of Car Rental Days';
CARAVG/A50 = 'Average Daily Car Rate';
CARMID/A50 = 'Midsize Usage';
CARBOOK/A50 = 'Number of Car Bookings';
 
-* DEFINES FOR CURRENT
CCDAY/D12CS = IF CURRENT EQ 'Y' THEN RENTAL_DAYS ELSE 0;
CCAMT/P12.2CSM = IF CURRENT EQ 'Y' THEN RENTAL_AMT ELSE 0;
CCMID/P12CS = IF CURRENT EQ 'Y' THEN MID_DAYS ELSE 0;
CCBOOK/D12CS = IF CURRENT EQ 'Y' THEN BOOKINGS ELSE 0;
 
-* DEFINES FOR PRIOR
PCDAY/D12CS = IF PRIOR EQ 'Y' THEN RENTAL_DAYS ELSE 0;
PCAMT/P12.2CSM = IF PRIOR EQ 'Y' THEN RENTAL_AMT ELSE 0;
PCMID/P12CS = IF PRIOR EQ 'Y' THEN MID_DAYS ELSE 0;
PCBOOK/D12CS = IF PRIOR EQ 'Y' THEN BOOKINGS ELSE 0;
END
 
TABLE FILE CARTWO
SUM CCDAY AS 'TCCDAY'
    PCDAY AS 'TPCDAY'
BY ROLLCD
ON TABLE HOLD AS CARMATCH
END
-RUN
 
TABLE FILE CARTWO
SUM CARBOOK
  CAR_DESC
  CAR_KEY
  CAR_RATE
  CAR_TYPE
  CURRENT
  CCBOOK
  DAILY_RATE
  MIDBOOK
  MID_DAYS
  NBR_DAYS
  PRIOR
  RENTAL_AMT
  RENTAL_DAYS
  PCBOOK
  CARDAY
  CARAVG
  CARMID
  CCDAY
  CCAMT
  CCMID
  PCDAY
  PCAMT
  PCMID
BY ROLLCD
ON TABLE HOLD AS CARMATCH1
END
-RUN
 
MATCH FILE CARMATCH1
PRINT CARBOOK
  CAR_DESC
  CAR_KEY
  CAR_RATE
  CAR_TYPE
  CURRENT
  CCBOOK
  PCBOOK
  DAILY_RATE
  MIDBOOK
  MID_DAYS
  NBR_DAYS
  PRIOR
  RENTAL_AMT
  RENTAL_DAYS
  CARDAY
  CARAVG
  CARMID
  CCDAY
  CCAMT
  CCMID
  PCDAY
  PCAMT
  PCMID
BY ROLLCD
ON TABLE HOLD
RUN
FILE CARMATCH
SUM TCCDAY
    TPCDAY
BY ROLLCD
AFTER MATCH HOLD AS CARMATCH2 OLD-OR-NEW
END
-RUN
 
TABLE FILE CARMATCH2
SUM CARBOOK
  CARAVG
  CARDAY
  CAR_DESC
  CAR_KEY
  CARMID
  CAR_RATE
  CAR_TYPE
  CCBOOK
  CCAMT
  CCDAY
  CCMID
  CURRENT
  DAILY_RATE
  MID_DAYS
  NBR_DAYS
  PCAMT
  PCDAY
  PCMID
  PCBOOK
  PRIOR
  RENTAL_AMT
  RENTAL_DAYS
COMPUTE CCAVG/P12.2CSM = IF ((CCDAY LT 1) AND (CCDAY GT (-1))) THEN 0 ELSE
                         (CCAMT/CCDAY);
COMPUTE PCAVG/P12.2CSM = IF ((PCDAY LT 1) AND (PCDAY GT (-1))) THEN 0 ELSE
                         (PCAMT/PCDAY);
COMPUTE CPCTMID/P12.2CSM = IF ((TCCDAY LT 1) AND (TCCDAY GT (-1))) THEN 0 ELSE
                           ((CCMID/TCCDAY)*100);
COMPUTE PPCTMID/P12.2S% = IF ((TPCDAY LT 1) AND (TPCDAY GT (-1))) THEN 0 ELSE
                           ((PCMID/TPCDAY)*100);
-* INCREASE DECREASE COMPUTE
COMPUTE IDCDAY/P12.2% = IF ((PCDAY LT 1) AND (PCDAY GT (-1))) THEN 0 ELSE
                         (((CCDAY-PCDAY)/PCDAY)*100);
COMPUTE IDCAVG/P12.2% = IF ((PCAVG LT 1) AND (PCAVG GT (-1))) THEN 0 ELSE
                         (((CCAVG-PCAVG)/PCAVG)*100);
COMPUTE IDCPCT/P12.2S% = (CPCTMID-PPCTMID);
 
COMPUTE IDCBOOK/P12.2% = IF ((PCBOOK LT 1) AND (PCBOOK GT (-1))) THEN 0 ELSE
                           (((CCBOOK-PCBOOK)/PCBOOK)*100);
 
BY ROLLCD
ON TABLE HOLD AS CARTTL
END
-RUN
 
DEFINE FILE TCHREV
CURRENT/A1 = IF INVOICE_DATE GE &&FROMDT.EVAL AND
                INVOICE_DATE LE &&TODT.EVAL THEN 'Y' ELSE 'N';
PRIOR/A1 =  IF INVOICE_DATE GE &&FXDATE.EVAL AND
               INVOICE_DATE LE &&TXDATE.EVAL THEN 'Y' ELSE 'N';
END
 
TABLE FILE TCHREV
PRINT CURRENT
  INT_DOM
  NBR_DAYS
  NBR_ROOMS
  NEW_TOTAL_AMT
  PRIOR
BY ROLLCD
ON TABLE HOLD AS HTLHLD1
END
-RUN
 
DEFINE FILE HTLHLD1
-* DEFINES FOR HEADINGS
HTLDAY/A50 = 'Number Of Hotel Nights';
HTLROOM/A50 = 'Number Of Rooms Booked';
HTLAVG/A50 = 'Average Hotel Rate Per Night';
DHTLAVG/A50 = 'Average Domestic Hotel Rate Per Night';
IHTLAVG/A50 = 'Average International Hotel Rate Per Night';
-* CURRENT
CHNGT/P12CS = IF CURRENT EQ 'Y' THEN NBR_DAYS ELSE 0;
CHDNGT/P12CS = IF (CURRENT EQ 'Y') AND (INT_DOM EQ 'D') THEN NBR_DAYS ELSE 0;
CHINGT/P12CS = IF (CURRENT EQ 'Y') AND (INT_DOM EQ 'I') THEN NBR_DAYS ELSE 0;
CHROOM/P12CS = IF CURRENT EQ 'Y' THEN NBR_ROOMS ELSE 0;
CHAMT/P12.2CSM = IF CURRENT EQ 'Y' THEN NEW_TOTAL_AMT ELSE 0;
CHDAMT/P12CSM = IF (CURRENT EQ 'Y') AND (INT_DOM EQ 'D') THEN
                 NEW_TOTAL_AMT ELSE 0;
CHIAMT/P12CSM = IF (CURRENT EQ 'Y') AND (INT_DOM EQ 'I') THEN
                 NEW_TOTAL_AMT ELSE 0;
 
-* PRIOR
PHNGT/P12CS = IF PRIOR EQ 'Y' THEN NBR_DAYS ELSE 0;
PHDNGT/P12CS = IF (PRIOR EQ 'Y') AND (INT_DOM EQ 'D') THEN NBR_DAYS ELSE 0;
PHINGT/P12CS = IF (PRIOR EQ 'Y') AND (INT_DOM EQ 'I') THEN NBR_DAYS ELSE 0;
PHROOM/P12CS = IF PRIOR EQ 'Y' THEN NBR_ROOMS ELSE 0;
PHAMT/P12.2CSM = IF PRIOR EQ 'Y' THEN NEW_TOTAL_AMT ELSE 0;
PHDAMT/P12.2CSM = IF (PRIOR EQ 'Y') AND (INT_DOM EQ 'D') THEN
                  NEW_TOTAL_AMT ELSE 0;
PHIAMT/P12.2CSM = IF (PRIOR EQ 'Y') AND (INT_DOM EQ 'I') THEN
                  NEW_TOTAL_AMT ELSE 0;
END
 
TABLE FILE HTLHLD1
SUM HTLDAY
HTLROOM
HTLAVG
DHTLAVG
IHTLAVG
CHNGT
CHROOM
CHAMT
PHNGT
PHROOM
PHAMT
COMPUTE CHAVG/P12.2CSM = IF ((CHNGT LT 1) AND (CHNGT GT (-1))) THEN 0 ELSE
                         (CHAMT/CHNGT);
COMPUTE CHDAVG/P12.2CSM= IF ((CHDNGT LT 1) AND (CHDNGT GT (-1))) THEN 0 ELSE
                         (CHDAMT/CHDNGT);
COMPUTE CHIAVG/P12.2CSM= IF ((CHINGT LT 1) AND (CHINGT GT (-1))) THEN 0 ELSE
                         (CHIAMT/CHINGT);
COMPUTE PHAVG/P12.2CSM = IF ((PHNGT LT 1) AND (PHNGT GT (-1))) THEN 0 ELSE
                         (PHAMT/PHNGT);
COMPUTE PHDAVG/P12.2CSM = IF ((PHDNGT LT 1) AND (PHDNGT GT (-1))) THEN 0 ELSE
                         (PHDAMT/PHDNGT);
COMPUTE PHIAVG/P12.2CSM = IF ((PHINGT LT 1) AND (PHINGT GT (-1))) THEN 0 ELSE
                         (PHIAMT/PHINGT);
 
-* INCREASE DECREASE COMPUTES
COMPUTE IDHNGT/P12.2% = IF ((PHNGT LT 1) AND (PHNGT GT (-1))) THEN 0 ELSE
                          (((CHNGT-PHNGT)/PHNGT)*100);
COMPUTE IDHRM/P12.2% = IF ((PHROOM LT 1) AND (PHROOM GT (-1))) THEN 0 ELSE
                         (((CHROOM-PHROOM)/PHROOM)*100);
COMPUTE IDHAVG/P12.2% = IF ((PHAVG LT 1) AND (PHAVG GT (-1))) THEN 0 ELSE
                          (((CHAVG-PHAVG)/PHAVG)*100);
COMPUTE IDHDAVG/P12.2% = IF ((PHDAVG LT 1) AND (PHDAVG GT (-1))) THEN 0 ELSE
                           ((CHDAVG-PHDAVG)/PHDAVG)*100;
COMPUTE IDHIAVG/P12.2% = IF ((PHIAVG LT 1) AND (PHIAVG GT (-1))) THEN 0 ELSE
                           ((CHIAVG-PHIAVG)/PHIAVG)*100;
BY ROLLCD
ON TABLE HOLD AS HTLTTL
END
-RUN
 
 
 
-SET &&RPTSUF = 'QTRREVIEW';
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXY=EDIT(&&FXDATE,'$9999');
-SET &TXM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXY=EDIT(&&TXDATE,'$9999');
-SET &&SP = '|';
-SET &&SP3 = IF &&ROLLCNCT EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP4 = IF &&ROLLPHN EQ ' ' THEN ' ' ELSE &&SP;
-SET &&RCNCT = &&ROLLCNCT.LENGTH;
-SET &&CSL = &&ROLLCS.LENGTH;
-SET &&CSLP = IF &&RCNCT.EVAL GE 10 OR &&CSL.EVAL GE 10 THEN 60 ELSE 68;
-SET &&ROLLCS11 = TRUNCATE(&&ROLLCS);
-SET &&RCNCT1 = TRUNCATE(&&ROLLCNCT);
-SET &&SUBHEAD = <ROLLCD;
-RUN
 
 
 
 
 
-INCLUDE FDEFRPTS
-RUN
 
JOIN TRANTWO.ROLLCD IN TRANTWO TO CARTTL.ROLLCD IN CARTTL AS J1
END
JOIN TRANTWO.ROLLCD IN TRANTWO TO HTLTTL.ROLLCD IN HTLTTL AS J2
END
-RUN
 
DEFINE FILE TRANTWO
NOWTOD/A8 WITH AIRF = HHMMSS (NOWTOD);
BLANK/A10 = '          ';
END
-RUN
 
-IF '&&SETF.EVAL' EQ 'TCSBQREV' THEN GOTO DEB;
 
TABLE FILE TRANTWO
SUM AIRF AS ''
CFARE AS '' PFARE AS ''  IDFARE AS ''
OVER TKTP AS ''
CTKTP AS ''         PTKTP AS ''         IDTKTI AS ''
OVER NETT AS ''
CNET_TKT AS ''      PNET_TKT AS ''      IDNETT AS ''
OVER EXCH AS ''
CTOT_ECNT AS ''     PTOT_ECNT AS ''     IDEXCH AS ''
OVER RFND AS ''
 CREFUNDS AS ''     PREFUNDS AS ''      IDRFND AS ''
OVER RFNDF AS ''
CREFUNDF AS ''      PREFUNDF AS ''      IDRFF AS ''
OVER VOID AS ''
 CVOIDS AS ''       PVOIDS AS ''        IDVOIDS AS ''
OVER VOIDF AS ''
CVOIDF AS ''        PVOIDF AS ''        IDVOIDF AS ''
OVER GRND AS ''
 CTOT_TRANS AS ''   PTOT_TRANS AS ''    IDTOTT AS ''
OVER VASAV AS ''
CVASAV AS ''        PVASAV AS ''        IDVSV AS ''
OVER VSVPT AS ''
CVSVPT AS ''        PVSVPT AS ''        IDVSVPT AS ''
OVER VSVPT1 AS ''
TVSVPT1 AS ''
OVER PVSV AS ''
PCTCVS AS ''        PCTPVS AS ''        IDPCTVS AS ''
OVER AVGT AS ''
CAVGD AS ''         PAVGD AS ''         IDAVGD AS ''
OVER AVGT1 AS ''
CAVGI AS ''         PAVGI AS ''         IDAVGI AS ''
OVER LST AS ''
CLST AS ''          PLST AS ''          IDLST AS ''
OVER LSTPT AS ''
CLSTPT AS ''        PLSTPT AS ''        IDLSTPT1 AS ''
OVER PCLST AS ''
CPCTLSV AS ''       PPCTLSV AS ''       IDPCTLS AS ''
OVER PCLST1 AS ''
TLST AS ''
OVER CARDAY AS ''
CCDAY AS ''         PCDAY AS ''         IDCDAY AS ''
OVER CARAVG AS ''
CCAVG AS ''          PCAVG AS ''        IDCAVG AS ''
OVER CARMID AS ''
CPCTMID AS ''       PPCTMID AS ''       IDCPCT AS ''
OVER CARBOOK AS ''
CCBOOK AS ''        PCBOOK AS ''        IDCBOOK AS ''
OVER HTLDAY AS ''
CHNGT AS ''         PHNGT AS ''         IDHNGT AS ''
OVER HTLROOM AS ''
CHROOM AS ''        PHROOMS AS ''       IDHRM AS ''
OVER HTLAVG AS ''
CHAVG AS ''         PHAVG AS ''         IDHAVG AS ''
OVER DHTLAVG AS ''
CHDAVG AS ''        PHDAVG AS ''        IDHDAVG AS ''
OVER IHTLAVG AS ''
CHIAVG AS ''        PHIAVG AS ''        IDHIAVG AS ''
BY ROLLCD NOPRINT
HEADING
"</4"
-* -INCLUDE TCHEADERDD
"&&DTDESC &FMM/&FMD/&FMY - &TOM/&TOD/&TOY <&&CSLP &&ROLLNME <+0> &&SP <+0> &&ROLLCS11 <+0> &&SP3 <+0> &&RCNCT1 <+0> &&SP4 <+0> &&ROLLPHN"
"Page:<TABPAGENO <10  &FXM/&FXD/&FXY - &TXM/&TXD/&TXY"
"<35 &&RPT_TTL1"
"<35 &&RPT_TTL2"
" "
"&&SUBHEAD <30 PERIOD1 <40 PERIOD2 <55 VAR %"
ON TABLE SET PAGE-NUM OFF
ON ROLLCD PAGE-BREAK
 
FOOTING BOTTOM
"&&FOOTER1"
"&&FOOTER2"
"<60 eTTek Review &DATE at <NOWTOD &&FOOTR"
 
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
 
ON TABLE SET STYLE *
-* -INCLUDE &&SMSTY
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.050000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT,FONT=ARIAL, SIZE=8, COLOR=BLACK,
    BACKCOLOR=NONE, STYLE=NORMAL, $
-* TYPE=HEADING, SIZE=8, STYLE=BOLD, JUSTIFY=LEFT, FONT='ARIAL', COLOR=RGB(70 136 177),$
-* TYPE=HEADING, LINE=4,  SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=6, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=7, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
 
TYPE=HEADING, LINE=8, SIZE=9, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=9, SIZE=9, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=11, SIZE=8, STYLE=BOLD, FONT='ARIAL', $
TYPE=SUBHEAD, SIZE=8, STYLE=BOLD, JUSTIFY=LEFT, FONT='ARIAL', COLOR=RGB(70 136 177),$
 
TYPE=FOOTING, SIZE=7, FONT='ARIAL', COLOR=RGB(70 136 177), $
TYPE=TABFOOTING, SIZE=7, FONT='ARIAL', COLOR=RGB(70 136 177),$
TYPE=TITLE, STYLE=BOLD, SIZE=8, $
TYPE=REPORT, COLUMN=N2, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N6, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N10, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N14, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N18, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N22, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N26, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N30, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N34, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N38, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N42, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N46, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N48, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N52, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N56, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N60, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N64, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N68, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N72, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N74, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N78, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N82, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N86, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N90, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N94, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N98, SQUEEZE=2.60, $
TYPE=REPORT, COLUMN=N102, SQUEEZE=2.60, BACKCOLOR=RGB(239 239 239),$
TYPE=REPORT, COLUMN=N106, SQUEEZE=2.60, $
 
 
TYPE=REPORT,COLUMN=N3,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N4,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N5,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N7,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N8,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N9,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N11,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N12,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N13,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N15,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N16,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N17,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N19,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N20,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N21,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N23,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N24,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N25,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N27,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N28,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N29,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N31,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N32,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N33,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N35,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N36,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N37,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N39,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N40,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N41,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N43,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N44,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N45,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N47,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N49,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N50,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N51,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N53,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N54,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N55,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N57,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N58,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N59,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N61,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N62,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N63,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N65,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N66,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N67,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N69,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N70,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N71,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N73,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N75,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N76,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N77,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N79,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N80,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N81,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N83,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N84,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N85,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N87,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N88,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N89,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N91,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N92,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N93,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N95,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N96,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N97,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N99,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N100,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N101,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N103,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N104,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N105,SQUEEZE=1.0, JUSTIFY=LEFT, BACKCOLOR=RGB(239 239 239), $
TYPE=REPORT,COLUMN=N107,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N108,SQUEEZE=1.0, JUSTIFY=LEFT, $
TYPE=REPORT,COLUMN=N109,SQUEEZE=1.0, JUSTIFY=LEFT, $
 
TYPE=DATA,
     GRID=OFF,
     COLUMN=N1,
$
 
TYPE=DATA,
     GRID=OFF,
     SIZE=8,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
$
 
 
 
TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0), SIZE=(2.8 .37),PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.0), SIZE=(10.5 .58), PRESERVERATIO=ON, $  
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&TNTDTPOS), SIZE=(&&ROLDTSIZ), $
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
-*
END
-RUN
 
-IF &LINES GT 0 THEN GOTO XXIT;
 
 
-DEB
 
 
TABLE FILE TRANTWO
 
SUM
CFARE AS 'Total,Airline,Spend,Period1'  PFARE AS 'Total,Airline,Spend,Period2'   IDFARE AS 'Total,Airline,Spend,Inc/Dec'
CTKTP AS 'Tickets,Issued,Period1'        PTKTP AS 'Tickets,Issued,Period2'          IDTKTI AS 'Tickets,Issued,Inc/Dec'
CNET_TKT AS '    Net,Tickets,Period1'      PNET_TKT AS '    Net,Tickets,Period2'       IDNETT AS '    Net,Tickets,Inc/Dec'
CTOT_ECNT AS 'Total,Exchanges,Period1'     PTOT_ECNT AS 'Total,Exchanges,Period2'       IDEXCH AS 'Total,Exchanges,Inc/Dec'
CREFUNDS AS 'Total,Refunds,Period1'    PREFUNDS AS 'Total,Refunds,Period2'        IDRFND AS 'Total,Refunds,Inc/Dec'
CREFUNDF AS 'Dollar,Amount,Refunds,Period1'    PREFUNDF AS 'Dollar,Amount,Refunds,Period2'        IDRFF AS 'Dollar,Amount,Refunds,Inc/Dec'
CVOIDS AS 'Total,Voids,Period1'       PVOIDS AS 'Total,Voids,Period2'         IDVOIDS AS 'Total,Voids,Inc/Dec'
CVOIDF AS 'Dollar,Amount,Voids,Period1'      PVOIDF AS 'Dollar,Amount,Voids,Period2'          IDVOIDF AS 'Dollar,Amount,Voids,Inc/Dec'
CTOT_TRANS AS 'Total,Trans-,actions,Period1'  PTOT_TRANS AS 'Total,Trans-,actions,Period2'      IDTOTT AS 'Total,Trans-,actions,Inc/Dec'
CVASAV AS 'Contract,Savings,Period1'       PVASAV AS 'Contract,Savings,Period2'         IDVSV AS 'Contract,Savings,Inc/Dec'
CVSVPT AS 'Svgs Per,Net Ticket,Issued,Period1'       PVSVPT AS 'Svgs Per,Net Ticket,Issued,Period2'          IDVSVPT AS 'Svgs Per,Net Ticket,Issued,Inc/Dec'
TVSVPT1 AS 'Svgs Per, Net Tkt,From Incr,Contract Svgs,'
PCTCVS AS 'Pct Svgs,Per Net,Ticket,Period1'      PCTPVS AS 'Pct Svgs,Per Net,Ticket,Period2'          IDPCTVS AS 'Pct Svgs,Per Net,Ticket,Inc/Dec'
CAVGD AS 'Dom Avg,Ticket,Cost,Period1'      PAVGD AS 'Dom Avg,Ticket,Cost,Period2'           IDAVGD AS 'Dom Avg,Ticket,Cost,Inc/Dec'
CAVGI AS 'Intl Avg,Ticket,Cost,Period1'       PAVGI AS 'Intl Avg,Ticket,Cost,Period2'           IDAVGI AS 'Intl Avg,Ticket,Cost,Inc/Dec'
CLST AS 'Lost,Savings,Period1'         PLST AS 'Lost,Savings,Period2'           IDLST AS 'Lost,Savings,Inc/Dec'
CLSTPT AS 'Lost Svgs,Per Net,Ticket,Period1'      PLSTPT AS 'Lost Svgs,Per Net,Ticket,Period2'         IDLSTPT1 AS 'Lost Svgs,Per Net,Ticket,Inc/Dec'
CPCTLSV AS 'Pct Lost,Svgs Per,Ticket,Period1'     PPCTLSV AS 'Pct Lost,Svgs Per,Ticket,Period2'         IDPCTLS AS 'Pct Lost,Svgs Per,Ticket,Inc/Dec'
TLST AS 'Svgs Per,Net Tkt,From,Decreased LS,'
CCDAY AS 'Nbr Car,Rental,Days,Period1'       PCDAY AS 'Nbr Car,Rental,Days,Period2'           IDCDAY AS 'Nbr Car,Rental,Days,Inc/Dec'
CCAVG AS 'Avg Daily,Car Rate,Period1'       PCAVG AS 'Avg Daily,Car Rate,Period2'          IDCAVG AS 'Avg Daily,Car Rate,Inc/Dec'
CPCTMID AS 'Midsize,Usage,Period1'      PPCTMID AS 'Midsize,Usage,Period2'         IDCPCT AS 'Midsize,Usage,Inc/Dec'
CCBOOK AS 'Nbr Car,Bookings,Period1'       PCBOOK AS 'Nbr Car,Bookings,Period2'          IDCBOOK AS 'Nbr Car,Bookings,Inc/Dec'
CHNGT AS 'Nbr Hotel,Nights,Period1'        PHNGT AS 'Nbr Hotel,Nights,Period2'           IDHNGT AS 'Nbr Hotel,Nights,Inc/Dec'
CHROOM AS 'Nbr Rooms, Booked,Period1'       PHROOMS AS 'Nbr Rooms, Booked,Period2'         IDHRM AS 'Nbr Rooms, Booked,Inc/Dec'
CHAVG AS 'Avg Htl Rate, Per Night,Period1'       PHAVG AS 'Avg Htl Rate, Per Night,Period2'           IDHAVG AS 'Avg Htl Rate, Per Night,Inc/Dec'
CHDAVG AS 'Avg Dom,Hotel,Rate,Period1'        PHDAVG AS 'Avg Dom,Hotel,Rate,Period2'         IDHDAVG AS 'Avg Dom,Hotel,Rate,Inc/Dec'
CHIAVG AS 'Avg Intl,Hotel,Rate,Period1'       PHIAVG AS 'Avg Intl,Hotel,Rate,Period2'         IDHIAVG AS 'Avg Intl,Hotel,Rate,Inc/Dec'
BY ROLLCD AS 'ROLLUP'
 
 
HEADING
"</3"
"&&DTDESC Period1:&FMM/&FMD/&FMY - &TOM/&TOD/&TOY <&&CSLP &&ROLLNME <+0> &&SP <+0> &&ROLLCS <+0> &&SP3 <+0> &&ROLLCNCT <+0> &&SP4 <+0> &&ROLLPHN"
"Period2: <10  &FXM/&FXD/&FXY - &TXM/&TXD/&TXY"
" "
"<35 &&RPT_TTL1"
"<35 &&RPT_TTL2"
"</2"
 
 
FOOTING BOTTOM
"eTTek Review &DATE AT <NOWTOD <60 &&FOOTR"
"Copyright (c) 1996-2003, Travel and Transport - Confidential/Proprietary"
 
ON TABLE SET PAGE-NUM OFF
-INCLUDE FOOTERSM
 
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
 
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=1.250000, RIGHTMARGIN=0.250000,
    TOPMARGIN=1.000000, BOTTOMMARGIN=0.250000, SQUEEZE=OFF,
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT,FONT=TIMES NEW ROMAN, SIZE=9, COLOR=BLACK,
    BACKCOLOR=NONE, STYLE=NORMAL, $
 
 
 
    TYPE=REPORT, COLUMN=N2, WRAP= .50,$
    TYPE=REPORT, COLUMN=N3, WRAP= .50,$
    TYPE=REPORT, COLUMN=N4, WRAP= .50,$
    TYPE=REPORT, COLUMN=N4, WRAP= .50,$
    TYPE=REPORT, COLUMN=N5, WRAP= .50,$
    TYPE=REPORT, COLUMN=N6, WRAP= .50,$
    TYPE=REPORT, COLUMN=N7, WRAP= .50,$
    TYPE=REPORT, COLUMN=N8, WRAP= .50,$
    TYPE=REPORT, COLUMN=N9, WRAP= .50,$
    TYPE=REPORT, COLUMN=N10, WRAP= .50,$
    TYPE=REPORT, COLUMN=N11, WRAP= .75,$
    TYPE=REPORT, COLUMN=N12, WRAP= .75,$
    TYPE=REPORT, COLUMN=N13, WRAP= .75,$
    TYPE=REPORT, COLUMN=N14, WRAP= .60,$
    TYPE=REPORT, COLUMN=N15, WRAP= .60,$
    TYPE=REPORT, COLUMN=N16, WRAP= .60,$
    TYPE=REPORT, COLUMN=N17, WRAP= .60,$
    TYPE=REPORT, COLUMN=N18, WRAP= .60,$
    TYPE=REPORT, COLUMN=N19, WRAP= .60,$
    TYPE=REPORT, COLUMN=N20, WRAP= .50,$
    TYPE=REPORT, COLUMN=N21, WRAP= .50,$
    TYPE=REPORT, COLUMN=N22, WRAP= .50,$
    TYPE=REPORT, COLUMN=N23, WRAP= .50,$
    TYPE=REPORT, COLUMN=N24, WRAP= .50,$
    TYPE=REPORT, COLUMN=N25, WRAP= .50,$
    TYPE=REPORT, COLUMN=N26, WRAP= .50,$
    TYPE=REPORT, COLUMN=N27, WRAP= .50,$
    TYPE=REPORT, COLUMN=N28, WRAP= .50,$
    TYPE=REPORT, COLUMN=N29, WRAP= .75,$
    TYPE=REPORT, COLUMN=N30, WRAP= .75,$
    TYPE=REPORT, COLUMN=N31, WRAP= .75,$
    TYPE=REPORT, COLUMN=N32, WRAP= .50,$
    TYPE=REPORT, COLUMN=N33, WRAP= .50,$
    TYPE=REPORT, COLUMN=N34, WRAP= .50,$
    TYPE=REPORT, COLUMN=N35, WRAP= .75,$
    TYPE=REPORT, COLUMN=N36, WRAP= .50,$
    TYPE=REPORT, COLUMN=N37, WRAP= .50,$
    TYPE=REPORT, COLUMN=N38, WRAP= .50,$
    TYPE=REPORT, COLUMN=N39, WRAP= .50,$
    TYPE=REPORT, COLUMN=N40, WRAP= .50,$
    TYPE=REPORT, COLUMN=N41, WRAP= .50,$
    TYPE=REPORT, COLUMN=N42, WRAP= .50,$
    TYPE=REPORT, COLUMN=N43, WRAP= .50,$
    TYPE=REPORT, COLUMN=N44, WRAP= .50,$
    TYPE=REPORT, COLUMN=N45, WRAP= .60,$
    TYPE=REPORT, COLUMN=N46, WRAP= .60,$
    TYPE=REPORT, COLUMN=N47, WRAP= .60,$
    TYPE=REPORT, COLUMN=N48, WRAP= .50,$
    TYPE=REPORT, COLUMN=N49, WRAP= .50,$
    TYPE=REPORT, COLUMN=N50, WRAP= .50,$
    TYPE=REPORT, COLUMN=N51, WRAP= .50,$
    TYPE=REPORT, COLUMN=N52, WRAP= .50,$
    TYPE=REPORT, COLUMN=N53, WRAP= .50,$
    TYPE=REPORT, COLUMN=N54, WRAP= .75,$
    TYPE=REPORT, COLUMN=N55, WRAP= .50,$
    TYPE=REPORT, COLUMN=N56, WRAP= .50,$
    TYPE=REPORT, COLUMN=N57, WRAP= .50,$
    TYPE=REPORT, COLUMN=N58, WRAP= .50,$
    TYPE=REPORT, COLUMN=N59, WRAP= .50,$
    TYPE=REPORT, COLUMN=N60, WRAP= .50,$
 
    TYPE=REPORT, COLUMN=N61, WRAP= .50,$
    TYPE=REPORT, COLUMN=N62, WRAP= .50,$
    TYPE=REPORT, COLUMN=N63, WRAP= .50,$
    TYPE=REPORT, COLUMN=N64, WRAP= .75,$
    TYPE=REPORT, COLUMN=N65, WRAP= .75,$
    TYPE=REPORT, COLUMN=N66, WRAP= .75,$
    TYPE=REPORT, COLUMN=N67, WRAP= .50,$
    TYPE=REPORT, COLUMN=N68, WRAP= .50,$
    TYPE=REPORT, COLUMN=N69, WRAP= .50,$
    TYPE=REPORT, COLUMN=N70, WRAP= .50,$
 
    TYPE=REPORT, COLUMN=N71, WRAP= .50,$
    TYPE=REPORT, COLUMN=N72, WRAP= .50,$
    TYPE=REPORT, COLUMN=N73, WRAP= .50,$
    TYPE=REPORT, COLUMN=N74, WRAP= .50,$
    TYPE=REPORT, COLUMN=N75, WRAP= .50,$
    TYPE=REPORT, COLUMN=N76, WRAP= .50,$
    TYPE=REPORT, COLUMN=N77, WRAP= .50,$
    TYPE=REPORT, COLUMN=N78, WRAP= .50,$
    TYPE=REPORT, COLUMN=N79, WRAP= .50,$
    TYPE=REPORT, COLUMN=N80, WRAP= .50,$
 
    TYPE=REPORT, COLUMN=N81, WRAP= .50,$
    TYPE=REPORT, COLUMN=N82, WRAP= .50,$
    TYPE=REPORT, COLUMN=N83, WRAP= .50,$
    TYPE=REPORT, COLUMN=N84, WRAP= .50,$
    TYPE=REPORT, COLUMN=N85, WRAP= .50,$
    TYPE=REPORT, COLUMN=N86, WRAP= .50,$
    TYPE=REPORT, COLUMN=N87, WRAP= .50,$
    TYPE=REPORT, COLUMN=N88, WRAP= .50,$
    TYPE=REPORT, COLUMN=N89, WRAP= .50,$
    TYPE=REPORT, COLUMN=N90, WRAP= .50,$
 
    TYPE=REPORT, COLUMN=N91, WRAP= .50,$
    TYPE=REPORT, COLUMN=N92, WRAP= .50,$
    TYPE=REPORT, COLUMN=N93, WRAP= .50,$
    TYPE=REPORT, COLUMN=N94, WRAP= .50,$
    TYPE=REPORT, COLUMN=N95, WRAP= .50,$
    TYPE=REPORT, COLUMN=N96, WRAP= .50,$
    TYPE=REPORT, COLUMN=N97, WRAP= .50,$
    TYPE=REPORT, COLUMN=N98, WRAP= .50,$
    TYPE=REPORT, COLUMN=N99, WRAP= .50,$
    TYPE=REPORT, COLUMN=N100, WRAP= .50,$
 
 
TYPE=HEADING, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$
TYPE=HEADING, LINE=8, SIZE=9, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=9, SIZE=9, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=SUBHEAD, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$
 
TYPE=FOOTING, SIZE=6, FONT='ARIAL', COLOR=RGB(70 136 177), $
TYPE=TABFOOTING, SIZE=6, FONT='ARIAL', COLOR=RGB(70 136 177),$
 
TYPE=TITLE, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
-* TYPE=SUBFOOT, SIZE=8, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=8, STYLE=BOLD, $
 
TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0), $
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.2), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&TNTDTPOS), SIZE=(&&ROLDTSIZ), $
 
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
-*
END
-RUN
 
 
 
 
-IF &LINES GT 0 THEN GOTO XXIT;
 
 
 
EX TCEMPTY
-RUN
-XXIT
 
