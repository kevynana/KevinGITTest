-*06/06/2017-JEM-S-34232-Creation for new report QBECBCFP

-*SET TEMPERASE = OFF
EX SETDBLS SETFILE=&&SETF
-RUN
-INCLUDE OTHPARMS
-INCLUDE SetParmtime
 
-SET &&DRILLABLE = 'N';
 
-SET &&RPT_HOLD = 'RPTHOLD';
-SET &OUTDEST = EDIT('&&OUTTO.EVAL','9$');
 
-SET &&OUTLINE1 = IF '&OUTDEST.EVAL' EQ 'E' OR '&OUTDEST.EVAL' EQ 'T'
- THEN 'ON TABLE SAVE AS SAVREP FORMAT EXL2K'
- ELSE 'ON TABLE PCHOLD FORMAT EXL2K';
-SET &&OUTLINE2 = '';
 
 
-* -INCLUDE SETPARMTIME


-**********************************************************************
-******LOCAL DEPLOYMENT
-IF &&DEPLOY EQ 'W' GOTO SETWEB;
-SET &&SETFNM= &&LOCPATH || &&DTTMSTRM ||'.FTM';
COPY &&SETF &&SETFNM
-RUN
 
-******WEB DEPLOYMENT
-SETWEB
-SET &&WEBPATH = '&&WEBSRV.EVAL' || '\TTWEB\ ' || &&ROLLUP || '\ '||&&UNAME.EVAL|| '\';
-SET &&SETFNM = &&WEBPATH || &&DTTMSTRM ||'.FTM';
 
COPY &&VARFWEB &&SETFNM
-INCLUDE SETFPARM
-RUN
 
 
FILEDEF AUSEINCL DISK &&AUSEPASS
-RUN
FILEDEF CUSEINCL DISK &&CUSEPASS
-RUN
FILEDEF HUSEINCL DISK &&HUSEPASS
-RUN
FILEDEF LUSEINCL DISK &&LUSEPASS
-RUN
 
-INCLUDE SELCATQT
-RUN
 
EX &&CATQTRPR
-RUN
 
FILEDEF AUSEINCL CLEAR
-RUN
FILEDEF CUSEINCL CLEAR
-RUN
FILEDEF HUSEINCL CLEAR
-RUN
FILEDEF LUSEINCL CLEAR
-RUN
 
-* SET EMPTYREPORT = ON
-* -RUN
 
-SET &&SMD = 'S';
-RUN
 
-IF &&FROMAVRP NE 'Y' GOTO :TA1;
-SET &&RPTGRP_OVERRIDE='AIR';
EX CODEGEN
-INCLUDE SELCATQT
-RUN
-:TA1
 
EX AIRUSE
-RUN
 
EX SELDESC2
-RUN
 
 
EX QBEAIREX
-RUN

-IF &&AIRREC EQ 'N' THEN GOTO NORECORDS;

FILEDEF AUSEINCL DISK &&AUSEPASS
-RUN
FILEDEF CUSEINCL DISK &&CUSEPASS
-RUN
FILEDEF HUSEINCL DISK &&HUSEPASS
-RUN
FILEDEF LUSEINCL DISK &&LUSEPASS
-RUN
 
-INCLUDE SELCATQT
-RUN
 
EX &&CATQTRPR
-RUN
 
FILEDEF AUSEINCL CLEAR
-RUN
FILEDEF CUSEINCL CLEAR
-RUN
FILEDEF HUSEINCL CLEAR
-RUN
FILEDEF LUSEINCL CLEAR
-RUN

-IF &&FROMAVRP NE 'Y' GOTO :TA1A;
-SET &&RPTGRP_OVERRIDE='AIR';
EX CODEGEN
-INCLUDE SELCATQT
-RUN
-:TA1A
 
EX AIRUSE
-RUN
 
EX SELDESC2
-RUN

EX QBEAIRDEX
-RUN


-SET &&RPTSUF = 'QBECBFP';
-INCLUDE FDEFRPTS
-RUN

 
-IF &&FROMAVRP NE 'Y' GOTO :AVSF0;
-INCLUDE OTHPARMS
-INCLUDE AVRP_SUBFOOT
-:AVSF0
-RUN



 
-* -SET &&COMPOUND=IF &&OUTLINE1 CONTAINS 'ONLINE-FMT' OR 'PCHOLD' THEN
-* - 'COMPOUND LAYOUT PCHOLD FORMAT ' | '&&OUTFMT.EVAL' ELSE
-* - 'COMPOUND LAYOUT HOLD FORMAT ' | '&&OUTFMT.EVAL';
 
-SET &&LOUT1=IF &&OUTLINE1 CONTAINS 'ONLINE-FMT' OR 'PCHOLD' THEN
- 'COMPOUND LAYOUT PCHOLD FORMAT ' | '&&OUTFMT.EVAL' ELSE
- 'COMPOUND LAYOUT HOLD FORMAT ' | '&&OUTFMT.EVAL';
 
-SET &&LOUT2=IF &&OUTLINE1 CONTAINS 'ONLINE-FMT' OR 'PCHOLD' THEN
- 'ON TABLE PCHOLD FORMAT ' | '&&OUTFMT.EVAL' ELSE
- 'ON TABLE HOLD AS SAVREP FORMAT ' | '&&OUTFMT.EVAL';
 
 
 
EX QBEMULTI
-RUN
 
 
-GOTO JOY; 
-IF &&OUTTO EQ 'XB' GOTO SKIP_TRIG;
 
-SET &OFL=&&OUTFMT.LENGTH;
-SET &OFM='A' || '&OFL.EVAL';
-SET &&OUTFMTX=LOCASE(&OFL.EVAL, '&&OUTFMT.EVAL', '&OFM.EVAL');
 
-SET &HFILE=&&WEB_PATH || 'SAVREP.' || &&OUTFMTX;
-IF &&OUTTO EQ 'TC' GOTO SRV_SAVE;
 
-GOTO SKIP_TRIG;
 
-SRV_SAVE
COPY &HFILE &&SAVSUM
 
-JOY; 
-SKIP_TRIG
SET EMPTYREPORT=OFF
-RUN
 
 
 
-GOTO XXITrpt
 
 
-* REJ ADDED TO TRAP ERRORS
-SET &&FEXNOW=&&EXPARM;
-INCLUDE ERRORCHK
-IF &&RET GT 1 GOTO XXIT;
-* REJ ADDED TO TRAP ERRORS
 
-IF &RECORDS GT 0 THEN GOTO DOIT;
 
-NORECORDS

-IF &&FROMAVRP NE 'Y' GOTO :AVSF2;
-INCLUDE OTHPARMS
-INCLUDE AVRP_SUBFOOT
-:AVSF2

-INCLUDE NORECRPT
-RUN

-DOIT
 
-XXITrpt
 
