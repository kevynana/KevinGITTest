-SET &&COMPNY = 'METX';
-SET &&COMPHP = 'HP' ||&&COMPNY;
-SET &&COMPAH = 'AH' ||&&COMPNY;

-* QUARTERLY
EX AIRXUSES
END
-RUN
-* NONQUARTERLY
-* EX AIRXUSET
-* END
-* -RUN

SET ASNAMES=ON

TABLE FILE SR_50
ON TABLE SET PAGE-NUM OFF
SUM CITYPAIR.AIR_KEY ROLL_LEV
BY AIR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

TABLE FILE HOLD
PRINT AIR_KEY ROLL_LEV
BY ROLL_LEV NOPRINT
ON TABLE HOLD AS SRHOLD
END
-RUN

TABLE FILE &&COMPHP
SUM ROLL_KEY ROLL_LEV
BY ROLL_LEV NOPRINT
ON TABLE HOLD AS HPHOLD
END
-RUN

MATCH FILE SRHOLD
PRINT AIR_KEY ROLL_LEV
BY ROLL_LEV NOPRINT
RUN
FILE HPHOLD
SUM ROLL_KEY ROLL_LEV
BY ROLL_LEV NOPRINT
AFTER MATCH HOLD OLD
END
-RUN

TABLE FILE HOLD
PRINT AIR_KEY ROLL_KEY ROLL_LEV
IF ROLL_KEY NE ' ';
ON TABLE HOLD AS FHOLD
END
-RUN

MODIFY FILE &&COMPAH
FIXFORM AIR_KEY/45 ROLL_KEY/50 ROLL_LEV/15
MATCH AIR_KEY
ON MATCH UPDATE ROLL_KEY
ON MATCH UPDATE ROLL_LEV
ON NOMATCH REJECT
DATA ON FHOLD
END
-RUN
-EXIT
