

-*CHANGED TRNM_FLAG DEFINE TO SHOW MONTH IN LCWORD FORMAT DUE TO NO REC
-* DEB 8/7/13
-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-INCLUDE SETECHO

SET ASNAMES=ON 
 




-DEFAULT &&CPARLN1 = ' ';
-DEFAULT &&CPARLN2 = ' ';
-DEFAULT &&CPARLN3 = ' ';
-DEFAULT &&CPARLN4 = ' ';
-DEFAULT &&CPARLN5 = ' ';
-DEFAULT &&CPARLN6 = ' ';
-DEFAULT &&CPARLN7 = ' ';
-DEFAULT &&CPARLN8 = ' ';
-DEFAULT &&CPARLN9 = ' ';



TABLEF FILE TPMPYR
PRINT AIR_LINE
    AIRLINE_NAME
    P1CNT
    P1FARE 
    P2CNT
    P2FARE
    XTRANMY
    TRNM_FLAG
    TRN_DATE    
BY TRAN_MY    
BY CP_AIRLINE
ON TABLE HOLD AS SIMPHLD1
END
-RUN



-* Extract data for airline(s) selected only


DEFINE FILE SIMPHLD1 
  AIRSELECT/A3 = IF ('&&AIR1' EQ AIR_LINE) THEN AIR_LINE ELSE '0';
  AIRSELECT2/A3 =IF ('&&AIR2' EQ AIR_LINE) THEN AIR_LINE ELSE '0';
  AIRSELECT3/A3 =IF ('&&AIR3' EQ AIR_LINE) THEN AIR_LINE ELSE '0';
  AIRSELECT4/A3 =IF ('&&AIR4' EQ AIR_LINE) THEN AIR_LINE ELSE '0';
  AIRSELECT5/A3 =IF ('&&AIR5' EQ AIR_LINE) THEN AIR_LINE ELSE '0';
  AIRSELECT6/A3 =IF ('&&AIR6' EQ AIR_LINE) THEN AIR_LINE ELSE '0';
  AIRSELECT7/A3 =IF ('&&AIR7' EQ AIR_LINE) THEN AIR_LINE ELSE '0';
  AIRSELECT8/A3 =IF ('&&AIR8' EQ AIR_LINE) THEN AIR_LINE ELSE '0';
  AIRSELECT9/A3 =IF ('&&AIR9' EQ AIR_LINE) THEN AIR_LINE ELSE '0';

  
  
END
-RUN


TABLE FILE SIMPHLD1
SUM P1CNT 
    P1FARE
    P2CNT
    P2FARE
    AIRLINE_NAME 
    TRNM_FLAG
    TRAN_MY
    XTRANMY   
BY AIRSELECT NOPRINT
BY AIRSELECT2 NOPRINT
BY AIRSELECT3 NOPRINT
BY AIRSELECT4 NOPRINT
BY AIRSELECT5 NOPRINT
BY AIRSELECT6 NOPRINT
BY AIRSELECT7 NOPRINT
BY AIRSELECT8 NOPRINT
BY AIRSELECT9 NOPRINT
BY CP_AIRLINE
BY TRAN_MY


-**** Start - WHERE statement to test Flown Airlines selected *****************
-IF &&AIR1 NE ' ' AND &&AIR2 NE ' ' AND &&AIR3 NE ' ' AND &&AIR4 NE ' '
- AND &&AIR5 NE ' ' AND &&AIR6 NE ' ' AND &&AIR7 NE ' ' AND &&AIR8 NE ' '
- AND &&AIR9 NE ' ' THEN GOTO WHEREAIR9 ELSE GOTO CHKAIR8;

-WHEREAIR9
WHERE CP_AIRLINE EQ '&&AIR1' OR '&&AIR2' OR '&&AIR3' OR '&&AIR4' OR '&&AIR5' 
OR '&&AIR6' OR '&&AIR7' OR '&&AIR8' OR '&&AIR9'
-GOTO CHKDONE;

-CHKAIR8
-IF &&AIR1 NE ' ' AND &&AIR2 NE ' ' AND &&AIR3 NE ' ' AND &&AIR4 NE ' '
- AND &&AIR5 NE ' ' AND &&AIR6 NE ' ' AND &&AIR7 AND &&AIR8 NE ' '
- THEN GOTO WHEREAIR8 ELSE GOTO CHKAIR7;

-WHEREAIR8
WHERE CP_AIRLINE EQ '&&AIR1' OR '&&AIR2' OR '&&AIR3' OR '&&AIR4' OR '&&AIR5' OR
'&&AIR6' OR '&&AIR7' OR '&&AIR8' 
-GOTO CHKDONE;

-CHKAIR7
-IF &&AIR1 NE ' ' AND &&AIR2 NE ' ' AND &&AIR3 NE ' ' AND &&AIR4 NE ' '
- AND &&AIR5 NE ' ' AND &&AIR6 NE ' ' AND &&AIR7 NE ' '
- THEN GOTO WHEREAIR7 ELSE GOTO CHKAIR6;

-WHEREAIR7
WHERE CP_AIRLINE EQ '&&AIR1' OR '&&AIR2' OR '&&AIR3' OR '&&AIR4' OR 
'&&AIR5' OR '&&AIR6' OR '&&AIR7'
-GOTO CHKDONE;

-CHKAIR6
-IF &&AIR1 NE ' ' AND &&AIR2 NE ' ' AND &&AIR3 NE ' ' AND &&AIR4 NE ' '
- AND &&AIR5 NE ' ' AND &&AIR6 NE ' ' THEN GOTO WHEREAIR6 ELSE GOTO CHKAIR5;

-WHEREAIR6
WHERE CP_AIRLINE EQ '&&AIR1' OR '&&AIR2' OR '&&AIR3' OR '&&AIR4' OR 
'&&AIR5' OR '&&AIR6'
-GOTO CHKDONE;

 
-CHKAIR5
-IF &&AIR1 NE ' ' AND &&AIR2 NE ' ' AND &&AIR3 NE ' ' AND &&AIR4 NE ' '
- AND &&AIR5 NE ' ' THEN GOTO WHEREAIR5 ELSE GOTO CHKAIR4;

-WHEREAIR5
WHERE CP_AIRLINE EQ '&&AIR1' OR '&&AIR2' OR '&&AIR3' OR '&&AIR4' OR 
'&&AIR5'
-GOTO CHKDONE;

-CHKAIR4
-IF &&AIR1 NE ' ' AND &&AIR2 NE ' ' AND &&AIR3 NE ' ' AND &&AIR4 NE ' '
- THEN GOTO WHEREAIR4 ELSE GOTO CHKAIR3;

-WHEREAIR4
WHERE CP_AIRLINE EQ '&&AIR1' OR '&&AIR2' OR '&&AIR3' OR '&&AIR4' 
-GOTO CHKDONE;

-CHKAIR3
-IF &&AIR1 NE ' ' AND &&AIR2 NE ' ' AND &&AIR3 NE ' ' 
- THEN GOTO WHEREAIR3 ELSE GOTO CHKAIR2;

-WHEREAIR3
WHERE CP_AIRLINE EQ '&&AIR1' OR '&&AIR2' OR '&&AIR3' 
-GOTO CHKDONE;

-CHKAIR2
-IF &&AIR1 NE ' ' AND &&AIR2 NE ' ' THEN GOTO WHEREAIR2 ELSE GOTO CHKAIR1;

-WHEREAIR2
WHERE CP_AIRLINE EQ '&&AIR1' OR '&&AIR2'  
-GOTO CHKDONE;

-CHKAIR1
-IF &&AIR1 NE ' ' THEN GOTO WHEREAIR1 ELSE GOTO CHKDONE;

-WHEREAIR1
WHERE CP_AIRLINE EQ '&&AIR1'  
-GOTO CHKDONE;

-CHKDONE
-**** End - WHERE statement to test Flown Airlines selected *******************

ON TABLE HOLD AS AIRHOLD1 
END
-RUN








DEFINE FILE AIRHOLD1
FLAG/A1 = 'A';
END

TABLE FILE AIRHOLD1
SUM P1CNT
    P1FARE
    P2CNT
    P2FARE 
    TRNM_FLAG
    XTRANMY   
BY FLAG
BY AIRLINE_NAME
BY CP_AIRLINE
BY TRAN_MY
ON TABLE HOLD AS AIRHOLD2 FORMAT FOCUS
END
-RUN


-* Extract data for all airlines combined total

DEFINE FILE SIMPHLD1
AIRLINE_NAME/A12 = 'ALL AIRLINES';
CP_AIRLINE/A3 = 'ZZZ';
FLAG/A1 = 'B';

END
TABLE FILE SIMPHLD1
SUM P1CNT
    P1FARE
    P2CNT
    P2FARE 
    TRNM_FLAG
    XTRANMY  
BY FLAG
BY AIRLINE_NAME
BY CP_AIRLINE
BY TRAN_MY
ON TABLE HOLD AS AIRHOLD3 FORMAT FOCUS
END
-RUN



-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HRANK1=&HLDPATH || 'AIRHOLD2.FOC';
-SET &HRANK2=&HLDPATH || 'AIRHOLD3.FOC';
-RUN

USE CLEAR *
-RUN

EX SUUSES
-RUN

USE ADD 
&HRANK1 AS AIRHOLD2
&HRANK2 AS AIRHOLD2
END
-RUN


-* MATCH TO DEBHOLD3 FROM SIMPA2

DEFINE FILE DEBHOLD3
TRNMN/A3 = EDIT(ROW_LABEL, '999$$$$');
TRNM_FLAG/A2 = DECODE TRNMN (Jan '01' Feb '02' Mar '03' Apr '04' May '05' Jun '06'
                             Jul '07' Aug '08' Sep '09' Oct '10' Nov '11' Dec '12');
END

TABLE FILE DEBHOLD3
PRINT ROW_ORDER TRNMN
      ROW_LABEL  
BY TRNM_FLAG
ON TABLE HOLD AS LBLHLD
END
-RUN



TABLE FILE AIRHOLD2
SUM P1CNT
    P1FARE
    P2CNT
    P2FARE
    AIRLINE_NAME
    TRAN_MY   
BY TRNM_FLAG
BY CP_AIRLINE
ON TABLE HOLD AS AIRHOLD4
END
-RUN

MATCH FILE AIRHOLD4
PRINT P1CNT
      P1FARE
      P2CNT
      P2FARE
      AIRLINE_NAME
      CP_AIRLINE
      TRAN_MY
BY TRNM_FLAG
ON TABLE HOLD 
RUN
FILE LBLHLD
SUM ROW_ORDER
    ROW_LABEL
BY TRNM_FLAG
AFTER MATCH HOLD AS AIRHOLD5 OLD-OR-NEW
END
-RUN

TABLE FILE AIRHOLD5
SUM P1CNT
      P1FARE
      P2CNT
      P2FARE
      AIRLINE_NAME
      ROW_ORDER
      ROW_LABEL
      TRAN_MY
BY TRNM_FLAG
BY CP_AIRLINE
ON TABLE HOLD AS AIRHOLD6 FORMAT FOCUS
END
-RUN






TABLE FILE AIRHOLD6
SUM CP_AIRLINE  
BY CP_AIRLINE
IF CP_AIRLINE NE 'ZZZ'
ON TABLE HOLD AS AIRCNT
END
-RUN


 

TABLE FILE AIRCNT
COUNT CP_AIRLINE AS 'CNT'
BY CP_AIRLINE NOPRINT
WHERE CP_AIRLINE EQ '&&AIR1' OR '&&AIR2' OR '&&AIR3' OR '&&AIR4' OR '&&AIR5' 
OR '&&AIR6' OR '&&AIR7' OR '&&AIR8' OR '&&AIR9'
ON TABLE HOLD AS AIRCNT1  
END
-RUN



-IF &RECORDS EQ 0 THEN GOTO NOCOUNT;


TABLE FILE AIRCNT1
SUM CNT
ON TABLE HOLD AS AIRCNT2 FORMAT ALPHA
END
-RUN

-READ AIRCNT2 NOCLOSE &CNT.A5.
-RUN

-SET &&CNT1 = EDIT(&CNT, '$$$$9');
-SET &&ACNT = &&CNT1;

-CLOSE AIRCNT

-GOTO NEXT;

-NOCOUNT
-SET &&ACNT = 0;

-NEXT;

TABLE FILE AIRHOLD6
SUM CP_AIRLINE
BY CP_AIRLINE
ON TABLE SAVE AS AIRHOLD7 FORMAT ALPHA
END
-RUN





-GetCount
-SET &CNT = 0;
-SET &TOTROLLS = &LINES;
-REPEAT Loop1 &TOTROLLS TIMES
-READ AIRHOLD7 NOCLOSE &CP_AIRLINE.A3
-IF &CP_AIRLINE EQ ' ' THEN GOTO Loop1;
-SET &CNT = &CNT + 1;
-SET &CP_AIRLINE.&CNT = &CP_AIRLINE;
-SET &&CPARLN.&CNT = &CP_AIRLINE.&CNT;
-Loop1



 
 


-* ALL AIRLINES 

TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
    AIRLINE_NAME
    CP_AIRLINE
    TRNM_FLAG
    TRAN_MY 
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
COMPUTE P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
COMPUTE VARAMT/P12.2 = (P1AVGF-P2AVGF);
COMPUTE CS/P12.2 = (VARAMT*P1CNT);
COMPUTE VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY ROW_ORDER
BY ROW_LABEL
WHERE CP_AIRLINE EQ 'ZZZ'
ON TABLE HOLD AS ALLAIR
END
-RUN



DEFINE FILE ALLAIR
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE ALLAIR
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_TTL' 
ON TABLE HOLD AS ALLAIRA
END
-RUN

TABLE FILE ALLAIRA
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_TTL 
ON TABLE HOLD AS ALLAIRA1
END
MODIFY FILE SMP_FAR2 
FIXFORM FROM ALLAIRA1
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_TTL 
ON NOMATCH REJECT
DATA ON ALLAIRA1
END
-RUN


 



DEFINE FILE ALLAIR
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE ALLAIR
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_TTL' VARPER/D2S AS 'AIR_PT' 
ON TABLE HOLD AS ALLVAR
END
-RUN

TABLE FILE ALLVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_TTL AND AIR_PT 
ON TABLE HOLD AS ALLVAR2
END
MODIFY FILE SMP_FAR2
FIXFORM FROM ALLVAR2
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_TTL AIR_PT 
ON NOMATCH REJECT
DATA ON ALLVAR2
END
-RUN


DEFINE FILE ALLAIR
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE ALLAIR
PRINT CATEGORY/A40 AND ROW_LABEL/A8  AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND CS/D9 AS 'AIR_TTL' 
ON TABLE HOLD AS ALLCVAR
END
-RUN

TABLE FILE ALLCVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_TTL 
ON TABLE HOLD AS ALLCVAR2
END
MODIFY FILE SMP_FAR2
FIXFORM FROM ALLCVAR2
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_TTL 
ON NOMATCH REJECT
DATA ON ALLCVAR2
END
-RUN



-* YTD ALL AIRLINES 
DEFINE FILE AIRHOLD6
FLAG/A1= 'A';
END
-RUN

TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
        P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
        VARAMT/P12.2 = P1AVGF-P2AVGF;
        CS/P12.2 = VARAMT*P1CNT;
        VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY FLAG

WHERE CP_AIRLINE EQ 'ZZZ'
ON TABLE HOLD AS ALLAIRT
END
-RUN



DEFINE FILE ALLAIRT
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
END
-RUN

TABLE FILE ALLAIRT
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_TTL' 
ON TABLE HOLD AS YTDTOT
END
-RUN

TABLE FILE YTDTOT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_TTL 
ON TABLE HOLD AS YTDTOT1
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDTOT1
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_TTL 
ON NOMATCH REJECT
DATA ON YTDTOT1
END
-RUN



DEFINE FILE ALLAIRT
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
END
-RUN

TABLE FILE ALLAIRT
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_TTL' VARPER/D2S AS 'AIR_PT'  
ON TABLE HOLD AS YTDVAR
END
-RUN


TABLE FILE YTDVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_TTL AND AIR_PT
ON TABLE HOLD AS YTDVAR1
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR1
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_TTL AIR_PT
ON NOMATCH REJECT
DATA ON YTDVAR1
END
-RUN



DEFINE FILE ALLAIRT
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
END
-RUN

TABLE FILE ALLAIRT
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND CS/D9 AS 'AIR_TTL'  
ON TABLE HOLD AS YTDCVAR
END
-RUN


TABLE FILE YTDCVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_TTL 
ON TABLE HOLD AS YTDCVAR1
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDCVAR1
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_TTL  
ON NOMATCH REJECT
DATA ON YTDCVAR1
END
-RUN



-* Air 1 

TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
    AIRLINE_NAME
    CP_AIRLINE
    TRNM_FLAG
    TRAN_MY
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
        P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
        VARAMT/P12.2 = P1AVGF-P2AVGF;
        CS/P12.2 = VARAMT*P1CNT;
        VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY ROW_ORDER
BY ROW_LABEL
WHERE CP_AIRLINE EQ '&&AIR1'
ON TABLE HOLD AS AIR1
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO AIR2;

 
DEFINE FILE AIR1
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE AIR1
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_1' AND AIRLINE_NAME1/A12 AS 'AIR_N1'
ON TABLE HOLD AS AIR1A
END
-RUN

TABLE FILE AIR1A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_1 AND AIR_N1
ON TABLE HOLD AS AIR1B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR1B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_1 AIR_N1
ON NOMATCH REJECT
DATA ON AIR1B
END
-RUN





DEFINE FILE AIR1
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE AIR1
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_1' VARPER/D2S AS 'AIR_P1' 
ON TABLE HOLD AS AIR1VAR
END
-RUN

TABLE FILE AIR1VAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_1 AND AIR_P1 
ON TABLE HOLD AS AIR1VARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR1VARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_1 AIR_P1 
ON NOMATCH REJECT
DATA ON AIR1VARB
END
-RUN






DEFINE FILE AIR1
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE AIR1
PRINT CATEGORY/A40 AND ROW_LABEL/A8  AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND CS/D9 AS 'AIR_1' 
ON TABLE HOLD AS AIR1CVAR
END
-RUN

TABLE FILE AIR1CVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_1 
ON TABLE HOLD AS AIR1CVARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR1CVARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_1 
ON NOMATCH REJECT
DATA ON AIR1CVARB
END
-RUN


-* AIR1   YTD 

 DEFINE FILE AIRHOLD6
 FLAG/A1= 'A';
 END
 -RUN
  
 TABLE FILE AIRHOLD6
 SUM P1CNT
      P1FARE 
      P2CNT  
      P2FARE
      AIRLINE_NAME
 COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                           ELSE P1FARE/P1CNT;  
          P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                           ELSE P2FARE/P2CNT; 
          VARAMT/P12.2 = P1AVGF-P2AVGF;
          CS/P12.2 = VARAMT*P1CNT;
          VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                          ELSE ((VARAMT/P2AVGF)*100);
 BY FLAG
  
 WHERE CP_AIRLINE EQ '&&AIR1'
 ON TABLE HOLD AS YTDAIR1
 END
 -RUN

 
 DEFINE FILE YTDAIR1
 CATEGORY/A40 = 'Average Market Fare';
 CAT_ORDER/I2 = 1;
 ROW_LABEL/A8 = '&&RLBL.EVAL';
 ROW_ORDER/I2 = 13;
 AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
 END
 -RUN
 
 TABLE FILE YTDAIR1
 PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
 CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_1' AND AIRLINE_NAME1/A12 AS 'AIR_N1'
 ON TABLE HOLD AS YTDAIR1A
 END
 -RUN
 
 
 TABLE FILE YTDAIR1A
 PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_1 AND AIR_N1
 ON TABLE HOLD AS YTDAIR1B
 END
 MODIFY FILE SMP_FAR2
 FIXFORM FROM YTDAIR1B
 MATCH CATEGORY ROW_LABEL ROW_ORDER
 ON MATCH UPDATE AIR_1 AIR_N1
 ON NOMATCH REJECT
 DATA ON YTDAIR1B
 END
 -RUN
 


DEFINE FILE YTDAIR1
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR1
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_1' VARPER/D2S AS 'AIR_P1'  
ON TABLE HOLD AS YTDVAR1
END
-RUN


TABLE FILE YTDVAR1
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_1 AND AIR_P1
ON TABLE HOLD AS YTDVAR1A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR1A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_1 AIR_P1
ON NOMATCH REJECT
DATA ON YTDVAR1A
END
-RUN



DEFINE FILE YTDAIR1
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR1
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_1' VARPER/D2S AS 'AIR_P1'  
ON TABLE HOLD AS YTDVAR1
END
-RUN


TABLE FILE YTDVAR1
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_1 AND AIR_P1
ON TABLE HOLD AS YTDVAR1A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR1A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_1 AIR_P1
ON NOMATCH REJECT
DATA ON YTDVAR1A
END
-RUN



DEFINE FILE YTDAIR1
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR1
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND CS/D9 AS 'AIR_1'   
ON TABLE HOLD AS YTDCVAR1
END
-RUN


TABLE FILE YTDCVAR1
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_1  
ON TABLE HOLD AS YTDCVAR1A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDCVAR1A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_1 AIR_P1
ON NOMATCH REJECT
DATA ON YTDCVAR1A
END
-RUN



-AIR2

-* Air 2 

TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
    AIRLINE_NAME
    CP_AIRLINE
    TRNM_FLAG
    TRAN_MY
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
        P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
        VARAMT/P12.2 = P1AVGF-P2AVGF;
        CS/P12.2 = VARAMT*P1CNT;
        VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY ROW_ORDER
BY ROW_LABEL
WHERE CP_AIRLINE EQ '&&AIR2'
ON TABLE HOLD AS AIR2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO AIR3;

DEFINE FILE AIR2
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);

END
-RUN

TABLE FILE AIR2
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_2' AND AIRLINE_NAME1/A12 AS 'AIR_N2'
ON TABLE HOLD AS AIR2A
END
-RUN

TABLE FILE AIR2A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_2 AND AIR_N2
ON TABLE HOLD AS AIR2B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR2B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_2 AIR_N2
ON NOMATCH REJECT
DATA ON AIR2B
END
-RUN






DEFINE FILE AIR2
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;

END
-RUN

TABLE FILE AIR2
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_2' VARPER/D4S AS 'AIR_P2' 
ON TABLE HOLD AS AIR2VAR
END
-RUN

TABLE FILE AIR2VAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_2 AND AIR_P2 
ON TABLE HOLD AS AIR2VARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR2VARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_2 AIR_P2 
ON NOMATCH REJECT
DATA ON AIR2VARB
END
-RUN


DEFINE FILE AIR2
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE AIR2
PRINT CATEGORY/A40 AND ROW_LABEL/A8  AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND CS/D9 AS 'AIR_2'
ON TABLE HOLD AS AIR2CVAR
END
-RUN

TABLE FILE AIR2CVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_2 
ON TABLE HOLD AS AIR2CVARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR2CVARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_2 
ON NOMATCH REJECT
DATA ON AIR2CVARB
END
-RUN

-* YTD AIR2 

DEFINE FILE AIRHOLD6
FLAG/A1= 'A';
END
-RUN
 
TABLE FILE AIRHOLD6
SUM P1CNT
     P1FARE 
     P2CNT  
     P2FARE
     AIRLINE_NAME
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                          ELSE P1FARE/P1CNT;  
         P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                          ELSE P2FARE/P2CNT; 
         VARAMT/P12.2 = P1AVGF-P2AVGF;
         CS/P12.2 = VARAMT*P1CNT;
         VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                         ELSE ((VARAMT/P2AVGF)*100);
BY FLAG
 
WHERE CP_AIRLINE EQ '&&AIR2'
ON TABLE HOLD AS YTDAIR2
END
-RUN


DEFINE FILE YTDAIR2
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR2
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_2' AND AIRLINE_NAME1/A12 AS 'AIR_N2'
ON TABLE HOLD AS YTDAIR2A
END
-RUN


TABLE FILE YTDAIR2A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_2 AND AIR_N2
ON TABLE HOLD AS YTDAIR2B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDAIR2B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_2 AIR_N2
ON NOMATCH REJECT
DATA ON YTDAIR2B
END
-RUN


DEFINE FILE YTDAIR2
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR2
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_2' VARPER/D4S AS 'AIR_P2'  
ON TABLE HOLD AS YTDVAR2
END
-RUN


TABLE FILE YTDVAR2
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_2 AND AIR_P2
ON TABLE HOLD AS YTDVAR2A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR2A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_2 AIR_P2
ON NOMATCH REJECT
DATA ON YTDVAR2A
END
-RUN



DEFINE FILE YTDAIR2
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR2
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND CS/D9 AS 'AIR_2'   
ON TABLE HOLD AS YTDCVAR2
END
-RUN


TABLE FILE YTDCVAR2
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_2  
ON TABLE HOLD AS YTDCVAR2A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDCVAR2A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_2 
ON NOMATCH REJECT
DATA ON YTDCVAR2A
END
-RUN



-AIR3

-* Air 3 

TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
    AIRLINE_NAME
    CP_AIRLINE
    TRNM_FLAG
    TRAN_MY
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
        P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
        VARAMT/P12.2 = P1AVGF-P2AVGF;
        CS/P12.2 = VARAMT*P1CNT;
        VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY ROW_ORDER
BY ROW_LABEL
WHERE CP_AIRLINE EQ '&&AIR3'
ON TABLE HOLD AS AIR3
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO AIR4;

DEFINE FILE AIR3
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);

END
-RUN

TABLE FILE AIR3
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_3' AND AIRLINE_NAME1/A12 AS 'AIR_N3'
ON TABLE HOLD AS AIR3A
END
-RUN

TABLE FILE AIR3A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_3 AND AIR_N3
ON TABLE HOLD AS AIR3B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR3B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_3 AIR_N3
ON NOMATCH REJECT
DATA ON AIR3B
END
-RUN



DEFINE FILE AIR3
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE AIR3
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_3' VARPER/D4S AS 'AIR_P3' 
ON TABLE HOLD AS AIR3VAR
END
-RUN

TABLE FILE AIR3VAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_3 AND AIR_P3 
ON TABLE HOLD AS AIR3VARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR3VARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_3 AIR_P3 
ON NOMATCH REJECT
DATA ON AIR3VARB
END
-RUN


DEFINE FILE AIR3
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE AIR3
PRINT CATEGORY/A40 AND ROW_LABEL/A8  AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND CS/D9 AS 'AIR_3' 
ON TABLE HOLD AS AIR3CVAR
END
-RUN

TABLE FILE AIR3CVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_3
ON TABLE HOLD AS AIR3CVARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR3CVARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_3 
ON NOMATCH REJECT
DATA ON AIR3CVARB
END
-RUN

-* YTD AIR3 

DEFINE FILE AIRHOLD6
FLAG/A1= 'A';
END
-RUN
 
TABLE FILE AIRHOLD6
SUM P1CNT
     P1FARE 
     P2CNT  
     P2FARE
     AIRLINE_NAME
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                          ELSE P1FARE/P1CNT;  
         P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                          ELSE P2FARE/P2CNT; 
         VARAMT/P12.2 = P1AVGF-P2AVGF;
         CS/P12.2 = VARAMT*P1CNT;
         VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                         ELSE ((VARAMT/P2AVGF)*100);
BY FLAG
 
WHERE CP_AIRLINE EQ '&&AIR3'
ON TABLE HOLD AS YTDAIR3
END
-RUN


DEFINE FILE YTDAIR3
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR3
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_3' AND AIRLINE_NAME1/A12 AS 'AIR_N3'
ON TABLE HOLD AS YTDAIR3A
END
-RUN


TABLE FILE YTDAIR3A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_3 AND AIR_N3
ON TABLE HOLD AS YTDAIR3B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDAIR3B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_3 AIR_N3
ON NOMATCH REJECT
DATA ON YTDAIR3B
END
-RUN


DEFINE FILE YTDAIR3
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR3
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_3' VARPER/D4S AS 'AIR_P3'  
ON TABLE HOLD AS YTDVAR3
END
-RUN


TABLE FILE YTDVAR3
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_3 AND AIR_P3
ON TABLE HOLD AS YTDVAR3A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR3A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_3 AIR_P3
ON NOMATCH REJECT
DATA ON YTDVAR3A
END
-RUN



DEFINE FILE YTDAIR3
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR3
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND CS/D9 AS 'AIR_3'   
ON TABLE HOLD AS YTDCVAR3
END
-RUN


TABLE FILE YTDCVAR3
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_3  
ON TABLE HOLD AS YTDCVAR3A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDCVAR3A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_3 
ON NOMATCH REJECT
DATA ON YTDCVAR3A
END
-RUN





-AIR4 
-* Air 4 

TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
    AIRLINE_NAME
    CP_AIRLINE
    TRNM_FLAG
    TRAN_MY
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
        P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
        VARAMT/P12.2 = P1AVGF-P2AVGF;
        CS/P12.2 = VARAMT*P1CNT;
        VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY ROW_ORDER
BY ROW_LABEL
WHERE CP_AIRLINE EQ '&&AIR4'
ON TABLE HOLD AS AIR4
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO AIR5;

DEFINE FILE AIR4
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);

END
-RUN

TABLE FILE AIR4
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_4' AND AIRLINE_NAME1/A12 AS 'AIR_N4'
ON TABLE HOLD AS AIR4A
END
-RUN

TABLE FILE AIR4A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_4 AND AIR_N4
ON TABLE HOLD AS AIR4B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR4B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_4 AIR_N4
ON NOMATCH REJECT
DATA ON AIR4B
END
-RUN



DEFINE FILE AIR4
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE AIR4
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_4' VARPER/D4S AS 'AIR_P4' 
ON TABLE HOLD AS AIR4VAR
END
-RUN

TABLE FILE AIR4VAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_4 AND AIR_P4 
ON TABLE HOLD AS AIR4VARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR4VARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_4 AIR_P4 
ON NOMATCH REJECT
DATA ON AIR4VARB
END
-RUN


DEFINE FILE AIR4
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE AIR4
PRINT CATEGORY/A40 AND ROW_LABEL/A8  AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND CS/D9 AS 'AIR_4' 
ON TABLE HOLD AS AIR4CVAR
END
-RUN

TABLE FILE AIR4CVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_4 
ON TABLE HOLD AS AIR4CVARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR4CVARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_4 
ON NOMATCH REJECT
DATA ON AIR4CVARB
END
-RUN

-* YTD AIR4 

DEFINE FILE AIRHOLD6
FLAG/A1= 'A';
END
-RUN
 
TABLE FILE AIRHOLD6
SUM P1CNT
     P1FARE 
     P2CNT  
     P2FARE
     AIRLINE_NAME
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                          ELSE P1FARE/P1CNT;  
         P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                          ELSE P2FARE/P2CNT; 
         VARAMT/P12.2 = P1AVGF-P2AVGF;
         CS/P12.2 = VARAMT*P1CNT;
         VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                         ELSE ((VARAMT/P2AVGF)*100);
BY FLAG
 
WHERE CP_AIRLINE EQ '&&AIR4'
ON TABLE HOLD AS YTDAIR4
END
-RUN


DEFINE FILE YTDAIR4
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR4
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_4' AND AIRLINE_NAME1/A12 AS 'AIR_N4'
ON TABLE HOLD AS YTDAIR4A
END
-RUN


TABLE FILE YTDAIR4A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_4 AND AIR_N4
ON TABLE HOLD AS YTDAIR4B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDAIR4B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_4 AIR_N4
ON NOMATCH REJECT
DATA ON YTDAIR4B
END
-RUN


DEFINE FILE YTDAIR4
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR4
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_4' VARPER/D4S AS 'AIR_P4'  
ON TABLE HOLD AS YTDVAR4
END
-RUN


TABLE FILE YTDVAR4
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_4 AND AIR_P4
ON TABLE HOLD AS YTDVAR4A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR4A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_4 AIR_P4
ON NOMATCH REJECT
DATA ON YTDVAR4A
END
-RUN



DEFINE FILE YTDAIR4
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR4
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND CS/D9 AS 'AIR_4'   
ON TABLE HOLD AS YTDCVAR4
END
-RUN


TABLE FILE YTDCVAR4
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_4  
ON TABLE HOLD AS YTDCVAR4A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDCVAR4A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_4 
ON NOMATCH REJECT
DATA ON YTDCVAR4A
END
-RUN





-AIR5



-* Air 5 

TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
    AIRLINE_NAME
    CP_AIRLINE
    TRNM_FLAG
    TRAN_MY
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
        P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
        VARAMT/P12.2 = P1AVGF-P2AVGF;
        CS/P12.2 = VARAMT*P1CNT;
        VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY ROW_ORDER
BY ROW_LABEL
WHERE CP_AIRLINE EQ '&&AIR5'
ON TABLE HOLD AS AIR5
END
-RUN
 


-IF &RECORDS EQ 0 THEN GOTO AIR6;

DEFINE FILE AIR5
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);

END
-RUN

TABLE FILE AIR5
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_5' AND AIRLINE_NAME1 AS 'AIR_N5'
ON TABLE HOLD AS AIR5A
END
-RUN

TABLE FILE AIR5A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_5 AND AIR_N5
ON TABLE HOLD AS AIR5B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR5B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_5 AIR_N5
ON NOMATCH REJECT
DATA ON AIR5B
END
-RUN



DEFINE FILE AIR5
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE AIR5
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_5' VARPER/D4S AS 'AIR_P5' 
ON TABLE HOLD AS AIR5VAR
END
-RUN

TABLE FILE AIR5VAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_5 AND AIR_P5 
ON TABLE HOLD AS AIR5VARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR5VARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_5 AIR_P5 
ON NOMATCH REJECT
DATA ON AIR5VARB
END
-RUN


DEFINE FILE AIR5
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE AIR5
PRINT CATEGORY/A40 AND ROW_LABEL/A8  AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND CS/D9 AS 'AIR_5' 
ON TABLE HOLD AS AIR5CVAR
END
-RUN

TABLE FILE AIR5CVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_5 
ON TABLE HOLD AS AIR5CVARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR5CVARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_5 
ON NOMATCH REJECT
DATA ON AIR5CVARB
END
-RUN


-* YTD AIR5 

DEFINE FILE AIRHOLD6
FLAG/A1= 'A';
END
-RUN
 
TABLE FILE AIRHOLD6
SUM P1CNT
     P1FARE 
     P2CNT  
     P2FARE
     AIRLINE_NAME
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                          ELSE P1FARE/P1CNT;  
         P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                          ELSE P2FARE/P2CNT; 
         VARAMT/P12.2 = P1AVGF-P2AVGF;
         CS/P12.2 = VARAMT*P1CNT;
         VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                         ELSE ((VARAMT/P2AVGF)*100);
BY FLAG
 
WHERE CP_AIRLINE EQ '&&AIR5'
ON TABLE HOLD AS YTDAIR5
END
-RUN


DEFINE FILE YTDAIR5
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR5
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_5' AND AIRLINE_NAME1/A12 AS 'AIR_N5'
ON TABLE HOLD AS YTDAIR5A
END
-RUN


TABLE FILE YTDAIR5A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_5 AND AIR_N5
ON TABLE HOLD AS YTDAIR5B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDAIR5B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_5 AIR_N5
ON NOMATCH REJECT
DATA ON YTDAIR5B
END
-RUN


DEFINE FILE YTDAIR5
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR5
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_5' VARPER/D4S AS 'AIR_P5'  
ON TABLE HOLD AS YTDVAR5
END
-RUN


TABLE FILE YTDVAR5
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_5 AND AIR_P5
ON TABLE HOLD AS YTDVAR5A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR5A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_5 AIR_P5
ON NOMATCH REJECT
DATA ON YTDVAR5A
END
-RUN



DEFINE FILE YTDAIR5
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR5
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND CS/D9 AS 'AIR_5'   
ON TABLE HOLD AS YTDCVAR5
END
-RUN


TABLE FILE YTDCVAR5
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_5  
ON TABLE HOLD AS YTDCVAR5A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDCVAR5A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_5 
ON NOMATCH REJECT
DATA ON YTDCVAR5A
END
-RUN



-* Air 6 
-AIR6
TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
    AIRLINE_NAME
    CP_AIRLINE
    TRNM_FLAG
    TRAN_MY
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
        P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
        VARAMT/P12.2 = P1AVGF-P2AVGF;
        CS/P12.2 = VARAMT*P1CNT;
        VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY ROW_ORDER
BY ROW_LABEL
WHERE CP_AIRLINE EQ '&&AIR6'
ON TABLE HOLD AS AIR6
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO AIR7;

DEFINE FILE AIR6
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);

END
-RUN

TABLE FILE AIR6
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_6' AND AIRLINE_NAME1
AS 'AIR_N6'
ON TABLE HOLD AS AIR6A
END
-RUN

TABLE FILE AIR6A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_6 AND AIR_N6
ON TABLE HOLD AS AIR6B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR6B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_6 AIR_N6
ON NOMATCH REJECT
DATA ON AIR6B
END
-RUN



DEFINE FILE AIR6
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE AIR6
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_6' VARPER/D4S AS 'AIR_P6' 
ON TABLE HOLD AS AIR6VAR
END
-RUN

TABLE FILE AIR6VAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_6 AND AIR_P6 
ON TABLE HOLD AS AIR6VARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR6VARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_6 AIR_P6 
ON NOMATCH REJECT
DATA ON AIR6VARB
END
-RUN


DEFINE FILE AIR6
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE AIR6
PRINT CATEGORY/A40 AND ROW_LABEL/A8  AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND CS/D9 AS 'AIR_6' 
ON TABLE HOLD AS AIR6CVAR
END
-RUN

TABLE FILE AIR6CVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_6 
ON TABLE HOLD AS AIR6CVARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR6CVARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_6 
ON NOMATCH REJECT
DATA ON AIR6CVARB
END
-RUN


-* YTD AIR6 

DEFINE FILE AIRHOLD6
FLAG/A1= 'A';
END
-RUN
 
TABLE FILE AIRHOLD6
SUM P1CNT
     P1FARE 
     P2CNT  
     P2FARE
     AIRLINE_NAME
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                          ELSE P1FARE/P1CNT;  
         P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                          ELSE P2FARE/P2CNT; 
         VARAMT/P12.2 = P1AVGF-P2AVGF;
         CS/P12.2 = VARAMT*P1CNT;
         VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                         ELSE ((VARAMT/P2AVGF)*100);
BY FLAG
 
WHERE CP_AIRLINE EQ '&&AIR6'
ON TABLE HOLD AS YTDAIR6
END
-RUN


DEFINE FILE YTDAIR6
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR6
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_6' AND AIRLINE_NAME1/A12 
AS 'AIR_N6'
ON TABLE HOLD AS YTDAIR6A
END
-RUN


TABLE FILE YTDAIR6A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_6 AND AIR_N6
ON TABLE HOLD AS YTDAIR6B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDAIR6B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_6 AIR_N6
ON NOMATCH REJECT
DATA ON YTDAIR6B
END
-RUN


DEFINE FILE YTDAIR6
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR6
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_6' VARPER/D4S AS 'AIR_P6'  
ON TABLE HOLD AS YTDVAR6
END
-RUN


TABLE FILE YTDVAR6
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_6 AND AIR_P6
ON TABLE HOLD AS YTDVAR6A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR6A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_6 AIR_P6
ON NOMATCH REJECT
DATA ON YTDVAR6A
END
-RUN



DEFINE FILE YTDAIR6
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR6
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND CS/D9 AS 'AIR_6'   
ON TABLE HOLD AS YTDCVAR6
END
-RUN


TABLE FILE YTDCVAR6
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_6  
ON TABLE HOLD AS YTDCVAR6A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDCVAR6A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_6 
ON NOMATCH REJECT
DATA ON YTDCVAR6A
END
-RUN



-* Air 7 
-AIR7
TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
    AIRLINE_NAME
    CP_AIRLINE
    TRNM_FLAG
    TRAN_MY
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
        P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
        VARAMT/P12.2 = P1AVGF-P2AVGF;
        CS/P12.2 = VARAMT*P1CNT;
        VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY ROW_ORDER
BY ROW_LABEL
WHERE CP_AIRLINE EQ '&&AIR7'
ON TABLE HOLD AS AIR7
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO NOMORE;

DEFINE FILE AIR7
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);

END
-RUN

TABLE FILE AIR7
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_7' AND AIRLINE_NAME1
AS 'AIR_N7'
ON TABLE HOLD AS AIR7A
END
-RUN

TABLE FILE AIR7A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_7 AND AIR_N7
ON TABLE HOLD AS AIR7B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR7B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_7 AIR_N7
ON NOMATCH REJECT
DATA ON AIR7B
END
-RUN



DEFINE FILE AIR7
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE AIR7
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_7' VARPER/D4S AS 'AIR_P7' 
ON TABLE HOLD AS AIR7VAR
END
-RUN

TABLE FILE AIR7VAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_7 AND AIR_P7 
ON TABLE HOLD AS AIR7VARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR7VARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_7 AIR_P7 
ON NOMATCH REJECT
DATA ON AIR7VARB
END
-RUN


DEFINE FILE AIR7
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE AIR7
PRINT CATEGORY/A40 AND ROW_LABEL/A8  AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND CS/D9 AS 'AIR_7' 
ON TABLE HOLD AS AIR7CVAR
END
-RUN

TABLE FILE AIR7CVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_7 
ON TABLE HOLD AS AIR7CVARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR7CVARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_7 
ON NOMATCH REJECT
DATA ON AIR7CVARB
END
-RUN


-* YTD AIR7 

DEFINE FILE AIRHOLD6
FLAG/A1= 'A';
END
-RUN
 
TABLE FILE AIRHOLD6
SUM P1CNT
     P1FARE 
     P2CNT  
     P2FARE
     AIRLINE_NAME
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                          ELSE P1FARE/P1CNT;  
         P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                          ELSE P2FARE/P2CNT; 
         VARAMT/P12.2 = P1AVGF-P2AVGF;
         CS/P12.2 = VARAMT*P1CNT;
         VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                         ELSE ((VARAMT/P2AVGF)*100);
BY FLAG
 
WHERE CP_AIRLINE EQ '&&AIR7'
ON TABLE HOLD AS YTDAIR7
END
-RUN


DEFINE FILE YTDAIR7
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR7
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_7' AND AIRLINE_NAME1/A12 
AS 'AIR_N7'
ON TABLE HOLD AS YTDAIR7A
END
-RUN


TABLE FILE YTDAIR7A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_7 AND AIR_N7
ON TABLE HOLD AS YTDAIR7B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDAIR7B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_7 AIR_N7
ON NOMATCH REJECT
DATA ON YTDAIR7B
END
-RUN


DEFINE FILE YTDAIR7
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR7
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_7' VARPER/D4S AS 'AIR_P7'  
ON TABLE HOLD AS YTDVAR7
END
-RUN


TABLE FILE YTDVAR7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_7 AND AIR_P7
ON TABLE HOLD AS YTDVAR7A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR7A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_7 AIR_P7
ON NOMATCH REJECT
DATA ON YTDVAR7A
END
-RUN



DEFINE FILE YTDAIR7
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR7
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND CS/D9 AS 'AIR_7'   
ON TABLE HOLD AS YTDCVAR7
END
-RUN


TABLE FILE YTDCVAR7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_7  
ON TABLE HOLD AS YTDCVAR7A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDCVAR7A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_7 
ON NOMATCH REJECT
DATA ON YTDCVAR7A
END
-RUN


-* Air 8 
-AIR8
TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
    AIRLINE_NAME
    CP_AIRLINE
    TRNM_FLAG
    TRAN_MY
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
        P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
        VARAMT/P12.2 = P1AVGF-P2AVGF;
        CS/P12.2 = VARAMT*P1CNT;
        VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY ROW_ORDER
BY ROW_LABEL
WHERE CP_AIRLINE EQ '&&AIR8'
ON TABLE HOLD AS AIR8
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO AIR9;

 
DEFINE FILE AIR8
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);

END
-RUN

TABLE FILE AIR8
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_8' AND AIRLINE_NAME1
AS 'AIR_N8'
ON TABLE HOLD AS AIR8A
END
-RUN

TABLE FILE AIR8A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_8 AND AIR_N8
ON TABLE HOLD AS AIR8B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR8B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_8 AIR_N8
ON NOMATCH REJECT
DATA ON AIR8B
END
-RUN



DEFINE FILE AIR8
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE AIR8
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_8' VARPER/D4S AS 'AIR_P8' 
ON TABLE HOLD AS AIR8VAR
END
-RUN

TABLE FILE AIR8VAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_8 AND AIR_P8 
ON TABLE HOLD AS AIR8VARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR8VARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_8 AIR_P8 
ON NOMATCH REJECT
DATA ON AIR8VARB
END
-RUN


DEFINE FILE AIR8
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE AIR8
PRINT CATEGORY/A40 AND ROW_LABEL/A8  AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND CS/D9 AS 'AIR_8' 
ON TABLE HOLD AS AIR8CVAR
END
-RUN

TABLE FILE AIR8CVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_8 
ON TABLE HOLD AS AIR8CVARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR8CVARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_8 
ON NOMATCH REJECT
DATA ON AIR8CVARB
END
-RUN


-* YTD AIR8 

DEFINE FILE AIRHOLD6
FLAG/A1= 'A';
END
-RUN
 
TABLE FILE AIRHOLD6
SUM P1CNT
     P1FARE 
     P2CNT  
     P2FARE
     AIRLINE_NAME
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                          ELSE P1FARE/P1CNT;  
         P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                          ELSE P2FARE/P2CNT; 
         VARAMT/P12.2 = P1AVGF-P2AVGF;
         CS/P12.2 = VARAMT*P1CNT;
         VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                         ELSE ((VARAMT/P2AVGF)*100);
BY FLAG
 
WHERE CP_AIRLINE EQ '&&AIR8'
ON TABLE HOLD AS YTDAIR8
END
-RUN


DEFINE FILE YTDAIR8
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR8
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_8' AND AIRLINE_NAME1/A12 
AS 'AIR_N8'
ON TABLE HOLD AS YTDAIR8A
END
-RUN


TABLE FILE YTDAIR8A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_8 AND AIR_N8
ON TABLE HOLD AS YTDAIR8B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDAIR8B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_8 AIR_N8
ON NOMATCH REJECT
DATA ON YTDAIR8B
END
-RUN


DEFINE FILE YTDAIR8
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR8
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_8' VARPER/D4S AS 'AIR_P8'  
ON TABLE HOLD AS YTDVAR8
END
-RUN


TABLE FILE YTDVAR8
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_8 AND AIR_P8
ON TABLE HOLD AS YTDVAR8A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR8A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_8 AIR_P8
ON NOMATCH REJECT
DATA ON YTDVAR8A
END
-RUN



DEFINE FILE YTDAIR8
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR8
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND CS/D9 AS 'AIR_8'   
ON TABLE HOLD AS YTDCVAR8
END
-RUN


TABLE FILE YTDCVAR8
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_8  
ON TABLE HOLD AS YTDCVAR8A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDCVAR8A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_8 
ON NOMATCH REJECT
DATA ON YTDCVAR8A
END
-RUN


-* Air 9 
-AIR9

TABLE FILE AIRHOLD6
SUM P1CNT
    P1FARE 
    P2CNT  
    P2FARE 
    AIRLINE_NAME
    CP_AIRLINE
    TRNM_FLAG
    TRAN_MY
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                         ELSE P1FARE/P1CNT;  
        P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                         ELSE P2FARE/P2CNT; 
        VARAMT/P12.2 = P1AVGF-P2AVGF;
        CS/P12.2 = VARAMT*P1CNT;
        VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                        ELSE ((VARAMT/P2AVGF)*100);
BY ROW_ORDER
BY ROW_LABEL
WHERE CP_AIRLINE EQ '&&AIR9'
ON TABLE HOLD AS AIR9
END
-RUN


-IF &RECORDS EQ 0 THEN GOTO NOMORE;



DEFINE FILE AIR9
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);

END
-RUN

TABLE FILE AIR9
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_9' AND AIRLINE_NAME1
AS 'AIR_N9'
ON TABLE HOLD AS AIR9A
END
-RUN

TABLE FILE AIR9A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_9 AND AIR_N9
ON TABLE HOLD AS AIR9B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR9B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_9 AIR_N9
ON NOMATCH REJECT
DATA ON AIR9B
END
-RUN



DEFINE FILE AIR9
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE AIR9
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_9' VARPER/D4S AS 'AIR_P9' 
ON TABLE HOLD AS AIR9VAR
END
-RUN

TABLE FILE AIR9VAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_9 AND AIR_P9 
ON TABLE HOLD AS AIR9VARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR9VARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_9 AIR_P9 
ON NOMATCH REJECT
DATA ON AIR9VARB
END
-RUN


DEFINE FILE AIR9
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE AIR9
PRINT CATEGORY/A40 AND ROW_LABEL/A8  AND CAT_ORDER/I2 AND
ROW_ORDER/I2 AND CS/D9 AS 'AIR_9' 
ON TABLE HOLD AS AIR9CVAR
END
-RUN

TABLE FILE AIR9CVAR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND AIR_9 
ON TABLE HOLD AS AIR9CVARB
END
MODIFY FILE SMP_FAR2
FIXFORM FROM AIR9CVARB
MATCH CATEGORY ROW_LABEL ROW_ORDER  
ON MATCH UPDATE AIR_9 
ON NOMATCH REJECT
DATA ON AIR9CVARB
END
-RUN


-* YTD AIR9 

DEFINE FILE AIRHOLD6
FLAG/A1= 'A';
END
-RUN
 
TABLE FILE AIRHOLD6
SUM P1CNT
     P1FARE 
     P2CNT  
     P2FARE
     AIRLINE_NAME
COMPUTE P1AVGF/P12.2 = IF ((P1CNT LT 1) AND (P1CNT GT (-1))) THEN 0
                          ELSE P1FARE/P1CNT;  
         P2AVGF/P12.2 = IF ((P2CNT LT 1) AND (P2CNT GT (-1))) THEN 0
                          ELSE P2FARE/P2CNT; 
         VARAMT/P12.2 = P1AVGF-P2AVGF;
         CS/P12.2 = VARAMT*P1CNT;
         VARPER/P5 = IF ((P2AVGF LT 1) AND (P2AVGF GT (-1))) THEN 0
                         ELSE ((VARAMT/P2AVGF)*100);
BY FLAG
 
WHERE CP_AIRLINE EQ '&&AIR9'
ON TABLE HOLD AS YTDAIR9
END
-RUN


DEFINE FILE YTDAIR9
CATEGORY/A40 = 'Average Market Fare';
CAT_ORDER/I2 = 1;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR9
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND P1AVGF/D9 AS 'AIR_9' AND AIRLINE_NAME1/A12 
AS 'AIR_N9'
ON TABLE HOLD AS YTDAIR9A
END
-RUN


TABLE FILE YTDAIR9A
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_9 AND AIR_N9
ON TABLE HOLD AS YTDAIR9B
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDAIR9B
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_9 AIR_N9
ON NOMATCH REJECT
DATA ON YTDAIR9B
END
-RUN


DEFINE FILE YTDAIR9
CATEGORY/A40 = 'Dollar/PCT Variance over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR9
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND VARAMT/D9 AS 'AIR_9' VARPER/D4S AS 'AIR_P9'  
ON TABLE HOLD AS YTDVAR9
END
-RUN


TABLE FILE YTDVAR9
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_9 AND AIR_P9
ON TABLE HOLD AS YTDVAR9A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDVAR9A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_9 AIR_P9
ON NOMATCH REJECT
DATA ON YTDVAR9A
END
-RUN



DEFINE FILE YTDAIR9
CATEGORY/A40 = 'Cost/(Savings) over Previous Year';
CAT_ORDER/I2 = 2;
ROW_LABEL/A8 = '&&RLBL.EVAL';
ROW_ORDER/I2 = 13;
AIRLINE_NAME1/A12 = LCWORD(12, AIRLINE_NAME, AIRLINE_NAME1);
END
-RUN

TABLE FILE YTDAIR9
PRINT CATEGORY/A40 AND ROW_LABEL/A8 AND
CAT_ORDER/I2 AND ROW_ORDER/I2 AND CS/D9 AS 'AIR_9'   
ON TABLE HOLD AS YTDCVAR9
END
-RUN


TABLE FILE YTDCVAR9
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND ROW_ORDER AND AIR_9  
ON TABLE HOLD AS YTDCVAR9A
END
MODIFY FILE SMP_FAR2
FIXFORM FROM YTDCVAR9A
MATCH CATEGORY ROW_LABEL ROW_ORDER
ON MATCH UPDATE AIR_9 
ON NOMATCH REJECT
DATA ON YTDCVAR9A
END
-RUN

 

-NOMORE

 


TABLE FILE SMP_FAR2 
SUM AIR_N1
    AIR_N2
    AIR_N3
    AIR_N4
    AIR_N5
    AIR_N6
    AIR_N7
    AIR_N8
    AIR_N9
BY AIR_N1
BY AIR_N2
BY AIR_N3
BY AIR_N4
BY AIR_N5
BY AIR_N6
BY AIR_N7
BY AIR_N8
BY AIR_N9
ON TABLE HOLD AS NAMEONE
END
-RUN


TABLE FILE NAMEONE
SUM AIR_N1
      AIR_N2
      AIR_N3
      AIR_N4
      AIR_N5
      AIR_N6
      AIR_N7
      AIR_N8
      AIR_N9
ON TABLE HOLD AS NAMETWO FORMAT ALPHA
END
-RUN




- READ NAMETWO NOCLOSE &&AIR_N1.A12. &&AIR_N2.A12. &&AIR_N3.A12. ,
-        &&AIR_N4.A12. &&AIR_N5.A12. &&AIR_N6.A12. &&AIR_N7.A12. ,
-        &&AIR_N8.A12. &&AIR_N9.A12. 

-RUN


-SET &&AIRN1 =  '&&AIR_N1.EVAL';
-SET &&AIRN2 =  '&&AIR_N2.EVAL';
-SET &&AIRN3 =  '&&AIR_N3.EVAL';
-SET &&AIRN4 =  '&&AIR_N4.EVAL';
-SET &&AIRN5 =  '&&AIR_N5.EVAL';
-SET &&AIRN6 =  '&&AIR_N6.EVAL';
-SET &&AIRN7 =  '&&AIR_N7.EVAL';
-SET &&AIRN8 =  '&&AIR_N8.EVAL';
-SET &&AIRN9 =  '&&AIR_N9.EVAL';



-CLOSE NAMETWO





-* All airline graph creation




-SET &PRINT1  = 'AIR_TTL ';
-SET &PRINT2  = IF '&&AIR1.EVAL' EQ ' '  THEN ' ' ELSE 'AIR_1';                                             
-SET &PRINT3  = IF '&&AIR2.EVAL' EQ ' ' THEN ' ' ELSE 'AIR_2';                                            
-SET &PRINT4  = IF '&&AIR3.EVAL' EQ ' ' THEN ' ' ELSE 'AIR_3';                                             
-SET &PRINT5  = IF '&&AIR4.EVAL' EQ ' ' THEN ' ' ELSE 'AIR_4';                                             
-SET &PRINT6  = IF '&&AIR5.EVAL' EQ ' ' THEN ' ' ELSE 'AIR_5';                                             
-SET &PRINT7  = IF '&&AIR6.EVAL' EQ ' ' THEN ' ' ELSE 'AIR_6';                                             
-SET &PRINT8  = IF '&&AIR7.EVAL' EQ ' ' THEN ' ' ELSE 'AIR_7';                                            
-SET &PRINT9  = IF '&&AIR8.EVAL' EQ ' ' THEN ' ' ELSE 'AIR_8';                                             
-SET &PRINT10 = IF '&&AIR9.EVAL' EQ ' ' THEN ' ' ELSE 'AIR_9';                                             



TABLE FILE SMP_FAR2
PRINT
&PRINT1
&PRINT2
&PRINT3
&PRINT4
&PRINT5
&PRINT6
&PRINT7
&PRINT8
&PRINT9
&PRINT10
BY TRAN_MY
WHERE TRAN_MY NE ' '
WHERE CAT_ORDER EQ 1
ON TABLE HOLD AS JOY
END
-RUN


-IF &RECORDS EQ 0 GOTO SKIP_GRAPH1;
-RUN




-SET &&AIRNM1 = '&&AIR1.EVAL'||'-'||'&&AIRN1.EVAL';
-SET &&AIRNM2 = '&&AIR2.EVAL'||'-'||'&&AIRN2.EVAL';
-SET &&AIRNM3 = '&&AIR3.EVAL'||'-'||'&&AIRN3.EVAL';
-SET &&AIRNM4 = '&&AIR4.EVAL'||'-'||'&&AIRN4.EVAL';
-SET &&AIRNM5 = '&&AIR5.EVAL'||'-'||'&&AIRN5.EVAL';
-SET &&AIRNM6 = '&&AIR6.EVAL'||'-'||'&&AIRN6.EVAL';
-SET &&AIRNM7 = '&&AIR7.EVAL'||'-'||'&&AIRN7.EVAL';
-SET &&AIRNM8 = '&&AIR8.EVAL'||'-'||'&&AIRN8.EVAL';
-SET &&AIRNM9 = '&&AIR9.EVAL'||'-'||'&&AIRN9.EVAL';








-SET &SUM1 = 'AIR_TTL AS ''All Airlines''';
-SET &SUM2 =  IF '&&AIRN1.EVAL' EQ '            ' THEN ' ' ELSE 'AIR_1 AS ''&&AIRNM1.EVAL''';                                             
-SET &SUM3 =  IF '&&AIRN2.EVAL' EQ '            ' THEN ' ' ELSE 'AIR_2 AS ''&&AIRNM2.EVAL''';                                            
-SET &SUM4 =  IF '&&AIRN3.EVAL' EQ '            ' THEN ' ' ELSE 'AIR_3 AS ''&&AIRNM3.EVAL''';                                             
-SET &SUM5 =  IF '&&AIRN4.EVAL' EQ '            ' THEN ' ' ELSE 'AIR_4 AS ''&&AIRNM4.EVAL''';                                             
-SET &SUM6 =  IF '&&AIRN5.EVAL' EQ '            ' THEN ' ' ELSE 'AIR_5 AS ''&&AIRNM5.EVAL'''; 
-SET &SUM7 =  IF '&&AIRN6.EVAL' EQ '            ' THEN ' ' ELSE 'AIR_6 AS ''&&AIRNM6.EVAL''';                                             
-SET &SUM8 =  IF '&&AIRN7.EVAL' EQ '            ' THEN ' ' ELSE 'AIR_7 AS ''&&AIRNM7.EVAL''';                                            
-SET &SUM9 =  IF '&&AIRN8.EVAL' EQ '            ' THEN ' ' ELSE 'AIR_8 AS ''&&AIRNM8.EVAL''';                                             
-SET &SUM10 = IF '&&AIRN9.EVAL' EQ '            ' THEN ' ' ELSE 'AIR_9 AS ''&&AIRNM9.EVAL''';                                             

-IF &&AIR1 EQ ' ' AND &&AIR2 EQ ' ' AND &&AIR3 EQ ' ' AND &&AIR4 EQ ' '  AND &&AIR5 EQ ' ' 
- AND &&AIR6 EQ ' ' AND &&AIR7 EQ ' ' AND &&AIR8 EQ ' ' AND &&AIR9 EQ ' '  THEN GOTO GRAPH2;



-GRAPH



GRAPH FILE JOY
SUM
&SUM1  
&SUM2  
&SUM3  
&SUM4  
&SUM5  
&SUM6  
&SUM7
&SUM8
&SUM9
&SUM10
ACROSS TRAN_MY AS ' '
-* WHERE ( CAT_ORDER EQ 1 );
ON TABLE HOLD AS ALLAG1 FORMAT SVG
ON GRAPH SET 3D OFF
-* ON GRAPH SET GRID ON
ON TABLE SET GRAPHSTYLE *
setGraphType(17);
setMarkerDisplay(true);
setConnectLineMarkers(false);
setConnectScatterMarkers(false);
setO1LabelDisplay(true);
-* setO1AxisSide(3);
setO1LabelDisplay(true);
setFontSizeAbsolute(getO1Label(),true); 
setAutofit(getO1Label(),false);
setFontStyle(getO1Label(),0);
setFontSize(getO1Label(),7);
setFontName(getO1Label(),"Arial");
setO1LabelRotate(5);
setO1MajorGridDisplay(true);
setO1MinorGridDisplay(true);
setO1MajorGridStyle(0);
setO1MinorGridStyle(0);
-* setO1MajorGridDisplay(true);
-* setO1MajorGridStyle(0);
setO1MinorGridDisplay(false);
setAxisAssignment(0,0);
setSeriesType(0,1);
setY1LabelDisplay(true);
setY1LabelFormat(6);
setTextJustHoriz(getY1Label(),2);
setFontName(getY1Label(),"Arial");
setFontSizeAbsolute(getY1Label(),true);
setFontSize(getY1Label(),8);
setFontStyle(getY1Label(),0);
-* setY1AxisSide(0);
setY1MajorGridDisplay(false);
-* setY1MajorGridStyle(0);
-* setY1MinorGridDisplay(true);
-* setTextFormatPreset(getY1Label(),-1);
-* setTextFormatPattern(getY1Label(),"#.##");
-* setPieFeelerTextDisplay(1);
-* setPieLabelDisplay(0);
-* setTextFormatPreset(getPieSliceLabel(),1);
-* setRiserBorderMode(1);
-* setSeriesDefaultTransparentBorderColor(true);
-* setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(2);
setTitleString("Average Market Cost");
setTextJustHoriz(getTitle(),2);
setFontStyle(getTitle(),0);
setFontSize(getTitle(),10);
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(2, new Color, 115 160 247));
-* setFontSizeAbsolute(getY1Title(),true);
-* setFontSizeAbsolute(getY1Label(),true);
-* setFontSizeAbsolute(getY2Title(),true);
-* setFontSizeAbsolute(getY2Label(),true);
-* setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
END
-RUN

-GOTO SKIPJ


-GRAPH2



GRAPH FILE JOY
SUM
&SUM1  
&SUM2  
&SUM3  
&SUM4  
&SUM5  
&SUM6 
&SUM7
&SUM8
&SUM9
&SUM10
ACROSS TRAN_MY AS ' '
ON TABLE HOLD AS ALLAG1 FORMAT SVG
ON GRAPH SET 3D OFF
-* ON GRAPH SET GRID ON
ON TABLE SET GRAPHSTYLE *
setMarkerDisplay(true);
setConnectLineMarkers(false);
setConnectScatterMarkers(false);
setO1LabelDisplay(true);
setO1AxisSide(0);
setO1MajorGridDisplay(true);
setO1MajorGridStyle(0);
setO1MinorGridDisplay(false);
setAxisAssignment(0,0);
setSeriesType(0,1);
setY1LabelDisplay(true);
setY1AxisSide(0);
setY1MajorGridDisplay(true);
setY1MajorGridStyle(0);
setY1MinorGridDisplay(false);
setTextFormatPreset(getY1Label(),-1);
setTextFormatPattern(getY1Label(),"#.##");
setPieFeelerTextDisplay(1);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(1);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
-* setLegendDisplay(true);
-* setLegendPosition(2);
setTitleString("Domestic Average Market Cost");
setTextJustHoriz(getTitle(),2);
setFontStyle(getTitle(),0);
setFontSize(getTitle(),10);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
END
-RUN

-GOTO SKIPJ


-DEB

TABLE FILE SMP_FAR2
SUM SMP_FAR2.AIR_TTL AS 'All Airlines'
    SMP_FAR2.AIR_PT
    SMP_FAR2.AIR_1 AS '&&AIR1'
    SMP_FAR2.AIR_P1
    SMP_FAR2.AIR_2 AS '&&AIR2'
    SMP_FAR2.AIR_P2
    SMP_FAR2.AIR_3 AS '&&AIR3'    
    SMP_FAR2.AIR_P3
    SMP_FAR2.AIR_4 AS '&&AIR4'
    SMP_FAR2.AIR_P4
    SMP_FAR2.AIR_5 AS '&&AIR5'
    SMP_FAR2.AIR_P2
    SMP_FAR2.AIR_6 AS '&&AIR6'
    SMP_FAR2.AIR_P6
    SMP_FAR2.AIR_7 AS '&&AIR7'
    SMP_FAR2.AIR_P7
    SMP_FAR2.AIR_8 AS '&&AIR8'    
    SMP_FAR2.AIR_P8
    SMP_FAR2.AIR_9 AS '&&AIR9'
    SMP_FAR2.AIR_P9
BY SMP_FAR2.CAT_ORDER NOPRINT
BY SMP_FAR2.CATEGORY
-* BY KEY NOPRINT
BY SMP_FAR2.ROW_ORDER NOPRINT
BY SMP_FAR2.ROW_LABEL AS ''
END
-RUN
-EXIT


END
-RUN

-SKIPJ



-SET &&G_GIF=IF &LINES GT 0 THEN 'Y' ELSE 'N';


-XXIT
