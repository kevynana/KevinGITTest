-*
-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* File userrollupaudit.fex
-**********************************************************************
-* DATE           NAME               DESCRIPTION
-* 3/09/2016      RBaker	     S-16221 Excel report to audit user's list for TOTAL-R and also for all other users.
-*                                   Create a focexec that can be run at any time through Gotham Grinds with the following parameters:
-*                                    •	All TOTAL-R users (separate row per user/rollup)
-*                                    •	All other users and their rollups they have access to (separate row per user/rollup) – only if they have access to 5 or more rollups
-*                                    •	Excel spreadsheet format
-*
-DEFAULT &ROLLUP_NAME= 'TOTAL-R';
-DEFAULT &TITLETEXT  = 'Travel and Transport/User Audit Report';
-DEFAULT &RPT_NAME   = 'userrollupaudit';
-DEFAULT &RPT_TTL1   = 'User Audit Report - Post-trip Reporting';
-DEFAULT &RPT_TTL2   = ' ';
-DEFAULT &WFFMT      = 'EXL2K';
-*
JOIN CLEAR *
JOIN USER_NAME        IN USRTBL TO ALL USER_NAME   IN USRROLL AS J1_
JOIN CLIENT_ID_ROLLUP IN USRTBL TO ALL ROLLUP_CODE IN ROLLUP  AS J2_
-*
TABLE FILE USRTBL
SUM USER_NAME
BY USER_NAME NOPRINT
ON TABLE SET HOLDLIST PRINTONLY
WHERE ROLLUP_CODE EQ 'TOTAL-R'
ON TABLE SAVE AS USERHOLD
END
-RUN
-*
TABLE FILE USRTBL
SUM CNT.ROLLUP_CODE NOPRINT
 BY USER_NAME
PRINT ROLL_NAME AS 'Rollup Name'
 BY USER_NAME    AS 'User Name'
 BY EMAIL        AS 'Email Address'
 BY ROLLUP_CODE  AS 'Rollup Code'
 ON USER_NAME COMPUTE TOT_ROLLUPS/I9 = CNT.ROLLUP_CODE;
 ON USER_NAME SUBFOOT
 "TOTAL Rollups for <USER_NAME<+0>: <TOT_ROLLUPS"
 " "
ON TABLE SUBHEAD
" "
" &RPT_TTL1"
ON TABLE SUBFOOT
"Running for any user with access to 5+ rollups or access to TOTAL-R"
" "
"eTTek Review &DATEMDYY at &TOD  "
"RBaker - &RPT_NAME "
WHERE TOTAL CNT.ROLLUP_CODE GE 5 OR (USER_NAME IN FILE USERHOLD)
ON TABLE SET BYDISPLAY ON
ON TABLE SET PAGE-NUM OFF
ON TABLE NOTOTAL
ON TABLE PCHOLD FORMAT &WFFMT
ON TABLE SET STYLE *
     UNITS=IN,
     PAGESIZE='Letter',
     LEFTMARGIN=0.100000,
     RIGHTMARGIN=0.030000,
     TOPMARGIN=0.030000,
     BOTTOMMARGIN=0.050000,
     SQUEEZE=ON,
     ORIENTATION=PORTRAIT,
     TITLETEXT='&TITLETEXT',
$
TYPE=REPORT,
     FONT='ARIAL',
     SIZE=8,
     BACKCOLOR=NONE,
     STYLE=NORMAL,
$
TYPE=DATA,
     COLUMN=USER_NAME,
     COLOR=RGB(31 114 164),
$
TYPE=DATA,
     COLUMN=EMAIL,
     COLOR=RGB(31 114 164),
$
TYPE=TABHEADING,
     SIZE=8,
     STYLE=BOLD,
     FONT='ARIAL',
     COLOR=RGB(31 114 164),
     BACKCOLOR=NONE,
$
TYPE=TABHEADING,
     HEADALIGN=BODY,
$
TYPE=TABHEADING,
     LINE=1,
     COLSPAN=4,
$
TYPE=TABHEADING,
     LINE=2,
     COLSPAN=4,
     SIZE=9,
     JUSTIFY=CENTER,
$
TYPE=TABHEADING,
     LINE=4,
     COLSPAN=4,
     SIZE=9,
     JUSTIFY=CENTER,
$
TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8,
     COLOR='WHITE',
     BACKCOLOR=RGB(31 114 164),
     STYLE=BOLD,
$
TYPE=DATA,
     BACKCOLOR=( RGB(239 239 239) 'WHITE'),
$
TYPE=TABFOOTING,
     FONT=ARIAL,
     COLOR=GRAY,
$
TYPE=TABFOOTING,
     LINE=1,
     COLSPAN=4,
	 OBJECT=TEXT,
	 ITEM=1,
     FONT=ARIAL,
     COLOR=BLACK,
     SIZE=8,
     JUSTIFY=LEFT,
$
TYPE=TABFOOTING,
     LINE=3,
     COLSPAN=4,
	 OBJECT=TEXT,
	 ITEM=1,
     FONT=ARIAL,
     COLOR=GRAY,
     SIZE=8,
     JUSTIFY=LEFT,
$
TYPE=TABFOOTING,
     LINE=4,
     COLSPAN=4,
	 OBJECT=TEXT,
	 ITEM=1,
     FONT=ARIAL,
     COLOR=GRAY,
     SIZE=7,
     JUSTIFY=LEFT,
$
TYPE=TABFOOTING,
     LINE=4,
     COLSPAN=4,
	 OBJECT=FIELD,
	 ITEM=1,
     FONT=ARIAL,
     COLOR=GRAY,
     SIZE=7,
     JUSTIFY=LEFT,
$
TYPE=SUBFOOT,
     BY=1,
     LINE=1,
     SIZE=8,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     COLOR='WHITE',
     BACKCOLOR=RGB(31 114 164),
     STYLE=BOLD,
$
TYPE=SUBTOTAL,
     SIZE=8,
     STYLE=BOLD,
$
TYPE=GRANDTOTAL,
     SIZE=8,
     STYLE=BOLD,
$
ENDSTYLE
END
