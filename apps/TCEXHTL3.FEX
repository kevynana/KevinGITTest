-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* 09/15/2015  DV  S-05438 Changed to use modify instead of maintain

-INCLUDE SETECHO
SET ASNAMES = ON
-* File TCEXHTL3.FEX

-SET &ECHO = ALL;

-GOTO SKIPit;
TABLEF FILE HOLD3
PRINT
CDM1HTL_AMT CDM1HTL_DAY CDM1HTL_RMS
CIM1HTL_AMT CIM1HTL_DAY CIM1HTL_RMS
PDM1HTL_AMT PDM1HTL_DAY PDM1HTL_RMS
PIM1HTL_AMT PIM1HTL_DAY PIM1HTL_RMS
CDY1HTL_AMT CDY1HTL_DAY CDY1HTL_RMS
CIY1HTL_AMT CIY1HTL_DAY CIY1HTL_RMS
PDY1HTL_AMT PDY1HTL_DAY PDY1HTL_RMS
PIY1HTL_AMT PIY1HTL_DAY PIY1HTL_RMS
CDM1AVG_RATE
CIM1AVG_RATE
PDM1AVG_RATE
PIM1AVG_RATE
CDY1AVG_RATE
CIY1AVG_RATE
PDY1AVG_RATE
PIY1AVG_RATE
ON TABLE HOLD AS HTLSUMLD
END
-*-EXIT


MATCH FILE TSHTLHLD
PRINT CDM1HTL_AMT CDM1HTL_DAY CDM1HTL_RMS
CIM1HTL_AMT CIM1HTL_DAY CIM1HTL_RMS
PDM1HTL_AMT PDM1HTL_DAY PDM1HTL_RMS
PIM1HTL_AMT PIM1HTL_DAY PIM1HTL_RMS
CDY1HTL_AMT CDY1HTL_DAY CDY1HTL_RMS
CIY1HTL_AMT CIY1HTL_DAY CIY1HTL_RMS
PDY1HTL_AMT PDY1HTL_DAY PDY1HTL_RMS
PIY1HTL_AMT PIY1HTL_DAY PIY1HTL_RMS
CDM1AVG_RATE
CIM1AVG_RATE
PDM1AVG_RATE
PIM1AVG_RATE
CDY1AVG_RATE
CIY1AVG_RATE
PDY1AVG_RATE
PIY1AVG_RATE
CDMTAT_SAV 
CIMTAT_SAV
CDYTAT_SAV
CIYTAT_SAV
PDMTAT_SAV
PIMTAT_SAV
PDYTAT_SAV
PIYTAT_SAV
BY FLAG
AFTER MATCH HOLD AS HTLSUMLD OLD-OR-NEW
END
-RUN

-SKIPit
 

DEFINE FILE TC_TSHTL1
FLAG/A1 = 'A';
END
TABLEF FILE TC_TSHTL1
PRINT
CDM1HTL_AMT CDM1HTL_DAY CDM1HTL_RMS
CIM1HTL_AMT CIM1HTL_DAY CIM1HTL_RMS
PDM1HTL_AMT PDM1HTL_DAY PDM1HTL_RMS
PIM1HTL_AMT PIM1HTL_DAY PIM1HTL_RMS
CDY1HTL_AMT CDY1HTL_DAY CDY1HTL_RMS
CIY1HTL_AMT CIY1HTL_DAY CIY1HTL_RMS
PDY1HTL_AMT PDY1HTL_DAY PDY1HTL_RMS
PIY1HTL_AMT PIY1HTL_DAY PIY1HTL_RMS
CDM1AVG_RATE
CIM1AVG_RATE
PDM1AVG_RATE
PIM1AVG_RATE
CDY1AVG_RATE
CIY1AVG_RATE
PDY1AVG_RATE
PIY1AVG_RATE

-* Hotel Nights


COMPUTE DHDYVAR/D10 = CDM1HTL_DAY - PDM1HTL_DAY ;
COMPUTE DHDYVPCT/D6.2= IF ((PDM1HTL_DAY LT 1) AND (PDM1HTL_DAY GT (-1))) THEN 0 ELSE
                           (DHDYVAR/PDM1HTL_DAY) * 100;
COMPUTE IHDAYVAR/D10 = CIM1HTL_DAY - PIM1HTL_DAY;
COMPUTE IHDAYVPCT/D6.2= IF ((PIM1HTL_DAY LT 1) AND (PIM1HTL_DAY GT (-1))) THEN 0 ELSE
                           (IHDAYVAR/PIM1HTL_DAY) * 100;
COMPUTE CTHDAY/D10 = CDM1HTL_DAY + CIM1HTL_DAY;
COMPUTE PTHDAY/D10 = PDM1HTL_DAY + PIM1HTL_DAY;
COMPUTE THDAYVAR/D10 = CTHDAY - PTHDAY;
COMPUTE THDAYVPCT/D6.2= IF ((PTHDAY LT 1) AND (PTHDAY GT (-1))) THEN 0 ELSE
                           (THDAYVAR/PTHDAY) * 100;

-*Rooms
 
COMPUTE DHRMVAR/D10 = CDM1HTL_RMS - PDM1HTL_RMS ;
COMPUTE DHRMVPCT/D6.2= IF ((PDM1HTL_RMS LT 1) AND (PDM1HTL_RMS GT (-1))) THEN 0 ELSE
                           (DHRMVAR/PDM1HTL_RMS) * 100;
COMPUTE IHRMVAR/D10 = CIM1HTL_RMS - PIM1HTL_RMS;
COMPUTE IHRMVPCT/D6.2= IF ((PIM1HTL_RMS LT 1) AND (PIM1HTL_RMS GT (-1))) THEN 0 ELSE
                           (IHRMVAR/PIM1HTL_RMS) * 100;
COMPUTE CTHRM/D10 = CDM1HTL_RMS + CIM1HTL_RMS;
COMPUTE PTHRM/D10 = PDM1HTL_RMS + PIM1HTL_RMS;
COMPUTE THRMVAR/D10 = CTHRM - PTHRM;
COMPUTE THRMVPCT/D6.2= IF ((PTHRM LT 1) AND (PTHRM GT (-1))) THEN 0 ELSE
                           (THRMVAR/PTHRM) * 100;
-* Total Amount
COMPUTE DHAMTVAR/D10 = CDM1HTL_AMT - PDM1HTL_AMT ;
COMPUTE DHAMTVPCT/D6.2= IF ((PDM1HTL_AMT LT 1) AND (PDM1HTL_AMT GT (-1))) THEN 0 ELSE
                           (DHAMTVAR/PDM1HTL_AMT) * 100;
COMPUTE IHAMTVAR/D10 = CIM1HTL_AMT - PIM1HTL_AMT;
COMPUTE IHAMTVPCT/D6.2= IF ((PIM1HTL_AMT LT 1) AND (PIM1HTL_AMT GT (-1))) THEN 0 ELSE
                           (IHAMTVAR/PIM1HTL_AMT) * 100;
COMPUTE CTHAMT/D10 = CDM1HTL_AMT + CIM1HTL_AMT;
COMPUTE PTHAMT/D10 = PDM1HTL_AMT + PIM1HTL_AMT;
COMPUTE THAMTVAR/D10 = CTHAMT - PTHAMT;
COMPUTE THAMTVPCT/D6.2= IF ((PTHAMT LT 1) AND (PTHAMT GT (-1))) THEN 0 ELSE
                           (THAMTVAR/PTHAMT) * 100;
-*Avg. Room Rate

COMPUTE DHAVGTVAR/D10 = CDM1AVG_RATE - PDM1AVG_RATE ;
COMPUTE DHAVGVPCT/D6.2= IF ((PDM1AVG_RATE LT 1) AND (PDM1AVG_RATE GT (-1))) THEN 0 ELSE
                           (DHAVGTVAR/PDM1AVG_RATE) * 100;
COMPUTE IHAVGVAR/D10 = CIM1AVG_RATE - PIM1AVG_RATE;
COMPUTE IHAVGVPCT/D6.2= IF ((PIM1AVG_RATE LT 1) AND (PIM1AVG_RATE GT (-1))) THEN 0 ELSE
                           (IHAVGVAR/PIM1AVG_RATE) * 100;
COMPUTE CTHAVG/D10= IF ((CTHDAY LT 1) AND (CTHDAY GT (-1))) THEN 0 ELSE
                           (CTHAMT/CTHDAY) ;
COMPUTE PTHAVG/D10= IF ((PTHDAY LT 1) AND (PTHDAY GT (-1))) THEN 0 ELSE
                           (PTHAMT/PTHDAY) ; 
COMPUTE THAVGVAR/D10 = CTHAVG - PTHAVG ;                           
COMPUTE THAVGVPCT/D6.2= IF ((PTHAVG LT 1) AND (PTHAVG GT (-1))) THEN 0 ELSE
                           (THAVGVAR/PTHAVG) * 100;   

-* YTD Hotel Nights


COMPUTE DYHDYVAR/D10 = CDY1HTL_DAY - PDY1HTL_DAY ;
COMPUTE DYHDYVPCT/D6.2= IF ((PDY1HTL_DAY LT 1) AND (PDY1HTL_DAY GT (-1))) THEN 0 ELSE
                           (DYHDYVAR/PDY1HTL_DAY) * 100;
COMPUTE IYHDAYVAR/D10 = CIY1HTL_DAY - PIY1HTL_DAY;
COMPUTE IYHDAYVPCT/D6.2= IF ((PIY1HTL_DAY LT 1) AND (PIY1HTL_DAY GT (-1))) THEN 0 ELSE
                           (IYHDAYVAR/PIY1HTL_DAY) * 100;
COMPUTE CYTHDAY/D10 = CDY1HTL_DAY + CIY1HTL_DAY;
COMPUTE PYTHDAY/D10 = PDY1HTL_DAY + PIY1HTL_DAY;
COMPUTE TYHDAYVAR/D10 = CYTHDAY - PYTHDAY;
COMPUTE TYHDAYVPCT/D6.2= IF ((PYTHDAY LT 1) AND (PYTHDAY GT (-1))) THEN 0 ELSE
                           (TYHDAYVAR/PYTHDAY) * 100;

-*YTD Rooms
 
COMPUTE DYHRMVAR/D10 = CDY1HTL_RMS - PDY1HTL_RMS ;
COMPUTE DYHRMVPCT/D6.2= IF ((PDY1HTL_RMS LT 1) AND (PDY1HTL_RMS GT (-1))) THEN 0 ELSE
                           (DYHRMVAR/PDY1HTL_RMS) * 100;
COMPUTE IYHRMVAR/D10 = CIY1HTL_RMS - PIY1HTL_RMS;
COMPUTE IYHRMVPCT/D6.2= IF ((PIY1HTL_RMS LT 1) AND (PIY1HTL_RMS GT (-1))) THEN 0 ELSE
                           (IYHRMVAR/PIY1HTL_RMS) * 100;
COMPUTE CYTHRM/D10 = CDY1HTL_RMS + CIY1HTL_RMS;
COMPUTE PYTHRM/D10 = PDY1HTL_RMS + PIY1HTL_RMS;
COMPUTE TYHRMVAR/D10 = CYTHRM - PYTHRM;
COMPUTE TYHRMVPCT/D6.2= IF ((PYTHRM LT 1) AND (PYTHRM GT (-1))) THEN 0 ELSE
                           (TYHRMVAR/PYTHRM) * 100;
-* YTD Total Amount
COMPUTE DYHAMTVAR/D10 = CDY1HTL_AMT - PDY1HTL_AMT ;
COMPUTE DYHAMTVPCT/D6.2= IF ((PDY1HTL_AMT LT 1) AND (PDY1HTL_AMT GT (-1))) THEN 0 ELSE
                           (DYHAMTVAR/PDY1HTL_AMT) * 100;
COMPUTE IYHAMTVAR/D10 = CIY1HTL_AMT - PIY1HTL_AMT;
COMPUTE IYHAMTVPCT/D6.2= IF ((PIY1HTL_AMT LT 1) AND (PIY1HTL_AMT GT (-1))) THEN 0 ELSE
                           (IYHAMTVAR/PIY1HTL_AMT) * 100;
COMPUTE CYTHAMT/D10 = CDY1HTL_AMT + CIY1HTL_AMT;
COMPUTE PYTHAMT/D10 = PDY1HTL_AMT + PIY1HTL_AMT;
COMPUTE TYHAMTVAR/D10 = CYTHAMT - PYTHAMT;
COMPUTE TYHAMTVPCT/D6.2= IF ((PYTHAMT LT 1) AND (PYTHAMT GT (-1))) THEN 0 ELSE
                           (TYHAMTVAR/PYTHAMT) * 100;
-*YTD Avg. Room Rate

COMPUTE DYHAVGTVAR/D10 = CDY1AVG_RATE - PDY1AVG_RATE ;
COMPUTE DYHAVGVPCT/D6.2= IF ((PDY1AVG_RATE LT 1) AND (PDY1AVG_RATE GT (-1))) THEN 0 ELSE
                           (DYHAVGTVAR/PDY1AVG_RATE) * 100;
COMPUTE IYHAVGVAR/D10 = CIY1AVG_RATE - PIY1AVG_RATE;
COMPUTE IYHAVGVPCT/D6.2= IF ((PIY1AVG_RATE LT 1) AND (PIY1AVG_RATE GT (-1))) THEN 0 ELSE
                           (IYHAVGVAR/PIY1AVG_RATE) * 100;
COMPUTE CYTHAVG/D10= IF ((CYTHDAY LT 1) AND (CYTHDAY GT (-1))) THEN 0 ELSE
                           (CYTHAMT/CYTHDAY) ;
COMPUTE PYTHAVG/D10= IF ((PYTHDAY LT 1) AND (PYTHDAY GT (-1))) THEN 0 ELSE
                           (PYTHAMT/PYTHDAY) ; 
COMPUTE TYHAVGVAR/D10 = CYTHAVG - PYTHAVG ;                           
COMPUTE TYHAVGVPCT/D6.2= IF ((PYTHAMT LT 1) AND (PYTHAMT GT (-1))) THEN 0 ELSE
                           (TYHAVGVAR/PYTHAVG) * 100;   

                           
BY FLAG
ON TABLE HOLD AS TC_TSHTL2
END
-RUN


-* Hotel Nights
DEFINE FILE TC_TSHTL2
CATEGORY/A30 = 'Hotel';
CAT_ORDER/I2 = 4;
ROW_LABEL/A20 = 'Hotel Nights';
ROW_ORDER/I2 = 1;
END
TABLE FILE TC_TSHTL2
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDM1HTL_DAY/D10 AS 'DOM_CURR' 
PDM1HTL_DAY/D10 AS 'DOM_PRIOR' DHDYVAR/D10 AS 'DOM_VAR_VAL' DHDYVPCT/D6  AS 'DOM_VAR_PCT' 
CIM1HTL_DAY/D10 AS 'INT_CURR' PIM1HTL_DAY/D10 AS 'INT_PRIOR'
IHDAYVAR/D10 AS 'INT_VAR_VAL'  IHDAYVPCT/D6  AS 'INT_VAR_PCT'
CTHDAY/D10 AS 'DI_CURR' PTHDAY/D10 AS 'DI_PRIOR' THDAYVAR/D10 AS 'DI_VAR_VAL'
THDAYVPCT/D6  AS 'DI_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS HDAY
END
-RUN

TABLE FILE HDAY
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DOM_CURR
AND DOM_PRIOR AND DOM_VAR_VAL AND DOM_VAR_PCT AND INT_CURR AND INT_PRIOR
AND INT_VAR_VAL AND INT_VAR_PCT AND DI_CURR AND DI_PRIOR AND DI_VAR_VAL AND DI_VAR_PCT
ON TABLE HOLD AS HDAY1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM HDAY1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DOM_CURR DOM_PRIOR DOM_VAR_VAL DOM_VAR_PCT INT_CURR INT_PRIOR INT_VAR_VAL INT_VAR_PCT DI_CURR DI_PRIOR DI_VAR_VAL DI_VAR_PCT
ON NOMATCH INCLUDE
DATA ON HDAY1
END
-RUN

-*Rooms
 
DEFINE FILE TC_TSHTL2
CATEGORY/A30 = 'Hotel';
CAT_ORDER/I2 = 4;
ROW_LABEL/A20 = 'Rooms';
ROW_ORDER/I2 = 2;
END
TABLE FILE TC_TSHTL2
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDM1HTL_RMS/D10 AS 'DOM_CURR' 
PDM1HTL_RMS/D10 AS 'DOM_PRIOR' DHRMVAR/D10 AS 'DOM_VAR_VAL' DHRMVPCT/D6  AS 'DOM_VAR_PCT' 
CIM1HTL_RMS/D10 AS 'INT_CURR' PIM1HTL_RMS/D10 AS 'INT_PRIOR'
IHRMVAR/D10 AS 'INT_VAR_VAL'  IHRMVPCT/D6  AS 'INT_VAR_PCT'
CTHRM/D10 AS 'DI_CURR' PTHRM/D10 AS 'DI_PRIOR' THRMVAR/D10 AS 'DI_VAR_VAL'
THRMVPCT/D6  AS 'DI_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS HROOMS
END
-RUN

TABLE FILE HROOMS
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DOM_CURR
AND DOM_PRIOR AND DOM_VAR_VAL AND DOM_VAR_PCT AND INT_CURR AND INT_PRIOR
AND INT_VAR_VAL AND INT_VAR_PCT AND DI_CURR AND DI_PRIOR AND DI_VAR_VAL AND DI_VAR_PCT
ON TABLE HOLD AS HROOMS1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM HROOMS1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DOM_CURR DOM_PRIOR DOM_VAR_VAL DOM_VAR_PCT INT_CURR INT_PRIOR INT_VAR_VAL INT_VAR_PCT DI_CURR DI_PRIOR DI_VAR_VAL DI_VAR_PCT
ON NOMATCH INCLUDE
DATA ON HROOMS1
END
-RUN
-* Total Amount

DEFINE FILE TC_TSHTL2
CATEGORY/A30 = 'Hotel';
CAT_ORDER/I2 = 4;
ROW_LABEL/A20 = 'Total Amount';
ROW_ORDER/I2 = 3;
END
TABLE FILE TC_TSHTL2
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDM1HTL_AMT/D10 AS 'DOM_CURR' 
PDM1HTL_AMT/D10 AS 'DOM_PRIOR' DHAMTVAR/D10 AS 'DOM_VAR_VAL' DHAMTVPCT/D6  AS 'DOM_VAR_PCT' 
CIM1HTL_AMT/D10 AS 'INT_CURR' PIM1HTL_AMT/D10 AS 'INT_PRIOR'
IHAMTVAR/D10 AS 'INT_VAR_VAL'  IHAMTVPCT/D6  AS 'INT_VAR_PCT'
CTHAMT/D10 AS 'DI_CURR' PTHAMT/D10 AS 'DI_PRIOR' THAMTVAR/D10 AS 'DI_VAR_VAL'
THAMTVPCT/D6  AS 'DI_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS HAMT
END
-RUN

TABLE FILE HAMT
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DOM_CURR
AND DOM_PRIOR AND DOM_VAR_VAL AND DOM_VAR_PCT AND INT_CURR AND INT_PRIOR
AND INT_VAR_VAL AND INT_VAR_PCT AND DI_CURR AND DI_PRIOR AND DI_VAR_VAL AND DI_VAR_PCT
ON TABLE HOLD AS HAMT1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM HAMT1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DOM_CURR DOM_PRIOR DOM_VAR_VAL DOM_VAR_PCT INT_CURR INT_PRIOR INT_VAR_VAL INT_VAR_PCT DI_CURR DI_PRIOR DI_VAR_VAL DI_VAR_PCT
ON NOMATCH INCLUDE
DATA ON HAMT1
END
-RUN

-*Avg. Room Rate

DEFINE FILE TC_TSHTL2
CATEGORY/A30 = 'Hotel';
CAT_ORDER/I2 = 4;
ROW_LABEL/A20 = 'Avg. Room Rate';
ROW_ORDER/I2 = 4;
END
TABLE FILE TC_TSHTL2
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDM1AVG_RATE/D10 AS 'DOM_CURR' 
PDM1AVG_RATE/D10 AS 'DOM_PRIOR' DHAVGTVAR/D10 AS 'DOM_VAR_VAL' DHAVGVPCT/D6  AS 'DOM_VAR_PCT' 
CIM1AVG_RATE/D10 AS 'INT_CURR' PIM1AVG_RATE/D10 AS 'INT_PRIOR'
IHAVGVAR/D10 AS 'INT_VAR_VAL'  IHAVGVPCT/D6  AS 'INT_VAR_PCT'
CTHAVG/D10 AS 'DI_CURR' PTHAVG/D10 AS 'DI_PRIOR' THAVGVAR/D10 AS 'DI_VAR_VAL'
THAVGVPCT/D6  AS 'DI_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS HAVG
END
-RUN

TABLE FILE HAVG
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DOM_CURR
AND DOM_PRIOR AND DOM_VAR_VAL AND DOM_VAR_PCT AND INT_CURR AND INT_PRIOR
AND INT_VAR_VAL AND INT_VAR_PCT AND DI_CURR AND DI_PRIOR AND DI_VAR_VAL AND DI_VAR_PCT
ON TABLE HOLD AS HAVG1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM HAVG1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DOM_CURR DOM_PRIOR DOM_VAR_VAL DOM_VAR_PCT INT_CURR INT_PRIOR INT_VAR_VAL INT_VAR_PCT DI_CURR DI_PRIOR DI_VAR_VAL DI_VAR_PCT
ON NOMATCH INCLUDE
DATA ON HAVG1
END
-RUN









                           

-* YTD Hotel Nights


DEFINE FILE TC_TSHTL2
CATEGORY/A30 = 'Hotel';
CAT_ORDER/I2 = 9;
ROW_LABEL/A20 = 'Hotel Nights';
ROW_ORDER/I2 = 1;
END
TABLE FILE TC_TSHTL2
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDY1HTL_DAY/D10 AS 'DYTD_CURR' 
PDY1HTL_DAY/D10 AS 'DYTD_PRIOR' DYHDYVAR/D10 AS 'DYTD_VAR_VAL' DYHDYVPCT/D6  AS 'DYTD_VAR_PCT' 
CIY1HTL_DAY/D10 AS 'IYTD_CURR' PIY1HTL_DAY/D10 AS 'IYTD_PRIOR'
IYHDAYVAR/D10 AS 'IYTD_VAR_VAL'  IYHDAYVPCT/D6  AS 'IYTD_VAR_PCT'
CYTHDAY/D10 AS 'DIYTD_CURR' PYTHDAY/D10 AS 'DIYTD_PRIOR' TYHDAYVAR/D10 AS 'DIYTD_VAR_VAL'
TYHDAYVPCT/D6  AS 'DIYTD_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS YHDAY
END
-RUN

TABLE FILE YHDAY
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DYTD_CURR
AND DYTD_PRIOR AND DYTD_VAR_VAL AND DYTD_VAR_PCT AND IYTD_CURR AND IYTD_PRIOR
AND IYTD_VAR_VAL AND IYTD_VAR_PCT AND DIYTD_CURR AND DIYTD_PRIOR AND DIYTD_VAR_VAL AND DIYTD_VAR_PCT
ON TABLE HOLD AS YHDAY1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM YHDAY1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DYTD_CURR DYTD_PRIOR DYTD_VAR_VAL DYTD_VAR_PCT IYTD_CURR IYTD_PRIOR IYTD_VAR_VAL IYTD_VAR_PCT DIYTD_CURR DIYTD_PRIOR DIYTD_VAR_VAL DIYTD_VAR_PCT
ON NOMATCH INCLUDE
DATA ON YHDAY1
END
-RUN


-*YTD Rooms
                          
                          
DEFINE FILE TC_TSHTL2
CATEGORY/A30 = 'Hotel';
CAT_ORDER/I2 = 9;
ROW_LABEL/A20 = 'Rooms';
ROW_ORDER/I2 = 2;
END
TABLE FILE TC_TSHTL2
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDY1HTL_RMS/D10 AS 'DYTD_CURR' 
PDY1HTL_RMS/D10 AS 'DYTD_PRIOR' DYHRMVAR/D10 AS 'DYTD_VAR_VAL' DYHRMVPCT/D6  AS 'DYTD_VAR_PCT' 
CIY1HTL_RMS/D10 AS 'IYTD_CURR' PIY1HTL_RMS/D10 AS 'IYTD_PRIOR'
IYHRMVAR/D10 AS 'IYTD_VAR_VAL'  IYHRMVPCT/D6  AS 'IYTD_VAR_PCT'
CYTHRM/D10 AS 'DIYTD_CURR' PYTHRM/D10 AS 'DIYTD_PRIOR' TYHRMVAR/D10 AS 'DIYTD_VAR_VAL'
TYHRMVPCT/D6  AS 'DIYTD_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS YHROOMS
END
-RUN

TABLE FILE YHROOMS
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DYTD_CURR
AND DYTD_PRIOR AND DYTD_VAR_VAL AND DYTD_VAR_PCT AND IYTD_CURR AND IYTD_PRIOR
AND IYTD_VAR_VAL AND IYTD_VAR_PCT AND DIYTD_CURR AND DIYTD_PRIOR AND DIYTD_VAR_VAL AND DIYTD_VAR_PCT
ON TABLE HOLD AS YHROOMS1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM YHROOMS1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DYTD_CURR DYTD_PRIOR DYTD_VAR_VAL DYTD_VAR_PCT IYTD_CURR IYTD_PRIOR IYTD_VAR_VAL IYTD_VAR_PCT DIYTD_CURR DIYTD_PRIOR DIYTD_VAR_VAL DIYTD_VAR_PCT
ON NOMATCH INCLUDE
DATA ON YHROOMS1
END
-RUN

-* YTD Total Amount

DEFINE FILE TC_TSHTL2
CATEGORY/A30 = 'Hotel';
CAT_ORDER/I2 = 9;
ROW_LABEL/A20 = 'Total Amount';
ROW_ORDER/I2 = 3;
END
TABLE FILE TC_TSHTL2
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDY1HTL_AMT/D10 AS 'DYTD_CURR' 
PDY1HTL_AMT/D10 AS 'DYTD_PRIOR' DYHAMTVAR/D10 AS 'DYTD_VAR_VAL' DYHAMTVPCT/D6  AS 'DYTD_VAR_PCT' 
CIY1HTL_AMT/D10 AS 'IYTD_CURR' PIY1HTL_AMT/D10 AS 'IYTD_PRIOR'
IYHAMTVAR/D10 AS 'IYTD_VAR_VAL'  IYHAMTVPCT/D6  AS 'IYTD_VAR_PCT'
CYTHAMT/D10 AS 'DIYTD_CURR' PYTHAMT/D10 AS 'DIYTD_PRIOR' TYHAMTVAR/D10 AS 'DIYTD_VAR_VAL'
TYHAMTVPCT/D6  AS 'DIYTD_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS YHAMT
END
-RUN

TABLE FILE YHAMT
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DYTD_CURR
AND DYTD_PRIOR AND DYTD_VAR_VAL AND DYTD_VAR_PCT AND IYTD_CURR AND IYTD_PRIOR
AND IYTD_VAR_VAL AND IYTD_VAR_PCT AND DIYTD_CURR AND DIYTD_PRIOR AND DIYTD_VAR_VAL AND DIYTD_VAR_PCT
ON TABLE HOLD AS YHAMT1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM YHAMT1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DYTD_CURR DYTD_PRIOR DYTD_VAR_VAL DYTD_VAR_PCT IYTD_CURR IYTD_PRIOR IYTD_VAR_VAL IYTD_VAR_PCT DIYTD_CURR DIYTD_PRIOR DIYTD_VAR_VAL DIYTD_VAR_PCT
ON NOMATCH INCLUDE
DATA ON YHAMT1
END
-RUN

-*YTD Avg. Room Rate
 

DEFINE FILE TC_TSHTL2
CATEGORY/A30 = 'Hotel';
CAT_ORDER/I2 = 9;
ROW_LABEL/A20 = 'Avg. Room Rate';
ROW_ORDER/I2 = 4;
END
TABLE FILE TC_TSHTL2
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDY1AVG_RATE/D10 AS 'DYTD_CURR' 
PDY1AVG_RATE/D10 AS 'DYTD_PRIOR' DYHAVGTVAR/D10 AS 'DYTD_VAR_VAL' DYHAVGVPCT/D6  AS 'DYTD_VAR_PCT' 
CIY1AVG_RATE/D10 AS 'IYTD_CURR' PIY1AVG_RATE/D10 AS 'IYTD_PRIOR'
IYHAVGVAR/D10 AS 'IYTD_VAR_VAL'  IYHAVGVPCT/D6  AS 'IYTD_VAR_PCT'
CYTHAVG/D10 AS 'DIYTD_CURR' PYTHAVG/D10 AS 'DIYTD_PRIOR' TYHAVGVAR/D10 AS 'DIYTD_VAR_VAL'
TYHAVGVPCT/D6  AS 'DIYTD_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS YHAVG
END
-RUN

TABLE FILE YHAVG
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DYTD_CURR
AND DYTD_PRIOR AND DYTD_VAR_VAL AND DYTD_VAR_PCT AND IYTD_CURR AND IYTD_PRIOR
AND IYTD_VAR_VAL AND IYTD_VAR_PCT AND DIYTD_CURR AND DIYTD_PRIOR AND DIYTD_VAR_VAL AND DIYTD_VAR_PCT
ON TABLE HOLD AS YHAVG1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM YHAVG1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DYTD_CURR DYTD_PRIOR DYTD_VAR_VAL DYTD_VAR_PCT IYTD_CURR IYTD_PRIOR IYTD_VAR_VAL IYTD_VAR_PCT DIYTD_CURR DIYTD_PRIOR DIYTD_VAR_VAL DIYTD_VAR_PCT
ON NOMATCH INCLUDE
DATA ON YHAVG1
END
-RUN
 
-GOTO HTLxxit;
DEFINE FILE TC2_MAIN
KEY/A1 = IF CAT_ORDER EQ 3 THEN 'Y' ELSE 'N'; 
END         
TABLEF FILE TC2_MAIN
ON TABLE SET PAGE-NUM OFF
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DOM_CURR
AND DOM_PRIOR AND DOM_VAR_VAL AND DOM_VAR_PCT AND INT_CURR AND INT_PRIOR
AND INT_VAR_VAL AND INT_VAR_PCT AND DI_CURR AND DI_PRIOR AND DI_VAR_VAL AND DI_VAR_PCT AND DYTD_CURR
AND DYTD_PRIOR AND DYTD_VAR_VAL AND DYTD_VAR_PCT AND IYTD_CURR AND IYTD_PRIOR
AND IYTD_VAR_VAL AND IYTD_VAR_PCT AND DIYTD_CURR AND DIYTD_PRIOR AND DIYTD_VAR_VAL AND DIYTD_VAR_PCT

  
BY CAT_ORDER  
BY ROW_ORDER  
BY ROW_LABEL
-*ON TABLE HOLD AS HTLSUM 
END
-RUN
-QUIT
 
-HTLxxit
