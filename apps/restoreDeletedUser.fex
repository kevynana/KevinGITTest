-**************************************************************************************************
-* restoreDeletedUser.fex
-* this fex will restore deleted user and his/her reports from the following tables and databases.
-*
-* STEP 1. RESTORE RELATED SQL DATABASES AND FOCUS DATABASES TO TNT\RESTORE FOLDER
-* STEP 2. CREATE SYNONYMS for deleted tables 
-* STEP 3. UPDATE the variables as required 
-*
-* following SQL tables and SU databases will be updated.
-* USRTBL, USRROLL, USERCNTL, botuprof
-* 
-* BACKUP FILES NAMES IN tnt\restore folder
-* USRTBL_0105, USRROLL_0105, botuprof_0105,  USERCNTX, RPT_SET_0105, RPTINSTX, RPTFLDSX
-*
-* Note: RUN this program through RunInteractive_LS.fex in apps 
-*
-* Lsi  01/06/2016
-**************************************************************************************************
-SET &ECHO=ALL;

-DEFAULT &USER = 'staciev';
-DEFAULT &SRCSQLDB = 'TTracker_20160104.dbo.Rpt_Set';
SET HOLDLIST = PRINTONLY
-RUN
USE CLEAR *
APP MAP RESTORE "\\omawebfocus05\d\tnt\restore"
APP PREPENDPATH  RESTORE
APP HOLDDATA RESTORE
APP HOLDMETA RESTORE
-RUN

TABLE FILE USRTBL_0105
PRINT *
WHERE USER_NAME EQ '&USER.EVAL'
ON TABLE HOLD AS 'HRSERS'
END
-RUN
-SET &USERLINES = &LINES;

-IF &USERLINES EQ 0 THEN GOTO DoneUser;
MODIFY FILE USRTBL
FIXFORM FROM HRSERS
  MATCH USER_NAME
   ON NOMATCH INCLUDE
   ON MATCH REJECT
DATA ON HRSERS
END
-RUN
-DoneUser

TABLE FILE USRROLL_0105
PRINT *
WHERE USER_NAME EQ '&USER.EVAL'
ON TABLE HOLD AS 'HUSROLLS'
END
-RUN
-SET &UROLLLINES = &LINES;

-IF &UROLLLINES EQ 0 THEN GOTO DoneURolls;
MODIFY FILE USRROLL
FIXFORM FROM HUSROLLS
  MATCH USER_NAME CLIENT_ID_ROLLUP
   ON NOMATCH INCLUDE
   ON MATCH REJECT
DATA ON HUSROLLS
END
-RUN
-DoneURolls

TABLE FILE botuprof_0105
PRINT *
WHERE CASTER_USER EQ '&USER.EVAL'
ON TABLE HOLD AS 'HCASTER'
END
-RUN
WHENCE USERCNTL FOCUS
-RUN
-SET &CASTERLINES = &LINES;

-IF &CASTERLINES EQ 0 THEN GOTO DoneCaster;
MODIFY FILE botuprof
FIXFORM FROM HCASTER
  MATCH CASTER_USER
   ON NOMATCH INCLUDE
   ON MATCH REJECT
DATA ON HCASTER
END
-RUN
-DoneCaster

-*USERCNTL DATABASE
TABLE FILE USERCNTX
PRINT USER_NAME ROLLUP_CODE SEL_LEVEL LEVEL ROLL_LEV
WHERE USER_NAME EQ '&USER.EVAL'
ON TABLE HOLD AS 'HUSRCNTL'
END
-RUN
WHENCE USERCNTL FOCUS
-RUN
-SET &CNTLLINES = &LINES;

EX SUUSES
-RUN

-IF &CNTLLINES EQ 0 THEN GOTO DoneUcntl;
MODIFY FILE USERCNTL
FIXFORM FROM HUSRCNTL
  MATCH USER_NAME
   ON NOMATCH INCLUDE
   ON MATCH REJECT
  MATCH ROLLUP_CODE
   ON NOMATCH INCLUDE
   ON MATCH REJECT
  MATCH LEVEL ROLL_LEV
   ON NOMATCH INCLUDE
   ON MATCH REJECT   
DATA ON HUSRCNTL
END
-RUN
-DoneUcntl

-SQLONLY
-**********************************************************
-*USE SQL TO INSERT DELETED RECORDS INTO RPT_SET
SQL SQLMSS
SET IDENTITY_INSERT TTracker.dbo.Rpt_Set ON

INSERT INTO
  TTracker.dbo.Rpt_Set (
  SET_KEY,
  ROLLUP_CODE,
  SET_NAME,
  USER_NAME,
  USER_SECURITY,
  SET_TYPE,
  SET_FREQ,
  CDATE,
  LDATE
  )
SELECT
  SET_KEY,
  ROLLUP_CODE,
  SET_NAME,
  USER_NAME,
  USER_SECURITY,
  SET_TYPE,
  SET_FREQ,
  CDATE,
  LDATE
FROM 	&SRCSQLDB
  WHERE USER_NAME = '&USER.EVAL';

-*  TTracker_20160104.dbo.Rpt_Set
-*WHERE USER_NAME = 'staciev';

SET IDENTITY_INSERT TTracker.dbo.Rpt_Set OFF
END
-RUN
-**********************************************************

TABLE FILE RPT_SET_0105
PRINT *
BY SET_KEY NOPRINT
WHERE USER_NAME EQ '&USER.EVAL'
ON TABLE HOLD AS RPTSET2
END
-RUN

-* save deleted set_keys for RPT_INST(SET_KEY/I7) 
DEFINE FILE RPTSET2
 KEYS/I7 = SET_KEY;
END
TABLE FILE RPTSET2
BY KEYS AS 'SET_KEY'
ON TABLE SAVE AS SETKEYS
END
-RUN


-*ENGINE SQLMSS SET IDENTITY_INSERT Review.dbo.rpt_set ON
-*-RUN

-*SQL SQLMSS
-*SET IDENTITY_INSERT Review.dbo.rpt_set ON
-*END
-RUN
-*UPDATE RPT_SET
-*MODIFY FILE &RPT_SET
-*FIXFORM FROM RPTSET2
-*MATCH SET_KEY
-* ON NOMATCH INCLUDE
-* ON MATCH REJECT
-*DATA ON RPTSET2
-*END
-*-RUN

-*SQL SQLMSS
-*SET IDENTITY_INSERT Review.dbo.rpt_set OFF
-*END
-*-RUN


WHENCE RPTINSTX FOCUS
WHENCE RPTINSTX MASTER
-RUN

-*retrieve from rptinstx
TABLE FILE RPTINSTX
PRINT *
WHERE SET_KEY IN FILE SETKEYS
ON TABLE HOLD AS 'RPTINST2'
END
-RUN

-*SAVE INSTKEYS FOR RPT_FLDS DATABASE
TABLE FILE RPTINST2
BY INST_KEY
ON TABLE SAVE AS INSTKEYS
END
-RUN

EX SUUSES
-RUN
WHENCE RPT_INST FOCUS
WHENCE RPT_INST MASTER
-RUN

-*UPDATE RPT_INST
MODIFY FILE RPT_INST
FIXFORM FROM RPTINST2
MATCH INST_KEY
 ON MATCH REJECT
 ON NOMATCH INCLUDE
MATCH ID
 ON MATCH REJECT
 ON NOMATCH INCLUDE
DATA ON RPTINST2
END
-RUN


-*retrieve from RPTFLDSX DATABASE
-SEG1
TABLE FILE RPTFLDSX
PRINT SEG.RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE HOLD AS 'RPTFLDS1'
END
-RUN
-SET &SEG1 = &LINES;

-SEG2
TABLE FILE RPTFLDSX
PRINT SEG.COMMON1.INCL1
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE HOLD AS 'RPTFLDS2'
END
-RUN
-SET &SEG2 = &LINES;

-SEG3
TABLE FILE RPTFLDSX
PRINT SEG.COMMON2.SEQ_NO
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE HOLD AS 'RPTFLDS3'
END
-RUN
-SET &SEG3 = &LINES;

-SEG4
TABLE FILE RPTFLDSX
PRINT SEG.AIR.ID
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDS4'
END
-RUN
-SET &SEG4 = &LINES;

-SEG5
TABLE FILE RPTFLDSX
PRINT SEG.AIRFLDS.SEQ_NO
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDS5'
END
-RUN
-SET &SEG5 = &LINES;

-SEG6
TABLE FILE RPTFLDSX
PRINT SEG.CAR.ID
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDS6'
END
-RUN
-SET &SEG6= &LINES;

-SEG7
TABLE FILE RPTFLDSX
PRINT SEG.CARFLDS.SEQ_NO
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDS7'
END
-RUN
-SET &SEG7 = &LINES;

-SEG8
TABLE FILE RPTFLDSX
PRINT SEG.HTL.ID
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDS8'
END
-RUN
-SET &SEG8 = &LINES;

-SEG9
TABLE FILE RPTFLDSX
PRINT SEG.HTLFLDS.SEQ_NO
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDS9'
END
-RUN
-SET &SEG9 = &LINES;

-SEG10
TABLE FILE RPTFLDSX
PRINT SEG.HIEORG1.ID
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDSA'
END
-RUN
-SET &SEGA = &LINES;

-SEG11
TABLE FILE RPTFLDSX
PRINT SEG.HIEORG2.SEQ_NO
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDSB'
END
-RUN
-SET &SEGB = &LINES;

-SEG12
TABLE FILE RPTFLDSX
PRINT SEG.ROLL1.ID
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDSC'
END
-RUN
-SET &SEGC = &LINES;

-SEG13
TABLE FILE RPTFLDSX
PRINT SEG.ROLL2.SEQ_NO
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDSD'
END
-RUN
-SET &SEGD = &LINES;

-SEG14
TABLE FILE RPTFLDSX
PRINT SEG.TRVLSMRY.ID
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDSE'
END
-RUN
-SET &SEGE = &LINES;

-SEG15
TABLE FILE RPTFLDSX
PRINT SEG.UDINFO.UID
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDSF'
END
-RUN
-SET &SEGF = &LINES;

-SEG16
TABLE FILE RPTFLDSX
PRINT SEG.QREVIEW.RPT_ID
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDSG'
END
-RUN
-SET &SEGG = &LINES;

-SEG17
TABLE FILE RPTFLDSX
PRINT SEG.QREVIEW2.SEQ_NO
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDSH'
END
-RUN
-SET &SEGH = &LINES;

-SEG18
TABLE FILE RPTFLDSX
PRINT SEG.DVR.DVRID
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDSI'
END
-RUN
-SET &SEGI = &LINES;

-SEG19
TABLE FILE RPTFLDSX
PRINT SEG.OPTION1
BY RPT_INST.INST_KEY
WHERE INST_KEY IN FILE INSTKEYS
ON TABLE SAVE AS 'RPTFLDSJ'
END
-RUN
-SET &SEGJ = &LINES;

-*UPDATE RPT_FLDS
-IF &SEG1 EQ 0 THEN GOTO EndRptflds;

-SEG21
MODIFY FILE RPT_FLDS
FIXFORM FROM RPTFLDS1
MATCH INST_KEY
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDS1
END
-RUN

-SEG22
-IF &SEG2 EQ 0 THEN GOTO SEG23;
MODIFY FILE RPT_FLDS
FIXFORM FROM RPTFLDS2
  MATCH INST_KEY INCL1
   ON NOMATCH INCLUDE
   ON MATCH REJECT
DATA ON RPTFLDS2
END
-RUN

-SEG23
-IF &SEG3 EQ 0 THEN GOTO SEG24;
MODIFY FILE RPT_FLDS
FIXFORM FROM RPTFLDS3
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH REJECT
MATCH * KEYS SEG COMMON2
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDS3
END
-RUN

-SEG24
-IF &SEG4 EQ 0 THEN GOTO SEG25;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 AIR.ID/1 AIR.INCL1/1 AIR.INCL2/1 AIR.INCL3/1
FIXFORM AIR.INCL4/1 AIR.INCL5/1 AIR.INCL6/1 AIR.INCL7/1 AIR.INCL8/1
FIXFORM AIR.INCL9/1 AIR.INCL10/1  AIR.INCL11/1 AIR.INCL12/1
FIXFORM INTDOMT/1 INTDOMS/1 AIR.RANKBYTOP1/5 AIR.RANKMETHOD/1
FIXFORM CLASSCAT_A/1 CLASSCAT_F/1 CLASSCAT_B/1 CLASSCAT_C/1 CLASSCAT_D/1 
FIXFORM CLASSCAT_DEF/1 CLASSCAT_UPG/1
FIXFORM TRANS_TYPE_S/1 TRANS_TYPE_E/1 TRANS_TYPE_R/1 TRANS_TYPE_V/1
FIXFORM ADV_PUR_A/1 ADV_PUR_0/1 ADV_PUR_7/1 ADV_PUR_14/1 ADV_PUR_21/1
FIXFORM AIR.RANKBYTOP2/5 AIR.CITYPAIRFLD/1 AIRFORECAST/3 AIR.INCL13/1
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG AIR
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDS4
END
-RUN

-SEG25
-IF &SEG5 EQ 0 THEN GOTO SEG26;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 AIRFLDS.SEQ_NO/2 AIRFLDS.PASSENGER/A33 TICKET_NO/A10
FIXFORM DPT_AIRPORT/A3 RTE_AIRPORT/A3 VAL_AIR/A3 FLOWN_AIR/A3
FIXFORM AIRFLDS.REFUSE_CODE/A2 CP_AIRPORT/A6
FIXFORM AIRFLDS.TRIP_CODE/A2 NHTL_CODE/A2 ORG_APC/A3 DST_APC/A3 PNR_LOCATOR/A6
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG AIRFLDS
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDS5
END
-RUN

-SEG26
-IF &SEG6 EQ 0 THEN GOTO SEG27;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 CAR.ID/1 CAR.INCL1/1 CAR.INCL2/1 CAR.INCL3/1
FIXFORM CAR.INCL4/1 CAR.INCL5/1 CAR.INCL6/1
FIXFORM CAR.RANKBYTOP/5 CAR.RANKMETHOD/1 RATEALL/1
FIXFORM RATE1/1 RATE2/1 RATE3/1 RATE4/1 RATE5/1 RATE6/1 INTDOMC/1 CARFORECAST/3
FIXFORM CAR.CINCL7/1 
REPOSTION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG CAR
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDS6
END
-RUN

-SEG27
-IF &SEG7 EQ 0 THEN GOTO SEG28;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 CARFLDS.SEQ_NO/2 CARFLDS.PASSENGER/A33
FIXFORM VENDOR_CODE/A2  CARFLDS.REFUSE_CODE/A2
FIXFORM PICKUP_CITY/A3  DROPOFF_CITY/A3 CAR_TYPE/A7 CTRIP_CODE/A2
REPOSTION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG CARFLDS
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDS7
END
-RUN

-SEG28
-IF &SEG8 EQ 0 THEN GOTO SEG29;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 HTL.ID/1 HTL.INCL1/1 HTL.INCL2/1 HTL.INCL3/1
FIXFORM HTL.INCL4/1 HTL.RANKBYTOP1/5 HTL.RANKMETHOD/1 HTL.RANKBYTOP2/5 INTDOMH/1 HTLFORECAST/3
FIXFORM HTL.HINCL5/1
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH HTL.ID
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDS8
END
-RUN


-SEG29
-IF &SEG9 EQ 0 THEN GOTO SEG2A;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 HTLFLDS.SEQ_NO/2 HTLFLDS.PASSENGER/A33
FIXFORM CHAIN_CODE/A2 HTL_CITY/A3 HTLFLDS.REFUSE_CODE/A2 HTRIP_CODE/A2
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG HTLFLDS
  ON NOMATCH INCLUDE
  ON MATCH INCLUDE
DATA ON RPTFLDS9
END
-RUN

-SEG2A
-IF &SEGA EQ 0 THEN GOTO SEG2B;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 HIEORG1.ID/1 HIEORG1.INCL1/1 HIEORG1.INCL2/1
FIXFORM HIEORG1.INCL3/1 HIEORG1.SEL_LEVEL/A2 SLTMEM/A64
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG HIEORG1
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDSA
END
-RUN

-SEG2B
-IF &SEGB EQ 0 THEN GOTO SEG2C;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 HIEORG2.SEQ_NO/2 HIEORG2.CLIENT/A8
FIXFORM HIEORG2.CATG/A15 HIEORG2.MEMBER/A15 LEVEL/A2
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG HIEORG2
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDSB
END
-RUN

-SEG2C
-IF &SEGC EQ 0 THEN GOTO SEG2D;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 ROLL1.ID/1 ROLL1.INCL1/1 ROLL1.INCL2/1 ROLL1.INCL3/1
FIXFORM ROLL1.INCL4/1 ROLL1.INCL5/1 ROLL1.INCL6/1 ROLL1.OF_ACCT/1 ROLL1.CTD/1
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG ROLL1
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDSC
END
-RUN

-SEG2D
-IF &SEGD EQ 0 THEN GOTO SEG2E;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 ROLL2.SEQ_NO/4 ROLL2.ROLLUP/A8 ROLL2.BRANCH_CODE/A2
FIXFORM ROLL2.RESV_BRANCH/A2 ROLL2.TKT_BRANCH/A2
FIXFORM ROLL2.CATG2/A15 ROLL2.BR_CL_IDX/A8 ROLL2.ROLLUP2/A8
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG ROLL2
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDSD
END
-RUN

-SEG2E
-IF &SEGE EQ 0 THEN GOTO SEG2F;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 TRVLSMRY.ID/2 TRVLSMRY.ORDER/2 TRVLSMRY.CHECKED/1
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG TRVLSMRY
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDSE
END
-RUN

-SEG2F
-IF &SEGF EQ 0 THEN GOTO SEG2G;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 UID/3 UINCL/1 UDID/A3 UDDATA/A64 FROMVAL/16 TOVAL/16
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG UDINFO
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDSF
END
-RUN

-SEG2G
-IF &SEGG EQ 0 THEN GOTO SEG2H;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 RPT_ID/3 RPT_NBR/3 RPT_ABBR/10 RPT_MISC/7
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG QREVIEW
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDSG
END
-RUN
 
-SEG2H 
-IF &SEGH EQ 0 THEN GOTO SEG2I;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 QREVIEW2.SEQ_NO/4 QREVIEW2.PEERGRP/1 QREVIEW2.PEERMBR/8
FIXFORM QREVIEW2.CPEERGRP/1 QREVIEW2.CPEERMBR/8 QREVIEW2.HPEERGRP/1
FIXFORM QREVIEW2.HPEERMBR/8 QREVIEW2.PERCENT/3 QREVIEW2.AL_MFC/A2
FIXFORM QREVIEW2.AL_CSA/A2 QREVIEW2.AL_MSM/A2 QREVIEW2.AL_CA/A2
FIXFORM QREVIEW2.LSO_AMT/7 QREVIEW2.OA_PCT/3 QREVIEW2.CP_LOGO/20 AL_ADA/2 
FIXFORM QREVIEW2.LPEERGRP/1 QREVIEW2.LPEERMBR/8 QREVIEW2.HSA/1 QREVIEW2.HZA/1
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH * KEYS SEG QREVIEW2
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDSH
END
-RUN

-SEG2I
-IF &SEGI EQ 0 THEN GOTO SEG2J;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 DVRID/1 TRAN1/1 TRAN2/1 TRAN3/1 TRAN4/1 TRAN5/1 
FIXFORM LSONLY/1 UNUSEDT1/1 UNUSEDT2/1 UNUSEDT3/1 UNUSEDT4/1
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH DVRID
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDSI
END
-RUN

-SEG2J
-IF &SEGJ EQ 0 THEN GOTO EndRptflds;
MODIFY FILE RPT_FLDS
FIXFORM INST_KEY/7 OPTION1/1 OPTION2/1 OPTION3/1 OPTION4/1 OPTION5/1 OPTION6/1 
REPOSITION INST_KEY
MATCH INST_KEY
  ON MATCH CONTINUE
  ON NOMATCH INCLUDE
MATCH OPTION1
  ON NOMATCH INCLUDE
  ON MATCH REJECT
DATA ON RPTFLDSJ
END
-RUN

-EndRptflds

