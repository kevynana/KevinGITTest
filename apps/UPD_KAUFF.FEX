SET ASNAMES = ON

TABLE FILE SZKAUFF
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS SEGHOLD
END
-RUN

MODIFY FILE SZKAUFF
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH COMPUTE AROLL_LEV7=' ';
ON MATCH COMPUTE AROLL_LEV8=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON NOMATCH REJECT
DATA ON SEGHOLD
END
-RUN

TABLE FILE SZKAUFF
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AROLL_LEV3 EQ 'KAUFFB'
ON TABLE HOLD AS SEGHOLD2
END
-RUN

MODIFY FILE SZKAUFF
FIXFORM FROM SEGHOLD2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='DEFDEPT';
ON MATCH UPDATE AROLL_LEV3
ON NOMATCH REJECT
DATA ON SEGHOLD2
END
-RUN




TABLE FILE MZKAUFF
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS MKTHOLD
END
-RUN

MODIFY FILE MZKAUFF
FIXFORM FROM MKTHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH COMPUTE AROLL_LEV7=' ';
ON MATCH COMPUTE AROLL_LEV8=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON NOMATCH REJECT
DATA ON MKTHOLD
END
-RUN

TABLE FILE MZKAUFF
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AROLL_LEV3 EQ 'KAUFFB'
ON TABLE HOLD AS MKTHOLD2
END
-RUN

MODIFY FILE MZKAUFF
FIXFORM FROM MKTHOLD2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='DEFDEPT';
ON MATCH UPDATE AROLL_LEV3
ON NOMATCH REJECT
DATA ON MKTHOLD2
END
-RUN


TABLE FILE DZKAUFF
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS DSTHOLD
END
-RUN

MODIFY FILE DZKAUFF
FIXFORM FROM DSTHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH COMPUTE AROLL_LEV7=' ';
ON MATCH COMPUTE AROLL_LEV8=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON NOMATCH REJECT
DATA ON DSTHOLD
END
-RUN

TABLE FILE DZKAUFF
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AROLL_LEV3 EQ 'KAUFFB'
ON TABLE HOLD AS DSTD2
END
-RUN

MODIFY FILE DZKAUFF
FIXFORM FROM DSTD2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='DEFDEPT';
ON MATCH UPDATE AROLL_LEV3
ON NOMATCH REJECT
DATA ON DSTD2
END
-RUN




TABLE FILE CZKAUFF
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD AS CARHOLD
END
-RUN

MODIFY FILE CZKAUFF
FIXFORM FROM CARHOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH COMPUTE AROLL_LEV7=' ';
ON MATCH COMPUTE AROLL_LEV8=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON NOMATCH REJECT
DATA ON CARHOLD
END
-RUN

TABLE FILE CZKAUFF
PRINT CAR_KEY 
BY CAR_KEY NOPRINT 
IF AROLL_LEV3 EQ 'KAUFFB'
ON TABLE HOLD AS CAR2
END
-RUN

MODIFY FILE CZKAUFF
FIXFORM FROM CAR2
MATCH CAR_KEY  
ON MATCH COMPUTE AROLL_LEV3='DEFDEPT';
ON MATCH UPDATE AROLL_LEV3
ON NOMATCH REJECT
DATA ON CAR2
END
-RUN


TABLE FILE HZKAUFF
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD AS HTLHOLD
END
-RUN

MODIFY FILE HZKAUFF
FIXFORM FROM HTLHOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH COMPUTE AROLL_LEV7=' ';
ON MATCH COMPUTE AROLL_LEV8=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON NOMATCH REJECT
DATA ON HTLHOLD
END
-RUN

TABLE FILE HZKAUFF
PRINT HTL_KEY 
BY HTL_KEY NOPRINT 
IF AROLL_LEV3 EQ 'KAUFFB'
ON TABLE HOLD AS HTL2
END
-RUN

MODIFY FILE HZKAUFF
FIXFORM FROM HTL2
MATCH HTL_KEY  
ON MATCH COMPUTE AROLL_LEV3='DEFDEPT';
ON MATCH UPDATE AROLL_LEV3
ON NOMATCH REJECT
DATA ON HTL2
END
-RUN
