-INCLUDE SETECHO
-* File ADMRESET.FEX
-*   Scaled down version of RESET for the Admin. Functions.
-*
REMOTE DEST=&&SRVR
-REMOTE BEGIN
TABLE FILE ROLLUP
PRINT  ROLLUP_CODE
       COMP AS COMPANY
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
ON TABLE PCHOLD AS HOLDF1
END
-RUN
-REMOTE END

-READ HOLDF1 &X.8 &&COMPNY.6
-RUN

-SET &HIER = &&HPF_PATH || 'HP' ||
- &&COMPNY || '.FOC AS HIER50';


USE
&HIER AS HIER50
END
-RUN

REMOTE DEST=&&SRVR
-REMOTE BEGIN
TABLE FILE ROLLUP
ON TABLE SET PAGE-NUM OFF
PRINT  ROLLUP_CODE
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
ON TABLE NOTOTAL
ON TABLE PCHOLD AS HOLDF2
END
-RUN
-REMOTE END

CREATE FILE CONTROL
-RUN

-TYPE Before first Control MODIFY
MODIFY FILE CONTROL
FIXFORM FROM HOLDF2
COMPUTE CONTROL_ID/A3  =  'PGM';
COMPUTE USER_ID/A20 = 'ADMIN';
COMPUTE SECURITY_LEVEL/I1 = 9;
COMPUTE WEB_RUN/A1 = 'N';
COMPUTE INST_KEY/A72 = ' ';
MATCH CONTROL_ID
 ON MATCH REJECT
 ON NOMATCH INCLUDE
DATA ON HOLDF2
END
-RUN

-DBSETS
-SET &&AIR_DB = 'A_' || &&COMPNY || '.FOC';
-SET &&CAR_DB = 'C_' || &&COMPNY || '.FOC';
-SET &&HTL_DB = 'H_' || &&COMPNY || '.FOC';
-SET &&SEG_DB = 'S_' || &&COMPNY || '.FOC';
-SET &&MRK_DB = 'M_' || &&COMPNY || '.FOC';
-SET &&DST_DB = 'D_' || &&COMPNY || '.FOC';
-SET &&AH_DB = 'AH' || &&COMPNY || '.FOC';
-SET &&CH_DB = 'AH' || &&COMPNY || '.FOC';
-SET &&HH_DB = 'AH' || &&COMPNY || '.FOC';
-SET &&HIER = 'HP' || &&COMPNY || '.FOC';
-SET &&XHIER = 'HX' || &&COMPNY || '.FOC';
-SET &&DAIR_DB = 'AIR_MAIN.';
-SET &&DCAR_DB = 'CAR_MAIN.';
-SET &&DHTL_DB = 'HTL_MAIN.';
-SET &&DSEG_DB = 'S_' || &&COMPNY || '.';
-SET &&DMRK_DB = 'M_' || &&COMPNY || '.';
-SET &&DDST_DB = 'D_' || &&COMPNY || '.';

-SET &&USE_HIER = &&HPF_PATH || &&HIER;
-SET &&USE_XHIER = &&HPF_PATH || &&XHIER;


-SET &&AUSEPASS = &&TEMP_PATH || 'AUSEINCL.FTM';
-SET &&CUSEPASS = &&TEMP_PATH || 'CUSEINCL.FTM';
-SET &&HUSEPASS = &&TEMP_PATH || 'HUSEINCL.FTM';
-RUN

-XEND
