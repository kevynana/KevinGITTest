
SET EMPTYREPORT = ON
SET LINES=99999
-DEFAULT &OWNER='$*';
-DEFAULT &ROLLUP='$*';
 
JOIN
 INNER PUSH_GROUPS.PUSH_GROUPS.GROUP_KEY IN PUSH_GROUPS TO MULTIPLE
 PUSH_REPORTS_KEYS.PUSH_REPORTS_KEYS.GROUP_KEY IN PUSH_REPORTS_KEYS AS J3
 END
JOIN
 INNER PUSH_REPORTS_KEYS.PUSH_REPORTS_KEYS.INST_KEY IN PUSH_GROUPS TO UNIQUE
 RPT_INST.RPT_INST.INST_KEY IN RPT_INST AS J4
 END
JOIN
 INNER RPT_INST.RPT_INST.SET_KEY IN PUSH_GROUPS TO UNIQUE
 RPT_SET.RPT_SET.SET_KEY IN RPT_SET AS J5
 END
JOIN
 INNER RPT_SET.RPT_SET.ROLLUP_CODE IN PUSH_GROUPS TO UNIQUE
 ROLLUP.ROLLUP.ROLLUP_CODE IN ROLLUP AS J6
 END
DEFINE FILE PUSH_GROUPS
WK/A1=IF SCHED_WEEKLY EQ '1' THEN 'Y' ELSE ' ';
MN/A1=IF SCHED_M EQ '1' THEN 'Y' ELSE ' ';
MY/A1=IF SCHED_MYTD EQ '1' THEN 'Y' ELSE ' ';
QT/A1=IF SCHED_Q EQ '1' THEN 'Y' ELSE ' ';
QY/A1=IF SCHED_QYTD EQ '1' THEN 'Y' ELSE ' ';
AN/A1=IF SCHED_A EQ '1' THEN 'Y' ELSE ' ';
LPD/MDYY=LAST_PROCESS_DATE;
LPDW/MDYY=LAST_WEEKLY_PROCESS_DATE;
END
TABLE FILE PUSH_GROUPS
PRINT
     RPT_NAME
     WK
     MN
     MY
     QT
     QY
     AN
     PUSH_EADDRS1
     PUSH_EADDRS2
     PUSH_EADDRS3
     SCHED_OWNER
     LPD
     LPDW
BY USER_NAME
BY ROLLUP_CODE
BY ROLL_NAME
BY SET_NAME
WHERE INST_KEY NE 0
WHERE ROLLUP_CODE NE ''
WHERE SCHED_OWNER EQ '&OWNER'
WHERE ROLLUP_CODE EQ '&ROLLUP'
ON TABLE HOLD AS HLDRI FORMAT FOCUS
END
-RUN
 
JOIN CLEAR *
JOIN
 INNER PUSH_GROUPS.PUSH_GROUPS.GROUP_KEY IN PUSH_GROUPS TO MULTIPLE
 PUSH_REPORTS_KEYS.PUSH_REPORTS_KEYS.GROUP_KEY IN PUSH_REPORTS_KEYS AS J3
 END
JOIN
 INNER PUSH_GROUPS.PUSH_GROUPS.SET_KEY IN PUSH_GROUPS TO UNIQUE
 RPT_SET.RPT_SET.SET_KEY IN RPT_SET AS J5
 END
JOIN
 INNER RPT_SET.RPT_SET.ROLLUP_CODE IN PUSH_GROUPS TO UNIQUE
 ROLLUP.ROLLUP.ROLLUP_CODE IN ROLLUP AS J6
 END
 
 
DEFINE FILE PUSH_GROUPS
RN/A50='All';
WK/A1=IF SCHED_WEEKLY EQ '1' THEN 'Y' ELSE ' ';
MN/A1=IF SCHED_M EQ '1' THEN 'Y' ELSE ' ';
MY/A1=IF SCHED_MYTD EQ '1' THEN 'Y' ELSE ' ';
QT/A1=IF SCHED_Q EQ '1' THEN 'Y' ELSE ' ';
QY/A1=IF SCHED_QYTD EQ '1' THEN 'Y' ELSE ' ';
AN/A1=IF SCHED_A EQ '1' THEN 'Y' ELSE ' ';
LPD/MDYY=LAST_PROCESS_DATE;
LPDW/MDYY=LAST_WEEKLY_PROCESS_DATE;
END
TABLE FILE PUSH_GROUPS
PRINT
     RN AS RPT_NAME
     WK
     MN
     MY
     QT
     QY
     AN
     PUSH_EADDRS1
     PUSH_EADDRS2
     PUSH_EADDRS3
     SCHED_OWNER
     LPD
     LPDW
BY USER_NAME
BY ROLLUP_CODE
BY ROLL_NAME
BY SET_NAME
WHERE INST_KEY EQ 0
WHERE ROLLUP_CODE NE ''
WHERE SCHED_OWNER EQ '&OWNER'
WHERE ROLLUP_CODE EQ '&ROLLUP'
ON TABLE HOLD AS HLDRS FORMAT FOCUS
ON TABLE SET ASNAMES ON
END
-RUN
 
USE CLEAR *
USE
HLDRI.FOC AS HLDRI
HLDRS.FOC AS HLDRI
END
-RUN
 
DEFINE FILE HLDRI
PUSH_EADDRS/A765=PUSH_EADDRS1 || PUSH_EADDRS2 || PUSH_EADDRS3;
END
TABLE FILE HLDRI
PRINT
     RPT_NAME AS 'Report Name'
     WK AS 'Weekly'
     MN AS 'Monthly'
     MY AS 'Monthly YTD'
     QT AS 'Quarterly'
     QY AS 'Quarterly YTD'
     AN AS 'Annually'
     PUSH_EADDRS AS 'Push to Email Addresses'
     LPDW AS 'Last,Weekly,Push'
     LPD AS 'Last,Monthly,Push'
BY SCHED_OWNER AS 'Schedule,Owner' UNDER-LINE
BY USER_NAME AS 'Set,Owner'
BY ROLLUP_CODE AS 'Rollup,Code'
BY ROLL_NAME AS 'Rollup'
BY SET_NAME AS 'Report Set'
HEADING
" "
"eTTek Review Push Reports"
ON TABLE SET PAGE-NUM OFF
ON TABLE NOTOTAL
ON TABLE PCHOLD FORMAT HTML
ON TABLE SET HTMLCSS ON
ON TABLE SET STYLE *
     UNITS=IN,
     PAGESIZE='Letter',
     LEFTMARGIN=0.250000,
     RIGHTMARGIN=0.250000,
     TOPMARGIN=0.250000,
     BOTTOMMARGIN=0.250000,
     SQUEEZE=ON,
     ORIENTATION=PORTRAIT,
$
TYPE=REPORT,
     FONT='ARIAL',
     SIZE=10,
     COLOR='BLACK',
     BACKCOLOR='NONE',
     STYLE=NORMAL,
$
TYPE=DATA,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8,
     BACKCOLOR=( RGB(242 242 242) 'WHITE' ),
$
TYPE=DATA,
     COLUMN=N12,
     JUSTIFY=CENTER,
$
TYPE=DATA,
     COLUMN=N11,
     JUSTIFY=CENTER,
$
TYPE=DATA,
     COLUMN=N10,
     JUSTIFY=CENTER,
$
TYPE=DATA,
     COLUMN=N9,
     JUSTIFY=CENTER,
$
TYPE=DATA,
     COLUMN=N8,
     JUSTIFY=CENTER,
$
TYPE=DATA,
     COLUMN=N7,
     JUSTIFY=CENTER,
$
TYPE=TITLE,
     COLUMN=N11,
     JUSTIFY=CENTER,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
$
TYPE=TITLE,
     COLUMN=N9,
     JUSTIFY=CENTER,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
$
TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=9,
     COLOR='WHITE',
     BACKCOLOR=RGB(154 175 212),
     STYLE=BOLD,
$
 
TYPE=HEADING,
     SIZE=12,
     COLOR=RGB(36 43 114),
     STYLE=BOLD,
     JUSTIFY=CENTER,
$
TYPE=FOOTING,
     STYLE=BOLD,
$
TYPE=SUBHEAD,
     SIZE=9,
     STYLE=BOLD,
$
TYPE=REPORT,
     IMAGE=/image/TNTLogo.gif,
     POSITION=(0.027778 0.027778),
     SIZE=(1.902778 0.652778),
$
TYPE=REPORT,
     COLUMN=N13,
     WRAP=8.000000,
$
ENDSTYLE
END
-RUN
 
JOIN CLEAR *
JOIN
 INNER PUSH_GROUPS.PUSH_GROUPS.GROUP_KEY IN PUSH_GROUPS TO MULTIPLE
 PUSH_REPORTS_KEYS.PUSH_REPORTS_KEYS.GROUP_KEY IN PUSH_REPORTS_KEYS AS J3
 END
JOIN
 INNER PUSH_REPORTS_KEYS.PUSH_REPORTS_KEYS.INST_KEY IN PUSH_GROUPS TO UNIQUE
 RPT_INST.RPT_INST.INST_KEY IN RPT_INST AS J4
 END
JOIN
 INNER RPT_INST.RPT_INST.SET_KEY IN PUSH_GROUPS TO UNIQUE
 RPT_SET.RPT_SET.SET_KEY IN RPT_SET AS J5
 END
JOIN
 INNER RPT_SET.RPT_SET.ROLLUP_CODE IN PUSH_GROUPS TO UNIQUE
 ROLLUP.ROLLUP.ROLLUP_CODE IN ROLLUP AS J6
 END
DEFINE FILE PUSH_GROUPS
WK/A1=IF SCHED_WEEKLY EQ '1' THEN 'Y' ELSE ' ';
MN/A1=IF SCHED_M EQ '1' THEN 'Y' ELSE ' ';
MY/A1=IF SCHED_MYTD EQ '1' THEN 'Y' ELSE ' ';
QT/A1=IF SCHED_Q EQ '1' THEN 'Y' ELSE ' ';
QY/A1=IF SCHED_QYTD EQ '1' THEN 'Y' ELSE ' ';
AN/A1=IF SCHED_A EQ '1' THEN 'Y' ELSE ' ';
LPD/MDYY=LAST_PROCESS_DATE;
LPDW/MDYY=LAST_WEEKLY_PROCESS_DATE;
END
TABLE FILE PUSH_GROUPS
PRINT
     RPT_NAME
     WK
     MN
     MY
     QT
     QY
     AN
     PUSH_EADDRS1
     PUSH_EADDRS2
     PUSH_EADDRS3
     SCHED_OWNER
     LPD
     LPDW
BY USER_NAME
BY ROLLUP_CODE
BY ROLL_NAME
BY SET_NAME
WHERE INST_KEY NE 0
WHERE ROLLUP_CODE NE ''
WHERE SCHED_OWNER EQ '&OWNER'
WHERE ROLLUP_CODE EQ '&ROLLUP'
ON TABLE HOLD AS HLDRI1 FORMAT FOCUS
END
-RUN
 
JOIN CLEAR *
JOIN
 INNER PUSH_GROUPS.PUSH_GROUPS.GROUP_KEY IN PUSH_GROUPS TO MULTIPLE
 PUSH_REPORTS_KEYS.PUSH_REPORTS_KEYS.GROUP_KEY IN PUSH_REPORTS_KEYS AS J3
 END
JOIN
 INNER PUSH_GROUPS.PUSH_GROUPS.SET_KEY IN PUSH_GROUPS TO UNIQUE
 RPT_SET.RPT_SET.SET_KEY IN RPT_SET AS J5
 END
JOIN
 INNER RPT_SET.RPT_SET.ROLLUP_CODE IN PUSH_GROUPS TO UNIQUE
 ROLLUP.ROLLUP.ROLLUP_CODE IN ROLLUP AS J6
 END
JOIN
 INNER RPT_SET.RPT_SET.SET_KEY IN PUSH_GROUPS TO MULTIPLE
 RPT_INST.RPT_INST.SET_KEY IN RPT_INST AS J7
 END
 
DEFINE FILE PUSH_GROUPS
RN/A50='All';
WK/A1=IF SCHED_WEEKLY EQ '1' THEN 'Y' ELSE ' ';
MN/A1=IF SCHED_M EQ '1' THEN 'Y' ELSE ' ';
MY/A1=IF SCHED_MYTD EQ '1' THEN 'Y' ELSE ' ';
QT/A1=IF SCHED_Q EQ '1' THEN 'Y' ELSE ' ';
QY/A1=IF SCHED_QYTD EQ '1' THEN 'Y' ELSE ' ';
AN/A1=IF SCHED_A EQ '1' THEN 'Y' ELSE ' ';
LPD/MDYY=LAST_PROCESS_DATE;
LPDW/MDYY=LAST_WEEKLY_PROCESS_DATE;
END
TABLE FILE PUSH_GROUPS
PRINT
  RPT_NAME
     WK
     MN
     MY
     QT
     QY
     AN
     PUSH_EADDRS1
     PUSH_EADDRS2
     PUSH_EADDRS3
     SCHED_OWNER
     LPD
     LPDW
BY USER_NAME
BY ROLLUP_CODE
BY ROLL_NAME
BY SET_NAME
WHERE INST_KEY EQ 0
WHERE ROLLUP_CODE NE ''
WHERE SCHED_OWNER EQ '&OWNER'
WHERE ROLLUP_CODE EQ '&ROLLUP'
ON TABLE HOLD AS HLDRS1 FORMAT FOCUS
ON TABLE SET ASNAMES ON
END
-RUN
 
USE
HLDRI1.FOC AS HLDRI1
HLDRS1.FOC AS HLDRI1
END
 
TABLE FILE HLDRI1
PRINT
     RPT_NAME
     WK
     MN
     MY
     QT
     QY
     AN
     PUSH_EADDRS1
     PUSH_EADDRS2
     PUSH_EADDRS3
     USER_NAME
     LPD
     LPDW
BY SCHED_OWNER
BY ROLLUP_CODE
BY ROLL_NAME
BY SET_NAME
ON TABLE HOLD AS HLDALL
END
-RUN
 
DEFINE FILE HLDALL
WK_CNT/I7C=IF WK EQ 'Y' THEN 1 ELSE 0;
MN_CNT/I7C=IF MN EQ 'Y' THEN 1 ELSE 0;
MY_CNT/I7C=IF MY EQ 'Y' THEN 1 ELSE 0;
QT_CNT/I7C=IF QT EQ 'Y' THEN 1 ELSE 0;
QY_CNT/I7C=IF QY EQ 'Y' THEN 1 ELSE 0;
AN_CNT/I7C=IF AN EQ 'Y' THEN 1 ELSE 0;
R_CNT/I7C=1;
U_CNT/I7C=IF SCHED_OWNER EQ LAST SCHED_OWNER THEN 0 ELSE 1;
END
TABLE FILE HLDALL
"eTTek Review Push Report Totals"
SUM
   U_CNT AS 'Users'
   R_CNT AS 'Reports'
   WK_CNT AS 'Weekly,Schedules'
   MN_CNT AS 'Monthly,Schedules'
   MY_CNT AS 'Monthly YTD,Schedules'
   QT_CNT AS 'Quarterly,Schedules'
   QY_CNT AS 'Quarterly YTD,Schedules'
   AN_CNT AS 'Annual,Schedules'
   COMPUTE TOT_CNT/I7C=WK_CNT + MN_CNT + MY_CNT + QT_CNT + QY_CNT + AN_CNT; AS 'Total,Schedules'
ON TABLE SET PAGE-NUM OFF
ON TABLE NOTOTAL
ON TABLE PCHOLD FORMAT HTML
ON TABLE SET HTMLCSS ON
ON TABLE SET STYLE *
     UNITS=IN,
     PAGESIZE='Letter',
     LEFTMARGIN=0.250000,
     RIGHTMARGIN=0.250000,
     TOPMARGIN=0.250000,
     BOTTOMMARGIN=0.250000,
     SQUEEZE=ON,
     ORIENTATION=PORTRAIT,
$
TYPE=REPORT,
     FONT='ARIAL',
     SIZE=10,
     COLOR='BLACK',
     BACKCOLOR='NONE',
     STYLE=NORMAL,
$
TYPE=DATA,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8,
     BACKCOLOR=( RGB(242 242 242) 'WHITE' ),
$
TYPE=TITLE,
     COLUMN=N9,
     JUSTIFY=CENTER,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
$
TYPE=TITLE,
     COLUMN=N7,
     JUSTIFY=CENTER,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
$
TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=9,
     COLOR='WHITE',
     BACKCOLOR=RGB(154 175 212),
     STYLE=BOLD,
$
 
TYPE=HEADING,
     SIZE=12,
     COLOR=RGB(36 43 114),
     STYLE=BOLD,
     JUSTIFY=CENTER,
$
TYPE=FOOTING,
     STYLE=BOLD,
$
TYPE=SUBHEAD,
     SIZE=9,
     STYLE=BOLD,
$
ENDSTYLE
END
