-*-INCLUDE SETECHO
-*-*SET TEMPERASE = OFF
-* bkupsu - used to backup the files under control of the SU machine.
-* Steve Cords - added code to backup RPT_FLDS and HRPTFLDS - 04/08/03
-* LS          - changed code as some su databases no longer being used
-*               and some were changed - 11/18/03.
-*
-*     Master File Name      Backup Name
-*     ----------------      ------------
-*     RPT_INST              RPTINST2
-*     RPT_FLDS              RPTFLDS2
-*     RPT_SET               RPT_SET2
-*     RPT_MSTR              RPTMSTR2
-*     RPT_KEY               RPT_KEY2
-*     ROLLUP                ROLLUP2
-*     ROLLSET               ROLLSET2
-*     ROLLQTR               ROLLQTR2
-*     RPT_QUE               RPT_QUE2
-*     HRPTINST              ZRPTINST
-*     HRPTFLDS              ZRPTFLDS
-*     HRPT_SET              ZRPT_SET

-* Create variables for current run
-SET &HOUR=EDIT(&TOD,'99');
-SET &BUPATH='D:\HOURLYBACKUPS2\' | &HOUR | '\';

-* Make directory to store backup file
-DOS MKDIR &BUPATH

EX SUUSES
-RUN

-*********************************************************************
-* Backup RPT_INST
-*
-RPT_INST
-TYPE Backing up RPT_INST....

-SET &RPTINST2=&BUPATH | 'RPTINST2.FOC';
FILEDEF RPTINST2 DISK &RPTINST2
-RUN

USE ADD
&RPTINST2 AS RPTINST2 NEW
END
-RUN

CREATE FILE RPTINST2
-RUN

TABLEF FILE RPT_INST
PRINT
  SEG.INST_KEY
ON TABLE HOLD AS HRINST1
END

TABLEF FILE RPT_INST
PRINT SEG.ID
BY INST_KEY
ON TABLE HOLD AS HRINST2
END

MODIFY FILE RPTINST2
FIXFORM FROM HRINST1
MATCH INST_KEY
 ON MATCH REJECT
 ON NOMATCH INCLUDE
DATA ON HRINST1
END
-RUN

MODIFY FILE RPTINST2
FIXFORM FROM HRINST2
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE 
MATCH ID
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRINST2
END
-RUN

-TYPE Backing up RPT_INST Complete
-*********************************************************************

-*********************************************************************
-* Backup RPT_FLDS
-*
-RPT_FLDS
-TYPE Backing up RPT_FLDS....

-SET &RPTFLDS2=&BUPATH | 'RPTFLDS2.FOC';
FILEDEF RPTFLDS2 DISK &RPTFLDS2
-RUN

USE ADD
&RPTFLDS2 AS RPTFLDS2 NEW
END
-RUN

CREATE FILE RPTFLDS2
-RUN

SET ASNAMES=ON

TABLEF FILE RPT_FLDS
PRINT INST_KEY USE_PARM
  BY INST_KEY NOPRINT
ON TABLE HOLD AS HRFLDS1
END

TABLEF FILE RPT_FLDS
PRINT SEG COMMON1.INCL1
BY INST_KEY
BY COMMON1.INCL1 NOPRINT
ON TABLE HOLD AS HRFLDS2
END

TABLEF FILE RPT_FLDS
PRINT SEG COMMON2.SEQ_NO
BY INST_KEY
BY COMMON2.SEQ_NO NOPRINT
ON TABLE HOLD AS HRFLDS3
END
-RUN

TABLEF FILE RPT_FLDS
PRINT AIR.ID AS 'AIR.ID'
AIR.INCL1 AS 'AIR.INCL1'
AIR.INCL2 AS 'AIR.INCL2'
AIR.INCL3 AS 'AIR.INCL3'
AIR.INCL4 AS 'AIR.INCL4'
AIR.INCL5 AS 'AIR.INCL5'
AIR.INCL6 AS 'AIR.INCL6'
AIR.INCL7 AS 'AIR.INCL7'
AIR.INCL8 AS 'AIR.INCL8'
AIR.INTDOMT AS 'AIR.INTDOMT'
AIR.INTDOMS AS 'AIR.INTDOMS'
AIR.RANKBYTOP1 AS 'AIR.RANKBYTOP1'
AIR.RANKMETHOD AS 'AIR.RANKMETHOD'
AIR.CLASSCAT_A AS 'AIR.CLASSCAT_A'
AIR.CLASSCAT_F AS 'AIR.CLASSCAT_F'
AIR.CLASSCAT_B AS 'AIR.CLASSCAT_B'
AIR.CLASSCAT_C AS 'AIR.CLASSCAT_C'
AIR.CLASSCAT_D AS 'AIR.CLASSCAT_D'
AIR.TRANS_TYPE_S AS 'AIR.TRANS_TYPE_S'
AIR.TRANS_TYPE_E AS 'AIR.TRANS_TYPE_E'
AIR.TRANS_TYPE_R AS 'AIR.TRANS_TYPE_R'
AIR.TRANS_TYPE_V AS 'AIR.TRANS_TYPE_V'
AIR.ADV_PUR_A AS 'AIR.ADV_PUR_A'
AIR.ADV_PUR_0 AS 'AIR.ADV_PUR_0'
AIR.ADV_PUR_7 AS 'AIR.ADV_PUR_7'
AIR.ADV_PUR_14 AS 'AIR.ADV_PUR_14'
AIR.ADV_PUR_21 AS 'AIR.ADV_PUR_21'
AIR.RANKBYTOP2 AS 'AIR.RANKBYTOP2'
AIR.CITYPAIRFLD AS 'AIR.CITYPAIRFLD'
BY INST_KEY
BY AIR.ID NOPRINT
ON TABLE HOLD AS HRFLDS4
END
-RUN

TABLEF FILE RPT_FLDS
PRINT AIRFLDS.SEQ_NO AS 'AIRFLDS.SEQ_NO'
AIRFLDS.PASSENGER AS 'AIRFLDS.PASSENGER'
AIRFLDS.TICKET_NO AS 'AIRFLDS.TICKET_NO'
AIRFLDS.ORG_AIRPORT AS 'AIRFLDS.ORG_AIRPORT'
AIRFLDS.RTE_AIRPORT AS 'AIRFLDS.RTE_AIRPORT'
AIRFLDS.VAL_AIR AS 'AIRFLDS.VAL_AIR'
AIRFLDS.FLOWN_AIR AS 'AIRFLDS.FLOWN_AIR'
AIRFLDS.REFUSE_CODE AS 'AIRFLDS.REFUSE_CODE'
AIRFLDS.CP_AIRPORT AS 'AIRFLDS.CP_AIRPORT'
BY INST_KEY
BY AIRFLDS.SEQ_NO NOPRINT
ON TABLE HOLD AS HRFLDS5
END
-RUN

TABLEF FILE RPT_FLDS
PRINT CAR.ID AS 'CAR.ID'
CAR.INCL1 AS 'CAR.INCL1'
CAR.INCL2 AS 'CAR.INCL2'
CAR.INCL3 AS 'CAR.INCL3'
CAR.INCL4 AS 'CAR.INCL4'
CAR.INCL5 AS 'CAR.INCL5'
CAR.INCL6 AS 'CAR.INCL6'
CAR.RANKBYTOP AS 'CAR.RANKBYTOP'
CAR.RANKMETHOD AS 'CAR.RANKMETHOD'
CAR.RATEALL AS 'CAR.RATEALL'
CAR.RATE1 AS 'CAR.RATE1'
CAR.RATE2 AS 'CAR.RATE2'
CAR.RATE3 AS 'CAR.RATE3'
CAR.RATE4 AS 'CAR.RATE4'
CAR.RATE5 AS 'CAR.RATE5'
CAR.RATE6 AS 'CAR.RATE6'
BY INST_KEY
BY CAR.ID NOPRINT
ON TABLE HOLD AS HRFLDS6
END
-RUN

TABLEF FILE RPT_FLDS
PRINT CARFLDS.SEQ_NO AS 'CARFLDS.SEQ_NO'
CARFLDS.SEQ_NO AS 'CARFLDS.SEQ_NO'
CARFLDS.PASSENGER AS 'CARFLDS.PASSENGER'
CARFLDS.VENDOR_CODE AS 'CARFLDS.VENDOR_CODE'
CARFLDS.REFUSE_CODE AS 'CARFLDS.REFUSE_CODE'
CARFLDS.PICKUP_CITY AS 'CARFLDS.PICKUP_CITY'
CARFLDS.DROPOFF_CITY AS 'CARFLDS.DROPOFF_CITY'
CARFLDS.CAR_TYPE AS 'CARFLDS.CAR_TYPE'
BY INST_KEY
BY CARFLDS.SEQ_NO NOPRINT
ON TABLE HOLD AS HRFLDS7
END
-RUN

TABLEF FILE RPT_FLDS
PRINT HTL.ID AS 'HTL.ID'
HTL.INCL1 AS 'HTL.INCL1'
HTL.INCL2 AS 'HTL.INCL2'
HTL.INCL3 AS 'HTL.INCL3'
HTL.INCL4 AS 'HTL.INCL4'
HTL.RANKBYTOP1 AS 'HTL.RANKBYTOP1'
HTL.RANKMETHOD AS 'HTL.RANKMETHOD'
HTL.RANKBYTOP2 AS 'HTL.RANKBYTOP2'
BY INST_KEY
BY HTL.ID NOPRINT
ON TABLE HOLD AS HRFLDS8
END
-RUN

TABLEF FILE RPT_FLDS
PRINT HTLFLDS.SEQ_NO AS 'HTLFLDS.SEQ_NO'
HTLFLDS.PASSENGER AS 'HTLFLDS.PASSENGER'
HTLFLDS.CHAIN_CODE AS 'HTLFLDS.CHAIN_CODE'
HTLFLDS.HTL_CITY AS 'HTLFLDS.HTL_CITY'
HTLFLDS.REFUSE_CODE AS 'HTLFLDS.REFUSE_CODE'
BY INST_KEY
BY HTLFLDS.SEQ_NO NOPRINT
ON TABLE HOLD AS HRFLDS9
END
-RUN

TABLEF FILE RPT_FLDS
PRINT HIEORG1.ID AS 'HIEORG1.ID'
HIEORG1.INCL1 AS 'HIEORG1.INCL1'
HIEORG1.INCL2 AS 'HIEORG1.INCL2'
HIEORG1.INCL3 AS 'HIEORG1.INCL3'
HIEORG1.SEL_LEVEL AS 'HIEORG1.SEL_LEVEL'
BY INST_KEY
BY HIEORG1.ID NOPRINT
ON TABLE HOLD AS HRFLDS10
END
-RUN

TABLEF FILE RPT_FLDS
PRINT HIEORG2.SEQ_NO AS 'HIEORG2.SEQ_NO'
HIEORG2.CLIENT AS 'HIEORG2.CLIENT'
HIEORG2.CATG AS 'HIEORG2.CATG'
HIEORG2.MEMBER AS 'HIEORG2.MEMBER'
BY INST_KEY
BY HIEORG2.SEQ_NO NOPRINT
ON TABLE HOLD AS HRFLDS11
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS1
MATCH INST_KEY
 ON MATCH REJECT
 ON NOMATCH INCLUDE
DATA ON HRFLDS1
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS2
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO RPTFLDS2.COMMON1.INCL1
  MATCH RPTFLDS2.COMMON1.INCL1
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRFLDS2
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS3
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO RPTFLDS2.COMMON2.SEQ_NO
  MATCH RPTFLDS2.COMMON2.SEQ_NO
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRFLDS3
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS4
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO RPTFLDS2.AIR.ID
  MATCH RPTFLDS2.AIR.ID
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRFLDS4
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS5
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO RPTFLDS2.AIRFLDS.SEQ_NO
  MATCH RPTFLDS2.AIRFLDS.SEQ_NO
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRFLDS5
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS6
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO RPTFLDS2.CAR.ID
  MATCH RPTFLDS2.CAR.ID
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRFLDS6
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS7
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO RPTFLDS2.CARFLDS.SEQ_NO
  MATCH RPTFLDS2.CARFLDS.SEQ_NO
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRFLDS7
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS8
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO RPTFLDS2.HTL.ID
  MATCH RPTFLDS2.HTL.ID
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRFLDS8
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS9
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO RPTFLDS2.HTLFLDS.SEQ_NO
  MATCH RPTFLDS2.HTLFLDS.SEQ_NO
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRFLDS9
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS10
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO RPTFLDS2.HIEORG1.ID
  MATCH RPTFLDS2.HIEORG1.ID
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRFLDS10
END
-RUN

MODIFY FILE RPTFLDS2
FIXFORM FROM HRFLDS11
MATCH INST_KEY
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO RPTFLDS2.HIEORG2.SEQ_NO
  MATCH RPTFLDS2.HIEORG2.SEQ_NO
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON HRFLDS11
END
-RUN

-TYPE Backing up RPT_FLDS Complete
-*********************************************************************

-*********************************************************************
-* Backup RPT_SET
-*
-RPT_SET
-TYPE Backing up RPT_SET....

-SET &RPT_SET2=&BUPATH | 'RPT_SET2.FOC';
FILEDEF RPT_SET2 DISK &RPT_SET2
-RUN

USE ADD
&RPT_SET2 AS RPT_SET2 NEW
END
-RUN

CREATE FILE RPT_SET2
-RUN


TABLEF FILE RPT_SET
PRINT
  SEG.SET_KEY
ON TABLE HOLD AS HRSET1
END
-RUN

MODIFY FILE RPT_SET2
FIXFORM FROM HRSET1
MATCH SET_KEY
 ON NOMATCH INCLUDE
 ON MATCH REJECT
DATA ON HRSET1
END
-RUN
-TYPE Backing up RPT_SET Complete
-*********************************************************************


-*********************************************************************
-* Backup ROLLUP
-*
-ROLLUP
-TYPE Backing up ROLLUP....

-SET &ROLLUP2=&BUPATH | 'ROLLUP2.FOC';
FILEDEF ROLLUP2 DISK &ROLLUP2
-RUN

USE ADD
&ROLLUP2 AS ROLLUP2 NEW
END
-RUN

CREATE FILE ROLLUP2
-RUN


TABLEF FILE ROLLUP
PRINT SEG.ROLL_STATUS
ON TABLE HOLD AS HROLL1
END

MODIFY FILE ROLLUP2
FIXFORM FROM HROLL1
MATCH ROLLUP_CODE
 ON NOMATCH INCLUDE
 ON MATCH REJECT
DATA ON HROLL1
END
-RUN

-TYPE Backing up ROLLUP Complete
-*********************************************************************

-*********************************************************************
-* Backup RPT_QUE
-*
-RPT_QUE
-TYPE Backing up RPT_QUE....

-SET &RPT_QUE2 &BUPATH | 'RPT_QUE2.FOC';
FILEDEF RPT_QUE2 DISK &RPT_QUE2
-RUN

USE ADD
&RPT_QUE2 AS RPT_QUE2 NEW
END
-RUN

CREATE FILE RPT_QUE2
-RUN

TABLEF FILE RPT_QUE
PRINT SEG.INST_KEY
ON TABLE HOLD AS HRQUE1
END
-RUN

MODIFY FILE RPT_QUE2
FIXFORM FROM HRQUE1
MATCH INST_KEY INTIME
 ON NOMATCH INCLUDE
 ON MATCH REJECT
DATA ON HRQUE1
END
-RUN

-TYPE Backing up RPT_QUE Complete
-*********************************************************************

-*********************************************************************
-* Backup ROLLSET
-*
-ROLLSET
-TYPE Backing up ROLLSET....

-SET &ROLLSET2=&BUPATH | 'ROLLSET2.FOC';
FILEDEF ROLLSET2 DISK &ROLLSET2
-RUN

USE ADD
&ROLLSET2 AS ROLLSET2 NEW
END
-RUN

CREATE FILE ROLLSET2
-RUN

TABLEF FILE ROLLSET
PRINT SEG.ROLLUP_CODE
ON TABLE HOLD AS HRLSET1
END
-RUN

MODIFY FILE ROLLSET2
FIXFORM FROM HRLSET1
MATCH ROLLUP_CODE GLOBAL_PARM
 ON NOMATCH INCLUDE
 ON MATCH REJECT
DATA ON HRLSET1
END
-RUN

-TYPE Backing up ROLLSET Complete
-*********************************************************************

-*********************************************************************
-* Backup ROLLQTR
-*
-ROLLQTR
-TYPE Backing up ROLLQTR....

-SET &ROLLQTR2=&BUPATH | 'ROLLQTR2.FOC';
FILEDEF ROLLQTR2 DISK &ROLLQTR2
-RUN

USE ADD
&ROLLQTR2 AS ROLLQTR2 NEW
END
-RUN

CREATE FILE ROLLQTR2
-RUN

TABLEF FILE ROLLQTR
PRINT SEG.ROLLUP_CODE
ON TABLE HOLD AS HRLQTR1
END
-RUN

MODIFY FILE ROLLQTR2
FIXFORM FROM HRLQTR1
MATCH ROLLUP_CODE
 ON NOMATCH INCLUDE
 ON MATCH REJECT
DATA ON HRLQTR1
END
-RUN

-TYPE Backing up ROLLQTR Complete
-*********************************************************************
-* Backup RPT_MSTR
-*
-RPT_MSTR
-TYPE Backing up RPT_MSTR....

-SET &RPTMSTR2=&BUPATH | 'RPTMSTR2.FOC';
FILEDEF RPTMSTR2 DISK &RPTMSTR2
-RUN

USE ADD
&RPTMSTR2 AS RPTMSTR2 NEW
END
-RUN

CREATE FILE RPTMSTR2
-RUN


TABLEF FILE RPT_MSTR
PRINT SEG.RPT_GROUP
ON TABLE HOLD AS HRPTM1
END
-RUN

MODIFY FILE RPTMSTR2
FIXFORM FROM HRPTM1
MATCH RPT_GROUP
 ON NOMATCH INCLUDE
 ON MATCH REJECT
DATA ON HRPTM1
END
-RUN

-TYPE Backing up RPT_MSTR Complete
-*********************************************************************
-* Backup HRPTINST
-*
-HRPTINST
-TYPE Backing up HRPTINST....

-SET &ZRPTINST=&BUPATH | 'ZRPTINST.FOC';
FILEDEF ZRPTINST DISK &ZRPTINST
-RUN

USE ADD
&ZRPTINST AS ZRPTINST NEW
END
-RUN

CREATE FILE ZRPTINST
-RUN

TABLEF FILE HRPTINST
PRINT
  SEG.INST_KEY
ON TABLE HOLD AS HHRINST1
END

TABLEF FILE HRPTINST
PRINT SEG.ID
BY INST_KEY BY INTIME
ON TABLE HOLD AS HHRINST2
END

MODIFY FILE ZRPTINST
FIXFORM FROM HHRINST1
MATCH INST_KEY INTIME
 ON MATCH REJECT
 ON NOMATCH INCLUDE
DATA ON HHRINST1
END
-RUN

MODIFY FILE ZRPTINST
FIXFORM FROM HHRINST2
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE 
MATCH ID
   ON NOMATCH INCLUDE
DATA ON HHRINST2
END
-RUN

-TYPE Backing up HRPTINST Complete
-*********************************************************************

-*********************************************************************
-* Backup HRPTFLDS
-*
-HRPTFLDS
-TYPE Backing up HRPTFLDS....

-SET &ZRPTFLDS=&BUPATH | 'ZRPTFLDS.FOC';
FILEDEF ZRPTFLDS DISK &ZRPTFLDS
-RUN

USE ADD
&ZRPTFLDS AS ZRPTFLDS NEW
END
-RUN

CREATE FILE ZRPTFLDS
-RUN

SET ASNAMES=ON

TABLEF FILE HRPTFLDS
PRINT
  SEG.INST_KEY INTIME
ON TABLE HOLD AS ZRFLDS1
END

TABLEF FILE HRPTFLDS
PRINT SEG.COMMON1.INCL1
BY INST_KEY
BY INTIME
BY COMMON1.INCL1
ON TABLE HOLD AS ZRFLDS2
END

TABLEF FILE HRPTFLDS
PRINT COMMON2.SEQ_NO
BY INST_KEY
BY INTIME
BY COMMON2.SEQ_NO NOPRINT
ON TABLE HOLD AS ZRFLDS3
END
-RUN

TABLEF FILE HRPTFLDS
PRINT AIR.ID
AIR.INCL1 AS 'AIR.INCL1'
AIR.INCL2 AS 'AIR.INCL2'
AIR.INCL3 AS 'AIR.INCL3'
AIR.INCL4 AS 'AIR.INCL4'
AIR.INCL5 AS 'AIR.INCL5'
AIR.INCL6 AS 'AIR.INCL6'
AIR.INCL7 AS 'AIR.INCL7'
AIR.INCL8 AS 'AIR.INCL8'
AIR.INTDOMT AS 'AIR.INTDOMT'
AIR.INTDOMS AS 'AIR.INTDOMS'
AIR.RANKBYTOP1 AS 'AIR.RANKBYTOP1'
AIR.RANKMETHOD AS 'AIR.RANKMETHOD'
AIR.CLASSCAT_A AS 'AIR.CLASSCAT_A'
AIR.CLASSCAT_F AS 'AIR.CLASSCAT_F'
AIR.CLASSCAT_B AS 'AIR.CLASSCAT_B'
AIR.CLASSCAT_C AS 'AIR.CLASSCAT_C'
AIR.CLASSCAT_D AS 'AIR.CLASSCAT_D'
AIR.TRANS_TYPE_S AS 'AIR.TRANS_TYPE_S'
AIR.TRANS_TYPE_E AS 'AIR.TRANS_TYPE_E'
AIR.TRANS_TYPE_R AS 'AIR.TRANS_TYPE_R'
AIR.TRANS_TYPE_V AS 'AIR.TRANS_TYPE_V'
AIR.ADV_PUR_A AS 'AIR.ADV_PUR_A'
AIR.ADV_PUR_0 AS 'AIR.ADV_PUR_0'
AIR.ADV_PUR_7 AS 'AIR.ADV_PUR_7'
AIR.ADV_PUR_14 AS 'AIR.ADV_PUR_14'
AIR.ADV_PUR_21 AS 'AIR.ADV_PUR_21'
AIR.RANKBYTOP2 AS 'AIR.RANKBYTOP2'
AIR.CITYPAIRFLD AS 'AIR.CITYPAIRFLD'
BY INST_KEY
BY INTIME
BY AIR.ID NOPRINT
ON TABLE HOLD AS ZRFLDS4
END
-RUN

TABLEF FILE HRPTFLDS
PRINT AIRFLDS.SEQ_NO AS 'AIRFLDS.SEQ_NO'
AIRFLDS.PASSENGER AS 'AIRFLDS.PASSENGER'
AIRFLDS.TICKET_NO AS 'AIRFLDS.TICKET_NO'
AIRFLDS.ORG_AIRPORT AS 'AIRFLDS.ORG_AIRPORT'
AIRFLDS.RTE_AIRPORT AS 'AIRFLDS.RTE_AIRPORT'
AIRFLDS.VAL_AIR AS 'AIRFLDS.VAL_AIR'
AIRFLDS.FLOWN_AIR AS 'AIRFLDS.FLOWN_AIR'
AIRFLDS.REFUSE_CODE AS 'AIRFLDS.REFUSE_CODE'
AIRFLDS.CP_AIRPORT AS 'AIRFLDS.CP_AIRPORT'
BY INST_KEY
BY INTIME
BY AIRFLDS.SEQ_NO NOPRINT
ON TABLE HOLD AS ZRFLDS5
END
-RUN

TABLEF FILE HRPTFLDS
PRINT CAR.ID AS 'CAR.ID'
CAR.INCL1 AS 'CAR.INCL1'
CAR.INCL2 AS 'CAR.INCL2'
CAR.INCL3 AS 'CAR.INCL3'
CAR.INCL4 AS 'CAR.INCL4'
CAR.INCL5 AS 'CAR.INCL5'
CAR.INCL6 AS 'CAR.INCL6'
CAR.RANKBYTOP AS 'CAR.RANKBYTOP'
CAR.RANKMETHOD AS 'CAR.RANKMETHOD'
CAR.RATEALL AS 'CAR.RATEALL'
CAR.RATE1 AS 'CAR.RATE1'
CAR.RATE2 AS 'CAR.RATE2'
CAR.RATE3 AS 'CAR.RATE3'
CAR.RATE4 AS 'CAR.RATE4'
CAR.RATE5 AS 'CAR.RATE5'
CAR.RATE6 AS 'CAR.RATE6'
BY INST_KEY
BY INTIME
BY CAR.ID NOPRINT
ON TABLE HOLD AS ZRFLDS6
END
-RUN

TABLEF FILE HRPTFLDS
PRINT CARFLDS.SEQ_NO AS 'CARFLDS.SEQ_NO'
CARFLDS.SEQ_NO AS 'CARFLDS.SEQ_NO'
CARFLDS.PASSENGER AS 'CARFLDS.PASSENGER'
CARFLDS.VENDOR_CODE AS 'CARFLDS.VENDOR_CODE'
CARFLDS.REFUSE_CODE AS 'CARFLDS.REFUSE_CODE'
CARFLDS.PICKUP_CITY AS 'CARFLDS.PICKUP_CITY'
CARFLDS.DROPOFF_CITY AS 'CARFLDS.DROPOFF_CITY'
CARFLDS.CAR_TYPE AS 'CARFLDS.CAR_TYPE'
BY INST_KEY
BY INTIME
BY CARFLDS.SEQ_NO NOPRINT
ON TABLE HOLD AS ZRFLDS7
END
-RUN

TABLEF FILE HRPTFLDS
PRINT HTL.ID AS 'HTL.ID'
HTL.INCL1 AS 'HTL.INCL1'
HTL.INCL2 AS 'HTL.INCL2'
HTL.INCL3 AS 'HTL.INCL3'
HTL.INCL4 AS 'HTL.INCL4'
HTL.RANKBYTOP1 AS 'HTL.RANKBYTOP1'
HTL.RANKMETHOD AS 'HTL.RANKMETHOD'
HTL.RANKBYTOP2 AS 'HTL.RANKBYTOP2'
BY INST_KEY
BY INTIME
BY HTL.ID NOPRINT
ON TABLE HOLD AS ZRFLDS8
END
-RUN

TABLEF FILE HRPTFLDS
PRINT HTLFLDS.SEQ_NO AS 'HTLFLDS.SEQ_NO'
HTLFLDS.PASSENGER AS 'HTLFLDS.PASSENGER'
HTLFLDS.CHAIN_CODE AS 'HTLFLDS.CHAIN_CODE'
HTLFLDS.HTL_CITY AS 'HTLFLDS.HTL_CITY'
HTLFLDS.REFUSE_CODE AS 'HTLFLDS.REFUSE_CODE'
BY INST_KEY
BY INTIME
BY HTLFLDS.SEQ_NO NOPRINT
ON TABLE HOLD AS ZRFLDS9
END
-RUN

TABLEF FILE HRPTFLDS
PRINT HIEORG1.ID AS 'HIEORG1.ID'
HIEORG1.INCL1 AS 'HIEORG1.INCL1'
HIEORG1.INCL2 AS 'HIEORG1.INCL2'
HIEORG1.INCL3 AS 'HIEORG1.INCL3'
HIEORG1.SEL_LEVEL AS 'HIEORG1.SEL_LEVEL'
BY INST_KEY
BY INTIME
BY HIEORG1.ID NOPRINT
ON TABLE HOLD AS ZRFLDS10
END
-RUN

TABLEF FILE HRPTFLDS
PRINT HIEORG2.SEQ_NO AS 'HIEORG2.SEQ_NO'
HIEORG2.CLIENT AS 'HIEORG2.CLIENT'
HIEORG2.CATG AS 'HIEORG2.CATG'
HIEORG2.MEMBER AS 'HIEORG2.MEMBER'
BY INST_KEY
BY INTIME
BY HIEORG2.SEQ_NO NOPRINT
ON TABLE HOLD AS ZRFLDS11
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS1
MATCH INST_KEY INTIME
 ON MATCH REJECT
 ON NOMATCH INCLUDE
DATA ON ZRFLDS1
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS2
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO ZRPTFLDS.COMMON1.INCL1
  MATCH ZRPTFLDS.COMMON1.INCL1
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON ZRFLDS2
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS3
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO ZRPTFLDS.COMMON2.SEQ_NO
  MATCH ZRPTFLDS.COMMON2.SEQ_NO
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON ZRFLDS3
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS4
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO ZRPTFLDS.AIR.ID
  MATCH ZRPTFLDS.AIR.ID
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON ZRFLDS4
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS5
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO ZRPTFLDS.AIRFLDS.SEQ_NO
  MATCH ZRPTFLDS.AIRFLDS.SEQ_NO
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON ZRFLDS5
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS6
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO ZRPTFLDS.CAR.ID
  MATCH ZRPTFLDS.CAR.ID
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON ZRFLDS6
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS7
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO ZRPTFLDS.CARFLDS.SEQ_NO
  MATCH ZRPTFLDS.CARFLDS.SEQ_NO
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON ZRFLDS7
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS8
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO ZRPTFLDS.HTL.ID
  MATCH ZRPTFLDS.HTL.ID
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON ZRFLDS8
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS9
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO ZRPTFLDS.HTLFLDS.SEQ_NO
  MATCH ZRPTFLDS.HTLFLDS.SEQ_NO
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON ZRFLDS9
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS10
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO ZRPTFLDS.HIEORG1.ID
  MATCH ZRPTFLDS.HIEORG1.ID
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON ZRFLDS10
END
-RUN

MODIFY FILE ZRPTFLDS
FIXFORM FROM ZRFLDS11
MATCH INST_KEY INTIME
 ON NOMATCH REJECT
 ON MATCH CONTINUE TO ZRPTFLDS.HIEORG2.SEQ_NO
  MATCH ZRPTFLDS.HIEORG2.SEQ_NO
   ON MATCH INCLUDE
   ON NOMATCH INCLUDE
DATA ON ZRFLDS11
END
-RUN

-TYPE Backing up HRPTFLDS Complete
-*********************************************************************

-*********************************************************************
-* Backup HRPT_SET
-*
-HRPT_SET
-TYPE Backing up HRPT_SET....

-SET &ZRPT_SET=&BUPATH | 'ZRPT_SET.FOC';
FILEDEF ZRPT_SET DISK &ZRPT_SET
-RUN

USE ADD
&ZRPT_SET AS ZRPT_SET NEW
END
-RUN

CREATE FILE ZRPT_SET
-RUN


TABLEF FILE HRPT_SET
PRINT
  SEG.SET_KEY
ON TABLE HOLD AS HHRSET1
END
-RUN

MODIFY FILE ZRPT_SET
FIXFORM FROM HHRSET1
MATCH SET_KEY INTIME
 ON NOMATCH INCLUDE
 ON MATCH REJECT
DATA ON HHRSET1
END
-RUN
-TYPE Backing up HRPT_SET Complete
-*********************************************************************

-*********************************************************************
-* Backup RPT_KEY
-*
-RPT_KEY
-TYPE Backing up RPT_KEY....

-SET &RPT_KEY2=&BUPATH | 'RPT_KEY2.FOC';
FILEDEF RPT_KEY2 DISK &RPT_KEY2
-RUN

USE ADD
&RPT_KEY2 AS RPT_KEY2 NEW
END
-RUN

CREATE FILE RPT_KEY2
-RUN

TABLEF FILE RPT_KEY
PRINT
  SEG.SET_KEY
BY KEY_TYPE
WHERE KEY_TYPE EQ 'S'
ON TABLE HOLD AS RPTKEY1
END
-RUN

TABLEF FILE RPT_KEY
PRINT
  SEG.INST_KEY
BY KEY_TYPE
WHERE KEY_TYPE EQ 'I'
ON TABLE HOLD AS RPTKEY2
END
-RUN

MODIFY FILE RPT_KEY2
FIXFORM FROM RPTKEY1
MATCH KEY_TYPE
 ON NOMATCH INCLUDE
 ON MATCH CONTINUE
MATCH SET_KEY
 ON NOMATCH INCLUDE
DATA ON RPTKEY1
END
-RUN

MODIFY FILE RPT_KEY2
FIXFORM FROM RPTKEY2
MATCH KEY_TYPE
 ON NOMATCH INCLUDE
 ON MATCH CONTINUE
MATCH INST_KEY
 ON NOMATCH INCLUDE
DATA ON RPTKEY2
END
-RUN

-TYPE Backing up RPT_KEY Complete
-*********************************************************************