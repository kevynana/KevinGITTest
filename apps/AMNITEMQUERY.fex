SET ASNAME = ON
DEFINE FILE A0METX
  ATKTDATE/A8YYMD = TKT_DATE;
  SRTFLD/A18=TKT_NUM | ATKTDATE;
END

TABLE FILE A0METX
PRINT TKT_NUM TKT_DATE LEVEL1 AS 'EMPID' PASSNGR_NAME VAL_AIRLINE
BY SRTFLD
-*BY TKT_NUM 
WHERE TKT_DATE IS-FROM '2009/03/01' TO '2009/06/30'
ON TABLE HOLD AS HOLDMETX FORMAT FOCUS INDEX SRTFLD
END
-RUN

DEFINE FILE AMN_ITEM
 ISSUEDATE/YYMD = HDATE(DATE_ISSUED, 'YYMD');
 ATKTDATE/A8YYMD = ISSUEDATE;
 TKTNUM/A10 = EDIT(TICKET_NUM,'9999999999');
 SRTFLD/A18=TKTNUM | ATKTDATE;
 NAME/A33 = EDIT(PAX, '999999999999999999999999999999999');
END
 
TABLE FILE AMN_ITEM
PRINT TICKET_NUM ISSUEDATE LEVEL1 NAME AIRLINE_CODE
BY SRTFLD      
WHERE ROLLUP EQ 'METX-R'
WHERE ISSUEDATE IS-FROM '2009/03/01' TO '2009/06/30'
ON TABLE HOLD AS HOLD2
END

JOIN CLEAR *
JOIN SRTFLD IN HOLD2 TO SRTFLD IN HOLDMETX AS J1
END
 
TABLE FILE HOLD2
LIST TKT_NUM AIRLINE_CODE VAL_AIRLINE ISSUEDATE TKT_DATE LEVEL1 EMPID PASSNGR_NAME NAME
-*BY SRTFLD
WHERE HOLD2.SRTFLD EQ HOLDMETX.SRTFLD
END