SET ASNAMES = ON



TABLE FILE A_ISU
PRINT AIR_KEY LEVEL1
BY AIR_KEY NOPRINT
IF LEVEL1 EQ '430'
IF BR_CL_IDX EQ 'AC169904'
ON TABLE HOLD AS 'DEBHOLD'
END
-RUN

MODIFY FILE A_ISU
FIXFORM FROM DEBHOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='0430';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON DEBHOLD
END
-RUN

TABLE FILE DEBHOLD
PRINT AIR_KEY
BY AIR_KEY NOPRINT
ON TABLE HOLD AS DEBHOLD1
END
-RUN

TABLE FILE S_ISU
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
AROLL_LEV3 AROLL_LEV4
BY AIR_KEY NOPRINT
WHERE AROLL_LEV3 EQ 'ISUU'
WHERE AROLL_LEV4 EQ '430'
IF TRN_DATE GE '20030501'
IF TRN_DATE LE '20030531'
ON TABLE HOLD AS 'ISUHOLD'
END
-RUN



MATCH FILE DEBHOLD1
PRINT AIR_KEY AS 'AKEY'
BY AIR_KEY NOPRINT
RUN
FILE ISUHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV3 AROLL_LEV4
BY AIR_KEY NOPRINT
AFTER MATCH HOLD NEW
END
-RUN


TABLE FILE HOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS CISU
END


 

MODIFY FILE S_ISU
FIXFORM FROM CISU
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='ISUA';
ON MATCH COMPUTE AROLL_LEV4='0430';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON CISU
END

TABLE FILE M_ISU
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
AROLL_LEV3 AROLL_LEV4
BY AIR_KEY NOPRINT
WHERE AROLL_LEV3 EQ 'ISUU'
WHERE AROLL_LEV4 EQ '430'
IF TRN_DATE GE '20030501'
IF TRN_DATE LE '20030531'
ON TABLE HOLD AS 'ISUHOLD'
END
-RUN



MATCH FILE DEBHOLD1
PRINT AIR_KEY AS 'AKEY'
BY AIR_KEY NOPRINT
RUN
FILE ISUHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV3 AROLL_LEV4
BY AIR_KEY NOPRINT
AFTER MATCH HOLD NEW
END
-RUN


TABLE FILE HOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS CISU
END

MODIFY FILE M_ISU
FIXFORM FROM CISU
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='ISUA';
ON MATCH COMPUTE AROLL_LEV4='0430';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON CISU
END
 

TABLE FILE D_ISU
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
AROLL_LEV3 AROLL_LEV4
BY AIR_KEY NOPRINT
WHERE AROLL_LEV3 EQ 'ISUU'
WHERE AROLL_LEV4 EQ '430'
IF TRN_DATE GE '20030501'
IF TRN_DATE LE '20030531'
ON TABLE HOLD AS 'ISUHOLD'
END
-RUN



MATCH FILE DEBHOLD1
PRINT AIR_KEY AS 'AKEY'
BY AIR_KEY NOPRINT
RUN
FILE ISUHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV3 AROLL_LEV4
BY AIR_KEY NOPRINT
AFTER MATCH HOLD NEW
END
-RUN


TABLE FILE HOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS CISU
END

MODIFY FILE D_ISU
FIXFORM FROM CISU
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='ISUA';
ON MATCH COMPUTE AROLL_LEV4='0430';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON CISU
END
