SET ASNAMES = ON

DEFINE FILE S9UAP
XL02/A15 = IF AROLL_LEV2 EQ 'UAPB' THEN 'CPSB' ELSE
           IF AROLL_LEV2 EQ 'UAPP' THEN 'CPSP' ELSE
           IF AROLL_LEV2 EQ 'UAPTF' THEN 'CPSTF' ELSE AROLL_LEV2;
        
END
TABLE FILE S9UAP
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  XL02 AS 'AROLL_LEV2'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS DEBHOLDS
END


MODIFY FILE S9UAP
FIXFORM FROM DEBHOLDS
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV4='               ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON DEBHOLDS
END


DEFINE FILE D9UAP
XL01/A15 = '               ';
XL02/A15 = IF AROLL_LEV2 EQ 'UAPB' THEN 'CPSB' ELSE
           IF AROLL_LEV2 EQ 'UAPP' THEN 'CPSP' ELSE
           IF AROLL_LEV2 EQ 'UAPTF' THEN 'CPSTF' ELSE AROLL_LEV2;
END
TABLE FILE D9UAP
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  XL02 AS 'AROLL_LEV2'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS DEBHOLDD
END


MODIFY FILE D9UAP
FIXFORM FROM DEBHOLDD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV4='               ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON DEBHOLDD
END


DEFINE FILE M9UAP
XL02/A15 = IF AROLL_LEV2 EQ 'UAPB' THEN 'CPSB' ELSE
           IF AROLL_LEV2 EQ 'UAPP' THEN 'CPSP' ELSE
           IF AROLL_LEV2 EQ 'UAPTF' THEN 'CPSTF' ELSE AROLL_LEV2;
END
TABLE FILE M9UAP
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  XL02 AS 'AROLL_LEV2'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS DEBHOLDM
END


MODIFY FILE M9UAP
FIXFORM FROM DEBHOLDM
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV4='               ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON DEBHOLDM
END


DEFINE FILE C9UAP
XL02/A15 = IF AROLL_LEV2 EQ 'UAPB' THEN 'CPSB' ELSE
           IF AROLL_LEV2 EQ 'UAPP' THEN 'CPSP' ELSE
           IF AROLL_LEV2 EQ 'UAPTF' THEN 'CPSTF' ELSE AROLL_LEV2;
END
TABLE FILE C9UAP
PRINT CAR_KEY   XL02 AS 'AROLL_LEV2'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS DEBHOLDC
END


MODIFY FILE C9UAP
FIXFORM FROM DEBHOLDC
MATCH CAR_KEY 
ON MATCH COMPUTE AROLL_LEV4='               ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON DEBHOLDC
END


DEFINE FILE H9UAP
XL02/A15 = IF AROLL_LEV2 EQ 'UAPB' THEN 'CPSB' ELSE
           IF AROLL_LEV2 EQ 'UAPP' THEN 'CPSP' ELSE
           IF AROLL_LEV2 EQ 'UAPTF' THEN 'CPSTF' ELSE AROLL_LEV2;
END
TABLE FILE H9UAP
PRINT HTL_KEY XL02 AS 'AROLL_LEV2'  
BY HTL_KEY NOPRINT
ON TABLE HOLD AS DEBHOLDH
END


MODIFY FILE H9UAP
FIXFORM FROM DEBHOLDH
MATCH HTL_KEY 
ON MATCH COMPUTE AROLL_LEV4='               ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON DEBHOLDH
END
