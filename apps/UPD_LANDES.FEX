SET ASNAMES = ON

-INCLUDE SETECHO


DEFINE FILE A_LANDES
LVL1/A2 = GETTOK (ICODEX, 36, -1, '-', 2, LVL1);
LVL2/A4 = GETTOK (ICODEX, 36, -2, '-', 4, LVL2);
END
TABLE FILE A_LANDES
PRINT LVL1 AS 'LEVEL1'  LVL2 AS 'LEVEL2'  
BY AIR_KEY
IF ICODEX NE ' '
ON TABLE HOLD AS AIRHOLD
END
-RUN


MODIFY FILE A_LANDES 
FIXFORM FROM AIRHOLD
MATCH AIR_KEY 
ON MATCH COMPUTE LEVEL3='               ';
ON MATCH UPDATE LEVEL1
ON MATCH UPDATE LEVEL2
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON AIRHOLD
END
-RUN


 
 

DEFINE FILE C_LANDES
LVL1/A2 = GETTOK (ICODEX, 36, -1, '-', 2, LVL1);
LVL2/A4 = GETTOK (ICODEX, 36, -2, '-', 4, LVL2);
END
TABLE FILE C_LANDES
PRINT LVL1 AS 'LEVEL1'  LVL2 AS 'LEVEL2' 
BY CAR_KEY
IF ICODEX NE ' '
ON TABLE HOLD AS CARHOLD
END
-RUN
 
MODIFY FILE C_LANDES 
FIXFORM FROM CARHOLD
MATCH CAR_KEY  
ON MATCH COMPUTE LEVEL3='               '; 
ON MATCH UPDATE LEVEL1
ON MATCH UPDATE LEVEL2
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CARHOLD
END
-RUN

DEFINE FILE H_LANDES
LVL1/A2 = GETTOK (ICODEX, 36, -1, '-', 2, LVL1);
LVL2/A4 = GETTOK (ICODEX, 36, -2, '-', 4, LVL2);
END
TABLE FILE H_LANDES
PRINT LVL1 AS 'LEVEL1'  LVL2 AS 'LEVEL2'
BY HTL_KEY
IF ICODEX NE ' '

ON TABLE HOLD AS HTLHOLD
END
-RUN
 
MODIFY FILE H_LANDES 
FIXFORM FROM HTLHOLD
MATCH HTL_KEY  
ON MATCH COMPUTE LEVEL3='               ';

ON MATCH UPDATE LEVEL1
ON MATCH UPDATE LEVEL2
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HTLHOLD
END
-RUN