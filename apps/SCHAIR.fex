-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* STEVE - 03/29/2004 - CHANGED AVG_TKTN TO USE AIR_VOL INSTEAD OF NET_VOL
-INCLUDE SETECHO
SET ASNAMES=ON

DEFINE FILE SCHAHLD
LABEL1/A25='AIR VOLUME';
LABEL2/A25='NET VOLUME';
LABEL3/A25='TICKETS ISSUED';
LABEL4/A25='FULL REFUNDS';
LABEL5/A25='NET TICKETS';
LABEL6/A25='AVERAGE TICKET';
LABEL7/A25='AVERAGE NET TICKET ';
LABEL8/A25='DOMESTIC NET VOLUME';
LABEL9/A25='DOMESTIC NET TICKETS';
LABEL10/A25='DOMESTIC NET AVERAGE';
LABEL11/A25='DOMESTIC %';
LABEL12/A25='INTERNATIONAL NET VOLUME';
LABEL13/A25='INTERNATIONAL NET TICKETS';
LABEL14/A25='INTERNATIONAL NET AVERAGE';
LABEL15/A25='INTERNATIONAL %';
LABEL16/A25='LOST SAVINGS';
LABEL17/A25='LOST SAVINGS %';
END
-RUN

TABLE FILE SCHAHLD
SUM AIR_VOL
  DOM_TKTS
  DOM_VOL
  INT_VOL
  INT_TKTS
  LABEL1
  LABEL2
  LABEL3
  LABEL4
  LABEL5
  LABEL6
  LABEL7
  LABEL8
  LABEL9
  LABEL10
  LABEL11
  LABEL12
  LABEL13
  LABEL14
  LABEL15
  LABEL16
  LABEL17
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT
  TRNY	
  VAS_AMT
BY TRNM
ON TABLE HOLD AS HLD1
END
-RUN

-JAN
TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'JAN'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO FEB;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JAVOL
END
-RUN

TABLE FILE JAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER 
      AND ROW_ORDER AND VOL_JAN
ON TABLE HOLD AS JAVOL1
END
-RUN


MODIFY FILE SCH_MAIN
FIXFORM FROM JAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS JNVOL
END
-RUN

TABLE FILE JNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS JTKTI
END
-RUN

TABLE FILE JTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JREF
END
-RUN

TABLE FILE JREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS JNTKT
END
-RUN

TABLE FILE JNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS JAVGT
END
-RUN

TABLE FILE JAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS JNAVGT
END
-RUN

TABLE FILE JNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS JDVOL
END
-RUN

TABLE FILE JDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS JDTKT
END
-RUN

TABLE FILE JDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS JDAVG
END
-RUN

TABLE FILE JDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS JDPCT
END
-RUN

TABLE FILE JDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS JIVOL
END
-RUN

TABLE FILE JIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS JITKT
END
-RUN

TABLE FILE JITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS JIAVG
END
-RUN

TABLE FILE JIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS JIPCT
END
-RUN

TABLE FILE JIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS JLOSS
END
-RUN

TABLE FILE JLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS JLOSSP
END
-RUN

TABLE FILE JLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JLOSSP1
END
-RUN


-FEB
TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'FEB'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO MAR;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS FEBAVOL
END
-RUN

TABLE FILE FEBAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB
ON TABLE HOLD AS FEBAVOL1
END

MODIFY FILE SCH_MAIN
FIXFORM FROM FEBAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS FEBNVOL
END
-RUN

TABLE FILE FEBNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB
ON TABLE HOLD AS FEBNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS FEBTKTI
END
-RUN

TABLE FILE FEBTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB
ON TABLE HOLD AS FEBTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS FEBREF
END
-RUN

TABLE FILE FEBREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS FEBNTKT
END
-RUN

TABLE FILE FEBNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB
ON TABLE HOLD AS FEBNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS FEBAVGT
END
-RUN

TABLE FILE FEBAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS FEBNAVGT
END
-RUN

TABLE FILE FEBNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS FEBDVOL
END
-RUN

TABLE FILE FEBDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB
ON TABLE HOLD AS FEBDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS FEBDTKT
END
-RUN

TABLE FILE FEBDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS FEBDAVG
END
-RUN

TABLE FILE FEBDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS FEBDPCT
END
-RUN

TABLE FILE FEBDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS FEBIVOL
END
-RUN

TABLE FILE FEBIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS FEBITKT
END
-RUN

TABLE FILE FEBITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS FEBIAVG
END
-RUN

TABLE FILE FEBIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS FEBIPCT
END
-RUN

TABLE FILE FEBIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS FEBLOSS
END
-RUN

TABLE FILE FEBLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS FEBLOSSP
END
-RUN

TABLE FILE FEBLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBLOSSP1
END
-RUN


-MAR
TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'MAR'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO APR;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS MARAVOL
END
-RUN

TABLE FILE MARAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR
ON TABLE HOLD AS MARAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS MARNVOL
END
-RUN

TABLE FILE MARNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR
ON TABLE HOLD AS MARNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS MARTKTI
END
-RUN

TABLE FILE MARTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR
ON TABLE HOLD AS MARTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS MARREF
END
-RUN

TABLE FILE MARREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS MARNTKT
END
-RUN

TABLE FILE MARNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR
ON TABLE HOLD AS MARNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS MARAVGT
END
-RUN

TABLE FILE MARAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS MARNAVGT
END
-RUN

TABLE FILE MARNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS MARDVOL
END
-RUN

TABLE FILE MARDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR
ON TABLE HOLD AS MARDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS MARDTKT
END
-RUN

TABLE FILE MARDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS MARDAVG
END
-RUN

TABLE FILE MARDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS MARDPCT
END
-RUN

TABLE FILE MARDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS MARIVOL
END
-RUN

TABLE FILE MARIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS MARITKT
END
-RUN

TABLE FILE MARITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS MARIAVG
END
-RUN

TABLE FILE MARIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS MARIPCT
END
-RUN

TABLE FILE MARIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS MARLOSS
END
-RUN

TABLE FILE MARLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS MARLOSSP
END
-RUN

TABLE FILE MARLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARLOSSP1
END
-RUN

-APR

TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'APR'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO MAY;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS APRAVOL
END
-RUN

TABLE FILE APRAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR
ON TABLE HOLD AS APRAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS APRNVOL
END
-RUN

TABLE FILE APRNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR
ON TABLE HOLD AS APRNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS APRTKTI
END
-RUN

TABLE FILE APRTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR
ON TABLE HOLD AS APRTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS APRREF
END
-RUN

TABLE FILE APRREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS APRNTKT
END
-RUN

TABLE FILE APRNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR
ON TABLE HOLD AS APRNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS APRAVGT
END
-RUN

TABLE FILE APRAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS APRNAVGT
END
-RUN

TABLE FILE APRNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS APRDVOL
END
-RUN

TABLE FILE APRDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR
ON TABLE HOLD AS APRDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS APRDTKT
END
-RUN

TABLE FILE APRDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS APRDAVG
END
-RUN

TABLE FILE APRDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS APRDPCT
END
-RUN

TABLE FILE APRDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS APRIVOL
END
-RUN

TABLE FILE APRIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS APRITKT
END
-RUN

TABLE FILE APRITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS APRIAVG
END
-RUN

TABLE FILE APRIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS APRIPCT
END
-RUN

TABLE FILE APRIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS APRLOSS
END
-RUN

TABLE FILE APRLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS APRLOSSP
END
-RUN

TABLE FILE APRLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRLOSSP1
END
-RUN


-MAY

TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'MAY'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO JUN;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS MAYAVOL
END
-RUN

TABLE FILE MAYAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY
ON TABLE HOLD AS MAYAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS MAYNVOL
END
-RUN

TABLE FILE MAYNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY
ON TABLE HOLD AS MAYNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS MAYTKTI
END
-RUN

TABLE FILE MAYTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY
ON TABLE HOLD AS MAYTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS MAYREF
END
-RUN

TABLE FILE MAYREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS MAYNTKT
END
-RUN

TABLE FILE MAYNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY
ON TABLE HOLD AS MAYNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS MAYAVGT
END
-RUN

TABLE FILE MAYAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS MAYNAVGT
END
-RUN

TABLE FILE MAYNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS MAYDVOL
END
-RUN

TABLE FILE MAYDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY
ON TABLE HOLD AS MAYDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS MAYDTKT
END
-RUN

TABLE FILE MAYDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS MAYDAVG
END
-RUN

TABLE FILE MAYDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS MAYDPCT
END
-RUN

TABLE FILE MAYDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS MAYIVOL
END
-RUN

TABLE FILE MAYIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS MAYITKT
END
-RUN

TABLE FILE MAYITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS MAYIAVG
END
-RUN

TABLE FILE MAYIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS MAYIPCT
END
-RUN

TABLE FILE MAYIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS MAYLOSS
END
-RUN

TABLE FILE MAYLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS MAYLOSSP
END
-RUN

TABLE FILE MAYLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYLOSSP1
END
-RUN


-JUN

TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'JUN'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO JUL;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JUNAVOL
END
-RUN

TABLE FILE JUNAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN
ON TABLE HOLD AS JUNAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS JUNNVOL
END
-RUN

TABLE FILE JUNNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN
ON TABLE HOLD AS JUNNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS JUNTKTI
END
-RUN

TABLE FILE JUNTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN
ON TABLE HOLD AS JUNTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JUNREF
END
-RUN

TABLE FILE JUNREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS JUNNTKT
END
-RUN

TABLE FILE JUNNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN
ON TABLE HOLD AS JUNNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS JUNAVGT
END
-RUN

TABLE FILE JUNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS JUNNAVGT
END
-RUN

TABLE FILE JUNNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS JUNDVOL
END
-RUN

TABLE FILE JUNDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN
ON TABLE HOLD AS JUNDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS JUNDTKT
END
-RUN

TABLE FILE JUNDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS JUNDAVG
END
-RUN

TABLE FILE JUNDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS JUNDPCT
END
-RUN

TABLE FILE JUNDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS JUNIVOL
END
-RUN

TABLE FILE JUNIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS JUNITKT
END
-RUN

TABLE FILE JUNITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS JUNIAVG
END
-RUN

TABLE FILE JUNIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS JUNIPCT
END
-RUN

TABLE FILE JUNIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS JUNLOSS
END
-RUN

TABLE FILE JUNLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS JUNLOSSP
END
-RUN

TABLE FILE JUNLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNLOSSP1
END
-RUN


-JUL

TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'JUL'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO AUG;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JULAVOL
END
-RUN

TABLE FILE JULAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL
ON TABLE HOLD AS JULAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS JULNVOL
END
-RUN

TABLE FILE JULNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL
ON TABLE HOLD AS JULNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS JULTKTI
END
-RUN

TABLE FILE JULTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL
ON TABLE HOLD AS JULTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JULREF
END
-RUN

TABLE FILE JULREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS JULNTKT
END
-RUN

TABLE FILE JULNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL
ON TABLE HOLD AS JULNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS JULAVGT
END
-RUN

TABLE FILE JULAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS JULNAVGT
END
-RUN

TABLE FILE JULNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS JULDVOL
END
-RUN

TABLE FILE JULDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL
ON TABLE HOLD AS JULDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS JULDTKT
END
-RUN

TABLE FILE JULDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS JULDAVG
END
-RUN

TABLE FILE JULDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS JULDPCT
END
-RUN

TABLE FILE JULDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS JULIVOL
END
-RUN

TABLE FILE JULIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS JULITKT
END
-RUN

TABLE FILE JULITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS JULIAVG
END
-RUN

TABLE FILE JULIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS JULIPCT
END
-RUN

TABLE FILE JULIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS JULLOSS
END
-RUN

TABLE FILE JULLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS JULLOSSP
END
-RUN

TABLE FILE JULLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULLOSSP1
END
-RUN


-AUG

TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'AUG'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO SEP;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS AUGAVOL
END
-RUN

TABLE FILE AUGAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG
ON TABLE HOLD AS AUGAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS AUGNVOL
END
-RUN

TABLE FILE AUGNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG
ON TABLE HOLD AS AUGNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS AUGTKTI
END
-RUN

TABLE FILE AUGTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG
ON TABLE HOLD AS AUGTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS AUGREF
END
-RUN

TABLE FILE AUGREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS AUGNTKT
END
-RUN

TABLE FILE AUGNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG
ON TABLE HOLD AS AUGNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS AUGAVGT
END
-RUN

TABLE FILE AUGAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS AUGNAVGT
END
-RUN

TABLE FILE AUGNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS AUGDVOL
END
-RUN

TABLE FILE AUGDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG
ON TABLE HOLD AS AUGDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS AUGDTKT
END
-RUN

TABLE FILE AUGDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS AUGDAVG
END
-RUN

TABLE FILE AUGDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS AUGDPCT
END
-RUN

TABLE FILE AUGDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS AUGIVOL
END
-RUN

TABLE FILE AUGIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS AUGITKT
END
-RUN

TABLE FILE AUGITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS AUGIAVG
END
-RUN

TABLE FILE AUGIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS AUGIPCT
END
-RUN

TABLE FILE AUGIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS AUGLOSS
END
-RUN

TABLE FILE AUGLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS AUGLOSSP
END
-RUN

TABLE FILE AUGLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGLOSSP1
END
-RUN


-SEP

TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'SEP'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO OCT;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS SEPAVOL
END
-RUN

TABLE FILE SEPAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP
ON TABLE HOLD AS SEPAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS SEPNVOL
END
-RUN

TABLE FILE SEPNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP
ON TABLE HOLD AS SEPNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS SEPTKTI
END
-RUN

TABLE FILE SEPTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP
ON TABLE HOLD AS SEPTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS SEPREF
END
-RUN

TABLE FILE SEPREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS SEPNTKT
END
-RUN

TABLE FILE SEPNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP
ON TABLE HOLD AS SEPNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS SEPAVGT
END
-RUN

TABLE FILE SEPAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS SEPNAVGT
END
-RUN

TABLE FILE SEPNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS SEPDVOL
END
-RUN

TABLE FILE SEPDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP
ON TABLE HOLD AS SEPDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS SEPDTKT
END
-RUN

TABLE FILE SEPDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS SEPDAVG
END
-RUN

TABLE FILE SEPDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS SEPDPCT
END
-RUN

TABLE FILE SEPDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS SEPIVOL
END
-RUN

TABLE FILE SEPIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS SEPITKT
END
-RUN

TABLE FILE SEPITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS SEPIAVG
END
-RUN

TABLE FILE SEPIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS SEPIPCT
END
-RUN

TABLE FILE SEPIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS SEPLOSS
END
-RUN

TABLE FILE SEPLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS SEPLOSSP
END
-RUN

TABLE FILE SEPLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPLOSSP1
END
-RUN


-OCT

TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'OCT'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO NOV;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS OCTAVOL
END
-RUN

TABLE FILE OCTAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT
ON TABLE HOLD AS OCTAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS OCTNVOL
END
-RUN

TABLE FILE OCTNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT
ON TABLE HOLD AS OCTNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS OCTTKTI
END
-RUN

TABLE FILE OCTTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT
ON TABLE HOLD AS OCTTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS OCTREF
END
-RUN

TABLE FILE OCTREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS OCTNTKT
END
-RUN

TABLE FILE OCTNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT
ON TABLE HOLD AS OCTNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS OCTAVGT
END
-RUN

TABLE FILE OCTAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS OCTNAVGT
END
-RUN

TABLE FILE OCTNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS OCTDVOL
END
-RUN

TABLE FILE OCTDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT
ON TABLE HOLD AS OCTDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS OCTDTKT
END
-RUN

TABLE FILE OCTDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS OCTDAVG
END
-RUN

TABLE FILE OCTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS OCTDPCT
END
-RUN

TABLE FILE OCTDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS OCTIVOL
END
-RUN

TABLE FILE OCTIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS OCTITKT
END
-RUN

TABLE FILE OCTITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS OCTIAVG
END
-RUN

TABLE FILE OCTIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS OCTIPCT
END
-RUN

TABLE FILE OCTIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS OCTLOSS
END
-RUN

TABLE FILE OCTLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS OCTLOSSP
END
-RUN

TABLE FILE OCTLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTLOSSP1
END
-RUN


-NOV

TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'NOV'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO DEC;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS NOVAVOL
END
-RUN

TABLE FILE NOVAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV
ON TABLE HOLD AS NOVAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS NOVNVOL
END
-RUN

TABLE FILE NOVNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV
ON TABLE HOLD AS NOVNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS NOVTKTI
END
-RUN

TABLE FILE NOVTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV
ON TABLE HOLD AS NOVTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS NOVREF
END
-RUN

TABLE FILE NOVREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS NOVNTKT
END
-RUN

TABLE FILE NOVNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV
ON TABLE HOLD AS NOVNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS NOVAVGT
END
-RUN

TABLE FILE NOVAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS NOVNAVGT
END
-RUN

TABLE FILE NOVNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS NOVDVOL
END
-RUN

TABLE FILE NOVDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV
ON TABLE HOLD AS NOVDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS NOVDTKT
END
-RUN

TABLE FILE NOVDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS NOVDAVG
END
-RUN

TABLE FILE NOVDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS NOVDPCT
END
-RUN

TABLE FILE NOVDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS NOVIVOL
END
-RUN

TABLE FILE NOVIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS NOVITKT
END
-RUN

TABLE FILE NOVITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS NOVIAVG
END
-RUN

TABLE FILE NOVIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS NOVIPCT
END
-RUN

TABLE FILE NOVIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS NOVLOSS
END
-RUN

TABLE FILE NOVLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS NOVLOSSP
END
-RUN

TABLE FILE NOVLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVLOSSP1
END
-RUN

-DEC

TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNM EQ 'DEC'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO YTD;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS DECAVOL
END
-RUN

TABLE FILE DECAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC
ON TABLE HOLD AS DECAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS DECNVOL
END
-RUN

TABLE FILE DECNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC
ON TABLE HOLD AS DECNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS DECTKTI
END
-RUN

TABLE FILE DECTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC
ON TABLE HOLD AS DECTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS DECREF
END
-RUN

TABLE FILE DECREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS DECNTKT
END
-RUN

TABLE FILE DECNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC
ON TABLE HOLD AS DECNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS DECAVGT
END
-RUN

TABLE FILE DECAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS DECNAVGT
END
-RUN

TABLE FILE DECNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS DECDVOL
END
-RUN

TABLE FILE DECDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC
ON TABLE HOLD AS DECDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS DECDTKT
END
-RUN

TABLE FILE DECDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS DECDAVG
END
-RUN

TABLE FILE DECDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS DECDPCT
END
-RUN

TABLE FILE DECDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS DECIVOL
END
-RUN

TABLE FILE DECIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS DECITKT
END
-RUN

TABLE FILE DECITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS DECIAVG
END
-RUN

TABLE FILE DECIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS DECIPCT
END
-RUN

TABLE FILE DECIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS DECLOSS
END
-RUN

TABLE FILE DECLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS DECLOSSP
END
-RUN

TABLE FILE DECLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECLOSSP1
END
-RUN


-YTD

TABLE FILE HLD1
SUM AIR_VOL
  DOM_VOL
  DOM_TKTS
  INT_TKTS
  INT_VOL
  NET_AMT
  TKT_ISS	
  NET_TKTS
  REF_ISS
  LOS_AMT	
  VAS_AMT
COMPUTE AVG_TKT/D12 = IF ((TKT_ISS LT 1) AND (TKT_ISS GT (-1))) THEN 0
                      ELSE (AIR_VOL/TKT_ISS);
COMPUTE AVG_TKTN/D12 = IF ((NET_TKT LT 1) AND (NET_TKT GT (-1))) THEN 0
                      ELSE (AIR_VOL/NET_TKT);
COMPUTE DAVG/D12 = IF ((DOM_TKTS LT 1) AND (DOM_TKTS GT (-1))) THEN 0 
                   ELSE (DOM_VOL/DOM_TKTS);
COMPUTE DPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((DOM_TKTS/NET_TKTS)*100);
COMPUTE IAVG/D12 = IF ((INT_TKTS LT 1) AND (INT_TKTS GT (-1))) THEN 0
                   ELSE (INT_VOL/INT_TKTS);
COMPUTE IPCT/D12 = IF ((NET_TKTS LT 1) AND (NET_TKTS GT (-1))) THEN 0 
                   ELSE ((INT_TKTS/NET_TKTS)*100);
COMPUTE LPCT/D12 = IF ((AIR_VOL LT 1) AND (AIR_VOL GT (-1))) THEN 0 ELSE
                        ((LOS_AMT/AIR_VOL)*100);
BY LABEL1
BY LABEL2
BY LABEL3
BY LABEL4
BY LABEL5
BY LABEL6
BY LABEL7
BY LABEL8
BY LABEL9
BY LABEL10
BY LABEL11
BY LABEL12
BY LABEL13
BY LABEL14
BY LABEL15
BY LABEL16
BY LABEL17
WHERE TRNY EQ 'YTD'
ON TABLE HOLD AS HLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO XXIT;
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AIR_VOL/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS YTDAVOL
END
-RUN

TABLE FILE YTDAVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD
ON TABLE HOLD AS YTDAVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDAVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDAVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_AMT/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2=2;
ON TABLE HOLD AS YTDNVOL
END
-RUN

TABLE FILE YTDNVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD
ON TABLE HOLD AS YTDNVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDNVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDNVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND TKT_ISS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2=3;   
ON TABLE HOLD AS YTDTKTI
END
-RUN

TABLE FILE YTDTKTI
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD
ON TABLE HOLD AS YTDTKTI1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDTKTI1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDTKTI1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND REF_ISS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS YTDREF
END
-RUN

TABLE FILE YTDREF
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDREF1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDREF1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDREF1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKTS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2=5;   
ON TABLE HOLD AS YTDNTKT
END
-RUN

TABLE FILE YTDNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD
ON TABLE HOLD AS YTDNTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDNTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDNTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKT/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS YTDAVGT
END
-RUN

TABLE FILE YTDAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDAVGT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVG_TKTN/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 7;   
ON TABLE HOLD AS YTDNAVGT
END
-RUN

TABLE FILE YTDNAVGT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDNAVGT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDNAVGT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDNAVGT1
END
-RUN


DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_VOL/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS YTDDVOL
END
-RUN

TABLE FILE YTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD
ON TABLE HOLD AS YTDDVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDDVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDDVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DOM_TKTS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS YTDDTKT
END
-RUN

TABLE FILE YTDDTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDDTKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDDTKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDDTKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DAVG/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS YTDDAVG
END
-RUN

TABLE FILE YTDDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDDAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDDAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDDAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND DPCT/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS YTDDPCT
END
-RUN

TABLE FILE YTDDPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDDPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDDPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDDPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_VOL/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS YTDIVOL
END
-RUN

TABLE FILE YTDIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDIVOL1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDIVOL1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDIVOL1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL13/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND INT_TKTS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 13;   
ON TABLE HOLD AS YTDITKT
END
-RUN

TABLE FILE YTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDITKT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDITKT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDITKT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL14/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IAVG/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 14;   
ON TABLE HOLD AS YTDIAVG
END
-RUN

TABLE FILE YTDIAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDIAVG1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDIAVG1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDIAVG1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL15/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND IPCT/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 15;   
ON TABLE HOLD AS YTDIPCT
END
-RUN

TABLE FILE YTDIPCT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDIPCT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDIPCT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDIPCT1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL16/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LOS_AMT/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 16;   
ON TABLE HOLD AS YTDLOSS
END
-RUN

TABLE FILE YTDLOSS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDLOSS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDLOSS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDLOSS1
END
-RUN

DEFINE FILE HLD2
CATEGORY/A8 = 'AIRLINES';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL17/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND LPCT/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 17;   
ON TABLE HOLD AS YTDLOSSP
END
-RUN

TABLE FILE YTDLOSSP
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDLOSSP1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDLOSSP1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDLOSSP1
END
-RUN


-XXIT


