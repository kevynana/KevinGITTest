-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-********************************************************************
-* Modifications:
-* 6/28/02 - CARRIED THROUGH NEW_SEG_AMT AND NET_COMM 
-*07/03/02   STEVE              CHANGED TO eTTek Review and Copyright
-* 6/10/03  Joy - Carried Through Base_fare1/Base_fare2 Defines
-* 6/13/03  DEB  - ADDED SUM OF NEW_SEG_AMT
-* 8/15/03  DEB  - CARRIED THROUGH AGENT_NUM
-* 9/25/03  DEB  - CARRIED THROUGH SEG_COUNT EMB_APT_NM SEG_CNT
-* 11/26/03 DEB   CARRIED THROUGH CGBOOK
-* 12/31/03 DEB   CARRIED TRHOUGH LEVEL3
-* 1/12/04  JOY   CARRIED THROUGH MILEAGE/SEG_MILES
-* 1/21/04  DEB   CARRIED THROUGH BR_CL_IDX
-* 2/10/04   DEB   CARRIED THROUGH DFARE DTKT_CNT IFARE ITKT_CNT
-*                TRAN_MY  
-*2/23/04   JK     CARRIED THROUGH LEVEL1
-*2/23/04   JK    CARRIED THROUGH AROLL_LEV4
-*7/22/04   JK    CARRIED THROUGH EMB_CNTRY_CODE
-*11/10/04  DV    ADDED CODE FOR GLOBAL CURRENCY
-*6/14/04   DV    CARRIED THROUGH ORG_APC DST_APC
-*10/3/05   DV    ADDED SUMMATION OF NEW_SEG_MILES
-*7/8/14    DV    CARRIED THROUGH REFUSE_CODE
-*11/24/15  Joy    S-07987  Corrected for running Currency Enabled Version
-*12/10/15 - JEM - S-13286 Updated to allow reports to sort/subtotal by id-levels

-********************************************************************

-INCLUDE SETECHO

SET ASNAMES = ON
-RUN

-IF &&CURRENCY EQ 'USD' THEN GOTO NEXT;

-SET &&SUBHEAD = <NAMEC;
-SET &FPAID_CUR = 'FARE,PAID, (' | &&CURRENCY || ')';
-SET &GCPK_CUR= 'COST,/KLMTR, (' | &&CURRENCY || ')';
-SET &AFP_CUR= 'AVERAGE,FLIGHT,PRICE, (' | &&CURRENCY || ')';
-SET &&S_SUBJ5='PAID_FAREX/D16.2CS AS ' | '''&FPAID_CUR.EVAL'''  ;
-SET &&S_SUBJ7='PCT.PAID_FAREX/D8.2 AS '' % OF,TOTAL,FARE,PAID''';
-SET &&S_SUBJ8='COMPUTE AVGF/D16.2CS = IF ((MRK_TKT_CNT LT 1) AND (MRK_TKT_CNT GT (-1))) THEN 0 ELSE PAID_FAREX/MRK_TKT_CNT; AS ' | '''&AFP_CUR.EVAL''' ;
-SET &&S_SUBJ9=' ';
-SET &&S_SUBJ10=' ';





-NEXT;

TABLE FILE AIRCLS
SUM FARE_PAID/D12.2CS AS 'TFARE'
    PAID_FAREX/D16.2CS AS 'GTFARE'	
    MRK_TKT_CNT/D8CS AS 'TMKT'
    NET_COMM/D12.2CS AS 'NCOMM'
    NEW_SEG_AMT/D12.CS AS 'TBASE'
    NEW_SEGAX/D16.2CS AS 'GTBASE'
    NET_TKT_CNT/D8CS AS 'TTKT'
    NEW_SEG_MILES/D9CS AS 'TMILE'
BY LEVEL_DESC    
ON TABLE HOLD AS HOLDONE
END
-RUN

TABLE FILE AIRCLS
PRINT
  AGENT_NUM
  AIRLINE 	
  AIRLINE_NAME
  AROLL_LEV4
  BASE_FARE1
  BASE_FARE2
  BR_CL_IDX
  CGBOOK	
  CLASS	
  CLASS_CAT
  DFARE
  DST_APC
  DTKT_CNT
  EMB_APT_NM
  EMB_CNTRY_CODE
  FARE_BAS	
  FARE_PAID
  IFARE
  ITKT_CNT
  LEVEL1
  LEVEL3	
  MFNH
  MILEAGE
  MRK_TKT_CNT
  NAMEC
  NET_COMM
  NET_TKT_CNT
  NEW_SEG_AMT
  NEW_SEGAX/D16.2CS
  NEW_SEG_MILES
  ORG_APC
  PAID_FAREX/D16.2CS
  PASSNGR_NAME  
  REFUSE_CODE
  SEG_CNT
  SEG_COUNT
  SEG_MILES
  TRAN_MONTH
  TRAN_MY
  UPFARE	
BY LEVEL_DESC
ON TABLE HOLD AS XTWO
END
-RUN

MATCH FILE XTWO
PRINT
  AGENT_NUM
  AIRLINE 	
  AIRLINE_NAME
  AROLL_LEV4
  BASE_FARE1
  BASE_FARE2
  BR_CL_IDX
  CGBOOK	
  CLASS	
  CLASS_CAT
  DFARE
  DST_APC
  DTKT_CNT
  EMB_APT_NM
  EMB_CNTRY_CODE
  FARE_BAS	
  FARE_PAID
  IFARE
  ITKT_CNT
  LEVEL1
  LEVEL3
  MFNH
  MILEAGE	
  MRK_TKT_CNT
  NAMEC
  NET_COMM
  NET_TKT_CNT
  NEW_SEG_AMT
  NEW_SEGAX
  NEW_SEG_MILES
  ORG_APC
  PAID_FAREX
  PASSNGR_NAME
  REFUSE_CODE
  SEG_CNT
  SEG_COUNT
  SEG_MILES
  TRAN_MONTH
  TRAN_MY	
  UPFARE
BY LEVEL_DESC
ON TABLE HOLD
RUN
FILE HOLDONE
SUM TBASE
    TFARE
    TMKT
    NCOMM
    GTFARE
    GTBASE
    TTKT
    TMILE
BY LEVEL_DESC
AFTER MATCH HOLD AS XTHREE OLD-OR-NEW 
END
-RUN

DEFINE FILE XTHREE
  NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
END

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

TABLE FILE XTHREE
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
  
-*ON
&&BREAKOPTION
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10
 


-INCLUDE FOOTERSM
ON TABLE COLUMN-TOTAL
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *
-INCLUDE &&PASTYS

-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILL;
-TYPE BEFORE
-INCLUDE &&DSTY

-SKIP_DRILL

ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN

-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3;

EX REPORT_3

-SKIP_R3
