-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* 2/25/05 - DEB - ADDED CODE FOR GLOBAL CURRENCY
-* File NONHHLD.FEX
-* Joy Updated Pref_Non define to contain C/P/N/M/L
-*6/13/14 - DEB NO CHANGES MADE
-* 9/9/14 Updated Pref_non define to use exclude_flags - jk


SET ASNAMES = ON

TABLEF FILE &&EXTRACT
PRINT HTL_KEY INVOICE_DATE NUM_DAYS NUM_ROOMS TOTAL_AMT CHAIN_NAME
      ROOM_RATE REFUSE_CODE REFUSAL_DESC CURR_DATE EXCLUDE_FLAGS
WHERE (INVOICE_DATE GE &&FROMDT.EVAL AND INVOICE_DATE LE &&TODT.EVAL)
   OR (INVOICE_DATE GE &&FXDATE.EVAL AND INVOICE_DATE LE &&TXDATE.EVAL)
&&WHERE1
&&WHERE2
&&WHERE3



-INCLUDE RPTPARMS
ON TABLE HOLD AS GNONHTL
END

TABLE FILE GNONHTL
PRINT EXCLUDE_FLAGS
      HTL_KEY
      INVOICE_DATE
      NUM_DAYS
      NUM_ROOMS
      TOTAL_AMT
      CHAIN_NAME
      ROOM_RATE
      REFUSE_CODE
      REFUSAL_DESC
BY CURR_DATE 
ON TABLE HOLD AS GNONHTL1 FORMAT FOCUS INDEX CURR_DATE
END
-RUN

-* Global Reporting JOIN
JOIN GNONHTL1.CURR_DATE IN GNONHTL1 TO GLOBAL.DATE IN GLOBAL AS J1
END


DEFINE FILE GNONHTL1
CNAME1/A30 = LCWORD(30, CNAME, CNAME1);
NAMEC/A30 = IF GLOBAL.COUNTRYCODE EQ 'USD' THEN ' ' ELSE CNAME1;
 

-******************************************************************************
-*                         Global Currency Conversion Defines
-******************************************************************************
CURR1X/D20.6 = 1 / USDPU ;

-* DEFINES ON PREVIOUS DEFINES
AMT_TOTALX/D20.6 = TOTAL_AMT * CURR1X;
END

TABLE FILE GNONHTL1
PRINT CURR_DATE
      EXCLUDE_FLAGS
      HTL_KEY
      INVOICE_DATE
      NUM_DAYS
      NUM_ROOMS
      TOTAL_AMT
      CHAIN_NAME
      ROOM_RATE
      REFUSE_CODE
      REFUSAL_DESC
      NAMEC
      AMT_TOTALX/D16.2CS
WHERE GLOBAL.COUNTRYCODE EQ '&&CURRENCY'
ON TABLE HOLD AS GNONHHLD
END
-RUN




