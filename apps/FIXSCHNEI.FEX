SET ASNAMES=ON


JOIN AIR_KEY IN S6SCHNEI TO AIR_KEY IN T5SCHNEI AS J1
TABLE FILE S6SCHNEI
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE GEO_ZONE CONTAINS 'USA-LAM' OR GEO_ZONE CONTAINS 'USA-CAN'
WHERE GEO_ZONE OMITS 'EUR'
WHERE INTL_DOM EQ 'I'
ON TABLE HOLD
END
-RUN



TABLE FILE HOLD
SUM AIR_KEY
BY AIR_KEY NOPRINT
ON TABLE HOLD AS DEBHOLD
END
-RUN

MODIFY FILE A5SCHNEI
FIXFORM FROM DEBHOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON DEBHOLD
END
-RUN

MODIFY FILE S6SCHNEI
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


JOIN AIR_KEY IN D6SCHNEI TO AIR_KEY IN T5SCHNEI AS J1
TABLE FILE D6SCHNEI
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE GEO_ZONE CONTAINS 'USA-LAM' OR GEO_ZONE CONTAINS 'USA-CAN'
WHERE GEO_ZONE OMITS 'EUR'
WHERE INTL_DOM EQ 'I'
ON TABLE HOLD AS DHOLD
END
-RUN


MODIFY FILE D6SCHNEI
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

JOIN AIR_KEY IN M6SCHNEI TO AIR_KEY IN T5SCHNEI AS J1
TABLE FILE M6SCHNEI
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE GEO_ZONE CONTAINS 'USA-LAM' OR GEO_ZONE CONTAINS 'USA-CAN'
WHERE GEO_ZONE OMITS 'EUR'
WHERE INTL_DOM EQ 'I'
ON TABLE HOLD AS MHOLD
END
-RUN


MODIFY FILE M6SCHNEI
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN