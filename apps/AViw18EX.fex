-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-* File AVIW18EX.FEX

-* **************************************************************
-* DATE       NAME       DESCRIPTION
-* 1/22/01    SS         ADDED SEG_DESIG TO EXTRACT - USED IN
-*                       ISU GOALED DELTA MARKET SHARE (INTLDOMG)
-* 6/7/01     DB         DEFINE CHANGED DUE TO BALANCING ISSUES
-*                       (EX1-EX1)
-* 1/18/02    DB         ADDED VALUA DEFINE
-* 4/29/02    SC DB      CHANGED NET_TKT_CNT DEFINE TO CORRECTLY BACK OUT 
-*                       PARTIAL REFUNDS AND EXCHANGES 
-* 12/6/04   JK          ADDED ORG_APC AND DST_APC
-*03/06/13  CHANGED CP_CL_CAT DEFINE DUE TO CLASS CATEGORY CHANGES - DV
-* ADDED TRANTYPE INCLUDE - JK 12/9/14 STORY ID S-06492
-*11/24/15  Joy    S-07987  Corrected for running Currency Enabled Version
-*09/26/2017 - DLV - S-37268 - UPDATED defines for ND_CP_CD ND_APT_CDO ND_APT_CDD

-* **************************************************************
-INCLUDE SETECHO
-TYPE EXTRACT1
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

-SET &AIRDATES = &&WEB_PATH || 'AIRDATES.fex';
-SET &WHATDATE = IF '&&DATETYPE.EVAL' EQ 'I' THEN 'TRN_DATE' ELSE 'FST_DPT_DATE';

DEFINE FILE &&EXTRACT
COMM_SEG/D12.2S   = SEG_COM;
-*CP_CL_CAT/A8 = DECODE CL_CAT ('F' 'FIRST'     'C' 'COACH'   
-*                              'D' 'DISCOUNT'  'B' 'BUSINESS');
CP_CL_CAT/A15 = DECODE CL_CAT ('F' 'FIRST'     'P' 'PREMIUM ECONOMY'   
			        'D' 'DEFAULT'   'B' 'BUSINESS'
			        'E' 'ECONOMY'   'U'  'UPGRADE' 
                                ' ' 'DEFAULT');        
DIR_CITY_CD/A50 = EMB_CTY.EMB_CITY || '-' || RTE_CTY.RTE_CITY;
DIR_CITY_NM/A50 = EMB_CTY.CITY_NAME | RTE_CTY.CITY_NAME; 
DIR_CP_CD/A50 = CITYPAIR.EMBARK || '-' || CITYPAIR.ROUTE;
DIR_CP_NM/A50 = EMB_APT.AIRPORT_NAME | RTE_APT.AIRPORT_NAME;
EMB_APT/A21=EDIT(NDO_APT.AIRPORT_NAME,'999999999999999999999$$$$');
FARE_PAID/D12.2S  = SEG_AMT;
GEO1/A3 =  EDIT(TKT_MAIN.GEO_ZONE, 
'999$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');    
ND_CITY_CD/A50 = NDO_CTY.NDO_CITY || '-' || NDD_CTY.NDD_CITY;
ND_CITY_NM/A50 = NDO_CTY.CITY_NAME | NDD_CTY.CITY_NAME;
-*ND_CP_CD/A50  = NDO_APT.ND_ORG || '-' || NDD_APT.ND_DST;
ND_CP_CD/A50  = ND_ORG || '-' || ND_DST;

NET_COMM/D12.2S = (SEG_AMT - SEG_COM);
-* NET_COMM/D12.2S   = IF (SEG_AMT LT 0) AND (SEG_COM GT 0) THEN 
-*                    (SEG_AMT + SEG_COM) ELSE (SEG_AMT - SEG_COM);
NET_TKT_CNT/D8CS    = IF (TICKET_CODE EQ '1') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (EX_FLAG NE ' ') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (RF_FLAG NE ' ') THEN (-1) ELSE 0;
NET_FARE/D12.2S  = IF (EX_FLAG EQ ' ') AND (RF_FLAG EQ ' ')
                         THEN SEG_AMT ELSE 0;
NEW_SEG_COUNT/D8CS = SEG_COUNT;
OCTRY/A2 = EDIT(TKT_MAIN.CTRY_COD, '99');
OGZONE/A3 = EDIT(TKT_MAIN.GEO_ZONE, '999');
RTE_APT/A21=EDIT(NDD_APT.AIRPORT_NAME,'999999999999999999999$$$$');
TOTAL_FARE/D12.2S = SEG_AMT + SEG_TAX;
VALUA/A1 =   IF (AIRLINE EQ 'UA') AND 
                (FLIGHT GE '5000') AND
                (FLIGHT LE '5499') THEN 'Y' ELSE 
             IF (AIRLINE EQ 'UA') AND
                (FLIGHT GE '5500') AND
                (FLIGHT LE '5899') THEN 'Y' ELSE
             IF (AIRLINE EQ 'UA') AND
                (FLIGHT GE '6800') AND
                (FLIGHT LE '7019') THEN 'Y' ELSE
             IF (AIRLINE EQ 'UA') AND
                (FLIGHT GE '7020') AND
                (FLIGHT LE '7149') THEN 'Y' ELSE
             IF (AIRLINE EQ 'UA') AND
                (FLIGHT GE '7150') AND
                (FLIGHT LE '7899') THEN 'Y' ELSE
             IF (AIRLINE EQ 'UA') AND
                (FLIGHT GE '7900') AND
                (FLIGHT LE '7899') THEN 'Y' ELSE 'N';
VASAVINGS/D11.2CS = SEG_DISCOUNT - TOTAL_FARE;
XPSNGR_NM/A15 = EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
XTRAN_DT/MDYY = TRN_DATE;
KILO/D9      = CITYPAIR.SEG_MILES * 1.60934 ;
XTRAN_YY/YY          = &WHATDATE;
XTRAN_M/M            = &WHATDATE;  

-* ****DEFINES ON PREVIOUS DEFINES****

DISSAVINGS/D11.2CS= IF EMBARK EQ 'DT1' THEN 0 ELSE
                         TOTAL_FARE - SEG_LOWEST;
ND_CP_NM/A50 = EMB_APT|'  '|RTE_APT;
ORGDST/A50 = &&ORGDST;
SAVINGS/D11.2CS   = SEG_STANDARD - TOTAL_FARE;  

-******** NEW DEFINES TO CORRECT CITY/AIRPORT NAME/CODE ISSUE JK ******

-******* PRODUCES DIRECTIONAL CITY CODES ***************
DIR_CTY_CDO/A25 = EMB_CTY.EMB_CITY;
DIR_CTY_CDD/A25 = RTE_CTY.RTE_CITY;

-******* PRODUCES DIRECTIONAL CITY NAMES ***************
DIR_CTY_NMO/A25 = EMB_CTY.CITY_NAME;
DIR_CTY_NMD/A25 = RTE_CTY.CITY_NAME;

-********* PRODUCES DIRECTIONAL AIRPORT CODES ********
DIR_APT_CDO/A25 = CITYPAIR.EMBARK;
DIR_APT_CDD/A25 = CITYPAIR.ROUTE;

-********* PRODUCES DIRECTIONAL AIRPORT NAMES ********
DIR_APT_NMO/A25 = EMB_APT.AIRPORT_NAME;
DIR_APT_NMD/A25 = RTE_APT.AIRPORT_NAME;

-********* PRODUCES NON-DIRECTIONAL CITY CODES ********
ND_CTY_CDO/A25 = NDO_CTY.NDO_CITY;
ND_CTY_CDD/A25 = NDD_CTY.NDD_CITY;

-********* PRODUCES NON-DIRECTIONAL CITY NAMES ********
ND_CTY_NMO/A25 = NDO_CTY.CITY_NAME;
ND_CTY_NMD/A25 = NDD_CTY.CITY_NAME;

-******** PRODUCES NON-DIRECTIONAL AIRPORT CODES ****
-*ND_APT_CDO/A25 = NDO_APT.ND_ORG;
-*ND_APT_CDD/A25 = NDD_APT.ND_DST;

ND_APT_CDO/A25 = ND_ORG;
ND_APT_CDD/A25 = ND_DST;

-******** PRODUCES NON-DIRECTIONAL AIRPORT NAMES ****
ND_APT_NMO/A25 = EDIT(NDO_APT.AIRPORT_NAME, '999999999999999999999$$$$');
ND_APT_NMD/A25 = EDIT(NDD_APT.AIRPORT_NAME, '999999999999999999999$$$$');

-INCLUDE TRANTYPE

END

-IF &&SETF EQ 'MXAADOM' OR 'MXAAMEX' OR 'MXAAEUR' OR 'MXAAASA' OR 'MXAALAM'
- OR 'MXDLDOM' THEN GOTO MetxSpl;

TABLEF FILE &&EXTRACT
PRINT 
  AIR_KEY   
  AIRLINE   
  AIRLINE.AIRLINE AS 'AIR_LINE' 
  AIRLINE.AIRLINE_NAME  
  AR_BRANCH 
  CITYPAIR.AIRLINE AS 'CP_AIRLINE'  
  CITYPAIR.CLASS AS 'CP_CLASS'  
  CITYPAIR.INTL_DOM AS 'INTL_DOM'   
  CITYPAIR.NET_COMM AS 'NET_COMM'   
  CITYPAIR.SEG_MILES/D9C AS 'MILES' 
  CLASS 
  CLS_CAT.CAT_DESC AS 'CAT_DESC'    
  COMM_SEG  
  CP_CL_CAT 
  DISSAVINGS    
  DOC_TYPE  
  DST_APC
  EMB_APT.GEO_ZONE AS 'EGEO'
  EMBARK
  FARE_PAID
  KILO  
  ND_CP_CD  
  ND_CP_NM
  NET_FARE  
  NET_TKT_CNT   
  NEW_SEG_COUNT 
  ORG_APC
  ORGDST
  ROUTE 
  RTE_APT.GEO_ZONE AS 'RGEO'
  REFUSE_KEY    
  SAVINGS   
  SEG_COUNT
  SEG_DESIG 
  SEG_NBR
  TKT_DATE  
  TKT_NUM   
  TOTAL_FARE    
  TRN_DATE
  VALUA     
  VASAVINGS     
  XPSNGR_NM 
  XTRAN_DT
  XTRAN_M
  XTRAN_YY
-******* NEW FIELDS *********
  DIR_CTY_CDO
  DIR_CTY_CDD
  DIR_CTY_NMO
  DIR_CTY_NMD
  DIR_APT_CDO
  DIR_APT_CDD
  DIR_APT_NMO
  DIR_APT_NMD
  ND_CTY_CDO
  ND_CTY_CDD
  ND_CTY_NMO
  ND_CTY_NMD
  ND_APT_CDO
  ND_APT_CDD
  ND_APT_NMO
  ND_APT_NMD  
-INCLUDE &AIRDATES
WHERE VOID_DATE EQ 0
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10

-INCLUDE RPTPARMS

ON TABLE HOLD AS MKSHRHLD
END
-RUN

-GOTO Continue;

-MetxSpl



TABLEF FILE &&EXTRACT
PRINT 
  AIR_KEY   
  AIRLINE   
  AIRLINE.AIRLINE AS 'AIR_LINE' 
  AIRLINE.AIRLINE_NAME  
  AR_BRANCH 
  CITYPAIR.AIRLINE AS 'CP_AIRLINE'  
  CITYPAIR.CLASS AS 'CP_CLASS'  
  CITYPAIR.INTL_DOM AS 'INTL_DOM'   
  CITYPAIR.NET_COMM AS 'NET_COMM'   
  CITYPAIR.SEG_MILES/D9C AS 'MILES' 
  CLASS 
  CLS_CAT.CAT_DESC AS 'CAT_DESC'    
  COMM_SEG  
  CP_CL_CAT 
  DISSAVINGS     
  DOC_TYPE  
  DST_APC
  EMB_APT.GEO_ZONE AS 'EGEO'
  EMBARK
  FARE_PAID 
  KILO  
  ND_CP_CD  
  ND_CP_NM
  NET_FARE  
  NET_TKT_CNT   
  NEW_SEG_COUNT 
  ORG_APC
  ORGDST
  ROUTE 
  RTE_APT.GEO_ZONE AS 'RGEO'
  REFUSE_KEY    
  SAVINGS   
  SEG_COUNT
  SEG_DESIG 
  SEG_NBR
  TKT_DATE  
  TKT_NUM   
  TOTAL_FARE    
  TRN_DATE
  VALUA     
  VASAVINGS     
  XPSNGR_NM 
  XTRAN_DT
  XTRAN_M
  XTRAN_YY
-******* NEW FIELDS *********
  DIR_CTY_CDO
  DIR_CTY_CDD
  DIR_CTY_NMO
  DIR_CTY_NMD
  DIR_APT_CDO
  DIR_APT_CDD
  DIR_APT_NMO
  DIR_APT_NMD
  ND_CTY_CDO
  ND_CTY_CDD
  ND_CTY_NMO
  ND_CTY_NMD
  ND_APT_CDO
  ND_APT_CDD
  ND_APT_NMO
  ND_APT_NMD   
-INCLUDE &AIRDATES
WHERE VOID_DATE EQ 0
-IF &&SETF EQ 'MXAADOM' THEN GOTO AADOM ELSE 
-   IF &&SETF EQ 'MXAAMEX' THEN GOTO AAMEX ELSE 
-   IF &&SETF EQ 'MXAAEUR' THEN GOTO AAEUR ELSE 
-   IF &&SETF EQ 'MXAAASA' THEN GOTO AAASA ELSE 
-   IF &&SETF EQ 'MXAALAM' THEN GOTO AALAM ELSE  
-   IF &&SETF EQ 'MXDLDOM' THEN GOTO DLDOM ELSE GOTO Skip1;


-AADOM
WHERE CITYPAIR.EMBRTE LIKE '%EWRORD%' OR '%ORDEWR%' OR '%LGAORD%' OR '%ORDLGA%' OR
   '%LGATPA%' OR '%TPALGA%' OR '%ATLORD%' OR '%ORDATL%' OR '%BOSORD%' OR '%ORDBOS%'
   OR '%SYRORD%' OR '%ORDSYR%' OR '%BOSPHX%' OR '%PHXBOS%' OR '%ATLLGA%' OR '%LGAATL%'
   OR '%BDLORD%' OR '%ORDBDL%' OR '%ORDPHL%' OR '%PHLORD%' OR '%MCITPA%' OR '%TPAMCI%'
   OR '%DTWORD%' OR '%ORDDTW%' OR '%ORDPHX%' OR '%PHXORD%' OR '%ORDTPA%' OR '%TPAORD%'
   OR '%HPNORD%' OR '%ORDHPN%' OR '%MSPORD%' OR '%ORDMSP%' OR '%DENEWR%' OR '%EWRDEN%'
   OR '%JFKLAX%' OR '%LAXJFK%' OR '%EWRLAX%' OR '%LAXEWR%' OR '%IAHORD%' OR '%ORDIAH%'
   OR '%CLEORD%' OR '%ORDCLE%' OR '%EWRSTL%' OR '%STLEWR%' OR '%LGASTL%' OR '%STLLGA%'
   OR '%DFWORD%' OR '%ORDDFW%' OR '%EWRDFW%' OR '%DFWEWR%' OR '%ORDSTL%' OR '%STLORD%'
   OR '%DFWLGA%' OR '%LGADFW%' OR '%BOSSTL%' OR '%STLBOS%' OR '%DFWSNA%' OR '%SNADFW%'
   OR '%BDLSNA%' OR '%SNABDL%' OR '%MKEDFW%' OR '%DFWMKE%' OR '%BNADFW%' OR '%DFWBNA%' 
   OR '%JFKSFO%' OR '%SFOJFK%' OR '%PVDTUL%' OR '%TULPVD%' OR '%BDLPHX%' OR '%PHXBDL%'
   OR '%ORDSNA%' OR '%SNAORD%' OR '%BOSOGG%' OR '%OGGBOS%' OR '%CLTORD%' OR '%ORDCLT%'
   OR '%ORDPIT%' OR '%PITORD%' OR '%LAXOGG%' OR '%OGGLAX%' OR '%DTWLGA%' OR '%LGADTW%'
   OR '%MCIORD%' OR '%ORDMCI%' OR '%ORDSFO%' OR '%SFOORD%' OR '%DENLGA%' OR '%LGADEN%'
   OR '%ORDTUL%' OR '%TULORD%' OR '%OGGPIT%' OR '%PITOGG%' OR '%CMHORD%' OR '%ORDCMH%'
   OR '%EWROGG%' OR '%OGGEWR%' OR '%LAXBOS%' OR '%BOSLAX%' OR '%BWIORD%' OR '%ORDBWI%'
   OR '%LAXORD%' OR '%ORDLAX%' OR '%BWIORD%' OR '%ORDBWI%' OR '%LAXORD%' OR '%ORDLAX%'
   OR '%BDLLAX%' OR '%LAXBDL%' OR '%LGAPIT%' OR '%PITLGA%' OR '%OMAORD%' OR '%ORDOMA%'   
   OR '%BOSDCA%' OR '%DCABOS%' OR '%EWRMCI%' OR '%MCIEWR%' OR '%CVGORD%' OR '%ORDCVG%'
   OR '%DSMSNA%' OR '%SNADSM%' OR '%LGAMCO%' OR '%MCOLGA%' OR '%LGAPHX%' OR '%PHXLGA%'
   OR '%ALBORD%' OR '%ORDALB%' OR '%BOSJFK%' OR '%JFKBOS%' OR '%DENORD%' OR '%ORDDEN%'
   OR '%MCISYR%' OR '%SYRMCI%' OR '%JFKOGG%' OR '%OGGJFK%' OR '%DSMEWR%' OR '%EWRDSM%'
   OR '%PHXTPA%' OR '%TPAPHX%' OR '%SFOSNA%' OR '%SNASFO%' OR '%FLLPHX%' OR '%PHXFLL%'
   OR '%CLTLGA%' OR '%LGACLT%' OR '%DAYSYR%' OR '%SYRDAY%' OR '%LGATUL%' OR '%TULLGA%'
   OR '%EWROKC%' OR '%OKCEWR%' OR '%AUSPHX%' OR '%PHXAUS%' OR '%CLEOGG%' OR '%OGGCLE%'
   OR '%LGACMH%' OR '%CMHLGA%' OR '%GSPORD%' OR '%ORDGSP%' OR '%INDPHX%' OR '%PHXIND%'  
   OR '%LEXSYR%' OR '%SYRLEX%' OR '%BNALGA%' OR '%LGABNA%' OR '%BDLSTL%' OR '%STLBDL%'
   OR '%PHXDFW%' OR '%DFWPHX%' OR '%PHXSTL%' OR '%STLPHX%' OR '%STLPVD%' OR '%PVDSTL%'   
   OR '%DFWSTL%' OR '%STLDFW%' OR '%STLYYZ%' OR '%YYZSTL%' OR '%STLMSP%' OR '%MSPSTL%'
   OR '%LAXSTL%' OR '%STLLAX%' OR '%EWRMIA%' OR '%MIAEWR%' OR '%DFWBDL%' OR '%BDLDFW%'
   OR '%ATLDFW%' OR '%DFWATL%' OR '%PVDDFW%' OR '%DFWPVD%' OR '%DFWTUL%' OR '%TULDFW%'
   OR '%PHLSTL%' OR '%STLPHL%' OR '%DFWMSP%' OR '%MSPDFW%' OR '%DENSTL%' OR '%STLDEN%'
   OR '%STLSNA%' OR '%SNASTL%' OR '%DFWPHL%' OR '%PHLDFW%' OR '%ATLSTL%' OR '%STLATL%'
   OR '%MKEDFW%' OR '%DFWMKE%' OR '%BNADFW%' OR '%DFWBNA%' 
    
 
-GOTO Skip1;
-AAMEX
WHERE CITYPAIR.EMBRTE LIKE '%MEXORD%' OR '%ORDMEX%' OR '%MEXTPA%' OR '%TPAMEX%' OR
   '%CUNMIA%' OR '%MIACUN%' OR '%LAXSJD%' OR '%SJDLAX%' OR '%EWRMTY%' OR '%MTYEWR%'
   OR '%GSPMEX%' OR '%MEXGSP%' OR '%MCISJD%' OR '%SJDMCI%' OR '%IADMEX%' OR '%MEXIAD%'
   OR '%DFWMEX%' OR '%MEXDFW%' OR '%MEXMIA%' OR '%MIAMEX%'
-GOTO Skip1;
-AAEUR
WHERE CITYPAIR.EMBRTE LIKE '%BRUJFK%' OR '%JFKBRU%' OR '%LHRSTL%' OR '%STLLHR%' OR
   '%CDGJFK%' OR '%JFKCDG%' OR '%LHRTPA%' OR '%TPALHR%' OR '%LGWSTL%' OR '%STLLGW%'
   OR '%CDGLAX%' OR '%LAXCDG%' OR '%LHRPHX%' OR '%PHXLHR%' OR '%JFKZRH%' OR '%ZRHJFK%'
   OR '%DCADUB%' OR '%DUBDCA%' OR '%DCAZRH%' OR '%ZRHDCA%' OR '%BOSLHR%' OR '%LHRBOS%'
   OR '%LGWRDU%' OR '%RDULGW%' OR '%LHRORD%' OR '%ORDLHR%'
-GOTO Skip1;
-AAASA
WHERE CITYPAIR.EMBRTE LIKE '%JFKNRT%' OR '%NRTJFK%' OR '%NRTSTL%' OR '%STLNRT%' OR
   '%ORDPVG%' OR '%PVGORD%' OR '%DELPHL%' OR '%PHLDEL%' OR '%LGAPVG%' OR '%PVGLGA%'
   OR '%DELMSP%' OR '%MSPDEL%' OR '%BDLDEL%' OR '%DELBDL%' OR '%DELSTL%' OR '%STLDEL%'
   OR '%DELTPA%' OR '%TPADEL%' OR '%DELSYR%' OR '%SYRDEL%' OR '%DAYDEL%' OR '%DELDAY%'
   OR '%DELORD%' OR '%ORDDEL%' OR '%EWRNRT%' OR '%NRTEWR%' OR '%BDLNRT%' OR '%NRTBDL%'
-GOTO Skip1;
-AALAM
WHERE CITYPAIR.EMBRTE LIKE '%SJOTUL%' OR '%TULSJO%' OR '%EWRGRU%' OR '%GRUEWR%' OR
   '%EZEJFK%' OR '%JFKEZE%' OR '%CLTGRU%' OR '%GRUCLT%' OR '%EWRSJO%' OR '%SJOEWR%'
   OR '%GRUSTL%' OR '%STLGRU%' OR '%EZELGA%' OR '%LGAEZE%' OR '%EZEPHL%' OR '%PHLEZE%'
   OR '%DFWSCL%' OR '%SCLDFW%' OR '%DAYSJO%' OR '%SJODAY%' OR '%JFKSCL%' OR '%SCLJFK%'
   OR '%EWREZE%' OR '%EZEEWR%' OR '%EWRGIG%' OR '%GIGEWR%' OR '%EWRSCL%' OR '%SCLEWR%'
   OR '%GRUJFK%' OR '%JFKGRU%' OR '%GUATPA%' OR '%TPAGUA%' OR '%GUAMIA%' OR '%MIAGUA%'
-GOTO Skip1;
-DLDOM
WHERE CITYPAIR.EMBRTE LIKE '%ATLEWR%' OR '%EWRATL%' OR '%LGATPA%' OR '%TPALGA%' OR
   '%JFKTPA%' OR '%TPAJFK%' OR '%BDLTPA%' OR '%TPABDL%' OR '%ATLORD%' OR '%ORDATL%'
   OR '%ATLLGA%' OR '%LGAATL%' OR '%BOSTPA%' OR '%TPABOS%' OR '%GSPLGA%' OR '%LGAGSP%'
   OR '%PVDTUL%' OR '%TULPVD%' OR '%ATLTPA%' OR '%TPAATL%' OR '%ATLBOS%' OR '%BOSATL%'
   OR '%ATLBDL%' OR '%BDLATL%' OR '%ATLPVD%' OR '%PVDATL%' OR '%BDLSNA%' OR '%SNABDL%'
   OR '%BDLDSM%' OR '%DSMBDL%' OR '%JFKLAX%' OR '%LAXJFK%' OR '%ATLPHL%' OR '%PHLATL%'
   OR '%ATLSTL%' OR '%STLATL%' OR '%BOSJFK%' OR '%JFKBOS%' OR '%ATLDFW%' OR '%DFWATL%'
   OR '%ATLMCO%' OR '%MCOATL%' OR '%JFKSFO%' OR '%SFOJFK%' OR '%ATLBWI%' OR '%BWIATL%'
   OR '%ATLMDW%' OR '%MDWATL%' OR '%BOSLAX%' OR '%LAXBOS%' OR '%GSPSYR%' OR '%SYRGSP%'
   OR '%ATLSYR%' OR '%SYRATL%' OR '%JFKSAN%' OR '%SANJFK%' OR '%BDLMCO%' OR '%MCOBDL%'

-Skip1

&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10

-INCLUDE RPTPARMS

ON TABLE HOLD AS MKSHRHLD
END
-RUN

-Continue

TABLE FILE MKSHRHLD
PRINT AIR_KEY   
  AIRLINE   
  AIR_LINE  
  AIRLINE_NAME  
  AR_BRANCH 
  CP_AIRLINE    
  CP_CLASS 
  DISSAVINGS    
  INTL_DOM  
  NET_COMM  
  MILES 
  CLASS 
  CAT_DESC  
  COMM_SEG  
  CP_CL_CAT 
  DOC_TYPE  
  DST_APC
  EMBARK
  EGEO
  FARE_PAID 
  KILO  
  ND_CP_CD  
  ND_CP_NM
  NET_FARE  
  NET_TKT_CNT   
  NEW_SEG_COUNT 
  ORG_APC
  ORGDST
  RGEO  
  REFUSE_KEY    
  ROUTE
  SAVINGS   
  SEG_COUNT
  SEG_DESIG 
  SEG_NBR
  TKT_NUM   
  TOTAL_FARE    
  TRN_DATE
  VALUA     
  VASAVINGS     
  XPSNGR_NM 
  XTRAN_DT
  XTRAN_M
  XTRAN_YY
-******* NEW FIELDS *********
  DIR_CTY_CDO
  DIR_CTY_CDD
  DIR_CTY_NMO
  DIR_CTY_NMD
  DIR_APT_CDO
  DIR_APT_CDD
  DIR_APT_NMO
  DIR_APT_NMD
  ND_CTY_CDO
  ND_CTY_CDD
  ND_CTY_NMO
  ND_CTY_NMD
  ND_APT_CDO
  ND_APT_CDD
  ND_APT_NMO
  ND_APT_NMD
BY TKT_DATE
ON TABLE HOLD AS MKTSHR FORMAT FOCUS INDEX TKT_DATE
END
-RUN            

-* Global Reporting JOIN
JOIN MKTSHR.TKT_DATE IN MKTSHR TO GLOBAL.DATE IN GLOBAL AS J1


DEFINE FILE MKTSHR
NAMEC/A30 = CNAME;

-******************************************************************************
-*                         Global Currency Conversion Defines
-******************************************************************************
CURR1X/D20.6 = 1 / USDPU ;

-* DEFINES ON PREVIOUS DEFINES
PAID_FAREX/D20.6 = FARE_PAID * CURR1X;
FARE_TTLX/D20.6 = TOTAL_FARE * CURR1X;
-* DEFINES ON PREVIOUSLY DEFINES DEFINES

PAID_FARE1/D20.6C = PAID_FAREX;
FARE_TTL1/D20.6C = FARE_TTLX;
END
-RUN

TABLE FILE MKTSHR
PRINT AIR_KEY   
  AIRLINE   
  AIR_LINE  
  AIRLINE_NAME  
  AR_BRANCH 
  CP_AIRLINE    
  CP_CLASS  
  DST_APC
  EMBARK
  INTL_DOM  
  NET_COMM  
  MILES 
  CLASS 
  CAT_DESC  
  COMM_SEG  
  CP_CL_CAT 
  DISSAVINGS    
  DOC_TYPE  
  EGEO
  FARE_PAID AS 'CP_FARE_PD'
  KILO  
  ND_CP_CD  
  ND_CP_NM
  NET_FARE  
  NET_TKT_CNT   
  NEW_SEG_COUNT 
  ORG_APC
  ORGDST    
  REFUSE_KEY    
  RGEO
  ROUTE
  SAVINGS   
  SEG_COUNT
  SEG_DESIG 
  SEG_NBR
  TKT_NUM   
  TOTAL_FARE    
  TRN_DATE
  VALUA     
  VASAVINGS     
  XPSNGR_NM 
  XTRAN_DT
  XTRAN_M
  XTRAN_YY
-******* NEW FIELDS *********
  DIR_CTY_CDO
  DIR_CTY_CDD
  DIR_CTY_NMO
  DIR_CTY_NMD
  DIR_APT_CDO
  DIR_APT_CDD
  DIR_APT_NMO
  DIR_APT_NMD
  ND_CTY_CDO
  ND_CTY_CDD
  ND_CTY_NMO
  ND_CTY_NMD
  ND_APT_CDO
  ND_APT_CDD
  ND_APT_NMO
  ND_APT_NMD
  NAMEC
  PAID_FAREX
  PAID_FARE1
  FARE_TTLX
  FARE_TTL1  
WHERE GLOBAL.COUNTRYCODE EQ '&&CURRENCY'
ON TABLE HOLD AS MKTSHR1
END
-RUN


