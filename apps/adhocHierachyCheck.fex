-*adhocHierachyCheck.fex
-* Check if hierarchy level and level fields are selected.
-*SET TEMPERASE = OFF
-*-SET &ECHO = ALL;
-*-SET &&WEB_PATH=TEMPPATH(50,'A50');

-SET &&AROLL_DSC = IF &&BRK_LVL LT 10 THEN 'AROLL_DSC' | EDIT(&&BRK_LVL,'$9') ELSE 'AROLL_DSC' | EDIT(&&BRK_LVL,'99');
-SET &&AROLL_LEV = IF &&BRK_LVL LT 10 THEN 'AROLL_LEV' | EDIT(&&BRK_LVL,'$9') ELSE 'AROLL_LEV' | EDIT(&&BRK_LVL,'99');

-SET &HIERPARMS = 
- &&WEB_PATH || 'HIERPARMS.FEX';
FILEDEF HIERPARM DISK &HIERPARMS
-RUN
-WRITE HIERPARM 
-CLOSE HIERPARM

TABLE FILE ADHOCREPORTFIELDS
PRINT COLUMN_NAME
BY INST_KEY NOPRINT
WHERE INST_KEY EQ &&IKEY
-*WHERE INST_KEY EQ 339603
WHERE COLUMN_NAME LIKE 'AROLL_%' OR 'LEVEL%'
ON TABLE SET HOLDLIST PRINTONLY
ON TABLE SAVE AS 'SAVEHIER'
END
-RUN
-SET &HIERRECORDS = &LINES;
-IF &LINES EQ 0 THEN GOTO getAllHiers;

-REPEAT getAllHiers &HIERRECORDS TIMES
-READ SAVEHIER NOCLOSE &HIERFLDS.20.
-WRITE HIERPARM &HIERFLDS
-getAllHiers

-*write break level to the file
-WRITE HIERPARM &&AROLL_DSC
-WRITE HIERPARM &&AROLL_LEV

-CLOSE SAVEHIER;
-CLOSE HIERPARM;
-NOHIERS