
-INCLUDE SETECHO
SET ASNAMES = ON
-SET &&CYEAR = '2015';
-SET &&PYEAR = '2014';
-SET &&IQTR = '4';

 

DEFINE FILE HLD1
NOWTOD/A8 WITH CAT_ORDER = HHMMSS (NOWTOD);
CAMT/P15CS=IF YR EQ '&&CYEAR' THEN VOL_P1 ELSE 0;
CAMTA/A19=IF CAMT GT 0 THEN VOL_A1 ELSE '';
PAMT/P15CS=IF YR EQ '&&PYEAR' THEN VOL_P1 ELSE 0;
PAMTA/A19=IF PAMT GT 0 THEN VOL_A1 ELSE '';
QDESC/A12=IF QTR CONTAINS 'Q1' THEN 'Quarter 1' ELSE
          IF QTR CONTAINS 'Q2' THEN 'Quarter 2' ELSE
          IF QTR CONTAINS 'Q3' THEN 'Quarter 3' ELSE
          IF QTR CONTAINS 'Q4' THEN 'Quarter 4' ELSE
          IF QTR EQ 'YTD' THEN 'Year to Date' ELSE '';
CQTR1/A19=IF QTR CONTAINS 'Q1' AND YR EQ '&&CYEAR' THEN VOL_A1 ELSE CQTR1;
CQTR1X/P15=IF QTR CONTAINS 'Q1' AND YR EQ '&&CYEAR' THEN VOL_P1 ELSE 0;
 
PQTR1/A19=IF QTR CONTAINS 'Q1' AND YR EQ '&&PYEAR' THEN VOL_A1 ELSE PQTR1;
PQTR1X/P15=IF QTR CONTAINS 'Q1' AND YR EQ '&&PYEAR' THEN VOL_P1 ELSE 0;
 
CQTR2/A19=IF QTR CONTAINS 'Q2' AND YR EQ '&&CYEAR' THEN VOL_A1 ELSE CQTR2;
CQTR2X/P15=IF QTR CONTAINS 'Q2' AND YR EQ '&&CYEAR' THEN VOL_P1 ELSE 0;
 
PQTR2/A19=IF QTR CONTAINS 'Q2' AND YR EQ '&&PYEAR' THEN VOL_A1 ELSE PQTR2;
PQTR2X/P15=IF QTR CONTAINS 'Q2' AND YR EQ '&&PYEAR' THEN VOL_P1 ELSE 0;
 
CQTR3/A19=IF QTR CONTAINS 'Q3' AND YR EQ '&&CYEAR' THEN VOL_A1 ELSE CQTR3;
CQTR3X/P15=IF QTR CONTAINS 'Q3' AND YR EQ '&&CYEAR' THEN VOL_P1 ELSE 0;
 
PQTR3/A19=IF QTR CONTAINS 'Q3' AND YR EQ '&&PYEAR' THEN VOL_A1 ELSE PQTR3;
PQTR3X/P15=IF QTR CONTAINS 'Q3' AND YR EQ '&&PYEAR' THEN VOL_P1 ELSE 0;
 
CQTR4/A19=IF QTR CONTAINS 'Q4' AND YR EQ '&&CYEAR' THEN VOL_A1 ELSE CQTR4;
CQTR4X/P15=IF QTR CONTAINS 'Q4' AND YR EQ '&&CYEAR' THEN VOL_P1 ELSE 0;
 
PQTR4/A19=IF QTR CONTAINS 'Q4' AND YR EQ '&&PYEAR' THEN VOL_A1 ELSE PQTR4;
PQTR4X/P15=IF QTR CONTAINS 'Q4' AND YR EQ '&&PYEAR' THEN VOL_P1 ELSE 0;
 
CYTD/A19=IF QTR EQ '&&CYEAR' THEN VOL_A1 ELSE CYTD;
CYTDX/P15=IF QTR EQ '&&CYEAR' THEN VOL_P1 ELSE 0;
PYTD/A19=IF QTR EQ '&&PYEAR' THEN VOL_A1 ELSE PYTD;
PYTDX/P15=IF QTR EQ '&&PYEAR' THEN VOL_P1 ELSE 0;
 
END
TABLE FILE HLD1
SUM CQTR1 AS 'Q1 &&CYEAR' IN +2
    PQTR1 AS 'Q1 &&PYEAR' IN +2
    CQTR1X NOPRINT
    PQTR1X NOPRINT
 
 COMPUTE VAR1P/P4=(CQTR1X - PQTR1X) / PQTR1X * 100; NOPRINT
 COMPUTE VAR1D/D4=VAR1P; NOPRINT
-* COMPUTE VAR1/A5=IF PQTR1X EQ 0 AND CQTR1X GT 0 THEN '100+%' ELSE
-*                   FTOA(VAR1D, '(D4)', 'A4') || '%'; AS 'Var%' IN +2
 COMPUTE VAR1/A6=IF PQTR1X EQ 0 AND CQTR1X GT 0 THEN '100+%' ELSE
                   FTOA(VAR1D, '(D4)', 'A5') || '%'; AS 'Var %' IN +2
 
-IF &&IQTR EQ 1 GOTO YTDTOT;
    CQTR2 AS 'Q2 &&CYEAR' IN +3
    PQTR2 AS 'Q2 &&PYEAR' IN +2
    CQTR2X  
    PQTR2X 
    COMPUTE VAR2P/P4=(CQTR2X - PQTR2X) / PQTR2X * 100; 
 COMPUTE VAR2D/D4=VAR2P; 
-* COMPUTE VAR2/A5=IF PQTR2X EQ 0 AND CQTR2X GT 0 THEN '100+%' ELSE
-*                   FTOA(VAR2D, '(D4)', 'A4') || '%'; AS 'Var%' IN +2
 COMPUTE VAR2/A6=IF PQTR2X EQ 0 AND CQTR2X GT 0 THEN '100+%' ELSE
                   FTOA(VAR2D, '(D4)', 'A5') || '%'; AS 'Var%' IN +2 
-IF &&IQTR EQ 2 GOTO YTDTOT;
    CQTR3 AS 'Q3 &&CYEAR' IN +3
    PQTR3 AS 'Q3 &&PYEAR' IN +2
    CQTR3X NOPRINT
    PQTR3X NOPRINT
    COMPUTE VAR3P/P4=(CQTR3X - PQTR3X) / PQTR3X * 100;  
 COMPUTE VAR3D/D4=VAR3P; NOPRINT
-* COMPUTE VAR3/A5=IF PQTR3X EQ 0 AND CQTR3X GT 0 THEN '100+%' ELSE
-*                   FTOA(VAR3D, '(D4)', 'A4') || '%'; AS 'Var%' IN +2
 COMPUTE VAR3/A6=IF PQTR3X EQ 0 AND CQTR3X GT 0 THEN '100+%' ELSE
                   FTOA(VAR3D, '(D4)', 'A5') || '%'; AS 'Var%' IN +2 

-IF &&IQTR EQ 3 GOTO YTDTOT;
    CQTR4 AS 'Q4 &&CYEAR' IN +3
    PQTR4 AS 'Q4 &&PYEAR' IN +2
    CQTR4X NOPRINT
    PQTR4X NOPRINT
    COMPUTE VAR4P/P4=(CQTR4X - PQTR4X) / PQTR4X * 100; NOPRINT
 COMPUTE VAR4D/D4=VAR4P; NOPRINT
-* COMPUTE VAR4/A5=IF PQTR4X EQ 0 AND CQTR4X GT 0 THEN '100+%' ELSE
-*                   FTOA(VAR4D, '(D4)', 'A4') || '%'; AS 'Var%' IN +2
 COMPUTE VAR4/A6=IF PQTR4X EQ 0 AND CQTR4X GT 0 THEN '100+%' ELSE
                   FTOA(VAR4D, '(D4)', 'A5') || '%'; AS 'Var%' IN +2 
-YTDTOT
    CYTD AS 'YTD &&CYEAR' IN +3
    PYTD AS 'YTD &&PYEAR' IN +2
    CYTDX NOPRINT
    PYTDX NOPRINT
    
    COMPUTE VARYTDP/P4%S=(CYTDX - PYTDX) / PYTDX * 100;  
 COMPUTE VARYTDD/D4=VARYTDP;  
-* COMPUTE VARYTD/A5=IF PYTDX EQ 0 AND CYTDX GT 0 THEN '100+%' ELSE
-*                   FTOA(VARYTDD, '(D4)', 'A4') || '%'; AS 'Var%' IN +2
 COMPUTE VARYTD/A6=IF PYTDX EQ 0 AND CYTDX GT 0 THEN '100+%' ELSE
                   FTOA(VARYTDD, '(D4)', 'A5') || '%'; AS 'Var%' IN +2 
-DEB
BY CAT_ORDER NOPRINT
BY CATEGORY NOPRINT
BY ROW_ORDER NOPRINT
BY ROW_LABEL AS ''
ON CAT_ORDER SUBHEAD
END
-RUN
-QUIT
