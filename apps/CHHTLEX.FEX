-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-*1/30/14 UPDATED ONLINE/TRADITIONAL DEFINES TO USE ONLINE_TRADITIONAL FIELD INSTEAD OF DOD_TYPE
-*4/24/14  DEB  ADDED LEVEL4
-*8/29/17-JEM-S-34936 Removed TNT_COMPANY

-INCLUDE SETECHO

 
-DEFAULT &&HtlNOrec = 'N';

DEFINE FILE &&EXTRACT
 CITY_ST/A35 = PROP_CITY||(', '| PROP_STATE);
 IN_DATE/MDYY = CHKIN_DATE;
 LEVEL_DESC/A60  = &&LDESC;
 NBR_DAYS/D12 =  NUM_DAYS;
 NBR_ROOMS/D12 = NUM_ROOMS;

 NEW_TOTAL_AMT/D14.2C = TOTAL_AMT;
 NNROOMS/D12 = IF ((NBR_DAYS LT 0) AND (NUM_ROOMS LT 0)) THEN 
                ((NBR_DAYS*NUM_ROOMS) * (-1)) ELSE NBR_DAYS*NUM_ROOMS;
 OUT_DATE/MDYY = CHKOUT_DATE;
 PROP_ZIP5/A5=EDIT(PROP_ZIP, '99999$$$$$');

 GROSS_BOOK/D8 = IF NEW_TOTAL_AMT GE 0 THEN 1 ELSE 0;

END 

TABLEF FILE &&EXTRACT
PRINT AGENT_NUM
      AR_BRANCH
      CITY_ST
      DAILY_RATE
      GROSS_BOOK
      HOTEL_PHONE
      IN_DATE
      INVOICE_DATE
      INVOICE_NUM
      LEVEL1
      LEVEL2
      LEVEL3
      LEVEL4
      LEVEL_DESC   
      NBR_ROOMS
      NEW_TOTAL_AMT
      NNROOMS
      OUT_DATE
      PASSNGR_NAME
      PROP_NAME
      PROP_ADDRESS
      PROP_ZIP5
      PNR_LOCATOR
      RESV_STATUS
   
 
-********************************************************************
-* Where statements to select data specified in user profile
-* *******************************************************************
WHERE (INVOICE_DATE GE &&FROMDT.EVAL) AND (INVOICE_DATE LE &&TODT.EVAL)
 
&&WHERE9
&&WHERE10
 
-INCLUDE RPTPARMS
ON TABLE HOLD AS HTLHLD
END
-RUN


-SET &&HtlNOrec = IF &RECORDS EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO NOHtl;

 
TABLE FILE HTLHLD
PRINT AGENT_NUM
      AR_BRANCH
      CITY_ST
      DAILY_RATE
      GROSS_BOOK
      HOTEL_PHONE
      IN_DATE
      INVOICE_DATE
      INVOICE_NUM
      LEVEL1
      LEVEL2
      LEVEL3
      LEVEL4
      LEVEL_DESC   
      NBR_ROOMS
      NEW_TOTAL_AMT
      NNROOMS
      OUT_DATE
      PASSNGR_NAME
      PROP_NAME
      PROP_ADDRESS
      PROP_ZIP5
      RESV_STATUS
BY PNR_LOCATOR
-IF &&NOAIRrec EQ 'Y' THEN GOTO NoInFile;
WHERE NOT PNR_LOCATOR IN FILE GBLAIR;
-NoInFile
ON TABLE HOLD AS HTLHLD2
END
-RUN

 


TABLE FILE HTLHLD2
PRINT AGENT_NUM
      AR_BRANCH
      CITY_ST
      DAILY_RATE
      GROSS_BOOK
      HOTEL_PHONE
      IN_DATE
      INVOICE_DATE
      INVOICE_NUM
      LEVEL1
      LEVEL2
      LEVEL3
      LEVEL4
      LEVEL_DESC   
      NBR_ROOMS
      NEW_TOTAL_AMT
      NNROOMS
      OUT_DATE
      PASSNGR_NAME
      PROP_NAME
      PROP_ADDRESS
      PROP_ZIP5
      PNR_LOCATOR
      RESV_STATUS
BY LEVEL_DESC
ON TABLE HOLD AS HTLTRN 
END
-RUN
 

-NOHtl

-END



 
