-* Modify GLA/GLC/GLH UDIDs into Level6 in Air/Car/Hotel

SET ASNAMES=ON

-* Air Modify

TABLE FILE UAGROW
PRINT AUD_DATA
BY AIR_KEY
WHERE UDID EQ 'GLA'
ON TABLE HOLD AS HGLA
END
-RUN

DEFINE FILE HGLA
LEVEL6/A20 = EDIT(AUD_DATA, '99999999999999999999');
END
TABLE FILE HGLA
PRINT LEVEL6
BY AIR_KEY
ON TABLE HOLD AS HGLA1
END
-RUN

MODIFY FILE A_GROW
FIXFORM FROM HGLA1
MATCH AIR_KEY
ON MATCH UPDATE LEVEL6
ON NOMATCH REJECT
DATA ON HGLA1
END
-RUN

-* Car Modify

TABLE FILE UCGROW
PRINT AUD_DATA
BY CAR_KEY
WHERE UDID EQ 'GLC'
ON TABLE HOLD AS HGLC
END
-RUN

DEFINE FILE HGLC
LEVEL6/A20 = EDIT(AUD_DATA, '99999999999999999999');
END
TABLE FILE HGLC
PRINT LEVEL6
BY CAR_KEY
ON TABLE HOLD AS HGLC1
END
-RUN

MODIFY FILE C_GROW
FIXFORM FROM HGLC1
MATCH CAR_KEY
ON MATCH UPDATE LEVEL6
ON NOMATCH REJECT
DATA ON HGLC1
END
-RUN

-* Hotel Modify 

TABLE FILE UHGROW
PRINT AUD_DATA
BY HTL_KEY
WHERE UDID EQ 'GLH'
ON TABLE HOLD AS HGLH
END
-RUN

DEFINE FILE HGLH
LEVEL6/A20 = EDIT(AUD_DATA, '99999999999999999999');
END
TABLE FILE HGLH
PRINT LEVEL6
BY HTL_KEY
ON TABLE HOLD AS HGLH1
END
-RUN

MODIFY FILE H_GROW
FIXFORM FROM HGLH1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL6
ON NOMATCH REJECT
DATA ON HGLH1
END
-RUN

