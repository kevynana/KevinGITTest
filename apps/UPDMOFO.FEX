
SET ASNAMES = ON


-GOTO DEB;
DEFINE FILE A4MOFO
XL01/A5 = EDIT(ICODEX, '$$$$$$$$$99999');
XL02/A7 = EDIT(ICODEX, '$$$$$$$$$$$$$$9999999');
XL03/A15 = XL01 || '-' || XL02;
END
TABLE FILE A4MOFO
PRINT AIR_KEY XL03 AS 'LEVEL3'
BY AIR_KEY NOPRINT
WHERE LEVEL3 EQ ' '
ON TABLE HOLD AS DEBFIX
END
-RUN


MODIFY FILE A4MOFO
FIXFORM FROM DEBFIX
MATCH AIR_KEY
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON DEBFIX
END
-RUN


DEFINE FILE H4MOFO
XL01/A5 = EDIT(ICODEX, '$$$$$$$$$99999');
XL02/A7 = EDIT(ICODEX, '$$$$$$$$$$$$$$9999999');
XL03/A15 = XL01 || '-' || XL02;
END
TABLE FILE H4MOFO
PRINT HTL_KEY XL03 AS 'LEVEL3'
BY HTL_KEY NOPRINT
WHERE LEVEL3 EQ ' '
ON TABLE HOLD AS DEBHFIX
END
-RUN


MODIFY FILE H4MOFO
FIXFORM FROM DEBHFIX
MATCH HTL_KEY
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON DEBHFIX
END
-RUN


DEFINE FILE C4MOFO
XL01/A5 = EDIT(ICODEX, '$$$$$$$$$99999');
XL02/A7 = EDIT(ICODEX, '$$$$$$$$$$$$$$9999999');
XL03/A15 = XL01 || '-' || XL02;
END
TABLE FILE C4MOFO
PRINT CAR_KEY XL03 AS 'LEVEL3'
BY CAR_KEY NOPRINT
WHERE LEVEL3 EQ ' '
ON TABLE HOLD AS DEBCFIX
END
-RUN


MODIFY FILE C4MOFO
FIXFORM FROM DEBCFIX
MATCH CAR_KEY
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON DEBCFIX
END
-RUN

-DEB
DEFINE FILE A4MOFO
XL01/A5 = EDIT(ICODEX, '$$$$$$99');
END
TABLE FILE A4MOFO
PRINT AIR_KEY XL01 AS 'LEVEL2'
BY AIR_KEY NOPRINT
WHERE ICODEX NE ' ' OR 'PERSONAL'
ON TABLE HOLD AS DEBFIX
END
-RUN

MODIFY FILE A4MOFO
FIXFORM FROM DEBFIX
MATCH AIR_KEY 
ON MATCH UPDATE LEVEL2
ON NOMATCH REJECT
DATA ON DEBFIX
END
-RUN

DEFINE FILE C4MOFO
XL01/A5 = EDIT(ICODEX, '$$$$$$99');
END
TABLE FILE C4MOFO
PRINT CAR_KEY XL01 AS 'LEVEL2'
BY CAR_KEY NOPRINT
WHERE ICODEX NE ' ' OR 'PERSONAL'
ON TABLE HOLD AS DEBCFIX
END
-RUN

MODIFY FILE C4MOFO
FIXFORM FROM DEBCFIX
MATCH CAR_KEY 
ON MATCH UPDATE LEVEL2
ON NOMATCH REJECT
DATA ON DEBCFIX
END
-RUN

DEFINE FILE H4MOFO
XL01/A5 = EDIT(ICODEX, '$$$$$$99');
END
TABLE FILE H4MOFO
PRINT HTL_KEY XL01 AS 'LEVEL2'
BY HTL_KEY NOPRINT
WHERE ICODEX NE ' ' OR 'PERSONAL'
ON TABLE HOLD AS DEBHFIX
END
-RUN

MODIFY FILE H4MOFO
FIXFORM FROM DEBHFIX
MATCH HTL_KEY 
ON MATCH UPDATE LEVEL2
ON NOMATCH REJECT
DATA ON DEBHFIX
END
-RUN