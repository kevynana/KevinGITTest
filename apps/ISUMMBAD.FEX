USE
F:\TNT\TTRACKER\SUDATA\I_SUMM.FOC
F:\TNT\TTRACKER\SUDATA\IHIER_SL.FOC
F:\TNT\TTRACKER\SUDATA\RPT_INST.FOC
F:\TNT\TTRACKER\SUDATA\RPT_SET.FOC
END
-RUN

TABLE FILE I_SUMM
PRINT INST_KEY
BY INST_KEY NOPRINT
IF HDES1 EQ ' ';
ON TABLE HOLD AS ISUMMHLD
END
-RUN

TABLE FILE RPT_INST
PRINT INST_KEY ROLLUP_CODE SET_ID LEV_SELECT RPT_NAME USE_PARM GLOBAL_PARM
BY INST_KEY NOPRINT
ON TABLE HOLD AS RPTIHLD
END
-RUN

JOIN INST_KEY IN ISUMMHLD TO INST_KEY IN RPTIHLD
TABLE FILE ISUMMHLD
PRINT SET_ID INST_KEY ROLLUP_CODE SET_ID LEV_SELECT RPT_NAME GLOBAL_PARM 
LEV_SELECT
BY SET_ID NOPRINT
ON TABLE HOLD AS JOINFIL
END
-RUN

JOIN SET_ID IN JOINFIL TO SET_ID IN RPT_SET
TABLE FILE JOINFIL
PRINT ROLLUP USER_NAME SET_NAME RPT_NAME GLOBAL_PARM LEV_SELECT
BY ROLLUP_CODE NOPRINT
BY USER_NAME NOPRINT
BY SET_NAME NOPRINT
BY RPT_NAME NOPRINT
IF ROLLUP_CODE NE ' ';
ON TABLE HOLD AS HIERUPD FORMAT EXCEL
END
-RUN
