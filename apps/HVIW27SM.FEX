-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-*03/13/17 - DLV - S-22486 - updated ettek Review to Post-trip Reporting
-*10/02/2017 JEM S-35468 Place the footer datetime stamp text in a separate file to be -INCLUDED in the stylesheets

-INCLUDE SETECHO
-* File HVIW26.FEX

SET ASNAMES=ON

 
-SET &&RANK_LIMIT = 500;
-SET &&RANK_LIMIT2 = 25;
-SET &&CTY_LMT = &&RANK_LIMIT;
-SET &&HTL_LMT = &&RANK_LIMIT2;
 
-* -SET &&RANK_METH = IF &&RANK_METH EQ 'ROOM_AMT' THEN 'ROOM_AMT'
-* - ELSE IF &&RANK_METH EQ 'NBR_DAYS' THEN 'NBR_DAYS' 
-* - ELSE 'NBR_DAYS';

-SET &&RANK_METH = 'YNMBR_DAYS'; 


TABLE FILE HTLHLD2
SUM YDROOMS 
    YDTOT_AMT  
COMPUTE NDAYS/I6 = FST.DAYS;
COMPUTE DIVBY/I6=IF NDAYS GT 365 THEN NDAYS ELSE 365; NOPRINT
COMPUTE PROHSP1/D12CS  = ((YDTOT_AMT/FST.DAYS)*DIVBY);
COMPUTE PROHRM/D8 = ((YDROOMS/FST.DAYS)*DIVBY);
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY CHAIN_NAME
BY PROP_NAME
BY PROP_ZIP5
BY PROP_ADDRESS
BY HOTEL_PHONE
BY CHAIN_CODE
ON TABLE HOLD AS PRJHLD
END
-RUN


MATCH FILE &&RPT_HOLD 
PRINT NEW_ROOM_RATE
    NEW_STD_RATE
    YBOOKINGS
    PYBOOKINGS
    YNUMDYS
    PNUMDYS
    YDRRATE
    YDSTD
    YDTOT_AMT
    PYDTOT_AMT
    YNMBR_DAYS	
    PYNMBR_DAYS	
    YDROOMS
    PYDROOMS
    REFUSE_CD	
    RESV_BRANCH	
    YDSVGS
    YROOM_AMT
    YDTOT_STD
    YDTOT_SVGS
    PROP_CODE
    YDPREF_NON
    PROP_LANYON_ID
    PROP_LATITUDE
    PROP_LONGITUDE
    PROP_MOBIL_STARS
    PROP_AAA_DIAMONDS
    PROP_OHG_CLASS
    SCALE_DESC
    PREF_NON
    CPREF_FLAG
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY CHAIN_NAME
BY PROP_NAME
BY PROP_ZIP5
BY PROP_ADDRESS
BY HOTEL_PHONE
BY CHAIN_CODE
ON TABLE HOLD
RUN
FILE PRJHLD
PRINT PROHSP1
    PROHRM
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY CHAIN_NAME
BY PROP_NAME
BY PROP_ZIP5
BY PROP_ADDRESS
BY HOTEL_PHONE
BY CHAIN_CODE
AFTER MATCH HOLD AS HTLHOLD3 OLD-OR-NEW
END
-RUN




TABLE FILE HTLHOLD3
PRINT 
     YBOOKINGS
     PYBOOKINGS
     YNUMDYS 
     PNUMDYS 
     YDRRATE
     YDSTD
     YDTOT_AMT
     PYDTOT_AMT
     YNMBR_DAYS 	
     PYNMBR_DAYS 	
     YDROOMS	
     PYDROOMS
     YDSVGS
     YROOM_AMT 
     YDTOT_STD
     YDTOT_SVGS
     YDPREF_NON
     PROHSP1
     PROHRM
     CHAIN_CODE	
     CHAIN_NAME	
     HOTEL_PHONE	
     PROP_ADDRESS	
     PROP_CODE
     PROP_NAME	
     PROP_ZIP5	
     REFUSE_CD	
     RESV_BRANCH	
-* New Property Master fields
  PROP_LANYON_ID
  PROP_LATITUDE
  PROP_LONGITUDE
  PROP_MOBIL_STARS
  PROP_AAA_DIAMONDS
  PROP_OHG_CLASS  
  SCALE_DESC
  PREF_NON
  CPREF_FLAG
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
-* RANKED BY HIGHEST NMBR_DAYS NOPRINT
RANKED BY HIGHEST &&RANK_METH NOPRINT
ON TABLE HOLD AS HOLD2
END
-RUN

 



 

DEFINE FILE HOLD2
 RANK_LIMIT/I5 = &&HTL_LMT;
 DRANK/D5      = RANK;
 ARANKX/A6 = FTOA(DRANK, '(D5)', 'A6');
 ARANK/A5=EDIT(ARANKX,'$99999');
 RANK_VALUE/A5 = IF (RANK_LIMIT EQ 0) THEN ARANK ELSE
                 IF RANK GT RANK_LIMIT THEN 'OTHER' ELSE ARANK;
END
-RUN

TABLE FILE HOLD2
PRINT 
     YBOOKINGS
     PYBOOKINGS
     YNUMDYS 
     PNUMDYS 
     YDRRATE
     YDSTD
     YDTOT_AMT
     PYDTOT_AMT
     YNMBR_DAYS 	
     PYNMBR_DAYS 	
     YDROOMS	
     PYDROOMS
     YDSVGS
     YROOM_AMT 
     YDTOT_STD
     YDTOT_SVGS
     YDPREF_NON
     PROHSP1
     PROHRM     
     CHAIN_CODE	
     CHAIN_NAME	
     HOTEL_PHONE	
     PROP_ADDRESS	
     PROP_CODE
     PROP_NAME	
     PROP_ZIP5	
     REFUSE_CD	
     RESV_BRANCH	
-* New Property Master fields
  PROP_LANYON_ID
  PROP_LATITUDE
  PROP_LONGITUDE
  PROP_MOBIL_STARS
  PROP_AAA_DIAMONDS
  PROP_OHG_CLASS  
  SCALE_DESC
  YDPREF_NON
  CPREF_FLAG
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
ON TABLE HOLD AS HOLD3
END
-RUN

DEFINE FILE HOLD3  
-*   CHAIN_CD/A2= IF RANK_VALUE LE '&&HTL_LMT' THEN CHAIN_CODE ELSE ' ';
CHAIN_CD/A2 = IF RANK_VALUE NE 'OTHER' THEN CHAIN_CODE ELSE ' ';
-*   CHAIN_NM/A35= IF RANK_VALUE LE '&&HTL_LMT' THEN CHAIN_NAME ELSE ' ';	
CHAIN_NM/A35 = IF RANK_VALUE NE 'OTHER' THEN CHAIN_NAME ELSE ' ';
-*  HTL_ADDRESS/A35= IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_ADDRESS ELSE ' ';
HTL_ADDRESS/A35 = IF RANK_VALUE NE 'OTHER' THEN PROP_ADDRESS ELSE ' ';
-* HTL_NAME/A35 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_NAME ELSE ' ';
 -* HTL_NAME/A35 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_NAME ELSE 'ALL OTHER';
 HTL_NAME/A30= IF RANK_VALUE NE 'OTHER' THEN PROP_NAME ELSE 'ALL OTHER';
 HH_NAME/A30 = IF RANK_VALUE LE '&&HTL_LMT' AND CHAIN_CODE EQ 'HH' THEN PROP_NAME ELSE 'ALL OTHER';
-************************IBI KR 
-*PROP_PHONE/A14= IF RANK_VALUE LE '&&HTL_LMT' THEN HOTEL_PHONE ELSE ' ';	
-*  PROP_PHONE/A15= IF RANK_VALUE LE '&&HTL_LMT' THEN HOTEL_PHONE ELSE ' ';
PROP_PHONE/A15 = IF RANK_VALUE NE 'OTHER' THEN HOTEL_PHONE ELSE ' ';
-*   PROP_C/A7 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_CODE ELSE ' ';
PROP_C/A7 = IF RANK_VALUE NE 'OTHER' THEN PROP_CODE ELSE ' ';  
-*   ZIP5/A5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_ZIP5 ELSE ' ';	
ZIP5/A5 = IF RANK_VALUE NE 'OTHER' THEN PROP_ZIP5 ELSE ' ';
-* New Property Master fields
LANYON_ID/A15 = IF RANK_VALUE NE 'OTHER' THEN PROP_LANYON_ID ELSE ' ';
PROP_LAT/D13.8CS = IF RANK_VALUE NE 'OTHER' THEN PROP_LATITUDE ELSE 0;
PROP_LON/D13.8CS = IF RANK_VALUE NE 'OTHER' THEN PROP_LONGITUDE ELSE 0;
MOBILE_STARS/I5 = IF RANK_VALUE NE 'OTHER' THEN PROP_MOBIL_STARS ELSE 0;
AAA_DIAMONDS/I5 = IF RANK_VALUE NE 'OTHER' THEN PROP_AAA_DIAMONDS ELSE 0;
OHG_CLASS/A5 = IF RANK_VALUE NE 'OTHER' THEN PROP_OHG_CLASS ELSE ' ';
SCALED/A20 = IF RANK_VALUE NE 'OTHER' THEN SCALE_DESC ELSE ' ';

END
-RUN



TABLE FILE HOLD3
SUM
     YBOOKINGS
     PYBOOKINGS
     YNUMDYS 
     PNUMDYS 
     YDRRATE
     YDSTD
     YDTOT_AMT
     PYDTOT_AMT
     YNMBR_DAYS 	
     PYNMBR_DAYS 	
     YDROOMS	
     PYDROOMS
     YDSVGS
     YROOM_AMT 
     YDTOT_STD
     YDTOT_SVGS
     PROHSP1
     PROHRM
     REFUSE_CD	
     RESV_BRANCH	
     CPREF_FLAG
-*     YDPREF_NON
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
BY HTL_NAME
BY HH_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
BY PROP_C
BY LANYON_ID
BY PROP_LAT
BY PROP_LON
BY MOBILE_STARS
BY AAA_DIAMONDS
BY OHG_CLASS
BY SCALED
ON TABLE HOLD AS HOLD4
END
-RUN



TABLE FILE HOLD2
SUM 
     YBOOKINGS
     PYBOOKINGS
     YNUMDYS 
     PNUMDYS 
     YDRRATE
     YDSTD
     YDTOT_AMT
     PYDTOT_AMT
     YNMBR_DAYS 	
     PYNMBR_DAYS 	
     YDROOMS	
     PYDROOMS
     YDSVGS
     YROOM_AMT 
     YDTOT_STD
     YDTOT_SVGS
-*     REFUSE_CD	
-*     RESV_BRANCH	
-*     PREF_NON
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
ON TABLE HOLD AS RHOLD1
END
-RUN

TABLE FILE RHOLD1
PRINT *
-* RANKED BY HIGHEST NMBR_DAYS AS 'DAYS_RANK'
RANKED BY HIGHEST &&RANK_METH AS 'DAYS_RANK'
ON TABLE HOLD AS RHOLD2
END
-RUN

MATCH FILE HOLD4
PRINT *
BY CITY_ST
ON TABLE HOLD
RUN
FILE RHOLD2
SUM DAYS_RANK
BY CITY_ST
AFTER MATCH HOLD AS HOLD5 OLD-OR-NEW
END
-RUN

TABLE FILE HOLD5
PRINT *
RANKED BY HIGHEST DAYS_RANK
ON TABLE HOLD AS HOLD6
END
-RUN


-*-SET &&CTY_LMT = 200;
DEFINE FILE HOLD6
  CTY_LIMIT/I3 = &&CTY_LMT;
  CLIMIT/A3    = EDIT(CTY_LIMIT) ;
  CRANK/D5     = RANK;    
  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
  LIST/D6 = IF CITY_ST NE LAST CITY_ST THEN (LAST LIST + 1) ELSE LAST LIST;
  FRANKX/A7 = FTOA(LIST, '(D6)', 'A7');
  FRANK/A6= EDIT(FRANKX,'$999999');
  CTY_VALUE/A9 = IF CTY_LIMIT EQ 0 THEN BRANK ELSE
                 IF RANK GT CTY_LIMIT THEN 'ALL OTHER' ELSE BRANK;
-*                  IF CITY_ST EQ ' ' THEN 'ALL OTHER' ELSE BRANK;
  FLAG/A9 = IF CTY_VALUE EQ 'ALL OTHER' THEN 'ALL OTHER' ELSE 'A';                

END
-RUN

TABLE FILE HOLD6
PRINT BRANK
     YBOOKINGS
     PYBOOKINGS
     YNUMDYS 
     PNUMDYS 
     YDRRATE
     YDSTD
     YDTOT_AMT
     PYDTOT_AMT
     YNMBR_DAYS 	
     PYNMBR_DAYS 	
     YDROOMS	
     PYDROOMS
     YDSVGS
     YROOM_AMT 
     YDTOT_STD
     YDTOT_SVGS
     PROHSP1
     PROHRM
  CLIMIT
  CITY_ST	
  CTY_LIMIT	
  DAYS_RANK 	
  REFUSE_CD	
  RESV_BRANCH	
  FLAG
  CPREF_FLAG
BY CTY_VALUE
-* BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY CHAIN_CD
BY CHAIN_NM
BY RANK_VAL AS 'RANK_VALUE'
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
BY PROP_C
BY LANYON_ID
BY PROP_LAT
BY PROP_LON
BY MOBILE_STARS
BY AAA_DIAMONDS
BY OHG_CLASS
BY SCALED
ON TABLE HOLD AS HOLD7
END
-RUN


TABLE FILE RPT_HOLDA
SUM YDROOMS/D8 AS 'CTLDAYS'
    YDTOT_AMT AS 'CTLAMT'
BY CITY_ST
ON TABLE HOLD AS HOLD8
END
-RUN

MATCH FILE HOLD7
PRINT 
  CLIMIT	
  CTY_LIMIT	
  DAYS_RANK 
  FLAG
  REFUSE_CD	
  RESV_BRANCH	
  YBOOKINGS
  PYBOOKINGS
  YNUMDYS 
  PNUMDYS 
  YDRRATE
  YDSTD
  YDTOT_AMT
  
  PYDTOT_AMT
  YNMBR_DAYS 	
  PYNMBR_DAYS 	
  YDROOMS	
  PYDROOMS
  YDSVGS
  YROOM_AMT 
  YDTOT_STD
  YDTOT_SVGS
  PROHSP1
  PROHRM
  CTY_VALUE
  PROP_C
  PROP_CITY
  PROP_STATE_CD
  CHAIN_CD
  CHAIN_NM
  RANK_VALUE
  HTL_NAME
  ZIP5
  HTL_ADDRESS
  PROP_PHONE
  LANYON_ID
  PROP_LAT
  PROP_LON
  MOBILE_STARS
  AAA_DIAMONDS
  OHG_CLASS  
  SCALED
  CPREF_FLAG
BY CITY_ST
ON TABLE HOLD
RUN
FILE HOLD8
SUM CTLDAYS
    CTLAMT
BY CITY_ST
AFTER MATCH HOLD AS HOLD9 OLD-OR-NEW
END
-RUN

TABLE FILE HOLD9
PRINT
    YBOOKINGS
    YBOOKINGS AS 'BKGS'   
   CTLAMT
   CTLDAYS
   CLIMIT
   CTY_LIMIT
   DAYS_RANK
   FLAG
   YDRRATE
    YDSTD
   YDTOT_AMT
   YNMBR_DAYS AS 'NDYS'
   YNMBR_DAYS
   YDROOMS
   PYDROOMS
   YNUMDYS
   REFUSE_CD
   RESV_BRANCH
   YDTOT_AMT AS 'ROOM_AMT'
   PYDTOT_AMT
   YDSVGS
   YDTOT_STD
   YDTOT_SVGS  
   YDTOT_SVGS AS 'TSLV'
   CPREF_FLAG
     PROHSP1
     PROHRM
COMPUTE PCTTAMT/D8.1S = IF ((CTLAMT LT 1) AND (CTLAMT GT (-1))) THEN 0
                        ELSE ((YDTOT_AMT/CTLAMT)*100);
     
BY CTY_VALUE
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
BY PROP_C
BY LANYON_ID
BY PROP_LAT
BY PROP_LON
BY MOBILE_STARS
BY AAA_DIAMONDS
BY OHG_CLASS
BY SCALED
ON TABLE HOLD AS HOLD10
END
-RUN







-Finishrpt
-*-SET &&TOTALR = &&RANK_LIMIT;

-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-SET &FXM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXY=EDIT(&&FXDATE,'$9999');
-SET &TXM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXY=EDIT(&&TXDATE,'$9999');
-SET &CYR = EDIT(&&FROMDT,'$$$99');
-SET &PYR = EDIT(&&TXDATE,'$$$99');
-SET &SP='|';
-SET &ROLLNME = TRUNCATE(&&RPTNAM);

-SET &ROLLCTY1 = LCWORD(15, '&&ROLLCTY.EVAL', 'A15');

-SET &ROLLCNCT = TRUNCATE(&&ROLLCNCT);
-SET &ROLLCS = TRUNCATE(&ROLLCTY1) || EDIT(&&ROLLSTA,', 99');

-SET &ROLLPHN = EDIT(&&ROLLFON,'9-999-999-9999');
 
-SET &ROLLCS = IF &&ROLLCS EQ ',' THEN ' ' ELSE &ROLLCS;
-SET &ROLLCS = IF &&ROLLSTA EQ '  ' THEN &&ROLLCTY ELSE &ROLLCS;
-SET &ROLLPHN = IF &&ROLLPHN EQ ' -   -   -    ' THEN ' ' ELSE &ROLLPHN;
-RUN
 

DEFINE FILE HOLD10

  HTL_NAM1/A20 = SUBSTR(30, HTL_NAME, 1, 20, 20, HTL_NAM1);
  HADDRS/A22 = SUBSTR(35, HTL_ADDRESS, 1, 20, 20, HADDRS);
  ADDRESS/A22 = IF CTY_VALUE LT CLIMIT THEN HADDRS ELSE ' ';	
  CHAIN_NAME/A35 = IF CTY_VALUE LT CLIMIT THEN CHAIN_NM ELSE ' ';	
  CHAIN_PRNT/A2 = IF CTY_VALUE LT CLIMIT THEN CHAIN_CD ELSE ' ';	
  CITY_PRNT/A35 = IF CTY_VALUE LT CLIMIT THEN PROP_CITY ELSE ' ';	
  CTY_PRINT/A35 = IF CTY_VALUE LT CLIMIT THEN CITY_ST ELSE ' ';	
  CTY_PRINT2/A22 = EDIT(CTY_PRINT, '9999999999999999999999');
  HH_RANK/A1 = IF RANK_VALUE EQ 'OTHER' THEN 'B' ELSE 
               IF RANK_VALUE EQ 'GRAND' THEN 'C' ELSE 'A';
  HH_FLAG/A15 = IF HH_RANK EQ 'A' THEN 'HILTON BRAND' ELSE 
                IF HH_RANK EQ 'C' THEN 'GRAND TOTAL' ELSE 'ALL OTHER';
 CTY_PRINT3/A18 = IF RANK_VALUE EQ 'GRAND' THEN EDIT(CITY_ST, '999999999999999999') ELSE
                  EDIT(CTY_PRINT, '999999999999999999');
                          
-************************IBI KR  
-* HTL_PHONE/A14 = IF CTY_VALUE LT CLIMIT THEN PROP_PHONE ELSE ' ';	
  HTL_PHONE/A15 = IF CTY_VALUE LT CLIMIT THEN PROP_PHONE ELSE ' ';	
  HTL_PRINT/A30 = IF CTY_VALUE EQ 'GRAND TTL' THEN HTL_NAME ELSE
                  IF CTY_VALUE LT CLIMIT THEN HTL_NAME ELSE ' ';
  HTL_PRINT1/A20 = IF CTY_VALUE LT CLIMIT THEN HTL_NAM1 ELSE ' ';	
  HTL_RANK/A5 = IF CTY_VALUE LT CLIMIT THEN RANK_VALUE ELSE ' ';
  HTL_RANK1/A5 = IF CTY_VALUE LT CLIMIT AND RANK_VALUE NE 'OTHER' THEN RANK_VALUE ELSE ' ';
  STATE_PRNT/A35 = IF CTY_VALUE LT CLIMIT THEN PROP_STATE_CD ELSE ' ';	
  ZIP_PRINT/A5 = IF CTY_VALUE LT CLIMIT THEN ZIP5 ELSE ' ';	
  FLAGN/A9 = IF FLAG EQ 'A' THEN ':' ELSE FLAG;      
  PROP_CD/A7 = IF CTY_VALUE LT CLIMIT THEN PROP_C ELSE ' ';
  LID_P/A15 = IF CTY_VALUE LT CLIMIT THEN LANYON_ID ELSE ' ';
  LAT_P/D13.8CS = IF CTY_VALUE LT CLIMIT THEN PROP_LAT ELSE 0;
  LON_P/D13.8CS = IF CTY_VALUE LT CLIMIT THEN PROP_LON ELSE 0;
  MOS_P/I5 = IF CTY_VALUE LT CLIMIT THEN MOBILE_STARS ELSE 0;
  AAA_P/I5 = IF CTY_VALUE LT CLIMIT THEN MOBILE_STARS ELSE 0;
  OHG_P/A5 = IF CTY_VALUE LT CLIMIT THEN OHG_CLASS ELSE ' ';
  SCALE_D/A20 = IF CTY_VALUE LT CLIMIT THEN SCALED ELSE ' ';
  CUR_YR/A4 = 'FY' || '&CYR.EVAL';
  PR_YR/A4 = 'FY' ||  '&PYR.EVAL';
  PREF_YR/A4 = '&FMY.EVAL';
  PREFN_FLAG/A1 = IF CPREF_FLAG EQ 'Y' THEN 'Y' ELSE ' ';
  PNPR1/A1 = IF PREFN_FLAG EQ 'Y' THEN 'P' ELSE ' ';
-* CTY_PRINT3/A18 = IF CTY_PRINT EQ ' ' AND PNPR1 EQ 'P' THEN 'PREFERRRED' ELSE
-*                  IF CTY_PRINT EQ ' ' AND PNPR1 EQ ' ' THEN 'NON-PREFERRED' ELSE
-*                  EDIT(CTY_PRINT, '999999999999999999');
                  
              
-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-**********************************************************************
  NOWTOD/A8 WITH CTY_VALUE = HHMMSS (NOWTOD);	
SPACE/A5 = ' ';
END

 


-IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' GOTO EXLFMT;
-RUN

 


-********************** Excel 2K Output
-EXLFMT;

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADERDD' ELSE 'HDREXLSDD'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

TABLE FILE HOLD10
HEADING 
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
 
 
-*SUM PYDROOMS/D12CS AS ' FY&&PYEAR.EVAL,NBR,NTS'
-*    YNMBR_DAYS/D12CS AS 'YTD&&CYEAR.EVAL,NBR,NTS'
SUM PYDROOMS/D12CS AS 'Period1,NBR,NTS'
    YNMBR_DAYS/D12CS AS 'Period2,NBR,NTS'    PROHRM AS 'FY&&CYEAR.EVAL,PROJ,NBR,NTS'
COMPUTE VARPCTR/D12.1% = IF ((PYDROOMS LT 1) AND (PYDROOMS GT (-1))) THEN 0 ELSE
                     ((PROHRM-PYDROOMS)/PYDROOMS) ; AS '%CHG,NBR,NTS'
-*    PYDTOT_AMT/D12CSM AS ' FY&&PYEAR.EVAL,TOT,AMT'
-*ROOM_AMT/D12CSM AS 'YTD&&CYEAR.EVAL,TTL,ROOM,AMT'
    PYDTOT_AMT/D12CSM AS 'Period1,TOT,AMT'
ROOM_AMT/D12CSM AS Period2,TTL,ROOM,AMT'    PROHSP1/D12CSM AS 'FY&&CYEAR.EVAL,PROJ,TOT,AMT'
COMPUTE VARPCTA/D12.1% = IF ((PYDTOT_AMT LT 1) AND (PYDTOT_AMT GT (-1))) THEN 0 ELSE
                     ((PROHSP1-PYDTOT_AMT)/PYDTOT_AMT) ; AS '%CHG,NBR,NTS'

COMPUTE AVGAMT/D12.2=IF (ROOM_AMT LT 0) AND (YNMBR_DAYS LT 0) THEN ((ROOM_AMT/YNMBR_DAYS)*(-1)) ELSE
                     IF ((YNMBR_DAYS LT 1) AND (YNMBR_DAYS GT (-1))) THEN 0 ELSE
                     ROOM_AMT/YNMBR_DAYS; AS 'AVG,DLY,RT'
BKGS AS 'NET,BKG'
COMPUTE AVGSTAY/D9=IF (YNUMDYS LT 0) AND (BKGS LT 0) THEN ((YNUMDYS/BKGS)*(-1)) ELSE 
                   IF ((BKGS LT 1) AND (BKGS GT (-1))) THEN 0 ELSE 
                   YNUMDYS/BKGS; AS  'AVG,STAY' 
 TSLV AS 'SVGS' 
 COMPUTE SPN/D12.2S=IF ((NDYS LT 1) AND (NDYS GT (-1))) THEN 0 ELSE TSLV/NDYS; AS 'SVG,PER,NT'



BY CTY_VALUE AS 'RANK'
BY CTY_PRINT3 AS 'CITY'
BY HTL_RANK NOPRINT
BY HTL_PRINT1 AS 'PROPERTY NAME'
BY ADDRESS AS 'ADDRESS'
BY PREFN_FLAG AS '&FMY.EVAL PREF ?'
BY PNPR1 NOPRINT
BY ZIP_PRINT AS 'ZIP,CD'
BY HTL_PHONE AS 'PHONE'
BY CHAIN_PRNT AS 'CH,CD'
BY PROP_CD AS 'GDS,CODE'
BY LID_P AS 'LANYON,ID'


ON CTY_PRINT3 RECOMPUTE MULTILINES AS 'TOTAL'
 
 

 
FOOTING BOTTOM
-INCLUDE FOOTERSM

ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *
-INCLUDE &&PASTYS
 
-JOY
TYPE=REPORT, COLUMN=N1, SQUEEZE=.5, $

TYPE=REPORT, COLUMN=N2, SQUEEZE=1.5, $
TYPE=REPORT, COLUMN=N3, SQUEEZE=1.5, $
TYPE=DATA, JUSTIFY=LEFT, $
-*TYPE=DATA, COLUMN=N2, COLOR=RGB(0 0 138), $
-*TYPE=DATA, COLUMN=N4, COLOR=RGB(0 0 138), $
TYPE=DATA, COLUMN=N6, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P',SQUEEZE=.5, $  
TYPE=DATA, COLUMN=N7, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N8, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N9, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N10, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N11, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P',SQUEEZE=.5, $ 
TYPE=DATA, COLUMN=N12, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', SQUEEZE=.5, $ 
TYPE=DATA, COLUMN=N13, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', SQUEEZE=.5, $ 

TYPE=DATA, COLUMN=N14, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', SQUEEZE=.5, $ 
TYPE=DATA, COLUMN=N15, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', SQUEEZE=.5, $ 
TYPE=DATA, COLUMN=N16, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N17, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N18, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N19, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N20, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
 

TYPE=SUBTOTAL, JUSTIFY=LEFT, STYLE=BOLD, $
TYPE=GRANDTOTAL, JUSTIFY=LEFT, STYLE=BOLD,$
 
ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-GOTO XXIT;



 




-XXIT;