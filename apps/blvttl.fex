
-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-*                     FOCEXEC: BLVTTL
-**************************************************************************
-* Created by JK 1/16/03
-**************************************************************************


SET ASNAMES=ON
-RUN

-INCLUDE SETECHO
SET ASNAMES=ON

-SET &&RPTSUF = 'BLVFILE';

-INCLUDE FDEFRPTS
-RUN


TABLE FILE &&RPT_HOLD
SUM FARE_PAID AS 'TFARE'
    SEG_LOWEST AS 'TLOW'
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
ON TABLE HOLD AS AIRHOLD1
END
-RUN

TABLE FILE &&RPT_HOLD
PRINT AIRLINE	
      ARR_DATE
      BOOK_DT
      CARD_FLAG	
      CLASS	
      DPT_TIME	
      EMB_APT_CD	
      INTL_DOM	
      LEVEL1	
      LEVEL2	
      LEVEL3
      MNON_REF
      OT_BOOK	
      PASSNGR_NAME
      REFUSE_CODE	
      RTE_APT_CD	
      SO_FLAG
      TKT_NUM
      TRN_DATE	
      VOID
      VOID_DATE	
      XDPT_DT	
      XTRAN_DT	
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
BY SEG_NBR
ON TABLE HOLD AS XTWO
END
-RUN

MATCH FILE XTWO
PRINT AIRLINE	
      ARR_DATE
      BOOK_DT	
      CARD_FLAG
      CLASS	
      DPT_TIME	
      EMB_APT_CD	
      INTL_DOM	
      LEVEL1	
      LEVEL2	
      LEVEL3
      OT_BOOK
      MNON_REF	
      PASSNGR_NAME
      REFUSE_CODE	
      RTE_APT_CD	
      SO_FLAG
      TKT_NUM	
      TRN_DATE
      VOID
      VOID_DATE	
      XDPT_DT	
      XTRAN_DT	
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
BY SEG_NBR
ON TABLE HOLD
RUN
FILE AIRHOLD1
PRINT TFARE
      TLOW
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
AFTER MATCH HOLD AS AIRHOLD2 OLD-OR-NEW
END
-RUN

TABLE FILE AIRHOLD2
PRINT AIRLINE
      ARR_DATE	
      BOOK_DT
      CARD_FLAG	
      CLASS	
      DPT_TIME	
      EMB_APT_CD	
      INTL_DOM	
      LEVEL_DESC
      LEVEL1	
      LEVEL2	
      LEVEL3
      MNON_REF
      OT_BOOK	
      PASSNGR_NAME
      REFUSE_CODE	
      RTE_APT_CD
      SO_FLAG	
      TFARE	
      TKT_NUM	
      TRN_DATE
      TLOW
      VOID
      VOID_DATE
      XPSNGR_NM
      XDPT_DT	
      XTRAN_DT	
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD AS AIRHOLD3
END
-RUN
 
DEFINE FILE AIRHOLD3
XT_DTE/A8 = EDIT(TRN_DATE);
XTKT_SRT/A10 = EDIT(TKT_SORT,'9999999999$');
XTRAN_DTE/MDYY = IF TKT_NUM NE LAST TKT_NUM THEN XTRAN_DT ELSE 0;
-******************************************************************
-* ****DEFINES ON PREVIOUS DEFINES****
SRT_DT/A100 = TKT_SORT||XT_DTE||LEVEL_DESC||XPSNGR_NM;
FARE_AMT/D12.2CS = IF SRT_DT NE LAST SRT_DT THEN TFARE ELSE 0;
LOW_AMT/D12.2CS = IF SRT_DT NE LAST SRT_DT THEN TLOW ELSE 0;
NOWTOD/A8 WITH TKT_SORT = HHMMSS (NOWTOD);
END


TABLE FILE CAR_HOLD
SUM NBR_DAYS
    DAILY_RATE
    VENDOR_NAME
BY LEVEL_DESC
BY TKT_NUM
BY PASSNGR_NAME
BY PICKUP_DATE
WHERE TKT_NUM NE '0000000000'
ON TABLE HOLD AS CAR_HOLD1
END
-RUN

TABLE FILE CAR_HOLD1
PRINT NBR_DAYS
    DAILY_RATE
    VENDOR_NAME
BY LEVEL_DESC
BY TKT_NUM
BY PASSNGR_NAME
BY PICKUP_DATE
WHERE DAILY_RATE NE 0 
WHERE NBR_DAYS NE 0
ON TABLE HOLD AS CAR_HOLD2
END
-RUN


TABLE FILE HTL_HOLD
SUM  NNROOMS
     ROOM_RATE
     PROP_NAME 
BY LEVEL_DESC
BY TKT_NUM
BY PASSNGR_NAME
BY CHKIN_DATE
WHERE TKT_NUM NE '0000000000'
ON TABLE HOLD AS HTL_HOLD1
END
-RUN

TABLE FILE HTL_HOLD1
PRINT NNROOMS
      ROOM_RATE
      PROP_NAME 
BY LEVEL_DESC
BY TKT_NUM
BY PASSNGR_NAME
BY CHKIN_DATE
WHERE ROOM_RATE NE 0
WHERE NNROOMS NE 0
ON TABLE HOLD AS HTL_HOLD2
END
-RUN


TABLE FILE AIRHOLD3
PRINT AIRLINE	
      BOOK_DT
      CARD_FLAG	
      CLASS	
      DPT_TIME	
      EMB_APT_CD	
      FARE_AMT
      INTL_DOM	
      LEVEL1	
      LEVEL2	
      LEVEL3
      LOW_AMT 
      OT_BOOK	
      MNON_REF
      PASSNGR_NAME
      REFUSE_CODE	
      RTE_APT_CD
      SEG_NBR	
      SO_FLAG
      TFARE	
      TKT_NUM	
      TKT_SORT
      TRN_DATE
      TLOW
      VOID
      VOID_DATE
      XDPT_DT	
      XTRAN_DT
      XTKT_SRT
BY LEVEL_DESC
BY TKT_NUM
BY PASSNGR_NAME
BY ARR_DATE
ON TABLE HOLD AS AIRHOLD4
END
-RUN

MATCH FILE AIRHOLD4
PRINT AIRLINE	
      BOOK_DT
      CARD_FLAG	
      CLASS	
      DPT_TIME	
      EMB_APT_CD	
      FARE_AMT
      INTL_DOM	
      LEVEL1	
      LEVEL2	
      LEVEL3
      LOW_AMT
      OT_BOOK
      MNON_REF	
      PASSNGR_NAME
      REFUSE_CODE	
      RTE_APT_CD
      SEG_NBR	
      SO_FLAG
      TFARE	
      TKT_NUM	
      TKT_SORT
      TRN_DATE
      TLOW
      VOID
      VOID_DATE
      XDPT_DT	
      XTRAN_DT
      XTKT_SRT
BY LEVEL_DESC
BY TKT_NUM
BY PASSNGR_NAME
BY ARR_DATE
ON TABLE HOLD
RUN
FILE CAR_HOLD2
SUM NBR_DAYS
    DAILY_RATE
    VENDOR_NAME
BY LEVEL_DESC
BY TKT_NUM
BY PASSNGR_NAME
BY PICKUP_DATE
AFTER MATCH HOLD AS ADCD OLD-OR-NEW
END
-RUN


MATCH FILE ADCD
PRINT AIRLINE	
      BOOK_DT
      CARD_FLAG	
      CLASS
      DAILY_RATE	
      DPT_TIME	
      EMB_APT_CD	
      FARE_AMT
      INTL_DOM	
      LEVEL1	
      LEVEL2	
      LEVEL3
      LOW_AMT
      NBR_DAYS
      OT_BOOK
      MNON_REF	
      PASSNGR_NAME
      REFUSE_CODE	
      RTE_APT_CD
      SEG_NBR	
      SO_FLAG
      TFARE	
      TKT_NUM	
      TKT_SORT
      TRN_DATE
      TLOW
      VENDOR_NAME
      VOID
      VOID_DATE
      XDPT_DT	
      XTRAN_DT
      XTKT_SRT
BY LEVEL_DESC
BY TKT_NUM
BY PASSNGR_NAME
BY ARR_DATE
ON TABLE HOLD
RUN
FILE HTL_HOLD2
SUM NNROOMS
    ROOM_RATE
    PROP_NAME
BY LEVEL_DESC
BY TKT_NUM
BY PASSNGR_NAME
BY CHKIN_DATE
AFTER MATCH HOLD AS ADCDHD OLD-OR-NEW
END
-RUN

-IF &&DRILLED_RUN EQ 'N' GOTO SKIP_DRIL;
-************************************************************
-* INCLUDE PROGRAM TO GEN WHERE STATEMENTS
-************************************************************
-SET &&DRILLRPT = 'AIRHOLD3';
-INCLUDE DRILWHRS
-SKIP_DRIL
-************************************************************
TABLE FILE ADCDHD
PRINT TKT_NUM AS 'TICKET NUMBER'
      BOOK_DT AS 'BOOK DATE'
      XDPT_DT AS 'DEPARTURE,DATE'
      AIRLINE AS 'FLOWN,CARRIER'
      FARE_AMT AS 'FARE PAID'
      LOW_AMT AS 'LOW FARE'
      PASSNGR_NAME AS 'PASSENGER NAME'
      REFUSE_CODE AS 'REASON CODE'
      LEVEL2 AS 'DEPARTMENT NUMBER'
      LEVEL3 AS 'PROJECT/PHASE NUMBER'
      CLASS AS 'CLASS OF SERVICE'
      EMB_APT_CD AS 'ORIGIN'
      RTE_APT_CD AS 'DESTINATION'
      INTL_DOM AS 'SEGMENT,DOM/INT'
      SO_FLAG AS 'CONNECTION,/STOPOVER'
      VOID AS 'VOID'
      VOID_DATE AS 'VOID DATE'
      OT_BOOK AS 'ONLINE'
      MNON_REF AS 'REFUNDABLE/NON-REFUNDABLE'
      CARD_FLAG AS 'MASTERCARD'
      PROP_NAME AS 'HOTEL NAME'
      NNROOMS AS 'NIGHTS'
      ROOM_RATE AS 'DAILY RATE'
      VENDOR_NAME AS 'CAR VENDOR'
      NBR_DAYS AS 'DAYS'
      DAILY_RATE AS 'DAILY RATE'

BY LEVEL_DESC NOPRINT
BY PASSNGR_NAME NOPRINT
BY XTKT_SRT NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
BY TRN_DATE NOPRINT
BY XDPT_DT NOPRINT
BY DPT_TIME NOPRINT
BY TKT_NUM NOPRINT

ON TABLE SET STYLE *
-INCLUDE &&DTSTY
ENDSTYLE
-*
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
-*

-* REJ EX RESTART 
-*-*-EXIT


