-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* CHANGED TITLE OF 0-6 AND 7-13 TO INCLUDE ADV PURCHASE DAYS PER PATTI   
-* DEB 1/13/05
-INCLUDE SETECHO
SET ASNAMES=ON

-SET &&RPTSUF = 'NONCOMPLIANCE';
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');

-INCLUDE FDEFRPTS
-RUN

JOIN ABNONHLD.LEVEL_DESC IN ABNONHLD TO ABNONHTL.LEVEL_DESC IN ABNONHTL AS J1
END
JOIN ABNONHLD.LEVEL_DESC IN ABNONHLD TO ABNONCAR.LEVEL_DESC IN ABNONCAR AS J2
-RUN


DEFINE FILE ABNONHLD
NOWTOD/A8 WITH NET_TKT_CNT = HHMMSS (NOWTOD);
BLANK/A1 = ' ';
END
-RUN
-IF &&CURRENCY EQ 'USD' THEN GOTO NEXT;

-SET &&SUBHEAD = <NAMEC;

-NEXT;


TABLE FILE ABNONHLD
-INCLUDE GHEADAIR
SUM MXADV_TKT AS 'DAY,ADVANCE,PURCHASE,0-6,TICKETS'
COMPUTE 
MXADVP/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXADV_TKT/NET_TKT_CNT)*100); AS '% OF,0-6,TICKETS'
MXADV_TKT1 AS 'DAY,ADVANCE,PURCHASE,7-13,TICKETS'
COMPUTE 
MXADVP1/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXADV_TKT1/NET_TKT_CNT)*100); AS '% OF,7-13,TICKETS'
REFUNDABLE AS 'REFUNDABLE,TICKETS'
COMPUTE 
REFP/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                ((REFUNDABLE/NET_TKT_CNT)*100); AS '% OF,REFUNDABLE,TICKETS'
MXTRA_TKT AS 'TRADITIONAL,TICKETS'
COMPUTE
MXTRAP/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXTRA_TKT/NET_TKT_CNT)*100); AS '% OF,TRADITIONAL,TICKETS'
LS100 AS 'LOST SAVINGS,$100-$200,TICKETS'
COMPUTE
LS100P/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((LS100/NET_TKT_CNT)*100); AS
                  '% OF TICKETS WITH,LOST SAVINGS,$100-$200'
LS201 AS 'LOST SAVINGS,$201-$300,TICKETS
COMPUTE 
LS201P/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((LS201/NET_TKT_CNT)*100); AS
                  '% OF TICKETS WITH,LOST SAVINGS,$201-$300'
LS301 AS 'LOST SAVINGS,$301+'
COMPUTE 
LS301P/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((LS301/NET_TKT_CNT)*100); AS
                  '% OF TICKETS WITH,LOST SAVINGS,$301+'
TOTAL_ROOM AS 'NUMBER OF,ROOMS GREATER,THAN $150'
COMPUTE HAVG/P12CS = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        ((TOTAL_ROOM/NNROOMS)*100); 
                        AS '% OF ROOMS,GREATER THAN $150'
TOTAL_NON AS 'NUMBER OF,NON-PREFERRED ROOMS'
COMPUTE
HNONP/P12CS = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                 ((TOTAL_NON/NNROOMS)*100); 
                 AS '% OF,NON-PREFERRED ROOMS'
NOMIDBK AS 'NUMBER OF,BOOKINGS,LARGER THAN,MIDSIZE'
COMPUTE 
NOMIDP/P12CS = IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                  ((NOMIDBK/BOOKINGS)*100);
                  AS '% OF,CARS LARGER THAN,MIDSIZE'

BY LEVEL_DESC AS ' '
FOOTING
"</2"
ON TABLE SET PAGE-NUM OFF
ON LEVEL_DESC RECOMPUTE MULTILINES AS 'TOTAL FOR'
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *
TYPE=DATA, COLUMN=N2, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABADV' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N4, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABADV1' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N6, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABREF' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $


TYPE=DATA, COLUMN=N8, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABTRA' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N10, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABLS1' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N12, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABLS2' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N14, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABLS3' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N16, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRAB150' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N18, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABNONP' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N20, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABMID' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=7, BACKCOLOR=NONE, STYLE=NORMAL, $
-* TYPE=HEADING, OBJECT=TEXT, SIZE=8, COLOR=BLACK, $
TYPE=HEADING, LINE=4, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=13, SIZE=10, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=8, STYLE=BOLD, $
TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(&&TNTDTPOS), SIZE=(&&TNTDTSIZ), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLDTPOS), SIZE=(&&ROLDTSIZ), $

ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
-*
END
-RUN
