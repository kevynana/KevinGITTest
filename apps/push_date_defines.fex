-* File push_date_defines.fex
OUTTO/A2='TC';
 
TDATE1/YYMD=&TDATE;
P_MONTH/MDYY=DATEADD(TDATE1, 'M', (-1));
P_EOM/MDYY=DATEMOV(P_MONTH, 'EOM');
 
-* RUN_EOM is the End of Month we are executing.
RUN_EOM/M=P_EOM;
 
-* Determine End of Quarters for Rollups
RFY/M=IF ROLL_FY EQ '' OR '1' OR 'X' THEN 1 ELSE EDIT(ROLL_FY);
-*RFY/M=7;
Q1B/M=RFY;
Q1E/M=IF (RFY + 3) - 1 LT 12 THEN (RFY + 3) - 1 ELSE (RFY + 3) - 1 - 12;
Q2B/M=IF (RFY + 3) GT 12 THEN (RFY + 3) - 12 ELSE (RFY + 3);
Q2E/M=IF (RFY + 6) - 1 LT 12 THEN (RFY + 6) - 1 ELSE (RFY + 6) - 1 - 12;
Q3B/M=IF (RFY + 6) GT 12 THEN (RFY + 6) - 12 ELSE (RFY + 6);
Q3E/M=IF (RFY + 9) - 1 LT 12 THEN (RFY + 9) - 1 ELSE (RFY + 9) - 1 - 12;
Q4B/M=IF (RFY + 9) GT 12 THEN (RFY + 9) - 12 ELSE (RFY + 9);
Q4E/M=IF (RFY + 12) - 1 LT 12 THEN (RFY + 12) - 1 ELSE (RFY + 12) - 1 - 12;
 
-* Determine End of Year Month for Rollups
ANNUAL/M=Q4E;
ANNUAL_YY/YY=P_EOM;
-*ANNUAL_YY1/YY=IF FYFLAG EQ '1' OR '2' THEN ANNUAL_YY + 1 ELSE ANNUAL_YY;
ANNUAL_YY1/YY=IF RUN_EOM GT Q4E THEN ANNUAL_YY + 1 ELSE ANNUAL_YY;
 
ANNUAL_A8MDYY/A8MDYY=EDIT(Q4E) | '01' | EDIT(ANNUAL_YY1);
ANNUAL_MONTH/MDYY=ANNUAL_A8MDYY;
ANNUAL_END/MDYY=DATEMOV(ANNUAL_MONTH, 'EOM');
 
Q4_END/MDYY=ANNUAL_END;
Q4_BEGIN/MDYY=DATEMOV(DATEADD(Q4_END, 'M', (-2)), 'BOM');
Q3_END/MDYY=Q4_BEGIN - 1;
Q3_BEGIN/MDYY=DATEMOV(DATEADD(Q3_END, 'M', (-2)), 'BOM');
Q2_END/MDYY=Q3_BEGIN - 1;
Q2_BEGIN/MDYY=DATEMOV(DATEADD(Q2_END, 'M', (-2)), 'BOM');
Q1_END/MDYY=Q2_BEGIN - 1;
Q1_BEGIN/MDYY=DATEMOV(DATEADD(Q1_END, 'M', (-2)), 'BOM');
 
ANNUAL_BEGIN/MDYY=Q1_BEGIN;
 
BIANNUAL_BEGIN1/MDYY=Q1_BEGIN;
BIANNUAL_END1/MDYY=Q2_END;
BIANNUAL_BEGIN2/MDYY=Q3_BEGIN;
BIANNUAL_END2/MDYY=Q4_END;
CUR_BIA/A1=IF BIANNUAL_END1 EQ P_EOM THEN '1' ELSE
           IF BIANNUAL_END2 EQ P_EOM THEN '2' ELSE '0';
 
CUR_QTR/A1=IF Q1_END EQ P_EOM THEN '1' ELSE
           IF Q2_END EQ P_EOM THEN '2' ELSE
     IF Q3_END EQ P_EOM THEN '3' ELSE
     IF Q4_END EQ P_EOM THEN '4' ELSE '0';
 
P_BOM/MDYY=DATEMOV(P_MONTH, 'BOM');
P_BOQ/MDYY=DATEMOV(P_MONTH, 'BOQ');
P_BOY/MDYY=DATEMOV(P_MONTH, 'BOY');
 
EXFEX/A10=IF ROLLUP_CODE EQ 'TOTAL-R' THEN 'WRUNTOTAL' ELSE
          IF RPT_TYPE EQ 'QTR' THEN 'RUN_QTR' ELSE 'WRUNINDV';
