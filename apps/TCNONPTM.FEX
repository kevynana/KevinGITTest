-***************************************************************************
-* REPORT NAME: TOP NON DIRECTIONAL MARKET PAIR SUMMARY
-* TOTAL COMPANY REPORTING
-**************************************************************
-* Date       Author    Modification
-**************************************************************
-* 01/24/2012 GSE       Removed parens from around OLIMIT to
-*                      prevent errors in 7.7.03
-*  08/23/2016  REJ  S-17914 Changes for ER5.
-*  12/29/2016  REJ  S-28553 Move ER5 My Reports to production.

-**************************************************************
-INCLUDE SETECHO
CREATE FILE TCMARK2
-RUN
 
-INCLUDE TCGETROLL
-RUN
 
 
-SET &CNT = 1;
-REPEAT Loop2 &TOTROLLS TIMES
-SET &&ROLL = &ROLL.&CNT;
EX TCAIRDB
-RUN
- IF &FOCERRNUM EQ 36 THEN GOTO IncLoop2;
 
EX TCNON2EX
-RUN
-IncLoop2
-SET &CNT = &CNT + 1;
-Loop2
 
-IF &&FROMAVRP NE 'Y' GOTO :AVSF0;
-INCLUDE AVRP_SUBFOOT
-:AVSF0
 
-INCLUDE SetParmtime
-RUN
 
-IF &&SETF EQ 'TCTPMTM1' OR 'TCTPMTM2' THEN GOTO SKIP;
 
 
-SET &&RANK_METH =  'NET_TKT_CNT';
-SET &&RANK_LIMIT =   15;
-SET &&RANK_LIMIT2 =  100;
-SET &&ORGDST = DIR_CP_NM;
 
-GOTO NEXT;
 
-SKIP;
 
-SET &&RANK_METH =  'NET_TKT_CNT ';
-SET &&RANK_LIMIT =   30;
-SET &&RANK_LIMIT2 =  100;
-SET &&ORGDST = DIR_CP_NM;
 
-NEXT;
 
-IF &&SETF EQ 'TCTPMTM1' THEN GOTO AVGPAX ELSE GOTO AROUND;
 
 
-AVGPAX
 
-SET &DAY1 = &&FROMDT.EVAL;
-SET &DAY2 = &&TODT.EVAL;
DEFINE FILE ROLLUP
FROMDT/YYMD = '&DAY1';
TODT/YYMD = '&DAY2';
IFROMDT/I8YYMD = FROMDT;
ITODT/I8YYMD = TODT;
TOTALDAYS/I5 = DATEDIF(FROMDT,TODT,'D');
FIRSTDAY/A4 = DOWK (IFROMDT,FIRSTDAY);
LASTDAY/A4  = DOWK (ITODT,LASTDAY);
MON/I5 = IF FIRSTDAY EQ 'MON' OR LASTDAY EQ 'MON' OR 'TUE' OR 'WED' OR 'THU' OR 'FRI' OR 'SAT' OR 'SUN' THEN TOTALDAYS/7 + 1 ELSE TOTALDAYS/7;
TUE/I5 = IF FIRSTDAY EQ 'MON' OR 'TUE' OR LASTDAY EQ 'TUE' OR 'WED' OR 'THU' OR 'FRI' OR 'SAT' OR 'SUN' THEN TOTALDAYS/7 + 1 ELSE TOTALDAYS/7;
WED/I5 = IF FIRSTDAY EQ 'MON' OR 'TUE' OR 'WED' OR LASTDAY EQ 'WED' OR 'THU' OR 'FRI' OR 'SAT' OR 'SUN' THEN TOTALDAYS/7 + 1 ELSE TOTALDAYS/7;
THU/I5 = IF FIRSTDAY EQ 'MON' OR 'TUE' OR 'WED' OR 'THU' OR LASTDAY EQ 'THU' OR 'FRI' OR 'SAT' OR 'SUN' THEN TOTALDAYS/7 + 1 ELSE TOTALDAYS/7;
FRI/I5 = IF FIRSTDAY EQ 'MON' OR 'TUE' OR 'WED' OR 'THU' OR 'FRI' OR LASTDAY EQ 'FRI' OR 'SAT' OR 'SUN' THEN TOTALDAYS/7 + 1 ELSE TOTALDAYS/7;
SAT/I5 = IF FIRSTDAY EQ 'MON' OR 'TUE' OR 'WED' OR 'THU' OR 'FRI' OR 'SAT' OR LASTDAY EQ 'SAT' OR 'SUN' THEN TOTALDAYS/7 + 1 ELSE TOTALDAYS/7;
SUN/I5 = IF FIRSTDAY EQ 'MON' OR 'TUE' OR 'WED' OR 'THU' OR 'FRI' OR 'SAT' OR 'SUN' OR LASTDAY EQ 'SUN' THEN TOTALDAYS/7 + 1 ELSE TOTALDAYS/7;
 
FLAG/A1 = 'A';
END
-RUN
TABLE FILE ROLLUP
PRINT MON TUE WED THU FRI SAT SUN
BY ROLLUP
BY FLAG
IF RECORDLIMIT EQ 1
ON TABLE HOLD AS CNTHLD
END
-RUN
 
DEFINE FILE TCMARK2
FLAG/A1 = 'A';
END
-RUN
 
TABLE FILE TCMARK2
PRINT FARE
    MILES
    NET_TKT_CNT
    ORGDST
    DPT_DAY
    TM_RANGE
BY FLAG
ON TABLE HOLD AS HOLD1
END
-RUN
 
 
MATCH FILE HOLD1
PRINT FARE
    MILES
    NET_TKT_CNT
    ORGDST
    DPT_DAY
    TM_RANGE
BY FLAG
ON TABLE HOLD
RUN
FILE CNTHLD
SUM MON TUE WED THU FRI SAT SUN
BY FLAG
AFTER MATCH HOLD AS HOLD1A1 OLD-AND-NEW
END
-RUN
 
 
DEFINE FILE HOLD1A1
DAY_CNT/I5 = IF DPT_DAY EQ 'MON' THEN MON ELSE
             IF DPT_DAY EQ 'TUE' THEN TUE ELSE
             IF DPT_DAY EQ 'WED' THEN WED ELSE
             IF DPT_DAY EQ 'THU' THEN THU ELSE
             IF DPT_DAY EQ 'FRI' THEN FRI ELSE
             IF DPT_DAY EQ 'SAT' THEN SAT ELSE SUN;
END
-RUN
 
TABLE FILE HOLD1A1
PRINT DAY_CNT NET_TKT_CNT
BY ORGDST
BY DPT_DAY
BY TM_RANGE
ON TABLE HOLD AS DAYH
END
-RUN
 
DEFINE FILE DAYH
DAY/I5 = IF DPT_DAY NE LAST DPT_DAY THEN DAY_CNT ELSE
         IF TM_RANGE EQ LAST TM_RANGE THEN 0 ELSE DAY_CNT;
END
-RUN
 
TABLE FILE DAYH
SUM DAY
BY ORGDST
BY DPT_DAY
BY TM_RANGE
ON TABLE HOLD AS DAYH1
END
-RUN
 
MATCH FILE HOLD1A1
PRINT FARE
    MILES
    NET_TKT_CNT
BY ORGDST
BY DPT_DAY
BY TM_RANGE
ON TABLE HOLD
RUN
FILE DAYH
PRINT DAY
BY ORGDST
BY DPT_DAY
BY TM_RANGE
AFTER MATCH HOLD AS HOLD1A1A OLD
END
-RUN
 
TABLE FILE HOLD1A1A
SUM NET_TKT_CNT
    FARE
    MILES
    DAY
BY ORGDST
BY DPT_DAY
BY TM_RANGE
ON TABLE HOLD AS DAYHLD1
END
-RUN
 
 
TABLE FILE DAYHLD1
PRINT DAY
    FARE
    MILES
    NET_TKT_CNT
    DPT_DAY
    TM_RANGE
BY ORGDST
RANKED BY HIGHEST &&RANK_METH
ON TABLE HOLD AS HOLD2
END
-RUN
 
DEFINE FILE HOLD2
  DRANK/D9 = RANK;
  ARANKX/A11 = FTOA(DRANK, '(D9)', 'A11');
  ARANK/A9 = EDIT(ARANKX,'$$999999999');
  RANK_LIMIT/I5 = &&RANK_LIMIT2;
  RNK_VAL/A9 = IF RANK_LIMIT EQ 0 THEN ARANK ELSE
               IF RANK GT RANK_LIMIT THEN 'OTHER' ELSE ARANK;
 
END
-RUN
 
 
TABLE FILE HOLD2
SUM DAY
    FARE
    MILES
    NET_TKT_CNT
BY ORGDST
BY RNK_VAL
BY DPT_DAY
BY TM_RANGE
ON TABLE HOLD AS HOLD3
END
-RUN
 
TABLE FILE HOLD3
SUM DAY
    FARE
    NET_TKT_CNT
    MILES
BY ORGDST
BY RNK_VAL
BY DPT_DAY
BY TM_RANGE
ON TABLE HOLD AS HOLD4
END
-RUN
 
TABLE FILE HOLD4
SUM &&RANK_METH
BY ORGDST
ON TABLE HOLD AS RHOLD1
END
-RUN
 
 
TABLE FILE RHOLD1
PRINT &&RANK_METH
RANKED BY HIGHEST &&RANK_METH AS 'SEG_RANK'
BY ORGDST
ON TABLE HOLD AS RHOLD2
END
-RUN
 
 
MATCH FILE HOLD4
PRINT DAY
    FARE
    MILES
    NET_TKT_CNT
    RNK_VAL
    DPT_DAY
    TM_RANGE
BY ORGDST
ON TABLE HOLD
RUN
FILE RHOLD2
SUM SEG_RANK
BY ORGDST
AFTER MATCH HOLD AS HOLD5 OLD-OR-NEW
END
-RUN
 
 
TABLE FILE HOLD5
PRINT DAY
    FARE
    MILES
    NET_TKT_CNT
    RNK_VAL
    ORGDST
    DPT_DAY
    TM_RANGE
    RNK_VAL
RANKED BY HIGHEST SEG_RANK
ON TABLE HOLD AS HOLD6
END
-RUN
 
 
DEFINE FILE HOLD6
  ORG_LIMIT/I2 = &&RANK_LIMIT ;
  OLIMIT/A2    = EDIT(ORG_LIMIT) ;
  CRANK/D5     = RANK;
  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
  LIST/D6 = IF ORGDST NE LAST ORGDST THEN (LAST LIST + 1)
    ELSE LAST LIST;
  FRANKX/A7 = FTOA(LIST, '(D6)', 'A7');
  FRANK/A6  = EDIT(FRANKX,'$999999');
  ORG_VALUE/A6 = IF ORG_LIMIT EQ 0 THEN BRANK ELSE
                 IF LIST GT ORG_LIMIT THEN 'OTHER' ELSE FRANK;
  ORG_PRINT/A60 = IF ORG_VALUE EQ 'OTHER' THEN 'OTHER' ELSE ORGDST;
END
-RUN
 
TABLE FILE HOLD6
SUM DAY
    FARE
    MILES
    NET_TKT_CNT
    OLIMIT
    RNK_VAL
BY ORG_VALUE
BY ORG_PRINT
BY DPT_DAY
BY TM_RANGE
ON TABLE HOLD AS HOLD7
END
-RUN
 
DEFINE FILE HOLD7
-* -INCLUDE STDTIME1
-*   ORG_PRINT/A55 =IF ORG_VALUE LT OLIMIT THEN ORGDST ELSE 'ALL OTHER';
-*   RO_PRINT/A15 =IF ORG_VALUE LT OLIMIT THEN TMR_PRINT ELSE
-*                  IF ORG_PRINT EQ 'ALL OTHER' THEN TM_RANGE ELSE ' ';
-*   OTH_PRINT/A15   = IF ORG_PRINT EQ 'ALL OTHER' THEN TM_RANGE ELSE ' ';
DD_PRINT/A15 = IF ORG_PRINT EQ 'OTHER' THEN 'OTHER' ELSE DPT_DAY;
TM_PRINT/A15 = IF ORG_PRINT EQ 'OTHER' THEN 'OTHER' ELSE TM_RANGE;
 
END
-RUN
 
TABLE FILE HOLD7
PRINT DAY
    FARE
    MILES
    NET_TKT_CNT
    OLIMIT
    RNK_VAL
BY ORG_VALUE
BY ORG_PRINT
BY DD_PRINT
BY TM_PRINT
ON TABLE HOLD AS HOLD8
END
-RUN
 
 
TABLE FILE HOLD7
SUM MILES AS 'C_MILES'
    FARE AS 'C_FARE'
    NET_TKT_CNT AS 'C_SEGMT'
BY ORG_PRINT
ON TABLE HOLD AS HOLD9
END
-RUN
 
MATCH FILE HOLD8
PRINT DAY
    FARE
    MILES
    NET_TKT_CNT
    ORG_VALUE
    RNK_VAL
    OLIMIT
    DD_PRINT
    TM_PRINT
BY ORG_PRINT
ON TABLE HOLD
RUN
FILE HOLD9
SUM C_FARE
    C_MILES
    C_SEGMT
BY ORG_PRINT
AFTER MATCH HOLD AS HOLD10 OLD-OR-NEW
END
-RUN
 
 
-SET &&RPTSUF = 'SMY';
-INCLUDE FDEFRPTS
-RUN
 
-TYPE BEFORE DEFINES
 
DEFINE FILE HOLD10
  RANK_VALUE/A9 = IF ORG_PRINT EQ 'ALL OTHER' THEN '1' ELSE RNK_VAL;
  PER_FARE/D8.1=    IF ((C_FARE LT 1) AND (C_FARE GT (-1))) THEN 0
                    ELSE ((FARE/C_FARE)*100);
  SEGPER/D8.1 =     IF ((C_SEGMT LT 1) AND (C_SEGMT GT (-1))) THEN 0
                    ELSE ((NET_TKT_CNT/C_SEGMT)*100);
  MILE_PCT/D8.1=    IF ((C_MILES LT 1) AND (C_MILES GT (-1))) THEN 0
                    ELSE ((MILES/C_MILES)*100);
  COSTPER_MILE/D8.2=IF ((MILES LT 1) AND (MILES GT (-1))) THEN 0
                    ELSE (FARE/MILES);
  KEY/A1 = IF DD_PRINT EQ 'MON' THEN 'A' ELSE
           IF DD_PRINT EQ 'TUE' THEN 'B' ELSE
           IF DD_PRINT EQ 'WED' THEN 'C' ELSE
           IF DD_PRINT EQ 'THU' THEN 'D' ELSE
           IF DD_PRINT EQ 'FRI' THEN 'E' ELSE
           IF DD_PRINT EQ 'SAT' THEN 'F' ELSE
           'G';
  KEY2/A1 = IF TM_PRINT EQ '6AM - 8AM' THEN 'A' ELSE
            IF TM_PRINT EQ '8AM - 10AM' THEN 'B' ELSE
            IF TM_PRINT EQ '10AM - 12PM' THEN 'C' ELSE
            IF TM_PRINT EQ '12PM - 2PM' THEN 'D' ELSE
            IF TM_PRINT EQ '2PM - 4PM' THEN 'E' ELSE
            IF TM_PRINT EQ '4PM - 6PM' THEN 'F' ELSE
            IF TM_PRINT EQ '6PM - 8PM' THEN 'G' ELSE
            IF TM_PRINT EQ '8PM - 10PM' THEN 'H' ELSE
            'I';
 
 
 -**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS
-*                                  USED IN FOOTERSM
-**********************************************************************
  NOWTOD/A8 WITH ORG_VALUE = HHMMSS (NOWTOD);
END
 
 
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS';
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
 
 
TABLE FILE HOLD10
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</1"
-NOSPC;
   &&S_SUBJ1
   &&S_SUBJ2
   &&S_SUBJ3
   &&S_SUBJ4
   &&S_SUBJ5
   &&S_SUBJ6
   &&S_SUBJ7
   &&S_SUBJ8
   &&S_SUBJ9
   &&S_SUBJ10
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10
 
-INCLUDE FOOTERSM
-*ON TABLE SET STYLE &&SMSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT
-*                                  WITH AN INCLUDE
-**************************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
 
ON TABLE SET STYLE *
 
-INCLUDE &&PASTYS
 
-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILL;
-* -INCLUDE &&DSTY
 
-SKIP_DRILL
 
 
ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN
 
-GOTO XXIT;
 
 
 
-AROUND
-**************************************************************
-* GET THE FINAL REPORT
-**************************************************************
TABLE FILE TCMARK2
SUM FARE
    MILES
    NET_TKT_CNT
BY ORGDST
BY DPT_DAY
BY TM_RANGE
ON TABLE HOLD AS HOLD1
END
-RUN
 
TABLE FILE HOLD1
PRINT DPT_DAY
    FARE
    MILES
    NET_TKT_CNT
    TM_RANGE
BY ORGDST
RANKED BY HIGHEST &&RANK_METH
ON TABLE HOLD AS HOLD2
END
-RUN
 
DEFINE FILE HOLD2
  DRANK/D5      = RANK ;
  ARANKX/A6     = FTOA(DRANK, '(D5)', 'A6');
  ARANK/A5      = EDIT(ARANKX,'$99999');
  RANK_LIMIT/I5 = &&RANK_LIMIT2 ;
  RANK_VALUE/A5 = IF (RANK_LIMIT EQ 0) THEN (ARANK) ELSE
                  IF RANK GT RANK_LIMIT THEN 'OTHER' ELSE ARANK;
END
-RUN
 
TABLE FILE HOLD2
PRINT DPT_DAY
    FARE
    MILES
    NET_TKT_CNT
    TM_RANGE
BY ORGDST
BY RANK_VALUE
ON TABLE HOLD AS HOLD3
END
-RUN
 
DEFINE FILE HOLD3
TMR_PRINT/A15 = IF RANK_VALUE LE '&&RANK_LIMIT2' THEN TM_RANGE ELSE 'OTHER';
DAY_PRINT/A5 = IF RANK_VALUE LE '&&RANK_LIMIT2' THEN DPT_DAY ELSE 'OTHER';
END
-RUN
 
TABLE FILE HOLD3
SUM DPT_DAY
    FARE
    MILES
    NET_TKT_CNT
    TM_RANGE
BY ORGDST
BY RANK_VALUE
BY DAY_PRINT
BY TMR_PRINT
ON TABLE HOLD AS HOLD4
END
-RUN
 
TABLE FILE HOLD1
SUM &&RANK_METH
BY ORGDST
ON TABLE HOLD AS RHOLD1
END
-RUN
 
TABLE FILE RHOLD1
PRINT &&RANK_METH
RANKED BY HIGHEST &&RANK_METH AS 'SEG_RANK'
BY ORGDST
ON TABLE HOLD AS RHOLD2
END
-RUN
 
MATCH FILE HOLD4
PRINT DAY_PRINT
    DPT_DAY
    FARE
    MILES
    NET_TKT_CNT
    RANK_VALUE
    TM_RANGE
    TMR_PRINT
BY ORGDST
ON TABLE HOLD
RUN
FILE RHOLD2
SUM SEG_RANK
BY ORGDST
AFTER MATCH HOLD AS HOLD5 OLD-OR-NEW
END
-RUN
 
TABLE FILE HOLD5
PRINT DAY_PRINT
    DPT_DAY
    FARE
    MILES
    NET_TKT_CNT
    ORGDST
    RANK_VALUE
    TM_RANGE
    TMR_PRINT
RANKED BY HIGHEST SEG_RANK
ON TABLE HOLD AS HOLD6
END
-RUN
 
-* -SET &&RANK_LIMIT =   15;
 
DEFINE FILE HOLD6
  ORG_LIMIT/I2 = &&RANK_LIMIT;
  OLIMIT/A2    = EDIT(ORG_LIMIT) ;
  CRANK/D5     = RANK;
  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
  LIST/D6 = IF ORGDST NE LAST ORGDST THEN (LAST LIST + 1)
    ELSE LAST LIST;
  FRANKX/A7 = FTOA(LIST, '(D6)', 'A7');
  FRANK/A6  = EDIT(FRANKX,'$999999');
  ORG_VALUE/A6 = IF ORG_LIMIT EQ 0 THEN BRANK ELSE
               IF LIST GT ORG_LIMIT THEN 'OTHER' ELSE FRANK;
END
-RUN
 
TABLE FILE HOLD6
SUM DPT_DAY
   TM_RANGE
    FARE
    MILES
    NET_TKT_CNT
    OLIMIT
BY ORG_VALUE
BY ORGDST
BY RANK_VALUE
BY DAY_PRINT
BY TMR_PRINT
ON TABLE HOLD AS HOLD7
END
-RUN
 
DEFINE FILE HOLD7
  ORG_PRINT/A55 =IF ORG_VALUE LT OLIMIT THEN ORGDST ELSE 'ALL OTHER';
  RO_PRINT/A15 = IF ORG_VALUE LT OLIMIT THEN TMR_PRINT ELSE
                  IF ORG_PRINT EQ 'ALL OTHER' THEN TM_RANGE ELSE ' ';
 
END
 
 
TABLE FILE HOLD7
SUM DPT_DAY
    FARE
    MILES
    NET_TKT_CNT
    TM_RANGE
BY ORG_VALUE
BY ORG_PRINT
BY RANK_VALUE
BY RO_PRINT
BY DAY_PRINT
ON TABLE HOLD AS HOLD8
END
-RUN
 
TABLE FILE HOLD7
SUM MILES AS 'C_MILES'
    FARE AS 'C_FARE'
    NET_TKT_CNT AS 'C_SEGMT'
BY ORG_PRINT
ON TABLE HOLD AS HOLD9
END
-RUN
 
MATCH FILE HOLD8
PRINT DAY_PRINT
      DPT_DAY
      FARE
      MILES
      NET_TKT_CNT
      ORG_VALUE
      RANK_VALUE
      TM_RANGE
      RO_PRINT
BY ORG_PRINT
ON TABLE HOLD
RUN
FILE HOLD9
SUM C_FARE
    C_MILES
    C_SEGMT
BY ORG_PRINT
AFTER MATCH HOLD AS HOLD10 OLD-OR-NEW
END
-RUN
 
 
 
 
 
-SET &&RPTSUF = 'SMY';
-INCLUDE FDEFRPTS
-RUN
 
-TYPE BEFORE DEFINES
DEFINE FILE HOLD10
  RNK_VAL/A5 = IF ORG_PRINT EQ 'ALL OTHER' THEN '1' ELSE RANK_VALUE;
  PER_FARE/D8.1=    IF ((C_FARE LT 1) AND (C_FARE GT (-1))) THEN 0
                    ELSE ((FARE/C_FARE)*100);
  SEGPER/D8.1 =     IF ((C_SEGMT LT 1) AND (C_SEGMT GT (-1))) THEN 0
                    ELSE ((NET_TKT_CNT/C_SEGMT)*100);
  MILE_PCT/D8.1=    IF ((C_MILES LT 1) AND (C_MILES GT (-1))) THEN 0
                    ELSE ((MILES/C_MILES)*100);
  KEY/A1 = IF DPT_DAY EQ 'MON' THEN 'A' ELSE
           IF DPT_DAY EQ 'TUE' THEN 'B' ELSE
           IF DPT_DAY EQ 'WED' THEN 'C' ELSE
           IF DPT_DAY EQ 'THU' THEN 'D' ELSE
           IF DPT_DAY EQ 'FRI' THEN 'E' ELSE
           IF DPT_DAY EQ 'SAT' THEN 'F' ELSE
           'G';
  KEY2/A1 = IF TM_RANGE EQ '6AM - 8AM' THEN 'A' ELSE
            IF TM_RANGE EQ '8AM - 10AM' THEN 'B' ELSE
            IF TM_RANGE EQ '10AM - 12PM' THEN 'C' ELSE
            IF TM_RANGE EQ '12PM - 2PM' THEN 'D' ELSE
            IF TM_RANGE EQ '2PM - 4PM' THEN 'E' ELSE
            IF TM_RANGE EQ '4PM - 6PM' THEN 'F' ELSE
            IF TM_RANGE EQ '6PM - 8PM' THEN 'G' ELSE
            IF TM_RANGE EQ '8PM - 10PM' THEN 'H' ELSE
            'I';
  NOWTOD/A8 WITH ORG_VALUE = HHMMSS (NOWTOD);
END
 
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS';
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
 
TABLE FILE HOLD10
-INCLUDE &&PAHDR
   &&S_SUBJ1
   &&S_SUBJ2
   &&S_SUBJ3
   &&S_SUBJ4
   &&S_SUBJ5
   &&S_SUBJ6
   &&S_SUBJ7
   &&S_SUBJ8
   &&S_SUBJ9
   &&S_SUBJ10
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10
 
 
-INCLUDE FOOTERSM
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *
-INCLUDE &&PASTYS
ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN
 
-IF &LINES GT 0 THEN GOTO XXIT;
EX TCEMPTY
-RUN
-XXIT
