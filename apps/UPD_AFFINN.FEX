-INCLUDE SETECHO

SET ASNAMES = ON;

TABLE FILE S_AFFINN 
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AROLL_LEV2 EQ 'BUSINESS'
ON TABLE HOLD AS SHOLD
END
-RUN

MODIFY FILE S_AFFINN
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV2='AFFINNB';
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN


TABLE FILE D_AFFINN 
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AROLL_LEV2 EQ 'BUSINESS'
ON TABLE HOLD AS DHOLD
END
-RUN

MODIFY FILE D_AFFINN
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV2='AFFINNB';
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

TABLE FILE M_AFFINN 
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AROLL_LEV2 EQ 'BUSINESS'
ON TABLE HOLD AS MHOLD
END
-RUN

MODIFY FILE M_AFFINN
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV2='AFFINNB';
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN


TABLE FILE C_AFFINN 
PRINT CAR_KEY  
BY CAR_KEY NOPRINT
IF AROLL_LEV2 EQ 'BUSINESS'
ON TABLE HOLD AS CHOLD
END
-RUN

MODIFY FILE C_AFFINN
FIXFORM FROM CHOLD
MATCH CAR_KEY  
ON MATCH COMPUTE AROLL_LEV2='AFFINNB';
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN

TABLE FILE H_AFFINN 
PRINT HTL_KEY  
BY HTL_KEY NOPRINT
IF AROLL_LEV2 EQ 'BUSINESS'
ON TABLE HOLD AS HHOLD
END
-RUN

MODIFY FILE H_AFFINN
FIXFORM FROM HHOLD
MATCH HTL_KEY  
ON MATCH COMPUTE AROLL_LEV2='AFFINNB';
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


TABLE FILE L_AFFINN 
PRINT CAR_KEY  
BY CAR_KEY NOPRINT
IF AROLL_LEV2 EQ 'BUSINESS'
ON TABLE HOLD AS LHOLD
END
-RUN

MODIFY FILE L_AFFINN
FIXFORM FROM LHOLD
MATCH CAR_KEY  
ON MATCH COMPUTE AROLL_LEV2='AFFINNB';
ON MATCH UPDATE AROLL_LEV2
ON NOMATCH REJECT
DATA ON LHOLD
END
-RUN
