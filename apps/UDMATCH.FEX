-* Match for Udid reporting fields
-* Steve - Added CLA and CLS to Car routine - 06/16/2006
-* 8/23/06 - DEB - Added udid BPAY_AMT BUS_FAR PAY_AMT TIER


SET ASNAMES=ON

-IF &&REPTTYPE EQ 'AIR' THEN GOTO AIR;
-IF &&REPTTYPE EQ 'CAR' THEN GOTO CAR;
-IF &&REPTTYPE EQ 'HTL' THEN GOTO HTL;
-RUN

-AIR

-INCLUDE UDAUSE

TABLE FILE UDAIR
PRINT AUD_DATA AS 'COST_CODE'
BY AIR_KEY
WHERE UDID EQ 'RM1'
ON TABLE HOLD AS UDH1 
END
-RUN


TABLE FILE UDAIR
PRINT AUD_DATA AS 'PROJ_NBR'
BY AIR_KEY
WHERE UDID EQ '2'
ON TABLE HOLD AS UDH2
END
-RUN

TABLE FILE UDAIR
PRINT NUD_DATA/D12.2CS AS 'ADD_SAV'
BY AIR_KEY
WHERE UDID EQ 'ASV'
ON TABLE HOLD AS UDH3
END
-RUN

TABLE FILE UDAIR
PRINT NUD_DATA/D12.2CS AS 'POT_SAV'
BY AIR_KEY
WHERE UDID EQ 'PSV'
ON TABLE HOLD AS UDH4
END
-RUN

TABLE FILE UDAIR
PRINT NUD_DATA/D12.2CS AS 'SAV_AMT'
BY AIR_KEY
WHERE UDID EQ 'SAV'
ON TABLE HOLD AS UDH5
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'SVC_FEE'
BY AIR_KEY
WHERE UDID EQ '6'
ON TABLE HOLD AS UDH6
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'NON_ARCV'
BY AIR_KEY
WHERE UDID EQ '30'
ON TABLE HOLD AS UDH7
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'MISC_VNDR'
BY AIR_KEY
WHERE UDID EQ '50'
ON TABLE HOLD AS UDH8
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'BOOK_AGENT'
BY AIR_KEY
WHERE UDID EQ 'BKA'
ON TABLE HOLD AS UDH9
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'DEPT_36'
BY AIR_KEY
WHERE UDID EQ 'D36'
ON TABLE HOLD AS UDH10
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'IT_CODE'
BY AIR_KEY
WHERE UDID EQ '113'
ON TABLE HOLD AS UDH11
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'WPROJ_NBR'
BY AIR_KEY
WHERE UDID EQ 'PR#'
ON TABLE HOLD AS UDH12
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'FUND_SRC'
BY AIR_KEY
WHERE UDID EQ 'FSR'
ON TABLE HOLD AS UDH13
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'GUEST'
BY AIR_KEY
WHERE UDID EQ 'GST'
ON TABLE HOLD AS UDH14
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'TPROJ_NBR'
BY AIR_KEY
WHERE UDID EQ 'CCC'
ON TABLE HOLD AS UDH15
END
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA AS 'BPAY_AMT'
BY AIR_KEY
WHERE UDID EQ 'ISS'
ON TABLE HOLD AS UDH16
END
-RUN


TABLE FILE UDAIR
PRINT NUD_DATA/D12.2CS AS 'BUS_FAR'
BY AIR_KEY
WHERE UDID EQ 'IBF'
ON TABLE HOLD AS UDH17
END
-RUN



TABLE FILE UDAIR
PRINT NUD_DATA/D12.2CS AS 'PAY_AMT'
BY AIR_KEY
WHERE UDID EQ 'IPA'
ON TABLE HOLD AS UDH18
END
-RUN


TABLE FILE UDAIR
PRINT AUD_DATA AS 'TIER'
BY AIR_KEY
WHERE UDID EQ 'ITR'
ON TABLE HOLD AS UDH19
END
-RUN



MATCH FILE UDH1 
PRINT COST_CODE 
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH2
SUM PROJ_NBR
BY AIR_KEY
AFTER MATCH HOLD AS HOLD1 OLD-OR-NEW
END
-RUN


MATCH FILE HOLD1
PRINT COST_CODE PROJ_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH3
SUM ADD_SAV
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD-OR-NEW
END
-RUN

MATCH FILE HOLD2
PRINT COST_CODE PROJ_NBR ADD_SAV
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH4
SUM POT_SAV
BY AIR_KEY
AFTER MATCH HOLD AS HOLD3 OLD-OR-NEW
END
-RUN

MATCH FILE HOLD3
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH5
SUM SAV_AMT
BY AIR_KEY
AFTER MATCH HOLD AS HOLD4 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD4
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH6
SUM SVC_FEE
BY AIR_KEY
AFTER MATCH HOLD AS HOLD5 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD5
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH7
SUM NON_ARCV
BY AIR_KEY
AFTER MATCH HOLD AS HOLD6 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD6
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH8
SUM MISC_VNDR
BY AIR_KEY
AFTER MATCH HOLD AS HOLD7 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD7
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH9
SUM BOOK_AGENT
BY AIR_KEY
AFTER MATCH HOLD AS HOLD8 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD8
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH10
SUM DEPT_36
BY AIR_KEY
AFTER MATCH HOLD AS HOLD9 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD9
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT DEPT_36
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH11
SUM IT_CODE
BY AIR_KEY
AFTER MATCH HOLD AS HOLD10 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD10
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH12
SUM WPROJ_NBR
BY AIR_KEY
AFTER MATCH HOLD AS HOLD11 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD11
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH13
SUM FUND_SRC
BY AIR_KEY
AFTER MATCH HOLD AS HOLD12 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD12
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR 
FUND_SRC
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH14
SUM GUEST
BY AIR_KEY
AFTER MATCH HOLD AS HOLD13 OLD-OR-NEW
END
-RUN 


MATCH FILE HOLD13
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR 
FUND_SRC GUEST
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH15
SUM TPROJ_NBR
BY AIR_KEY
AFTER MATCH HOLD AS HOLD14 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD14
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR 
FUND_SRC GUEST TPROJ_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH16
SUM BPAY_AMT
BY AIR_KEY
AFTER MATCH HOLD AS HOLD15 OLD-OR-NEW
END
-RUN 


MATCH FILE HOLD15
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR 
FUND_SRC GUEST TPROJ_NBR BPAY_AMT
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH17
SUM BUS_FAR
BY AIR_KEY
AFTER MATCH HOLD AS HOLD16 OLD-OR-NEW
END
-RUN 




MATCH FILE HOLD16
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR 
FUND_SRC GUEST TPROJ_NBR BPAY_AMT BUS_FAR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH18
SUM PAY_AMT
BY AIR_KEY
AFTER MATCH HOLD AS HOLD17 OLD-OR-NEW
END
-RUN 

MATCH FILE HOLD17
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR 
FUND_SRC GUEST TPROJ_NBR BPAY_AMT BUS_FAR PAY_AMT
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH19
SUM TIER
BY AIR_KEY
AFTER MATCH HOLD AS HOLD18 OLD-OR-NEW
END
-RUN 




-* WWF FLY AMERICA WAIVER

TABLE FILE UDAIR
PRINT AUD_DATA AS 'FLY_AA'
BY AIR_KEY
WHERE UDID EQ 'FAA'
ON TABLE HOLD AS HWWF1
END
-RUN

TABLE FILE UDID_DSC
PRINT UD_DESC
BY UDID_ALPHA AS 'FLY_AA'
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
WHERE UDID_ID EQ 'FAA'
ON TABLE HOLD AS HWWF2
END
-RUN

MATCH FILE HWWF1
PRINT AIR_KEY
BY FLY_AA
ON TABLE HOLD
RUN
FILE HWWF2
SUM UD_DESC
BY FLY_AA
AFTER MATCH HOLD AS HWWF3 OLD
END
-RUN

TABLE FILE HWWF3
PRINT UD_DESC FLY_AA
BY AIR_KEY
ON TABLE HOLD AS HWWF4
END
-RUN


MATCH FILE HOLD18
PRINT COST_CODE PROJ_NBR ADD_SAV POT_SAV SAV_AMT SVC_FEE
NON_ARCV MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR 
FUND_SRC GUEST TPROJ_NBR BPAY_AMT BUS_FAR PAY_AMT TIER
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HWWF4
SUM UD_DESC FLY_AA
BY AIR_KEY
AFTER MATCH HOLD AS HOLD19 OLD-OR-NEW
END
-RUN 




-GOTO XXIT

-* Car Udids

-CAR

-INCLUDE UDCUSE

TABLE FILE UDCAR
PRINT AUD_DATA AS 'COST_CODE'
BY CAR_KEY
WHERE UDID EQ 'RM1'
ON TABLE HOLD AS UDCH1 
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'PROJ_NBR'
BY CAR_KEY
WHERE UDID EQ '2'
ON TABLE HOLD AS UDCH2
END
-RUN


TABLE FILE UDCAR
PRINT AUD_DATA AS 'NONCOM_CAR'
BY CAR_KEY
WHERE UDID EQ '8'
ON TABLE HOLD AS UDCH3
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'SVC_FEE'
BY CAR_KEY
WHERE UDID EQ '6'
ON TABLE HOLD AS UDCH4
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'NON_ARCV'
BY CAR_KEY
WHERE UDID EQ '30'
ON TABLE HOLD AS UDCH5
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'MISC_VNDR'
BY CAR_KEY
WHERE UDID EQ '50'
ON TABLE HOLD AS UDCH6
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'BOOK_AGENT'
BY CAR_KEY
WHERE UDID EQ 'BKA'
ON TABLE HOLD AS UDCH7
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'DEPT_36'
BY CAR_KEY
WHERE UDID EQ 'D36'
ON TABLE HOLD AS UDCH8
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'IT_CODE'
BY CAR_KEY
WHERE UDID EQ '113'
ON TABLE HOLD AS UDCH9
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'CAR_ONLY'
BY CAR_KEY
WHERE UDID EQ '28'
ON TABLE HOLD AS UDCH10
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'WPROJ_NBR'
BY CAR_KEY
WHERE UDID EQ 'PR#'
ON TABLE HOLD AS UDCH11
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'FUND_SRC'
BY CAR_KEY
WHERE UDID EQ 'FSR'
ON TABLE HOLD AS UDCH12
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'GUEST'
BY CAR_KEY
WHERE UDID EQ 'GST'
ON TABLE HOLD AS UDCH13
END
-RUN

TABLE FILE UDCAR
PRINT NUD_DATA AS 'CAR_LOW_AMT'
BY CAR_KEY
WHERE UDID EQ 'CLA'
ON TABLE HOLD AS UDCH14
END
-RUN

TABLE FILE UDCAR
PRINT NUD_DATA AS 'CAR_LOST_AMT'
BY CAR_KEY
WHERE UDID EQ 'CLS'
ON TABLE HOLD AS UDCH15
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'TRP_PRP'
BY CAR_KEY
WHERE UDID EQ 'TP-'
ON TABLE HOLD AS UDCH16
END
-RUN

TABLE FILE UDCAR
PRINT AUD_DATA AS 'ZIP'
BY CAR_KEY
WHERE UDID EQ 'ZIP'
ON TABLE HOLD AS UDCH17
END
-RUN

MATCH FILE UDCH1
PRINT COST_CODE
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH2
SUM PROJ_NBR
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD1 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD1
PRINT COST_CODE PROJ_NBR
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH3
SUM NONCOM_CAR
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD2 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD2
PRINT COST_CODE PROJ_NBR NONCOM_CAR
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH4
SUM SVC_FEE
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD3 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD3
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH5
SUM NON_ARCV
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD4 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD4
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH6
SUM MISC_VNDR
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD5 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD5
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH7
SUM BOOK_AGENT
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD6 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD6
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
      BOOK_AGENT
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH8
SUM DEPT_36
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD7 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD7
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
      BOOK_AGENT DEPT_36
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH9
SUM IT_CODE
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD8 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD8
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
      BOOK_AGENT DEPT_36 IT_CODE
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH10
SUM CAR_ONLY
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD9 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD9
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
      BOOK_AGENT DEPT_36 IT_CODE CAR_ONLY
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH11
SUM WPROJ_NBR
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD10 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD10
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
      BOOK_AGENT DEPT_36 IT_CODE CAR_ONLY WPROJ_NBR
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH12
SUM FUND_SRC
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD11 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD11
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
      BOOK_AGENT DEPT_36 IT_CODE CAR_ONLY WPROJ_NBR FUND_SRC
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH13
SUM GUEST
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD12 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD12
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
      BOOK_AGENT DEPT_36 IT_CODE CAR_ONLY WPROJ_NBR FUND_SRC
      GUEST
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH14
SUM CAR_LOW_AMT
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD13 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD13
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
      BOOK_AGENT DEPT_36 IT_CODE CAR_ONLY WPROJ_NBR FUND_SRC
      GUEST CAR_LOW_AMT
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH15
SUM CAR_LOST_AMT
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD14 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD14
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
      BOOK_AGENT DEPT_36 IT_CODE CAR_ONLY WPROJ_NBR FUND_SRC
      GUEST CAR_LOW_AMT CAR_LOST_AMT
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH16
SUM TRP_PRP
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD15 OLD-OR-NEW
END
-RUN

MATCH FILE CHOLD15
PRINT COST_CODE PROJ_NBR NONCOM_CAR SVC_FEE NON_ARCV MISC_VNDR
      BOOK_AGENT DEPT_36 IT_CODE CAR_ONLY WPROJ_NBR FUND_SRC
      GUEST CAR_LOW_AMT CAR_LOST_AMT
BY CAR_KEY
ON TABLE HOLD
RUN
FILE UDCH17
SUM ZIP
BY CAR_KEY
AFTER MATCH HOLD AS CHOLD15 OLD-OR-NEW
END
-RUN

-GOTO XXIT


-HTL

-INCLUDE UDHUSE

TABLE FILE UDHTL
PRINT AUD_DATA AS 'COST_CODE'
BY HTL_KEY
WHERE UDID EQ 'RM1'
ON TABLE HOLD AS UDHH1 
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'PROJ_NBR'
BY HTL_KEY
WHERE UDID EQ '2'
ON TABLE HOLD AS UDHH2 
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'NONCOM_HTL'
BY HTL_KEY
WHERE UDID EQ '8'
ON TABLE HOLD AS UDHH3 
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'SVC_FEE'
BY HTL_KEY
WHERE UDID EQ '6'
ON TABLE HOLD AS UDHH4
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'ADD_HTLI'
BY HTL_KEY
WHERE UDID EQ '12'
ON TABLE HOLD AS UDHH5
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'HTL_ONLY'
BY HTL_KEY
WHERE UDID EQ '28'
ON TABLE HOLD AS UDHH6
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'NON_ARCV'
BY HTL_KEY
WHERE UDID EQ '30'
ON TABLE HOLD AS UDHH7
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'MISC_VNDR'
BY HTL_KEY
WHERE UDID EQ '50'
ON TABLE HOLD AS UDHH8
END
-RUN


TABLE FILE UDHTL
PRINT AUD_DATA AS 'BOOK_AGENT'
BY HTL_KEY
WHERE UDID EQ 'BKA'
ON TABLE HOLD AS UDHH9
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'DEPT_36'
BY HTL_KEY
WHERE UDID EQ 'D36'
ON TABLE HOLD AS UDHH10
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'IT_CODE'
BY HTL_KEY
WHERE UDID EQ '113'
ON TABLE HOLD AS UDHH11
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'WPROJ_NBR'
BY HTL_KEY
WHERE UDID EQ 'PR#'
ON TABLE HOLD AS UDHH12
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'FUND_SRC'
BY HTL_KEY
WHERE UDID EQ 'FSR'
ON TABLE HOLD AS UDHH13
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'GUEST'
BY HTL_KEY
WHERE UDID EQ 'GST'
ON TABLE HOLD AS UDHH14
END
-RUN

TABLE FILE UDHTL
PRINT AUD_DATA AS 'TRP_PRP'
BY HTL_KEY
WHERE UDID EQ 'TP-'
ON TABLE HOLD AS UDHH15
END
-RUN

MATCH FILE UDHH1
PRINT COST_CODE
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH2
SUM PROJ_NBR
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD1 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD1
PRINT COST_CODE PROJ_NBR
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH3
SUM NONCOM_HTL
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD2 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD2
PRINT COST_CODE PROJ_NBR NONCOM_HTL
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH4
SUM SVC_FEE
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD3 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD3
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH5
SUM ADD_HTLI
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD4 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD4
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE ADD_HTLI
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH6
SUM HTL_ONLY
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD5 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD5
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE ADD_HTLI HTL_ONLY
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH7
SUM NON_ARCV
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD6 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD6
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE ADD_HTLI HTL_ONLY NON_ARCV
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH8
SUM MISC_VNDR
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD7 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD7
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE ADD_HTLI HTL_ONLY NON_ARCV
      MISC_VNDR
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH9
SUM BOOK_AGENT
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD8 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD8
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE ADD_HTLI HTL_ONLY NON_ARCV
      MISC_VNDR BOOK_AGENT
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH10
SUM DEPT_36
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD9 OLD-OR-NEW
END
-RUN


MATCH FILE HHOLD9
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE ADD_HTLI HTL_ONLY NON_ARCV
      MISC_VNDR BOOK_AGENT DEPT_36
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH11
SUM IT_CODE
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD10 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD10
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE ADD_HTLI HTL_ONLY NON_ARCV
      MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH12
SUM WPROJ_NBR
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD11 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD11
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE ADD_HTLI HTL_ONLY NON_ARCV
      MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH13
SUM FUND_SRC
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD12 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD12
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE ADD_HTLI HTL_ONLY NON_ARCV
      MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR FUND_SRC
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH14
SUM GUEST
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD13 OLD-OR-NEW
END
-RUN

MATCH FILE HHOLD13
PRINT COST_CODE PROJ_NBR NONCOM_HTL SVC_FEE ADD_HTLI HTL_ONLY NON_ARCV
      MISC_VNDR BOOK_AGENT DEPT_36 IT_CODE WPROJ_NBR FUND_SRC GUEST
BY HTL_KEY
ON TABLE HOLD
RUN
FILE UDHH15
SUM TRP_PRP
BY HTL_KEY
AFTER MATCH HOLD AS HHOLD14 OLD-OR-NEW
END
-RUN


-XXIT
