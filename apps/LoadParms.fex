-* -INCLUDE SETECHO
-* JOIN CLEAR *
-IF &&WRRUN EQ 'Y' GOTO JOIN_4;
JOIN INST_KEY IN BRPT_QUE TO ALL INST_KEY IN HRPTFLDS
-GOTO JOIN_DONE4
-JOIN_4
JOIN INST_KEY IN BRPT_QUE TO INST_KEY IN RPT_FLDS
-JOIN_DONE4
-RUN

TABLE FILE BRPT_QUE
PRINT RPT_INST.INST_KEY RPT_INST.USE_PARM SEG.COMMON1.INCL1
BY RPT_INST.INST_KEY NOPRINT

-IF &&WRRUN EQ 'Y' GOTO NO_WHERE1;
WHERE BRPT_QUE.RPT_QUE.INTIME EQ HRPTFLDS.RPT_INST.INTIME

-NO_WHERE1
ON TABLE HOLD AS HOLDRPT1 FORMAT FOCUS
END
-RUN

TABLE FILE BRPT_QUE
PRINT SEG.COMMON2.SEQ_NO
BY RPT_INST.INST_KEY 

-IF &&WRRUN EQ 'Y' GOTO NO_WHERE2;
WHERE BRPT_QUE.RPT_QUE.INTIME EQ HRPTFLDS.RPT_INST.INTIME

-NO_WHERE2
ON TABLE HOLD AS HOLDRPT2 FORMAT FOCUS
END
-RUN

TABLE FILE BRPT_QUE
PRINT SEG.AIR.ID
BY RPT_INST.INST_KEY 

-IF &&WRRUN EQ 'Y' GOTO NO_WHERE3;
WHERE BRPT_QUE.RPT_QUE.INTIME EQ HRPTFLDS.RPT_INST.INTIME

-NO_WHERE3
ON TABLE HOLD AS HOLDRPT3  FORMAT FOCUS
END
-RUN

TABLE FILE BRPT_QUE
PRINT SEG.AIRFLDS.SEQ_NO
BY RPT_INST.INST_KEY 
BY AIRFLDS.SEQ_NO NOPRINT

-IF &&WRRUN EQ 'Y' GOTO NO_WHERE4;
WHERE BRPT_QUE.RPT_QUE.INTIME EQ HRPTFLDS.RPT_INST.INTIME

-NO_WHERE4
ON TABLE HOLD AS HOLDRPT4  FORMAT FOCUS
END
-RUN

TABLE FILE BRPT_QUE
PRINT SEG.CAR.ID
BY RPT_INST.INST_KEY 

-IF &&WRRUN EQ 'Y' GOTO NO_WHERE5;
WHERE BRPT_QUE.RPT_QUE.INTIME EQ HRPTFLDS.RPT_INST.INTIME

-NO_WHERE5
ON TABLE HOLD AS HOLDRPT5  FORMAT FOCUS
END
-RUN

TABLE FILE BRPT_QUE
PRINT SEG.CARFLDS.SEQ_NO
BY RPT_INST.INST_KEY 
BY CARFLDS.SEQ_NO NOPRINT

-IF &&WRRUN EQ 'Y' GOTO NO_WHERE6;
WHERE BRPT_QUE.RPT_QUE.INTIME EQ HRPTFLDS.RPT_INST.INTIME

-NO_WHERE6
ON TABLE HOLD AS HOLDRPT6  FORMAT FOCUS
END
-RUN


TABLE FILE BRPT_QUE
PRINT SEG.HTL.ID
BY RPT_INST.INST_KEY 

-IF &&WRRUN EQ 'Y' GOTO NO_WHERE7;
WHERE BRPT_QUE.RPT_QUE.INTIME EQ HRPTFLDS.RPT_INST.INTIME

-NO_WHERE7
ON TABLE HOLD AS HOLDRPT7  FORMAT FOCUS
END
-RUN

TABLE FILE BRPT_QUE
PRINT SEG.HTLFLDS.SEQ_NO
BY RPT_INST.INST_KEY 
BY HTLFLDS.SEQ_NO NOPRINT

-IF &&WRRUN EQ 'Y' GOTO NO_WHERE8;
WHERE BRPT_QUE.RPT_QUE.INTIME EQ HRPTFLDS.RPT_INST.INTIME

-NO_WHERE8
ON TABLE HOLD AS HOLDRPT8  FORMAT FOCUS
END
-RUN

CREATE FILE BRPTFLDS
-RUN

MAINTAIN FILE BRPTFLDS AND HOLDRPT1 AND HOLDRPT2 AND HOLDRPT3
	AND HOLDRPT4 AND HOLDRPT5 AND HOLDRPT6 AND HOLDRPT7 AND HOLDRPT8

CASE TOP
	compute Cnt/I5=1;
  -*define stacks for BRPTFLDS
	infer BRptflds.INST_KEY BRptflds.COMMON1.INCL1  INTO BRfStk1;
	infer BRptflds.INST_KEY BRptflds.COMMON2.SEQ_NO INTO BRfStk2;
	infer BRptflds.INST_KEY BRptflds.AIR.ID         INTO BRfAirStk1;
	infer BRptflds.INST_KEY BRptflds.AIRFLDS.SEQ_NO INTO BRfAirStk2;
	infer BRptflds.INST_KEY BRptflds.CAR.ID         INTO BRfCarStk1;
	infer BRptflds.INST_KEY BRptflds.CARFLDS.SEQ_NO INTO BRfCarStk2;
	infer BRptflds.INST_KEY BRptflds.HTL.ID         INTO BRfHtlStk1;
	infer BRptflds.INST_KEY BRptflds.HTLFLDS.SEQ_NO INTO BRfHtlStk2;
	
	-*define stacks for HOLDRPT*
	infer HOLDRPT1.INST_KEY INTO HoldStk1;
	infer HOLDRPT2.INST_KEY INTO HoldStk2;
	infer HOLDRPT3.INST_KEY INTO HoldStk3;
	infer HOLDRPT4.INST_KEY INTO HoldStk4;
	infer HOLDRPT5.INST_KEY INTO HoldStk5;
	infer HOLDRPT6.INST_KEY INTO HoldStk6;
	infer HOLDRPT7.INST_KEY INTO HoldStk7;
	infer HOLDRPT8.INST_KEY INTO HoldStk8;
	
	-*move data from hold file into stacks
	FOR ALL NEXT HOLDRPT1.INST_KEY into HoldStk1;
	FOR ALL NEXT HOLDRPT2.INST_KEY into HoldStk2;
	FOR ALL NEXT HOLDRPT3.INST_KEY into HoldStk3;
	FOR ALL NEXT HOLDRPT4.INST_KEY into HoldStk4;
	FOR ALL NEXT HOLDRPT5.INST_KEY into HoldStk5;
	FOR ALL NEXT HOLDRPT6.INST_KEY into HoldStk6;
	FOR ALL NEXT HOLDRPT7.INST_KEY into HoldStk7;
	FOR ALL NEXT HOLDRPT8.INST_KEY into HoldStk8;
	
	compute Cnt = 1;
	REPEAT While Cnt LE HoldStk1.FocCount
		BRfStk1(Cnt).Inst_key = HoldStk1(Cnt).Inst_key;	
		BRfStk1(Cnt).USE_PARM = HoldStk1(Cnt).USE_PARM;	
		BRfStk1(Cnt).INCL1 = HoldStk1(Cnt).INCL1;	
		BRfStk1(Cnt).INCL2 = HoldStk1(Cnt).INCL2;	
		BRfStk1(Cnt).INCL3 = HoldStk1(Cnt).INCL3;	
	EndRepeat Cnt = Cnt + 1;
	
	compute Cnt = 1;
	REPEAT While Cnt LE HoldStk2.FocCount
		BRfStk2(Cnt).Inst_key = HoldStk2(Cnt).Inst_key;	
		BRfStk2(Cnt).SEQ_NO = HoldStk2(Cnt).SEQ_NO;	
		BRfStk2(Cnt).ID_LEVEL1 = HoldStk2(Cnt).ID_LEVEL1;	
		BRfStk2(Cnt).ID_LEVEL2 = HoldStk2(Cnt).ID_LEVEL2;	
		BRfStk2(Cnt).ID_LEVEL3 = HoldStk2(Cnt).ID_LEVEL3;	
	EndRepeat Cnt = Cnt + 1;
	
	compute Cnt = 1;
	REPEAT While Cnt LE HoldStk3.FocCount
		BRfAirStk1(Cnt).Inst_key = HoldStk3(Cnt).Inst_key;	
		BRfAirStk1(Cnt).ID = HoldStk3(Cnt).ID;	
		BRfAirStk1(Cnt).INCL1 = HoldStk3(Cnt).INCL1;	
		BRfAirStk1(Cnt).INCL2 = HoldStk3(Cnt).INCL2;	
		BRfAirStk1(Cnt).INCL3 = HoldStk3(Cnt).INCL3;	
		BRfAirStk1(Cnt).INCL4 = HoldStk3(Cnt).INCL4;	
		BRfAirStk1(Cnt).INCL5 = HoldStk3(Cnt).INCL5;	
		BRfAirStk1(Cnt).INCL6 = HoldStk3(Cnt).INCL6;	
		BRfAirStk1(Cnt).INCL7 = HoldStk3(Cnt).INCL7;	
		BRfAirStk1(Cnt).INCL8 = HoldStk3(Cnt).INCL8;	
		BRfAirStk1(Cnt).INCL9 = HoldStk3(Cnt).INCL9;	
		BRfAirStk1(Cnt).INTDOMT = HoldStk3(Cnt).INTDOMT;	
		BRfAirStk1(Cnt).INTDOMS = HoldStk3(Cnt).INTDOMS;	
		BRfAirStk1(Cnt).RANKBYTOP1 = HoldStk3(Cnt).RANKBYTOP1;	
		BRfAirStk1(Cnt).RANKMETHOD = HoldStk3(Cnt).RANKMETHOD;	
		BRfAirStk1(Cnt).CLASSCAT_A = HoldStk3(Cnt).CLASSCAT_A;	
		BRfAirStk1(Cnt).CLASSCAT_F = HoldStk3(Cnt).CLASSCAT_F;	
		BRfAirStk1(Cnt).CLASSCAT_B = HoldStk3(Cnt).CLASSCAT_B;	
		BRfAirStk1(Cnt).CLASSCAT_C = HoldStk3(Cnt).CLASSCAT_C;	
		BRfAirStk1(Cnt).CLASSCAT_D = HoldStk3(Cnt).CLASSCAT_D;	
		BRfAirStk1(Cnt).TRANS_TYPE_S = HoldStk3(Cnt).TRANS_TYPE_S;	
		BRfAirStk1(Cnt).TRANS_TYPE_E = HoldStk3(Cnt).TRANS_TYPE_E;	
		BRfAirStk1(Cnt).TRANS_TYPE_R = HoldStk3(Cnt).TRANS_TYPE_R;	
		BRfAirStk1(Cnt).TRANS_TYPE_V = HoldStk3(Cnt).TRANS_TYPE_V;	
		BRfAirStk1(Cnt).ADV_PUR_A = HoldStk3(Cnt).ADV_PUR_A;	
		BRfAirStk1(Cnt).ADV_PUR_0 = HoldStk3(Cnt).ADV_PUR_0;	
		BRfAirStk1(Cnt).ADV_PUR_7 = HoldStk3(Cnt).ADV_PUR_7;	
		BRfAirStk1(Cnt).ADV_PUR_14 = HoldStk3(Cnt).ADV_PUR_14;	
		BRfAirStk1(Cnt).ADV_PUR_21 = HoldStk3(Cnt).ADV_PUR_21;
		BRfAirStk1(Cnt).RANKBYTOP2 = HoldStk3(Cnt).RANKBYTOP2;	
	EndRepeat Cnt = Cnt + 1;
	
	compute Cnt = 1;
	REPEAT While Cnt LE HoldStk4.FocCount
		BRfAirStk2(Cnt).Inst_key = HoldStk4(Cnt).Inst_key;	
		BRfAirStk2(Cnt).SEQ_NO = HoldStk4(Cnt).SEQ_NO;	
		BRfAirStk2(Cnt).PASSENGER = HoldStk4(Cnt).PASSENGER;	
		BRfAirStk2(Cnt).TICKET_NO = HoldStk4(Cnt).TICKET_NO;	
		BRfAirStk2(Cnt).ORG_AIRPORT = HoldStk4(Cnt).ORG_AIRPORT;
		BRfAirStk2(Cnt).RTE_AIRPORT = HoldStk4(Cnt).RTE_AIRPORT;
		BRfAirStk2(Cnt).VAL_AIR = HoldStk4(Cnt).VAL_AIR;
		BRfAirStk2(Cnt).FLOWN_AIR = HoldStk4(Cnt).FLOWN_AIR;
		BRfAirStk2(Cnt).REFUSE_CODE = HoldStk4(Cnt).REFUSE_CODE;
		BRfAirStk2(Cnt).DEPT_CITY = HoldStk4(Cnt).DEPT_CITY;
		BRfAirStk2(Cnt).ARR_CITY = HoldStk4(Cnt).ARR_CITY;
	EndRepeat Cnt = Cnt + 1;
	
	compute Cnt = 1;
	REPEAT While Cnt LE HoldStk5.FocCount
		BRfCarStk1(Cnt).Inst_key = HoldStk5(Cnt).Inst_key;	
		BRfCarStk1(Cnt).ID = HoldStk5(Cnt).ID;	
		BRfCarStk1(Cnt).INCL1 = HoldStk5(Cnt).INCL1;	
		BRfCarStk1(Cnt).INCL2 = HoldStk5(Cnt).INCL2;	
		BRfCarStk1(Cnt).INCL3 = HoldStk5(Cnt).INCL3;	
		BRfCarStk1(Cnt).INCL4 = HoldStk5(Cnt).INCL4;	
		BRfCarStk1(Cnt).INCL5 = HoldStk5(Cnt).INCL5;	
		BRfCarStk1(Cnt).INCL6 = HoldStk5(Cnt).INCL6;	
		BRfCarStk1(Cnt).RANKBYTOP = HoldStk5(Cnt).RANKBYTOP;	
		BRfCarStk1(Cnt).RANKMETHOD = HoldStk5(Cnt).RANKMETHOD;	
		BRfCarStk1(Cnt).RATEALL = HoldStk5(Cnt).RATEALL;	
		BRfCarStk1(Cnt).RATE1 = HoldStk5(Cnt).RATE1;	
		BRfCarStk1(Cnt).RATE2 = HoldStk5(Cnt).RATE2;	
		BRfCarStk1(Cnt).RATE3 = HoldStk5(Cnt).RATE3;	
		BRfCarStk1(Cnt).RATE4 = HoldStk5(Cnt).RATE4;	
		BRfCarStk1(Cnt).RATE5 = HoldStk5(Cnt).RATE5;	
		BRfCarStk1(Cnt).RATE6 = HoldStk5(Cnt).RATE6;	
	EndRepeat Cnt = Cnt + 1;
	
	compute Cnt = 1;
	REPEAT While Cnt LE HoldStk6.FocCount
		BRfCarStk2(Cnt).Inst_key = HoldStk6(Cnt).Inst_key;	
		BRfCarStk2(Cnt).SEQ_NO = HoldStk6(Cnt).SEQ_NO;	
		BRfCarStk2(Cnt).PASSENGER = HoldStk6(Cnt).PASSENGER;	
		BRfCarStk2(Cnt).VENDOR_CODE = HoldStk6(Cnt).VENDOR_CODE;	
		BRfCarStk2(Cnt).REFUSE_CODE = HoldStk6(Cnt).REFUSE_CODE;
		BRfCarStk2(Cnt).PICKUP_CITY = HoldStk6(Cnt).PICKUP_CITY;
		BRfCarStk2(Cnt).DROPOFF_CITY = HoldStk6(Cnt).DROPOFF_CITY;
		BRfCarStk2(Cnt).CAR_TYPE = HoldStk6(Cnt).CAR_TYPE;		
	EndRepeat Cnt = Cnt + 1;
		
	compute Cnt = 1;
	REPEAT While Cnt LE HoldStk7.FocCount
		BRfHtlStk1(Cnt).Inst_key = HoldStk7(Cnt).Inst_key;	
		BRfHtlStk1(Cnt).ID = HoldStk7(Cnt).ID;	
		BRfHtlStk1(Cnt).INCL1 = HoldStk7(Cnt).INCL1;	
		BRfHtlStk1(Cnt).INCL2 = HoldStk7(Cnt).INCL2;	
		BRfHtlStk1(Cnt).INCL3 = HoldStk7(Cnt).INCL3;	
		BRfHtlStk1(Cnt).INCL4 = HoldStk7(Cnt).INCL4;	
		BRfHtlStk1(Cnt).RANKBYTOP1 = HoldStk7(Cnt).RANKBYTOP1;	
		BRfHtlStk1(Cnt).RANKMETHOD = HoldStk7(Cnt).RANKMETHOD;	
		BRfHtlStk1(Cnt).RANKBYTOP2 = HoldStk7(Cnt).RANKBYTOP2;	
	EndRepeat Cnt = Cnt + 1;

	compute Cnt = 1;
	REPEAT While Cnt LE HoldStk8.FocCount
		BRfHtlStk2(Cnt).Inst_key = HoldStk8(Cnt).Inst_key;	
		BRfHtlStk2(Cnt).SEQ_NO = HoldStk8(Cnt).SEQ_NO;	
		BRfHtlStk2(Cnt).PASSENGER = HoldStk8(Cnt).PASSENGER;	
		BRfHtlStk2(Cnt).CHAIN_CODE = HoldStk8(Cnt).CHAIN_CODE;	
		BRfHtlStk2(Cnt).REFUSE_CODE = HoldStk8(Cnt).REFUSE_CODE;
		BRfHtlStk2(Cnt).HTL_CITY = HoldStk8(Cnt).HTL_CITY;
	EndRepeat Cnt = Cnt + 1;

	STACK CLEAR HoldStk1;
	STACK CLEAR HoldStk2;
	STACK CLEAR HoldStk3;
	STACK CLEAR HoldStk4;
	STACK CLEAR HoldStk5;
	STACK CLEAR HoldStk6;
	STACK CLEAR HoldStk7;
	STACK CLEAR HoldStk8;	
	
	REPOSITION BRPTFLDS.INST_KEY;
	FOR ALL INCLUDE BRPTFLDS.RPT_INST.INST_KEY BRPTFLDS.COMMON1.INCL1 FROM BRfStk1;

	REPOSITION BRPTFLDS.INST_KEY;
	FOR ALL INCLUDE BRPTFLDS.RPT_INST.INST_KEY BRPTFLDS.COMMON2.SEQ_NO FROM BRfStk2;

	REPOSITION BRPTFLDS.INST_KEY;
	FOR ALL INCLUDE BRPTFLDS.RPT_INST.INST_KEY BRPTFLDS.AIR.ID FROM BRfAirStk1;

	REPOSITION BRPTFLDS.INST_KEY;
	FOR ALL INCLUDE BRPTFLDS.RPT_INST.INST_KEY BRPTFLDS.AIRFLDS.SEQ_NO FROM BRfAirStk2;

	REPOSITION BRPTFLDS.INST_KEY;
	FOR ALL INCLUDE BRPTFLDS.RPT_INST.INST_KEY BRPTFLDS.CAR.ID FROM BRfCarStk1;

	REPOSITION BRPTFLDS.INST_KEY;
	FOR ALL INCLUDE BRPTFLDS.RPT_INST.INST_KEY BRPTFLDS.CARFLDS.SEQ_NO FROM BRfCarStk2;

	REPOSITION BRPTFLDS.INST_KEY;
	FOR ALL INCLUDE BRPTFLDS.RPT_INST.INST_KEY BRPTFLDS.HTL.ID FROM BRfHtlStk1;

	REPOSITION BRPTFLDS.INST_KEY;
	FOR ALL INCLUDE BRPTFLDS.RPT_INST.INST_KEY BRPTFLDS.HTLFLDS.SEQ_NO FROM BRfHtlStk2;
	COMMIT;
	
EndCase

End	

-RUN