
FILEDEF METXHTL1 DISK D:\TNT\TTRACKER\SYSTEM\DATA\METXHTL1.TXT
FILEDEF HTLMKT1 DISK D:\TNT\TTRACKER\SYSTEM\DATA\HTLMKT1.TXT

SET ASNAMES=ON

-* -IF ROLLUP_CODE EQ 'METX-R' THEN GOTO METX ELSE GOTO KIEWPRINC;
-* -RUN

-IF ROLLUP_CODE EQ 'KIEWIT-R' GOTO KW;

-******* Comment in GOTO if loading Princ or Kiewit ****************

-METX

TABLE FILE METXHTL
PRINT ST_CITY H_MARKET
BY ROLLUP_CODE
BY ST_CITY
-* WHERE ROLLUP_CODE EQ 'METX-R'
WHERE ROLLUP_CODE EQ 'KIEWIT-R'
ON TABLE HOLD AS DELETEHLD
END
-RUN

MODIFY FILE METXHTL
FIXFORM FROM DELETEHLD
MATCH ROLLUP_CODE ST_CITY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON DELETEHLD
END

-KIEWPRINC

DEFINE FILE METXHTL1
STATE/A40=UPCASE(40, ST_CITY, STATE);
MKT/A130=UPCASE(130, H_MARKET, MKT);
END
TABLE FILE METXHTL1
PRINT MKT  AS 'H_MARKET'
BY ROLLUP_CODE
BY STATE AS 'ST_CITY'
ON TABLE HOLD
END
-RUN

MODIFY FILE METXHTL
FIXFORM FROM HOLD
MATCH ROLLUP_CODE ST_CITY
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON HOLD
END
-RUN

-GOTO XXIT;


-KW
TABLE FILE HTLMKT
PRINT STATE CITY H_MARKET
BY ROLLUP_CODE
BY STATE
BY CITY
WHERE ROLLUP_CODE EQ 'METX-R'
WHERE ROLLUP_CODE EQ 'KIEWIT-R'
ON TABLE HOLD AS DELETEHLD
END
-RUN

MODIFY FILE HTLMKT
FIXFORM FROM DELETEHLD
MATCH ROLLUP_CODE ST_CITY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON DELETEHLD
END


DEFINE FILE HTLMKT1
CITY1/A40=UPCASE(40, CITY, CITY1);
MKT/A130=UPCASE(130, H_MARKET, MKT);
END
TABLE FILE METXHTL1
PRINT MKT  AS 'H_MARKET'
BY ROLLUP_CODE
BY STATE 
BY CITY1 AS 'CITY'
ON TABLE HOLD
END
-RUN

MODIFY FILE HTLMKT
FIXFORM FROM HOLD
MATCH ROLLUP_CODE STATE CITY
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON HOLD
END
-RUN


-XXIT;






