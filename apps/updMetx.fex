-GOTO SCAN

-AIR

USE
F:\TNT\TTRACKER\DATA\A1METX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\A2METX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\A3METX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\A4METX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\A5METX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\A6METX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\A7METX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\A8METX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\A9METX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\A0METX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\AYMETX.FOC AS AIR_MAIN
F:\TNT\TTRACKER\DATA\AZMETX.FOC AS AIR_MAIN
END
-RUN

COMPUTE FILE AIR_MAIN
ROLLUP/A8 = 'METX-R';
END
-RUN

TABLE FILE AIR_MAIN
PRINT ROLLUP TKT_NUM TICKET_CODE TKT_DATE AR_BRANCH
CLIENT_NUM INVOICE_NUM DOC_NUMBER LEVEL1 LEVEL3
BY ROLLUP NOPRINT
BY TKT_NUM NOPRINT
BY TICKET_CODE NOPRINT
BY TKT_DATE NOPRINT
BY AR_BRANCH NOPRINT
BY CLIENT_NUM NOPRINT
BY INVOICE_NUM NOPRINT
BY DOC_NUMBER NOPRINT
ON TABLE SAVE AS METXTMPA
END
-RUN

-CAR

USE
F:\TNT\TTRACKER\DATA\C1METX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\C2METX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\C3METX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\C4METX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\C5METX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\C6METX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\C7METX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\C8METX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\C9METX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\C0METX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\CYMETX.FOC AS CAR_MAIN
F:\TNT\TTRACKER\DATA\CZMETX.FOC AS CAR_MAIN
END
-RUN

COMPUTE FILE CAR_MAIN
ROLLUP/A8 = 'METX-R';
END
-RUN

TABLE FILE CAR_MAIN
PRINT ROLLUP AR_BRANCH CLIENT_NUM PASSNGR_NAME CCR_CONFIRM
PNR_LOCATOR PICKUP_CITY RESV_STATUS LEVEL1 LEVEL3
BY ROLLUP NOPRINT
BY AR_BRANCH NOPRINT
BY CLIENT_NUM NOPRINT
BY PASSNGR_NAME NOPRINT
BY CCR_CONFIRM NOPRINT
BY PNR_LOCATOR NOPRINT
BY PICKUP_CITY NOPRINT
BY RESV_STATUS NOPRINT
ON TABLE SAVE AS METXTMPC
END
-RUN

-HOTEL

USE
F:\TNT\TTRACKER\DATA\H1METX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\H2METX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\H3METX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\H4METX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\H5METX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\H6METX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\H7METX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\H8METX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\H9METX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\H0METX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\HYMETX.FOC AS HTL_MAIN
F:\TNT\TTRACKER\DATA\HZMETX.FOC AS HTL_MAIN
END
-RUN

COMPUTE FILE HTL_MAIN
ROLLUP/A8 = 'METX-R';
END
-RUN

TABLE FILE HTL_MAIN
PRINT ROLLUP AR_BRANCH CLIENT_NUM PASSNGR_NAME HHL_CONFIRM
PNR_LOCATOR RESV_STATUS LEVEL1 LEVEL3
BY ROLLUP NOPRINT
BY AR_BRANCH NOPRINT
BY CLIENT_NUM NOPRINT
BY PASSNGR_NAME NOPRINT
BY HHL_CONFIRM NOPRINT
BY PNR_LOCATOR NOPRINT
BY RESV_STATUS NOPRINT
ON TABLE SAVE AS METXTMPH
END
-RUN
-EXIT

-WRNR

DEFINE FILE CR_50
FPNR/A1 = EDIT (PNR_LOCATOR, '$$$$$9');
END

TABLE FILE CR_50
ON TABLE SET PAGE-NUM OFF
PRINT CAR_KEY
WHERE ( PICK_CTY.CITY_NAME EQ ' ') AND (CAR_MAIN.INVOICE_DATE GE '20010101');
IF FPNR EQ ' ';
ON TABLE HOLD
END
-RUN

MODIFY FILE C_WRNR
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE CLWRNR
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE CHWRNR
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-KIMB

TABLE FILE H1KIMB
PRINT HTL_KEY
BY HTL_KEY NOPRINT
IF AR_BRANCH EQ 'RF'
ON TABLE HOLD
END
-RUN

MODIFY FILE HHKIMB
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE HLKIMB
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE H1KIMB
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT

-WRNR2

TABLE FILE C_WRNR
PRINT CAR_KEY
BY CAR_KEY
IF DROP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C_WRNR
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE DROP_CITY='FYV';
ON MATCH UPDATE DROP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT

-CH2M

SET ASNAMES=ON

DEFINE FILE I_SUMM
TEST/A7 = 'I AND E';
HSIFX/A65 = 'IF AROLL_LEV4 EQ '|''''||''''||TEST|''''||'''';
END
-RUN

TABLE FILE I_SUMM
PRINT INST_KEY HSIFX AS 'HSIF01'
IF INST_KEY EQ
'CH2M-R  CH2M  st20020404075030SPCAIRMasterCH2M  st20020404075030'
ON TABLE HOLD
END
-RUN

MODIFY FILE I_SUMM
FIXFORM FROM HOLD
MATCH INST_KEY
ON MATCH UPDATE HSIF01
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE I_SUMM
PRINT INST_KEY HSIF01
IF INST_KEY EQ
'CH2M-R  CH2M  st20020404075030SPCAIRMasterCH2M  st20020404075030'
END
-RUN

-EXIT


-SCAN

TABLE FILE ALNELR
PRINT AIR_KEY
BY AIR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE ALNELR
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE AROLL_DSC1='(NELR-R) NELSON REFRIGERATION  INC';
ON MATCH UPDATE AROLL_DSC1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE CLNELR
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE CLNELR
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_DSC1='(NELR-R) NELSON REFRIGERATION  INC';
ON MATCH UPDATE AROLL_DSC1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE HLNELR
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE HLNELR
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_DSC1='(NELR-R) NELSON REFRIGERATION  INC';
ON MATCH UPDATE AROLL_DSC1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-EXIT


-AGP

TABLE FILE SR_50
PRINT CITYPAIR.AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
WHERE (AROLL_LEV1 EQ ' ') OR (AROLL_DSC1 EQ ' ')
ON TABLE HOLD
END
-RUN

MODIFY FILE S_TALEN
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE M_TALEN
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE D_TALEN
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-EXIT

-FRER

TABLE FILE CR_50
PRINT CAR_KEY
BY CAR_KEY NOPRINT
IF AROLL_LEV1 EQ ' '
ON TABLE HOLD
END
-RUN

MODIFY FILE C_FRER
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE CLFRER
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT
