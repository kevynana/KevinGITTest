-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-* File HVIEW1SM.FEX
-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-*4/17/01      TANDT-SS             ADDED DOD_TYPE.
-*07/03/02   STEVE              CHANGED TO eTTek Review and Copyright
-*08/06/02   DEB                    CARRIED THROUGH RATE_GRP2
-*11/5/02    DB                     CARRIED THROUGH PROP_ZIP5
-*12/17/02   DB                     CARRIED THROUGH CITY_ST
-**********************************************************************


SET ASNAMES = ON
-RUN

TABLE FILE &&RPT_HOLD
SUM NBR_DAYS AS 'HNDAY'
    NEW_ROOM_RATE/D14.2 AS 'HRRATE'
    STD_RATE/D14.2 AS 'HSTD'
    NEW_TOTAL_AMT/D14.2 AS 'HTTL'
    BY LEVEL_DESC
    ON TABLE HOLD AS HOLDONE
END
-RUN

TABLE FILE &&RPT_HOLD
PRINT BOOKINGS
  BR_CL_IDX
  CHAIN_CODE	
  CHAIN_NAME
  CITY_ST
  CLIENT_NAME	
  CREDIT_CARD
  DOD_TYPE	
  HHL_CONFIRM	
  HOTEL_PHONE
  IBOOK	
  INV_DATE	
  INVOICE_DATE	
  LEVEL1
  LEVEL2
  LEVEL3
  MXREFUSE_CD	
  NBR_DAYS	
  NBR_ROOMS	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NNROOMS
  NUM_DAYS	
  OUT_DATE	
  PASSNGR_NAME	
  PROP_ADDRESS	
  PROP_CITY	
  PROP_NAME	
  PROP_STATE_CD
  PROP_ZIP5	
  RATE_GRP
  RATE_GRP2
  ROOM_RATE	
  ROOM_TYPE	
  RSNCDE
  RESV_BRANCH
  STD_RATE	
  TKT_NUM	
  TOTAL_AMT	
  TOTAL_SLSAV
  TOTAL_STD
  UP_STD
  XPSNGR_NM
BY LEVEL_DESC
BY REFUSE_CD
BY REFUSAL_DESC
ON TABLE HOLD AS XTWO
END
-RUN

MATCH FILE XTWO
PRINT  
  BOOKINGS
  BR_CL_IDX
  CHAIN_CODE	
  CHAIN_NAME
  CITY_ST
  CLIENT_NAME	
  CREDIT_CARD
  DOD_TYPE	
  HHL_CONFIRM	
  HOTEL_PHONE
  IBOOK	
  INV_DATE	
  INVOICE_DATE	
  LEVEL1
  LEVEL2
  LEVEL3
  MXREFUSE_CD	
  NBR_DAYS	
  NBR_ROOMS
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NNROOMS	
  NUM_DAYS	
  OUT_DATE	
  PASSNGR_NAME	
  PROP_ADDRESS	
  PROP_CITY	
  PROP_NAME	
  PROP_STATE_CD
  PROP_ZIP5	
  RATE_GRP
  RATE_GRP2
  ROOM_RATE	
  ROOM_TYPE	
  RSNCDE
  RESV_BRANCH
  STD_RATE	
  TKT_NUM	
  TOTAL_AMT	
  TOTAL_SLSAV
  TOTAL_STD
  UP_STD
  XPSNGR_NM	
BY LEVEL_DESC
BY REFUSE_CD
BY REFUSAL_DESC
ON TABLE HOLD
RUN
FILE HOLDONE
SUM HNDAY
    HRRATE
    HSTD
    HTTL
    BY LEVEL_DESC
AFTER MATCH HOLD AS XTHREE OLD-OR-NEW 
END
-RUN

DEFINE FILE XTHREE
   PCTHDAYS/D8.1S = IF ((HNDAY LT 1) AND (HNDAY GT (-1))) THEN 0
                    ELSE ((NNROOMS/HNDAY)*100);
   PCTHTAMT/D8.1S = IF ((HTTL LT 1) AND (HTTL GT (-1))) THEN 0
                    ELSE ((TOTAL_AMT/HTTL)*100);

-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-**********************************************************************
  NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
END

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

TABLE FILE XTHREE
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10

-INCLUDE FOOTERSM
ON TABLE COLUMN-TOTAL
-*ON TABLE SET STYLE &&SMSTY
-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *

-INCLUDE &&PASTYS

-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILL;
-INCLUDE &&DSTY

-SKIP_DRILL

ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN

-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3;

EX REPORT_3

-SKIP_R3
