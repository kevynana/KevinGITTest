
-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-********************************************************************
-* Modifications:
-* CREATED FOR DATA VAULT AIR DETAIL REPORT CREATED FROM AVIW74DT
-*7/11/16 -DLV -  S-20630   Added EMP_ID to extract
-********************************************************************
SET ASNAMES=ON
-RUN
-INCLUDE SETECHO

TABLE FILE &&RPT_HOLD
SUM DISSAVINGS AS 'DTSAVE' 
    FARE_PAID AS 'TFARE'
    MRK_TKT_CNT AS 'TMKT'
    NET_COMM AS 'NCOMM'
    NEW_SEG_AMT AS 'TBASE'
    SAVINGS AS 'TSAVE'
    SEG_COM AS 'TSCOM'
    SEG_LOWEST AS 'TLOW'
    SEG_STANDARD AS 'TSTD'
    SEG_DISCOUNT AS 'TDISC'
    NEW_SEG_MILES/D9CS AS 'TMILE'
    VASAVINGS AS 'TVSV'
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
ON TABLE HOLD AS AIRHOLD1
END
-RUN

TABLE FILE &&RPT_HOLD
PRINT ACCT
  AGENT_NUM
  AIR_KEY   
  AIRLINE   
  AIRLINE_NAME
  BR_CL_IDX
  CGBOOK
  C_ITIN
  CL_CAT    
  CLASS 
  CLASS_CAT
  DISSAVINGS
  DST_APC
  DV_NUM
  EMB_APT_CD
  EMB_APT_NM    
  EMB_CTY_NM
  EMB_CNTRY_CODE
  EMP_ID
  FARE_BAS
  FARE_PAID
  FLIGHT
  FREQ_FLYER
  FF_MILES
  INTL_DOM
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3   
  LEVEL4
  LEVEL5
  LEVEL6
  LEVEL7
  MRK_TKT_CNT
  NET_COMM
  NET_TKT_CNT
  NEW_ADV_PURCH
  NEW_SEG_AMT
  NEW_SEG_MILES
  ORG_APC
  PASSNGR_NAME 
  PNR_LOCATOR
  REFUSE_CODE
  REFUSAL_DESC
  RTE_APT_CD
  RTE_APT_NM    
  RTE_CTY_NM
  SAVINGS
  SEG_COUNT
  SEG_LOWEST
  SEG_MILES
  SEG_NBR
  SEG_STANDARD
  TKT_NUM   
  TKT_SORT
  TKT_TYPE
  TRAN_MONTH
  TRAN_MY 
  TRIP_PURPOSE
  TRN_DATE
  TRP_DESC
  VAL_AIRLINE
  XDPT_DT
  XFST_DPT
  XPSNGR_NM
  XTRAN_DT  
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
BY SEG_NBR
ON TABLE HOLD AS XTWO
END
-RUN


MATCH FILE XTWO
PRINT ACCT
  AGENT_NUM
  AIR_KEY   
  AIRLINE   
  AIRLINE_NAME
  BR_CL_IDX
  CGBOOK
  C_ITIN
  CL_CAT    
  CLASS 
  CLASS_CAT
  DISSAVINGS
  DST_APC
  DV_NUM
  EMB_APT_CD
  EMB_APT_NM    
  EMB_CTY_NM
  EMB_CNTRY_CODE
  EMP_ID
  FARE_BAS
  FARE_PAID
  FLIGHT
  FREQ_FLYER
  FF_MILES
  INTL_DOM
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3 
  LEVEL4   
  LEVEL5
  LEVEL6
  LEVEL7
  MRK_TKT_CNT
  NET_COMM
  NET_TKT_CNT
  NEW_ADV_PURCH
  NEW_SEG_AMT
  NEW_SEG_MILES
  ORG_APC
  PASSNGR_NAME
  PNR_LOCATOR
  REFUSE_CODE
  REFUSAL_DESC
  RTE_APT_CD
  RTE_APT_NM    
  RTE_CTY_NM
  SAVINGS
  SEG_COUNT
  SEG_LOWEST
  SEG_MILES
  SEG_NBR
  SEG_STANDARD
  TKT_NUM   
  TKT_SORT
  TKT_TYPE
  TRAN_MONTH
  TRAN_MY   
  TRIP_PURPOSE
  TRN_DATE
  TRP_DESC
  VAL_AIRLINE
  XDPT_DT
  XFST_DPT
  XPSNGR_NM
  XTRAN_DT  
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
BY SEG_NBR
ON TABLE HOLD
RUN
FILE AIRHOLD1
PRINT DTSAVE
      TBASE
      TDISC
      TFARE
      TLOW
      TMKT
      NCOMM
      TSCOM
      TMILE
      TSAVE
      TSTD
      TVSV
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
-*AFTER MATCH HOLD AS AIRHOLD2 OLD-OR-NEW
AFTER MATCH HOLD AS DVRCSDT OLD-OR-NEW
END
-RUN
 