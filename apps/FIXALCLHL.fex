-* File UPDAL.FEX

-***************************************************************************
-* This program will update the AL, CL and HL databases when there is a blank
-* AROLL_LEV1 or AROLL_DSC1 - based off of the TTPHIERA0 file.
-* DATE           NAME
-* 03/27/02       Steve Cords - Initial Creation
-***************************************************************************

-GOTO METXCOPY

-GOTO PRINC7

TABLE FILE AZMETX
PRINT AIR_KEY LEVEL3
BY AIR_KEY NOPRINT
IF LEVEL3 EQ 'NEWFNPCC' OR 'GENAMPCC' OR 'PARAPCC';
ON TABLE HOLD
END
-RUN

MODIFY FILE AZMETX
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3='PERSONALCC';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* CAR

TABLE FILE CZMETX
PRINT CAR_KEY LEVEL3
BY CAR_KEY NOPRINT
IF LEVEL3 EQ 'NEWFNPCC' OR 'GENAMPCC' OR 'PARAPCC';
ON TABLE HOLD
END
-RUN

MODIFY FILE CZMETX
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL3='PERSONALCC';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* HOTEL

TABLE FILE HZMETX
PRINT HTL_KEY LEVEL3
BY HTL_KEY NOPRINT
IF LEVEL3 EQ 'NEWFNPCC' OR 'GENAMPCC' OR 'PARAPCC';
ON TABLE HOLD
END
-RUN

MODIFY FILE HZMETX
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL3='PERSONALCC';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-UPDATEA
-*AIR

SET ASNAMES=ON

TABLE FILE ALMETX
PRINT AIR_KEY
BY AIR_KEY NOPRINT
ON TABLE HOLD AS ALHOLD
END
-RUN

USE
D:\TNT\TTRACKER\DATA\A1METX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A2METX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A3METX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A4METX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A5METX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A6METX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A7METX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A8METX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A9METX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A0METX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\AYMETX.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\AZMETX.FOC AS AIR_MAIN
END
-RUN

TABLE FILE AIR_MAIN
PRINT AIR_KEY LEVEL3
BY AIR_KEY NOPRINT
ON TABLE HOLD AS AIRHOLD
END
-RUN

MATCH FILE AIRHOLD
PRINT AIR_KEY LEVEL3
BY AIR_KEY NOPRINT
RUN
FILE ALHOLD
SUM AIR_KEY
BY AIR_KEY NOPRINT
AFTER MATCH HOLD OLD-NOT-NEW
END
-RUN

TABLE FILE HOLD
PRINT AIR_KEY LEVEL3 AS 'AROLL_LEV8'
BY LEVEL3 NOPRINT
ON TABLE HOLD AS HOLD2
END
-RUN

-*=======================================================================
-* DECLARE FILEDEFS FOR AS400 FILES USED FOR DATA EXTRACT
-*=======================================================================
FI TTPHIERA DISK D:\AS400\TTPHIERA.TXT

TABLE FILE TTPHIERA
PRINT *
BY AROLL_LEV8 NOPRINT
IF AROLL_LEV1 EQ 'METX-R'
ON TABLE HOLD AS TMPHOLDA
END
-RUN

MATCH FILE HOLD2
PRINT AIR_KEY
BY AROLL_LEV8 NOPRINT
RUN
FILE TMPHOLDA
SUM
AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2
AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4
AROLL_LEV5 AROLL_DSC5 AROLL_LEV6 AROLL_DSC6
AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8
AROLL_LEV9 AROLL_DSC9
BY AROLL_LEV8 NOPRINT
AFTER MATCH HOLD OLD
END
-RUN

TABLE FILE HOLD
PRINT *
BY AIR_KEY NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE ALMETX
FIXFORM FROM HOLD3
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD3
END
-RUN
-EXIT

-UPDATEC
-*CAR

SET ASNAMES=ON

TABLE FILE CLMETX
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD AS CLHOLD
END
-RUN

USE
D:\TNT\TTRACKER\DATA\C1METX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C2METX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C3METX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C4METX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C5METX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C6METX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C7METX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C8METX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C9METX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C0METX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\CYMETX.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\CZMETX.FOC AS CAR_MAIN
END
-RUN

TABLE FILE CAR_MAIN
PRINT CAR_KEY LEVEL3
BY CAR_KEY NOPRINT
ON TABLE HOLD AS CARHOLD
END
-RUN

MATCH FILE CARHOLD
PRINT CAR_KEY LEVEL3
BY CAR_KEY NOPRINT
RUN
FILE CLHOLD
SUM CAR_KEY
BY CAR_KEY NOPRINT
AFTER MATCH HOLD OLD-NOT-NEW
END
-RUN

TABLE FILE HOLD
PRINT CAR_KEY LEVEL3 AS 'AROLL_LEV8'
BY LEVEL3 NOPRINT
ON TABLE HOLD AS HOLD2
END
-RUN

-*=======================================================================
-* DECLARE FILEDEFS FOR AS400 FILES USED FOR DATA EXTRACT
-*=======================================================================
FI TTPHIERA DISK D:\AS400\TTPHIERA.TXT

TABLE FILE TTPHIERA
PRINT *
BY AROLL_LEV8 NOPRINT
IF AROLL_LEV1 EQ 'METX-R'
ON TABLE HOLD AS TMPHOLDA
END
-RUN

MATCH FILE HOLD2
PRINT CAR_KEY
BY AROLL_LEV8 NOPRINT
RUN
FILE TMPHOLDA
SUM
AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2
AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4
AROLL_LEV5 AROLL_DSC5 AROLL_LEV6 AROLL_DSC6
AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8
AROLL_LEV9 AROLL_DSC9
BY AROLL_LEV8 NOPRINT
AFTER MATCH HOLD OLD
END
-RUN

TABLE FILE HOLD
PRINT *
BY CAR_KEY NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE CLMETX
FIXFORM FROM HOLD3
MATCH CAR_KEY
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD3
END
-RUN
-EXIT


-UPDATEH
-*HOTEL

SET ASNAMES=ON

TABLE FILE HLMETX
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD AS HLHOLD
END
-RUN

USE
D:\TNT\TTRACKER\DATA\H1METX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H2METX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H3METX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H4METX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H5METX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H6METX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H7METX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H8METX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H9METX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H0METX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\HYMETX.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\HZMETX.FOC AS HTL_MAIN
END
-RUN

TABLE FILE HTL_MAIN
PRINT HTL_KEY LEVEL3
BY HTL_KEY NOPRINT
ON TABLE HOLD AS HTLHOLD
END
-RUN

MATCH FILE HTLHOLD
PRINT HTL_KEY LEVEL3
BY HTL_KEY NOPRINT
RUN
FILE HLHOLD
SUM HTL_KEY
BY HTL_KEY NOPRINT
AFTER MATCH HOLD OLD-NOT-NEW
END
-RUN

TABLE FILE HOLD
PRINT HTL_KEY LEVEL3 AS 'AROLL_LEV8'
BY LEVEL3 NOPRINT
ON TABLE HOLD AS HOLD2
END
-RUN

-*=======================================================================
-* DECLARE FILEDEFS FOR AS400 FILES USED FOR DATA EXTRACT
-*=======================================================================
FI TTPHIERA DISK D:\AS400\TTPHIERA.TXT

TABLE FILE TTPHIERA
PRINT *
BY AROLL_LEV8 NOPRINT
IF AROLL_LEV1 EQ 'METX-R'
ON TABLE HOLD AS TMPHOLDA
END
-RUN

MATCH FILE HOLD2
PRINT HTL_KEY
BY AROLL_LEV8 NOPRINT
RUN
FILE TMPHOLDA
SUM
AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2
AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4
AROLL_LEV5 AROLL_DSC5 AROLL_LEV6 AROLL_DSC6
AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8
AROLL_LEV9 AROLL_DSC9
BY AROLL_LEV8 NOPRINT
AFTER MATCH HOLD OLD
END
-RUN

TABLE FILE HOLD
PRINT *
BY HTL_KEY NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE HLMETX
FIXFORM FROM HOLD3
MATCH HTL_KEY
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD3
END
-RUN
-EXIT

-METX5

TABLE FILE RPT_INST
PRINT INST_KEY AND COMPUTE
RPT_FOOT1/A60='INCLUDES ONLY DOMESTIC SEGMENTS OVER $500 AND INTERNATIONAL ';
RPT_FOOT2/A60='SEGMENTS OVER $1000 - EXCLUDES CO AND IB INTL SEGMENTS      ';
IF ROLLUP EQ 'METX-R'
IF GLOBAL_PARM EQ 'MX1STCL'
-* IF RPT_FOOT2 EQ ' '
ON TABLE HOLD
END
-RUN

MODIFY FILE RPT_INST
FIXFORM FROM HOLD
MATCH INST_KEY
ON MATCH UPDATE RPT_FOOT1
ON MATCH UPDATE RPT_FOOT2
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT

-CONG5

TABLE FILE CR_50
PRINT CAR_KEY
BY CAR_KEY NOPRINT
WHERE (CAR_HIER.AROLL_LEV1 EQ ' ') OR (CAR_HIER.AROLL_DSC1 EQ ' ');
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE C1CONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE C2CONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE C3CONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE C4CONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE C5CONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE C6CONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE C7CONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE C8CONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE C9CONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE C0CONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE CYCONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE CZCONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE CLCONG
FIXFORM FROM HOLD1
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN
-EXIT

-CONG6

TABLE FILE HR_50
PRINT HTL_KEY
BY HTL_KEY NOPRINT
WHERE (HTL_HIER.AROLL_LEV1 EQ ' ') OR (HTL_HIER.AROLL_DSC1 EQ ' ');
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE H1CONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE H2CONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE H3CONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE H4CONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE H5CONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE H6CONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE H7CONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE H8CONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE H9CONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE H0CONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE HYCONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE HZCONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

MODIFY FILE HLCONG
FIXFORM FROM HOLD1
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN
-EXIT

-KIMB6

TABLE FILE C1KIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C1KIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C2KIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C2KIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C3KIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C3KIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C4KIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C4KIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C5KIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C5KIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C6KIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C6KIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C7KIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C7KIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C8KIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C8KIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C9KIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C9KIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C0KIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE C0KIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE CYKIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE CYKIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE CZKIMB
PRINT CAR_KEY
IF PICKUP_CITY EQ 'XNA'
ON TABLE HOLD
END
-RUN

MODIFY FILE CZKIMB
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE PICKUP_CITY='FYV';
ON MATCH UPDATE PICKUP_CITY
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT

-ISU6

TABLE FILE S_ISU
PRINT *
IF EMBARK EQ 'FP3'
ON TABLE HOLD
END
-RUN

MODIFY FILE S_ISU
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

SET ASNAMES=ON

DEFINE FILE HOLD
TKTFST/A10 = EDIT(TKT_SORT, '9999999999$');
TKT_SOR1/A11 = TKTFST||'C';
END
-RUN

TABLE FILE HOLD
PRINT  AIR_KEY EMBARK ROUTE TKT_SOR1 AS 'TKT_SORT' SEG_NBR TRN_DATE
DPT_DATE SEG_STANDARD SEG_DISCOUNT SEG_LOWEST SEG_REASON
SEG_CONTRACT SEG_COUNT DPT_TIME SEG_AMT SEG_TAX SEG_PCT
SEG_COM AIRLINE FLIGHT CLASS CL_CAT COUPON STOP_CON
ALN_AFFL FARE_BAS SEG_DESIG ARR_TIME ARR_DATE STAY
INTL_DOM PFC_CHG ND_ORG ND_DST ORG_DST SEG_MILES
RF_FLAG EX_FLAG HTL_DAYS CAR_DAYS
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE S_ISU
FIXFORM FROM HOLD2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON HOLD2
END
-RUN
-EXIT

-PRINC6

TABLE FILE S_PRINC
PRINT *
IF TKT_SORT EQ '7206990336J'
-* IF SEG_AMT EQ '-162.98'
IF SEG_TAX EQ '-13.03'
ON TABLE HOLD
END
-RUN

MODIFY FILE S_PRINC
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

SET ASNAMES=ON

DEFINE FILE HOLD
TKTFST/A10 = EDIT(TKT_SORT, '9999999999$');
TKT_SOR1/A11 = TKTFST||'M';
END
-RUN

TABLE FILE HOLD
PRINT  AIR_KEY EMBARK ROUTE TKT_SOR1 AS 'TKT_SORT' SEG_NBR TRN_DATE
DPT_DATE SEG_STANDARD SEG_DISCOUNT SEG_LOWEST SEG_REASON
SEG_CONTRACT SEG_COUNT DPT_TIME SEG_AMT SEG_TAX SEG_PCT
SEG_COM AIRLINE FLIGHT CLASS CL_CAT COUPON STOP_CON
ALN_AFFL FARE_BAS SEG_DESIG ARR_TIME ARR_DATE STAY
INTL_DOM PFC_CHG ND_ORG ND_DST ORG_DST SEG_MILES
RF_FLAG EX_FLAG HTL_DAYS CAR_DAYS
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE S_PRINC
FIXFORM FROM HOLD2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON HOLD2
END
-RUN
-EXIT

-PRINC7

TABLE FILE S_PRINC
PRINT *
IF EMBARK EQ 'FP3'
ON TABLE HOLD
END
-RUN

MODIFY FILE S_PRINC
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

SET ASNAMES=ON

DEFINE FILE HOLD
TKTFST/A10 = EDIT(TKT_SORT, '9999999999$');
TKT_SOR1/A11 = TKTFST||'C';
END
-RUN

TABLE FILE HOLD
PRINT  AIR_KEY EMBARK ROUTE TKT_SOR1 AS 'TKT_SORT' SEG_NBR TRN_DATE
DPT_DATE SEG_STANDARD SEG_DISCOUNT SEG_LOWEST SEG_REASON
SEG_CONTRACT SEG_COUNT DPT_TIME SEG_AMT SEG_TAX SEG_PCT
SEG_COM AIRLINE FLIGHT CLASS CL_CAT COUPON STOP_CON
ALN_AFFL FARE_BAS SEG_DESIG ARR_TIME ARR_DATE STAY
INTL_DOM PFC_CHG ND_ORG ND_DST ORG_DST SEG_MILES
RF_FLAG EX_FLAG HTL_DAYS CAR_DAYS
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE S_PRINC
FIXFORM FROM HOLD2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON HOLD2
END
-RUN
-EXIT

-FIXSEG

-* TABLE FILE SR_50
-* PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* BY AIR_KEY NOPRINT
-* BY EMBARK NOPRINT
-* BY ROUTE NOPRINT
-* BY TKT_SORT NOPRINT
-* BY SEG_NBR NOPRINT
-* WHERE (AIR_HIER.AROLL_LEV1 EQ ' ') OR (AIR_HIER.AROLL_DSC1 EQ ' ');
-* ON TABLE HOLD
-* END
-* -RUN

-* MODIFY FILE S_AMER
-* FIXFORM FROM HOLD
-* MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH DELETE
-* ON NOMATCH REJECT
-* DATA ON HOLD
-* END
-* -RUN

MODIFY FILE S_AURO
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE S_BAUM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE S_BMA
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE S_CARR
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE S_DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE S_DUNN
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE S_ISU
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE S_PAMECO
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE S_SCAN
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE S_WEB
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE S_ZUP
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT

-MUSA5

TABLE FILE RPT_INST
PRINT INST_KEY AND COMPUTE
RPT_FOOT2/A60='AVG Does not include Refunds or Exchanges                  ';
IF USE_PARM EQ 'AVIEW3'
IF RPT_FOOT2 EQ ' '
ON TABLE HOLD
END
-RUN

MODIFY FILE RPT_INST
FIXFORM FROM HOLD
MATCH INST_KEY
ON MATCH UPDATE RPT_FOOT2
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT

-METXCOPY

TABLE FILE RPT_INST
PRINT INST_KEY 
IF CA_OM1 EQ ' '
IF CATG1 EQ 'MEETING'
IF CASEL EQ 'E'
ON TABLE HOLD
END
-RUN

TABLE FILE HOLD
PRINT INST_KEY AND COMPUTE
CA_OM1/A65='IF CATEGORY NE MEETING';
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE RPT_INST
FIXFORM FROM HOLD2
MATCH INST_KEY
ON MATCH UPDATE CA_OM1
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN
-EXIT
