-* 4/26/05   - DEB  - CREATED TO SHOW COMBINED TOTAL INSTEAD OF
-*                    BREAK BY ROLLUP
-*  08/23/2016  REJ  S-17914 Changes for ER5.
-*  12/29/2016  REJ  S-28553 Move ER5 My Reports to production.

 
-INCLUDE SETECHO
 
CREATE FILE TCAVGT1
CREATE FILE TCATP2
-RUN
 
-INCLUDE TCGETROLL
-RUN
 
-SET &CNT = 1;
-REPEAT Loop2 &TOTROLLS TIMES
-SET &&ROLL = &ROLL.&CNT;
 
-TYPE TCAIRDB
-SET &&PAIRDB = 'S';
EX TCAIRDB
-RUN
- IF &FOCERRNUM EQ 36 THEN GOTO IncLoop2;
 
EX TCAVT1EX
-RUN
-IncLoop2
-SET &CNT = &CNT + 1;
-Loop2
 
-INCLUDE SetParmtime
-RUN
 
-IF &&FROMAVRP NE 'Y' GOTO :AVSF0;
-INCLUDE AVRP_SUBFOOT
-:AVSF0
 
-**************************************************************
-* GET THE FINAL REPORT
-**************************************************************
DEFINE FILE TCAVGT1
FLAG/A8 = 'AAAAAAAA';
END
 
 
TABLE FILE TCAVGT1
SUM
   CDAVOL
   PDAVOL
   CIAVOL
   PIAVOL
   CAVOL
   PAVOL
   CDGFARE
   PDGFARE
   CIGFARE
   PIGFARE
   CGFARE
   PGFARE
   CDNTKT
   PDNTKT
   CINTKT
   PINTKT
   CNTKT
   PNTKT
   CDTKTPUR
   PDTKTPUR
   CITKTPUR
   PITKTPUR
   CTKTPUR
   PTKTPUR
BY FLAG
ON TABLE HOLD AS HOLDONE
END
-RUN
 
 
 
 
 
 
 
 
 
 
TABLE FILE HOLDONE
SUM CAVOL
   PAVOL
   CDAVOL
   PDAVOL
   CIAVOL
   PIAVOL
   CDGFARE
   PDGFARE
   CIGFARE
   PIGFARE
   CGFARE
   PGFARE
   CDNTKT
   PDNTKT
   CINTKT
   PINTKT
   CNTKT
   PNTKT
   CDTKTPUR
   PDTKTPUR
   CITKTPUR
   PITKTPUR
   CTKTPUR
   PTKTPUR
COMPUTE CNAVGT/D15.2 = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0 ELSE
                           (CAVOL/CNTKT);
        PNAVGT/D15.2 = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE
                           (PAVOL/PNTKT);
        CDNAVGT/D15.2 = IF ((CDNTKT LT 1) AND (CDNTKT GT (-1))) THEN 0 ELSE
                           (CDAVOL/CDNTKT);
        PDNAVGT/D15.2 = IF ((PDNTKT LT 1) AND (PDNTKT GT (-1))) THEN 0 ELSE
                           (PDAVOL/PDNTKT);
        CINAVGT/D15.2 = IF ((CINTKT LT 1) AND (CINTKT GT (-1))) THEN 0 ELSE
                           (CIAVOL/CINTKT);
        PINAVGT/D15.2 = IF ((PINTKT LT 1) AND (PINTKT GT (-1))) THEN 0 ELSE
                           (PIAVOL/PINTKT);
        CGAVGT/D15.2C= IF ((CTKTPUR LT 1) AND (CTKTPUR GT (-1))) THEN 0 ELSE
                           (CGFARE/CTKTPUR);
        PGAVGT/D15.2 = IF ((PTKTPUR LT 1) AND (PTKTPUR GT (-1))) THEN 0 ELSE
                           (PGFARE/PTKTPUR);
        CDGAVGT/D15.2 = IF ((CDTKTPUR LT 1) AND (CDTKTPUR GT (-1))) THEN 0 ELSE
                           (CDGFARE/CDTKTPUR);
        PDGAVGT/D15.2 = IF ((PDTKTPUR LT 1) AND (PDTKTPUR GT (-1))) THEN 0 ELSE
                           (PDGFARE/PDTKTPUR);
        CIGAVGT/D15.2 = IF ((CITKTPUR LT 1) AND (CITKTPUR GT (-1))) THEN 0 ELSE
                           (CIGFARE/CITKTPUR);
        PIGAVGT/D15.2 = IF ((PITKTPUR LT 1) AND (PITKTPUR GT (-1))) THEN 0 ELSE
                           (PIGFARE/PITKTPUR);
 
 
BY FLAG
ON TABLE HOLD AS HOLDTWO
END
-RUN
 
 
DEFINE FILE HOLDTWO
DOC1/A30 = 'Domestic';
DOC2/A30 = 'International';
DOC3/A30 = 'Combined';
END
 
TABLE FILE HOLDTWO
SUM DOC1/A30
    DOC2/A30
    DOC3/A30
    CNAVGT/D15.2
    CDNAVGT/D15.2
    CINAVGT/D15.2C
    PNAVGT/D15.2
    PDNAVGT/D15.2
    PINAVGT/D15.2
BY FLAG
ON TABLE HOLD AS NETAVG
END
-RUN
 
DEFINE FILE NETAVG
CATEGORY/A30 = 'Net Average Ticket Cost';
CAT_ORDER/I2 = 1
END
-RUN
 
 
TABLE FILE NETAVG
PRINT FLAG/A8 AS 'ROLLCD' AND CATEGORY/A30 AND
DOC1/A30 AS 'ROW_LABEL' AND CAT_ORDER/I2 AND CDNAVGT/D15.2 AS 'CURRENT'
AND PDNAVGT/D15.2 AS 'PRIOR' AND
COMPUTE ROW_ORDER/I2 = 1;
ON TABLE HOLD AS NETAVG1
END
-RUN
 
TABLE FILE NETAVG1
PRINT ROLLCD AND CATEGORY AND ROW_LABEL AND
      CAT_ORDER AND ROW_ORDER AND
      CURRENT AND PRIOR
ON TABLE HOLD AS NETAVGD
END
MODIFY FILE TCATP2
FIXFORM FROM NETAVGD
MATCH ROLLCD CATEGORY ROW_LABEL
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NETAVGD
END
-RUN
 
TABLE FILE NETAVG
PRINT FLAG/A8 AS 'ROLLCD' AND CATEGORY/A30 AND
DOC2/A30 AS 'ROW_LABEL' AND CAT_ORDER/I2 AND CINAVGT/D15.2 AS 'CURRENT'
AND PINAVGT/D15.2 AS 'PRIOR' AND
COMPUTE ROW_ORDER/I2 = 2;
ON TABLE HOLD AS NETAVG2
END
-RUN
 
TABLE FILE NETAVG2
PRINT ROLLCD AND CATEGORY AND ROW_LABEL AND
      CAT_ORDER AND ROW_ORDER AND
      CURRENT AND PRIOR
ON TABLE HOLD AS NETAVGI
END
MODIFY FILE TCATP2
FIXFORM FROM NETAVGI
MATCH ROLLCD CATEGORY ROW_LABEL
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NETAVGI
END
-RUN
 
 
TABLE FILE NETAVG
PRINT FLAG/A8 AS 'ROLLCD' AND CATEGORY/A30 AND
DOC3/A30 AS 'ROW_LABEL' AND CAT_ORDER/I2 AND CNAVGT/D15.2 AS 'CURRENT'
AND PNAVGT/D15.2 AS 'PRIOR' AND
COMPUTE ROW_ORDER/I2 = 3;
ON TABLE HOLD AS NETAVG3
END
-RUN
 
TABLE FILE NETAVG3
PRINT ROLLCD AND CATEGORY AND ROW_LABEL AND
      CAT_ORDER AND ROW_ORDER AND
      CURRENT AND PRIOR
ON TABLE HOLD AS NETAVGT
END
MODIFY FILE TCATP2
FIXFORM FROM NETAVGT
MATCH ROLLCD CATEGORY ROW_LABEL
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NETAVGT
END
-RUN
 
TABLE FILE HOLDTWO
SUM DOC1/A30
    DOC2/A30
    DOC3/A30
    CGAVGT/D15.2
    CDGAVGT/D15.2
    CIGAVGT/D15.2C
    PGAVGT/D15.2
    PDGAVGT/D15.2
    PIGAVGT/D15.2
BY FLAG
ON TABLE HOLD AS GRSAVG
END
-RUN
 
 
DEFINE FILE GRSAVG
CATEGORY/A30 = 'Gross Average Ticket Cost';
CAT_ORDER/I2 = 2
END
-RUN
 
TABLE FILE GRSAVG
PRINT FLAG/A8 AS 'ROLLCD' AND CATEGORY/A30 AND
DOC1/A30 AS 'ROW_LABEL' AND CAT_ORDER/I2 AND CDGAVGT/D15.2 AS 'CURRENT'
AND PDGAVGT/D15.2 AS 'PRIOR' AND
COMPUTE ROW_ORDER/I2 = 4;
ON TABLE HOLD AS GRSAVG1
END
-RUN
 
TABLE FILE GRSAVG1
PRINT ROLLCD AND CATEGORY AND ROW_LABEL AND
      CAT_ORDER AND ROW_ORDER AND
      CURRENT AND PRIOR
ON TABLE HOLD AS GRSAVGD
END
MODIFY FILE TCATP2
FIXFORM FROM GRSAVGD
MATCH ROLLCD CATEGORY ROW_LABEL
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON GRSAVGD
END
-RUN
 
 
TABLE FILE GRSAVG
PRINT FLAG/A8 AS 'ROLLCD' AND CATEGORY/A30 AND
DOC2/A30 AS 'ROW_LABEL' AND CAT_ORDER/I2 AND CIGAVGT/D15.2 AS 'CURRENT'
AND PIGAVGT/D15.2 AS 'PRIOR' AND
COMPUTE ROW_ORDER/I2 = 5;
ON TABLE HOLD AS GRSAVG2
END
-RUN
 
TABLE FILE GRSAVG2
PRINT ROLLCD AND CATEGORY AND ROW_LABEL AND
      CAT_ORDER AND ROW_ORDER AND
      CURRENT AND PRIOR
ON TABLE HOLD AS GRSAVGI
END
MODIFY FILE TCATP2
FIXFORM FROM GRSAVGI
MATCH ROLLCD CATEGORY ROW_LABEL
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON GRSAVGI
END
-RUN
 
 
TABLE FILE GRSAVG
PRINT FLAG/A8 AS 'ROLLCD' AND CATEGORY/A30 AND
DOC3/A30 AS 'ROW_LABEL' AND CAT_ORDER/I2 AND CGAVGT/D15.2 AS 'CURRENT'
AND PGAVGT/D15.2 AS 'PRIOR' AND
COMPUTE ROW_ORDER/I2 = 6;
ON TABLE HOLD AS GRSAVG3
END
-RUN
 
TABLE FILE GRSAVG3
PRINT ROLLCD AND CATEGORY AND ROW_LABEL AND
      CAT_ORDER AND ROW_ORDER AND
      CURRENT AND PRIOR
ON TABLE HOLD AS GRSAVGT
END
MODIFY FILE TCATP2
FIXFORM FROM GRSAVGT
MATCH ROLLCD CATEGORY ROW_LABEL
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON GRSAVGT
END
-RUN
 
 
-SET &&RPTSUF = 'AVGTKT';
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');
 
 
-INCLUDE FDEFRPTS
-RUN
 
 
DEFINE FILE TCATP2
ROLLCDX/A14 = IF ROLLCD EQ 'AAAAAAAA' THEN 'COMBINED TOTAL' ELSE ' ';
NOWTOD/A8 WITH CAT_ORDER = HHMMSS (NOWTOD);
END
-RUN
 
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'TCHEADERDD' ELSE 'HDREXLSDD';
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
 
TABLE FILE TCATP2
PRINT TCATP2.ROW_LABEL AS ''
      TCATP2.CURRENT AS 'CURRENT'
      TCATP2.PRIOR AS 'PRIOR'
BY TCATP2.ROLLCDX AS 'ROLLUP'
BY TCATP2.CAT_ORDER NOPRINT
BY TCATP2.CATEGORY AS ' '
BY TCATP2.ROW_ORDER NOPRINT
ON TABLE NOTOTAL
ON TABLE SET PAGE-NUM OFF
 
HEADING
-INCLUDE &&PAHDR
 
FOOTING BOTTOM
"NOTE:"
" ** GROSS AVERAGE TICKET PRICE CALCULATION** "
" ** EXCLUDES BACKING OUT OF REFUNDS AND EXCHANGES** "
"&&FOOTER1"
"&&FOOTER2"
"<60 eTTek Review &DATE at <NOWTOD &&FOOTR"
 
ON TABLE SET PAGE-NUM OFF
ON TABLE NOTOTAL
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
 
ON TABLE SET STYLE *
-INCLUDE &&PASTYS
-GOTO JOY
 
-INCLUDE GLOBAL_LOGO_SM
 
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.300000, BOTTOMMARGIN=0.050000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT='ARIAL', SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $
-* TYPE=HEADING, OBJECT=TEXT, SIZE=8, COLOR=BLACK, $
-* TYPE=HEADING, LINE=4, SIZE=9, STYLE=BOLD, COLOR=GREY, $
-* TYPE=HEADING, LINE=5, SIZE=9, STYLE=BOLD, COLOR=GREY, $
-* TYPE=HEADING, LINE=6, SIZE=9, STYLE=BOLD, COLOR=GREY, $
-* TYPE=HEADING, LINE=7, SIZE=9, STYLE=BOLD, COLOR=GREY, $
-* TYPE=HEADING, LINE=8, SIZE=9, STYLE=BOLD, COLOR=GREY, $
-* TYPE=HEADING, LINE=10, SIZE=9, STYLE=BOLD, COLOR=GREY, $
-* TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
-* TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
 
TYPE=HEADING, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$
-* TYPE=HEADING, LINE=4,  SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
-* TYPE=HEADING, LINE=5, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=8, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=9, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=SUBHEAD, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$
 
TYPE=FOOTING, SIZE=7, FONT='ARIAL', COLOR=RGB(70 136 177), $
TYPE=TABFOOTING, SIZE=7, FONT='ARIAL', COLOR=RGB(70 136 177),$
 
TYPE=TITLE, STYLE=BOLD, $
-* TYPE=SUBFOOT, SIZE=8, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=8, STYLE=BOLD, $
 
TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0), $
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.2), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&TNTDTPOS), SIZE=(&&ROLDTSIZ), $
-JOY
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
-*
END
-RUN
 
 
 
 
-IF &LINES GT 0 THEN GOTO XXIT;
EX TCEMPTY
-RUN
-XXIT
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
