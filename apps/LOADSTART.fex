-* File LOADSTART.FEX

SET ASNAMES=ON

-SET &&CHKDATE = '        ';

DEFINE FILE ROLLUP
UPDATE_DATE/MDYY = '01/01/2001';
END
-RUN

-CHKLOOP

FILEDEF CHKDATE DISK D:\TNT\TTRACKER\LOADCHK\CHKDATE.TXT (LRECL 80
-RUN

FILEDEF NEWDATE DISK D:\TNT\TTRACKER\LOADCHK\NEWDATE.TXT (LRECL 80
-RUN

-READ CHKDATE &&CHKDATE
-IF &&CHKDATE EQ 'END' THEN GOTO XFER;
-TYPE CHKDATE &&CHKDATE

-REPEAT BNEW WHILE &IORETURN EQ 0;
-READ CHKDATE &&SLINE.80
-IF &IORETURN NE 0 THEN GOTO BNEW;
-WRITE NEWDATE &&SLINE
-BNEW

FILEDEF CHKDATE CLEAR
-RUN

FILEDEF NEWDATE CLEAR
-RUN

COPY D:\TNT\TTRACKER\LOADCHK\NEWDATE.TXT D:\TNT\TTRACKER\LOADCHK\CHKDATE.TXT
-RUN

-TYPE CHKDATE &&CHKDATE

-SET &&ROLLUP = SUBSTR(8, &&CHKDATE, 1, 8, 8, 'A8');

-TYPE ROLLUP &&ROLLUP

TABLE FILE ROLLUP
PRINT ROLLUP_CODE UPDATE_DATE AS 'START_DATE'
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
ON TABLE HOLD
END
-RUN

MODIFY FILE ROLLUP
FIXFORM FROM HOLD
MATCH ROLLUP_CODE
ON MATCH UPDATE START_DATE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-GOTO CHKLOOP

-XFER
-TYPE PROGRAM COMPLETED SUCCESSFULLY.....
-EXIT

TABLE FILE ROLLUP
PRINT ROLLUP_CODE START_DATE
IF ROLLUP_CODE EQ 'GRAMA-R' OR 'HAR-R' OR 'HARRIS-R' OR 'HDRR-R' OR 'HILL-R'
OR 'HLTH-R' OR 'HSCOMP-R' OR 'ISCO-R' OR 'ISU-R' OR 'KCLG-R' OR 'KOHLS-R'
OR 'LAKE-R' OR 'LEO-R' OR 'MANRO-R' OR 'MDC-R' OR 'MESTEK-R' OR 'METER-R'
OR 'MODI-R' OR 'MURRAY-R' OR 'MUSA-R' OR 'MUTM-R' OR 'NAVA-R' OR 'NISOUR-R'
OR 'OMFM-R' OR 'ORSG-R' OR 'PAXT-R' OR 'PAYG-R' OR 'RUAN-R' OR 'MOLX-R'
ON TABLE HOLD
END

MODIFY FILE ROLLUP
FIXFORM FROM HOLD
MATCH ROLLUP_CODE
ON MATCH COMPUTE START_DATE='07012000';
ON MATCH UPDATE START_DATE
ON NOMATCH REJECT
DATA ON HOLD
END














