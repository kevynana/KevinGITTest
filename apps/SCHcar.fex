-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-*2/5/14 Updated the bookings define to use num_days instead of daily_rate - JK

-INCLUDE SETECHO
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN
-SET &CARDATES = &&WEB_PATH || 'CARDATES.fex';
DEFINE FILE &&EXTRACT

BOOKINGS/D8 = IF NUM_DAYS GT 0 THEN 1 ELSE IF NUM_DAYS LT 0 THEN (-1) ELSE 0;
  LEVEL_DESC/A60 = &&LDESC;
  INV_DATE/MDYY = INVOICE_DATE;
-*  INV_MONTH/MT = INVOICE_DATE;
  INV_MONTH/MT = IF '&&DATETYPE.EVAL' EQ 'I' THEN INVOICE_DATE ELSE PICKUP_DATE;
  INVY/A3 = 'YTD';	
  NBR_DAYS/D12 = NUM_DAYS;
  PICK_UP_DT/MDYY = PICKUP_DATE;	
  RENTAL_DAYS/D8 = IF (NUM_DAYS LT 0) AND (NUM_CARS LT 0) THEN
                   ((NUM_DAYS * NUM_CARS) * (-1)) ELSE NUM_DAYS * NUM_CARS;
 
END
-RUN

TABLEF FILE &&EXTRACT
PRINT 
  BOOKINGS
  INV_MONTH
  INVY
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
-INCLUDE &CARDATES 
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10

-INCLUDE RPTPARMS
ON TABLE HOLD AS SCHCHOLD
END
-RUN

DEFINE FILE SCHCHOLD
CLABEL1/A25='CAR BOOKINGS';
CLABEL2/A25='CAR DAYS';
CLABEL3/A25='CAR COST';
CLABEL4/A25='AVERAGE CAR DAYS';
CLABEL5/A25='AVERAGE CAR RATE';
END
-RUN 

TABLE FILE SCHCHOLD
SUM 
  BOOKINGS
  CLABEL1
  CLABEL2
  CLABEL3
  CLABEL4
  CLABEL5
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
BY INV_MONTH
BY INVY
ON TABLE HOLD AS CHLD1
END
-RUN

-JAN
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'JAN'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO FEB;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JANCBOOK
END
-RUN

TABLE FILE JANCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JANCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JANCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JANCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JANDAYS
END
-RUN

TABLE FILE JANDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JANDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JANDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JANDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JANCAMT
END
-RUN

TABLE FILE JANCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JANCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JANCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JANCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JANAVGD
END
-RUN

TABLE FILE JANAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JANAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JANAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JANAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JANACAMT
END
-RUN

TABLE FILE JANACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JANACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JANACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JANACAMT1
END
-RUN

    


-FEB
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'FEB'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO MAR;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS FEBCBOOK
END
-RUN

TABLE FILE FEBCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS FEBDAYS
END
-RUN

TABLE FILE FEBDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS FEBCAMT
END
-RUN

TABLE FILE FEBCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS FEBAVGD
END
-RUN

TABLE FILE FEBAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS FEBACAMT
END
-RUN

TABLE FILE FEBACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBACAMT1
END
-RUN



-MAR
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'MAR'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO APR;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS MARCBOOK
END
-RUN

TABLE FILE MARCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS MARDAYS
END
-RUN

TABLE FILE MARDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS MARCAMT
END
-RUN

TABLE FILE MARCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS MARAVGD
END
-RUN

TABLE FILE MARAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS MARACAMT
END
-RUN

TABLE FILE MARACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARACAMT1
END
-RUN



-APR
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'APR'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO MAY;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS APRCBOOK
END
-RUN

TABLE FILE APRCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS APRDAYS
END
-RUN

TABLE FILE APRDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS APRCAMT
END
-RUN

TABLE FILE APRCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS APRAVGD
END
-RUN

TABLE FILE APRAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS APRACAMT
END
-RUN

TABLE FILE APRACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRACAMT1
END
-RUN



-MAY
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'MAY'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO JUN;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS MAYCBOOK
END
-RUN

TABLE FILE MAYCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS MAYDAYS
END
-RUN

TABLE FILE MAYDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS MAYCAMT
END
-RUN

TABLE FILE MAYCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS MAYAVGD
END
-RUN

TABLE FILE MAYAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS MAYACAMT
END
-RUN

TABLE FILE MAYACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYACAMT1
END
-RUN



-JUN
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'JUN'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO JUL;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JUNCBOOK
END
-RUN

TABLE FILE JUNCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JUNDAYS
END
-RUN

TABLE FILE JUNDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JUNCAMT
END
-RUN

TABLE FILE JUNCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JUNAVGD
END
-RUN

TABLE FILE JUNAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JUNACAMT
END
-RUN

TABLE FILE JUNACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNACAMT1
END
-RUN



-JUL
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'JUL'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO AUG;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JULCBOOK
END
-RUN

TABLE FILE JULCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JULDAYS
END
-RUN

TABLE FILE JULDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JULCAMT
END
-RUN

TABLE FILE JULCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JULAVGD
END
-RUN

TABLE FILE JULAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JULACAMT
END
-RUN

TABLE FILE JULACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULACAMT1
END
-RUN



-AUG
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'AUG'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO SEP;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS AUGCBOOK
END
-RUN

TABLE FILE AUGCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS AUGDAYS
END
-RUN

TABLE FILE AUGDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS AUGCAMT
END
-RUN

TABLE FILE AUGCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS AUGAVGD
END
-RUN

TABLE FILE AUGAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS AUGACAMT
END
-RUN

TABLE FILE AUGACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGACAMT1
END
-RUN



-SEP
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'SEP'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO OCT;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS SEPCBOOK
END
-RUN

TABLE FILE SEPCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS SEPDAYS
END
-RUN

TABLE FILE SEPDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS SEPCAMT
END
-RUN

TABLE FILE SEPCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS SEPAVGD
END
-RUN

TABLE FILE SEPAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS SEPACAMT
END
-RUN

TABLE FILE SEPACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPACAMT1
END
-RUN



-OCT
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'OCT'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO NOV;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS OCTCBOOK
END
-RUN

TABLE FILE OCTCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS OCTDAYS
END
-RUN

TABLE FILE OCTDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS OCTCAMT
END
-RUN

TABLE FILE OCTCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS OCTAVGD
END
-RUN

TABLE FILE OCTAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS OCTACAMT
END
-RUN

TABLE FILE OCTACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTACAMT1
END
-RUN



-NOV
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'NOV'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO DEC;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS NOVCBOOK
END
-RUN

TABLE FILE NOVCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS NOVDAYS
END
-RUN

TABLE FILE NOVDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS NOVCAMT
END
-RUN

TABLE FILE NOVCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS NOVAVGD
END
-RUN

TABLE FILE NOVAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS NOVACAMT
END
-RUN

TABLE FILE NOVACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVACAMT1
END
-RUN



-DEC
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INV_MONTH EQ 'DEC'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO YTD;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS DECCBOOK
END
-RUN

TABLE FILE DECCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS DECDAYS
END
-RUN

TABLE FILE DECDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS DECCAMT
END
-RUN

TABLE FILE DECCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS DECAVGD
END
-RUN

TABLE FILE DECAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS DECACAMT
END
-RUN

TABLE FILE DECACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECACAMT1
END
-RUN



-YTD
TABLE FILE CHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  PICK_UP_DT
  RENTAL_DAYS
  RENTAL_AMT
COMPUTE AVDAYS/D12= IF (RENTAL_DAYS LT 0) AND (BOOKINGS LT 0) THEN 
                        ((RENTAL_DAYS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (RENTAL_DAYS/BOOKINGS); 
COMPUTE AVCAMT/D12 = IF ((RENTAL_DAYS LT 1) AND (RENTAL_DAYS GT (-1))) THEN 0 ELSE
                        (RENTAL_AMT/RENTAL_DAYS);
BY CLABEL1
BY CLABEL2
BY CLABEL3
BY CLABEL4
BY CLABEL5
WHERE INVY EQ 'YTD'
ON TABLE HOLD AS CHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO XXIT;
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS YTDCBOOK
END
-RUN

TABLE FILE YTDCBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDCBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDCBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDCBOOK1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_DAYS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS YTDDAYS
END
-RUN

TABLE FILE YTDDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDDAYS1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND RENTAL_AMT/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS YTDCAMT
END
-RUN

TABLE FILE YTDCAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDCAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDCAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDCAMT1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVDAYS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS YTDAVGD
END
-RUN

TABLE FILE YTDAVGD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDAVGD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDAVGD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDAVGD1
END
-RUN

DEFINE FILE CHLD2
CATEGORY/A8 = 'CARS';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE CHLD2
PRINT CATEGORY/A8 AND CLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVCAMT/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS YTDACAMT
END
-RUN

TABLE FILE YTDACAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDACAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDACAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDACAMT1
END
-RUN


-XXIT




