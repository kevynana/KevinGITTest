-INCLUDE SETECHO
SET ASNAMES = ON

DEFINE FILE S_SUNOCO
XL01/A15 = 'PSC';
XL02/A15 = 'CEO';
END
TABLE FILE S_SUNOCO
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL01 AS 'AROLL_LEV4' XL02 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT 
BY SEG_NBR NOPRINT
IF AROLL_LEV4 EQ 'CEO'
ON TABLE HOLD AS SHOLD
END
-RUN

MODIFY FILE S_SUNOCO
 LOG NOMATCH MSG OFF
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN



DEFINE FILE D_SUNOCO
XL01/A15 = 'PSC';
XL02/A15 = 'CEO';
END
TABLE FILE D_SUNOCO
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL01 AS 'AROLL_LEV4' XL02 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT 
BY SEG_NBR NOPRINT
IF AROLL_LEV4 EQ 'CEO'
ON TABLE HOLD AS DHOLD
END
-RUN

MODIFY FILE D_SUNOCO
 LOG NOMATCH MSG OFF
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN


DEFINE FILE M_SUNOCO
XL01/A15 = 'PSC';
XL02/A15 = 'CEO';
END
TABLE FILE M_SUNOCO
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL01 AS 'AROLL_LEV4' XL02 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT 
BY SEG_NBR NOPRINT
IF AROLL_LEV4 EQ 'CEO'
ON TABLE HOLD AS MHOLD
END
-RUN

MODIFY FILE M_SUNOCO
 LOG NOMATCH MSG OFF
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN


DEFINE FILE C_SUNOCO
XL01/A15 = 'PSC';
XL02/A15 = 'CEO';
END
TABLE FILE C_SUNOCO
PRINT CAR_KEY XL01 AS 'AROLL_LEV4' XL02 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
IF AROLL_LEV4 EQ 'CEO'
ON TABLE HOLD AS CHOLD
END
-RUN

MODIFY FILE C_SUNOCO
 LOG NOMATCH MSG OFF
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN

DEFINE FILE H_SUNOCO
XL01/A15 = 'PSC';
XL02/A15 = 'CEO';
END
TABLE FILE H_SUNOCO
PRINT HTL_KEY XL01 AS 'AROLL_LEV4' XL02 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
IF AROLL_LEV4 EQ 'CEO'
ON TABLE HOLD AS HHOLD
END
-RUN

MODIFY FILE H_SUNOCO
LOG NOMATCH MSG OFF
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE L_SUNOCO
XL01/A15 = 'PSC';
XL02/A15 = 'CEO';
END
TABLE FILE L_SUNOCO
PRINT CAR_KEY XL01 AS 'AROLL_LEV4' XL02 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
IF AROLL_LEV4 EQ 'CEO'
ON TABLE HOLD AS LHOLD
END
-RUN

MODIFY FILE L_SUNOCO
 LOG NOMATCH MSG OFF
FIXFORM FROM LHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON LHOLD
END
-RUN