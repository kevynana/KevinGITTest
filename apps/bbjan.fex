-* 02/24/2017 - DLV - S-22486 CHANGED ettek Review to Post-trip Reporting
-* 08/18/17 - CA - S-38044 Place the footer datetime stamp text in a separate file to be -INCLUDED in the stylesheets
-*
-INCLUDE SETECHO

-SET ASNAMES = ON;
-*-IF '&&JANNOREC.EVAL' EQ 'Y' THEN GOTO NoJanREC;

-SET &&RPTSUF = 'BBCMCH';

-SET &FMM=EDIT(&&FROMDT,'$$$$$99'); 
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'9999');
-SET &TOM=EDIT(&&TODT,'$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'9999');
-* YTD DATES 
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');




-SET &CURMY = 'JAN' || '&FMY.EVAL';
-SET &PRMY  = 'JAN' || '&TXOY.EVAL';
-SET &CURMY1 = '&CURMY.EVAL' |',' | 'CUMULATIVE'; 
-SET &PRMY1 = '&PRMY.EVAL' |',' | 'CUMULATIVE'; 

 
-RUN


DEFINE FILE BBCM
NOWTOD/A8 WITH CAT_ORDER = HHMMSS (NOWTOD);
KEY/A1 = IF BBCM.CATEGORY EQ 'AIR' THEN 'A' ELSE
         IF BBCM.CATEGORY EQ 'HTL' THEN 'B' ELSE
         IF BBCM.CATEGORY EQ 'CAR' THEN 'C' ELSE 'D';
KEY2/A9 = IF BBCM.CATEGORY EQ 'AIR' THEN 'AIR' ELSE
          IF BBCM.CATEGORY EQ 'HTL' THEN 'HOTEL' ELSE
          IF BBCM.CATEGORY EQ 'CAR' THEN 'CAR' ELSE 'TOTAL';
          
               
END
TABLE FILE BBCM
HEADING
" "
"<10 &&RPT_TTL1"
"<10 &&RPT_TTL2"
" "

" <34 PERIOD1: <40 &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
" <34 PERIOD2: <40 &FXMM/&FXMD/&FXMY - &TXOM/&TXOD/&TXOY"
" "
 
PRINT BBCM.ROW_LABEL AS '  '
      BBCM.CURMO     AS '&CURMY.EVAL'
      BBCM.PRMO      AS '&PRMY.EVAL'
      BBCM.CURYR     AS '&CURMY1.EVAL' 
      BBCM.PRYR      AS '&PRMY1.EVAL' 
      BBCM.DIFF      AS 'DIFFERENCE'
      BBCM.IDPERCENT AS '% INC./,DECREASE'
BY KEY NOPRINT  
BY BBCM.CATEGORY AS ' '
 
BY BBCM.CAT_ORDER NOPRINT
BY BBCM.ROW_ORDER NOPRINT
ON BBCM.CATEGORY SKIP-LINE
WHERE BBCM.TRANM EQ 'JAN'


&&OUTLINE1
&&OUTLINE2
-*
-INCLUDE FOOTERDT
-*
ON TABLE SET PAGE-NUM OFF
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE NOTOTAL
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=1.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=1.000000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT,FONT=TIMES NEW ROMAN, SIZE=8, COLOR=BLACK, 
    BACKCOLOR=NONE, GRID=ON, STYLE=NORMAL, $
TYPE=TITLE, FONT=TIMES NEW ROMAN, SIZE=9, BACKCOLOR=RGB(128 255 255), $
TYPE=HEADING, FONT=TIMES NEW ROMAN, SIZE=9, LINE=5, BACKCOLOR=RGB(128 255 255), $

TYPE=HEADING, FONT=TIMES NEW ROMAN, SIZE=9, LINE=6, BACKCOLOR=RGB(128 255 255), $

TYPE=FOOTING, SIZE=7, $
TYPE=TITLE, SIZE=9, STYLE=BOLD+UNDERLINE, $
TYPE=HEADING, SIZE=10, STYLE=BOLD, FONT=TIMES NEW ROMAN,$
-*TYPE=REPORT, WRAP= 1,$
-*TYPE=DATA, BACKCOLOR=RED, STYLE=BOLD, COLUMN=N10, WHEN=BBCM.DIFF LT 0, $ 
-*TYPE=DATA, BACKCOLOR=RED, STYLE=BOLD, COLUMN=N11, WHEN=BBCM.IDPERCENT LT 0, $ 
TYPE=DATA, COLUMN=N2, BACKCOLOR=RGB(128 255 255),$

TYPE=REPORT, IMAGE=&&TNTPIC, POSITION=(&&TNTTRPOS), SIZE=(&&TNTTRSIZ), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLTRPOS), SIZE=(&&ROLTRSIZ), $
TYPE=SUBTOTAL, SIZE=9, STYLE=BOLD, COLOR=BLACK, BACKCOLOR=RGB(128 255 255),$

TYPE=GRANDTOTAL, SIZE=9, STYLE=BOLD, COLOR=BLACK, BACKCOLOR=RGB(128 255 255),$
TYPE=REPORT, TITLETEXT='JAN',$

ENDSTYLE
END

-*&&OUTLINE1
-*&&OUTLINE2
-*
END 
-RUN

-*-IF &FOCERRNUM EQ 205  OR &LINES EQ 0 THEN GOTO NoJanREC;
-GOTO XXITJAN2

-NoJanREC
-SET &TITLETEXT = 'JAN';
-INCLUDE BBNoRecord
-XXITJAN2

 