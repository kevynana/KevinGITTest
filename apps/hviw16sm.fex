-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS** 

-INCLUDE SETECHO
-* File HVIW16SM.FEX
-********************************************************************** 
-*DATE           NAME               DESCRIPTION
-*11/22/04       DEB                CREATED FROM HVIEW3 FOR GLOBAL CURRENCY 
-*                                  REPORTING OF GCTOPHTL
-*12/27/11       GSE                Removed parens from around CLIMIT in
-*                                  DEFINEs for 7.7.03
-*03/13/17 - DLV - S-22486 - updated ettek Review to Post-trip Reporting
-*08/15/17- JEM - S-24416 - Added logic for new report GCTPHTLBK - produces seperate tabs per hierarchy selected 
-*09/05/17 - JEM - S-38948 - Updating &&OUT3 to use XLSX when run to the screen to correct issue within chrome that is doesn't know what program to use
-*09/19/17 - DLV -S-39512 - Updated total page to break out city/hotel name totals GCTPHTLB
-*                          Commented out SET of &&RANK_LIMIT and &&RANK_LIMIT2 due to this being
-*                          done with additional report selections
-**********************************************************************
 
SET ASNAMES=ON

-IF '&&SETF.EVAL' EQ 'GCTPHTLB' GOTO GCTPHTLBK;

-SET &&CTY_LMT = &&RANK_LIMIT;
-SET &&HTL_LMT = &&RANK_LIMIT2;
-SET &&RANK_METH = IF &&RANK_METH EQ 'ROOM_AMT' THEN 'ROOM_AMT'
- ELSE IF &&RANK_METH EQ 'NMBR_DAYS' THEN 'NMBR_DAYS' 
- ELSE 'NMBR_DAYS';

-IF &&CURRENCY EQ 'USD' THEN GOTO NEXT;


-SET &&SUBHEAD = <NAMEC;
-SET &TAMT_CUR = 'TOTAL,ROOM,AMOUNT, (' | &&CURRENCY || ')';
-SET &CAVG_CUR = 'AVG,DAILY,RATE, (' | &&CURRENCY || ')';
-SET &CSAV_CUR = 'SAVINGS, (' | &&CURRENCY || ')';
-SET &&S_SUBJ3='GROOM_AMT/D16.2CS AS ' | '''&TAMT_CUR.EVAL''' ;
-SET &&S_SUBJ4='COMPUTE AVGAMT/D12.2=IF (GROOM_AMT LT 0)';
-SET &&S_SUBJ5='AND (NMBR_DAYS LT 0) THEN ((GROOM_AMT/NMBR_DAYS)*(-1)) ELSE';
-SET &&S_SUBJ6='IF ((NMBR_DAYS LT 1) AND (NMBR_DAYS GT (-1))) THEN 0 ELSE';
-SET &&S_SUBJ7='GROOM_AMT/NMBR_DAYS; AS ' | '''&CAVG_CUR.EVAL''';
-SET &&S_SUBJ13='TTL_SLSAVX/D16.2 AS ' | '''&CSAV_CUR.EVAL''';

-NEXT;

TABLE FILE HTLHLD3
SUM BOOKINGS
    NAMEC	
    NEW_ROOM_RATE
    NEW_STD_RATE
    NEW_TOTAL_AMT
    NNROOMS	
    NNROOMS/D8 AS 'NMBR_DAYS'	
    REFUSE_CD	
    RESV_BRANCH	
    SAVINGS	
    TOTAL_AMT/D12.2 AS 'ROOM_AMT'	
    TOTAL_STD
    TOTAL_SLSAV
    TTL_SLSAVX/D16.2CS 
    AMT_TOTALX/D16.2 AS 'GROOM_AMT'
    NEW_AMT_TTLX/D16.2	
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY CHAIN_NAME
BY PROP_NAME
BY PROP_ZIP5
BY PROP_ADDRESS
BY HOTEL_PHONE
BY CHAIN_CODE
ON TABLE HOLD AS HOLD1
END
-RUN


TABLE FILE HOLD1
PRINT 
  BOOKINGS	
  CHAIN_CODE	
  CHAIN_NAME
  GROOM_AMT/D16.2	
  HOTEL_PHONE
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  PROP_ADDRESS	
  PROP_NAME	
  PROP_ZIP5	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT/D12.2	
  SAVINGS
  TOTAL_STD	
  TOTAL_SLSAV
  TTL_SLSAVX/D16.2
  NEW_AMT_TTLX/D16.2 
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
-* RANKED BY HIGHEST NMBR_DAYS NOPRINT
RANKED BY HIGHEST &&RANK_METH NOPRINT
ON TABLE HOLD AS HOLD2
END
-RUN





DEFINE FILE HOLD2
 RANK_LIMIT/I5 = &&HTL_LMT;
 DRANK/D5      = RANK;
 ARANKX/A6 = FTOA(DRANK, '(D5)', 'A6');
 ARANK/A5=EDIT(ARANKX,'$99999');
 RANK_VALUE/A5 = IF (RANK_LIMIT EQ 0) THEN (ARANK) ELSE
                IF RANK GT RANK_LIMIT THEN 'OTHER' ELSE ARANK;
END
-RUN

TABLE FILE HOLD2
PRINT 
  BOOKINGS	
  CHAIN_CODE	
  CHAIN_NAME
  GROOM_AMT	
  HOTEL_PHONE
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT	
  NMBR_DAYS	
  NNROOMS	
  PROP_ADDRESS	
  PROP_NAME	
  PROP_ZIP5	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
ON TABLE HOLD AS HOLD3
END
-RUN

DEFINE FILE HOLD3
  CHAIN_CD/A2= IF RANK_VALUE LE '&&HTL_LMT' THEN CHAIN_CODE ELSE ' ';	
  CHAIN_NM/A35= IF RANK_VALUE LE '&&HTL_LMT' THEN CHAIN_NAME ELSE ' ';	
  HTL_ADDRESS/A35= IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_ADDRESS ELSE ' ';	
  HTL_NAME/A35 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_NAME ELSE 'ALL OTHER';
-************************IBI KR 
-*PROP_PHONE/A14= IF RANK_VALUE LE '&&HTL_LMT' THEN HOTEL_PHONE ELSE ' ';	
  PROP_PHONE/A15= IF RANK_VALUE LE '&&HTL_LMT' THEN HOTEL_PHONE ELSE ' ';	
  ZIP5/A5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_ZIP5 ELSE ' ';	
END
-RUN

TABLE FILE HOLD3
SUM 
  BOOKINGS
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
ON TABLE HOLD AS HOLD4
END
-RUN

TABLE FILE HOLD1
SUM 
  BOOKINGS
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
ON TABLE HOLD AS RHOLD1
END
-RUN

TABLE FILE RHOLD1
PRINT *
-* RANKED BY HIGHEST NMBR_DAYS AS 'DAYS_RANK'
RANKED BY HIGHEST &&RANK_METH AS 'DAYS_RANK'
ON TABLE HOLD AS RHOLD2
END
-RUN

MATCH FILE HOLD4
PRINT *
BY CITY_ST
ON TABLE HOLD
RUN
FILE RHOLD2
SUM DAYS_RANK
BY CITY_ST
AFTER MATCH HOLD AS HOLD5 OLD-OR-NEW
END
-RUN

TABLE FILE HOLD5
PRINT *
RANKED BY HIGHEST DAYS_RANK
ON TABLE HOLD AS HOLD6
END
-RUN

DEFINE FILE HOLD6
  CTY_LIMIT/I2 = &&CTY_LMT;
  CLIMIT/A2    = EDIT(CTY_LIMIT) ;
  CRANK/D5     = RANK;    
  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
  LIST/D6 = IF CITY_ST NE LAST CITY_ST THEN (LAST LIST + 1) ELSE LAST LIST;
  FRANKX/A7 = FTOA(LIST, '(D6)', 'A7');
  FRANK/A6=EDIT(FRANKX,'$999999');
  CTY_VALUE/A9 = IF CTY_LIMIT EQ 0 THEN BRANK ELSE
                 IF RANK GT CTY_LIMIT THEN 'ALL OTHER' ELSE BRANK;
END
-RUN

TABLE FILE HOLD6
PRINT 
  BOOKINGS	
  CLIMIT	
  CTY_LIMIT	
  DAYS_RANK
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY CTY_VALUE
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY CHAIN_CD
BY CHAIN_NM
BY RANK_VALUE
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
ON TABLE HOLD AS HOLD7
END
-RUN



TABLE FILE HTLHLD3
SUM NNROOMS/D8 AS 'CTLDAYS'
    NEW_TOTAL_AMT AS 'CTLAMT'
    NEW_AMT_TTLX/D16.2 AS 'GCTLAMT'
BY CITY_ST
ON TABLE HOLD AS HOLD8
END
-RUN

MATCH FILE HOLD7
PRINT 
  BOOKINGS	
  CLIMIT	
  CTY_LIMIT	
  DAYS_RANK
  GROOM_AMT
  NAMEC 	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  CTY_VALUE
  PROP_CITY
  PROP_STATE_CD
  CHAIN_CD
  CHAIN_NM
  RANK_VALUE
  HTL_NAME
  ZIP5
  HTL_ADDRESS
  PROP_PHONE
  NEW_AMT_TTLX
  TTL_SLSAVX
BY CITY_ST
ON TABLE HOLD
RUN
FILE HOLD8
SUM CTLDAYS
    CTLAMT
    GCTLAMT
BY CITY_ST
AFTER MATCH HOLD AS HOLD9 OLD-OR-NEW
END
-RUN



TABLE FILE HOLD9
PRINT
   BOOKINGS
   CTLAMT
   CTLDAYS
   CLIMIT
   CTY_LIMIT
   DAYS_RANK
   GCTLAMT
   GROOM_AMT
   NAMEC
   NEW_ROOM_RATE
   NEW_STD_RATE
   NEW_TOTAL_AMT
   NMBR_DAYS
   NNROOMS
   REFUSE_CD
   RESV_BRANCH
   ROOM_AMT
   SAVINGS
   TOTAL_STD
   TOTAL_SLSAV
   TTL_SLSAVX
   NEW_AMT_TTLX
COMPUTE PCTTAMT/D8.1S = IF ((CTLAMT LT 1) AND (CTLAMT GT (-1))) THEN 0
                        ELSE ((NEW_TOTAL_AMT/CTLAMT)*100);
       PGCTTAMT/D8.1S = IF ((GCTLAMT LT 1) AND (GCTLAMT GT (-1))) THEN 0
                        ELSE ((NEW_AMT_TTLX/GCTLAMT)*100);

BY CTY_VALUE
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
ON TABLE HOLD AS HOLD10
END
-RUN




DEFINE FILE HOLD10
  HTL_NAM1/A20 = SUBSTR(35, HTL_NAME, 1, 20, 20, HTL_NAM1);
  ADDRESS/A35 = IF CTY_VALUE LT CLIMIT THEN HTL_ADDRESS ELSE ' ';	
  CHAIN_NAME/A35 = IF CTY_VALUE LT CLIMIT THEN CHAIN_NM ELSE ' ';	
  CHAIN_PRNT/A2 = IF CTY_VALUE LT CLIMIT THEN CHAIN_CD ELSE ' ';	
  CITY_PRNT/A35 = IF CTY_VALUE LT CLIMIT THEN PROP_CITY ELSE ' ';	
  CTY_PRINT/A35 = IF CTY_VALUE LT CLIMIT THEN CITY_ST ELSE ' ';	
-************************IBI KR  
-*HTL_PHONE/A14 = IF CTY_VALUE LT CLIMIT THEN PROP_PHONE ELSE ' ';	
  HTL_PHONE/A15 = IF CTY_VALUE LT CLIMIT THEN PROP_PHONE ELSE ' ';	
  HTL_PRINT/A35 = IF CTY_VALUE LT CLIMIT THEN HTL_NAME ELSE ' ';
  HTL_PRINT1/A20 = IF CTY_VALUE LT CLIMIT THEN HTL_NAM1 ELSE ' ';	
  HTL_RANK/A5 = IF CTY_VALUE LT CLIMIT THEN RANK_VALUE ELSE ' ';	
  STATE_PRNT/A35 = IF CTY_VALUE LT CLIMIT THEN PROP_STATE_CD ELSE ' ';	
  ZIP_PRINT/A5 = IF CTY_VALUE LT CLIMIT THEN ZIP5 ELSE ' ';	


-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-**********************************************************************
  NOWTOD/A8 WITH CTY_VALUE = HHMMSS (NOWTOD);	
END

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

TABLE FILE HOLD10
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
-*
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    &&S_SUBJ11
    &&S_SUBJ12
    &&S_SUBJ13
    &&S_SUBJ14
    &&S_SUBJ15
    &&S_SUBJ16
    &&S_SUBJ17
    &&S_SUBJ18
    &&S_SUBJ19
    &&S_SUBJ20
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10


-*


-INCLUDE FOOTERSM



-*
-*ON TABLE SET STYLE &&SMSTY
-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *

-IF &&CURRENCY EQ 'TRL' THEN GOTO SMALLER;
-INCLUDE &&PASTYS
-GOTO FINFONT;
-SMALLER
-INCLUDE SM7
-FINFONT


-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILL;
-INCLUDE &&DSTY

-SKIP_DRILL

ENDSTYLE
-*
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN
-*

-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3;

EX REPORT_3

-SKIP_R3

-GOTO XXIT;
 


-GCTPHTLBK;

-*-SET &&RANK_LIMIT = 999;
-*-SET &&RANK_LIMIT2 = 50;


-SET &&CTY_LMT = &&RANK_LIMIT;
-SET &&HTL_LMT = &&RANK_LIMIT2;

-SET &&RANK_METH = IF &&RANK_METH EQ 'ROOM_AMT' THEN 'ROOM_AMT'
- ELSE IF &&RANK_METH EQ 'NMBR_DAYS' THEN 'NMBR_DAYS' 
- ELSE 'NMBR_DAYS';

-IF &&CURRENCY EQ 'USD' THEN GOTO NEXTBK;


-SET &&SUBHEAD = <NAMEC;
-SET &TAMT_CUR = 'TOTAL,ROOM,AMOUNT, (' | &&CURRENCY || ')';
-SET &CAVG_CUR = 'AVG,DAILY,RATE, (' | &&CURRENCY || ')';
-SET &CSAV_CUR = 'SAVINGS, (' | &&CURRENCY || ')';
-SET &&S_SUBJ3='GROOM_AMT/D16.2CS AS ' | '''&TAMT_CUR.EVAL''' ;
-SET &&S_SUBJ4='COMPUTE AVGAMT/D12.2=IF (GROOM_AMT LT 0)';
-SET &&S_SUBJ5='AND (NMBR_DAYS LT 0) THEN ((GROOM_AMT/NMBR_DAYS)*(-1)) ELSE';
-SET &&S_SUBJ6='IF ((NMBR_DAYS LT 1) AND (NMBR_DAYS GT (-1))) THEN 0 ELSE';
-SET &&S_SUBJ7='GROOM_AMT/NMBR_DAYS; AS ' | '''&CAVG_CUR.EVAL''';
-SET &&S_SUBJ13='TTL_SLSAVX/D16.2 AS ' | '''&CSAV_CUR.EVAL''';

-NEXTBK;

 
TABLE FILE HTLHLD3
SUM BOOKINGS
    NAMEC	
    NEW_ROOM_RATE
    NEW_STD_RATE
    NEW_TOTAL_AMT
    NNROOMS	
    NNROOMS/D8 AS 'NMBR_DAYS'	
    REFUSE_CD	
    RESV_BRANCH	
    SAVINGS	
    TOTAL_AMT/D12.2 AS 'ROOM_AMT'	
    TOTAL_STD
    TOTAL_SLSAV
    TTL_SLSAVX/D16.2CS 
    AMT_TOTALX/D16.2 AS 'GROOM_AMT'
    NEW_AMT_TTLX/D16.2	
BY LEVEL_DESC    
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY CHAIN_NAME
BY PROP_NAME
BY PROP_ZIP5
BY PROP_ADDRESS
BY HOTEL_PHONE
BY CHAIN_CODE
ON TABLE HOLD AS HOLD1
END
-RUN

TABLE FILE HOLD1
PRINT 
  BOOKINGS	
  CHAIN_CODE	
  CHAIN_NAME
  GROOM_AMT/D16.2	
  HOTEL_PHONE
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  PROP_ADDRESS	
  PROP_NAME	
  PROP_ZIP5	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT/D12.2	
  SAVINGS
  TOTAL_STD	
  TOTAL_SLSAV
  TTL_SLSAVX/D16.2
  NEW_AMT_TTLX/D16.2 
BY LEVEL_DESC  
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
-* RANKED BY HIGHEST NMBR_DAYS NOPRINT
RANKED BY HIGHEST &&RANK_METH NOPRINT
ON TABLE HOLD AS HOLD2
END
-RUN





DEFINE FILE HOLD2
 RANK_LIMIT/I5 = &&HTL_LMT;
 DRANK/D5      = RANK;
 ARANKX/A6 = FTOA(DRANK, '(D5)', 'A6');
 ARANK/A5=EDIT(ARANKX,'$99999');
 RANK_VALUE/A5 = IF (RANK_LIMIT EQ 0) THEN (ARANK) ELSE
                 IF RANK GT RANK_LIMIT THEN 'OTHER' ELSE ARANK;
END
-RUN

TABLE FILE HOLD2
PRINT 
  BOOKINGS	
  CHAIN_CODE	
  CHAIN_NAME
  GROOM_AMT	
  HOTEL_PHONE
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT	
  NMBR_DAYS	
  NNROOMS	
  PROP_ADDRESS	
  PROP_NAME	
  PROP_ZIP5	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY LEVEL_DESC  
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
ON TABLE HOLD AS HOLD3
END
-RUN



DEFINE FILE HOLD3
  CHAIN_CD/A2= IF RANK_VALUE LE '&&HTL_LMT' THEN CHAIN_CODE ELSE ' ';	
  CHAIN_NM/A35= IF RANK_VALUE LE '&&HTL_LMT' THEN CHAIN_NAME ELSE ' ';	
  HTL_ADDRESS/A35= IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_ADDRESS ELSE ' ';	
  HTL_NAME/A35 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_NAME ELSE 'ALL OTHER';
-************************IBI KR 
-*PROP_PHONE/A14= IF RANK_VALUE LE '&&HTL_LMT' THEN HOTEL_PHONE ELSE ' ';	
  PROP_PHONE/A15= IF RANK_VALUE LE '&&HTL_LMT' THEN HOTEL_PHONE ELSE ' ';	
  ZIP5/A5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_ZIP5 ELSE ' ';	
END
-RUN

TABLE FILE HOLD3
SUM 
  BOOKINGS
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY LEVEL_DESC  
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
ON TABLE HOLD AS HOLD4
END
-RUN


TABLE FILE HOLD1
SUM 
  BOOKINGS
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY LEVEL_DESC  
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
ON TABLE HOLD AS RHOLD1
END
-RUN

TABLE FILE RHOLD1
PRINT CITY_ST
  BOOKINGS
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
  PROP_CITY
  PROP_STATE_CD
BY LEVEL_DESC      
RANKED BY HIGHEST &&RANK_METH AS 'DAYS_RANK'
ON TABLE HOLD AS RHOLD2
END
-RUN

MATCH FILE HOLD4
PRINT *
BY LEVEL_DESC
BY CITY_ST
ON TABLE HOLD
RUN
FILE RHOLD2
SUM DAYS_RANK
BY LEVEL_DESC
BY CITY_ST
AFTER MATCH HOLD AS HOLD5 OLD-OR-NEW
END
-RUN

TABLE FILE HOLD5
PRINT *
BY LEVEL_DESC
RANKED BY HIGHEST DAYS_RANK
ON TABLE HOLD AS HOLD6
END
-RUN


DEFINE FILE HOLD6
  CTY_LIMIT/I2 = &&CTY_LMT;
  CLIMIT/A2    = EDIT(CTY_LIMIT) ;
  CRANK/D5     = RANK;    
  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
-*  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
  
  LIST/D9 =IF LEVEL_DESC NE LAST LEVEL_DESC THEN (1) ELSE
           IF CITY_ST NE LAST CITY_ST THEN (LAST LIST + 1) ELSE LAST LIST;  
-*  LIST/D6 = IF CITY_ST NE LAST CITY_ST THEN (LAST LIST + 1) ELSE LAST LIST;
  FRANKX/A7 = FTOA(LIST, '(D6)', 'A7');
  FRANK/A6=EDIT(FRANKX,'$999999');
  CTY_VALUE/A9 = IF CTY_LIMIT EQ 0 THEN BRANK ELSE
                 IF LIST GT CTY_LIMIT THEN 'ALL OTHER' ELSE FRANK;
 FLAG/A1 = 'A';
END
-RUN

TABLE FILE HOLD6
PRINT 
  BOOKINGS	
  CLIMIT	
  CTY_LIMIT	
  DAYS_RANK
  FLAG
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY LEVEL_DESC  
BY CTY_VALUE
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
-* BY CHAIN_CD
-* BY CHAIN_NM
BY RANK_VALUE
BY CHAIN_CD
BY CHAIN_NM
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
ON TABLE HOLD AS HOLD7
END
-RUN




TABLE FILE HTLHLD3
SUM NNROOMS/D8 AS 'CTLDAYS'
    NEW_TOTAL_AMT AS 'CTLAMT'
    NEW_AMT_TTLX/D16.2 AS 'GCTLAMT'
BY LEVEL_DESC    
BY CITY_ST
ON TABLE HOLD AS HOLD8
END
-RUN

MATCH FILE HOLD7
PRINT 
  BOOKINGS	
  CLIMIT	
  CTY_LIMIT	
  DAYS_RANK
  FLAG
  GROOM_AMT
  NAMEC 	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  CTY_VALUE
  PROP_CITY
  PROP_STATE_CD
  CHAIN_CD
  CHAIN_NM
  RANK_VALUE
  HTL_NAME
  ZIP5
  HTL_ADDRESS
  PROP_PHONE
  NEW_AMT_TTLX
  TTL_SLSAVX
BY LEVEL_DESC  
BY CITY_ST
ON TABLE HOLD
RUN
FILE HOLD8
SUM CTLDAYS
    CTLAMT
    GCTLAMT
BY LEVEL_DESC
BY CITY_ST
AFTER MATCH HOLD AS HOLD9 OLD-OR-NEW
END
-RUN



TABLE FILE HOLD9
PRINT
   BOOKINGS
   CTLAMT
   CTLDAYS
   CLIMIT
   CTY_LIMIT
   DAYS_RANK
   GCTLAMT
   GROOM_AMT
   NAMEC
   NEW_ROOM_RATE
   NEW_STD_RATE
   NEW_TOTAL_AMT
   NMBR_DAYS
   NNROOMS
   REFUSE_CD
   RESV_BRANCH
   ROOM_AMT
   SAVINGS
   TOTAL_STD
   TOTAL_SLSAV
   TTL_SLSAVX
   NEW_AMT_TTLX
COMPUTE PCTTAMT/D8.1S = IF ((CTLAMT LT 1) AND (CTLAMT GT (-1))) THEN 0
                        ELSE ((NEW_TOTAL_AMT/CTLAMT)*100);
       PGCTTAMT/D8.1S = IF ((GCTLAMT LT 1) AND (GCTLAMT GT (-1))) THEN 0
                        ELSE ((NEW_AMT_TTLX/GCTLAMT)*100);
BY FLAG
BY LEVEL_DESC
BY CTY_VALUE
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
ON TABLE HOLD AS HOLD10 FORMAT FOCUS
END
-RUN
-* Added code to produce total page including vendor totals

TABLE FILE HTLHLD3
SUM BOOKINGS
    NAMEC	
    NEW_ROOM_RATE
    NEW_STD_RATE
    NEW_TOTAL_AMT
    NNROOMS	
    NNROOMS/D8 AS 'NMBR_DAYS'	
    REFUSE_CD	
    RESV_BRANCH	
    SAVINGS	
    TOTAL_AMT/D12.2 AS 'ROOM_AMT'	
    TOTAL_STD
    TOTAL_SLSAV
    TTL_SLSAVX/D16.2CS 
    AMT_TOTALX/D16.2 AS 'GROOM_AMT'
    NEW_AMT_TTLX/D16.2	
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY CHAIN_NAME
BY PROP_NAME
BY PROP_ZIP5
BY PROP_ADDRESS
BY HOTEL_PHONE
BY CHAIN_CODE
ON TABLE HOLD AS TOTH1
END
-RUN


DEFINE FILE TOTH1
LV_DESC/A60 = 'GRAND TOTAL';
END
TABLE FILE TOTH1
PRINT 
  BOOKINGS	
  CHAIN_CODE	
  CHAIN_NAME
  GROOM_AMT/D16.2	
  HOTEL_PHONE
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  PROP_ADDRESS	
  PROP_NAME	
  PROP_ZIP5	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT/D12.2	
  SAVINGS
  TOTAL_STD	
  TOTAL_SLSAV
  TTL_SLSAVX/D16.2
  NEW_AMT_TTLX/D16.2 
BY LV_DESC AS 'LEVEL_DESC'  
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
-* RANKED BY HIGHEST NMBR_DAYS NOPRINT
RANKED BY HIGHEST &&RANK_METH NOPRINT
ON TABLE HOLD AS TOTH2
END
-RUN




 
 

DEFINE FILE TOTH2
 RANK_LIMIT/I5 = &&HTL_LMT;
 DRANK/D5      = RANK;
 ARANKX/A6 = FTOA(DRANK, '(D5)', 'A6');
 ARANK/A5=EDIT(ARANKX,'$99999');
 RANK_VALUE/A5 = IF (RANK_LIMIT EQ 0) THEN (ARANK) ELSE
                 IF RANK GT RANK_LIMIT THEN 'OTHER' ELSE ARANK;
END
-RUN

TABLE FILE TOTH2
PRINT 
  BOOKINGS	
  CHAIN_CODE	
  CHAIN_NAME
  GROOM_AMT	
  HOTEL_PHONE
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT	
  NMBR_DAYS	
  NNROOMS	
  PROP_ADDRESS	
  PROP_NAME	
  PROP_ZIP5	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY LEVEL_DESC  
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
ON TABLE HOLD AS TOTH3
END
-RUN




DEFINE FILE TOTH3
  CHAIN_CD/A2= IF RANK_VALUE LE '&&HTL_LMT' THEN CHAIN_CODE ELSE ' ';	
  CHAIN_NM/A35= IF RANK_VALUE LE '&&HTL_LMT' THEN CHAIN_NAME ELSE ' ';	
  HTL_ADDRESS/A35= IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_ADDRESS ELSE ' ';	
  HTL_NAME/A35 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_NAME ELSE 'ALL OTHER';
-************************IBI KR 
-*PROP_PHONE/A14= IF RANK_VALUE LE '&&HTL_LMT' THEN HOTEL_PHONE ELSE ' ';	
  PROP_PHONE/A15= IF RANK_VALUE LE '&&HTL_LMT' THEN HOTEL_PHONE ELSE ' ';	
  ZIP5/A5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_ZIP5 ELSE ' ';	
END
-RUN

TABLE FILE TOTH3
SUM 
  BOOKINGS
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY LEVEL_DESC  
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
ON TABLE HOLD AS TOTH4
END
-RUN


TABLE FILE TOTH2
SUM 
  BOOKINGS
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY LEVEL_DESC  
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
ON TABLE HOLD AS TOTHR1
END
-RUN

TABLE FILE TOTHR1
PRINT CITY_ST
  BOOKINGS
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
  PROP_CITY
  PROP_STATE_CD
BY LEVEL_DESC      
RANKED BY HIGHEST &&RANK_METH AS 'DAYS_RANK'
ON TABLE HOLD AS TOTHR2
END
-RUN

MATCH FILE TOTH4
PRINT *
BY LEVEL_DESC
BY CITY_ST
ON TABLE HOLD
RUN
FILE TOTHR2
SUM DAYS_RANK
BY LEVEL_DESC
BY CITY_ST
AFTER MATCH HOLD AS TOTH5 OLD-OR-NEW
END
-RUN

TABLE FILE TOTH5
PRINT *
BY LEVEL_DESC
RANKED BY HIGHEST DAYS_RANK
ON TABLE HOLD AS TOTH6
END
-RUN


DEFINE FILE TOTH6
  CTY_LIMIT/I2 = &&CTY_LMT;
  CLIMIT/A2    = EDIT(CTY_LIMIT) ;
  CRANK/D5     = RANK;    
  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
-*  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
  
  LIST/D9 =IF LEVEL_DESC NE LAST LEVEL_DESC THEN (1) ELSE
           IF CITY_ST NE LAST CITY_ST THEN (LAST LIST + 1) ELSE LAST LIST;  
-*  LIST/D6 = IF CITY_ST NE LAST CITY_ST THEN (LAST LIST + 1) ELSE LAST LIST;
  FRANKX/A7 = FTOA(LIST, '(D6)', 'A7');
  FRANK/A6=EDIT(FRANKX,'$999999');
  CTY_VALUE/A9 = IF CTY_LIMIT EQ 0 THEN BRANK ELSE
                 IF LIST GT CTY_LIMIT THEN 'ALL OTHER' ELSE FRANK;
 FLAG/A1 = 'B';
END
-RUN

TABLE FILE TOTH6
PRINT 
  BOOKINGS	
  CLIMIT	
  CTY_LIMIT	
  DAYS_RANK
    FLAG
  GROOM_AMT
  NAMEC	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  TTL_SLSAVX
  NEW_AMT_TTLX
BY LEVEL_DESC  
BY CTY_VALUE
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
-* BY CHAIN_CD
-* BY CHAIN_NM
BY RANK_VALUE
BY CHAIN_CD
BY CHAIN_NM
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
ON TABLE HOLD AS TOTH7
END
-RUN


TABLE FILE TOTH3
SUM NNROOMS/D8 AS 'CTLDAYS'
    NEW_TOTAL_AMT AS 'CTLAMT'
    NEW_AMT_TTLX/D16.2 AS 'GCTLAMT'
BY LEVEL_DESC    
BY CITY_ST
ON TABLE HOLD AS TOTH8
END
-RUN

MATCH FILE TOTH7
PRINT 
  BOOKINGS	
  CLIMIT	
  CTY_LIMIT	
  DAYS_RANK
  FLAG
  GROOM_AMT
  NAMEC 	
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS	
  REFUSE_CD	
  RESV_BRANCH	
  ROOM_AMT	
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  CTY_VALUE
  PROP_CITY
  PROP_STATE_CD
  CHAIN_CD
  CHAIN_NM
  RANK_VALUE
  HTL_NAME
  ZIP5
  HTL_ADDRESS
  PROP_PHONE
  NEW_AMT_TTLX
  TTL_SLSAVX
BY LEVEL_DESC  
BY CITY_ST
ON TABLE HOLD
RUN
FILE TOTH8
SUM CTLDAYS
    CTLAMT
    GCTLAMT
BY LEVEL_DESC
BY CITY_ST
AFTER MATCH HOLD AS TOTH9 OLD-OR-NEW
END
-RUN



TABLE FILE TOTH9
PRINT
   BOOKINGS
   CTLAMT
   CTLDAYS
   CLIMIT
   CTY_LIMIT
   DAYS_RANK
   GCTLAMT
   GROOM_AMT
   NAMEC
   NEW_ROOM_RATE
   NEW_STD_RATE
   NEW_TOTAL_AMT
   NMBR_DAYS
   NNROOMS
   REFUSE_CD
   RESV_BRANCH
   ROOM_AMT
   SAVINGS
   TOTAL_STD
   TOTAL_SLSAV
   TTL_SLSAVX
   NEW_AMT_TTLX
COMPUTE PCTTAMT/D8.1S = IF ((CTLAMT LT 1) AND (CTLAMT GT (-1))) THEN 0
                        ELSE ((NEW_TOTAL_AMT/CTLAMT)*100);
       PGCTTAMT/D8.1S = IF ((GCTLAMT LT 1) AND (GCTLAMT GT (-1))) THEN 0
                        ELSE ((NEW_AMT_TTLX/GCTLAMT)*100);
BY FLAG
BY LEVEL_DESC
BY CTY_VALUE
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY RANK_VALUE
BY HTL_NAME
BY ZIP5
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
ON TABLE HOLD AS TOTH10 FORMAT FOCUS
END
-RUN


END
-RUN

-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HRANK=&HLDPATH || 'HOLD10.FOC';
-SET &HNORANK=&HLDPATH || 'TOTH10.FOC';
-RUN

USE CLEAR *
-RUN

EX SUUSES
-RUN

USE ADD
&HRANK AS HOLD10
&HNORANK AS HOLD10
END
-RUN


 

SET COMPOUND=BYTOC

-*-SET &&OUT3 = IF '&&OUTTO.EVAL' EQ 'XB' THEN 'ON TABLE PCHOLD FORMAT EXL2K BYTOC' ELSE
-* -                                            'ON TABLE SAVE AS SAVREP FORMAT EXL2K BYTOC';
-SET &&OUT3 = IF '&&OUTTO.EVAL' EQ 'XB' THEN 'ON TABLE PCHOLD FORMAT XLSX BYTOC' ELSE
-                                            'ON TABLE SAVE AS SAVREP FORMAT EXL2K BYTOC';


DEFINE FILE HOLD10
  HTL_NAM1/A20 = SUBSTR(35, HTL_NAME, 1, 20, 20, HTL_NAM1);
  ADDRESS/A35 = IF CTY_VALUE LT CLIMIT THEN HTL_ADDRESS ELSE ' ';	
  CHAIN_NAME/A35 = IF CTY_VALUE LT CLIMIT THEN CHAIN_NM ELSE ' ';	
  CHAIN_PRNT/A2 = IF CTY_VALUE LT CLIMIT THEN CHAIN_CD ELSE ' ';	
  CITY_PRNT/A35 = IF CTY_VALUE LT CLIMIT THEN PROP_CITY ELSE ' ';	
  CTY_PRINT/A35 = IF CTY_VALUE LT CLIMIT THEN CITY_ST ELSE ' ';	
-************************IBI KR  
-*HTL_PHONE/A14 = IF CTY_VALUE LT CLIMIT THEN PROP_PHONE ELSE ' ';	
  HTL_PHONE/A15 = IF CTY_VALUE LT CLIMIT THEN PROP_PHONE ELSE ' ';	
  HTL_PRINT/A35 = IF CTY_VALUE LT CLIMIT THEN HTL_NAME ELSE ' ';
  HTL_PRINT1/A20 = IF CTY_VALUE LT CLIMIT THEN HTL_NAM1 ELSE ' ';	
  HTL_RANK/A5 = IF CTY_VALUE LT CLIMIT THEN RANK_VALUE ELSE ' ';	
  STATE_PRNT/A35 = IF CTY_VALUE LT CLIMIT THEN PROP_STATE_CD ELSE ' ';	
  ZIP_PRINT/A5 = IF CTY_VALUE LT CLIMIT THEN ZIP5 ELSE ' ';	


-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-**********************************************************************
  NOWTOD/A8 WITH CTY_VALUE = HHMMSS (NOWTOD);	
END 

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXLEJ' ELSE &&SMSTY;
-RUN

TABLE FILE HOLD10
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPCBK;
"</2"
-NOSPCBK;
-*
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    &&S_SUBJ11
    &&S_SUBJ12
    &&S_SUBJ13
    &&S_SUBJ14
    &&S_SUBJ15
    &&S_SUBJ16
    &&S_SUBJ17
    &&S_SUBJ18
    &&S_SUBJ19
    &&S_SUBJ20
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10


-*


-INCLUDE FOOTERSM

-*
-*ON TABLE SET STYLE &&SMSTY
-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *

-IF &&CURRENCY EQ 'TRL' THEN GOTO SMALLERBK;
-INCLUDE &&PASTYS
-GOTO FINFONTBK;
-SMALLERBK
-INCLUDE SM7
-FINFONTBK


-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILLBK;
-INCLUDE &&DSTY

-SKIP_DRILLBK

ENDSTYLE
&&OUT3
END
-RUN

-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3BK;

EX REPORT_3

-SKIP_R3BK
-GOTO XXIT;


-XXIT;
