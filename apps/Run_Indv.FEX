-* File RUN_INDV.FEX
-*****************************************************************
-***********************************************************************
-* DATE          NAME                DESCRIPTION
-* 8/31/00     IBISTL-KR             MODIFIED CODE TO REFLECT FIXED
-*                                   KEY LENGTH OF 50.
-* 9/13/00     IBISTL-KR             ADDED NEW PARAMETERS TO TEST
-*                                   FOR DRILLABLE REPORTS.
-* 3/19/01     TANDT-SS              ADDED CODE FOR DUAL DATE RANGES.
-*********************************************************************** 
-WINFORM MAIN ALTER RSET_BT ENABLE FALSE
-WINFORM MAIN ALTER RCYC_BT ENABLE FALSE
-WINFORM MAIN ALTER PWAIT SHOW TRUE
-RUN

-SET &&DRILLED_RUN = 'N';
-SET &&DRILLSTREAM = 'N';
-SET &&NOW_CYC = 'NOW';
-RUN

FILEDEF INSTPASS DISK &&INSTPASS
-RUN
-WRITE INSTPASS xxxxxxxx
-RUN

FILEDEF INSTPASS CLEAR
-RUN

-AIR50
USE ADD
 &&USE_HIER AS HIER50
END
-RUN
-GOTO RINST

-RINST

FILEDEF INSTPASS DISK &&INSTPASS
-RUN

RUN RPT_SET
-RUN

FILEDEF INSTPASS CLEAR
-RUN

FILEDEF INSTPASS DISK &&INSTPASS
-RUN

-READ INSTPASS &&STREAM.8 &&SETF.8 &&RPTTYP.3 &&IKEY.72 &&RN.50 &&RS.40,
-, &&RQ.4 &&IDKEY.A22 &&SCREEN.1
-RUN

FILEDEF INSTPASS CLEAR
-RUN

-IF &&STREAM EQ 'xxxxxxxx' THEN GOTO XXIT;

-SET &&RN = LJUST(50, &&RN, &&RN);
-SET &&RS = LJUST(40, &&RS, &&RS);
-SET &&RPTTX = 'Running: ' || &&RN;
-SET &&SETTX = 'of Set: ' || &&RS;
-WINFORM MAIN ALTER RPTNM TEXT &&RPTTX
-WINFORM MAIN ALTER SETNM TEXT &&SETTX
-WINFORM MAIN ALTER RPTNM SHOW TRUE
-WINFORM MAIN ALTER SETNM SHOW TRUE

-SET &&INSTID = SUBSTR(72, &&IKEY, 51, 72, 22, 'A22');
-SET &&SETID = SUBSTR(72, &&IKEY, 9, 30, 22, 'A22');
-RUN
-TYPE &&INSTID

-SET &&VARFILE = &&APP_PATH || &&SETF || '.FEX';
-RUN

-* ADDED CODE 'SPD' FOR DUAL DATE RANGE
-IF &&RPTTYP EQ 'SPC' OR 'SPD' OR 'STS' OR 'ETS' THEN GOTO SPCVAR;
-RUN

FILEDEF OUTFILE DISK &&VARFILE
-RUN

FILEDEF INSTPASS DISK &&INSTPASS
-RUN

RUN VARSETS
-RUN

FILEDEF OUTFILE CLEAR
-RUN

FILEDEF INSTPASS CLEAR
-RUN

-GOTO EXSTRM

-SPCVAR

-SET &&READSET = &&CLT_PATH || READSET || '.FTM';
-RUN

FILEDEF READSET DISK &&READSET
-RUN
FILEDEF OLDSET DISK &&VARFILE 
-RUN

-REPEAT XFER WHILE &IORETURN  EQ 0;
-READ OLDSET &&SLINE.80
-IF &IORETURN NE 0 THEN GOTO XFER;
-WRITE READSET &&SLINE

-XFER

-VARS
FILEDEF READSET CLEAR
-RUN
FILEDEF OLDSET CLEAR
-RUN
FILEDEF OUTFILE DISK &&VARFILE
-RUN
FILEDEF INSTPASS DISK &&INSTPASS
-RUN
FILEDEF READSET DISK &&READSET
-RUN

RUN VARSETS
-RUN

FILEDEF INSTPASS DISK &&INSTPASS
-RUN

-READ INSTPASS &&XSTREAM.8 &&XSETF.8 &&XRPTTYP.3 &&XIKEY.72,
-, &&IDKEY.22 &&SCREEN.1
-RUN

FILEDEF INSTPASS CLEAR
-RUN

-IF &&XSTREAM EQ 'AGAIN' THEN GOTO VARS ELSE GOTO GVAR;
-RUN

-* *******************************

-GVAR

FILEDEF READSET CLEAR
-RUN
FILEDEF OUTFILE CLEAR
-RUN

-GOTO EXSTRM

-EXSTRM

-SET &&NOW_CYC = 'NOW';
-TYPE Executing &&STREAM
EX &&STREAM
-EXIT

-XXIT

FILEDEF INSTPASS DISK &&INSTPASS
-RUN
-WRITE INSTPASS xxxxxxxx
-RUN

-* REJ EX RESTART 
-EXIT

