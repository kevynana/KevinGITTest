-* Match for Same Day Savings Analysis Udid repor
-* 03/08/16 - DLV -  S-15878  added Air Fare Re-Search savings and net tickets

SET ASNAMES=ON


-INCLUDE TCUDAUSE
-RUN

TABLE FILE UDAIR
PRINT AUD_DATA/A2 AS 'VAL_ALN'
BY AIR_KEY
WHERE UDID EQ 'SDV'
ON TABLE HOLD AS UDH1 
END
-RUN


TABLE FILE UDAIR
PRINT NUD_DATA/P12.2CS AS 'STD_FEE'
BY AIR_KEY
WHERE UDID EQ 'SDS'
ON TABLE HOLD AS UDH2
END
-RUN

TABLE FILE UDAIR
PRINT NUD_DATA/P12.2CS AS 'PD_FEE'
BY AIR_KEY
WHERE UDID EQ 'SDF'
ON TABLE HOLD AS UDH3
END
-RUN


MATCH FILE UDH1 
PRINT VAL_ALN
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH2
SUM STD_FEE
BY AIR_KEY
AFTER MATCH HOLD AS UDHOLD1 OLD-OR-NEW
END
-RUN


MATCH FILE UDHOLD1
PRINT VAL_ALN STD_FEE
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH3
SUM PD_FEE
BY AIR_KEY
AFTER MATCH HOLD AS UDHOLD2 OLD-OR-NEW
END
-RUN



 
TABLE FILE UDAIR
SUM NUD_DATA/P12.2CS AS 'DSS'
BY AIR_KEY
WHERE UDID EQ 'DSS'
ON TABLE HOLD AS TCUA1
END


TABLE FILE TCUA1
PRINT DSS
BY AIR_KEY
ON TABLE HOLD AS TCUA2 FORMAT FOCUS INDEX AIR_KEY
END
-RUN
  
