-* 03/15/2017 - DLV - S-22486 CHANGED ettek Review to Post-trip Reporting

SET ASNAMES=ON


-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');
-IF &&SETF EQ 'CGSLTMSD' THEN GOTO DOMT ELSE GOTO NODOMT;
-DOMT;
-SET &TITLE = 'Domestic SLT Summary';
-GOTO TITLDONE;
-NODOMT;
-SET &TITLE = 'SLT Summary';
-TITLDONE;
-* TABLE FILE AIRCARHTLN 
-* SUM CFARE CNET_TKTS CNET_TKTD CDOMFP CADVT CONL CTRAD PFARE PNET_TKTS PNET_TKTD PDOMFP PADVT PONL PTRAD
-*     CRENTDAYS CRENTAMT PRENTDAYS PRENTAMT CAVGL PAVGL
-*     CHNIGHTS PHNIGHTS CHAMT PHAMT CHAVGL PHAVGL 
-* BY AROLL_DSC5
-* ON TABLE HOLD AS RK
-* END
-* -RUN

DEFINE FILE RK
NOWTOD/A8 WITH AROLL_DSC5 = HHMMSS (NOWTOD);
END
-RUN

TABLE FILE RK
HEADING
" "
"<10 &&RPT_TTL1"
"<10 &&RPT_TTL2"
" "
" "
" <34 PERIOD1: <40 &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
" <34 PERIOD2: <40 &FXMM/&FXMD/&FXMY - &TXOM/&TXOD/&TXOY"
" "
"</2"
SUM    
-* Total Air Car Hotel Spend Amounts and Variance    
COMPUTE CTOTACH/D12M = CFARE + CRENTAMT + CHAMT; AS 'Current,Air Car,Hotel Spend'
COMPUTE PTOTACH/D12M = PFARE + PRENTAMT + PHAMT; AS 'Prior,Air Car,Hotel Spend'
COMPUTE TOTACHVAR/P8.1S% = IF ((PTOTACH LT 1) AND (PTOTACH GT (-1))) THEN 0 ELSE
                             ((CTOTACH - PTOTACH)/PTOTACH)*100; AS  'Variance'                          
                
-*Total Air Spend and Variance %
CFARE/D12M AS 'Current,Air,Spend' PFARE/D12M AS 'Prior,Air,Spend'
COMPUTE AIRSPVAR/P8.1S% = IF ((PFARE LT 1) AND (PFARE GT (-1))) THEN 0 ELSE
                             ((CFARE-PFARE)/PFARE)*100; AS 'Variance'
-*Net Tickets and Variance %
CNET_TKTS AS 'Current,Net,Tickets' PNET_TKTS AS 'Prior,Net,Tickets'
COMPUTE NETTVAR/P8.1S% = IF ((PNET_TKTS LT 1) AND (PNET_TKTS GT (-1))) THEN 0 ELSE
                            ((CNET_TKTS-PNET_TKTS)/PNET_TKTS)*100; AS 'Variance'               

-* Total Hotel Spend and Variance %
CHAMT/D12M AS 'Current,Hotel,Spend' PHAMT/D12M AS 'Prior,Hotel,Spend'
COMPUTE HTLSVAR/P8.1S% = IF ((PHAMT LT 1) AND (PHAMT GT (-1))) THEN 0 ELSE
                           ((CHAMT-PHAMT)/PHAMT)*100; AS 'Variance'
                       
-* Average Hotel Rate Per Night and Variance %
COMPUTE CHAVGR/P12CSM = IF ((CHNIGHTS LT 1) AND (CHNIGHTS GT (-1))) THEN 0 ELSE
                           (CHAMT/CHNIGHTS); AS 'Current,Avg Rate,Per Night'
COMPUTE PHAVGR/P12CSM = IF ((PHNIGHTS LT 1) AND (PHNIGHTS GT (-1))) THEN 0 ELSE
                           (PHAMT/PHNIGHTS); AS 'Prior,Avg Rate,Per Night'
COMPUTE HTLRVAR/P8.1S% = IF ((PHAVGR LT 1) AND (PHAVGR GT (-1))) THEN 0 ELSE
                            ((CHAVGR-PHAVGR)/PHAVGR)*100; AS 'Variance'
-* Number of Hotel Nights and Variance %
CHNIGHTS AS 'Current,Hotel,Nights' PHNIGHTS AS 'Prior,Hotel,Nights'
COMPUTE CDAYVAR/P8.1S% = IF ((PHNIGHTS LT 1) AND (PHNIGHTS GT (-1))) THEN 0 ELSE
                            ((CHNIGHTS-PHNIGHTS)/PHNIGHTS)*100; AS 'Variance'                            
                            
-* Average Length of Stay and Variance %
CHAVGL AS 'Current,Avg Length,of Stay' PHAVGL AS 'Prior,Avg Length,of Stay'
COMPUTE HTLSVAR/P8.1S% = IF ((PHAVGL LT 1) AND (PHAVGL GT (-1))) THEN 0 ELSE
                            ((CHAVGL-PHAVGL)/PHAVGL)*100; AS 'Variance'
-* Total Car Spend and Variance %
CRENTAMT AS 'Current,Car,Spend' PRENTAMT AS 'Prior,Car,Spend'
COMPUTE CARSVAR/P8.1S% = IF ((PRENTAMT LT 1) AND (PRENTAMT GT (-1))) THEN 0 ELSE
                            ((CRENTAMT-PRENTAMT)/PRENTAMT)*100; AS 'Variance'
-* Average Daily Rate and Variance %
COMPUTE CCAVGR/P12CSM = IF ((CRENTDAYS LT 1) AND (CRENTDAYS GT (-1))) THEN 0 ELSE
                           (CRENTAMT/CRENTDAYS); AS 'Current,Avg Daily,Rate'
COMPUTE PCAVGR/P12CSM = IF ((PRENTDAYS LT 1) AND (PRENTDAYS GT (-1))) THEN 0 ELSE
                           (PRENTAMT/PRENTDAYS); AS 'Prior,Avg Daily,Rate' 
COMPUTE CARRVAR/P8.1S% = IF ((PCAVGR LT 1) AND (PCAVGR GT (-1))) THEN 0 ELSE
                            ((CCAVGR-PCAVGR)/PCAVGR)*100; AS 'Variance'
                            
-* Number of Rental Days and Variance %
CRENTDAYS AS 'Current,Car,Days' PRENTDAYS AS 'Prior,Car,Days'
COMPUTE CDAYVAR/P8.1S% = IF ((PRENTDAYS LT 1) AND (PRENTDAYS GT (-1))) THEN 0 ELSE
                            ((CRENTDAYS-PRENTDAYS)/PRENTDAYS)*100; AS 'Variance'
                            
-* Average length of Rental and Variance %
CAVGL AS 'Current,Avg Rental,Length' PAVGL AS 'Prior,Avg Rental,Length'
COMPUTE CARSVAR/P8.1S% = IF ((PAVGL LT 1) AND (PAVGL GT (-1))) THEN 0 ELSE
                            ((CAVGL-PAVGL)/PAVGL)*100; AS 'Variance'       
BY HIGHEST CNET_TKTS NOPRINT                            
BY AROLL_DSC5 AS 'SLT,Member'    
-* ON TABLE PCHOLD FORMAT EXL2K
&&OUTLINE1
&&OUTLINE2
FOOTING BOTTOM
"Post-trip Reporting &DATE AT <NOWTOD <60 &&FOOTR"
"Copyright (c) 1996-2003, Travel and Transport - Confidential/Proprietary"
ON AROLL_DSC5 RECOMPUTE MULTILINES AS 'TOTAL FOR'
ON TABLE SET PAGE-NUM OFF
-* ON TABLE PCHOLD FORMAT PDF
-* ON TABLE SET HTMLCSS ON
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=1.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=1.000000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT,FONT=TIMES NEW ROMAN, SIZE=8, COLOR=BLACK, 
    BACKCOLOR=NONE, GRID=ON, STYLE=NORMAL, $
TYPE=TITLE, FONT=TIMES NEW ROMAN, SIZE=9, BACKCOLOR=RGB(128 255 255), $
TYPE=FOOTING, SIZE=6, $
TYPE=TITLE, SIZE=9, STYLE=BOLD+UNDERLINE, $
TYPE=HEADING, SIZE=10, STYLE=BOLD, FONT=TIMES NEW ROMAN,$
TYPE=REPORT, WRAP= 1,$
TYPE=REPORT, IMAGE=&&TNTPIC, POSITION=(&&TNTTRPOS), SIZE=(&&TNTTRSIZ), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLTRPOS), SIZE=(&&ROLTRSIZ), $
TYPE=GRANDTOTAL, SIZE=9, STYLE=BOLD, COLOR=BLACK, BACKCOLOR=RGB(128 255 255),$
TYPE=REPORT, TITLETEXT=&TITLE,$
ENDSTYLE
END 
-RUN





