SET ASNAMES=ON

-GOTO JOYPF

JOIN AIR_KEY IN A_ROLAND TO ALL AIR_KEY IN S_ROLAND AS J1
-RUN


-* USE ADD
-* D:\TNT\TTRACKER\DATA\S_ROLAND.FOC AS SR_50
-* D:\TNT\TTRACKER\DATA\A_ROLAND.FOC AS AIR_MAIN
-* END
-* -RUN

DEFINE FILE A_ROLAND
AROLL_LEV3A/A15 = 'DEFDEP';
END
-RUN
TABLE FILE A_ROLAND
PRINT AROLL_LEV3A AS 'AROLL_LEV3'
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
WHERE LEVEL2 NE '3030' OR '3035' OR '3038' OR '5050' OR '5055' OR '5151' OR '5252' OR '5353' OR '5454' OR '6065'
ON TABLE HOLD AS JOY
END
-RUN


TABLE FILE JOY
PRINT AROLL_LEV3
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD
END
-RUN

MODIFY FILE S_ROLAND
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE AROLL_LEV3 = LEVEL2;
ON MATCH UPDATE AROLL_LEV3
ON NOMATCH REJECT 
DATA ON HOLD
END
-RUN

-JOYC
DEFINE FILE C_ROLAND
AROLL_LEV3A/A15 = 'DEFDEP';
END
-RUN
TABLE FILE C_ROLAND
PRINT AROLL_LEV3A AS 'AROLL_LEV3'
BY CAR_KEY
WHERE LEVEL2 NE '3030' OR '3035' OR '3038' OR '5050' OR '5055' OR '5151' OR '5252' OR '5353' OR '5454' OR '6065'
ON TABLE HOLD
END
-RUN

MODIFY FILE C_ROLAND
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
DATA ON HOLD
END
-RUN

-JOYH
DEFINE FILE H_ROLAND
AROLL_LEV3A/A15 = 'DEFDEP';
END
-RUN
TABLE FILE H_ROLAND
PRINT AROLL_LEV3A AS 'AROLL_LEV3'
BY HTL_KEY
WHERE LEVEL2 NE '3030' OR '3035' OR '3038' OR '5050' OR '5055' OR '5151' OR '5252' OR '5353' OR '5454' OR '6065'
ON TABLE HOLD
END
-RUN

MODIFY FILE H_ROLAND
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3
DATA ON HOLD
END
-RUN

-JOYPF


DEFINE FILE PFROLAND
AROLL_LEV3A/A15 = 'DEFDEP';
END
-RUN
TABLE FILE PFROLAND
PRINT AROLL_LEV3A AS 'AROLL_LEV3' 
BY SEQNBR
BY AIR_KEY
BY CAR_KEY
BY HTL_KEY
BY MISC_KEY
WHERE AROLL_LEV3 NE '3030' OR '3035' OR '3038' OR '5050' OR '5055' OR '5151' OR '5252' OR '5353' OR '5454' OR '6065' 
ON TABLE HOLD
END
-RUN

MODIFY FILE PFROLAND
FIXFORM FROM HOLD
MATCH SEQNBR AIR_KEY CAR_KEY HTL_KEY MISC_KEY
ON MATCH UPDATE AROLL_LEV3
DATA ON HOLD
END
-RUN





