-****************************************************************************************
-* UDIDGEN.FEX
-* This program will extract data from Rpt_flds and then interpret them
-* to WHERE statements.  Each UDID has one WHERE statements.
-* Write WHERE statements to corresponding UPARM# files
-*
-* Create and Update temp UDID files TMPAUDID, TMPCUDID or TMPHUDID.
-* Author: LS
-* Date: 09/27/2005
-*
-* Updated for NE selections.
-* Due to multiple UDIDs possible per AIR_KEY a simple exclusion (NE) will not work.
-* It requires multiple matches in order to extract the correct data.
-*
-* NE selections will be witten the first few UParm# files. However the condition
-* is reversed in WHERE statement if NE is selected, ie to treat as EQ condition.
-* EQUAL or CONTAINS selection will be written to the next few UPARM# files.
-* Max. number of UPARM# files are 5.
-* Added OMITS 01/08/2009
-* added LIMO UDID on Aug 2013
-*  02/05/2015  REJ  S-05681 Changes for Available Reports.  Adding code so that the
-*                           program will run in current Review and in Available Reports.
-****************************************************************************************
-INCLUDE SETECHO
SET USERFCHK=OFF
SET TEMPERASE = OFF
 
-SET &FILENAME=IF &&FROMAVRP EQ 'Y' THEN 'BRPT_FLDS_UDID' ELSE 'BRPTFLDS';
-SET &INST_KEY = &&IKEY;
-SET &&UDIDGRP='';
-SET &&UDIDNE='N';
 
-*These temp files create for UDID selections
CREATE FILE TMPAUDID
CREATE FILE TMPCUDID
CREATE FILE TMPHUDID
CREATE FILE TMPLUDID
-RUN
JOIN CLEAR *
-RUN
 
DEFINE FILE &FILENAME.EVAL
TEST/A1='X';
END
TABLE FILE &FILENAME.EVAL
PRINT UDID
WHERE INST_KEY EQ &INST_KEY
ON TABLE HOLD
END
-RUN
-IF &LINES EQ 0 THEN GOTO EndUDIDRPT;
 
-SET &UDIDF = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\UF' | '&&COMPNY.EVAL' || '.FOC AS UDFILE';
USE REPLACE
&UDIDF
END
-RUN
 
JOIN UDID IN &FILENAME.EVAL TO UDID IN UDFILE
-RUN
 
-*Numeric UDID selections
TABLE FILE &FILENAME
SUM UDID UD_GROUP
BY UDID NOPRINT
WHERE INST_KEY EQ &INST_KEY
WHERE UINCL EQ 9
ON TABLE HOLD AS SAVE1 FORMAT ALPHA
END
-RUN
-SET &RECS1 = &LINES;
 
-IF &RECS1 EQ 0 THEN GOTO NOREAD1;
-REPEAT ENDREAD1 &LINES TIMES
-READ SAVE1 NOCLOSE &X.3. &UDGRP.3.
-SET &&UDIDGRP = &&UDIDGRP || &UDGRP;
-ENDREAD1
-CLOSE SAVE1
-NOREAD1
 
-* Alpha UDID selections
-*NOT EQUAL SELECTIOINS
TABLE FILE &FILENAME
SUM UDID UD_GROUP
BY UDID NOPRINT
WHERE INST_KEY EQ &INST_KEY
WHERE UINCL EQ 2
ON TABLE HOLD AS SAVE2 FORMAT ALPHA
END
-RUN
-SET &RECS2 = &LINES;
-SET &&UDIDNE=IF &RECS2 GT 0 THEN 'Y' ELSE 'N';
-IF &RECS2 EQ 0 THEN GOTO NOREAD2;
 
-REPEAT ENDREAD2 &LINES TIMES
-READ SAVE2 NOCLOSE &X.3. &UDGRP.3.
-SET &&UDIDGRP = &&UDIDGRP || &UDGRP;
-ENDREAD2
-CLOSE SAVE2
-NOREAD2
 
TABLE FILE &FILENAME
SUM UDID UD_GROUP
BY UDID NOPRINT
WHERE INST_KEY EQ &INST_KEY
WHERE UINCL EQ 1 OR 3 OR 4
ON TABLE HOLD AS SAVE3 FORMAT ALPHA
END
-RUN
-SET &RECS3 = &LINES;
-IF &RECS3 EQ 0 THEN GOTO NOREAD3;
 
-REPEAT ENDREAD3 &LINES TIMES
-READ SAVE3 NOCLOSE &X.3. &UDGRP.3.
-SET &&UDIDGRP = &&UDIDGRP || &UDGRP;
-ENDREAD3
-CLOSE SAVE3
-NOREAD3
 
-SET &RECS = &RECS1 + &RECS2 + &RECS3;
 
-IF &RECS EQ 0 THEN GOTO EndUDIDRPT;
 
-***********************************************
-*generate temp focexec files: uparm#
-***********************************************
-SET &CNT = 1;
-REPEAT ENDDEF &RECS TIMES
-SET &UPARM.&CNT = 'UPARM' | '&CNT.EVAL';;
-SET &DDNAME = &UPARM.&CNT;
-SET &FEXNAME = &&WEB_PATH.EVAL || '&DDNAME.EVAL' | '.FEX';
-TYPE &FEXNAME
FILEDEF &DDNAME DISK &FEXNAME
-RUN
-WRITE &DDNAME
-CLOSE &DDNAME
-SET &CNT = &CNT + 1;
-ENDDEF
 
-SET &STARTCOUNT = 100;
-SET &TOTCOUNT = 50;
-SET &CNT = &STARTCOUNT;
-REPEAT EndUDID &TOTCOUNT TIMES
-SET &WHERE.&CNT = '';
-SET &CNT = &CNT + 1;
-EndUDID
 
-***********************************************
-*retrieve not equal selections
-***********************************************
-SET &UD2SEL = 0;
-IF &RECS2 EQ 0 THEN GOTO CHKNUDID;
TABLE FILE &FILENAME
PRINT UDID UINCL UDDATA
BY UDID NOPRINT
BY UINCL NOPRINT
WHERE INST_KEY EQ &INST_KEY
WHERE UINCL EQ 2
ON TABLE HOLD AS UDID02 FORMAT ALPHA
END
-RUN
-SET &UD2SEL = &LINES;
 
-SET &PrevUDID='';
-SET &PrevIncl='';
-SET &CNT = &STARTCOUNT;
-REPEAT TOUDID2 &LINES TIMES
-READ UDID02 &VUDID.3. &VINCL.1.  &VUDDATA.64.
 
-SET &OP = ' EQ ' ;
 
-*Special process required if NOT EQUAL is selected
 
-SET &LEN=ARGLEN(64,'&VUDDATA.EVAL','I2');
-SET &VUDDATA = TRIM('T','&VUDDATA.EVAL', 64, ' ', 1, 'A&LEN.EVAL');
 
-IF &PrevUDID EQ &VUDID AND &PrevIncl NE &VINCL THEN GOTO SameUDIDOnly2;
-IF &PrevUDID EQ &VUDID AND &PrevIncl EQ &VINCL THEN GOTO SameUDOP2;
 
-SET &WHERE.&CNT = 'WHERE UDID EQ ' | '''&VUDID.EVAL''' | ' AND AUD_DATA' | ' &OP.EVAL ' | '''&VUDDATA.EVAL''';
-GOTO IncUDID2;
 
-SameUDIDOnly2
-SET &WHERE.&CNT = ' OR UDID EQ ' | '''&VUDID.EVAL''' | ' AND AUD_DATA ' | ' &OP.EVAL ' | '''&VUDDATA.EVAL''';
-GOTO IncUDID2;
 
-SameUDOP2
-SET &WHERE.&CNT = ' OR ' | '''&VUDDATA.EVAL'''
 
-IncUDID2
-SET &CNT = &CNT + 1;
-SET &PrevUDID='&VUDID.EVAL';
-SET &PrevIncl = '&VINCL.EVAL';
-TOUDID2
 
-******************************************
-*Retrieve from and to values
-******************************************
-CHKNUDID
-IF &RECS1 EQ 0 THEN GOTO CHKUDID3;
 
TABLE FILE &FILENAME
PRINT UDID FROMVAL TOVAL
BY UDID NOPRINT
WHERE INST_KEY EQ &INST_KEY
WHERE UINCL EQ 9
ON TABLE HOLD AS UDID09 FORMAT ALPHA
END
-RUN
 
-SET &CNT = IF &RECS2 EQ 0 THEN &STARTCOUNT ELSE &CNT;
-SET &PrevUDID='';
-REPEAT TOUDID1 &LINES TIMES
-READ UDID09 NOCLOSE &VUDID.A3. &VFROM.16. &VTO.16.
 
-SET &VFROM = TRIM('B','&VFROM.EVAL', 16, ' ', 1, 'A16');
-SET &LEN=ARGLEN(16,'&VFROM.EVAL','I2');
-SET &VFROM = TRIM('B','&VFROM.EVAL', 16, ' ', 1, 'A&LEN.EVAL');
-SET &VFROM = IF '&VFROM.EVAL' EQ ' ' THEN 0.0 ELSE &VFROM;
 
 
-SET &VTO = TRIM('B','&VTO.EVAL', 16, ' ', 1, 'A16');
-SET &LEN=ARGLEN(16,'&VTO.EVAL','I2');
-SET &VTO = TRIM('B','&VTO.EVAL', 16, ' ', 1, 'A&LEN.EVAL');
-SET &VTO = IF '&VTO.EVAL' EQ ' ' THEN 0.0 ELSE &VTO;
 
-SET &TEMP = &VTO;
-SET &VTO = IF &VFROM GT &VTO THEN &VFROM ELSE &VTO;
-SET &VFROM = IF &VFROM GT &TEMP THEN &TEMP ELSE &VFROM;
 
-IF &PrevUDID EQ &VUDID THEN GOTO SameUDID1;
-SET &CNT = IF '&PrevUDID.EVAL' EQ '' AND &RECS2 EQ 0 THEN 100
- ELSE (100 + &RECS2 * 10);
 
-SET &WHERE.&CNT = IF &PrevUDID EQ '' THEN 'WHERE UDDATA.UDID EQ ' | '''&VUDID.EVAL'''
-                ELSE ' OR UDDATA.UDID EQ ' | '''&VUDID.EVAL''';
-SET &CNT = &CNT + 1;
-SET &WHERE.&CNT = ' AND NUD_DATA IS-FROM ' | '&VFROM.EVAL' || ' TO ' | '&VTO.EVAL';
 
-GOTO IncUDID1;
-SameUDID1
-SET &WHERE.&CNT = ' OR NUD_DATA IS-FROM ' | '&VFROM.EVAL' || ' TO ' | '&VTO.EVAL';
-IncUDID1
-SET &CNT = &CNT + 1;
-SET &PrevUDID='&VUDID.EVAL';
-TOUDID1
-CLOSE UDID09
 
-CHKUDID3
-IF &RECS3 EQ 0 THEN GOTO WRITEUDID;
-SET &CNT = IF &RECS1 EQ 0 AND &RECS2 EQ 0 THEN &STARTCOUNT ELSE &CNT;
 
-******************************************
-*Retrieve EQ, CONTAINS, OMITS
-******************************************
TABLE FILE &FILENAME
PRINT UDID UINCL UDDATA
BY UDID NOPRINT
BY UINCL NOPRINT
WHERE INST_KEY EQ &INST_KEY
WHERE UINCL EQ 1 OR 3 OR 4
ON TABLE HOLD AS UDID03 FORMAT ALPHA
END
-RUN
 
-SET &PrevUDID='';
-SET &PrevIncl='';
-REPEAT TOUDID3 &LINES TIMES
-READ UDID03 NOCLOSE &VUDID.3. &VINCL.1.  &VUDDATA.64.
 
-SET &OP = IF &VINCL EQ 1 THEN ' EQ '
-     ELSE IF &VINCL EQ 2 THEN ' NE '
-     ELSE IF &VINCL EQ 3 THEN ' CONTAINS '
-     ELSE IF &VINCL EQ 4 THEN ' OMITS ';
 
-SET &LEN=ARGLEN(64,'&VUDDATA.EVAL','I2');
-SET &VUDDATA = TRIM('T','&VUDDATA.EVAL', 64, ' ', 1, 'A&LEN.EVAL');
 
-IF &PrevUDID EQ &VUDID AND &PrevIncl NE &VINCL THEN GOTO SameUDIDOnl3;
-IF &PrevUDID EQ &VUDID AND &PrevIncl EQ &VINCL THEN GOTO SameUDOP3;
 
-SET &WHERE.&CNT = IF &VINCL EQ 2 THEN
- 'WHERE UDID NE ' | '''&VUDID.EVAL''' | ' OR UDID EQ ' | '''&VUDID.EVAL''' | ' AND AUD_DATA' | ' &OP.EVAL ' | '''&VUDDATA.EVAL'''
- ELSE 'WHERE UDID EQ ' | '''&VUDID.EVAL''' | ' AND AUD_DATA' | ' &OP.EVAL ' | '''&VUDDATA.EVAL''';
-GOTO IncUDID3;
 
-SameUDIDOnl3
-SET &WHERE.&CNT = ' OR UDID EQ ' | '''&VUDID.EVAL''' | ' AND AUD_DATA ' | ' &OP.EVAL ' | '''&VUDDATA.EVAL''';
-GOTO IncUDID2;
 
-SameUDOP3
-SET &WHERE.&CNT = ' OR ' | '''&VUDDATA.EVAL'''
 
-IncUDID3
-SET &CNT = &CNT + 1;
-SET &PrevUDID='&VUDID.EVAL';
-SET &PrevIncl = '&VINCL.EVAL';
-TOUDID3
-CLOSE UDID03
 
-WRITEUDID
-IF &RECS EQ 0 THEN GOTO FINUDID;
-******************************************************************************
-* Write conditions to Parm# files dynamically.  The files could contain
-* any number of lines. Each UDID is in a separate file.
-******************************************************************************
-SET &CNT = &STARTCOUNT;
-SET &CNT2 = 1;
-SET &LINE1 = 'Y';
-REPEAT FinWrite &TOTCOUNT TIMES
-SET &&DDNAME = 'UPARM' | '&CNT2.EVAL';
-SET &PRINTLINE = &WHERE.&CNT;
-IF &PRINTLINE EQ ' ' THEN GOTO NEXTLINE;
-SET &FIRST5 = SUBSTR(80, &PRINTLINE, 1, 5, 5, 'A5');
-IF &FIRST5 NE 'WHERE' THEN GOTO OLDFILE
- ELSE IF &LINE1 EQ 'Y' THEN GOTO OLDFILE
- ELSE GOTO NEWFILE;
-OLDFILE
-WRITE &&DDNAME &PRINTLINE
-SET &LINE1 = 'N';
-GOTO NEXTLINE;
-NEWFILE
-CLOSE &&DDNAME
-SET &CNT2 = &CNT2 + 1;
-SET &&DDNAME = 'UPARM' | '&CNT2.EVAL';
-WRITE &&DDNAME &PRINTLINE
-NEXTLINE
-SET &CNT = &CNT + 1;
 
-FinWrite
-CLOSE &&DDNAME
-******************************************************************************
-* the start to hold temp files based on UDID selections
-* the temp files will be TMPAUDID TMPCUDID TMPHUDID
-******************************************************************************
SET ALL=PASS
 
-IF '&&RPTGRP.EVAL' EQ 'AIR' OR 'ADD' OR 'DVR' THEN GOTO AUDIDRPT;
-IF '&&RPTGRP.EVAL' EQ 'CAR' OR 'CDD' THEN GOTO CUDIDRPT;
-IF '&&RPTGRP.EVAL' EQ 'LIM' OR 'LDD' THEN GOTO LUDIDRPT;
-IF '&&RPTGRP.EVAL' EQ 'HTL' OR 'HDD' THEN GOTO HUDIDRPT;
-IF '&&RPTGRP.EVAL' EQ 'EXC' OR 'OTH' OR 'QTR' THEN GOTO CHKUDGRP;
-GOTO EndUDIDRPT;
 
-CHKUDGRP
-IF &&UDIDGRP CONTAINS 'A' THEN GOTO AUDIDRPT;
-IF &&UDIDGRP CONTAINS 'C' THEN GOTO CUDIDRPT;
-IF &&UDIDGRP CONTAINS 'L' THEN GOTO LUDIDRPT;
-IF &&UDIDGRP CONTAINS 'H' THEN GOTO HUDIDRPT;
 
-AUDIDRPT
 
-**************************************************************
-* Air Reports
-**************************************************************
-SET &UDIDUSE = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\UA' | '&&COMPNY.EVAL' || '.FOC AS AIRUDID';
USE ADD
&UDIDUSE
END
 
-**********************************************************
-***  Process NOT EQUAL selections for Air
-***  &RECS2 contains number of NE selections
-**********************************************************
-SET &NOTEQ = 0;
-IF &RECS2 EQ 0 THEN GOTO CHK_AIR_EQ;
-IF &RECS2 EQ 1 THEN GOTO AUDID1NE;
-IF &RECS2 EQ 2 THEN GOTO AUDID2NE;
-IF &RECS2 EQ 3 THEN GOTO AUDID3NE;
-IF &RECS2 EQ 4 THEN GOTO AUDID4NE;
 
-AUDID1NE
TABLE FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM1
ON TABLE HOLD
END
MATCH FILE HOLD
BY AIR_KEY
RUN
FILE AIRUDID
BY AIR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_AIR_EQ;
 
 
-AUDID2NE
MATCH FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM1
RUN
FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE AIRUDID
BY AIR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_AIR_EQ;
 
-AUDID3NE
MATCH FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM1
RUN
FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE AIRUDID
BY AIR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_AIR_EQ;
 
-AUDID4NE
MATCH FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM1
RUN
FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM4
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE AIRUDID
BY AIR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_AIR_EQ;
-**********************************************************
-***  End of NOT EQUAL Air Report Process
-**********************************************************
 
-CHK_AIR_EQ
-**********************************************************
-*** Process EQ/CONTAIN selections for Air Report
-**********************************************************
-SET &EQUALS2 = &RECS1 + &RECS3;
-IF &EQUALS2 EQ 0 AND &NOTEQ GT 0 THEN GOTO HLDTMPAUDID
- ELSE IF &EQUALS2 EQ 0 AND &NOTEQ EQ 0 THEN GOTO EndAirUDID;
 
-*Else continue processing below, # represents the number of UPARM# files included.
-IF &EQUALS2 EQ 1 THEN GOTO AUDID1;
-IF &EQUALS2 EQ 2 THEN GOTO AUDID2;
-IF &EQUALS2 EQ 3 THEN GOTO AUDID3;
-IF &EQUALS2 EQ 4 THEN GOTO AUDID4;
-IF &EQUALS2 EQ 5 THEN GOTO AUDID5;
 
-AUDID1
TABLE FILE AIRUDID
BY AIR_KEY
-IF &RECS2 EQ 0 THEN GOTO A1PARM1;
-IF &RECS2 EQ 1 THEN GOTO A1PARM2;
-IF &RECS2 EQ 2 THEN GOTO A1PARM3;
-IF &RECS2 EQ 3 THEN GOTO A1PARM4;
-IF &RECS2 EQ 4 THEN GOTO A1PARM5;
-A1PARM1
-INCLUDE UPARM1
-GOTO A1PARMEND;
 
-A1PARM2
-INCLUDE UPARM2
-GOTO A1PARMEND;
 
-A1PARM3
-INCLUDE UPARM3
-GOTO A1PARMEND;
 
-A1PARM4
-INCLUDE UPARM4
-GOTO A1PARMEND;
 
-A1PARM5
-INCLUDE UPARM5
-GOTO A1PARMEND;
 
-A1PARMEND
 
ON TABLE HOLD AS EQHOLDA1
END
-RUN
-GOTO HLDTMPAUDID;
 
-AUDID2
MATCH FILE AIRUDID
BY AIR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO A2PARM1;
-IF &RECS2 EQ 1 THEN GOTO A2PARM2;
-IF &RECS2 EQ 2 THEN GOTO A2PARM3;
-IF &RECS2 EQ 3 THEN GOTO A2PARM4;
-A2PARM1
-INCLUDE UPARM1
-GOTO A2PARMEND;
 
-A2PARM2
-INCLUDE UPARM2
-GOTO A2PARMEND;
 
-A2PARM3
-INCLUDE UPARM3
-GOTO A2PARMEND;
 
-A2PARM4
-INCLUDE UPARM4
-GOTO A2PARMEND;
 
-A2PARMEND
RUN
FILE AIRUDID
BY AIR_KEY
-IF &RECS2 EQ 0 THEN GOTO A22PARM1;
-IF &RECS2 EQ 1 THEN GOTO A22PARM2;
-IF &RECS2 EQ 2 THEN GOTO A22PARM3;
-IF &RECS2 EQ 3 THEN GOTO A22PARM4;
 
-A22PARM1
-INCLUDE UPARM2
-GOTO A22PARMEND;
 
-A22PARM2
-INCLUDE UPARM3
-GOTO A22PARMEND;
 
-A22PARM3
-INCLUDE UPARM4
-GOTO A22PARMEND;
 
-A22PARM4
-INCLUDE UPARM5
-GOTO A22PARMEND;
 
-A22PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-GOTO HLDTMPAUDID;
 
-AUDID3
MATCH FILE AIRUDID
BY AIR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO A3PARM1;
-IF &RECS2 EQ 1 THEN GOTO A3PARM2;
-IF &RECS2 EQ 2 THEN GOTO A3PARM3;
-A3PARM1
-INCLUDE UPARM1
-GOTO A3PARMEND;
 
-A3PARM2
-INCLUDE UPARM2
-GOTO A3PARMEND;
 
-A3PARM3
-INCLUDE UPARM3
 
-A3PARMEND
RUN
FILE AIRUDID
BY AIR_KEY
-IF &RECS2 EQ 0 THEN GOTO A32PARM1;
-IF &RECS2 EQ 1 THEN GOTO A32PARM2;
-IF &RECS2 EQ 2 THEN GOTO A32PARM3;
 
-A32PARM1
-INCLUDE UPARM2
-GOTO A32PARMEND;
 
-A32PARM2
-INCLUDE UPARM3
-GOTO A32PARMEND;
 
-A32PARM3
-INCLUDE UPARM4
 
-A32PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE AIRUDID
BY AIR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO A33PARM1;
-IF &RECS2 EQ 1 THEN GOTO A33PARM2;
-IF &RECS2 EQ 2 THEN GOTO A33PARM3;
 
-A33PARM1
-INCLUDE UPARM3
-GOTO A33PARMEND;
 
-A33PARM2
-INCLUDE UPARM4
-GOTO A33PARMEND;
 
-A33PARM3
-INCLUDE UPARM5
-GOTO A33PARMEND;
 
-A33PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-GOTO HLDTMPAUDID;
 
-AUDID4
MATCH FILE AIRUDID
BY AIR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO A4PARM1;
-IF &RECS2 EQ 1 THEN GOTO A4PARM2;
 
-A4PARM1
-INCLUDE UPARM1
-GOTO A4PARMEND;
 
-A4PARM2
-INCLUDE UPARM2
 
-A4PARMEND
RUN
FILE AIRUDID
BY AIR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO A42PARM1;
-IF &RECS2 EQ 1 THEN GOTO A42PARM2;
 
-A42PARM1
-INCLUDE UPARM2
-GOTO A42PARMEND;
 
-A42PARM2
-INCLUDE UPARM3
 
-A42PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE AIRUDID
BY AIR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO A43PARM1;
-IF &RECS2 EQ 1 THEN GOTO A43PARM2;
 
-A43PARM1
-INCLUDE UPARM3
-GOTO A43PARMEND;
 
-A43PARM2
-INCLUDE UPARM4
 
-A43PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE AIRUDID
BY AIR_KEY
-IF &RECS2 EQ 0 THEN GOTO A53PARM1;
-IF &RECS2 EQ 1 THEN GOTO A53PARM2;
 
-A53PARM1
-INCLUDE UPARM4
-GOTO A53PARMEND;
 
-A53PARM2
-INCLUDE UPARM5
 
-A53PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
 
END
-RUN
-GOTO HLDTMPAUDID;
 
-AUDID5
MATCH FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM1
RUN
FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM4
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE AIRUDID
BY AIR_KEY
-INCLUDE UPARM5
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-**********************************************************
-*** The End of EQ/CONTAIN selections for Air Report
-**********************************************************
 
-HLDTMPAUDID
-IF &LINES EQ 0 AND &RECS2 EQ 0 THEN GOTO EndAirUDID;
-**********************************************************
-*** Combine EQ/CONTAIN, NE selections for Air Report
-**********************************************************
-IF &EQUALS2 EQ 0 AND &RECS2 NE 0 THEN GOTO AIR_NEONLY;
-IF &EQUALS2 NE 0 AND &LINES NE 0 AND &RECS2 NE 0 THEN GOTO AIR_EQNE;
-IF &RECS2 EQ 0 THEN GOTO AIR_EQONLY ELSE GOTO EndAirUDID;
 
-AIR_NEONLY
TABLE FILE NEHOLDA2
BY AIR_KEY
ON TABLE HOLD AS HOLDUD2
END
-RUN
-GOTO AIRHOLDUD2;
 
-IF (&RECS2 EQ 0 OR &EQUALS2 EQ 0) THEN GOTO AIRHOLDUD2;
-*Combine EQ and NE together
-AIR_EQNE
MATCH FILE NEHOLDA2
BY AIR_KEY
RUN
FILE EQHOLDA1
BY AIR_KEY
AFTER MATCH HOLD AS HOLDUD2 OLD-AND-NEW
END
-RUN
-GOTO AIRHOLDUD2;
 
-AIR_EQONLY
TABLE FILE EQHOLDA1
BY AIR_KEY
ON TABLE HOLD AS HOLDUD2
END
-RUN
 
-AIRHOLDUD2
TABLE FILE HOLDUD2
BY AIR_KEY
ON TABLE HOLD
END
-RUN
-IF &LINES EQ 0 THEN GOTO EndAirUDID;
 
MODIFY FILE TMPAUDID
FIXFORM AIR_KEY/45
MATCH AIR_KEY
  ON MATCH REJECT
  ON NOMATCH INCLUDE
DATA ON HOLD
END
-RUN
 
-EndAirUDID
 
-IF &&RPTGRP EQ 'AIR' OR 'ADD' THEN GOTO EndUDIDRPT;
-IF &&UDIDGRP CONTAINS 'C' THEN GOTO CUDIDRPT;
-IF &&UDIDGRP CONTAINS 'H' THEN GOTO HUDIDRPT ELSE GOTO EndUDIDRPT;
-**************************************************************
-* The End of Air Reports
-**************************************************************
 
-CUDIDRPT
-**************************************************************
-* Car Reports
-**************************************************************
-SET &UDIDUSE = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\UC' | '&&COMPNY.EVAL' || '.FOC AS CARUDID';
USE ADD
&UDIDUSE
END
 
-**********************************************************
-***  Process NOT EQUAL selections for Car
-***  &RECS2 contains number of NE selections
-**********************************************************
-SET &NOTEQ = 0;
-IF &RECS2 EQ 0 THEN GOTO CHK_CAR_EQ;
-IF &RECS2 EQ 1 THEN GOTO CUDID1NE;
-IF &RECS2 EQ 2 THEN GOTO CUDID2NE;
-IF &RECS2 EQ 3 THEN GOTO CUDID3NE;
-IF &RECS2 EQ 4 THEN GOTO CUDID4NE;
 
-CUDID1NE
TABLE FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM1
ON TABLE HOLD
END
MATCH FILE HOLD
BY CAR_KEY
RUN
FILE CARUDID
BY CAR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_CAR_EQ;
 
 
-CUDID2NE
MATCH FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM1
RUN
FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE CARUDID
BY CAR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_CAR_EQ;
 
-CUDID3NE
MATCH FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM1
RUN
FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE CARUDID
BY CAR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_CAR_EQ;
 
-CUDID4NE
MATCH FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM1
RUN
FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM4
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE CARUDID
BY CAR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_CAR_EQ;
-**********************************************************
-***  End of NOT EQUAL Car Report Process
-**********************************************************
 
-CHK_CAR_EQ
-**********************************************************
-*** Process EQ/CONTAIN selections for Car Report
-**********************************************************
-SET &EQUALS2 = &RECS1 + &RECS3;
-IF &EQUALS2 EQ 0 AND &NOTEQ GT 0 THEN GOTO HLDTMPCUDID
- ELSE IF &EQUALS2 EQ 0 AND &NOTEQ EQ 0 THEN GOTO EndCARUDID;
 
-*Else continue processing below, # represents the number of UPARM# files included.
-IF &EQUALS2 EQ 1 THEN GOTO CUDID1;
-IF &EQUALS2 EQ 2 THEN GOTO CUDID2;
-IF &EQUALS2 EQ 3 THEN GOTO CUDID3;
-IF &EQUALS2 EQ 4 THEN GOTO CUDID4;
-IF &EQUALS2 EQ 5 THEN GOTO CUDID5;
 
-CUDID1
TABLE FILE CARUDID
BY CAR_KEY
-IF &RECS2 EQ 0 THEN GOTO C1PARM1;
-IF &RECS2 EQ 1 THEN GOTO C1PARM2;
-IF &RECS2 EQ 2 THEN GOTO C1PARM3;
-IF &RECS2 EQ 3 THEN GOTO C1PARM4;
-IF &RECS2 EQ 4 THEN GOTO C1PARM5;
-C1PARM1
-INCLUDE UPARM1
-GOTO C1PARMEND;
 
-C1PARM2
-INCLUDE UPARM2
-GOTO C1PARMEND;
 
-C1PARM3
-INCLUDE UPARM3
-GOTO C1PARMEND;
 
-C1PARM4
-INCLUDE UPARM4
-GOTO C1PARMEND;
 
-C1PARM5
-INCLUDE UPARM5
 
-C1PARMEND
ON TABLE HOLD AS EQHOLDA1
END
-RUN
-GOTO HLDTMPCUDID;
 
-CUDID2
MATCH FILE CARUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO C2PARM1;
-IF &RECS2 EQ 1 THEN GOTO C2PARM2;
-IF &RECS2 EQ 2 THEN GOTO C2PARM3;
-IF &RECS2 EQ 3 THEN GOTO C2PARM4;
-C2PARM1
-INCLUDE UPARM1
-GOTO C2PARMEND;
 
-C2PARM2
-INCLUDE UPARM2
-GOTO C2PARMEND;
 
-C2PARM3
-INCLUDE UPARM3
-GOTO C2PARMEND;
 
-C2PARM4
-INCLUDE UPARM4
-GOTO C2PARMEND;
 
-C2PARMEND
RUN
FILE CARUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO C22PARM1;
-IF &RECS2 EQ 1 THEN GOTO C22PARM2;
-IF &RECS2 EQ 2 THEN GOTO C22PARM3;
-IF &RECS2 EQ 3 THEN GOTO C22PARM4;
 
-C22PARM1
-INCLUDE UPARM2
-GOTO C22PARMEND;
 
-C22PARM2
-INCLUDE UPARM3
-GOTO C22PARMEND;
 
-C22PARM3
-INCLUDE UPARM4
-GOTO C22PARMEND;
 
-C22PARM4
-INCLUDE UPARM5
-GOTO C22PARMEND;
 
-C22PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-GOTO HLDTMPCUDID;
 
-CUDID3
MATCH FILE CARUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO C3PARM1;
-IF &RECS2 EQ 1 THEN GOTO C3PARM2;
-IF &RECS2 EQ 2 THEN GOTO C3PARM3;
-C3PARM1
-INCLUDE UPARM1
-GOTO C3PARMEND;
 
-C3PARM2
-INCLUDE UPARM2
-GOTO C3PARMEND;
 
-C3PARM3
-INCLUDE UPARM3
 
-C3PARMEND
RUN
FILE CARUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO C32PARM1;
-IF &RECS2 EQ 1 THEN GOTO C32PARM2;
-IF &RECS2 EQ 2 THEN GOTO C32PARM3;
 
-C32PARM1
-INCLUDE UPARM2
-GOTO C32PARMEND;
 
-C32PARM2
-INCLUDE UPARM3
-GOTO C32PARMEND;
 
-C32PARM3
-INCLUDE UPARM4
 
-C32PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE CARUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO C33PARM1;
-IF &RECS2 EQ 1 THEN GOTO C33PARM2;
-IF &RECS2 EQ 2 THEN GOTO C33PARM3;
 
-C33PARM1
-INCLUDE UPARM3
-GOTO C33PARMEND;
 
-C33PARM2
-INCLUDE UPARM4
-GOTO C33PARMEND;
 
-C33PARM3
-INCLUDE UPARM5
-GOTO C33PARMEND;
 
-C33PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-GOTO HLDTMPCUDID;
 
-CUDID4
MATCH FILE CARUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO C4PARM1;
-IF &RECS2 EQ 1 THEN GOTO C4PARM2;
 
-C4PARM1
-INCLUDE UPARM1
-GOTO C4PARMEND;
 
-C4PARM2
-INCLUDE UPARM2
 
-C4PARMEND
RUN
FILE CARUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO C42PARM1;
-IF &RECS2 EQ 1 THEN GOTO C42PARM2;
 
-C42PARM1
-INCLUDE UPARM2
-GOTO C42PARMEND;
 
-C42PARM2
-INCLUDE UPARM3
 
-C42PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE CARUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO C43PARM1;
-IF &RECS2 EQ 1 THEN GOTO C43PARM2;
 
-C43PARM1
-INCLUDE UPARM3
-GOTO C43PARMEND;
 
-C43PARM2
-INCLUDE UPARM4
 
-C43PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE CARUDID
BY CAR_KEY
-IF &RECS2 EQ 0 THEN GOTO C53PARM1;
-IF &RECS2 EQ 1 THEN GOTO C53PARM2;
 
-C53PARM1
-INCLUDE UPARM4
-GOTO C53PARMEND;
 
-C53PARM2
-INCLUDE UPARM5
 
-C53PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
 
END
-RUN
-GOTO HLDTMPCUDID;
 
-CUDID5
MATCH FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM1
RUN
FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM4
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE CARUDID
BY CAR_KEY
-INCLUDE UPARM5
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-**********************************************************
-*** The End of EQ/CONTAIN selections for Car Report
-**********************************************************
 
-HLDTMPCUDID
-IF &LINES EQ 0 AND &RECS2 EQ 0 THEN GOTO EndCARUDID;
-**********************************************************
-*** Combine EQ/CONTAIN, NE selections for Car Report
-**********************************************************
-IF &EQUALS2 EQ 0 AND &RECS2 NE 0 THEN GOTO CAR_NEONLY;
-IF &EQUALS2 NE 0 AND &LINES NE 0 AND &RECS2 NE 0 THEN GOTO CAR_EQNE;
-IF &RECS2 EQ 0 THEN GOTO CAR_EQONLY ELSE GOTO EndCARUDID;
 
-CAR_NEONLY
TABLE FILE NEHOLDA2
BY CAR_KEY
ON TABLE HOLD AS HOLDUD2
END
-RUN
-GOTO CARHOLDUD2;
 
-IF (&RECS2 EQ 0 OR &EQUALS2 EQ 0) THEN GOTO CARHOLDUD2;
-*Combine EQ and NE together
-CAR_EQNE
MATCH FILE NEHOLDA2
BY CAR_KEY
RUN
FILE EQHOLDA1
BY CAR_KEY
AFTER MATCH HOLD AS HOLDUD2 OLD-AND-NEW
END
-RUN
-GOTO CARHOLDUD2;
 
-CAR_EQONLY
TABLE FILE EQHOLDA1
BY CAR_KEY
ON TABLE HOLD AS HOLDUD2
END
-RUN
 
-CARHOLDUD2
TABLE FILE HOLDUD2
BY CAR_KEY
ON TABLE HOLD
END
-RUN
-IF &LINES EQ 0 THEN GOTO EndCARUDID;
 
MODIFY FILE TMPCUDID
FIXFORM CAR_KEY/82
MATCH CAR_KEY
  ON MATCH REJECT
  ON NOMATCH INCLUDE
DATA ON HOLD
END
-RUN
 
-EndCARUDID
-**************************************************************
-* The End of Car Reports
-**************************************************************
-IF &&RPTGRP EQ 'CAR' OR 'CDD' THEN GOTO EndUDIDRPT;
-IF &&UDIDGRP CONTAINS 'H' THEN GOTO HUDIDRPT ELSE GOTO EndUDIDRPT;
 
-HUDIDRPT
-**************************************************************
-* Hotel Reports
-**************************************************************
-SET &UDIDUSE = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\UH' | '&&COMPNY.EVAL' || '.FOC AS HTLUDID';
USE ADD
&UDIDUSE
END
 
-**********************************************************
-***  Process NOT EQUAL selections for Hotel
-***  &RECS2 contains number of NE selections
-**********************************************************
-SET &NOTEQ = 0;
-IF &RECS2 EQ 0 THEN GOTO CHK_HTL_EQ;
-IF &RECS2 EQ 1 THEN GOTO HUDID1NE;
-IF &RECS2 EQ 2 THEN GOTO HUDID2NE;
-IF &RECS2 EQ 3 THEN GOTO HUDID3NE;
-IF &RECS2 EQ 4 THEN GOTO HUDID4NE;
 
-HUDID1NE
TABLE FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM1
ON TABLE HOLD
END
MATCH FILE HOLD
BY HTL_KEY
RUN
FILE HTLUDID
BY HTL_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_HTL_EQ;
 
-HUDID2NE
MATCH FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM1
RUN
FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE HTLUDID
BY HTL_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_HTL_EQ;
 
-HUDID3NE
MATCH FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM1
RUN
FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE HTLUDID
BY HTL_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_HTL_EQ;
 
-HUDID4NE
MATCH FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM1
RUN
FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM4
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE HTLUDID
BY HTL_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_HTL_EQ;
-**********************************************************
-***  End of NOT EQUAL Hotel Report Process
-**********************************************************
 
-CHK_HTL_EQ
-**********************************************************
-*** Process EQ/CONTAIN selections for Hotel Report
-**********************************************************
-SET &EQUALS2 = &RECS1 + &RECS3;
-IF &EQUALS2 EQ 0 AND &NOTEQ GT 0 THEN GOTO HLDTMPHUDID
- ELSE IF &EQUALS2 EQ 0 AND &NOTEQ EQ 0 THEN GOTO EndHTLUDID;
 
-*Else continue processing below, # represents the number of UPARM# files included.
-IF &EQUALS2 EQ 1 THEN GOTO HUDID1;
-IF &EQUALS2 EQ 2 THEN GOTO HUDID2;
-IF &EQUALS2 EQ 3 THEN GOTO HUDID3;
-IF &EQUALS2 EQ 4 THEN GOTO HUDID4;
-IF &EQUALS2 EQ 5 THEN GOTO HUDID5;
 
-HUDID1
TABLE FILE HTLUDID
BY HTL_KEY
-IF &RECS2 EQ 0 THEN GOTO H1PARM1;
-IF &RECS2 EQ 1 THEN GOTO H1PARM2;
-IF &RECS2 EQ 2 THEN GOTO H1PARM3;
-IF &RECS2 EQ 3 THEN GOTO H1PARM4;
-IF &RECS2 EQ 4 THEN GOTO H1PARM5;
-H1PARM1
-INCLUDE UPARM1
-GOTO H1PARMEND;
 
-H1PARM2
-INCLUDE UPARM2
-GOTO H1PARMEND;
 
-H1PARM3
-INCLUDE UPARM3
-GOTO H1PARMEND;
 
-H1PARM4
-INCLUDE UPARM4
-GOTO H1PARMEND;
 
-H1PARM5
-INCLUDE UPARM5
 
-H1PARMEND
ON TABLE HOLD AS EQHOLDA1
END
-RUN
-GOTO HLDTMPHUDID;
 
-HUDID2
MATCH FILE HTLUDID
BY HTL_KEY
 
-IF &RECS2 EQ 0 THEN GOTO H2PARM1;
-IF &RECS2 EQ 1 THEN GOTO H2PARM2;
-IF &RECS2 EQ 2 THEN GOTO H2PARM3;
-IF &RECS2 EQ 3 THEN GOTO H2PARM4;
-H2PARM1
-INCLUDE UPARM1
-GOTO H2PARMEND;
 
-H2PARM2
-INCLUDE UPARM2
-GOTO H2PARMEND;
 
-H2PARM3
-INCLUDE UPARM3
-GOTO H2PARMEND;
 
-H2PARM4
-INCLUDE UPARM4
-GOTO H2PARMEND;
 
-H2PARMEND
RUN
FILE HTLUDID
BY HTL_KEY
-IF &RECS2 EQ 0 THEN GOTO H22PARM1;
-IF &RECS2 EQ 1 THEN GOTO H22PARM2;
-IF &RECS2 EQ 2 THEN GOTO H22PARM3;
-IF &RECS2 EQ 3 THEN GOTO H22PARM4;
 
-H22PARM1
-INCLUDE UPARM2
-GOTO H22PARMEND;
 
-H22PARM2
-INCLUDE UPARM3
-GOTO H22PARMEND;
 
-H22PARM3
-INCLUDE UPARM4
-GOTO H22PARMEND;
 
-H22PARM4
-INCLUDE UPARM5
-GOTO H22PARMEND;
 
-H22PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-GOTO HLDTMPHUDID;
 
-HUDID3
MATCH FILE HTLUDID
BY HTL_KEY
 
-IF &RECS2 EQ 0 THEN GOTO H3PARM1;
-IF &RECS2 EQ 1 THEN GOTO H3PARM2;
-IF &RECS2 EQ 2 THEN GOTO H3PARM3;
-H3PARM1
-INCLUDE UPARM1
-GOTO H3PARMEND;
 
-H3PARM2
-INCLUDE UPARM2
-GOTO H3PARMEND;
 
-H3PARM3
-INCLUDE UPARM3
 
-H3PARMEND
RUN
FILE HTLUDID
BY HTL_KEY
 
-IF &RECS2 EQ 0 THEN GOTO H32PARM1;
-IF &RECS2 EQ 1 THEN GOTO H32PARM2;
-IF &RECS2 EQ 2 THEN GOTO H32PARM3;
 
-H32PARM1
-INCLUDE UPARM2
-GOTO H32PARMEND;
 
-H32PARM2
-INCLUDE UPARM3
-GOTO H32PARMEND;
 
-H32PARM3
-INCLUDE UPARM4
 
-H32PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE HTLUDID
BY HTL_KEY
 
-IF &RECS2 EQ 0 THEN GOTO H33PARM1;
-IF &RECS2 EQ 1 THEN GOTO H33PARM2;
-IF &RECS2 EQ 2 THEN GOTO H33PARM3;
 
-H33PARM1
-INCLUDE UPARM3
-GOTO H33PARMEND;
 
-H33PARM2
-INCLUDE UPARM4
-GOTO H33PARMEND;
 
-H33PARM3
-INCLUDE UPARM5
-GOTO H33PARMEND;
 
-H33PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-GOTO HLDTMPHUDID;
 
-HUDID4
MATCH FILE HTLUDID
BY HTL_KEY
 
-IF &RECS2 EQ 0 THEN GOTO H4PARM1;
-IF &RECS2 EQ 1 THEN GOTO H4PARM2;
 
-H4PARM1
-INCLUDE UPARM1
-GOTO H4PARMEND;
 
-H4PARM2
-INCLUDE UPARM2
 
-H4PARMEND
RUN
FILE HTLUDID
BY HTL_KEY
 
-IF &RECS2 EQ 0 THEN GOTO H42PARM1;
-IF &RECS2 EQ 1 THEN GOTO H42PARM2;
 
-H42PARM1
-INCLUDE UPARM2
-GOTO H42PARMEND;
 
-H42PARM2
-INCLUDE UPARM3
 
-H42PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE HTLUDID
BY HTL_KEY
 
-IF &RECS2 EQ 0 THEN GOTO H43PARM1;
-IF &RECS2 EQ 1 THEN GOTO H43PARM2;
 
-H43PARM1
-INCLUDE UPARM3
-GOTO H43PARMEND;
 
-H43PARM2
-INCLUDE UPARM4
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
-H43PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE HTLUDID
BY HTL_KEY
-IF &RECS2 EQ 0 THEN GOTO H53PARM1;
-IF &RECS2 EQ 1 THEN GOTO H53PARM2;
 
-H53PARM1
-INCLUDE UPARM4
-GOTO H53PARMEND;
 
-H53PARM2
-INCLUDE UPARM5
 
-H53PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
 
END
-RUN
-GOTO HLDTMPHUDID;
 
-HUDID5
MATCH FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM1
RUN
FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM4
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE HTLUDID
BY HTL_KEY
-INCLUDE UPARM5
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-**********************************************************
-*** The End of EQ/CONTAIN selections for Hotel Report
-**********************************************************
 
-HLDTMPHUDID
-IF &LINES EQ 0 AND &RECS2 EQ 0 THEN GOTO EndHTLUDID;
-**********************************************************
-*** Combine EQ/CONTAIN, NE selections for Car Report
-**********************************************************
-IF &EQUALS2 EQ 0 AND &RECS2 NE 0 THEN GOTO HTL_NEONLY;
-IF &EQUALS2 NE 0 AND &LINES NE 0 AND &RECS2 NE 0 THEN GOTO HTL_EQNE;
-IF &RECS2 EQ 0 THEN GOTO HTL_EQONLY ELSE GOTO EndHTLUDID;
 
-HTL_NEONLY
TABLE FILE NEHOLDA2
BY HTL_KEY
ON TABLE HOLD AS HOLDUD2
END
-RUN
-GOTO HTLHOLDUD2;
-IF (&RECS2 EQ 0 OR &EQUALS2 EQ 0) THEN GOTO HTLHOLDUD2;
-*Combine EQ and NE together
-HTL_EQNE
MATCH FILE NEHOLDA2
BY HTL_KEY
RUN
FILE EQHOLDA1
BY HTL_KEY
AFTER MATCH HOLD AS HOLDUD2 OLD-AND-NEW
END
-RUN
-GOTO HTLHOLDUD2;
 
-HTL_EQONLY
TABLE FILE EQHOLDA1
BY HTL_KEY
ON TABLE HOLD AS HOLDUD2
END
-RUN
 
-HTLHOLDUD2
TABLE FILE HOLDUD2
BY HTL_KEY
ON TABLE HOLD
END
-RUN
-IF &LINES EQ 0 THEN GOTO EndHTLUDID;
 
MODIFY FILE TMPHUDID
FIXFORM HTL_KEY/69
MATCH HTL_KEY
  ON MATCH REJECT
  ON NOMATCH INCLUDE
DATA ON HOLD
END
-RUN
 
-EndHTLUDID
-**************************************************************
-* The End of Hotel Reports
-**************************************************************
-IF &&RPTGRP EQ 'HTL' OR 'HDD' THEN GOTO EndUDIDRPT;
-IF &&UDIDGRP CONTAINS 'L' THEN GOTO LUDIDRPT ELSE GOTO EndUDIDRPT;
 
 
-******start limo**********************************************
-LUDIDRPT
-**************************************************************
-* LIMO Reports
-**************************************************************
-SET &UDIDUSE = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\UL' | '&&COMPNY.EVAL' || '.FOC AS LIMUDID';
USE ADD
&UDIDUSE
END
 
-**********************************************************
-***  Process NOT EQUAL selections for limo
-***  &RECS2 contains number of NE selections
-**********************************************************
-SET &NOTEQ = 0;
-IF &RECS2 EQ 0 THEN GOTO CHK_LIM_EQ;
-IF &RECS2 EQ 1 THEN GOTO LUDID1NE;
-IF &RECS2 EQ 2 THEN GOTO LUDID2NE;
-IF &RECS2 EQ 3 THEN GOTO LUDID3NE;
-IF &RECS2 EQ 4 THEN GOTO LUDID4NE;
 
-LUDID1NE
TABLE FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM1
ON TABLE HOLD
END
MATCH FILE HOLD
BY CAR_KEY
RUN
FILE LIMUDID
BY CAR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_LIM_EQ;
 
 
-LUDID2NE
MATCH FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM1
RUN
FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE LIMUDID
BY CAR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_LIM_EQ;
 
-LUDID3NE
MATCH FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM1
RUN
FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE LIMUDID
BY CAR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_LIM_EQ;
 
-LUDID4NE
MATCH FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM1
RUN
FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM4
AFTER MATCH HOLD OLD-OR-NEW
RUN
FILE LIMUDID
BY CAR_KEY
AFTER MATCH HOLD AS NEHOLDA2 NEW-NOT-OLD
END
-RUN
-SET &NOTEQ = &LINES;
-GOTO CHK_LIM_EQ;
-**********************************************************
-***  End of NOT EQUAL LIMO Report Process
-**********************************************************
 
-CHK_LIM_EQ
-**********************************************************
-*** Process EQ/CONTAIN selections for Limo Report
-**********************************************************
-SET &EQUALS2 = &RECS1 + &RECS3;
-IF &EQUALS2 EQ 0 AND &NOTEQ GT 0 THEN GOTO HLDTMPLUDID
- ELSE IF &EQUALS2 EQ 0 AND &NOTEQ EQ 0 THEN GOTO EndLIMUDID;
 
-*Else continue processing below, # represents the number of UPARM# files included.
-IF &EQUALS2 EQ 1 THEN GOTO LUDID1;
-IF &EQUALS2 EQ 2 THEN GOTO LUDID2;
-IF &EQUALS2 EQ 3 THEN GOTO LUDID3;
-IF &EQUALS2 EQ 4 THEN GOTO LUDID4;
-IF &EQUALS2 EQ 5 THEN GOTO LUDID5;
 
-LUDID1
TABLE FILE LIMUDID
BY CAR_KEY
-IF &RECS2 EQ 0 THEN GOTO L1PARM1;
-IF &RECS2 EQ 1 THEN GOTO L1PARM2;
-IF &RECS2 EQ 2 THEN GOTO L1PARM3;
-IF &RECS2 EQ 3 THEN GOTO L1PARM4;
-IF &RECS2 EQ 4 THEN GOTO L1PARM5;
-L1PARM1
-INCLUDE UPARM1
-GOTO L1PARMEND;
 
-L1PARM2
-INCLUDE UPARM2
-GOTO L1PARMEND;
 
-L1PARM3
-INCLUDE UPARM3
-GOTO L1PARMEND;
 
-L1PARM4
-INCLUDE UPARM4
-GOTO L1PARMEND;
 
-L1PARM5
-INCLUDE UPARM5
 
-L1PARMEND
ON TABLE HOLD AS EQHOLDA1
END
-RUN
-GOTO HLDTMPLUDID;
 
-LUDID2
MATCH FILE LIMUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO L2PARM1;
-IF &RECS2 EQ 1 THEN GOTO L2PARM2;
-IF &RECS2 EQ 2 THEN GOTO L2PARM3;
-IF &RECS2 EQ 3 THEN GOTO L2PARM4;
-L2PARM1
-INCLUDE UPARM1
-GOTO L2PARMEND;
 
-L2PARM2
-INCLUDE UPARM2
-GOTO L2PARMEND;
 
-L2PARM3
-INCLUDE UPARM3
-GOTO L2PARMEND;
 
-L2PARM4
-INCLUDE UPARM4
-GOTO L2PARMEND;
 
-L2PARMEND
RUN
FILE LIMUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO L22PARM1;
-IF &RECS2 EQ 1 THEN GOTO L22PARM2;
-IF &RECS2 EQ 2 THEN GOTO L22PARM3;
-IF &RECS2 EQ 3 THEN GOTO L22PARM4;
 
-L22PARM1
-INCLUDE UPARM2
-GOTO L22PARMEND;
 
-L22PARM2
-INCLUDE UPARM3
-GOTO L22PARMEND;
 
-L22PARM3
-INCLUDE UPARM4
-GOTO L22PARMEND;
 
-L22PARM4
-INCLUDE UPARM5
-GOTO L22PARMEND;
 
-L22PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-GOTO HLDTMPLUDID;
 
-LUDID3
MATCH FILE LIMUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO L3PARM1;
-IF &RECS2 EQ 1 THEN GOTO L3PARM2;
-IF &RECS2 EQ 2 THEN GOTO L3PARM3;
-L3PARM1
-INCLUDE UPARM1
-GOTO L3PARMEND;
 
-L3PARM2
-INCLUDE UPARM2
-GOTO L3PARMEND;
 
-L3PARM3
-INCLUDE UPARM3
 
-L3PARMEND
RUN
FILE LIMUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO L32PARM1;
-IF &RECS2 EQ 1 THEN GOTO L32PARM2;
-IF &RECS2 EQ 2 THEN GOTO L32PARM3;
 
-L32PARM1
-INCLUDE UPARM2
-GOTO L32PARMEND;
 
-L32PARM2
-INCLUDE UPARM3
-GOTO L32PARMEND;
 
-L32PARM3
-INCLUDE UPARM4
 
-L32PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE LIMUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO L33PARM1;
-IF &RECS2 EQ 1 THEN GOTO L33PARM2;
-IF &RECS2 EQ 2 THEN GOTO L33PARM3;
 
-L33PARM1
-INCLUDE UPARM3
-GOTO L33PARMEND;
 
-L33PARM2
-INCLUDE UPARM4
-GOTO L33PARMEND;
 
-L33PARM3
-INCLUDE UPARM5
-GOTO L33PARMEND;
 
-L33PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-GOTO HLDTMPLUDID;
 
-LUDID4
MATCH FILE LIMUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO L4PARM1;
-IF &RECS2 EQ 1 THEN GOTO L4PARM2;
 
-L4PARM1
-INCLUDE UPARM1
-GOTO L4PARMEND;
 
-L4PARM2
-INCLUDE UPARM2
 
-L4PARMEND
RUN
FILE LIMUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO L42PARM1;
-IF &RECS2 EQ 1 THEN GOTO L42PARM2;
 
-L42PARM1
-INCLUDE UPARM2
-GOTO L42PARMEND;
 
-L42PARM2
-INCLUDE UPARM3
 
-L42PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE LIMUDID
BY CAR_KEY
 
-IF &RECS2 EQ 0 THEN GOTO L43PARM1;
-IF &RECS2 EQ 1 THEN GOTO L43PARM2;
 
-L43PARM1
-INCLUDE UPARM3
-GOTO L43PARMEND;
 
-L43PARM2
-INCLUDE UPARM4
 
-L43PARMEND
AFTER MATCH HOLD OLD-AND-NEW
RUN
 
FILE LIMUDID
BY CAR_KEY
-IF &RECS2 EQ 0 THEN GOTO L53PARM1;
-IF &RECS2 EQ 1 THEN GOTO L53PARM2;
 
-L53PARM1
-INCLUDE UPARM4
-GOTO L53PARMEND;
 
-L53PARM2
-INCLUDE UPARM5
 
-L53PARMEND
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
 
END
-RUN
-GOTO HLDTMPLUDID;
 
-LUDID5
MATCH FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM1
RUN
FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM2
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM3
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM4
AFTER MATCH HOLD OLD-AND-NEW
RUN
FILE LIMUDID
BY CAR_KEY
-INCLUDE UPARM5
AFTER MATCH HOLD AS EQHOLDA1 OLD-AND-NEW
END
-RUN
-**********************************************************
-*** The End of EQ/CONTAIN selections for LIMO Report
-**********************************************************
 
-HLDTMPLUDID
-IF &LINES EQ 0 AND &RECS2 EQ 0 THEN GOTO EndLIMUDID;
-**********************************************************
-*** Combine EQ/CONTAIN, NE selections for LIMO Report
-**********************************************************
-IF &EQUALS2 EQ 0 AND &RECS2 NE 0 THEN GOTO LIM_NEONLY;
-IF &EQUALS2 NE 0 AND &LINES NE 0 AND &RECS2 NE 0 THEN GOTO LIM_EQNE;
-IF &RECS2 EQ 0 THEN GOTO LIM_EQONLY ELSE GOTO EndLIMUDID;
 
-LIM_NEONLY
TABLE FILE NEHOLDA2
BY CAR_KEY
ON TABLE HOLD AS HOLDUD2
END
-RUN
-GOTO LIMHOLDUD2;
 
-IF (&RECS2 EQ 0 OR &EQUALS2 EQ 0) THEN GOTO LIMHOLDUD2;
-*Combine EQ and NE together
-LIM_EQNE
MATCH FILE NEHOLDA2
BY CAR_KEY
RUN
FILE EQHOLDA1
BY CAR_KEY
AFTER MATCH HOLD AS HOLDUD2 OLD-AND-NEW
END
-RUN
-GOTO LIMHOLDUD2;
 
-LIM_EQONLY
TABLE FILE EQHOLDA1
BY CAR_KEY
ON TABLE HOLD AS HOLDUD2
END
-RUN
 
-LIMHOLDUD2
TABLE FILE HOLDUD2
BY CAR_KEY
ON TABLE HOLD
END
-RUN
-IF &LINES EQ 0 THEN GOTO EndLIMUDID;
 
MODIFY FILE TMPLUDID
FIXFORM CAR_KEY/82
MATCH CAR_KEY
  ON MATCH REJECT
  ON NOMATCH INCLUDE
DATA ON HOLD
END
-RUN
 
-EndLIMUDID
-**************************************************************
-* The End of LIMO Reports
-**************************************************************
 
-EndUDIDRPT
-*-QUIT
SET ALL=OFF
-RUN
