-* JK added code to select only tnt_company eq 1 or 2 2/21/05
-INCLUDE SETECHO
SET ASNAMES = ON
-*========================================================================
-*           PERFORM DATA EXTRACT FOR CLIENT DETERMINED IN STEP3
-*========================================================================
DEFINE FILE CR_50
  GROSS_BOOK/D8 = IF DAILY_RATE GE 0 THEN 1 ELSE 0;
  RENTAL_DAYS/D12 =  IF (NUM_DAYS LT 0) AND (NUM_CARS LT 0) THEN
                  ((NUM_DAYS * NUM_CARS) * (-1)) ELSE NUM_DAYS * NUM_CARS;  
  INTL_DOM/A1 =IF (PICK_CTY.INTL_DOM EQ 'I') THEN 'I' ELSE 'D';
  
  
-* DEFINES ON PREVIOUS DEFINES

  DGROSS_BOOK/D12CS = IF INTL_DOM EQ 'D' THEN GROSS_BOOK ELSE 0;
  IGROSS_BOOK/D12CS = IF INTL_DOM EQ 'I' THEN GROSS_BOOK ELSE 0;
  DRENTAL_DAYS/D12CS = IF INTL_DOM EQ 'D' THEN RENTAL_DAYS ELSE 0;
  IRENTAL_DAYS/D12CS = IF INTL_DOM EQ 'I' THEN RENTAL_DAYS ELSE 0;
  DRENTAL_AMT/D12.2CSM = IF INTL_DOM EQ 'D' THEN RENTAL_AMT ELSE 0;
  IRENTAL_AMT/D12.2CSM = IF INTL_DOM EQ 'I' THEN RENTAL_AMT ELSE 0;
  
                  
END

TABLEF FILE CR_50
PRINT DGROSS_BOOK
  DRENTAL_AMT	
  DRENTAL_DAYS 
  IGROSS_BOOK
  IRENTAL_AMT	
  IRENTAL_DAYS  
 WHERE INVOICE_DATE GE &&FROMDT.EVAL AND INVOICE_DATE LE &&TODT.EVAL
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10
-INCLUDE RPTPARMS

ON TABLE HOLD AS TC_CAR1
END
-RUN

-IF &LINES EQ 0 THEN GOTO NEXTONE;
-*========================================================================
-*   PROCESS EXTRACT DATA FROM ABOVE
-*========================================================================

DEFINE FILE TC_CAR1
ROLLCD/A8 = '&&ROLL';
NMB/I5    = NMB + 1;
END
TABLE FILE TC_CAR1
SUM DGROSS_BOOK
    DRENTAL_AMT	
    DRENTAL_DAYS
    IGROSS_BOOK
    IRENTAL_AMT	
    IRENTAL_DAYS
BY ROLLCD
BY NMB
ON TABLE HOLD AS TCCAR2 
END
-RUN

MODIFY FILE TCCTRN
FIXFORM FROM TCCAR2
DATA ON TCCAR2
END
-RUN




-NEXTONE
