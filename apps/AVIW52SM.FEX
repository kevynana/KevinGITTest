-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Carried through non_tkts ref_tkts JK 9/29/04
-* ADDED CODE FOR GLOBAL CURRENCY - DEB 11/9/04
-* CARRIED THROUGH AA_TKT DL_TKT NW_TKT OTH_TKT UA_TKT - DEB 11/17/04
-* CARRIED THROUGH TRIP_LENGTH
-* Added code for Top traveler with online/traditional break - JK 9/22/05
-* Added LEVEL define for CETOPTVL report - Steve - 07/06/2006
-* CARRIED THROUGH NEW_ADV_PURCH   - DEB - 1/31/07
-* CARRIED THROUGH NEW_TRIP_LENGTH - DEB 4/23/07
-* COMMENTED OUT THE TABLE OF BRPTINST IT WAS CRASHING ON THE SERVER
-* BY PASSING THIS CODE ALLOWED REPORT TO RUN CORRECTLY - DEB  1/5/11
-* 6/8/15 - DEB - S-09537 - ADDED ROUTINE FOR SHTOPLSV
-*12/08/15 - JEM - S-13286 Updated to allow reports to sort/subtotal by id-levels
-*7/15/16 -DLV -  S-20630   expanded EMPID define to A15 
-*7/19/16 -RSB -  S-20630   expanded EMPID define to A15 at line 640
-* 02/24/2017 - DLV - S-22486 CHANGED ettek Review to Post-trip Reporting
-* 08/08/2017 RSB S-38044 Place the footer datetime stamp text in a separate file to be -INCLUDED in the stylesheets
-*                         Added: -SET &FTR_AddlLines = #;
-*
-INCLUDE SETECHO
-* File SMRYRPT.FEX
-**********************************************************************
-**********************************************************************
SET ASNAMES = ON
-RUN

-IF &&SETF EQ 'ABTOPLSV' GOTO ABCD;
-IF &&SETF EQ 'PRTOPLSV' OR 'BZTOPLSV' OR 'BATOPLSV' GOTO PRINC;
-IF &&SETF EQ 'BZTPLSV' GOTO BZSV;
-IF &&SETF EQ 'SHTOPLSV' GOTO SCHNEI;




-* -ABCD
 

TABLE FILE BRPTINST
BY BREAK_LEVELS  
WHERE INST_KEY EQ &&IKEY
ON TABLE SAVE
END
-RUN


-READ SAVE &BL.18.
-SET &LEV = EDIT(&BL, '99');
-SET &PARM = IF &LEV GT '10' THEN 'AROLL_DSC' | &LEV ELSE 'AROLL_DSC' | EDIT(&LEV, '$9');
-CLOSE SAVE

TABLE FILE HIER_LVL
PRINT DESCRIPTION
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
WHERE LEVEL EQ '&LEV.EVAL'
ON TABLE SAVE AS DESCNAME
END
-RUN
 
-READ DESCNAME &DESC.60
-SET &DESC_NM = EDIT(&DESC, '$$$$$9999999999999999999999999999999999999999999999999999999');
-CLOSE DESCNAME


-ABCD;

-DEFAULT &&RANK_METH = 'DISSAVINGS';
-DEFAULT &&RANK_LIMIT = 9999;
 

-GOTO NEXT;

-BZSV;

-DEFAULT &&RANK_METH = 'TDSV';
-DEFAULT &&RANK_LIMIT = 9999;
 

-GOTO NEXT;


-PRINC


-SET &&RANK_METH = 'DISSAVINGS';
-SET &&RANK_LIMIT = 200;
-GOTO NEXT;



-SCHNEI;
 

-SET &&RANK_METH = 'DISSAVINGS';
-SET &&RANK_LIMIT = 9999;

-NEXT

-IF &&CURRENCY EQ 'USD' THEN GOTO NEXT2;

-SET &&SUBHEAD = <NAMEC;
-SET &FPAID_CUR = 'FARE PAID, (' | &&CURRENCY || ')';
-SET &GCPK_CUR= 'COST,/KLMTR, (' | &&CURRENCY || ')';
-SET &&S_SUBJ2='PAID_FAREX/D16.2CS AS ' | '''&FPAID_CUR.EVAL'''  ;
-SET &&S_SUBJ4='KILO/P9CS AS ''TOTAL KLMTRS''';
-SET &&S_SUBJ5='COMPUTE GCPK/P14.2CS= IF ((KILO LT 1) AND'; 
-SET &&S_SUBJ6='(KILO GT (-1))) THEN 0 ELSE';
-SET &&S_SUBJ7='(PAID_FAREX/KILO); AS ' | '''&GCPK_CUR.EVAL''';

-NEXT2;

-IF &&SETF EQ 'BZTPLSV' GOTO BOOZFLSV;
 
TABLE FILE TOPTVL
SUM DISSAVINGS AS 'DSAV'
    NET_TKT_CNT
    SEG_LOWEST
    FARE_PAID
    EMP_ID
    EMP_NO
BY PASSNGR_NAME
BY LEVEL_DESC  
BY TKT_SORT
BY TRN_DATE
ON TABLE HOLD AS HOLDONE
END
-RUN




DEFINE FILE HOLDONE
LS_TKT/D8 = IF ((DSAV LT 1) AND (DSAV GT (-1))) THEN 0 ELSE NET_TKT_CNT;
END
TABLE FILE HOLDONE
SUM DSAV
    EMP_ID
    SEG_LOWEST
    FARE_PAID
    NET_TKT_CNT
    LS_TKT
    EMP_NO
BY PASSNGR_NAME
BY LEVEL_DESC
ON TABLE HOLD AS HOLDTWO
END
-RUN

TABLE FILE TOPTVL
SUM 
    NET_TKT_CNT
    MRK_TKT_CNT
    FARE_PAID
    PAID_FAREX/D16.2CS
    DISSAVINGS
    KILO
    LEVEL1
    LEVEL3
    NAMEC
    NEW_SEG_MILES
    NEW_TRIP_LENGTH
    AIRLINE_FEE
    AIRFEE_CNT
    NON_TKTS
    REF_TKTS
    AA_TKT
    DL_TKT
    UA_TKT
    NW_TKT
    OTH_TKT
    TRP_LEN
BY PASSNGR_NAME
BY LEVEL_DESC
ON TABLE HOLD AS HOLDTHREE
END
-RUN


MATCH FILE HOLDTHREE
PRINT NET_TKT_CNT
    MRK_TKT_CNT
    FARE_PAID
    PAID_FAREX 
    DISSAVINGS
    KILO
    LEVEL1
    LEVEL3
    NAMEC
    NEW_SEG_MILES
    NEW_TRIP_LENGTH
    AIRLINE_FEE
    AIRFEE_CNT
    NON_TKTS
    REF_TKTS
    AA_TKT
    DL_TKT
    UA_TKT
    NW_TKT
    OTH_TKT
    TRP_LEN
BY PASSNGR_NAME
BY LEVEL_DESC
ON TABLE HOLD
RUN
FILE HOLDTWO
SUM EMP_ID
    EMP_NO
    DSAV
    LS_TKT
BY PASSNGR_NAME
BY LEVEL_DESC
AFTER MATCH HOLD AS MATCHONE OLD-OR-NEW
END
-RUN



TABLE FILE MATCHONE
PRINT DISSAVINGS
    NET_TKT_CNT
    LS_TKT
    DSAV
    EMP_ID
    EMP_NO
    MRK_TKT_CNT
    FARE_PAID
    KILO
    LEVEL1
    LEVEL3
    
    NAMEC
    NEW_SEG_MILES
    NEW_TRIP_LENGTH
    PAID_FAREX
    AIRLINE_FEE
    AIRFEE_CNT
    NON_TKTS
    REF_TKTS
    AA_TKT
    DL_TKT
    UA_TKT
    NW_TKT
    OTH_TKT
    TRP_LEN
RANKED BY HIGHEST &&RANK_METH NOPRINT
BY PASSNGR_NAME
BY LEVEL_DESC
ON TABLE HOLD AS RNKHLD2
END
-RUN


 

DEFINE FILE RNKHLD2
  DRANK/D9 = RANK;
  ARANKX/A11 = FTOA(DRANK, '(D9)', 'A11');
  ARANK/A9 = EDIT(ARANKX,'$$999999999');
  LIST/D9 = (LAST LIST + 1);
  CRANKX/A11 = FTOA(LIST, '(D9)', 'A11');
  CRANK/A9 = EDIT(CRANKX,'$$999999999');
  RANK_VALUE/A9 = IF &&RANK_LIMIT EQ 0 THEN ARANK ELSE 
                  IF LIST GT &&RANK_LIMIT THEN 'ALL OTHER' ELSE 
                  CRANK;
  RANK_VAL/A9 = IF &&RANK_LIMIT EQ 0 THEN ARANK ELSE
                IF RANK GT &&RANK_LIMIT THEN 'ALL OTHER' ELSE
                ARANK;
  RANK_LAB1/A80 = IF RANK_VAL NE 'ALL OTHER' THEN &&RANK_LABEL1
                  ELSE 'ALL OTHER';
  RANK_LABEL1/A80 = IF RANK_VALUE NE 'ALL OTHER' THEN &&RANK_LABEL1
                      ELSE ' ';
  RANK_LABEL2/A80 = IF RANK_VALUE NE 'ALL OTHER' THEN &&RANK_LABEL2
                      ELSE ' ';
  RANK_LABEL3/A80 = IF RANK_VALUE NE 'ALL OTHER' THEN &&RANK_LABEL3
                      ELSE ' ';
  LEVEL/A15 = IF RANK_VALUE NE 'ALL OTHER' THEN LEVEL1 ELSE ' '; 
  EMPID/A15 = IF RANK_VALUE NE 'ALL OTHER' THEN EMP_ID ELSE ' ';
  EMPNO/A80 = IF RANK_VALUE NE 'ALL OTHER' THEN EMP_NO ELSE ' ';
  LSTKT/D8 = IF PASSNGR_NAME NE LAST PASSNGR_NAME AND LEVEL_DESC NE LAST LEVEL_DESC THEN
           LS_TKT ELSE 0;
-* NET_TKT_CNT/D9S = IF (SEG_NBR EQ '01') THEN TTKT ELSE 0;
  NOWTOD/A8 WITH RANK = HHMMSS (NOWTOD);
END
-RUN


-IF '&&SETF.EVAL' EQ 'SHTOPLSV' THEN GOTO Schnei;
TABLE FILE RNKHLD2
PRINT AA_TKT
      AIRFEE_CNT  
      AIRLINE_FEE
      DISSAVINGS
      DL_TKT
      EMPID
      EMPNO
      FARE_PAID
      KILO
      LEVEL_DESC
      LEVEL1
      LEVEL3
      LS_TKT
      MRK_TKT_CNT
      NAMEC
      NET_TKT_CNT
      NEW_SEG_MILES
      NEW_TRIP_LENGTH
      NON_TKTS
      NW_TKT
      OTH_TKT
      PAID_FAREX/D16.2CS
      PASSNGR_NAME
      REF_TKTS
      TRP_LEN
      UA_TKT
BY RANK_VALUE
ON TABLE HOLD AS JOYTEST 
END
-RUN


-GOTO SKIPit;
-Schnei;

TABLE FILE RNKHLD2
PRINT AA_TKT
      AIRFEE_CNT  
      AIRLINE_FEE
      DISSAVINGS
      DL_TKT
      EMPID
      EMPNO
      FARE_PAID
      KILO
      LEVEL_DESC
      LEVEL1
      LEVEL3
      LS_TKT
      MRK_TKT_CNT
      NAMEC
      NET_TKT_CNT
      NEW_SEG_MILES
      NEW_TRIP_LENGTH
      NON_TKTS
      NW_TKT
      OTH_TKT
      PAID_FAREX/D16.2CS
      PASSNGR_NAME
      REF_TKTS
      TRP_LEN
      UA_TKT
      RANK_VALUE
      RANK_LABEL1
      RANK_LABEL2
      NOWTOD
BY PASSNGR_NAME
BY LEVEL_DESC
ON TABLE HOLD AS LSHOLD
END
-RUN

-SET &AIRDATES = &&WEB_PATH || 'AIRDATES.fex';
 
TABLE FILE &&EXTRACT
SUM NET_TKT_CNT AS 'TTKT'
BY PASSNGR_NAME
BY LEVEL_DESC
-INCLUDE &AIRDATES
WHERE VOID_DATE EQ 0
-INCLUDE RPTPARMS
ON TABLE HOLD AS TOTTKT
END
-RUN
 
MATCH FILE LSHOLD
PRINT AA_TKT
      AIRFEE_CNT  
      AIRLINE_FEE
      DISSAVINGS
      DL_TKT
      EMPID
      EMPNO
      FARE_PAID
      KILO
      LEVEL_DESC
      LEVEL1
      LEVEL3
      LS_TKT
      MRK_TKT_CNT
      NAMEC
      NET_TKT_CNT
      NEW_SEG_MILES
      NEW_TRIP_LENGTH
      NON_TKTS
      NW_TKT
      OTH_TKT
      PAID_FAREX 
      PASSNGR_NAME
      REF_TKTS
      TRP_LEN
      UA_TKT
      RANK_VALUE
      RANK_LABEL1
      RANK_LABEL2
      NOWTOD
BY PASSNGR_NAME
BY LEVEL_DESC
ON TABLE HOLD
RUN
FILE TOTTKT
SUM TTKT 
BY PASSNGR_NAME
BY LEVEL_DESC
AFTER MATCH HOLD AS FNLHLD OLD
END
-RUN

 

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN


TABLE FILE FNLHLD
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;

SUM 
  FARE_PAID AS 'FARE PAID' DISSAVINGS AS 'LOST,SAVINGS'
  TTKT AS '# TICKETS'
  LS_TKT AS '# TICKETS,   WITH,LOST SAVINGS'
COMPUTE LSPCT/D8.1CS =IF ((TTKT LT 1) AND (TTKT GT (-1))) THEN 0 ELSE
                      (LS_TKT/TTKT)*100; AS '% OF TKTS,ISSUED WITH,LOST SAVINGS'
BY RANK_VALUE AS ' '
BY RANK_LABEL1 AS  'PASSENGER NAME '
-*BY LEVEL_DESC AS '&DESC_NM.EVAL'
-* BY LEVEL_DESC AS ' '
BY RANK_LABEL2 AS 'HIERARCHY'
ON RANK_LABEL1 RECOMPUTE MULTILINES AS 'TOTAL'

-GOTO FOOTERSM;

-SKIPit;

-IF &&SETF NE 'ABTOPLSV' OR 'BATOPLSV' GOTO Finishrpt;

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN


TABLE FILE RNKHLD2
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;

SUM 
  FARE_PAID AS 'FARE PAID' DISSAVINGS AS 'LOST,SAVINGS'
  NET_TKT_CNT AS '# TICKETS'
  LS_TKT AS '# TICKETS,   WITH,LOST SAVINGS'
COMPUTE LSPCT/D8.1CS =IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                      (LS_TKT/NET_TKT_CNT)*100; AS '% OF TKTS,ISSUED WITH,LOST SAVINGS'
BY RANK_VALUE AS ' '
BY RANK_LABEL1 AS  'PASSENGER NAME '
-*BY LEVEL_DESC AS '&DESC_NM.EVAL'
-* BY LEVEL_DESC AS ' '
BY RANK_LABEL2 AS 'HIERARCHY'
ON RANK_LABEL1 RECOMPUTE MULTILINES AS 'TOTAL'

-GOTO FOOTERSM;

-BOOZFLSV;


TABLE FILE TOPTVL
SUM DISSAVINGS AS 'DSAV'
    NET_TKT_CNT
    SEG_LOWEST
    FARE_PAID
    EMP_ID
    EMP_NO
BY PASSNGR_NAME
BY TKT_SORT
BY TRN_DATE
ON TABLE HOLD AS HOLDONE
END
-RUN


DEFINE FILE HOLDONE
LS_TKT/D8 = IF ((DSAV LT 1) AND (DSAV GT (-1))) THEN 0 ELSE NET_TKT_CNT;
END
TABLE FILE HOLDONE
SUM DSAV
    TOT.DSAV AS 'TDSV'
    EMP_ID
    SEG_LOWEST
    FARE_PAID
    NET_TKT_CNT
    LS_TKT
    EMP_NO
BY PASSNGR_NAME
ON TABLE HOLD AS HOLDTWO
END
-RUN

TABLE FILE TOPTVL
SUM 
    NET_TKT_CNT
    MRK_TKT_CNT
    FARE_PAID
    PAID_FAREX/D16.2CS
    DISSAVINGS
    KILO
    LEVEL1
    LEVEL3
    NAMEC
    NEW_SEG_MILES
    NEW_TRIP_LENGTH
    AIRLINE_FEE
    AIRFEE_CNT
    NON_TKTS
    REF_TKTS
    AA_TKT
    DL_TKT
    UA_TKT
    NW_TKT
    OTH_TKT
    TRP_LEN
BY PASSNGR_NAME
BY FLT_RANGE
ON TABLE HOLD AS HOLDTHREE
END
-RUN



MATCH FILE HOLDTHREE
PRINT NET_TKT_CNT
    MRK_TKT_CNT
    FARE_PAID
    PAID_FAREX 
    DISSAVINGS
    KILO
    LEVEL1
    LEVEL3
    NAMEC
    NEW_SEG_MILES
    NEW_TRIP_LENGTH
    AIRLINE_FEE
    AIRFEE_CNT
    NON_TKTS
    REF_TKTS
    AA_TKT
    DL_TKT
    UA_TKT
    NW_TKT
    OTH_TKT
    TRP_LEN
BY PASSNGR_NAME
BY FLT_RANGE
ON TABLE HOLD
RUN
FILE HOLDTWO
SUM EMP_ID
    EMP_NO
    DSAV
    LS_TKT
BY PASSNGR_NAME
-* BY FLT_RANGE
AFTER MATCH HOLD AS MATCHONE OLD-OR-NEW
END
-RUN



TABLE FILE MATCHONE
PRINT DISSAVINGS
    NET_TKT_CNT
    LS_TKT
    DSAV
    EMP_ID
    EMP_NO
    MRK_TKT_CNT
    FARE_PAID
    KILO
    LEVEL1
    LEVEL3
    
    NAMEC
    NEW_SEG_MILES
    NEW_TRIP_LENGTH
    PAID_FAREX
    AIRLINE_FEE
    AIRFEE_CNT
    NON_TKTS
    REF_TKTS
    AA_TKT
    DL_TKT
    UA_TKT
    NW_TKT
    OTH_TKT
    TRP_LEN
RANKED BY HIGHEST DSAV NOPRINT
BY PASSNGR_NAME
BY FLT_RANGE
ON TABLE HOLD AS RNKHLD2
END
-RUN


DEFINE FILE RNKHLD2
  DRANK/D9 = RANK;
  ARANKX/A11 = FTOA(DRANK, '(D9)', 'A11');
  ARANK/A9 = EDIT(ARANKX,'$$999999999');
  LIST/D9 = IF PASSNGR_NAME NE LAST PASSNGR_NAME THEN (LAST LIST + 1) ELSE LAST LIST;
  CRANKX/A11 = FTOA(LIST, '(D9)', 'A11');
  CRANK/A9 = EDIT(CRANKX,'$$999999999');
  RANK_VALUE/A9 = IF &&RANK_LIMIT EQ 0 THEN ARANK ELSE 
                  IF LIST GT &&RANK_LIMIT THEN 'ALL OTHER' ELSE 
                  CRANK;
  RANK_VAL/A9 = IF &&RANK_LIMIT EQ 0 THEN ARANK ELSE
                IF RANK GT &&RANK_LIMIT THEN 'ALL OTHER' ELSE
                ARANK;
  RANK_LAB1/A80 = IF RANK_VAL NE 'ALL OTHER' THEN &&RANK_LABEL1
                  ELSE 'ALL OTHER';
  RANK_LABEL1/A80 = IF RANK_VALUE NE 'ALL OTHER' THEN &&RANK_LABEL1
                      ELSE ' ';
  RANK_LABEL2/A80 = IF RANK_VALUE NE 'ALL OTHER' THEN &&RANK_LABEL2
                      ELSE ' ';
  RANK_LABEL3/A80 = IF RANK_VALUE NE 'ALL OTHER' THEN &&RANK_LABEL3
                      ELSE ' ';
  LEVEL/A15 = IF RANK_VALUE NE 'ALL OTHER' THEN LEVEL1 ELSE ' '; 
  EMPID/A15 = IF RANK_VALUE NE 'ALL OTHER' THEN EMP_ID ELSE ' ';
  EMPNO/A80 = IF RANK_VALUE NE 'ALL OTHER' THEN EMP_NO ELSE ' ';
  LSTKT/D8 = IF PASSNGR_NAME NE LAST PASSNGR_NAME AND LEVEL_DESC NE LAST LEVEL_DESC THEN
           LS_TKT ELSE 0;
-* NET_TKT_CNT/D9S = IF (SEG_NBR EQ '01') THEN TTKT ELSE 0;
  NOWTOD/A8 WITH RANK = HHMMSS (NOWTOD);
END
-RUN


-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN


TABLE FILE RNKHLD2
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;

SUM 
  FARE_PAID AS 'FARE PAID' DISSAVINGS AS 'LOST,SAVINGS'
  NET_TKT_CNT AS '# TICKETS'
  LS_TKT AS '# TICKETS,   WITH,LOST SAVINGS'
COMPUTE LSPCT/D8.1CS =IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                      (LS_TKT/NET_TKT_CNT)*100; AS '% OF TKTS,ISSUED WITH,LOST SAVINGS'
BY RANK_VALUE AS ' '
BY RANK_LABEL1 AS  'PASSENGER NAME '
BY RANK_LABEL2 AS 'FLIGHT RANGE'
-* BY FLT_RANGE AS 'FLIGHT RANGE'
ON RANK_LABEL1 RECOMPUTE MULTILINES AS 'TOTAL'

-GOTO FOOTERSM;


-Finishrpt;

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN


TABLE FILE RNKHLD2
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10

-IF &&SETF EQ 'ABTOPLSV' OR 'PRTOPLSV' OR 'BZTOPLSV' OR 'BZTPLSV' OR 'SHTOPLSV' THEN GOTO FOOTERSM;
-*
-SET &FTR_AddlLines = 3;
FOOTING BOTTOM
" "
" "
"EXCLUDES EMPLOYEE NUMBER 000999999 AND 009999999"
-********
-FOOTERSM
-********
-INCLUDE FOOTERSM
-*
ON TABLE COLUMN-TOTAL
-*ON TABLE SET STYLE &&SMSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *
-INCLUDE &&PASTYS

-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILL;
-IF '&&SETF.EVAL' NE 'ABTOPLSV' OR 'BATOPLSV' OR 'BZTPLSV' OR 'SHTOPLSV' GOTO SKIP_DRILL;

-INCLUDE &&DSTY

-SKIP_DRILL

ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN

-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3;

EX REPORT_3

-SKIP_R3
-*-*-EXIT




