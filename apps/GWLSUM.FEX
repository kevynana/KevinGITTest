-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-INCLUDE SETECHO
SET ASNAMES=ON

-SET &&RPTSUF = 'DTL';
-INCLUDE FDEFRPTS
-RUN

-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HA=&HLDPATH || 'H2.FOC';
-SET &HC=&HLDPATH || 'HC2.FOC';
-SET &HH=&HLDPATH || 'HH2.FOC';
-RUN

USE CLEAR *
-RUN

EX SUUSES
-RUN 

USE ADD 
&HA AS H2
&HC AS H2
&HH AS H2
END
-RUN


TABLE FILE H2
PRINT FEE XTRAN_DT LEVEL1 LINE_DESC ACCOUNT FLAG XPSNGR_NM
BY PNR_LOCATOR
BY PAX
WHERE FEE NE 0
ON TABLE HOLD AS H3
END
-RUN

USE ADD
D:\TNT\TTRACKER\DATA\S1GWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\S2GWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\S3GWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\S4GWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\S5GWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\S6GWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\S7GWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\S8GWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\S9GWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\S0GWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\SYGWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\SZGWL.FOC AS 'S1GWL'
D:\TNT\TTRACKER\DATA\A1GWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\A2GWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\A3GWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\A4GWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\A5GWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\A6GWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\A7GWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\A8GWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\A9GWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\A0GWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\AYGWL.FOC AS 'A1GWL'
D:\TNT\TTRACKER\DATA\AZGWL.FOC AS 'A1GWL'
END
-RUN

JOIN AIR_KEY IN A1GWL TO ALL AIR_KEY IN S1GWL 
END
-RUN

DEFINE FILE A1GWL
XTRAN_DT/MDYY = TRN_DATE;
XPSNGR_NM/A15        = 
    EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
PAX/A5 = EDIT(XPSNGR_NM, '99999$$$$$$$$$$');
END
TABLE FILE A1GWL
SUM XTRAN_DT
BY PNR_LOCATOR
BY PAX
ON TABLE HOLD AS JH
END
-RUN

MATCH FILE H3
PRINT FEE XTRAN_DT LEVEL1 LINE_DESC ACCOUNT FLAG XPSNGR_NM
BY PNR_LOCATOR
BY PAX
ON TABLE HOLD
RUN
FILE JH
PRINT XTRAN_DT
BY PNR_LOCATOR
BY PAX
AFTER MATCH HOLD AS JH1 OLD
END
-RUN

TABLE FILE JH1
PRINT FEE XTRAN_DT LEVEL1 LINE_DESC ACCOUNT FLAG
      XPSNGR_NM
BY PNR_LOCATOR
BY PAX
BY HIGHEST XTRAN_DT AS 'DATE1'
WHERE FLAG EQ 'A' OR 'B'
ON TABLE HOLD AS JH2
END
-RUN

TABLE FILE JH2
SUM PNR_LOCATOR PAX DATE1
ON TABLE HOLD AS JHA
END
-RUN


DEFINE FILE JH1
DATE/MDYY = XTRAN_DT;
END
TABLE FILE JH1
PRINT DATE FEE LEVEL1 LINE_DESC ACCOUNT FLAG XPSNGR_NM
BY PNR_LOCATOR
BY PAX
WHERE FLAG EQ 'C' OR 'D' OR 'E' OR 'F'
ON TABLE HOLD AS JH3
END
-RUN

MATCH FILE JH3
PRINT DATE FLAG FEE LEVEL1 LINE_DESC ACCOUNT XPSNGR_NM
BY PNR_LOCATOR
BY PAX
ON TABLE HOLD
RUN
FILE JHA
SUM DATE1
BY PNR_LOCATOR
BY PAX
AFTER MATCH HOLD AS JH4 OLD-OR-NEW
END
-RUN

DEFINE FILE JH2
DATE/MDYY = XTRAN_DT;
DATE1/MDYY = XTRAN_DT;
END

TABLE FILE JH2
PRINT DATE DATE1 FEE XTRAN_DT LEVEL1 LINE_DESC ACCOUNT FLAG XPSNGR_NM 
BY PNR_LOCATOR
BY PAX
ON TABLE HOLD AS JHF FORMAT FOCUS
END
-RUN

DEFINE FILE JH4
XTRAN_DT/MDYY = DATE;
END
TABLE FILE JH4
PRINT DATE DATE1 FEE XTRAN_DT LEVEL1 LINE_DESC ACCOUNT FLAG XPSNGR_NM 
BY PNR_LOCATOR
BY PAX
ON TABLE HOLD AS JHF1 FORMAT FOCUS
END
-RUN

-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &JHF=&HLDPATH || 'JHF.FOC';
-SET &JHF1=&HLDPATH || 'JHF1.FOC';
-RUN

USE CLEAR *
-RUN

EX SUUSES
-RUN 

USE ADD 
&JHF AS JHF
&JHF1 AS JHF
END
-RUN

DEFINE FILE JHF
TFEE/P5.2S = IF FLAG EQ 'A' OR 'B' THEN FEE ELSE
          IF FLAG EQ 'C' OR 'D' AND DATE LT DATE1 THEN FEE ELSE
          IF FLAG EQ 'E' OR 'F' AND DATE LT DATE1 THEN FEE ELSE 0;
BF/A10 = ' ';
NOWTOD/A8 WITH ACCOUNT = HHMMSS (NOWTOD);
END


TABLE FILE JHF
-INCLUDE HEADAIR
"&&SUBHEAD"
"</2"
-*
-**********************************************************************
-* Print statement with fields passed from the user profile database
-**********************************************************************
-*
&&PRINT1
&&PRINT2
&&PRINT3
&&PRINT4
&&PRINT5
&&PRINT6
&&PRINT7
&&PRINT8
&&PRINT9
&&PRINT10

-*
-**********************************************************************
-* By statements (one per field)
-**********************************************************************
-*
&&BY1
&&BY2
&&BY3
&&BY4
&&BY5
&&BY6
&&BY7
&&BY8
&&BY9
&&BY10

WHERE TFEE NE 0
-*
-*********************************************************************
-*DATE           NAME               DESCRIPTION 
-*8/18/00      IBISTL-KR            INCLUDE WHERE STATEMENTS WHEN
-*                                  DRILLED_RUN EQ 'Y'.
-*********************************************************************
-*
-**********************************************************************
-* Where statements for Drilled Report
-**********************************************************************
-*
  


-IF &&DRILLED_RUN EQ 'N' GOTO SKIP_WHR;
-INCLUDE &&DRILLWHR
-SKIP_WHR
-*
-**********************************************************************
-* On Table statements for code appropriate to On Table commands
-**********************************************************************
-*
&&ONTABLE1
&&ONTABLE2
&&ONTABLE3
&&ONTABLE4
&&ONTABLE5
&&ONTABLE6
&&ONTABLE7
&&ONTABLE8
&&ONTABLE9
&&ONTABLE10
 
-*
-**********************************************************************
-* Report specific footer(s)
-**********************************************************************
-*
-INCLUDE FOOTERDT
-*
-*ON TABLE SET STYLE &&DTSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**************************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *
-INCLUDE &&DTSTY 
ENDSTYLE

-*

&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN




