-* 09/17/2015  DV  S-05438 Changed to use modify instead of maintain
-* File EXECTOT3.FEX
-INCLUDE SETECHO


SET ASNAMES = ON

MATCH FILE TKT_TYP2
PRINT CDTOTAMT 
      PDTOTAMT 
      CITOTAMT 
      PITOTAMT 
      CTOTAMT 
      PTOTAMT 
      CDYTOTAMT
      PDYTOTAMT
      CIYTOTAMT
      PIYTOTAMT
      CYTOTAMT
      PYTOTAMT
BY FLAG
ON TABLE HOLD
RUN
FILE TC_TSCAR2
SUM  CDM1RNT_AMT
     PDM1RNT_AMT
     CIM1RNT_AMT
     PIM1RNT_AMT
     CTCAMT
     PTCAMT
     CDY1RNT_AMT 
     CIY1RNT_AMT 
     PDY1RNT_AMT 
     PIY1RNT_AMT 
     CYTCAMT
     PYTCAMT
BY FLAG
AFTER MATCH HOLD AS XONE OLD-OR-NEW
END
-RUN

MATCH FILE XONE
PRINT CDTOTAMT 
      PDTOTAMT 
      CITOTAMT 
      PITOTAMT 
      CTOTAMT 
      PTOTAMT
      CDYTOTAMT
      PDYTOTAMT
      CIYTOTAMT
      PIYTOTAMT
      CYTOTAMT
      PYTOTAMT
      CDM1RNT_AMT
      PDM1RNT_AMT
      CIM1RNT_AMT
      PIM1RNT_AMT 
      CTCAMT
      PTCAMT
      CDY1RNT_AMT 
      CIY1RNT_AMT 
      PDY1RNT_AMT 
      PIY1RNT_AMT 
      CYTCAMT
      PYTCAMT
BY FLAG
ON TABLE HOLD
RUN
FILE TC_TSHTL2
SUM CDM1HTL_AMT
    PDM1HTL_AMT
    CIM1HTL_AMT
    PIM1HTL_AMT
    CTHAMT
    PTHAMT
    CDY1HTL_AMT  
    CIY1HTL_AMT  
    PDY1HTL_AMT  
    PIY1HTL_AMT   
    CYTHAMT 
    PYTHAMT
BY FLAG
AFTER MATCH HOLD AS XTWO OLD-OR-NEW
END
-RUN

TABLE FILE XTWO
SUM CDTOTAMT  
      PDTOTAMT 
      CITOTAMT 
      PITOTAMT 
      CTOTAMT 
      PTOTAMT
      CDYTOTAMT
      PDYTOTAMT
      CIYTOTAMT
      PIYTOTAMT
      CYTOTAMT
      PYTOTAMT
      CDM1RNT_AMT
      PDM1RNT_AMT
      CIM1RNT_AMT
      PIM1RNT_AMT 
      CTCAMT
      PTCAMT
      CDY1RNT_AMT 
      CIY1RNT_AMT 
      PDY1RNT_AMT 
      PIY1RNT_AMT 
      CYTCAMT
      PYTCAMT
      CDM1HTL_AMT
      PDM1HTL_AMT
      CIM1HTL_AMT
      PIM1HTL_AMT  
      CTHAMT
      PTHAMT
      CDY1HTL_AMT  
      CIY1HTL_AMT  
      PDY1HTL_AMT  
      PIY1HTL_AMT   
      CYTHAMT 
      PYTHAMT
-*Total Expense
COMPUTE CDTOTEXP/D10 =  CDTOTAMT + CDM1RNT_AMT + CDM1HTL_AMT;
COMPUTE PDTOTEXP/D10 =  PDTOTAMT + PDM1RNT_AMT + PDM1HTL_AMT;
COMPUTE DEXPVAR/D10 = CDTOTEXP - PDTOTEXP;
COMPUTE DEXPVPCT/D6.2 = IF ((PDTOTEXP LT 1) AND (PDTOTEXP GT (-1))) THEN 0 ELSE
                           (DEXPVAR/PDTOTEXP) * 100;
COMPUTE CITOTEXP/D10 =  CITOTAMT + CIM1RNT_AMT +  CIM1HTL_AMT;
COMPUTE PITOTEXP/D10 =  PITOTAMT + PIM1RNT_AMT +  PIM1HTL_AMT;
COMPUTE IEXPVAR/D10 = CITOTEXP - PITOTEXP;
COMPUTE IEXPVPCT/D6.2 = IF ((PITOTEXP LT 1) AND (PITOTEXP GT (-1))) THEN 0 ELSE
                           (IEXPVAR/PITOTEXP) * 100;  
COMPUTE CTOTEXP/D10 =  CTOTAMT + CTCAMT + CTHAMT;
COMPUTE PTOTEXP/D10 =  PTOTAMT + PTCAMT + PTHAMT; 
COMPUTE TEXPVAR/D10 = CTOTEXP - PTOTEXP;
COMPUTE TEXPVPCT/D6.2 = IF ((PTOTEXP LT 1) AND (PTOTEXP GT (-1))) THEN 0 ELSE
                           (TEXPVAR/PTOTEXP) * 100;  
-* Air % 
COMPUTE CDAIRP/D10 =  IF ((CDTOTEXP LT 1) AND (CDTOTEXP GT (-1))) THEN 0 ELSE
                           (CDTOTAMT/CDTOTEXP) * 100;  
COMPUTE PDAIRP/D10 =  IF ((PDTOTEXP LT 1) AND (PDTOTEXP GT (-1))) THEN 0 ELSE
                           (PDTOTAMT/PDTOTEXP) * 100;  
COMPUTE DAPVAR/D10 = CDAIRP - PDAIRP;

COMPUTE DAPVPCT/D6.2 = IF ((PDAIRP LT 1) AND (PDAIRP GT (-1))) THEN 0 ELSE
                           (DAPVAR/PDAIRP) * 100;
                           
COMPUTE CIAIRP/D10 =  IF ((CITOTEXP LT 1) AND (CITOTEXP GT (-1))) THEN 0 ELSE
                           (CITOTAMT/CITOTEXP) * 100;  
COMPUTE PIAIRP/D10 =  IF ((PITOTEXP LT 1) AND (PITOTEXP GT (-1))) THEN 0 ELSE
                           (PITOTAMT/PITOTEXP) * 100;  
COMPUTE IAPVAR/D10 = CIAIRP - PIAIRP;
COMPUTE IAPVPCT/D6.2 = IF ((PIAIRP LT 1) AND (PIAIRP GT (-1))) THEN 0 ELSE
                           (IAPVAR/PIAIRP) * 100;
                           
COMPUTE CTAIRP/D10 =  IF ((CTOTEXP LT 1) AND (CTOTEXP GT (-1))) THEN 0 ELSE
                           (CTOTAMT/CTOTEXP) * 100;  
COMPUTE PTAIRP/D10 =  IF ((PTOTEXP LT 1) AND (PTOTEXP GT (-1))) THEN 0 ELSE
                           (PTOTAMT/PTOTEXP) * 100;  
COMPUTE TAPVAR/D10 = CTAIRP - PTAIRP;

COMPUTE TAPVPCT/D6.2 = IF ((PTAIRP LT 1) AND (PTAIRP GT (-1))) THEN 0 ELSE
                           (TAPVAR/PTAIRP) * 100; 
-* Car %
COMPUTE CDCARP/D10 =  IF ((CDTOTEXP LT 1) AND (CDTOTEXP GT (-1))) THEN 0 ELSE
                           (CDM1RNT_AMT/CDTOTEXP) * 100;  
COMPUTE PDCARP/D10 =  IF ((PDTOTEXP LT 1) AND (PDTOTEXP GT (-1))) THEN 0 ELSE
                           (PDM1RNT_AMT/PDTOTEXP) * 100;  
COMPUTE DCPVAR/D10 = CDCARP - PDCARP;

COMPUTE DCPVPCT/D6.2 = IF ((PDCARP LT 1) AND (PDCARP GT (-1))) THEN 0 ELSE
                           (DCPVAR/PDCARP) * 100;
                           
COMPUTE CICARP/D10 =  IF ((CITOTEXP LT 1) AND (CITOTEXP GT (-1))) THEN 0 ELSE
                           (CIM1RNT_AMT/CITOTEXP) * 100;  
COMPUTE PICARP/D10 =  IF ((PITOTEXP LT 1) AND (PITOTEXP GT (-1))) THEN 0 ELSE
                           (PIM1RNT_AMT/PITOTEXP) * 100;  
COMPUTE ICPVAR/D10 = CICARP - PICARP;
COMPUTE ICPVPCT/D6.2 = IF ((PICARP LT 1) AND (PICARP GT (-1))) THEN 0 ELSE
                           (ICPVAR/PICARP) * 100;
                           
COMPUTE CTCARP/D10 =  IF ((CTOTEXP LT 1) AND (CTOTEXP GT (-1))) THEN 0 ELSE
                           (CTCAMT/CTOTEXP) * 100;  
COMPUTE PTCARP/D10 =  IF ((PTOTEXP LT 1) AND (PTOTEXP GT (-1))) THEN 0 ELSE
                           (PTCAMT/PTOTEXP) * 100;  
COMPUTE TCPVAR/D10 = CTCARP - PTCARP;

COMPUTE TCPVPCT/D6.2 = IF ((PTCARP LT 1) AND (PTCARP GT (-1))) THEN 0 ELSE
                           (TCPVAR/PTCARP) * 100; 
-* Hotel %

COMPUTE CDHTLP/D10 =  IF ((CDTOTEXP LT 1) AND (CDTOTEXP GT (-1))) THEN 0 ELSE
                           (CDM1HTL_AMT/CDTOTEXP) * 100;  
COMPUTE PDHTLP/D10 =  IF ((PDTOTEXP LT 1) AND (PDTOTEXP GT (-1))) THEN 0 ELSE
                           (PDM1HTL_AMT/PDTOTEXP) * 100;  
COMPUTE DHPVAR/D10 = CDHTLP - PDHTLP;

COMPUTE DHPVPCT/D6.2 = IF ((PDHTLP LT 1) AND (PDHTLP GT (-1))) THEN 0 ELSE
                           (DHPVAR/PDHTLP) * 100;
                           
COMPUTE CIHTLP/D10 =  IF ((CITOTEXP LT 1) AND (CITOTEXP GT (-1))) THEN 0 ELSE
                           (CIM1HTL_AMT/CITOTEXP) * 100;  
COMPUTE PIHTLP/D10 =  IF ((PITOTEXP LT 1) AND (PITOTEXP GT (-1))) THEN 0 ELSE
                           (PIM1HTL_AMT/PITOTEXP) * 100;  
COMPUTE IHPVAR/D10 = CIHTLP - PIHTLP;
COMPUTE IHPVPCT/D6.2 = IF ((PIHTLP LT 1) AND (PIHTLP GT (-1))) THEN 0 ELSE
                           (IHPVAR/PIHTLP) * 100;
                           
COMPUTE CTHTLP/D10 =  IF ((CTOTEXP LT 1) AND (CTOTEXP GT (-1))) THEN 0 ELSE
                           (CTHAMT/CTOTEXP) * 100;  
COMPUTE PTHTLP/D10 =  IF ((PTOTEXP LT 1) AND (PTOTEXP GT (-1))) THEN 0 ELSE
                           (PTHAMT/PTOTEXP) * 100;  
COMPUTE THPVAR/D10 = CTHTLP - PTHTLP;

COMPUTE THPVPCT/D6.2 = IF ((PTHTLP LT 1) AND (PTHTLP GT (-1))) THEN 0 ELSE
                           (THPVAR/PTHTLP) * 100; 

-*YTD Total Expense


COMPUTE CYDTOTEXP/D10 =  CDYTOTAMT + CDY1RNT_AMT + CDY1HTL_AMT;
COMPUTE PYDTOTEXP/D10 =  PDYTOTAMT + PDY1RNT_AMT + PDY1HTL_AMT;
COMPUTE DYEXPVAR/D10 = CYDTOTEXP - PYDTOTEXP;
COMPUTE DYEXPVPCT/D6.2 = IF ((PYDTOTEXP LT 1) AND (PYDTOTEXP GT (-1))) THEN 0 ELSE
                           (DYEXPVAR/PYDTOTEXP) * 100;
COMPUTE CYITOTEXP/D10 =  CIYTOTAMT + CIY1RNT_AMT +  CIY1HTL_AMT;
COMPUTE PYITOTEXP/D10 =  PIYTOTAMT + PIY1RNT_AMT +  PIY1HTL_AMT;
COMPUTE IYEXPVAR/D10 = CYITOTEXP - PYITOTEXP;
COMPUTE IYEXPVPCT/D6.2 = IF ((PYITOTEXP LT 1) AND (PYITOTEXP GT (-1))) THEN 0 ELSE
                           (IYEXPVAR/PYITOTEXP) * 100;  
COMPUTE CYTOTEXP/D10 =  CYTOTAMT + CYTCAMT + CYTHAMT;
COMPUTE PYTOTEXP/D10 =  PYTOTAMT + PYTCAMT + PYTHAMT; 
COMPUTE TYEXPVAR/D10 = CYTOTEXP - PYTOTEXP;
COMPUTE TYEXPVPCT/D6.2 = IF ((PYTOTEXP LT 1) AND (PYTOTEXP GT (-1))) THEN 0 ELSE
                           (TYEXPVAR/PYTOTEXP) * 100;  

 

-* YTD Air % 
COMPUTE CYDAIRP/D10 =  IF ((CYDTOTEXP LT 1) AND (CYDTOTEXP GT (-1))) THEN 0 ELSE
                           (CDYTOTAMT/CYDTOTEXP) * 100;  
COMPUTE PYDAIRP/D10 =  IF ((PYDTOTEXP LT 1) AND (PYDTOTEXP GT (-1))) THEN 0 ELSE
                           (PDYTOTAMT/PYDTOTEXP) * 100;  
COMPUTE DYAPVAR/D10 = CYDAIRP - PYDAIRP;

COMPUTE DYAPVPCT/D6.2 = IF ((PYDAIRP LT 1) AND (PYDAIRP GT (-1))) THEN 0 ELSE
                           (DYAPVAR/PYDAIRP) * 100;
                           
COMPUTE CYIAIRP/D10 =  IF ((CYITOTEXP LT 1) AND (CYITOTEXP GT (-1))) THEN 0 ELSE
                           (CIYTOTAMT/CYITOTEXP) * 100;  
COMPUTE PYIAIRP/D10 =  IF ((PYITOTEXP LT 1) AND (PYITOTEXP GT (-1))) THEN 0 ELSE
                           (PIYTOTAMT/PYITOTEXP) * 100;  
COMPUTE IYAPVAR/D10 = CYIAIRP - PYIAIRP;
COMPUTE IYAPVPCT/D6.2 = IF ((PYIAIRP LT 1) AND (PYIAIRP GT (-1))) THEN 0 ELSE
                           (IYAPVAR/PYIAIRP) * 100;
                           
COMPUTE CYTAIRP/D10 =  IF ((CYTOTEXP LT 1) AND (CYTOTEXP GT (-1))) THEN 0 ELSE
                           (CYTOTAMT/CYTOTEXP) * 100;  
COMPUTE PYTAIRP/D10 =  IF ((PYTOTEXP LT 1) AND (PYTOTEXP GT (-1))) THEN 0 ELSE
                           (PYTOTAMT/PYTOTEXP) * 100;  
COMPUTE TYAPVAR/D10 = CYTAIRP - PYTAIRP;

COMPUTE TYAPVPCT/D6.2 = IF ((PYTAIRP LT 1) AND (PYTAIRP GT (-1))) THEN 0 ELSE
                           (TYAPVAR/PYTAIRP) * 100; 

-* YTD Car %

COMPUTE CYDCARP/D10 =  IF ((CYDTOTEXP LT 1) AND (CYDTOTEXP GT (-1))) THEN 0 ELSE
                           (CDY1RNT_AMT/CYDTOTEXP) * 100;  
COMPUTE PYDCARP/D10 =  IF ((PYDTOTEXP LT 1) AND (PYDTOTEXP GT (-1))) THEN 0 ELSE
                           (PDY1RNT_AMT/PYDTOTEXP) * 100;  
COMPUTE DYCPVAR/D10 = CYDCARP - PYDCARP;

COMPUTE DYCPVPCT/D6.2 = IF ((PYDCARP LT 1) AND (PYDCARP GT (-1))) THEN 0 ELSE
                           (DYCPVAR/PYDCARP) * 100;
                           
COMPUTE CYICARP/D10 =  IF ((CYITOTEXP LT 1) AND (CYITOTEXP GT (-1))) THEN 0 ELSE
                           (CIY1RNT_AMT/CYITOTEXP) * 100;  
COMPUTE PYICARP/D10 =  IF ((PYITOTEXP LT 1) AND (PYITOTEXP GT (-1))) THEN 0 ELSE
                           (PIY1RNT_AMT/PYITOTEXP) * 100;  
COMPUTE IYCPVAR/D10 = CYICARP - PYICARP;
COMPUTE IYCPVPCT/D6.2 = IF ((PYICARP LT 1) AND (PYICARP GT (-1))) THEN 0 ELSE
                           (IYCPVAR/PYICARP) * 100;
                           
COMPUTE CYTCARP/D10 =  IF ((CYTOTEXP LT 1) AND (CYTOTEXP GT (-1))) THEN 0 ELSE
                           (CYTCAMT/CYTOTEXP) * 100;  
COMPUTE PYTCARP/D10 =  IF ((PYTOTEXP LT 1) AND (PYTOTEXP GT (-1))) THEN 0 ELSE
                           (PYTCAMT/PYTOTEXP) * 100;  
COMPUTE TYCPVAR/D10 = CYTCARP - PYTCARP;

COMPUTE TYCPVPCT/D6.2 = IF ((PYTCARP LT 1) AND (PYTCARP GT (-1))) THEN 0 ELSE
                           (TYCPVAR/PTCARP) * 100; 
-* YTD Hotel %
 
COMPUTE CYDHTLP/D10 =  IF ((CYDTOTEXP LT 1) AND (CYDTOTEXP GT (-1))) THEN 0 ELSE
                           (CDY1HTL_AMT/CYDTOTEXP) * 100;  
COMPUTE PYDHTLP/D10 =  IF ((PYDTOTEXP LT 1) AND (PYDTOTEXP GT (-1))) THEN 0 ELSE
                           (PDY1HTL_AMT/PYDTOTEXP) * 100;  
COMPUTE DYHPVAR/D10 = CYDHTLP - PYDHTLP;

COMPUTE DYHPVPCT/D6.2 = IF ((PYDHTLP LT 1) AND (PYDHTLP GT (-1))) THEN 0 ELSE
                           (DYHPVAR/PYDHTLP) * 100;
                           
COMPUTE CYIHTLP/D10 =  IF ((CYITOTEXP LT 1) AND (CYITOTEXP GT (-1))) THEN 0 ELSE
                           (CIY1HTL_AMT/CYITOTEXP) * 100;  
COMPUTE PYIHTLP/D10 =  IF ((PYITOTEXP LT 1) AND (PYITOTEXP GT (-1))) THEN 0 ELSE
                           (PIY1HTL_AMT/PYITOTEXP) * 100;  
COMPUTE IYHPVAR/D10 = CYIHTLP - PYIHTLP;
COMPUTE IYHPVPCT/D6.2 = IF ((PYIHTLP LT 1) AND (PYIHTLP GT (-1))) THEN 0 ELSE
                           (IYHPVAR/PYIHTLP) * 100;
                           
COMPUTE CYTHTLP/D10 =  IF ((CYTOTEXP LT 1) AND (CYTOTEXP GT (-1))) THEN 0 ELSE
                           (CYTHAMT/CYTOTEXP) * 100;  
COMPUTE PYTHTLP/D10 =  IF ((PYTOTEXP LT 1) AND (PYTOTEXP GT (-1))) THEN 0 ELSE
                           (PYTHAMT/PYTOTEXP) * 100;  
COMPUTE TYHPVAR/D10 = CYTHTLP - PYTHTLP;

COMPUTE TYHPVPCT/D6.2 = IF ((PYTHTLP LT 1) AND (PYTHTLP GT (-1))) THEN 0 ELSE
                           (TYHPVAR/PYTHTLP) * 100; 
BY FLAG
ON TABLE HOLD AS EXPHLD
END
-RUN

 
 


-* Total Expense 
DEFINE FILE EXPHLD
CATEGORY/A30 = 'Summary';
CAT_ORDER/I2 = 5;
ROW_LABEL/A20 = 'Total Expense';
ROW_ORDER/I2 = 1;
END
TABLE FILE EXPHLD
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDTOTEXP/D10 AS 'DOM_CURR' 
PDTOTEXP/D10 AS 'DOM_PRIOR' DEXPVAR/D10 AS 'DOM_VAR_VAL' DEXPVPCT/D6  AS 'DOM_VAR_PCT' 
CITOTEXP/D10 AS 'INT_CURR' PITOTEXP/D10 AS 'INT_PRIOR'
IEXPVAR/D10 AS 'INT_VAR_VAL'  IEXPVPCT/D6  AS 'INT_VAR_PCT'
CTOTEXP/D10 AS 'DI_CURR' PTOTEXP/D10 AS 'DI_PRIOR' TEXPVAR/D10 AS 'DI_VAR_VAL'
TEXPVPCT/D6  AS 'DI_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS TCTOTEXP
END
-RUN
 
TABLE FILE TCTOTEXP
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DOM_CURR
AND DOM_PRIOR AND DOM_VAR_VAL AND DOM_VAR_PCT AND INT_CURR AND INT_PRIOR
AND INT_VAR_VAL AND INT_VAR_PCT AND DI_CURR AND DI_PRIOR AND DI_VAR_VAL AND DI_VAR_PCT
ON TABLE HOLD AS TCTOTEXP1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM TCTOTEXP1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DOM_CURR DOM_PRIOR DOM_VAR_VAL DOM_VAR_PCT INT_CURR INT_PRIOR INT_VAR_VAL INT_VAR_PCT DI_CURR DI_PRIOR DI_VAR_VAL DI_VAR_PCT
ON NOMATCH INCLUDE
DATA ON TCTOTEXP1
END
-RUN


-* Air %

DEFINE FILE EXPHLD
CATEGORY/A30 = 'Summary';
CAT_ORDER/I2 = 5;
ROW_LABEL/A20 = 'Air %';
ROW_ORDER/I2 = 2;
END
TABLE FILE EXPHLD
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDAIRP/D10 AS 'DOM_CURR' 
PDAIRP/D10 AS 'DOM_PRIOR' DAPVAR/D10 AS 'DOM_VAR_VAL' DAPVPCT/D6  AS 'DOM_VAR_PCT' 
CIAIRP/D10 AS 'INT_CURR' PIAIRP/D10 AS 'INT_PRIOR'
IAPVAR/D10 AS 'INT_VAR_VAL'  IAPVPCT/D6  AS 'INT_VAR_PCT'
CTAIRP/D10 AS 'DI_CURR' PTAIRP/D10 AS 'DI_PRIOR' TAPVAR/D10 AS 'DI_VAR_VAL'
TAPVPCT/D6  AS 'DI_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS AIRPCT
END
-RUN
 
TABLE FILE AIRPCT
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DOM_CURR
AND DOM_PRIOR AND DOM_VAR_VAL AND DOM_VAR_PCT AND INT_CURR AND INT_PRIOR
AND INT_VAR_VAL AND INT_VAR_PCT AND DI_CURR AND DI_PRIOR AND DI_VAR_VAL AND DI_VAR_PCT
ON TABLE HOLD AS AIRPCT1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM AIRPCT1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DOM_CURR DOM_PRIOR DOM_VAR_VAL DOM_VAR_PCT INT_CURR INT_PRIOR INT_VAR_VAL INT_VAR_PCT DI_CURR DI_PRIOR DI_VAR_VAL DI_VAR_PCT
ON NOMATCH INCLUDE
DATA ON AIRPCT1
END
-RUN
 
-* Car %
DEFINE FILE EXPHLD
CATEGORY/A30 = 'Summary';
CAT_ORDER/I2 = 5;
ROW_LABEL/A20 = 'Car %';
ROW_ORDER/I2 = 3;
END
TABLE FILE EXPHLD
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDCARP/D10 AS 'DOM_CURR' 
PDCARP/D10 AS 'DOM_PRIOR' DCPVAR/D10 AS 'DOM_VAR_VAL' DCPVPCT/D6  AS 'DOM_VAR_PCT' 
CICARP/D10 AS 'INT_CURR' PICARP/D10 AS 'INT_PRIOR'
ICPVAR/D10 AS 'INT_VAR_VAL'  ICPVPCT/D6  AS 'INT_VAR_PCT'
CTCARP/D10 AS 'DI_CURR' PTCARP/D10 AS 'DI_PRIOR' TCPVAR/D10 AS 'DI_VAR_VAL'
TCPVPCT/D6  AS 'DI_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS CARPCT
END
-RUN
 
TABLE FILE CARPCT
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DOM_CURR
AND DOM_PRIOR AND DOM_VAR_VAL AND DOM_VAR_PCT AND INT_CURR AND INT_PRIOR
AND INT_VAR_VAL AND INT_VAR_PCT AND DI_CURR AND DI_PRIOR AND DI_VAR_VAL AND DI_VAR_PCT
ON TABLE HOLD AS CARPCT1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM CARPCT1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DOM_CURR DOM_PRIOR DOM_VAR_VAL DOM_VAR_PCT INT_CURR INT_PRIOR INT_VAR_VAL INT_VAR_PCT DI_CURR DI_PRIOR DI_VAR_VAL DI_VAR_PCT
ON NOMATCH INCLUDE
DATA ON CARPCT1
END
-RUN

-* Hotel %

DEFINE FILE EXPHLD
CATEGORY/A30 = 'Summary';
CAT_ORDER/I2 = 5;
ROW_LABEL/A20 = 'Hotel %';
ROW_ORDER/I2 = 4;
END
TABLE FILE EXPHLD
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CDHTLP/D10 AS 'DOM_CURR' 
PDHTLP/D10 AS 'DOM_PRIOR' DHPVAR/D10 AS 'DOM_VAR_VAL' DHPVPCT/D6  AS 'DOM_VAR_PCT' 
CIHTLP/D10 AS 'INT_CURR' PIHTLP/D10 AS 'INT_PRIOR'
IHPVAR/D10 AS 'INT_VAR_VAL'  IHPVPCT/D6  AS 'INT_VAR_PCT'
CTHTLP/D10 AS 'DI_CURR' PTHTLP/D10 AS 'DI_PRIOR' THPVAR/D10 AS 'DI_VAR_VAL'
THPVPCT/D6  AS 'DI_VAR_PCT'
BY FLAG NOPRINT
ON TABLE HOLD AS HTLPCT
END
 -RUN
 
TABLE FILE HTLPCT
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DOM_CURR
AND DOM_PRIOR AND DOM_VAR_VAL AND DOM_VAR_PCT AND INT_CURR AND INT_PRIOR
AND INT_VAR_VAL AND INT_VAR_PCT AND DI_CURR AND DI_PRIOR AND DI_VAR_VAL AND DI_VAR_PCT
ON TABLE HOLD AS HTLPCT1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM HTLPCT1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DOM_CURR DOM_PRIOR DOM_VAR_VAL DOM_VAR_PCT INT_CURR INT_PRIOR INT_VAR_VAL INT_VAR_PCT DI_CURR DI_PRIOR DI_VAR_VAL DI_VAR_PCT
ON NOMATCH INCLUDE
DATA ON HTLPCT1
END
-RUN


-* YTD Total Expense 
DEFINE FILE EXPHLD
CATEGORY/A30 = 'Summary';
CAT_ORDER/I2 = 10;
ROW_LABEL/A20 = 'Total Expense';
ROW_ORDER/I2 = 1;
END
TABLE FILE EXPHLD
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CYDTOTEXP/D10 AS 'DYTD_CURR' 
PYDTOTEXP/D10 AS 'DYTD_PRIOR' DYEXPVAR/D10 AS 'DYTD_VAR_VAL' DYEXPVPCT/D6  AS 'DYTD_VAR_PCT' 
CYITOTEXP/D10 AS 'IYTD_CURR' PYITOTEXP/D10 AS 'IYTD_PRIOR'
IYEXPVAR/D10 AS 'IYTD_VAR_VAL'  IYEXPVPCT/D6  AS 'IYTD_VAR_PCT'
CYTOTEXP/D10 AS 'DIYTD_CURR' PYTOTEXP/D10 AS 'DIYTD_PRIOR' TYEXPVAR/D10 AS 'DIYTD_VAR_VAL'
TYEXPVPCT/D6  AS 'DIYTD_VAR_VAL'
BY FLAG NOPRINT
ON TABLE HOLD AS YTOTEXP
END
-RUN
 
TABLE FILE YTOTEXP
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DYTD_CURR
AND DYTD_PRIOR AND DYTD_VAR_VAL AND DYTD_VAR_PCT AND IYTD_CURR AND IYTD_PRIOR
AND IYTD_VAR_VAL AND IYTD_VAR_PCT AND DIYTD_CURR AND DIYTD_PRIOR AND DIYTD_VAR_VAL AND DIYTD_VAR_VAL
ON TABLE HOLD AS YTOTEXP1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM YTOTEXP1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DYTD_CURR DYTD_PRIOR DYTD_VAR_VAL DYTD_VAR_PCT IYTD_CURR IYTD_PRIOR IYTD_VAR_VAL IYTD_VAR_PCT DIYTD_CURR DIYTD_PRIOR DIYTD_VAR_VAL DIYTD_VAR_VAL
ON NOMATCH INCLUDE
DATA ON YTOTEXP1
END
-RUN 

-* YTD Air %

DEFINE FILE EXPHLD
CATEGORY/A30 = 'Summary';
CAT_ORDER/I2 = 10;
ROW_LABEL/A20 = 'Air %';
ROW_ORDER/I2 = 2;
END
TABLE FILE EXPHLD
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CYDAIRP/D10 AS 'DYTD_CURR' 
PYDAIRP/D10 AS 'DYTD_PRIOR' DYAPVAR/D10 AS 'DYTD_VAR_VAL' DYAPVPCT/D6  AS 'DYTD_VAR_PCT' 
CYIAIRP/D10 AS 'IYTD_CURR' PYIAIRP/D10 AS 'IYTD_PRIOR'
IYAPVAR/D10 AS 'IYTD_VAR_VAL'  IYAPVPCT/D6  AS 'IYTD_VAR_PCT'
CYTAIRP/D10 AS 'DIYTD_CURR' PYTAIRP/D10 AS 'DIYTD_PRIOR' TYAPVAR/D10 AS 'DIYTD_VAR_VAL'
TYAPVPCT/D6  AS 'DIYTD_VAR_VAL'
BY FLAG NOPRINT
ON TABLE HOLD AS YAIRPCT
END
-RUN
 
TABLE FILE YAIRPCT
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DYTD_CURR
AND DYTD_PRIOR AND DYTD_VAR_VAL AND DYTD_VAR_PCT AND IYTD_CURR AND IYTD_PRIOR
AND IYTD_VAR_VAL AND IYTD_VAR_PCT AND DIYTD_CURR AND DIYTD_PRIOR AND DIYTD_VAR_VAL AND DIYTD_VAR_VAL
ON TABLE HOLD AS YAIRPCT1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM YAIRPCT1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DYTD_CURR DYTD_PRIOR DYTD_VAR_VAL DYTD_VAR_PCT IYTD_CURR IYTD_PRIOR IYTD_VAR_VAL IYTD_VAR_PCT DIYTD_CURR DIYTD_PRIOR DIYTD_VAR_VAL DIYTD_VAR_VAL
ON NOMATCH INCLUDE
DATA ON YAIRPCT1
END
-RUN
 

-* YTD Car %

DEFINE FILE EXPHLD
CATEGORY/A30 = 'Summary';
CAT_ORDER/I2 = 10;
ROW_LABEL/A20 = 'Car %';
ROW_ORDER/I2 = 3;
END
TABLE FILE EXPHLD
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CYDCARP/D10 AS 'DYTD_CURR' 
PYDCARP/D10 AS 'DYTD_PRIOR' DYCPVAR/D10 AS 'DYTD_VAR_VAL' DYCPVPCT/D6  AS 'DYTD_VAR_PCT' 
CYICARP/D10 AS 'IYTD_CURR' PYICARP/D10 AS 'IYTD_PRIOR'
IYCPVAR/D10 AS 'IYTD_VAR_VAL'  IYCPVPCT/D6  AS 'IYTD_VAR_PCT'
CYTCARP/D10 AS 'DIYTD_CURR' PYTCARP/D10 AS 'DIYTD_PRIOR' TYCPVAR/D10 AS 'DIYTD_VAR_VAL'
TYCPVPCT/D6  AS 'DIYTD_VAR_VAL'
BY FLAG NOPRINT
ON TABLE HOLD AS YCARPCT
END
-RUN
 
TABLE FILE YCARPCT
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DYTD_CURR
AND DYTD_PRIOR AND DYTD_VAR_VAL AND DYTD_VAR_PCT AND IYTD_CURR AND IYTD_PRIOR
AND IYTD_VAR_VAL AND IYTD_VAR_PCT AND DIYTD_CURR AND DIYTD_PRIOR AND DIYTD_VAR_VAL AND DIYTD_VAR_VAL
ON TABLE HOLD AS YCARPCT1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM YCARPCT1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DYTD_CURR DYTD_PRIOR DYTD_VAR_VAL DYTD_VAR_PCT IYTD_CURR IYTD_PRIOR IYTD_VAR_VAL IYTD_VAR_PCT DIYTD_CURR DIYTD_PRIOR DIYTD_VAR_VAL DIYTD_VAR_VAL
ON NOMATCH INCLUDE
DATA ON YCARPCT1
END
-RUN

-* YTD Hotel %

DEFINE FILE EXPHLD
CATEGORY/A30 = 'Summary';
CAT_ORDER/I2 = 10;
ROW_LABEL/A20 = 'Hotel %';
ROW_ORDER/I2 = 4;
END
TABLE FILE EXPHLD
PRINT CATEGORY/A30  CAT_ORDER/I2  ROW_ORDER/I2   ROW_LABEL/A20  
CYDHTLP/D10 AS 'DYTD_CURR' 
PYDHTLP/D10 AS 'DYTD_PRIOR' DYHPVAR/D10 AS 'DYTD_VAR_VAL' DYHPVPCT/D6  AS 'DYTD_VAR_PCT' 
CYIHTLP/D10 AS 'IYTD_CURR' PYIHTLP/D10 AS 'IYTD_PRIOR'
IYHPVAR/D10 AS 'IYTD_VAR_VAL'  IYHPVPCT/D6  AS 'IYTD_VAR_PCT'
CYTHTLP/D10 AS 'DIYTD_CURR' PYTHTLP/D10 AS 'DIYTD_PRIOR' TYHPVAR/D10 AS 'DIYTD_VAR_VAL'
TYHPVPCT/D6  AS 'DIYTD_VAR_VAL'
BY FLAG NOPRINT
ON TABLE HOLD AS YHTLPCT
END
 -RUN
 
TABLE FILE YHTLPCT
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DYTD_CURR
AND DYTD_PRIOR AND DYTD_VAR_VAL AND DYTD_VAR_PCT AND IYTD_CURR AND IYTD_PRIOR
AND IYTD_VAR_VAL AND IYTD_VAR_PCT AND DIYTD_CURR AND DIYTD_PRIOR AND DIYTD_VAR_VAL AND DIYTD_VAR_VAL
ON TABLE HOLD AS YHTLPCT1
END
MODIFY FILE TC2_MAIN
FIXFORM FROM YHTLPCT1
MATCH CATEGORY ROW_LABEL CAT_ORDER ROW_ORDER
ON MATCH UPDATE DYTD_CURR DYTD_PRIOR DYTD_VAR_VAL DYTD_VAR_PCT IYTD_CURR IYTD_PRIOR IYTD_VAR_VAL IYTD_VAR_PCT DIYTD_CURR DIYTD_PRIOR DIYTD_VAR_VAL DIYTD_VAR_VAL
ON NOMATCH INCLUDE
DATA ON YHTLPCT1
END
-RUN
 
 

-GOTO XXITexp;
DEFINE FILE TC2_MAIN
KEY/A1 = IF CAT_ORDER EQ 3 THEN 'Y' ELSE 'N'; 
END         
TABLEF FILE TC2_MAIN
ON TABLE SET PAGE-NUM OFF
PRINT CATEGORY  AND CAT_ORDER AND ROW_ORDER AND ROW_LABEL AND DOM_CURR
AND DOM_PRIOR AND DOM_VAR_VAL AND DOM_VAR_PCT AND INT_CURR AND INT_PRIOR
AND INT_VAR_VAL AND INT_VAR_PCT AND DI_CURR AND DI_PRIOR AND DI_VAR_VAL AND DI_VAR_PCT AND DYTD_CURR
AND DYTD_PRIOR AND DYTD_VAR_VAL AND DYTD_VAR_PCT AND IYTD_CURR AND IYTD_PRIOR
AND IYTD_VAR_VAL AND IYTD_VAR_PCT AND DIYTD_CURR AND DIYTD_PRIOR AND DIYTD_VAR_VAL AND DIYTD_VAR_PCT

  
BY CAT_ORDER  
BY ROW_ORDER  
BY ROW_LABEL
ON TABLE SAVE
END
-RUN
-QUIT
-XXITexp