-* File advdrill3.fex
EX USESTEVE
END
-RUN

DEFINE FILE SR_50
FARE_PAID/D12.2 = SEG_AMT + SEG_TAX;
LOST_SAVINGS/D12.2 = FARE_PAID - SEG_LOWEST;
NET_TKT_CNT/D8CS    = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
NEW_ADV_PURCH/D9    = ADV_PURCH;
REC_CNT/D8CS = IF NET_TKT_CNT EQ 1 THEN 1 ELSE 0;
TTLDAYS/D8 = NEW_ADV_PURCH*REC_CNT;


06ADV_CNT/D12 = IF ADV_PURCH LT 7 THEN NET_TKT_CNT ELSE 0;
713ADV_CNT/D12 = IF ADV_PURCH GE 7 AND ADV_PURCH LE 13 THEN NET_TKT_CNT ELSE 0;
1420ADV_CNT/D12 = IF ADV_PURCH GE 14 AND ADV_PURCH LE 20 THEN NET_TKT_CNT ELSE 0;
21ADV_CNT/D12 = IF ADV_PURCH GT 20 THEN NET_TKT_CNT ELSE 0;

06ADV_FARE/D12.2 = IF ADV_PURCH LT 7 THEN FARE_PAID ELSE 0;
713ADV_FARE/D12.2 = IF ADV_PURCH GE 7 AND ADV_PURCH LE 13 THEN FARE_PAID ELSE 0;
1420ADV_FARE/D12.2 = IF ADV_PURCH GE 14 AND ADV_PURCH LE 20 THEN FARE_PAID ELSE 0;
21ADV_FARE/D12.2 = IF ADV_PURCH GT 20 THEN FARE_PAID ELSE 0;

END

TABLE FILE SR_50
SUM
     NET_TKT_CNT AS 'TKT,CNT'
     FARE_PAID AS 'FARE,PAID'
     LOST_SAVINGS AS 'LOST,SAVINGS'
     NEW_ADV_PURCH
     TTLDAYS
     REC_CNT
     06ADV_CNT
     713ADV_CNT
     1420ADV_CNT
     21ADV_CNT
     06ADV_FARE
     713ADV_FARE
     1420ADV_FARE
     21ADV_FARE
BY   TKT_SORT 
BY   AROLL_LEV2 
BY   AROLL_LEV3 AS 'TOTAL'
BY   AROLL_DSC3 AS ' '
BY   EMBARK
BY   SEG_NBR
WHERE VOID_DATE EQ 0;
WHERE TRN_DATE GE '20051001';
WHERE TRN_DATE LE '20051031';
WHERE AROLL_LEV2 EQ '&Lvl1';
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
FLAG/A1 = '|';
END

TABLE FILE HOLD
SUM
     06ADV_CNT AS '0 - 6,CNT'
     06ADV_FARE AS '0 - 6,FARE'
     FLAG/A1 AS ' '
     713ADV_CNT AS '7 - 13,CNT' 
     713ADV_FARE AS '7 - 13,FARE'
     FLAG AS ' '
     1420ADV_CNT AS '14 - 20,CNT'
     1420ADV_FARE AS '14 - 20,FARE'
     FLAG/A1 AS ' '
     21ADV_CNT AS '21+,CNT'
     21ADV_FARE AS '21+,FARE'
BY   AROLL_LEV3 NOPRINT
BY   AROLL_DSC3 AS ' '
ON TABLE SUBHEAD
" "
" "
" "
"TRANSACTION PERIOD:"
"10/01/2005 - 10/31/2005"
"JOINT Commission" 
"Advance Purchase by Hierarchy - multi-level drill down"
" "
HEADING
"<AROLL_LEV2"
ON TABLE SET PAGE-NUM OFF
ON TABLE SET ONLINE-FMT PDF
ON TABLE SET HTMLCSS ON
ON TABLE SET STYLE *
     UNITS=IN,
     PAGESIZE='Letter',
     LEFTMARGIN=0.250000,
     RIGHTMARGIN=0.250000,
     TOPMARGIN=0.250000,
     BOTTOMMARGIN=0.250000,
     SQUEEZE=ON,
     ORIENTATION=LANDSCAPE,
$
TYPE=REPORT,
     GRID=OFF,
     FONT='TIMES NEW ROMAN',
     SIZE=10,
     COLOR='BLACK',
     BACKCOLOR='NONE',
     STYLE=NORMAL,
$
TYPE=DATA,
     COLUMN=N2,
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='advdrill4' Lvl1=N1),
$
TYPE=DATA, 
     COLUMN=N3,
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='advdetail1' Lvl1=N1 Col='3'),
$ 
TYPE=DATA,
     COLUMN=N6,
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='advdetail1' Lvl1=N1 Col='6'),
$ 
TYPE=DATA,
     COLUMN=N9,
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='advdetail1' Lvl1=N1 Col='9'),
$ 
TYPE=DATA,
     COLUMN=N12,
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='advdetail1' Lvl1=N1 Col='12'),
$ 
TYPE=TABHEADING,
     LINE=6,
     SIZE=14,
     JUSTIFY=CENTER,
$
TYPE=TABHEADING,
     LINE=6,
     OBJECT=TEXT,
     ITEM=1,
     COLOR='BLACK',
     STYLE=BOLD,
$
TYPE=TABHEADING,
     LINE=7,
     SIZE=14,
     JUSTIFY=CENTER,
$
TYPE=TABHEADING,
     LINE=7,
     OBJECT=TEXT,
     ITEM=1,
     COLOR='BLACK',
     STYLE=BOLD,
$
TYPE=REPORT,
     IMAGE=JOINT.gif,
     POSITION=(.5 .3), SIZE=(2.0 .4),
$
TYPE=REPORT,
     IMAGE=logo15.gif,
     POSITION=(8.1 .5), SIZE=(1.3 .44),
$
ENDSTYLE
END
