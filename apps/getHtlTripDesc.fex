-* 09/14/16 - DLV - S-24785 -  Carried through EMP_ID LEVEL6 LEVEL7 TASF_TKT_NUM
-INCLUDE SETECHO
SET ASNAMES = ON



DEFINE FILE TRP_REF
TRIPKEY/A2 = EDIT(TRP_KEY, '$$$$$$$$99');
END
TABLE FILE TRP_REF
PRINT  TRP_DESC
BY TRIPKEY AS 'TRIP_PURPOSE'
IF TRP_KEY CONTAINS '&&ROLLUP.EVAL'
ON TABLE HOLD AS HTLTD
END
-RUN

DEFINE FILE HTLHOLD
TRIP_PURPOSE/A2 = EDIT(LEVEL5, '99');
END
TABLE FILE HTLHOLD
PRINT ACCT
  TYPE
  TSORT
  DV_NUM
  CITY1
  HTL_KEY
  DATE
  EMP_ID
  TRAN_DATE
  INVOICE_DATE
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3 
  LEVEL4
  LEVEL5
  LEVEL6
  LEVEL7
  AMOUNT
  TTL_COUNT
  DATE2
  SEG
  PASSNGR_NAME
  PNR_LOCATOR
  NAME
  STATUS
  TKT_NUM
  GEO_ZONE
  TASF_TKT_NUM
BY  TRIP_PURPOSE
ON TABLE HOLD AS HTLHLD2
END
-RUN


MATCH FILE HTLHLD2
PRINT ACCT
  TYPE
  TSORT
  DV_NUM
  CITY1
  HTL_KEY
  DATE
  EMP_ID
  TRAN_DATE
  INVOICE_DATE
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3 
  LEVEL4
  LEVEL5
  LEVEL6
  LEVEL7
  AMOUNT
  TTL_COUNT
  DATE2
  SEG
  PASSNGR_NAME
  PNR_LOCATOR
  NAME
  STATUS
  TKT_NUM
  GEO_ZONE
  TASF_TKT_NUM
BY TRIP_PURPOSE
ON TABLE HOLD 
RUN
FILE HTLTD
SUM TRP_DESC
BY TRIP_PURPOSE
AFTER MATCH HOLD AS XONE OLD 
END
-RUN

TABLE FILE XONE
PRINT ACCT
  TYPE
  TSORT
  DV_NUM
  CITY1
  HTL_KEY
  DATE
  EMP_ID
  TRAN_DATE
  INVOICE_DATE
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3 
  LEVEL4
  LEVEL5
  LEVEL6
  LEVEL7
  AMOUNT
  TTL_COUNT
  DATE2
  SEG
  PASSNGR_NAME
  PNR_LOCATOR
  NAME
  STATUS
  TKT_NUM
  TRIP_PURPOSE
  TRP_DESC
  GEO_ZONE
  TASF_TKT_NUM
ON TABLE HOLD AS HTLHOLD  
END
-RUN


