-* 02/19/16 - DLV - S-14918 CREATED FOR STAND ALONE PERIOD COMPARISON ANALYSIS


-INCLUDE SETECHO
-TYPE PC_ACHL_SUM
SET ASNAMES=ON 




DEFINE FILE PCAAIRAA 
ALBL1/A40 = 'Total Domestic Air Spend                '; 
ALBL2/A40 = 'Total International Air Spend           ';
ALBL3/A40 = 'Total Air Spend                         ';
ALBL4/A40 = 'Total Domestic Net Tickets              ';
ALBL5/A40 = 'Total International Net Tickets         ';
ALBL6/A40 = 'Total Net Tickets                       ';
RLBL1/A87 = '_______________________________________________________________________________________';
ALBL7/A40 = 'Total Air Transactions                  ';
ALBL8/A40 = 'Average Overall Ticket Price            ';
ALBL9/A40 = 'Average Domestic Ticket Price           ';
ALBL10/A40 = 'Average International Ticket Price      ';
ALBL11/A40 = 'Total Online Tickets                    ';
ALBL12/A40 = 'Online Booking Adoption %               ';
ALBL13/A40 = 'Domestic Online Booking Adoption %      ';
ALBL14/A40 = 'Advanced Purchase Days 0-6 %            ';
ALBL15/A40 = 'Advanced Purchase Days 7-13 %           ';
ALBL16/A40 = 'Advanced Purchase Days 14-20 %          ';
ALBL17/A40 = 'Advanced Purchase Days 21+ %            ';
 

END
-RUN
 
TABLE FILE PCAAIRAA
SUM  CADV1_TKT/P12 CADV2_TKT/P12 CADV3_TKT/P12 CADV4_TKT/P12 CADV1_FARE/D20
    CADV2_FARE/D20 CADV3_FARE/D20 CADV4_FARE/D20 CDNET_AMT/D20 CINET_AMT/D20
    CNET_AMT/D20 CNET_TKT/P12 CDNET_TKT/P12 CINET_TKT/P12 CDONL_TKTS/P12 CIONL_TKTS/P12 
    CNR/P12 CONL_TKTS/P12  CSTAY/D9   
      PADV1_TKT/P12 PADV2_TKT/P12 PADV3_TKT/P12
    PADV4_TKT/P12 PADV1_FARE/P12 PADV2_FARE/P12 PADV3_FARE/P12 PADV4_FARE/P12
    PDNET_AMT/D20 PINET_AMT/D20 PNET_AMT/D20 PDNET_TKT/P12 PINET_TKT/P12 PNET_TKT/P12
    PONL_TKTS/P12 PDONL_TKTS/P12 PIONL_TKTS/P12  
     PNR/P12 PSTAY/P12
    ALBL1 ALBL2 ALBL3 ALBL4 ALBL5 ALBL6   ALBL11 ALBL12
    ALBL13 ALBL14 ALBL15 ALBL16 ALBL17   RLBL
COMPUTE COTP/P12% = IF ((CNET_TKT LT 1) AND (CNET_TKT GT (-1))) THEN 0 ELSE (CONL_TKTS/CNET_TKT)*100;
COMPUTE POTP/P12% = IF ((PNET_TKT LT 1) AND (PNET_TKT GT (-1))) THEN 0 ELSE (PONL_TKTS/PNET_TKT)*100;
COMPUTE CDOTP/P12% = IF ((CDNET_TKT LT 1) AND (CDNET_TKT GT (-1))) THEN 0 ELSE (CDONL_TKTS/CDNET_TKT)*100;
COMPUTE CIOTP/P12% = IF ((CINET_TKT LT 1) AND (CINET_TKT GT (-1))) THEN 0 ELSE (CIONL_TKTS/CINET_TKT)*100;
COMPUTE PDOTP/P12% = IF ((PDNET_TKT LT 1) AND (PDNET_TKT GT (-1))) THEN 0 ELSE (PDONL_TKTS/PDNET_TKT)*100;
COMPUTE PIOTP/P12% = IF ((PINET_TKT LT 1) AND (PINET_TKT GT (-1))) THEN 0 ELSE (PIONL_TKTS/PINET_TKT)*100;
BY CLIENT
ON TABLE HOLD AS PCAA1
END
-RUN

-* Preferred Airline pct

TABLE FILE PREFAIRHLD
SUM CFARE AS 'CPREF' CNET_TKT AS 'CPREFT' 
BY CLIENT
BY VAL_AIRLINE
WHERE CPRF_AIR EQ 'P' 
ON TABLE HOLD AS PREFCUR
END
-RUN


TABLE FILE PREFAIRHLD
SUM PFARE AS 'PPREF'  PNET_TKT AS 'PPREFT' 
BY CLIENT
BY AIRLINE_NAME
BY VAL_AIRLINE
WHERE PPRF_AIR EQ 'P' 
ON TABLE HOLD AS PREFPR
END
-RUN


MATCH FILE PREFCUR
SUM CPREF CPREFT 
BY CLIENT
ON TABLE HOLD
RUN
FILE PREFPR
SUM PPREF PPREFT 
BY CLIENT
AFTER MATCH HOLD AS CPPREF OLD-OR-NEW
END
-RUN


TABLE FILE PREFAIRHLD
SUM CFARE AS 'CURNET'
    PFARE AS 'PRNET'
    CNET_TKT AS 'CURNETT'
    PNET_TKT AS 'PRNETT'
BY CLIENT
ON TABLE HOLD AS TOTNET
END
-RUN

MATCH FILE CPPREF
PRINT CPREF
      CPREFT
      PPREF
      PPREFT
BY CLIENT
ON TABLE HOLD
RUN
FILE TOTNET
SUM CURNET
    CURNETT
    PRNET
    PRNETT
BY CLIENT
AFTER MATCH HOLD AS PREFTOT OLD-OR-NEW
END
-RUN



TABLE FILE PREFTOT
SUM CURNET CURNETT PRNET PRNETT CPREF CPREFT PPREF PPREFT
COMPUTE CPRPCT/P12% = IF ((CURNET LT 1) AND (CURNET GT (-1))) THEN 0 ELSE (CPREF/CURNET) *100;
COMPUTE PPRPCT/P12% = IF ((PRNET LT 1) AND (PRNET GT (-1))) THEN 0 ELSE (PPREF/PRNET) *100;
COMPUTE CPRPCTT/P12% = IF ((CURNETT LT 1) AND (CURNETT GT (-1))) THEN 0 ELSE (CPREFT/CURNETT) *100;
COMPUTE PPRPCTT/P12% = IF ((PRNETT LT 1) AND (PRNETT GT (-1))) THEN 0 ELSE (PPREFT/PRNETT) *100;
BY CLIENT
ON TABLE HOLD AS NWPREFPCT
END
-RUN

MATCH FILE PCAA1 
PRINT  CADV1_TKT CADV2_TKT CADV3_TKT CADV4_TKT CADV1_FARE CADV2_FARE CADV3_FARE
    CADV4_FARE CDNET_AMT CINET_AMT CNET_AMT CNET_TKT CNR CDNET_TKT CINET_TKT CDONL_TKTS
    CIONL_TKTS CONL_TKTS  CSTAY
      PADV1_TKT PADV2_TKT PADV3_TKT PADV4_TKT PADV1_FARE PADV2_FARE
    PADV3_FARE PADV4_FARE PDNET_AMT PINET_AMT PNET_AMT PDNET_TKT PINET_TKT PNET_TKT
    PNR PONL_TKTS PDONL_TKTS PIONL_TKTS   PSTAY
    ALBL1 ALBL2 ALBL3 ALBL4 ALBL5 ALBL6   ALBL11 ALBL12
    ALBL13 ALBL14 ALBL15 ALBL16 ALBL17   RLBL
    CDOTP COTP PDOTP POTP CIOTP PIOTP
BY CLIENT
ON TABLE HOLD
RUN
FILE NWPREFPCT
SUM CPRPCT
    CPRPCTT
    PPRPCT
    PPRPCTT
    
BY CLIENT
AFTER MATCH HOLD AS PCAA2 OLD-OR-NEW
END
-RUN

 
TABLE FILE PCAHTLHLD
SUM CHAMT/D20 CHAMT1/D20 CHDAY/P12 CDHDAY/P12 CIHDAY/P12 CONLHDAY/P12 CDONLHDAY/P12 CIONLHDAY/P12
    CHBOOK/P12 CHBOOK1/P12 CDHBK/P12 CIHBK/P12 CONLHBK/P12 CDONLHBK/P12 CIONLHBK/P12 CPREF/P12 CPREF1/P12
    CROOMS/P12 PHAMT/D20 PHAMT1/D20 PHDAY/P12 PDHDAY/P12 PIHDAY/P12 PONLHDAY/P12 PDONLHDAY/P12
    PIONLHDAY/P12 PHBOOK/P12 PHBOOK1/P12 PDHBK/P12 PIHBK/P12 PONLHBK/P12 PDONLHBK/P12 PIONLHBK/P12    
    PPREF/P12 PPREF1/P12 PROOMS/P12 
COMPUTE CHAVG/D20 = IF ((CHDAY LT 1) AND (CHDAY GT (-1))) THEN 0 ELSE CHAMT/CHDAY;
COMPUTE PHAVG/D20 = IF ((PHDAY LT 1) AND (PHDAY GT (-1))) THEN 0 ELSE PHAMT/PHDAY;
COMPUTE CHONLP/P12% = IF ((CHBOOK LT 1) AND (CHBOOK GT (-1))) THEN 0 ELSE (CONLHBK/CHBOOK)*100;
COMPUTE CDHONLP/P12% = IF ((CDHBK LT 1) AND (CDHBK GT (-1))) THEN 0 ELSE (CDONLHBK/CDHBK)*100;
COMPUTE CIHONLP/P12% = IF ((CIHBK LT 1) AND (CIHBK GT (-1))) THEN 0 ELSE (CIONLHBK/CIHBK)*100;

COMPUTE PHONLP/P12% = IF ((PHBOOK LT 1) AND (PHBOOK GT (-1))) THEN 0 ELSE (PONLHBK/PHBOOK)*100;
COMPUTE PDHONLP/P12% = IF ((PDHBK LT 1) AND (PDHBK GT (-1))) THEN 0 ELSE (PDONLHBK/PDHBK)*100;
COMPUTE PIHONLP/P12% = IF ((PIHBK LT 1) AND (PIHBK GT (-1))) THEN 0 ELSE (PIONLHBK/PIHBK)*100;
BY CLIENT
ON TABLE HOLD AS PCAH1
END
-RUN





 
TABLE FILE PCACAR
SUM CCAMT/D20 CCDAY/P12 CDCDAY/P12 CICDAY/P12 CONLCDAY/P12 CDONLCDAY/P12
    CIONLCDAY/P12 CCBOOK/P12  CDCBK/P12 CICBK/P12  CONLCBK/P12
    CDONLCBK/P12 CIONLCBK/P12 PCAMT/D20 PCDAY/P12 PDCDAY/P12 PICDAY/P12
    PONLCDAY/P12 PDONLCDAY/P12 PIONLCDAY/P12 PCBOOK/P12 PDCBK/P12
    PICBK/P12 PONLCBK/P12 PDONLCBK/P12 PIONLCBK/P12  CCPREF/P12 CCPREF1/P12 PCPREF/P12 PCPREF1/P12
COMPUTE CCAVG/D20 = IF ((CCDAY LT 1) AND (CCDAY GT (-1))) THEN 0 ELSE CCAMT/CCDAY;
COMPUTE PCAVG/D20 = IF ((PCDAY LT 1) AND (PCDAY GT (-1))) THEN 0 ELSE PCAMT/PCDAY;
COMPUTE CCONLP/P12% = IF ((CCBOOK LT 1) AND (CCBOOK GT (-1))) THEN 0 ELSE (CONLCBK/CCBOOK)*100;
COMPUTE CDCONLP/P12% = IF ((CDCBK LT 1) AND (CDCBK GT (-1))) THEN 0 ELSE (CDONLCBK/CDCBK)*100;
COMPUTE CICONLP/P12% = IF ((CICBK LT 1) AND (CICBK GT (-1))) THEN 0 ELSE (CIONLCBK/CICBK)*100;
COMPUTE PCONLP/P12% = IF ((PCBOOK LT 1) AND (PCBOOK GT (-1))) THEN 0 ELSE (PONLCBK/PCBOOK)*100;
COMPUTE PDCONLP/P12% = IF ((PDCBK LT 1) AND (PDCBK GT (-1))) THEN 0 ELSE (PDONLCBK/PDCBK)*100;
COMPUTE PICONLP/P12% = IF ((PICBK LT 1) AND (PICBK GT (-1))) THEN 0 ELSE (PIONLCBK/PICBK)*100;
BY CLIENT
ON TABLE HOLD AS PCAC1
END
-RUN




 


 

MATCH FILE PCAA2
PRINT   CADV1_TKT CADV2_TKT CADV3_TKT CADV4_TKT CADV1_FARE CADV2_FARE
    CADV3_FARE CADV4_FARE CDNET_AMT CINET_AMT CNET_AMT CNET_TKT CNR
    CDNET_TKT CINET_TKT CDONL_TKTS CIONL_TKTS CONL_TKTS  
     CSTAY
    PADV1_TKT PADV2_TKT PADV3_TKT PADV4_TKT PADV1_FARE PADV2_FARE
    PADV3_FARE PADV4_FARE PDNET_AMT PINET_AMT PNET_AMT PDNET_TKT PINET_TKT
    PNET_TKT PNR PONL_TKTS PDONL_TKTS PIONL_TKTS 
     PSTAY
    ALBL1 ALBL2 ALBL3 ALBL4 ALBL5 ALBL6   ALBL11 ALBL12
    ALBL13 ALBL14 ALBL15 ALBL16 ALBL17   RLBL
     CDOTP COTP PDOTP POTP CIOTP PIOTP
      CPRPCT CPRPCTT PPRPCT PPRPCTT
BY CLIENT
ON TABLE HOLD
RUN
FILE PCAH1
SUM CHAMT CHAMT1 CHBOOK CHBOOK1 CHDAY PHAMT PHAMT1 PHBOOK PHBOOK1 PHDAY CHAVG PHAVG CHONLP CDHONLP CIHONLP PHONLP
    PDHONLP PIHONLP CPREF CPREF1 PPREF PPREF1 CROOMS PROOMS 
BY CLIENT
AFTER MATCH HOLD AS PCAAH1 OLD-OR-NEW
END
-RUN
 
 

MATCH FILE PCAAH1
PRINT   CADV1_TKT CADV2_TKT CADV3_TKT CADV4_TKT CADV1_FARE CADV2_FARE
    CADV3_FARE CADV4_FARE CDNET_AMT CINET_AMT CNET_AMT CNET_TKT CNR
    CDNET_TKT CINET_TKT CDONL_TKTS CIONL_TKTS CONL_TKTS  
      CSTAY
     PADV1_TKT PADV2_TKT PADV3_TKT PADV4_TKT PADV1_FARE PADV2_FARE
    PADV3_FARE PADV4_FARE PDNET_AMT PINET_AMT PNET_AMT PDNET_TKT PINET_TKT
    PNET_TKT PNR PONL_TKTS PDONL_TKTS PIONL_TKTS  
      PSTAY
    ALBL1 ALBL2 ALBL3 ALBL4 ALBL5 ALBL6   ALBL11 ALBL12
    ALBL13 ALBL14 ALBL15 ALBL16 ALBL17   RLBL CDOTP COTP PDOTP POTP CIOTP PIOTP
   CPRPCT CPRPCTT PPRPCT PPRPCTT 
-* Hotel Fields
    CHAMT CHAMT1 CHBOOK CHBOOK1 CHDAY PHAMT PHAMT1 PHBOOK PHBOOK1 PHDAY CHAVG PHAVG CHONLP CDHONLP CIHONLP PHONLP
    PDHONLP PIHONLP CPREF CPREF1 PPREF PPREF1 CROOMS PROOMS 
BY CLIENT
ON TABLE HOLD
RUN
FILE PCAC1
SUM CCAMT CCBOOK CCDAY PCAMT PCDAY CCAVG PCAVG PCBOOK CCONLP CDCONLP CICONLP PCONLP
    PDCONLP PICONLP CCPREF CCPREF1 PCPREF PCPREF1
BY CLIENT
AFTER MATCH HOLD AS PCAAHC1 OLD-OR-NEW
END
-RUN
 
 

 
 

