-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Created for the new quarterly review - JK 8/2/05
-******************************************************************************
-INCLUDE SETECHO
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

-SET &POS0=0;
-SET &INC = 11;
-SET &POS1T = &POS0 + 1 * &INC;

-*DOMESTIC 
-SET &POS1 = &POS1T + 0;
-SET &POS2 = &POS1T + 6;
-SET &POS3 = &POS1T + 12;
-SET &POS4 = &POS1T + 18;
-SET &POS5 = &POS1T + 24;
-SET &POS6 = &POS1T + 30;
-SET &POS7 = &POS1T + 36;
-SET &POS8 = &POS1T + 42;

-SET &POS1A = &POS1 - 1;
-SET &POS2A = &POS2 - 1;
-SET &POS3A = &POS3 - 1;
-SET &POS4A = &POS4 - 1;
-SET &POS5A = &POS5 - 1;
-SET &POS6A = &POS6 - 1;
-SET &POS7A = &POS7 - 1;
-SET &POS8A = &POS8 - 1;

-*INTL 
-SET &POSI1 = &POS0 + 67;
-SET &POSI2 = &POSI1 + 6;
-SET &POSI3 = &POSI2 + 6;
-SET &POSI4 = &POSI3 + 6;
-SET &POSI5 = &POSI4 + 6;
-SET &POSI6 = &POSI5 + 6;
-SET &POSI7 = &POSI6 + 6;
-SET &POSI8 = &POSI7 + 6;

-SET &POSI1A = &POSI1 - 1;
-SET &POSI2A = &POSI2 - 1;
-SET &POSI3A = &POSI3 - 1;
-SET &POSI4A = &POSI4 - 1;
-SET &POSI5A = &POSI5 - 1;
-SET &POSI6A = &POSI6 - 1;
-SET &POSI7A = &POSI7 - 1;
-SET &POSI8A = &POSI8 - 1;

-* YTD
-SET &POSYD1 = &POS0 + 82;
-SET &POSYD2 = &POSYD1 + 10;
-SET &POSYD3 = &POSYD2 + 10;
-SET &POSYD4 = &POSYD3 + 7;
-SET &POSYD5 = &POSYD4 + 7;
-SET &POSYD6 = &POSYD5 + 7;
-SET &POSYD7 = &POSYD6 + 6;
-SET &POSYD8 = &POSYD7 + 6;


-SET &POSYD1A = &POSYD1 - 1;
-SET &POSYD2A = &POSYD2 - 1;
-SET &POSYD3A = &POSYD3 - 1;
-SET &POSYD4A = &POSYD4 - 1;
-SET &POSYD5A = &POSYD5 - 1;
-SET &POSYD6A = &POSYD6 - 1;
-SET &POSYD7A = &POSYD7 - 1;
-SET &POSYD8A = &POSYD8 - 1;


DEFINE FILE SR_50  
-*  LEVEL_DESC/A60 = &&LDESC;
  FARE_PAID/D12 = SEG_AMT + SEG_TAX;
  NET_TKT_CNT/D10  =   IF (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) THEN 1 ELSE 
                        IF (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') AND (SEG_COUNT EQ -1)
				   THEN (-1) ELSE 
                        IF (DOC_TYPE NE '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') AND
				   (SEG_COUNT EQ -1)
				   THEN (-1) ELSE 0;

TKT_PURCH/D8CS      = IF (TICKET_CODE EQ '1') AND
                             (SEG_NBR EQ '01') AND
                             (FARE_PAID GE 0) AND
                             (SEG_COUNT EQ 1) AND 
                             (CONJ_REL EQ 1) THEN 1 ELSE 0;
-INCLUDE QRFTRANA
-* Defines on Previous Defines
  DISSAVINGS/D12 = IF EMBARK EQ 'DT1' THEN 0 ELSE
                         FARE_PAID - SEG_LOWEST;
  VASAVINGS/D12 = SEG_DISCOUNT - FARE_PAID;

END
-RUN

TABLEF FILE SR_50
PRINT AIR_MAIN.INTL_DOM AS 'INTL_DOM'
  DISSAVINGS
  DOC_TYPE	
  DOD_TYPE
  DPT_DATE	
  EMBARK	
  EX_FLAG	
  EXCHG_SALE
  FARE_PAID	
-*  LEVEL_DESC
  NET_TKT_CNT
  REFUSE_CODE
  RF_FLAG
  SEG_AMT	
  SEG_COM	
  SEG_COUNT
  SEG_NBR 	
  SEG_TAX 
  TKT_NUM
  TKT_PURCH	
  YEAR
  TRAN
  TRN_DATE
  VASAVINGS
  VOID_DATE 	
  VOID_STATUS 	
  CURRENT PRIOR PYTD CQ PQ

WHERE (TRN_DATE GE '&&FROMDT.EVAL') AND (TRN_DATE LE '&&TODT.EVAL') OR
      (TRN_DATE GE '&&FXDATE.EVAL') AND (TRN_DATE LE '&&TXDATE.EVAL')
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
WHERE VOID_DATE EQ 0
-INCLUDE RPTPARMS
ON TABLE HOLD AS RPTHOLD
END
-RUN

-* Domestic
TABLE FILE RPTHOLD
SUM FARE_PAID
    NET_TKT_CNT
-*BY QTR
BY TRAN
WHERE INTL_DOM EQ 'D'
ON TABLE SAVE AS DAIRS1 FORMAT ALPHA
END
-RUN

-*  Domestic Graph
TABLE FILE RPTHOLD
SUM FARE_PAID
    NET_TKT_CNT
WHERE INTL_DOM EQ 'D'
-*BY QTR
BY TRAN
ON TABLE HOLD AS DGHOLD
END
-RUN

-SET &G_DOMAT='N';
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' THEN GOTO AROUNDG;

GRAPH FILE DGHOLD
SUM FARE_PAID AS 'Volume'
    NET_TKT_CNT AS 'Net Tickets'
ACROSS TRAN AS ' '
ON GRAPH SET LOOKGRAPH VBAR2AX
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D OFF
ON GRAPH SET VZERO ON
ON GRAPH SET GRID OFF
ON GRAPH SET GRAPHSTYLE *
-* setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(0, new Color, 145 207 255));
setSeriesFillColor(1, new Color, 125 0 0));
setMarkerDisplay(true);
setUseSeriesShapes(true);
setConnectLineMarkers(true);
setConnectScatterMarkers(true);
setO1LabelDisplay(true);
setO1LabelRotate(0);
setAxisAssignment(0,0);
setSeriesType(0,1);
setAxisAssignment(1,1);
setSeriesType(1,2);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setY2MajorGridDisplay(false);
setY2MinorGridDisplay(false);
setTextFormatPreset(getY1Label(),6);
setTextFormatPreset(getY2Label(),-1);
setTextFormatPattern(getY2Label(),"#,###");
setPieFeelerTextDisplay(1);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(1);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(1);
setTitleString("Domestic");
setTextJustHoriz(getTitle(), 1);
setFontSizeAbsolute(getTitle(),true);
setFontStyle(getTitle(),0);
setFontSizeAbsolute(getTitle(),true);
setFontSizeAbsolute(getLegendText(),true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
ON GRAPH HOLD AS DOMAT FORMAT SVG
END
-RUN

-AROUNDG

-SET &G_DOMAT=IF &LINES GT 0 THEN 'Y' ELSE 'N';

-SET &TD1 = ' ';
-SET &TD2 = ' ';
-SET &TD3 = ' ';
-SET &TD4 = ' ';
-SET &TD5 = ' ';
-SET &TD6 = ' ';
-SET &TD7 = ' ';
-SET &TD8 = ' ';
-SET &FPD1 = ' ';
-SET &FPD2 = ' ';
-SET &FPD3 = ' ';
-SET &FPD4 = ' ';
-SET &FPD5 = ' ';
-SET &FPD6 = ' ';
-SET &FPD7 = ' ';
-SET &FPD8 = ' ';
-SET &TPD1 = ' ';
-SET &TPD2 = ' ';
-SET &TPD3 = ' ';
-SET &TPD4 = ' ';
-SET &TPD5 = ' ';
-SET &TPD6 = ' ';
-SET &TPD7 = ' ';
-SET &TPD8 = ' ';


-SET &CNT = 0;
-REPEAT TOEND &LINES TIMES
-SET &CNT = &CNT + 1;
-*-READ DAIRS1 NOCLOSE &Q.&CNT.1. &TD.&CNT.3. &FPD.&CNT.12. &TPD.&CNT.10.
-READ DAIRS1 NOCLOSE  &TD.7. &FPD.12. &TPD.10.
-SET &TD.&CNT = &TD;
EX FMTNUMBER VALUE=&FPD,LEN=14
-RUN
-SET &FPD.&CNT = &&RETVAL;

EX FMTNUMBER VALUE=&TPD,DOLLAR='N',LEN=14
-RUN
-SET &TPD.&CNT = &&RETVAL;
-TOEND 
-CLOSE DAIRS1

-* Domestic YTD
TABLE FILE RPTHOLD
SUM FARE_PAID
    NET_TKT_CNT
BY YEAR 
WHERE INTL_DOM EQ 'D'
WHERE PYTD EQ 'Y' OR CURRENT EQ 'Y'
ON TABLE SAVE AS YDAIR FORMAT ALPHA
END
-RUN

-SET &YEAR1 = ' ';
-SET &YEAR2 = ' ';
-SET &FPYD1 = ' ';
-SET &FPYD2 = ' ';
-SET &TPYD1 = ' ';
-SET &TPYD2 = ' ';

-SET &CNT = IF &LINES EQ 1 THEN 2 ELSE 1;
-REPEAT TOENDYD &LINES TIMES
-READ YDAIR NOCLOSE &YEAR.4. &FPYD.12. &TPYD.10.
-SET &YEAR.&CNT = &YEAR;
EX FMTNUMBER VALUE=&FPYD,LEN=14
-RUN
-SET &FPYD.&CNT = &&RETVAL;

EX FMTNUMBER VALUE=&TPYD,DOLLAR='N',LEN=14
-RUN
-SET &TPYD.&CNT = &&RETVAL;
-SET &CNT = &CNT + 1;
-TOENDYD 
-CLOSE YDAIR


DEFINE FILE RPTHOLD
FARE1 = IF (CURRENT EQ 'Y') AND (INTL_DOM EQ 'D') THEN FARE_PAID ELSE 0;
FARE2 = IF (PRIOR EQ 'Y') AND (INTL_DOM EQ 'D') THEN FARE_PAID ELSE 0;
NET_TKTS1/D10 = IF (CURRENT EQ 'Y') AND (INTL_DOM EQ 'D')  THEN NET_TKT_CNT ELSE 0;
NET_TKTS2/D10 = IF (PRIOR EQ 'Y') AND (INTL_DOM EQ 'D') THEN NET_TKT_CNT ELSE 0;
FLAG/A1 = 'A';
END
-RUN

TABLE FILE RPTHOLD
SUM FARE1 FARE2 FARE_PAID NET_TKTS1 NET_TKTS2 NET_TKT_CNT
BY FLAG
WHERE PYTD EQ 'Y' OR CURRENT EQ 'Y'
ON TABLE HOLD AS DYTD1
END

TABLE FILE DYTD1
SUM FARE1 FARE2 NET_TKTS1 NET_TKTS2
COMPUTE FARED/D12.2CS = FARE1 - FARE2; 
COMPUTE FARED1/D12.2CS = FARE2 + FARE1;
COMPUTE NET_TKTSD/D10CS = NET_TKTS1 - NET_TKTS2;
COMPUTE NET_TKTSD1/D10CS = NET_TKTS2 + NET_TKTS1;
COMPUTE FAREDP/D4 = IF ((FARE2 LT 0) AND (FARE2 GT (-1))) THEN 0 ELSE
                        ((FARED/FARE2)*100);
COMPUTE NET_TKTDP/D4 = IF ((NET_TKTS2 LT 0) AND (NET_TKTS2 LT (-1))) THEN 0 ELSE
                        ((NET_TKTSD/NET_TKTS2)*100);
COMPUTE DFAREDPT/D4 = IF ((FARE_PAID LT 1) AND (FARE_PAID LT (-1))) THEN 0 ELSE
                        ((FARED1/FARE_PAID)*100);
COMPUTE DNETTPCT/D4 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT LT (-1))) THEN 0 ELSE
                        ((NET_TKTSD1/NET_TKT_CNT)*100);
BY FLAG
ON TABLE HOLD AS DYTD2
END
-RUN

TABLE FILE DYTD2
PRINT FAREDP NET_TKTDP DFAREDPT DNETTPCT
BY FLAG
ON TABLE SAVE AS DYTDD FORMAT ALPHA
END
-RUN

-SET &FLAG1 = ' ';
-SET &FPDPCT1 = ' ';
-SET &TPDPCT1 = ' ';
-SET &DFAREDPT1 = ' ';
-SET &DNETTPCT1 = ' ';

-* Domestic YTD Percentages
-SET &CNT = 0;
-REPEAT TOENDP &LINES TIMES
-SET &CNT = &CNT + 1;
-READ DYTDD NOCLOSE &FLAG.1. &FPDPCT.4. &TPDPCT.4. &DFAREDPT.4. &DNETTPCT.4.
-SET &FLAG.&CNT = &FLAG;
-SET &FPDPCT.&CNT = FTOA(&FPDPCT,'(D4)','A5') | '%';
-SET &TPDPCT.&CNT = FTOA(&TPDPCT,'(D4)','A5') | '%';
-SET &DFAREDPT.&CNT = FTOA(&DFAREDPT,'(D4)','A5') | '%';
-SET &DNETTPCT.&CNT = FTOA(&DNETTPCT,'(D4)','A5') | '%';
-TOENDP 
-CLOSE DYTDD


-* INTERNATIONAL
TABLE FILE RPTHOLD
SUM FARE_PAID
    NET_TKT_CNT
BY TRAN
WHERE INTL_DOM EQ 'I'
ON TABLE SAVE AS IAIRS1 FORMAT ALPHA
END
-RUN



-SET &Q1 = ' ';
-SET &Q2 = ' ';
-SET &Q3 = ' ';
-SET &Q4 = ' ';
-SET &Q5 = ' ';
-SET &Q6 = ' ';
-SET &Q7 = ' ';
-SET &Q8 = ' ';
-SET &TI1 = ' ';
-SET &TI2 = ' ';
-SET &TI3 = ' ';
-SET &TI4 = ' ';
-SET &TI5 = ' ';
-SET &TI6 = ' ';
-SET &TI7 = ' ';
-SET &TI8 = ' ';
-SET &FPI1 = ' ';
-SET &FPI2 = ' ';
-SET &FPI3 = ' ';
-SET &FPI4 = ' ';
-SET &FPI5 = ' ';
-SET &FPI6 = ' ';
-SET &FPI7 = ' ';
-SET &FPI8 = ' ';
-SET &TPI1 = ' ';
-SET &TPI2 = ' ';
-SET &TPI3 = ' ';
-SET &TPI4 = ' ';
-SET &TPI5 = ' ';
-SET &TPI6 = ' ';
-SET &TPI7 = ' ';
-SET &TPI8 = ' ';


-SET &CNT = 0;
-REPEAT TOEND1 &LINES TIMES
-SET &CNT = &CNT + 1;
-READ IAIRS1 NOCLOSE &TI.7. &FPI.12. &TPI.10.
-SET &TI.&CNT = &TI;

EX FMTNUMBER VALUE=&FPI,LEN=14
-RUN
-SET &FPI.&CNT = &&RETVAL;

EX FMTNUMBER VALUE=&TPI,DOLLAR='N',LEN=14
-RUN
-SET &TPI.&CNT = &&RETVAL;
-TOEND1 
-CLOSE IAIRS1



-* International Graph
TABLE FILE RPTHOLD
SUM FARE_PAID
    NET_TKT_CNT
WHERE INTL_DOM EQ 'I'
BY TRAN
ON TABLE HOLD AS DGHOLD
END
-RUN
-SET &PRINTINTL = IF &LINES GT 0 THEN 'Y' ELSE 'N';

-SET &G_INTAT='N';
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' THEN GOTO AROUNDG1;

GRAPH FILE DGHOLD
SUM FARE_PAID AS 'Volume'
    NET_TKT_CNT AS 'Net Tickets'
ACROSS TRAN AS ' '
ON GRAPH SET LOOKGRAPH VBAR2AX
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D OFF
ON GRAPH SET VZERO ON
ON GRAPH SET GRID OFF
ON GRAPH SET GRAPHSTYLE *
-* setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(0, new Color, 145 207 255));
setSeriesFillColor(1, new Color, 125 0 0));
setMarkerDisplay(true);
setUseSeriesShapes(true);
setConnectLineMarkers(true);
setConnectScatterMarkers(true);
setO1LabelDisplay(true);
setO1LabelRotate(0);
setAxisAssignment(0,0);
setSeriesType(0,1);
setAxisAssignment(1,1);
setSeriesType(1,2);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setY2MajorGridDisplay(false);
setY2MinorGridDisplay(false);
setTextFormatPreset(getY1Label(),6);
setTextFormatPreset(getY2Label(),-1);
setTextFormatPattern(getY2Label(),"#,###");
setPieFeelerTextDisplay(1);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(1);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(1);
setTitleString("International");
setTextJustHoriz(getTitle(), 1);
setFontSizeAbsolute(getTitle(),true);
setFontStyle(getTitle(),0);
setFontSizeAbsolute(getTitle(),true);
setFontSizeAbsolute(getLegendText(),true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
ON GRAPH HOLD AS INTAT FORMAT SVG
END

-AROUNDG1
-SET &G_INTAT=IF &LINES GT 0 THEN 'Y' ELSE 'N';

-* International YTD
TABLE FILE RPTHOLD
SUM FARE_PAID
    NET_TKT_CNT CURRENT
BY YEAR 
WHERE INTL_DOM EQ 'I'
WHERE PYTD EQ 'Y' OR CURRENT EQ 'Y'
ON TABLE SAVE AS YIAIR FORMAT ALPHA
END
-RUN

-SET &YEAR1 = ' ';
-SET &YEAR2 = ' ';
-SET &FPYI1 = ' ';
-SET &FPYI2 = ' ';
-SET &TPYI1 = ' ';
-SET &TPYI2 = ' ';

-SET &CNT = IF &LINES EQ 1 THEN 2 ELSE 1;
-* -SET &CNT = &LINES;

-* changed on 11/10/06 due to current year no data
-IF &LINES EQ 1 THEN GOTO READONE ELSE GOTO READTWO;
-READONE
-READ YIAIR &YEAR.&CNT.4. &FPYI.12. &TPYI.10. &CURRENT.1.
EX FMTNUMBER VALUE=&FPYI,LEN=12
-RUN
-SET &FPYI = &&RETVAL;

EX FMTNUMBER VALUE=&TPYI,DOLLAR='N',LEN=12
-RUN
-SET &TPYI = &&RETVAL;

-SET &FPYI1 = IF &CURRENT EQ 'N' THEN &FPYI ELSE '';
-SET &FPYI2 = IF &CURRENT EQ 'Y' THEN &FPYI ELSE '';
-SET &TPYI1 = IF &CURRENT EQ 'N' THEN &TPYI ELSE '';
-SET &TPYI2 = IF &CURRENT EQ 'Y' THEN &TPYI ELSE '';
-* end of changed on 11/10/06 due to current year no data
-GOTO TOENDYI


-READTWO
-REPEAT TOENDYI &LINES TIMES
-READ YIAIR NOCLOSE &YEAR.&CNT.4. &FPYI.12. &TPYI.10. &CURRENT.1.
EX FMTNUMBER VALUE=&FPYI,LEN=12
-RUN
-SET &FPYI.&CNT = &&RETVAL;

EX FMTNUMBER VALUE=&TPYI,DOLLAR='N',LEN=12
-RUN
-SET &TPYI.&CNT = &&RETVAL;
-SET &CNT = &CNT + 1;
-TOENDYI 
-CLOSE YIAIR



DEFINE FILE RPTHOLD
FAREI1 = IF (CURRENT EQ 'Y') AND (INTL_DOM EQ 'I') THEN FARE_PAID ELSE 0;
FAREI2 = IF (PRIOR EQ 'Y') AND (INTL_DOM EQ 'I') THEN FARE_PAID ELSE 0;
NET_TKTSI1/D10 = IF (CURRENT EQ 'Y') AND (INTL_DOM EQ 'I')  THEN NET_TKT_CNT ELSE 0;
NET_TKTSI2/D10 = IF (PRIOR EQ 'Y') AND (INTL_DOM EQ 'I') THEN NET_TKT_CNT ELSE 0;
FLAG/A1 = 'A';
END
-RUN

TABLE FILE RPTHOLD
SUM FAREI1 FAREI2 FARE_PAID NET_TKTSI1 NET_TKTSI2 NET_TKT_CNT
BY FLAG
WHERE PYTD EQ 'Y' OR CURRENT EQ 'Y'
ON TABLE HOLD AS IYTD1
END

TABLE FILE IYTD1
SUM FAREI1 FAREI2 NET_TKTSI1 NET_TKTSI2
COMPUTE FAREI3/D12.2CS = FAREI1 - FAREI2; 
COMPUTE FAREI4/D12.2CS = FAREI2 + FAREI1;
COMPUTE NET_TKTSI3/D10CS = NET_TKTSI1 - NET_TKTSI2;
COMPUTE NET_TKTSI4/D10CS = NET_TKTSI1 + NET_TKTSI2;
COMPUTE FAREIP/D4 = IF ((FAREI2 LT 0) AND (FAREI2 GT (-1))) THEN 0 ELSE
                        ((FAREI3/FAREI2)*100);
COMPUTE NET_TKTIP/D4 = IF ((NET_TKTSI2 LT 0) AND (NET_TKTSI2 LT (-1))) THEN 0 ELSE
                        ((NET_TKTSI3/NET_TKTSI2)*100);
COMPUTE IFAREDPT/D4 = IF ((FARE_PAID LT 1) AND (FARE_PAID LT (-1))) THEN 0 ELSE
                        ((FAREI4/FARE_PAID)*100);
COMPUTE INETTPCT/D4 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT LT (-1))) THEN 0 ELSE
                        ((NET_TKTSI4/NET_TKT_CNT)*100);
BY FLAG
ON TABLE HOLD AS IYTD2
END
-RUN

TABLE FILE IYTD2
PRINT FAREIP NET_TKTIP IFAREDPT INETTPCT
BY FLAG
ON TABLE SAVE AS IYTDD FORMAT ALPHA
END
-RUN

-* INTERNATIONAL VARIANCE/PERCENTAGE
-SET &FLAG1 = ' ';
-SET &FPIPCT1 = ' ';
-SET &TPIPCT1 = ' ';
-SET &IFAREDPT1 = ' ';
-SET &INETTPCT1 = ' ';
-* International YTD Percentages
-SET &CNT = 0;
-REPEAT TOENIP &LINES TIMES
-SET &CNT = &CNT + 1;
-READ IYTDD NOCLOSE &FLAG.&CNT.1. &FPIPCT.4. &TPIPCT.4. &IFAREDPT.4. &INETTPCT.4.
-SET &FPIPCT.&CNT = FTOA(&FPIPCT,'(D4)','A5') | '%';
-SET &TPIPCT.&CNT = FTOA(&TPIPCT,'(D4)','A5') | '%';
-SET &IFAREDPT.&CNT = FTOA(&IFAREDPT,'(D4)','A5') | '%';
-SET &INETTPCT.&CNT = FTOA(&INETTPCT,'(D4)','A5') | '%';
-TOENIP 
-CLOSE IYTDD

-* Total
TABLE FILE RPTHOLD
SUM FARE_PAID
    NET_TKT_CNT
-*BY QTR
BY TRAN
ON TABLE SAVE AS TAIRS1 FORMAT ALPHA
END
-RUN

-SET &TT1 = ' ';
-SET &TT2 = ' ';
-SET &TT3 = ' ';
-SET &TT4 = ' ';
-SET &TT5 = ' ';
-SET &TT6 = ' ';
-SET &TT7 = ' ';
-SET &TT8 = ' ';
-SET &FPT1 = ' ';
-SET &FPT2 = ' ';
-SET &FPT3 = ' ';
-SET &FPT4 = ' ';
-SET &FPT5 = ' ';
-SET &FPT6 = ' ';
-SET &FPT7 = ' ';
-SET &FPT8 = ' ';
-SET &TPT1 = ' ';
-SET &TPT2 = ' ';
-SET &TPT3 = ' ';
-SET &TPT4 = ' ';
-SET &TPT5 = ' ';
-SET &TPT6 = ' ';
-SET &TPT7 = ' ';
-SET &TPT8 = ' ';


-SET &CNT = 0;
-REPEAT TOEND2 &LINES TIMES
-SET &CNT = &CNT + 1;
-READ TAIRS1 NOCLOSE &TD.7. &FPT.12. &TPT.10.
-SET &TD.&CNT = &TD;
-*-SET &FPT.&CNT = FTOA(&FPT,'(D9M)','A11');
EX FMTNUMBER VALUE=&FPT,LEN=14
-RUN
-SET &FPT.&CNT =&&RETVAL;
-*-SET &TPT.&CNT = FTOA(&TPT,'(D10M)','A12');
EX FMTNUMBER VALUE=&TPT,DOLLAR='N',LEN=14
-RUN
-SET &TPT.&CNT =&&RETVAL;
-TOEND2 
-CLOSE TAIRS1

-* Total Graph
TABLE FILE RPTHOLD
SUM FARE_PAID
    NET_TKT_CNT
-*BY QTR
BY TRAN
ON TABLE HOLD AS TGHOLD
END
-RUN

-TYPE BEFORE AROUNDG2

-* Comment lines for prior YTD vs current YTD
-* check if there is need to compare current YTD to prior YTD
-SET &CLINE1 = '';
-SET &CLINE2 = '';
-SET &CLINE3 = '';
-SET &CLINE4 = '';

TABLE FILE RPTHOLD
BY TRAN
WHERE PRIOR EQ 'Y' 
ON TABLE HOLD
END
-RUN
-*
-SET &PRIORYR = IF &LINES EQ 4 THEN 'Y' ELSE 'N';
-IF &LINES LT 4 THEN GOTO ENDYTDCOMM;

-*get values for comments
TABLE FILE RPTHOLD
SUM FARE_PAID
    NET_TKT_CNT 
    CURRENT PRIOR PYTD PQ CQ
BY YEAR
BY TRAN
WHERE PYTD EQ 'Y' OR CURRENT EQ 'Y'
ON TABLE HOLD
END
-RUN

-*get values for comments - Current YEAR via last YEAR
DEFINE FILE HOLD
  PFARE/D12 = IF PYTD EQ 'Y'    THEN FARE_PAID ELSE 0;
  CFARE/D12 = IF CURRENT EQ 'Y' THEN FARE_PAID ELSE 0;
  PTKT/D12  = IF PYTD EQ 'Y'    THEN NET_TKT_CNT ELSE 0;
  CTKT/D12  = IF CURRENT EQ 'Y' THEN NET_TKT_CNT ELSE 0;
END
TABLE FILE HOLD
SUM PFARE CFARE PTKT CTKT
  
  COMPUTE FLAGPF/A1 = IF PFARE EQ 0 THEN 'Y' ELSE 'N';
  COMPUTE FLAGPT/A1 = IF PTKT EQ 0 THEN 'Y' ELSE 'N';
  
  COMPUTE YFRATIO/D3 = IF FLAGPF EQ 'N' THEN (CFARE - PFARE)/PFARE * 100 ELSE 0;
  COMPUTE YTRATIO/D3 = IF FLAGPT EQ 'N' THEN (CTKT - PTKT)/PTKT * 100 ELSE 0;
  
  COMPUTE ABSYFR/D3 = ABS(YFRATIO);
  COMPUTE ABSYTR/D3 = ABS(YTRATIO);
  
  COMPUTE FINC/A12 = IF YFRATIO GT 0 THEN 'increased' ELSE IF YFRATIO LT 0 THEN 'decreased' ELSE 'remains same';
  COMPUTE TINC/A12 = IF YTRATIO GT 0 THEN 'increased' ELSE IF YTRATIO LT 0 THEN 'decreased' ELSE 'remains same'; 
ON TABLE SAVE
END
-RUN
-READ SAVE &X.48. &FLAGPF.1. &FLAGPT.1. &X.6. &ABSYFR.3. &ABSYTR.3. &FINC.12. &TINC.12.

EX FMTNUMBER VALUE=&ABSYFR,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSYFR = &&RETVAL;

EX FMTNUMBER VALUE=&ABSYTR,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSYTR = &&RETVAL;

-SET &CLINE1 = IF &FLAGPF EQ 'N' THEN
- 'Total air volume &FINC.EVAL' || '&ABSYFR.EVAL' || '% while net tickets' ELSE ' ';
-SET &CLINE2 = IF &FLAGPF EQ 'N' THEN '&TINC.EVAL' || '&ABSYTR.EVAL' || '% YTD.' ELSE ' ';

-ENDYTDCOMM

-*get values for comments - current Q via same Q in last year
TABLE FILE RPTHOLD
SUM FARE_PAID NET_TKT_CNT CURRENT PRIOR TRAN CQ PQ
BY YEAR
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
ON TABLE HOLD AS HOLD2
END
-RUN
-IF &LINES NE 2 THEN GOTO ENDQCOMM;

DEFINE FILE HOLD2
  PFARE/D12 = IF PQ EQ 'Y' THEN FARE_PAID ELSE 0;
  CFARE/D12 = IF CQ EQ 'Y' THEN FARE_PAID ELSE 0;
  PTKT/D12  = IF PQ EQ 'Y' THEN NET_TKT_CNT ELSE 0;
  CTKT/D12  = IF CQ EQ 'Y' THEN NET_TKT_CNT ELSE 0; 
END

TABLE FILE HOLD2
SUM PFARE CFARE PTKT CTKT FST.TRAN LST.TRAN
  COMPUTE FLAGPF/A1 = IF PFARE EQ 0 THEN 'Y' ELSE 'N';
  COMPUTE FLAGPT/A1 = IF PTKT EQ 0 THEN 'Y' ELSE 'N';
  
  COMPUTE QFRATIO/D5 = IF FLAGPF EQ 'N' THEN (CFARE - PFARE)/PFARE * 100 ELSE 0;
  COMPUTE QTRATIO/D5 = IF FLAGPT EQ 'N' THEN (CTKT - PTKT)/PTKT * 100 ELSE 0;
  
  COMPUTE ABSQFR/D5 = ABS(QFRATIO);
  COMPUTE ABSQTR/D5 = ABS(QTRATIO);
  
  COMPUTE FINC/A12 = IF QFRATIO GT 0 THEN 'increased' ELSE IF QFRATIO LT 0 THEN 'decreased' ELSE 'remains same';
  COMPUTE TINC/A12 = IF QTRATIO GT 0 THEN 'increased' ELSE IF QTRATIO LT 0 THEN 'decreased' ELSE 'remains same'; 
  ON TABLE SAVE
END
-RUN
 
-READ SAVE &X.48. &PTRAN.7. &CTRAN.7.7 &FLAGPF.1. &FLAGPT.1. &X.10. &ABSYFR.5. &ABSYTR.5. &FINC.12. &TINC.12.

EX FMTNUMBER VALUE=&ABSYFR,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSYFR = &&RETVAL;

EX FMTNUMBER VALUE=&ABSYTR,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSYTR = &&RETVAL;

-SET &CLINE3 = IF &FLAGPF EQ 'N' THEN
- 'Total air volume &FINC.EVAL' || '&ABSYFR.EVAL' || '% while net tickets' ELSE ' ';
-SET &CLINE4 = IF &FLAGPF EQ 'N' THEN '&TINC.EVAL' || '&ABSYTR.EVAL' || '% &CTRAN.EVAL over &PTRAN.EVAL' | '.' ELSE ' ';
-TYPE &CLINE3
-TYPE &CLINE4
-ENDQCOMM
-*** The end of comment section ***

-SET &G_TTLAT= 'N';
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' THEN GOTO AROUNDG2;

GRAPH FILE TGHOLD
SUM FARE_PAID AS 'Volume'
NET_TKT_CNT AS 'Net Tickets'
ACROSS TRAN AS ' '
ON GRAPH SET LOOKGRAPH VBAR2AX
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D OFF
ON GRAPH SET VZERO ON
ON GRAPH SET GRID OFF
ON GRAPH SET GRAPHSTYLE *
-*  setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(0, new Color, 145 207 255));
setSeriesFillColor(1, new Color, 125 0 0));
setMarkerDisplay(true);
setUseSeriesShapes(true);
setConnectLineMarkers(true);
setConnectScatterMarkers(true);
setO1LabelDisplay(true);
setO1LabelRotate(0);
setAxisAssignment(0,0);
setSeriesType(0,1);
setAxisAssignment(1,1);
setSeriesType(1,2);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setY2MajorGridDisplay(false);
setY2MinorGridDisplay(false);
setTextFormatPreset(getY1Label(),6);
setTextFormatPreset(getY2Label(),-1);
setTextFormatPattern(getY2Label(),"#,###");
setPieFeelerTextDisplay(1);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(1);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(1);
setTitleString("Total");
setTextJustHoriz(getTitle(), 1);
setFontSizeAbsolute(getTitle(),true);
setFontStyle(getTitle(),0);
setFontSizeAbsolute(getTitle(),true);
setFontSizeAbsolute(getLegendText(),true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
ON GRAPH HOLD AS TTLAT FORMAT SVG
END
-RUN

-AROUNDG2

-SET &G_TTLAT=IF &LINES GT 0 THEN 'Y' ELSE 'N';

-* Total YTD
TABLE FILE RPTHOLD
SUM FARE_PAID
    NET_TKT_CNT
BY YEAR 
WHERE PYTD EQ 'Y' OR CURRENT EQ 'Y'
ON TABLE SAVE AS YTAIR FORMAT ALPHA
END
-RUN

-SET &YEAR1 = ' ';
-SET &YEAR2 = ' ';
-SET &FPYT1 = ' ';
-SET &FPYT2 = ' ';
-SET &TPYT1 = ' ';
-SET &TPYT2 = ' ';

-SET &CNT = IF &LINES EQ 1 THEN 2 ELSE 1;
-REPEAT TOENDYT &LINES TIMES
-READ YTAIR NOCLOSE &YEAR.&CNT.4. &FPYT.12. &TPYT.10.

EX FMTNUMBER VALUE = &FPYT,LEN=14
-RUN
-SET &FPYT.&CNT = &&RETVAL;

EX FMTNUMBER VALUE = &TPYT,DOLLAR='N',LEN=14
-RUN
-SET &TPYT.&CNT = &&RETVAL;
-SET &CNT = &CNT + 1;
-TOENDYT 
-CLOSE YTAIR

DEFINE FILE RPTHOLD
FARET1 = IF CURRENT EQ 'Y' THEN FARE_PAID ELSE 0;
FARET2 = IF PRIOR EQ 'Y' THEN FARE_PAID ELSE 0;
NET_TKTST1/D10 = IF CURRENT EQ 'Y' THEN NET_TKT_CNT ELSE 0;
NET_TKTST2/D10 = IF PRIOR EQ 'Y' THEN NET_TKT_CNT ELSE 0;
FLAG/A1 = 'A';
END
-RUN

TABLE FILE RPTHOLD
SUM FARET1 FARET2 NET_TKTST1 NET_TKTST2 
BY FLAG
WHERE CURRENT EQ 'Y' OR PYTD EQ 'Y'
ON TABLE HOLD AS IYTD1
END

TABLE FILE IYTD1
SUM FARET1 FARET2 NET_TKTST1 NET_TKTST2
COMPUTE FARET3/D12.2CS = FARET1 - FARET2; 
COMPUTE NET_TKTST3/D10CS = NET_TKTST1 - NET_TKTST2;
COMPUTE FARETP/D4 = IF ((FARET2 LT 0) AND (FARET2 GT (-1))) THEN 0 ELSE
                        ((FARET3/FARET2)*100);
COMPUTE NET_TKTTP/D4 = IF ((NET_TKTST2 LT 0) AND (NET_TKTST2 LT (-1))) THEN 0 ELSE
                        ((NET_TKTST3/NET_TKTST2)*100);
BY FLAG
ON TABLE HOLD AS TYTD2
END
-RUN

TABLE FILE TYTD2
PRINT FARETP NET_TKTTP 
BY FLAG
ON TABLE SAVE AS TYTDD FORMAT ALPHA
END
-RUN

-* Total Year Variance
-SET &FLAG1 = ' ';
-SET &FPTPCT1 = ' ';
-SET &TPTPCT1 = ' ';
-SET &CNT = 0;
-REPEAT TOENTP &LINES TIMES
-SET &CNT = &CNT + 1;
-READ TYTDD NOCLOSE &FLAG.&CNT.1. &FPTPCT.4. &TPTPCT.4. 
-SET &FPTPCT.&CNT = FTOA(&FPTPCT,'(D4)','A5') | '%'; 
-SET &TPTPCT.&CNT = FTOA(&TPTPCT,'(D4)','A5') | '%'; 
-TOENTP 
-CLOSE TYTDD


-*set conditional print lines for international travel
-SET &DLINEX =' ____________________________________________________________________________________________________________';
-SET &ILINEX ='<60 ________________________________________________________________________________________________________';

-SET &DLINEX2 ='|____________________________________________________________________________________________________________<59 |';
-SET &ILINEX2 ='<60 |________________________________________________________________________________________________________<115 |';

-SET &DLINE1 ='|                  <9 | <&POS1 &TD1  <&POS2A | <&POS2 &TD2 <&POS3A | <&POS3 &TD3 <&POS4A | <&POS4 &TD4 <&POS5A | <&POS5 &TD5 <&POS6A | <&POS6 &TD6 <&POS7A | <&POS7 &TD7 <&POS8A | <&POS8 &TD8 <59 |';
-SET &DLINEY ='|_____________________________________________________________________________________________________________<59 |';
-SET &DLINE2 = '|Domestic Spend   <9 |&FPD1 <&POS2A |&FPD2 <&POS3A |&FPD3 <&POS4A |&FPD4 <&POS5A |&FPD5 <&POS6A |&FPD6 <&POS7A |&FPD7 <&POS8A |&FPD8 <59 |';
-SET &DLINE3 = '|Domestic Tickets <9 |&TPD1 <&POS2A |&TPD2 <&POS3A |&TPD3 <&POS4A |&TPD4 <&POS5A |&TPD5 <&POS6A |&TPD6 <&POS7A |&TPD7 <&POS8A |&TPD8 <59 |';

-SET &ILINE1 = '<60 | <&POSI1A | <&POSI1 &TI1  <&POSI2A | <&POSI2 &TI2  <&POSI3A | <&POSI3 &TI3  <&POSI4A | <&POSI4 &TI4 <&POSI5A | <&POSI5 &TI5 <&POSI6A | <&POSI6 &TI6 <&POSI7A | <&POSI7 &TI7 <&POSI8A | <&POSI8 &TI8 <115 |';
-SET &ILINEY = '<60 |________________________________________________________________________________________________________<115 |';
-SET &ILINE2 = '<60 | <61 Intl Spend   <&POSI1A |&FPI1 <&POSI2A |&FPI2 <&POSI3A |&FPI3 <&POSI4A |&FPI4 <&POSI5A |&FPI5 <&POSI6A |&FPI6 <&POSI7A |&FPI7 <&POSI8A |&FPI8 <115 |';
-SET &ILINE3 = '<60 | <61 Intl Tickets <&POSI1A |&TPI1 <&POSI2A |&TPI2 <&POSI3A |&TPI3 <&POSI4A |&TPI4 <&POSI5A |&TPI5 <&POSI6A |&TPI6 <&POSI7A |&TPI7 <&POSI8A |&TPI8 <115 |';


-*if no pytd data, set these variables to blanks
-SET &FPDPCT1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &FPDPCT1 ELSE ' ';
-SET &TPDPCT1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &TPDPCT1 ELSE ' ';
-SET &FPIPCT1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &FPIPCT1 ELSE ' ';
-SET &TPIPCT1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &TPIPCT1 ELSE ' ';
-SET &FPTPCT1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &FPTPCT1 ELSE ' ';
-SET &TPTPCT1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &TPTPCT1 ELSE ' ';

-SET &FPYD1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &FPYD1 ELSE ' ';
-SET &TPYD1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &TPYD1 ELSE ' ';
-SET &FPYI1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &FPYI1 ELSE ' ';
-SET &TPYI1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &TPYI1 ELSE ' ';
-SET &FPYT1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &FPYT1 ELSE ' ';
-SET &TPYT1 = IF '&PRIORYR.EVAL' EQ 'Y' THEN &TPYT1 ELSE ' ';

-*if no pytd data,set &year1 lable in the column heading
-SET &TEMP = EDIT('&YEAR2.EVAL','$$99');
-SET &TEMP = &TEMP -1;
-SET &TEMP = IF &TEMP LE 9 THEN '0' | '&TEMP.EVAL' ELSE '&TEMP.EVAL';
-SET &TEMP = 'YTD' | EDIT('&YEAR2.EVAL','99') | '&TEMP.EVAL';
-SET &YEAR1 = IF '&YEAR1.EVAL' NE ' ' THEN 'YTD&YEAR1.EVAL' ELSE '&TEMP.EVAL'; 

-SET &YEAR2 = 'YTD&YEAR2.EVAL';

TABLE FILE BRPTINST
HEADING 
" "
BY INST_KEY NOPRINT
ON TABLE SET PAGE-NUM OFF
&&OUTLINE1
&&OUTLINE2
FOOTING
"</24"
-IF &PRINTINTL EQ 'Y' THEN GOTO PRINTBOTH;

"&DLINEX.EVAL"
"&DLINE1.EVAL"
"&DLINEY.EVAL"
"&DLINE2.EVAL"
"&DLINEY.EVAL"
"&DLINE3.EVAL"
"&DLINEX2.EVAL"
-GOTO PRINTCOM;

-PRINTBOTH
"&DLINEX.EVAL   &ILINEX.EVAL"
"&DLINE1.EVAL   &ILINE1.EVAL"
"&DLINEY.EVAL   &ILINEY.EVAL"
"&DLINE2.EVAL   &ILINE2.EVAL"
"&DLINEY.EVAL   &ILINEY.EVAL"
"&DLINE3.EVAL   &ILINE3.EVAL"
"&DLINEX2.EVAL  &ILINEX2.EVAL"

-PRINTCOM
"</1"
"    <67 &CLINE1 "
"    <67 &CLINE2 "
"</1 <67 &CLINE3 "
"    <67 &CLINE4 "
"</13"
" <&POSYD1A Year to Date Spend and Net Tickets  "
"<67  __________________________________________________________________________________________"
"<67 | <68                  <&POSYD1A | <&POSYD1    &YEAR2 <&POSYD2A | <&POSYD2    &YEAR1 <&POSYD3A | <&POSYD3 Variance <&POSYD4A | <&POSYD4 % of Total <&POSYD5A |"
"<67 |__________________________________________________________________________________________<&POSYD5A |"
"<67 | <68 Domestic Spend   <&POSYD1A | <&POSYD1 &FPYD2       <&POSYD2A | <&POSYD2 &FPYD1 <&POSYD3A | <&POSYD3 &FPDPCT1 <&POSYD4A | <&POSYD4 &DFAREDPT1 <&POSYD5A |"
"<67 |__________________________________________________________________________________________<&POSYD5A |"
"<67 | <68 Domestic Tickets <&POSYD1A | <&POSYD1 &TPYD2       <&POSYD2A | <&POSYD2 &TPYD1 <&POSYD3A | <&POSYD3 &TPDPCT1 <&POSYD4A | <&POSYD4 &DNETTPCT1 <&POSYD5A |"
"<67 |__________________________________________________________________________________________<&POSYD5A |"
"<67 | <68 Intl Spend       <&POSYD1A | <&POSYD1 &FPYI2       <&POSYD2A | <&POSYD2 &FPYI1 <&POSYD3A | <&POSYD3 &FPIPCT1 <&POSYD4A | <&POSYD4 &IFAREDPT1 <&POSYD5A |"
"_____________________________________________________________________________________________________________<59      <67 |__________________________________________________________________________________________<&POSYD5A |"
"|              <9 | &TD1 <&POS2A | &TD2 <&POS3A | &TD3 <&POS4A | &TD4 <&POS5A | &TD5 <&POS6A | &TD6 <&POS7A | &TD7 <&POS8A | &TD8 <59 |                                                           <67 | <68 Intl Tickets  <&POSYD1A | <&POSYD1 &TPYI2 <&POSYD2A | <&POSYD2 &TPYI1 <&POSYD3A | <&POSYD3 &TPIPCT1 <&POSYD4A | <&POSYD4 &INETTPCT1 <&POSYD5A |"
"|____________________________________________________________________________________________________________<59 | <67 |__________________________________________________________________________________________<&POSYD5A |"
"|Total Spend   <9 |&FPT1 <&POS2A |&FPT2 <&POS3A |&FPT3 <&POS4A |&FPT4 <&POS5A |&FPT5 <&POS6A |&FPT6 <&POS7A |&FPT7 <&POS8A |&FPT8 <59 |                                                           <67 | <68 Total Spend   <&POSYD1A | <&POSYD1 &FPYT2 <&POSYD2A | <&POSYD2 &FPYT1 <&POSYD3A | <&POSYD3 &FPTPCT1 <&POSYD4A | <&POSYD4   100% <&POSYD5A |"
"|____________________________________________________________________________________________________________<59 | <67 |__________________________________________________________________________________________<&POSYD5A |"
"|Total Tickets <9 |&TPT1 <&POS2A |&TPT2 <&POS3A |&TPT3 <&POS4A |&TPT4 <&POS5A |&TPT5 <&POS6A |&TPT6 <&POS7A |&TPT7 <&POS8A |&TPT8 <59 |                                                           <67 | <68 Total Tickets <&POSYD1A | <&POSYD1 &TPYT2 <&POSYD2A | <&POSYD2 &TPYT1 <&POSYD3A | <&POSYD3 &TPTPCT1 <&POSYD4A | <&POSYD4   100% <&POSYD5A |"
"|_____________________________________________________________________________________________________________<59 |<67 |__________________________________________________________________________________________<&POSYD5A |"


ON TABLE SET STYLE *

-INCLUDE QRSTY
TYPE=FOOTING, SIZE=15, LINE=35, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=36, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=38, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=39, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $

TYPE=FOOTING, LINE=47,ITEM=4,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=49,ITEM=4,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=51,ITEM=4,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=53,ITEM=4,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=55,ITEM=4,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=57,ITEM=4,FONT=COURIER NEW,$

TYPE=FOOTING, LINE=58,ITEM=4,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=60,ITEM=4,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=62,ITEM=4,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=64,ITEM=14,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=66,ITEM=14,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=68,ITEM=14,FONT=COURIER NEW,$

TYPE=FOOTING, LINE=58,ITEM=6,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=60,ITEM=6,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=62,ITEM=6,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=64,ITEM=16,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=66,ITEM=16,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=68,ITEM=16,FONT=COURIER NEW,$

TYPE=FOOTING, LINE=58,ITEM=8,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=60,ITEM=8,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=62,ITEM=8,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=64,ITEM=18,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=66,ITEM=18,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=68,ITEM=18,FONT=COURIER NEW,$

TYPE=FOOTING, LINE=58,ITEM=10,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=60,ITEM=10,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=62,ITEM=10,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=64,ITEM=20,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=66,ITEM=20,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=68,ITEM=20,FONT=COURIER NEW,$


TYPE=REPORT, IMAGE=AirSpend.GIF,POSITION=(0.1 0.2), SIZE=(10.75 .75), $
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' OR '&G_DOMAT.EVAL' EQ 'N' GOTO SKIP_DGAT;
TYPE=REPORT,IMAGE=DOMAT.SVG, POSITION=(0.25 0.95), SIZE=(5.5 2.5),$
-SKIP_DGAT
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' OR '&G_INTAT.EVAL' EQ 'N' GOTO SKIP_IGAT;
TYPE=REPORT, IMAGE=INTAT.SVG, POSITION=(5.7  0.95), SIZE=(5.5 2.5), $
-SKIP_IGAT
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' OR '&G_TTLAT.EVAL' EQ 'N' GOTO SKIP_TGAT;
TYPE=REPORT,IMAGE=TTLAT.SVG, POSITION=(0.25  4.75), SIZE=(5.5 2.5), $
-SKIP_TGAT

ENDSTYLE
END
-RUN
