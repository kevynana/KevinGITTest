-INCLUDE SETECHO

SET ASNAMES = ON
-*-GOTO BURST;


SET LINES=99999
SET EMPTYREPORT = ON
-SET &WUSER = 'rosannep';
-SET &ROLL = 'JOINT-R';
JOIN
 INNER PUSH_GROUPS.PUSH_GROUPS.GROUP_KEY IN PUSH_GROUPS TO MULTIPLE
 PUSH_REPORTS_KEYS.PUSH_REPORTS_KEYS.GROUP_KEY IN PUSH_REPORTS_KEYS AS J3
 END
JOIN
 INNER PUSH_REPORTS_KEYS.PUSH_REPORTS_KEYS.INST_KEY IN PUSH_GROUPS TO UNIQUE
 RPT_INST.RPT_INST.INST_KEY IN RPT_INST AS J4
 END
JOIN
 INNER RPT_INST.RPT_INST.SET_KEY IN PUSH_GROUPS TO UNIQUE
 RPT_SET.RPT_SET.SET_KEY IN RPT_SET AS J5
 END
JOIN
 INNER RPT_SET.RPT_SET.ROLLUP_CODE IN PUSH_GROUPS TO UNIQUE
 ROLLUP.ROLLUP.ROLLUP_CODE IN ROLLUP AS J6
 END
-RUN
 
DEFINE FILE PUSH_GROUPS
WK/A1=IF SCHED_WEEKLY EQ '1' THEN 'Y' ELSE ' ';
MN/A1=IF SCHED_M EQ '1' THEN 'Y' ELSE ' ';
MY/A1=IF SCHED_MYTD EQ '1' THEN 'Y' ELSE ' ';
QT/A1=IF SCHED_Q EQ '1' THEN 'Y' ELSE ' ';
QY/A1=IF SCHED_QYTD EQ '1' THEN 'Y' ELSE ' ';
AN/A1=IF SCHED_A EQ '1' THEN 'Y' ELSE ' ';
END
TABLE FILE PUSH_GROUPS
PRINT
     RPT_NAME
     WK
     MN
     MY
     QT
     QY
     AN
     PUSH_EADDRS1
     PUSH_EADDRS2
     PUSH_EADDRS3
     SCHED_OWNER
BY ROLL_NAME
BY USER_NAME
BY SET_NAME
BY GLOBAL_PARM
BY GROUP_KEY
BY GROUP_NAME
IF GLOBAL_PARM EQ  'BRNONAX' OR 'BVBTALST' OR 'BWACHD' OR 'BWBTALST' OR 'CCAFILTP' OR 'CGCGNONV' OR 'CGNONVSA' OR 'CGNV' OR 'CHCCLST' OR 'CHBTALS3' OR 'DNACHD' OR
'FMBTALST' OR 'GAGHOSTC' OR 'GOBTALS2' OR 'GWBTALST' OR 'IHAIRCC' OR 'ITHTLBTA' OR 'KWBTALST' OR 'KWBTALS' OR 'LNBTALST' OR 'LYWNCC' OR 'MFBTAHTL' OR 
'MFHTLDT2' OR 'MRACHD' OR 'MUHTLBTA' OR 'MXBTA1' OR 'MXBTA' OR 'MXBTALST' OR 'MXRGAEXC' OR 'NALAXHTL' OR 'NXCRDDTL' OR 'OVBTALST' OR 
'PRBTALS' OR 'RNCC' OR 'RUCCLST' OR 'SFHTLBTA' OR 'SGC01033' OR 'SGC01006' OR 'SGC31006' OR 'SKHTLBTA' OR 'STBTALST' OR 'TSBTALST' OR 
'TSUNITED' OR 'TTBTALST' OR 'TZACHDCC' OR 'UABTALST' OR 'UNCCTP' OR 'UNPAXBTA' OR 'UPBTALST' OR 'UPCCLIST' OR 'UPEM' OR 'WFBTALST' OR 
'WFTRNDCC' OR 'WRAHCC1' OR 'WRAHCC2' OR 'WRAHCC3' OR 'WRHTLBTA' 
ON TABLE SET ONLINE-FMT EXL2K
END
-RUN

-GOTO XXIT;
-BURST

JOIN CLEAR *
JOIN INNER BURST_GROUPS.BURST_GROUPS.BREAK_KEY IN BURST_GROUPS TO
 MULTIPLE BURST_REPORT_KEYS.BURST_REPORT_KEYS.BREAK_KEY IN BURST_REPORT_KEYS AS J1
END
JOIN INNER BURST_REPORT_KEYS.BURST_REPORT_KEYS.SET_KEY IN BURST_GROUPS TO
 UNIQUE RPT_SET.RPT_SET.SET_KEY IN RPT_SET AS J2
END
JOIN INNER BURST_GROUPS.BURST_GROUPS.ROLLUP_CODE IN BURST_GROUPS TO
 UNIQUE ROLLUP.ROLLUP.ROLLUP_CODE IN ROLLUP AS J3
END
JOIN INNER BURST_REPORT_KEYS.BURST_REPORT_KEYS.SET_KEY IN BURST_GROUPS TO
 MULTIPLE RPT_INST.RPT_INST.SET_KEY IN RPT_INST AS J4
END
JOIN
INNER RPT_INST.RPT_INST.GLOBAL_PARM IN BURST_GROUPS TO UNIQUE
 ROLLSET_MASTER.ROLLSET_MASTER.GLOBAL_PARM IN ROLLSET_MASTER AS J5
END
-RUN
 
-* Get list of Weekly Scheduled Reports
DEFINE FILE BURST_GROUPS
OUTTO/A2='TC';
-* Today's Date
-*TDATE1/YYMD=&TDATE;
TDATE1/YYMD=END_DATE + 1;
P_MONTH/MDYY=TDATE1;
P_BOW/MDYY=DATEMOV(P_MONTH, 'BOW');
P_EOW/MDYY=DATEMOV(P_MONTH, 'EOW');
 
AFM_DATE/MDYY=DATEADD(P_BOW, 'D', (-7));
ATO_DATE/MDYY=DATEADD((P_EOW + 2), 'D', (-7));
 
AFX_DATE/MDYY=IF RUN_DATE_TYPES NE 'B' THEN DATEADD(AFM_DATE, 'D', (-7)) ELSE AFM_DATE;
ATX_DATE0/MDYY=IF RUN_DATE_TYPES NE 'B' THEN DATEADD(ATO_DATE, 'D', (-7)) ELSE DATEMOV(DATEADD(ATO_DATE, 'M', (3)),'EOM');
ATX_DATE/MDYY=ATX_DATE0;
 
ACMFM_DATE/MDYY=AFM_DATE;
ACMTO_DATE/MDYY=ATO_DATE;
APMFM_DATE/MDYY=AFX_DATE;
APMTO_DATE/MDYY=ATX_DATE;
ACYFM_DATE/MDYY=AFM_DATE;
ACYTO_DATE/MDYY=ATO_DATE;
APYFM_DATE/MDYY=AFM_DATE;
APYTO_DATE/MDYY=ATO_DATE;
-*EXFEX/A10='WRUNBURST';
RPT_NAMEX/A60='Weekly-' || RPT_NAME;
-*PUSH_EADDRS/A765=PUSH_EADDRS1 || PUSH_EADDRS2 || PUSH_EADDRS3;
END
TABLE FILE BURST_GROUPS
PRINT SET_KEY
      RPT_INST.INST_KEY
      BREAK_KEY
      BREAK_NAME
   BREAK_LEVEL
      OUTTO
      OUTPUT_FORMAT
      DATETYPE
      RPT_NAMEX AS RPT_NAME
      AFM_DATE
      ATO_DATE
      AFX_DATE
      ATX_DATE
      ACMFM_DATE
      ACMTO_DATE
      APMFM_DATE
      APMTO_DATE
      ACYFM_DATE
      ACYTO_DATE
      APYFM_DATE
      APYTO_DATE
-*      EXFEX
      ROLLUP_CODE
-*      PUSH_EADDRS
   END_DATE
BY ROLLUP_CODE 
BY OWNER AS 'SCHED_OWNER'

IF GLOBAL_PARM EQ  'BRNONAX' OR 'BVBTALST' OR 'BWACHD' OR 'BWBTALST' OR 'CCAFILTP' OR 'CGCGNONV' OR 'CGNONVSA' OR 'CGNV' OR 'CHCCLST' OR 'CHBTALS3' OR 'DNACHD' OR
'FMBTALST' OR 'GAGHOSTC' OR 'GOBTALS2' OR 'GWBTALST' OR 'IHAIRCC' OR 'ITHTLBTA' OR 'KWBTALST' OR 'KWBTALS' OR 'LNBTALST' OR 'LYWNCC' OR 'MFBTAHTL' OR 
'MFHTLDT2' OR 'MRACHD' OR 'MUHTLBTA' OR 'MXBTA1' OR 'MXBTA' OR 'MXBTALST' OR 'MXRGAEXC' OR 'NALAXHTL' OR 'NXCRDDTL' OR 'OVBTALST' OR 
'PRBTALS' OR 'RNCC' OR 'RUCCLST' OR 'SFHTLBTA' OR 'SGC01033' OR 'SGC01006' OR 'SGC31006' OR 'SKHTLBTA' OR 'STBTALST' OR 'TSBTALST' OR 
'TSUNITED' OR 'TTBTALST' OR 'TZACHDCC' OR 'UABTALST' OR 'UNCCTP' OR 'UNPAXBTA' OR 'UPBTALST' OR 'UPCCLIST' OR 'UPEM' OR 'WFBTALST' OR 
'WFTRNDCC' OR 'WRAHCC1' OR 'WRAHCC2' OR 'WRAHCC3' OR 'WRHTLBTA' 

END
-RUN

-XXIT
