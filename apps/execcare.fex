-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-* File EXECCAR1.FEX
-*************************************************************************
-*DATE          NAME            DESCRIPTION
-* 3/07/01   TANDT-SS           CHANGE ALL NUMERIC FORMATS FROM P (PACKED) TO
-*                              D (FLOATING-POINT DOUBLE PRECISION) TO PROVIDE
-*                              CONSISTENCY IN ROUNDING AND PERCENTAGES.
-*************************************************************************


DEFINE FILE &&EXTRACT
INTL_DOM/A1 =IF (AIRPORT.INT_DOM EQ 'D' OR ' ') THEN 'D' ELSE 'I';
 CM/A1 = IF INVOICE_DATE GE &&CMFMDT.EVAL AND 
INVOICE_DATE LE &&CMTODT.EVAL THEN 'Y' ELSE 'N';
 CY/A1 = IF INVOICE_DATE GE &&CYFMDT.EVAL AND 
INVOICE_DATE LE &&CYTODT.EVAL THEN 'Y' ELSE 'N';
 PM/A1 = IF INVOICE_DATE GE &&PMFMDT.EVAL AND 
INVOICE_DATE LE &&PMTODT.EVAL THEN 'Y' ELSE 'N';
 PY/A1 = IF INVOICE_DATE GE &&PYFMDT.EVAL AND 
INVOICE_DATE LE &&PYTODT.EVAL THEN 'Y' ELSE 'N';
0440_RUF/A1 = IF LEVEL1 EQ '0440RUFFALO' THEN 'Y' ELSE
              IF LEVEL2 EQ '0015010100000' OR '0042022600000' OR
              '0015050000000' OR '0015010100000' OR '0015010000000' OR
              '0015062000000' OR '0015022000000' OR '0015010100000' OR
              '0013025300000' OR '0015044000000' OR '0015017900000' OR
              '0015017900000' OR '0010062200000' OR '0015010000000' OR
              '0015044000000' OR '0021044000000' OR '0015062000000' OR
              '0015010600000' OR '0032022500000' OR '0015012100000' OR
              '0014025200000' OR '0017044000000' OR '0005044000000' OR
              '0042022700000' OR '2402240000000' OR '0033044000000' 
              THEN 'Y' ELSE 'N';


-*DOMESTIC PERIOD
-* CURRENT RENTAL AMOUNT DOMESTIC CALCULATION
      CDM1RNT_AMT/D12.2 = IF ((INTL_DOM IS 'D')
                      AND (CM EQ 'Y'))       
                      THEN CAR_MAIN.RENTAL_AMT
                      ELSE 0;
-*DOMESTIC PERIOD
-* CURRENT RENTAL AMOUNT DOMESTIC CALCULATION
      CDM1RNT_AMT/D12.2 = IF ((INTL_DOM IS 'D')
                      AND (CM EQ 'Y'))       
                      THEN CAR_MAIN.RENTAL_AMT
                      ELSE 0;

-* CURRENT RENTAL DAYS DOMESTIC CALCULATION
      CDM1RNT_DAY/D12.2 = IF ((INTL_DOM IS 'D')
                      AND (CM EQ 'Y'))       
                      THEN CAR_MAIN.NUM_DAYS * CAR_MAIN.NUM_CAR
                      ELSE 0;
-*INT'L PERIOD
-* CURRENT RENTAL AMOUNT INT'L CALCULATION
      CIM1RNT_AMT/D12.2 = IF ((INTL_DOM IS 'I')
                      AND (CM EQ 'Y'))       
                      THEN CAR_MAIN.RENTAL_AMT
                      ELSE 0;

-* CURRENT RENTAL DAYS INT'L CALCULATION
      CIM1RNT_DAY/D12.2 = IF ((INTL_DOM IS 'I')
                      AND (CM EQ 'Y'))       
                      THEN CAR_MAIN.NUM_DAYS * CAR_MAIN.NUM_CAR
                      ELSE 0;

-*DOMESTIC PERIOD
-* PRIOR RENTAL AMOUNT DOMESTIC CALCULATION
      PDM1RNT_AMT/D12.2 = IF ((INTL_DOM IS 'D')
                      AND (PM EQ 'Y'))       
                      THEN CAR_MAIN.RENTAL_AMT
                      ELSE 0;

-* PRIOR RENTAL DAYS DOMESTIC CALCULATION
      PDM1RNT_DAY/D12.2 = IF ((INTL_DOM IS 'D')
                      AND (PM EQ 'Y'))       
                      THEN CAR_MAIN.NUM_DAYS * CAR_MAIN.NUM_CAR
                      ELSE 0;

-*INT'L PERIOD
-* PRIOR RENTAL AMOUNT INT'L CALCULATION
      PIM1RNT_AMT/D12.2 = IF ((INTL_DOM IS 'I')
                      AND (PM EQ 'Y'))       
                      THEN CAR_MAIN.RENTAL_AMT
                      ELSE 0;

-* PRIOR RENTAL DAYS INT'L CALCULATION
      PIM1RNT_DAY/D12.2 = IF ((INTL_DOM IS 'I')
                      AND (PM EQ 'Y'))       
                      THEN CAR_MAIN.NUM_DAYS * CAR_MAIN.NUM_CAR
                      ELSE 0;

-*DOMESTIC YTD 
-* CURRENT RENTAL AMOUNT DOMESTIC CALCULATION
      CDY1RNT_AMT/D12.2 = IF ((INTL_DOM IS 'D')
                      AND (CY EQ 'Y'))       
                      THEN CAR_MAIN.RENTAL_AMT
                      ELSE 0;

-* CURRENT RENTAL DAYS DOMESTIC CALCULATION
      CDY1RNT_DAY/D12.2 = IF ((INTL_DOM IS 'D')
                      AND (CY EQ 'Y'))       
                      THEN CAR_MAIN.NUM_DAYS * CAR_MAIN.NUM_CAR
                      ELSE 0;
-*INT'L YTD
-* CURRENT RENTAL AMOUNT INT'L CALCULATION
      CIY1RNT_AMT/D12.2 = IF ((INTL_DOM IS 'I')
                      AND (CY EQ 'Y'))       
                      THEN CAR_MAIN.RENTAL_AMT
                      ELSE 0;

-* CURRENT RENTAL DAYS INT'L CALCULATION
      CIY1RNT_DAY/D12.2 = IF ((INTL_DOM IS 'I')
                      AND (CY EQ 'Y'))       
                      THEN CAR_MAIN.NUM_DAYS * CAR_MAIN.NUM_CAR
                      ELSE 0;

-*DOMESTIC YTD
-* PRIOR RENTAL AMOUNT DOMESTIC CALCULATION
      PDY1RNT_AMT/D12.2 = IF ((INTL_DOM IS 'D')
                      AND (PY EQ 'Y'))       
                      THEN CAR_MAIN.RENTAL_AMT
                      ELSE 0;

-* PRIOR RENTAL DAYS DOMESTIC CALCULATION
      PDY1RNT_DAY/D12.2 = IF ((INTL_DOM IS 'D')
                      AND (PY EQ 'Y'))       
                      THEN CAR_MAIN.NUM_DAYS * CAR_MAIN.NUM_CAR
                      ELSE 0;

-*INT'L YTD
-* PRIOR RENTAL AMOUNT INT'L CALCULATION
      PIY1RNT_AMT/D12.2 = IF ((INTL_DOM IS 'I')
                      AND (PY EQ 'Y'))       
                      THEN CAR_MAIN.RENTAL_AMT
                      ELSE 0;

-* PRIOR RENTAL DAYS INT'L CALCULATION
      PIY1RNT_DAY/D12.2 = IF ((INTL_DOM IS 'I')
                      AND (PY EQ 'Y'))       
                      THEN CAR_MAIN.NUM_DAYS * CAR_MAIN.NUM_CAR
                      ELSE 0;
END
-RUN

TABLEF FILE &&EXTRACT
SUM
CDM1RNT_AMT/D10 CDM1RNT_DAY/D10 CIM1RNT_AMT/D10 CIM1RNT_DAY/D10
PDM1RNT_AMT/D10 PDM1RNT_DAY/D10 PIM1RNT_AMT/D10 PIM1RNT_DAY/D10 
CDY1RNT_AMT/D10 CDY1RNT_DAY/D10 CIY1RNT_AMT/D10 CIY1RNT_DAY/D10
PDY1RNT_AMT/D10 PDY1RNT_DAY/D10 PIY1RNT_AMT/D10 PIY1RNT_DAY/D10
AND COMPUTE
CDM1AVG_RATE/D10=CDM1RNT_AMT/CDM1RNT_DAY;
CIM1AVG_RATE/D10=CIM1RNT_AMT/CIM1RNT_DAY;
PDM1AVG_RATE/D10=PDM1RNT_AMT/PDM1RNT_DAY;
PIM1AVG_RATE/D10=PIM1RNT_AMT/PIM1RNT_DAY;
CDY1AVG_RATE/D10=CDY1RNT_AMT/CDY1RNT_DAY;
CIY1AVG_RATE/D10=CIY1RNT_AMT/CIY1RNT_DAY;
PDY1AVG_RATE/D10=PDY1RNT_AMT/PDY1RNT_DAY;
PIY1AVG_RATE/D10=PIY1RNT_AMT/PIY1RNT_DAY;
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10
&&WHERE11
&&WHERE12
&&WHERE13
&&WHERE14
&&WHERE15
&&WHERE16
&&WHERE17
&&WHERE18
&&WHERE19
&&WHERE20
&&WHERE21
&&WHERE22
&&WHERE23
&&WHERE24
&&WHERE25
&&WHERE26
&&WHERE27
&&WHERE28
&&WHERE29
&&WHERE30
&&WHERE31
&&WHERE32
&&WHERE33
&&WHERE34
&&WHERE35
&&WHERE36
&&WHERE37
&&WHERE38
&&WHERE39
&&WHERE40
&&WHERE41
&&WHERE42
&&WHERE43
&&WHERE44
&&WHERE45
&&WHERE46
&&WHERE47
&&WHERE48
&&WHERE49
&&WHERE50
&&WHERE51
&&WHERE52
&&WHERE53
&&WHERE54
&&WHERE55
&&WHERE56
&&WHERE57
&&WHERE58
&&WHERE59
&&WHERE60
&&WHERE61
&&WHERE62
&&WHERE63
&&WHERE64
&&WHERE65
&&WHERE66
&&WHERE67
&&WHERE68

WHERE (CAR_MAIN.INVOICE_DATE GE &&CYFMDT.EVAL
      AND CAR_MAIN.INVOICE_DATE LE &&CYTODT.EVAL)
 OR (CAR_MAIN.INVOICE_DATE GE &&PYFMDT.EVAL
      AND CAR_MAIN.INVOICE_DATE LE &&PYTODT.EVAL)
 OR (CAR_MAIN.INVOICE_DATE GE &&CMFMDT.EVAL 
      AND CAR_MAIN.INVOICE_DATE LE &&CMTODT.EVAL) 
 OR (CAR_MAIN.INVOICE_DATE GE &&PMFMDT.EVAL 
      AND CAR_MAIN.INVOICE_DATE LE &&PMTODT.EVAL);

-INCLUDE RPTPARMS

ON TABLE HOLD AS HOLD2
END
-RUN

TABLE FILE HOLD2
PRINT
CDM1RNT_AMT CDM1RNT_DAY CIM1RNT_AMT CIM1RNT_DAY
PDM1RNT_AMT PDM1RNT_DAY PIM1RNT_AMT PIM1RNT_DAY 
CDY1RNT_AMT CDY1RNT_DAY CIY1RNT_AMT CIY1RNT_DAY
PDY1RNT_AMT PDY1RNT_DAY PIY1RNT_AMT PIY1RNT_DAY
CDM1AVG_RATE
CIM1AVG_RATE
PDM1AVG_RATE
PIM1AVG_RATE
CDY1AVG_RATE
CIY1AVG_RATE
PDY1AVG_RATE
PIY1AVG_RATE
   
ON TABLE HOLD AS CARSUMLD
END
-*-EXIT
