-* Created to add quarter date ranges to converted quartered clients
-* updated qtr6 to 2014 - deb 4/17/14
-* UPDATED ROLLUP for CIT-R  Deb 5/5/14
TABLE FILE ROLLUP
PRINT ROLLUP_CODE
BY ROLLUP_CODE 
WHERE ROLLUP_CODE EQ 'UTC-R'
ON TABLE HOLD AS ROLL
END
-RUN

MODIFY FILE ROLLQTR
FIXFORM FROM ROLL
MATCH ROLLUP_CODE
ON MATCH REJECT 
ON NOMATCH INCLUDE
DATA ON ROLL
END
-RUN


-JOY
TABLE FILE ROLLQTR
PRINT Q1FMDT Q1TODT Q2FMDT Q2TODT Q3FMDT Q3TODT Q4FMDT Q4TODT Q5FMDT Q5TODT
Q6FMDT Q6TODT Q7FMDT Q7TODT Q8FMDT Q8TODT Q9FMDT Q9TODT Q0FMDT Q0TODT 
QYFMDT QYTODT QZFMDT QZTODT
BY ROLLUP_CODE
WHERE ROLLUP_CODE EQ 'UTC-R'
ON TABLE HOLD
END

MODIFY FILE ROLLQTR
FIXFORM FROM HOLD
MATCH ROLLUP_CODE
ON MATCH COMPUTE Q1FMDT='20130101';
ON MATCH COMPUTE Q1TODT='20130331';
ON MATCH COMPUTE Q2FMDT='20130401';
ON MATCH COMPUTE Q2TODT='20130630';
ON MATCH COMPUTE Q3FMDT='20130701';
ON MATCH COMPUTE Q3TODT='20130930';
ON MATCH COMPUTE Q4FMDT='20131001';
ON MATCH COMPUTE Q4TODT='20131231';
ON MATCH COMPUTE Q5FMDT='20140101';
ON MATCH COMPUTE Q5TODT='20140331';
ON MATCH COMPUTE Q6FMDT='20140401';
ON MATCH COMPUTE Q6TODT='20140630';
ON MATCH COMPUTE Q7FMDT='20140701';
ON MATCH COMPUTE Q7TODT='20140930';
ON MATCH COMPUTE Q8FMDT='20141001';
ON MATCH COMPUTE Q8TODT='20141231';
ON MATCH COMPUTE Q9FMDT='20120101';
ON MATCH COMPUTE Q9TODT='20120331';
ON MATCH COMPUTE Q0FMDT='20120401';
ON MATCH COMPUTE Q0TODT='20120630';
ON MATCH COMPUTE QYFMDT='20120701';
ON MATCH COMPUTE QYTODT='20120930';
ON MATCH COMPUTE QZFMDT='20121001';
ON MATCH COMPUTE QZTODT='20121231';
ON MATCH UPDATE Q1FMDT Q1TODT Q2FMDT Q2TODT Q3FMDT Q3TODT Q4FMDT Q4TODT
ON MATCH UPDATE Q5FMDT Q5TODT Q6FMDT Q6TODT Q7FMDT Q7TODT Q8FMDT Q8TODT
ON MATCH UPDATE Q9FMDT Q9TODT Q0FMDT Q0TODT QYFMDT QYTODT QZFMDT QZTODT
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

