-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* 1/24/05 - DEB - ADDED CODE FOR GLOBAL CURRENCY
-*4/20/2017-JEM-S-33318-updated logic for no records report


SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

DEFINE FILE &&EXTRACT

  LEVEL_DESC/A60  = &&LDESC;
  NBR_DAYS/D12=NUM_DAYS;
  NBR_ROOMS/D12 = NUM_ROOMS;
  NEW_TOTAL_AMT/D14.2C = TOTAL_AMT;
  NNROOMS/D12 = IF ((NBR_DAYS LT 0) AND (NUM_ROOMS LT 0)) THEN 
                ((NBR_DAYS*NUM_ROOMS) * (-1)) ELSE NBR_DAYS*NUM_ROOMS;
  REFUSE_CD/A2 = EDIT(REFUSE_KEY,'$$$$$$$$99');
 
END
-RUN

TABLEF FILE &&EXTRACT
PRINT AROLL_DSC3
  CURR_DATE
  INVOICE_DATE
  LEVEL_DESC
  NBR_DAYS	
  NNROOMS
  NEW_TOTAL_AMT
  REFUSE_CD

    
WHERE (INVOICE_DATE GE &&FROMDT.EVAL) AND (INVOICE_DATE LE &&TODT.EVAL) 
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
-* &&WHERE1
-* &&WHERE2
-* &&WHERE3
-* &&WHERE4
-* &&WHERE5
-* &&WHERE6
-* &&WHERE7
-* &&WHERE8
&&WHERE9
&&WHERE10
-INCLUDE RPTPARMS
ON TABLE HOLD AS BNMHHOLD
END
-RUN


TABLE FILE BNMHHOLD
PRINT AROLL_DSC3
  INVOICE_DATE
  NBR_DAYS	
  NNROOMS
  NEW_TOTAL_AMT
  REFUSE_CD
BY LEVEL_DESC
ON TABLE HOLD AS HTLHLD1  
END
-RUN









DEFINE FILE HTLHLD1
CHTTLA/D12.2CS = NEW_TOTAL_AMT;
CHTTLN/P8CS = NNROOMS;
PREF_NON/A15 = IF (REFUSE_CD EQ 'A' OR 'R' OR 'T') THEN 'PREFERRED' ELSE 
                  'NON-PREFERRED';
NPREF_AMT/D12.2 = IF PREF_NON EQ 'NON-PREFERRED' THEN NEW_TOTAL_AMT ELSE 0;
NPREF_NGT/P8CS = IF PREF_NON EQ 'NON-PREFERRED' THEN NNROOMS ELSE 0;
PREF_AMT/D12.2 = IF PREF_NON EQ 'PREFERRED' THEN NEW_TOTAL_AMT ELSE 0;
PREF_NGT/P8CS = IF PREF_NON EQ 'PREFERRED' THEN NNROOMS ELSE 0;
END

TABLE FILE HTLHLD1
SUM CHTTLA
    CHTTLN
    PREF_AMT
    PREF_NGT
BY LEVEL_DESC
BY PREF_NON
ON TABLE HOLD AS HTLHLD2
END
-RUN

TABLE FILE HTLHLD2
SUM CHTTLA
    CHTTLN
    PREF_AMT
    PREF_NGT
BY LEVEL_DESC
ON TABLE HOLD AS HTLHLD3 FORMAT FOCUS INDEX LEVEL_DESC
END
-RUN

-SET &&HTLREC=IF &RECORDS EQ 0 THEN 'N' ELSE 'Y';




