-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-*05/24/17 - DLV - S-34879 - New routine created for TMPAXSUM
 
-INCLUDE SETECHO
SET ASNAMES=ON



-SET &&RPTSUF = 'SMY';



-SET &&SORT1 = &&RANK_LABEL1;
-SET &&SORT2 = &&RANK_LABEL2;
 

 

-INCLUDE FDEFRPTS
-RUN

-SET &&RANK_METH = TOT_SPD;
-SET &&RANK_LIMIT = 9999;

MATCH FILE TPAIRPX
PRINT DISSAVINGS
    DISSAVX 
    FARE_PAID
    KILO 
    LEVEL1
    LEVEL2
    LEVEL3
    NAMEC
    NET_TKT_CNT
    NEW_SEG_MILES
    PAID_FAREX 
BY &&SORT1
BY &&SORT2
BY &&RANK_LABEL3
BY PASSNGR_NAME
ON TABLE HOLD
RUN
FILE HOLDHPX
PRINT NAMEC 
  NBR_DAY
  NBR_ROOMS
  NNROOMS
  NEW_TOTAL_AMT
  AMT_TOTALX 
BY &&SORT1
BY &&SORT2
BY &&RANK_LABEL3
BY PASSNGR_NAME
AFTER MATCH HOLD AS XONE OLD-OR-NEW
END
-RUN

TABLE FILE XONE
SUM DISSAVINGS
    DISSAVX 
    FARE_PAID
    KILO 
    LEVEL1
    LEVEL2
    LEVEL3
    NAMEC
    NET_TKT_CNT
    NEW_SEG_MILES
    PAID_FAREX 
    NAMEC 
    NBR_DAY
    NBR_ROOMS
    NNROOMS
    NEW_TOTAL_AMT
    AMT_TOTALX 
BY &&SORT1
BY &&SORT2
BY &&RANK_LABEL3
BY PASSNGR_NAME
ON TABLE HOLD AS AHHLD
END
-RUN
 

 
MATCH FILE XONE
PRINT DISSAVINGS
    DISSAVX
    FARE_PAID
    KILO
    LEVEL1
    LEVEL2
    LEVEL3
    NAMEC
    NET_TKT_CNT
    NEW_SEG_MILES
    NBR_DAY
    NBR_ROOMS
    NNROOMS
    NEW_TOTAL_AMT
    PAID_FAREX
    AMT_TOTALX
BY &&SORT1
BY &&SORT2
BY &&RANK_LABEL3
BY PASSNGR_NAME
ON TABLE HOLD
RUN
FILE HOLDCPX
PRINT NAMEC
    NBR_DAYS
    NUM_CARS
    RENTAL_DAYS
    NEW_RENTAL_AMT
    AMT_RENTALX 
BY &&SORT1
BY &&SORT2
BY &&RANK_LABEL3
BY PASSNGR_NAME
AFTER MATCH HOLD AS XTWO OLD-OR-NEW
END
-RUN

DEFINE FILE XTWO
XPSNGR_NM/A15        = 
  EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
TOT_SPD/D12.2CS = FARE_PAID + NEW_TOTAL_AMT + NEW_RENTAL_AMT;
END
TABLE FILE XTWO
SUM AMT_RENTALX 
    AMT_TOTALX
    DISSAVINGS
    DISSAVX 
    FARE_PAID
    KILO
    LEVEL1
    LEVEL2
    LEVEL3
    NAMEC
    NET_TKT_CNT
    NEW_RENTAL_AMT 
    NEW_SEG_MILES
    NNROOMS
    NUM_CARS
    RENTAL_DAYS
    NEW_TOTAL_AMT
    PAID_FAREX
    XPSNGR_NM

    TOT_SPD
BY &&SORT1
BY &&SORT2
BY &&RANK_LABEL3
BY PASSNGR_NAME
ON TABLE HOLD AS FNLHLD
END
-RUN 
 


 
-IF &RECORDS EQ 0 THEN GOTO XXITNR;

 
 


-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS';
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
 
 
DEFINE FILE FNLHLD
  BLANK/A5 = '     ';
  NOWTOD/A8 WITH EMP_ID = HHMMSS (NOWTOD);
END


TABLE FILE FNLHLD
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;


    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    &&S_SUBJ11
    &&S_SUBJ12
    &&S_SUBJ13
    &&S_SUBJ14
    &&S_SUBJ15
    &&S_SUBJ16
    &&S_SUBJ17
    &&S_SUBJ18
    &&S_SUBJ19
    &&S_SUBJ20
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10

-*FOOTING BOTTOM
-INCLUDE FOOTERSM

ON TABLE SET PAGE-NUM OFF
ON TABLE PAGE-BREAK AND SUBFOOT

-INCLUDE SBFOOT
 

ON TABLE SET STYLE *
-INCLUDE &&PASTYS

ENDSTYLE
 
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2


 

-*
END
-RUN

-GOTO XXITALL



 
-XXITNR



-XXITALL
