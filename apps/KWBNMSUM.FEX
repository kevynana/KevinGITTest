-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* 10/28/2015 DLV S-12409 - Added new routine for KWBNMPX 
-*                          created from CEBNMSUM
-*S-25167-9/27/16-JEM-Updated from level2 to emp_id
-*03/13/17 - DLV - S-22486 - updated ettek Review to Post-trip Reporting
-* 07/07/2017 - RSB - S-36531 Reports that do not use a view to be updated with standard footer (part 2)
-* 08/28/2017 - RSB - S-39056 Footer changes to be backed out of story S-36531
-* 
-SET &&PAHDR  = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL'   ELSE &&SMSTY;
-*      
-INCLUDE SETECHO
SET ASNAMES=ON
 
 
 
-SET &&RPTSUF = 'BENCHMARK';
  
-IF &&FROMAVRP EQ 'Y' GOTO :CS1; 
 
-SET &FMM=EDIT(&&FROMDT,'$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'9999');
-SET &TOM=EDIT(&&TODT,'$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'9999');
-GOTO :CS1_CONT;
 
-:CS1
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');
-:CS1_CONT
-SET &&SP = '|';
-SET &&SP1A = IF &&ROLLNME EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP1 = IF &&ROLLCS EQ ' ' THEN ' ' ELSE &&SP1A;
-SET &&SP3 = IF &&ROLLCNCT EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP4 = IF &&ROLLPHN EQ ' ' THEN ' ' ELSE &&SP;
-SET &&RCNCT = &&ROLLCNCT.LENGTH;
-SET &&CSL = &&ROLLCS.LENGTH;
-SET &&CSLPA = IF &&RCNCT.EVAL GE 10 OR &&CSL.EVAL GE 10 THEN 60 ELSE 68;
-SET &&CSLP = IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' THEN 78 ELSE &&CSLPA;
-SET &&ROLLCS11 = TRUNCATE(&&ROLLCS);
-SET &&RCNCT1 = TRUNCATE(&&ROLLCNCT);
-SET &&BLANK = ' ';
 
-INCLUDE FDEFRPTS
-RUN

-IF '&&CARDATA.EVAL' EQ 'N' AND '&&HTLDATA.EVAL' EQ 'N' AND '&&AIRDATA.EVAL' EQ 'Y'
-THEN GOTO NOCARHTL; 
 
-IF '&&CARDATA.EVAL' EQ 'Y' AND '&&HTLDATA.EVAL' EQ 'N' AND '&&AIRDATA.EVAL' EQ 'Y'
-THEN GOTO NOHTL; 

-IF '&&CARDATA.EVAL' EQ 'N' AND '&&HTLDATA.EVAL' EQ 'Y' AND '&&AIRDATA.EVAL' EQ 'Y'
-THEN GOTO NOCAR; 

-IF '&&CARDATA.EVAL' EQ 'N' AND '&&HTLDATA.EVAL' EQ 'Y' AND '&&AIRDATA.EVAL' EQ 'N'
-THEN GOTO NOAIRCAR; 

-IF '&&CARDATA.EVAL' EQ 'Y' AND '&&HTLDATA.EVAL' EQ 'N' AND '&&AIRDATA.EVAL' EQ 'N'
-THEN GOTO NOAIRHTL; 

-IF '&&CARDATA.EVAL' EQ 'Y' AND '&&HTLDATA.EVAL' EQ 'Y' AND '&&AIRDATA.EVAL' EQ 'N'
-THEN GOTO NOAIR; 


-TYPE &&AIRDATA
-TYPE &&HTLDATA
-TYPE &&CARDATA

 

MATCH FILE TRANTWO
PRINT CAVOL
    CDAVOL
    CDLS
    CDLSAV
    CDONL
    CDNTKT
    CLSAV
    CLSTKT
    CLS1
    CLS2
    CLS3
    CLS4
    CLS5
    CLS6
    CLS_AO
    CLSTKT
    CMILES
    CSAV
    CSAV1
    CNTKT
    CNVSA
    CVSAV
    CLS200
    CLS2001
    CADVT
    CADVT1
    CADVT2
    CADVT3
    CDNONONL
    PFARE
    PMILES
    CTAVGT
    CAVGT
    CADVP1
    CADVP2
    CADVP3
    CADVP4
    CADVP5
    CADVP6
    CLSP
    CDNONONLP
    CNONONLP
    CONLP1
    CNRP
    CNFSV
    CTLS
    CDTLSV
    CCLS1
    CCLS2
    CCLS3
    CCLS4
    CCLS5
    CCLS6
    CCLS_AO
    CPMILE
    PMILE
    CTLSV
    CLS100P
    CDATKT
    CILSAV
    CTILSV
    CIATKT
    CINONONL
BY EMP_ID
BY PASSNGR_NAME
ON TABLE HOLD
RUN
FILE HTLHLD3
SUM CHTTLA
    AVGRATE
    HPAX
BY EMP_ID
BY PASSNGR_NAME
AFTER MATCH HOLD AS XONE OLD-OR-NEW
END
-RUN
 


MATCH FILE XONE
PRINT CAVOL
    CDAVOL
    CDLS
    CDLSAV
    CDONL
    CDNTKT
    CLSAV
    CLSTKT
    CLS1
    CLS2
    CLS3
    CLS4
    CLS5
    CLS6
    CLS_AO
    CLSTKT
    CMILES
    CSAV
    CSAV1
    CNTKT
    CNVSA
    CVSAV
    CLS200
    CLS2001
    CADVT
    CADVT1
    CADVT2
    CADVT3
    CDNONONL
    PFARE
    PMILES
    CTAVGT
    CAVGT
    CADVP1
    CADVP2
    CADVP3
    CADVP4
    CADVP5
    CADVP6
    CLSP
    CDNONONLP
    CNONONLP
    CONLP1
    CNRP
    CNFSV
    CTLS
    CDTLSV
    CCLS1
    CCLS2
    CCLS3
    CCLS4
    CCLS5
    CCLS6
    CCLS_AO
    CPMILE
    PMILE
    CTLSV
    CLS100P
    CDATKT
    CILSAV
    CTILSV
    CIATKT
    CINONONL
    CHTTLA
    AVGRATE
    HPAX
BY EMP_ID
BY PASSNGR_NAME
ON TABLE HOLD
RUN
FILE CARTHREE
SUM CRENTAL
    CRENTALA
    CNOCMP_DAYS
    CNOMID_DAYS
    PASSNGR_NAME
    PCTNOCMP
    PCTNOMID
    AVGCAR
    CPAX
BY EMP_ID
BY PASSNGR_NAME
AFTER MATCH HOLD AS FINALHLD OLD-OR-NEW
END
-RUN
 

-GOTO FinREPORT;

-NOCARHTL 
DEFINE  FILE TRANTWO
PCTNOCMP/D12.2CS =  0 ;
AVGRATE/D12.2CS =  0 ;
AVGCAR/D12.2CS = 0;
END
TABLE FILE TRANTWO
PRINT CAVOL
    CDAVOL
    CDLS
    CDLSAV
    CDONL
    CDNTKT
    CLSAV
    CLSTKT
    CLS1
    CLS2
    CLS3
    CLS4
    CLS5
    CLS6
    CLS_AO
    CLSTKT
    CMILES
    CSAV
    CSAV1
    CNTKT
    CNVSA
    CVSAV
    CLS200
    CLS2001
    CADVT
    CADVT1
    CADVT2
    CADVT3
    CDNONONL
    PFARE
    PMILES
    CTAVGT
    CAVGT
    CADVP1
    CADVP2
    CADVP3
    CADVP4
    CADVP5
    CADVP6
    CLSP
    CDNONONLP
    CNONONLP
    CONLP1
    CNRP
    CNFSV
    CTLS
    CDTLSV
    CCLS1
    CCLS2
    CCLS3
    CCLS4
    CCLS5
    CCLS6
    CCLS_AO
    CPMILE
    PMILE
    CTLSV
    CLS100P
    CDATKT
    CILSAV
    CTILSV
    CIATKT
    CINONONL
    PCTNOCMP
    AVGRATE
    AVGCAR
BY EMP_ID
BY PASSNGR_NAME 
ON TABLE HOLD AS FINALHLD
END
-RUN


-GOTO FinREPORT

-NOHTL 
 

MATCH  FILE TRANTWO
PRINT CAVOL
    CDAVOL
    CDLS
    CDLSAV
    CDONL
    CDNTKT
    CLSAV
    CLSTKT
    CLS1
    CLS2
    CLS3
    CLS4
    CLS5
    CLS6
    CLS_AO
    CLSTKT
    CMILES
    CSAV
    CSAV1
    CNTKT
    CNVSA
    CVSAV
    CLS200
    CLS2001
    CADVT
    CADVT1
    CADVT2
    CADVT3
    CDNONONL
    PFARE
    PMILES
    CTAVGT
    CAVGT
    CADVP1
    CADVP2
    CADVP3
    CADVP4
    CADVP5
    CADVP6
    CLSP
    CDNONONLP
    CNONONLP
    CONLP1
    CNRP
    CNFSV
    CTLS
    CDTLSV
    CCLS1
    CCLS2
    CCLS3
    CCLS4
    CCLS5
    CCLS6
    CCLS_AO
    CPMILE
    PMILE
    CTLSV
    CLS100P
    CDATKT
    CILSAV
    CTILSV
    CIATKT
    CINONONL
BY EMP_ID
BY PASSNGR_NAME
ON TABLE HOLD
RUN
FILE CARTHREE
SUM CRENTAL
    CRENTALA
    CNOCMP_DAYS
    CNOMID_DAYS
    PASSNGR_NAME
    PCTNOCMP
    PCTNOMID
    AVGCAR
    CPAX
BY EMP_ID
BY PASSNGR_NAME
AFTER MATCH HOLD AS FINALHLD OLD-OR-NEW
END
-RUN
 
 

DEFINE FILE FINALHLD
NOWTOD/A8 WITH CAVOL = HHMMSS (NOWTOD);
BLANK/A1 = ' ';
AVGRATE/D12.2CS =  0 ;
END
-RUN
 
 
-GOTO FinREPORT2

-NOCAR
MATCH FILE TRANTWO
PRINT CAVOL
    CDAVOL
    CDLS
    CDLSAV
    CDONL
    CDNTKT
    CLSAV
    CLSTKT
    CLS1
    CLS2
    CLS3
    CLS4
    CLS5
    CLS6
    CLS_AO
    CLSTKT
    CMILES
    CSAV
    CSAV1
    CNTKT
    CNVSA
    CVSAV
    CLS200
    CLS2001
    CADVT
    CADVT1
    CADVT2
    CADVT3
    CDNONONL
    PFARE
    PMILES
    CTAVGT
    CAVGT
    CADVP1
    CADVP2
    CADVP3
    CADVP4
    CADVP5
    CADVP6
    CLSP
    CDNONONLP
    CNONONLP
    CONLP1
    CNRP
    CNFSV
    CTLS
    CDTLSV
    CCLS1
    CCLS2
    CCLS3
    CCLS4
    CCLS5
    CCLS6
    CCLS_AO
    CPMILE
    PMILE
    CTLSV
    CLS100P
    CDATKT
    CILSAV
    CTILSV
    CIATKT
    CINONONL
BY EMP_ID
BY PASSNGR_NAME
ON TABLE HOLD
RUN
FILE HTLHLD3
SUM CHTTLA
    AVGRATE
    HPAX
BY EMP_ID
BY PASSNGR_NAME
AFTER MATCH HOLD AS FINALHLD OLD-OR-NEW
END
-RUN 


DEFINE FILE FINALHLD
NOWTOD/A8 WITH CAVOL = HHMMSS (NOWTOD);
BLANK/A1 = ' ';
PCTNOCMP/P12.2CS =  0;
AVGCAR/D12.2CS = 0;
END
-RUN

-GOTO FinREPORT2;

-NOAIRCAR

DEFINE FILE HTLHLD3
CAVOL/D12CS = 0;
CNTKT/D8CS = 0;
CDLSAV/D12CS = 0;
CTLSV/D12CS  = 0;
CLSAV/D12CS = 0;
CTLS/D12CS = 0;
CCLS2/D12CS = 0;
CCLS1/D12CS = 0;
CCLS3/D12CS = 0;
CCLS4 /D12CS = 0;
CCLS5/D12CS = 0;
CDTLSV/D12CS = 0;
CVSAV/D12CS= 0;
CDATKT/D12.2CS = 0;
CTAVGT/D12.2CS = 0;
CADVT/D8CS = 0;
CADVT1/D8CS = 0;
CADVT2/D8CS = 0;
CADVT3/D8CS = 0;
CDNONONL/D8CS = 0;
CNRP/D12.2CS = 0;
CPMILE/D12.2CS = 0;  
PCTNOCMP/D12.2CS = 0;
AVGCAR/D12.2CS = 0;           
END
TABLE FILE HTLHLD3
PRINT  CHTTLA
    AVGRATE
    HPAX
    CAVOL 
    CNTKT
    CDLSAV 
    CTLSV  
    CLSAV 
    CTLS 
    CCLS2  
    CCLS1 
    CCLS3  
    CCLS4  
    CCLS5 
    CDTLSV 
    CVSAV 
    CDATKT 
    CTAVGT 
    CADVT 
    CADVT1 
    CADVT2 
    CADVT3 
    CDNONONL 
    CNRP 
    CPMILE 
    PCTNOCMP 
    AVGCAR 
BY EMP_ID
BY PASSNGR_NAME
ON TABLE HOLD AS FINALHLD
END
-RUN


-GOTO FinREPORT;

-NOAIRHTL
DEFINE FILE CARTHREE
CAVOL/D12CS = 0;
CNTKT/D8CS = 0;
CDLSAV/D12CS = 0;
CTLSV/D12CS  = 0;
CLSAV/D12CS = 0;
CTLS/D12CS = 0;
CCLS2/D12CS = 0;
CCLS1/D12CS = 0;
CCLS3/D12CS = 0;
CCLS4 /D12CS = 0;
CCLS5/D12CS = 0;
CDTLSV/D12CS = 0;
CVSAV/D12CS= 0;
CDATKT/D12.2CS = 0;
CTAVGT/D12.2CS = 0;
CADVT/D8CS = 0;
CADVT1/D8CS = 0;
CADVT2/D8CS = 0;
CADVT3/D8CS = 0;
CDNONONL/D8CS = 0;
CNRP/D12.2CS = 0;
CPMILE/D12.2CS = 0;  
CHTTLA/D12.2CS = 0;
CHTTLN/P8CS =0;
AVGRATE/D12.2CS = 0;
END
TABLE FILE CARTHREE
PRINT
    CRENTAL
    CRENTALA
    CNOCMP_DAYS
    CNOMID_DAYS
    PASSNGR_NAME
    PCTNOCMP
    PCTNOMID
    AVGCAR
    CPAX
    CHTTLA
    AVGRATE
    CAVOL 
    CNTKT
    CDLSAV 
    CTLSV  
    CLSAV 
    CTLS 
    CCLS2  
    CCLS1 
    CCLS3  
    CCLS4  
    CCLS5 
    CDTLSV 
    CVSAV 
    CDATKT 
    CTAVGT 
    CADVT 
    CADVT1 
    CADVT2 
    CADVT3 
    CDNONONL 
    CNRP 
    CPMILE 
BY EMP_ID
BY PASSNGR_NAME
ON TABLE HOLD AS FINALHLD
END
-RUN    

-GOTO FinREPORT

-NOAIR   

MATCH FILE CARTHREE
PRINT CRENTAL
    CRENTALA
    CNOCMP_DAYS
    CNOMID_DAYS
    PASSNGR_NAME
    PCTNOCMP
    PCTNOMID
    AVGCAR
    CPAX
BY EMP_ID
BY PASSNGR_NAME
ON TABLE HOLD
RUN
FILE HTLHLD3
SUM CHTTLA
    AVGRATE
    HPAX
BY EMP_ID
BY PASSNGR_NAME
AFTER MATCH HOLD AS XONE OLD-OR-NEW
END
-RUN
 
DEFINE FILE XONE
 
CAVOL/D12CS = 0;
CNTKT/D8CS = 0;
CDLSAV/D12CS = 0;
CTLSV/D12CS  = 0;
CLSAV/D12CS = 0;
CTLS/D12CS = 0;
CCLS2/D12CS = 0;
CCLS1/D12CS = 0;
CCLS3/D12CS = 0;
CCLS4/D12CS = 0;
CCLS5/D12CS = 0;
CDTLSV/D12CS = 0;
CVSAV/D12CS= 0;
CDATKT/D12.2CS = 0;
CTAVGT/D12.2CS = 0;
CADVT/D8CS = 0;
CADVT1/D8CS = 0;
CADVT2/D8CS = 0;
CADVT3/D8CS = 0;
CDNONONL/D8CS = 0;
CNRP/D12.2CS = 0;
CPMILE/D12.2CS = 0;  
END
TABLE FILE XONE
PRINT
    CRENTAL
    CRENTALA
    CNOCMP_DAYS
    CNOMID_DAYS
    PASSNGR_NAME
    PCTNOCMP
    PCTNOMID
    AVGCAR
    CPAX
    CHTTLA
    AVGRATE
    CAVOL 
    CNTKT
    CDLSAV 
    CTLSV  
    CLSAV 
    CTLS 
    CCLS2  
    CCLS1 
    CCLS3  
    CCLS4  
    CCLS5 
    CDTLSV 
    CVSAV 
    CDATKT 
    CTAVGT 
    CADVT 
    CADVT1 
    CADVT2 
    CADVT3 
    CDNONONL 
    CNRP 
    CPMILE 
BY EMP_ID
BY PASSNGR_NAME
ON TABLE HOLD AS FINALHLD
END
-RUN    

-FinREPORT
 
DEFINE FILE FINALHLD
NOWTOD/A8 WITH CAVOL = HHMMSS (NOWTOD);
BLANK/A1 = ' ';
END
-RUN

-FinREPORT2

 

TABLE FILE FINALHLD
SUM EMP_ID AS 'Employee,ID'
 PASSNGR_NAME AS 'Employee,Name '
CAVOL/D12CS AS 'Total,Volume'
CNTKT/D8CS AS 'Net,Tickets'
CDLSAV/D12CS AS 'Domestic Air Lost Savings'
CTLSV/D12CS  AS '% of,Domestic Lost Savings, to Domestic Air Volume'
CLSAV/D12CS AS 'TOTAL $,Lost Savings'
CTLS/D12CS AS '% of,Total Lost Savings to,Total Air Volume'
CCLS2/D12CS AS '% of,Lost Savings Due to,Time Specified'
CCLS1/D12CS AS '% of,Lost Savings Due to,Declined Connection'
CCLS3/D12CS AS '% of,Lost Savings Due to,Airline/Flight Specified'
CCLS4/D12CS AS '% of,Lost Savings Due to,Refused Discount due to Penalty/Restrict'
CCLS5/D12CS AS '% of,Lost Savings Due to,Section/Fare Type Specified'
CDTLSV/D12CS AS '% of Domestic Lost Savings, to Total Lost Savings'
CVSAV/D12CS AS 'Contract,Savings'
CDATKT/D12.2CS AS 'Domestic,Average,Ticket,Price'
CTAVGT/D12.2CS AS 'Average,Ticket,Price'
CADVT/D8CS AS 'Net Tickets Purchased,0-6 Days'
CADVT1/D8CS AS 'Net Tickets Purchased,7-13 Days'
CADVT2/D8CS AS 'Net Tickets Purchased,14-20 Days'
CADVT3/D8CS AS 'Net Tickets Purchased,21+ Days'
CDNONONL/D8CS AS '# of, Domestic,Offline Bookings'
CNRP/D12.2CS AS '%,of NonRefundable Tickets'
CPMILE/D12.2CS AS 'Cost Per Mile'
PCTNOCMP/D12.2CS AS '%,of Cars Larger,Than Compact'
AVGCAR/D12.2CS AS 'Average Car, Rate'
AVGRATE/D12.2CS AS 'Average,Hotel,Cost Per,Night'
BY EMP_ID NOPRINT
BY PASSNGR_NAME NOPRINT



-HEAD 
HEADING
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
-*
-INCLUDE FOOTERDT
-*
ON TABLE SET PAGE-NUM OFF
ON TABLE NOTOTAL
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
 
ON TABLE SET STYLE *
-INCLUDE &&PASTYS
 
    TYPE=REPORT, COLUMN=N3, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N4, WRAP= 2.5,$ 
    TYPE=REPORT, COLUMN=N5, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N6, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N7, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N8, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N9, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N10, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N11, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N12, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N13, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N14, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N15, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N16, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N17, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N18, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N19, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N20, WRAP= .75,$
    TYPE=REPORT, COLUMN=N21, WRAP= .75,$
    TYPE=REPORT, COLUMN=N22, WRAP= .75,$
    TYPE=REPORT, COLUMN=N23, WRAP= .75,$
    TYPE=REPORT, COLUMN=N24, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N25, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N26, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N27, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N28, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N29, WRAP= 1.0,$
 
 
ENDSTYLE

&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN


-IF &RECORDS EQ 0 THEN GOTO NORECORDS ELSE GOTO XXIT;
 
 
 
 
-NORECORDS
-SET &&RPTSUF = 'MSG';
-INCLUDE FDEFRPTS
-RUN
JOIN SET_KEY IN BRPTINST TO SET_KEY IN BRPT_SET AS J1
DEFINE FILE BRPTINST
EMPTY/A35 = 'NO RECORDS FOUND FOR THIS SELECTION';
NOWTOD/A8 WITH INST_KEY = HHMMSS (NOWTOD);
END
TABLE FILE BRPTINST
"&&ROLLNME &&SP1 &&ROLLCS11 &&SP3 &&RCNCT1 &&SP4 &&ROLLPHN"
"&&DTDESC  Period1: &FMM/&FMD/&FMY - &TOM/&TOD/&TOY  Period2: &FXMM/&FXMD/&FXMY - &TXOM/&TXOD/&TXOY"
" "
"<35 &&RPT_TTL1"
"<35 &&RPT_TTL2"
PRINT EMPTY AS 'REPORT,MESSAGE'
BY ROLLUP_CODE AS 'ROLLUP,CODE'
BY RPT_NAME AS 'REPORT,NAME'
BY SELECT_LEV AS 'BREAK,LEVEL'
IF INST_KEY EQ &&IKEY
IF RECORDLIMIT EQ 1
-INCLUDE FOOTERDT
ON TABLE SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET PAGE-NUM OFF
ON TABLE SET STYLE *
-INCLUDE &&DTSTY
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
 
-XXIT;
