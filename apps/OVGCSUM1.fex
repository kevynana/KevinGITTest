-* CHANGED PROGRAM TO CONCATENATE PAGES INTO 1 PDF FILE - DEB 2/6/06

-* 2/4/15 - DEB - S-07190 CORRECTED ISSUE TO CHECK ALL DATABASES FOR TNT_COMPANY INFORMATION
-*9/01/15   JOY STORY ID - S-07278 - Updating to use Level_desc and removing Company code
-* Story ID S-10086 Added &&overdrill flag logic for use in 5.0 to choose to for the report to be drillable or non-drillable - 9/15/15 - JM
-* 03/14/17 JEM S-22486 - updated position of header and footer NEW_HDR NEW_FTR


 
-INCLUDE SETECHO
-* -INCLUDE DTRANGE
-RUN

-SET &&HEADING = 'GLOBAL EXECUTIVE OVERVIEW BY AGENCY';
-* CURRENT DATES
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');
-SET &&SP='|';
-SET &&SP3 = IF &&ROLLCNCT EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP4 = IF &&ROLLPHN EQ ' ' THEN ' ' ELSE &&SP;
-RUN



-IF &&OUTLINE1 CONTAINS 'ONLINE-FMT' OR 'PCHOLD' GOTO ONFMT;
-IF &&OUTFMT EQ 'EXCEL' OR 'EXL2K' GOTO NEXTPART1;
-IF &&OUTFMT EQ 'PDF' THEN GOTO CFMT ELSE GOTO OFMT;
-RUN

-CFMT
-SET &&OUTLINE1 = 'ON TABLE SAVE AS SAVREP';
-SET &&OUTLINE2 = 'FORMAT PDF OPEN';
-SET &&RPTSUF = 'OVERVIEW';
-INCLUDE FDEFRPTS
-RUN
-GOTO NEXTPART

-OFMT
-SET &&RPTSUF = 'OVERVIEW';
-INCLUDE FDEFRPTS
-RUN
-GOTO NEXTPART

-ONFMT
-IF &&OUTFMT NE 'PDF' GOTO ONFMT1;
-SET &&OUTLINE1 = 'ON TABLE PCHOLD';
-SET &&OUTLINE2 = 'FORMAT PDF OPEN';
-SET &&RPTSUF = '';
-RUN
-GOTO NEXTPART

-ONFMT1
-SET &&RPTSUF = 'OVERVIEW';
-RUN
-GOTO NEXTPART




 

-NEXTPART

-SET &&TNTPIC='OneCompanyGlobally.gif';

-NEXTPART1

 


DEFINE FILE OV1_GC1

ORGDSTNW/A6 = EDIT(ROW_LABEL, '999$999$$$');  
KEY/A2 = IF OV1_GC.CAT_ORDER EQ 1 THEN 'A' ELSE
         IF OV1_GC.CAT_ORDER EQ 2 THEN 'B' ELSE
         IF OV1_GC.CAT_ORDER EQ 3 THEN 'C' ELSE
         IF OV1_GC.CAT_ORDER EQ 4 THEN 'D' ELSE
         IF OV1_GC.CAT_ORDER EQ 5 THEN 'E' ELSE
         IF OV1_GC.CAT_ORDER EQ 6 THEN 'F' ELSE ' ';

ALABEL/A12='Volume     ';
ALABEL1/A12='Tickets     ';
ALABEL2/A12='Markets     ';
BLABEL/A12='Savings     ';
BLABEL1/A12='Average    ';
CLABEL/A12='Days        ';
HLABEL/A12='Nights      ';

FLABEL/A12= IF KEY EQ 'A' THEN ALABEL ELSE
            IF KEY EQ 'B' THEN BLABEL1 ELSE
            IF KEY EQ 'C' THEN ALABEL ELSE
            IF KEY EQ 'D' THEN ALABEL ELSE 
            IF KEY EQ 'E' THEN ALABEL ELSE 
            IF KEY EQ 'F' THEN ALABEL ELSE ' ';

FLABEL1/A12= IF KEY EQ 'A' THEN ALABEL1 ELSE
             IF KEY EQ 'B' THEN ALABEL1 ELSE 
             IF KEY EQ 'C' THEN ALABEL2 ELSE 
             IF KEY EQ 'D' THEN ALABEL2 ELSE
             IF KEY EQ 'E' THEN CLABEL ELSE 
             IF KEY EQ 'F' THEN HLABEL ELSE ' ';

TEST/A1='';
CR/A7 = 'Current';
-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*7/31/00    IBISTL-KR          ADDED DEFINE FOR NOWTOD
-*************************************************************************
NOWTOD/A8 WITH CAT_ORDER = HHMMSS (NOWTOD);
P1/A10='Period 1:';
P2/A33='Period 2:';
END
-RUN

TABLE FILE OV1_GC1
SUM LEVEL_DESC 
BY LEVEL_DESC NOPRINT
ON TABLE SAVE AS SAVTOT
END
-RUN

-IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' GOTO EXLSTY;


-IF &LINES EQ 0 THEN GOTO XEXIT;
-SET &&TOTLEVD = &LINES;
-SET &CNT = 1;
-REPEAT TOEND2 &LINES TIMES
-READ SAVTOT NOCLOSE &LEVD.A60
-SET &&LEVD.&CNT =  &LEVD;

TABLE FILE OV1_GC1
PRINT OV1_GC1.VOL_CURR 
      OV1_GC1.VOL_PRIOR
BY OV1_GC1.LEVEL_DESC NOPRINT
BY OV1_GC1.CAT_ORDER NOPRINT
BY OV1_GC1.ROW_ORDER NOPRINT
BY KEY NOPRINT
BY ORGDSTNW NOPRINT
WHERE LEVEL_DESC EQ '&LEVD'
ON TABLE HOLD AS JOY
END
-IF &RECORDS EQ 0 GOTO NXONE;


TABLE FILE OV1_GC1
PRINT OV1_GC1.ROW_LABEL AS ''
      OV1_GC1.VOL_CURR  AS '' IN 16
      OV1_GC1.TKT_CURR  AS '' IN 26 
      OV1_GC1.VOL_PRIOR AS '' IN 32 
      OV1_GC1.TKT_PRIOR AS '' IN 42
BY OV1_GC1.LEVEL_DESC NOPRINT
BY OV1_GC1.CAT_ORDER NOPRINT
BY OV1_GC1.ROW_ORDER NOPRINT
BY KEY NOPRINT
BY ORGDSTNW NOPRINT
WHERE LEVEL_DESC EQ '&LEVD'
ON OV1_GC1.LEVEL_DESC PAGE-BREAK
ON OV1_GC1.CAT_ORDER SUBHEAD
" "
"<ST.OV1_GC1.CATEGORY"
-* " "
"<16<FLABEL <24<FLABEL1 <32<FLABEL <40<FLABEL1"
-*" "

ON TABLE NOTOTAL
ON TABLE SET PAGE-NUM OFF
&&OUTLINE1
&&OUTLINE2
HEADING
-* "</2"
"<37 &&HEADING <75 &&DTDESC"
"<32 &&LVL_DSC <75 <P1 &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
"<75 <P2 &FXMM/&FXMD/&FXMY - &TXOM/&TXOD/&TXOY"
"<65 &&ROLLNME <+0> &&SP <+0> &&ROLLCS <+0> &&SP3 <+0> &&ROLLCNCT <+0> &&SP4 <+0> &&ROLLPHN"
"</1"
"<22 <LEVEL_DESC"
" "
" <19 --Period1-- <35 --Period2-- "
FOOTING BOTTOM
"</1"
-* "&&FOOTER"
"<65 &&FOOTR"
-* "A REPORT FROM eTTek Review RUN ON &DATE AT <NOWTOD
ON TABLE SET STYLE *
-IF &&SETF EQ 'OVABCD2' GOTO OVABCD2;
-IF &&OVERDRILL EQ 'Y' GOTO OVERDRILL;

-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*10/4/00    IBISTL-SB          ADDED DRILL DOWN

-*************************************************************************
-* TRAVEL AND TRANSPORT
-* CURRENT ROW 7**************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N7, WHEN=KEY EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR1' PARM1='CY' PARM2='&LEVD.EVAL' ROW_LABEL=N6\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N7, WHEN=KEY EQ 'B', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR1' PARM1='CY' PARM2='&LEVD.EVAL' ROW_LABEL=N6\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR ROW 9**************************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N9, WHEN=KEY EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR1' PARM1='PY' PARM2='&LEVD.EVAL' ROW_LABEL=N6\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N9, WHEN=KEY EQ 'B', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR1' PARM1='PY' PARM2='&LEVD.EVAL' ROW_LABEL=N6\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT MARKETS ROW 7************************************************
TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N7, WHEN=KEY EQ 'C', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCORG1' ORGDSTNW=N5 FLAGPARM='CY' PARM2='&LEVD.EVAL' VALUERANK=N1  \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR MARKETS ROW 9 

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N9, WHEN=KEY EQ 'C', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCORG1' ORGDSTNW=N5 FLAGPARM='PY' PARM2='&LEVD.EVAL' VALUERANK=N1  \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT CARRIERS ROW 7

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N7, WHEN=KEY EQ 'D', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCR1' ROW_LABEL=N6 FLAGPARM='CY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR CARRIERS ROW 9

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N9, WHEN=KEY EQ 'D', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCR1' ROW_LABEL=N6 FLAGPARM='PY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT CAR ROW 7

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N7, WHEN=KEY EQ 'E', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCAR1' ROW_LABEL=N6 FLAGPARM='CY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR CAR ROW 9 

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N9, WHEN=KEY EQ 'E', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCAR1' ROW_LABEL=N6 FLAGPARM='PY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT HOTEL ROW 7

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N7, WHEN=KEY EQ 'F', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCHTL1' ROW_LABEL=N6 FLAGPARM='CY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR HOTEL ROW 9 

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N9, WHEN=KEY EQ 'F', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCHTL1' ROW_LABEL=N6 FLAGPARM='PY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $


-******************DRILL DOWN END************************************

-OVERDRILL;

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.050000, RIGHTMARGIN=0.050000,
    TOPMARGIN=0.250000, BOTTOMMARGIN=0.150000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $

TYPE=REPORT, FOCEXEC=NONE, FONT=ARIAL, SIZE=8, COLOR=BLACK,
    BACKCOLOR=NONE, STYLE=NORMAL, JUSTIFY=LEFT, $
    
    
TYPE=HEADING,
     FONT='ARIAL',
     JUSTIFY=LEFT,
     SIZE=8,
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$    

TYPE=HEADING,
     LINE=1,
     ITEM=1,
     FONT='ARIAL',
     JUSTIFY=LEFT,
     SIZE=9,
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$

TYPE=HEADING,
     LINE=2,
     ITEM=1,
     FONT='ARIAL',
     JUSTIFY=LEFT,
     SIZE=9,
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$


-* TYPE=SUBHEAD, BY=2, LINE=2, OBJECT=FIELD, ITEM=1, FONT=ARIAL, SIZE=8,
-*      STYLE=BOLD+UNDERLINE, $
TYPE=SUBHEAD, FONT=ARIAL, SIZE=8, STYLE=BOLD+UNDERLINE, $
TYPE=FOOTING, SIZE=6, FONT=ARIAL, STYLE=BOLD, COLOR=RGB(70 136 177), $ 


 
-*******************
-* TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(6.25 .18), SIZE=(4.50 .7), $
-* TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(.5 .3), SIZE=(&&ROLSMSIZ), $

TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0), SIZE=(2.8 .37),PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.0), SIZE=(10.5 .58), PRESERVERATIO=ON, $

-* -GOTO SKIPTHIS
-IF &&M_GIF.&CNT EQ 'N' GOTO SKIP_MAR;
TYPE=REPORT,
IMAGE=&&MKTSVG.&CNT,
-*      POSITION=(5.3 1.2), SIZE=(5.0 2.5), $
        POSITION=(6.0 1.0), SIZE=(4.5 2.0),$
      
-SKIP_MAR

-IF &&C_GIF.&CNT EQ 'N' GOTO SKIP_CARR;
TYPE=REPORT,
IMAGE=&&SRSVG.&CNT,
-*      POSITION=(5.3 3.3), SIZE=(5.0 2.5), $
      POSITION=(6.0 3.0), SIZE=(4.5 2.0), $

-SKIP_CARR
-IF &&CAR_GIF.&CNT EQ 'N' GOTO SKIP_CAR;
TYPE=REPORT,
IMAGE=&&CARSVG.&CNT,
     POSITION=(4.5 5.5), SIZE=(4.5 2.5), $

      
-SKIP_CAR
-IF &&H_GIF.&CNT EQ 'N' GOTO SKIP_HOT;
TYPE=REPORT,
IMAGE=&&HTLSVG.&CNT,
-IF &&M_GIF.&CNT EQ 'N' AND &&C_GIF.&CNT EQ 'N' AND &&CAR_GIF.&CNT EQ 'N' THEN GOTO NEXTpos;
       POSITION=(7.5 5.5), SIZE=(4.5 2.5), $  
-GOTO SKIP_HOT
-NEXTpos
      POSITION=(5.3 1.2), SIZE=(5.0 2.5), $

       
-SKIP_HOT

-* -SKIPTHIS 

ENDSTYLE
END

-NXONE;
-SET &CNT = &CNT + 1;
-TOEND2
-CLOSE SAVTOT

-GOTO XXIT;


-OVABCD2;

-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*10/4/00    IBISTL-SB          ADDED DRILL DOWN

-*************************************************************************


UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.050000, RIGHTMARGIN=0.050000,
    TOPMARGIN=0.250000, BOTTOMMARGIN=0.150000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $

TYPE=REPORT, FOCEXEC=NONE, FONT=ARIAL, SIZE=8, COLOR=BLACK,
    BACKCOLOR=NONE, STYLE=NORMAL, JUSTIFY=LEFT, $
    
    
TYPE=HEADING,
     FONT='ARIAL',
     JUSTIFY=LEFT,
     SIZE=8,
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$    

TYPE=HEADING,
     LINE=1,
     ITEM=1,
     FONT='ARIAL',
     JUSTIFY=LEFT,
     SIZE=9,
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$

TYPE=HEADING,
     LINE=2,
     ITEM=1,
     FONT='ARIAL',
     JUSTIFY=LEFT,
     SIZE=9,
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$


-* TYPE=SUBHEAD, BY=2, LINE=2, OBJECT=FIELD, ITEM=1, FONT=ARIAL, SIZE=8,
-*      STYLE=BOLD+UNDERLINE, $
TYPE=SUBHEAD, FONT=ARIAL, SIZE=8, STYLE=BOLD+UNDERLINE, $
TYPE=FOOTING, SIZE=6, FONT=ARIAL, STYLE=BOLD, COLOR=RGB(70 136 177), $ 


 
-*******************
-* TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(6.25 .18), SIZE=(4.50 .7), $
-* TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(.5 .3), SIZE=(&&ROLSMSIZ), $

TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0), SIZE=(2.8 .37),PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.0), SIZE=(10.5 .58), PRESERVERATIO=ON, $

-IF &&M_GIF.&CNT EQ 'N' GOTO SKIP_MAR2;
TYPE=REPORT,
IMAGE=&&MKTSVG.&CNT,
-*      POSITION=(5.3 1.2), SIZE=(5.0 2.5), $
        POSITION=(6.0 1.0), SIZE=(4.5 2.0),$

-SKIP_MAR2

-IF &&C_GIF.&CNT EQ 'N' GOTO SKIP_CARR2;
TYPE=REPORT,
IMAGE=&&SRSVG.&CNT,
      POSITION=(5.7 3.3), SIZE=(5.0 2.0), $

-*      POSITION=(5.9 3.3), SIZE=(4.5 2.2), $
-* ORIG     POSITION=(5.3 3.3), SIZE=(5.0 2.5), $

      
-SKIP_CARR2
-IF &&CAR_GIF.&CNT EQ 'N' GOTO SKIP_CAR2;
TYPE=REPORT,
IMAGE=&&CARSVG.&CNT,
-*     POSITION=(3.9 5.5), SIZE=(4.5 2.4), $
     POSITION=(4.5 5.5), SIZE=(4.5 2.5), $

      
-SKIP_CAR2
-IF &&H_GIF.&CNT EQ 'N' GOTO SKIP_HOT2;
TYPE=REPORT,
IMAGE=&&HTLSVG.&CNT,
-IF &&M_GIF.&CNT EQ 'N' AND &&C_GIF.&CNT EQ 'N' AND &&CAR_GIF.&CNT EQ 'N' THEN GOTO NEXTpos2;
-*       POSITION=(6.9 5.5), SIZE=(4.5 2.4), $  
       POSITION=(7.5 5.5), SIZE=(4.5 2.5), $  

-GOTO SKIP_HOT2
-NEXTpos2
      POSITION=(5.3 1.2), SIZE=(5.0 2.5), $

       

       
-SKIP_HOT2


-* -SKIPTHIS 

ENDSTYLE
END

-NXONE;
-SET &CNT = &CNT + 1;
-TOEND2
-CLOSE SAVTOT

-GOTO XXIT;

-EXLSTY;

-SET &&TOTLEVD = &LINES;
-SET &CNT = 1;
-REPEAT TOEND2 &LINES TIMES
-READ SAVTOT NOCLOSE &LEVD.A60
-SET &&LEVD.&CNT =  &LEVD;
-SET &RPTSUF = '&LEVD.EVAL' ;

-SET &&RPTSUF = '&RPTSUF.EVAL';
-INCLUDE FDEFRPTS
-RUN
 
 



TABLE FILE OV1_GC1
PRINT OV1_GC1.VOL_CURR  AS 'Volume'
      OV1_GC1.TKT_CURR  AS 'Tickets'
      OV1_GC1.VOL_PRIOR AS 'Volume'
      OV1_GC1.TKT_PRIOR AS 'Tickets'
BY OV1_GC1.LEVEL_DESC NOPRINT
BY OV1_GC1.CAT_ORDER NOPRINT
BY OV1_GC1.ROW_ORDER NOPRINT
BY KEY NOPRINT
BY ORGDSTNW NOPRINT
BY OV1_GC1.ROW_LABEL AS ' '
WHERE LEVEL_DESC EQ '&LEVD'
ON OV1_GC1.LEVEL_DESC PAGE-BREAK
ON OV1_GC1.CAT_ORDER SUBHEAD
"<ST.OV1_GC1.CATEGORY"

ON TABLE NOTOTAL
ON TABLE SET PAGE-NUM OFF
&&OUTLINE1
&&OUTLINE2
HEADING
"Current: &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
"Prior:   &FXMM/&FXMD/&FXMY - &TXOM/&TXOD/&TXOY"
" "
"&&HEADING"
"&&LVL_DSC"
"<LEVEL_DESC"
" "
"<+0> <+0> Current <+0> Prior"


FOOTING BOTTOM
"&&FOOTER"
"OVERVIEW <65 &&FOOTR"
"A REPORT FROM eTTek Review RUN ON &DATE AT <NOWTOD
"<65 &&CRIGHT"
ON TABLE SET STYLE *
-IF &&OVERDRILL EQ 'Y' GOTO OVERDRILL1;
-IF '&&SETF' EQ 'OVABCD2' GOTO NODREX;
-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*10/4/00    IBISTL-SB          ADDED DRILL DOWN

-*************************************************************************
-* TRAVEL AND TRANSPORT
-* CURRENT ROW 7**************

TYPE=DATA, COLUMN=N7, WHEN=KEY EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR1' PARM1='CY' PARM2='&LEVD.EVAL' ROW_LABEL=N6\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N7, WHEN=KEY EQ 'B', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR1' PARM1='CY' PARM2='&LEVD.EVAL' ROW_LABEL=N6\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR ROW 9**************************

TYPE=DATA, COLUMN=N9, WHEN=KEY EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR1' PARM1='PY' PARM2='&LEVD.EVAL' ROW_LABEL=N6\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N9, WHEN=KEY EQ 'B', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR1' PARM1='PY' PARM2='&LEVD.EVAL' ROW_LABEL=N6\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT MARKETS ROW 7************************************************
TYPE=DATA, COLUMN=N7, WHEN=KEY EQ 'C', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCORG1' ORGDSTNW=N5 FLAGPARM='CY' PARM2='&LEVD.EVAL' VALUERANK=N1  \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR MARKETS ROW 9 

TYPE=DATA, COLUMN=N9, WHEN=KEY EQ 'C', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCORG1' ORGDSTNW=N5 FLAGPARM='PY' PARM2='&LEVD.EVAL' VALUERANK=N1  \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT CARRIERS ROW 7

TYPE=DATA, COLUMN=N7, WHEN=KEY EQ 'D', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCR1' ROW_LABEL=N6 FLAGPARM='CY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR CARRIERS ROW 9

TYPE=DATA, COLUMN=N9, WHEN=KEY EQ 'D', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCR1' ROW_LABEL=N6 FLAGPARM='PY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT CAR ROW 7

TYPE=DATA, COLUMN=N7, WHEN=KEY EQ 'E', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCAR1' ROW_LABEL=N6 FLAGPARM='CY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR CAR ROW 9 

TYPE=DATA, COLUMN=N9, WHEN=KEY EQ 'E', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCAR1' ROW_LABEL=N6 FLAGPARM='PY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT HOTEL ROW 7

TYPE=DATA, COLUMN=N7, WHEN=KEY EQ 'F', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCHTL1' ROW_LABEL=N6 FLAGPARM='CY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR HOTEL ROW 9 

TYPE=DATA, COLUMN=N9, WHEN=KEY EQ 'F', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCHTL1' ROW_LABEL=N6 FLAGPARM='PY' PARM2='&LEVD.EVAL' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $


-******************DRILL DOWN END************************************
-OVERDRILL1;
-NODREX; 

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.050000, RIGHTMARGIN=0.050000,
    TOPMARGIN=0.250000, BOTTOMMARGIN=0.150000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $

TYPE=REPORT, FOCEXEC=NONE, FONT=TIMES NEW ROMAN, SIZE=9, COLOR=BLACK,
    BACKCOLOR=NONE, STYLE=NORMAL, $
    
TYPE=HEADING, HEADALIGN=BODY,$    


TYPE=HEADING,
     LINE=1,
     SIZE=9,
-*      WRAP=2,
     JUSTIFY=LEFT,
     FONT='ARIAL',
     STYLE=BOLD,
$

TYPE=HEADING,
     LINE=2,
     SIZE=9,
     JUSTIFY=LEFT,
     FONT='ARIAL',
     STYLE=BOLD,
$


TYPE=HEADING,
     LINE=4,
     SIZE=10,
     COLSPAN=6,
     JUSTIFY=CENTER,
     FONT='ARIAL',
     STYLE=BOLD,
$

TYPE=HEADING,
     LINE=5,
     SIZE=10,
     COLSPAN=6,
     JUSTIFY=CENTER,
     FONT='ARIAL',
     STYLE=BOLD,
$
     
 TYPE=HEADING,
     LINE=6,
     SIZE=10,
     COLSPAN=6,
     JUSTIFY=CENTER,
     FONT='ARIAL',
     STYLE=BOLD,
$ 

TYPE=HEADING,
     LINE=8,
     ITEM=1,
     SIZE=9,
     COLSPAN=1,
     JUSTIFY=RIGHT,
     FONT='ARIAL',
     STYLE=BOLD,
$

TYPE=HEADING,
     LINE=8,
     ITEM=2,
     SIZE=9,
     COLSPAN=2,
     JUSTIFY=CENTER,
     FONT='ARIAL',
     STYLE=BOLD,
$

TYPE=HEADING,
     LINE=8,
     ITEM=3,
     SIZE=9,
     COLSPAN=2,
     JUSTIFY=CENTER,
     FONT='ARIAL',
     STYLE=BOLD,
$



TYPE=TITLE,
     FONT='ARIAL',
     SIZE=8,
     STYLE=BOLD,
     JUSTIFY=LEFT,
     COLOR=RGB(0 0 138),
$

TYPE=SUBHEAD, 
     OBJECT=FIELD, 
     ITEM=1, 
     FONT=ARIAL,
     SIZE=9,
     STYLE=BOLD+UNDERLINE, $

TYPE=DATA,
     COLUMN=N6,
     SIZE=8,
     FONT='ARIAL',
     STYLE=BOLD,
     WHEN=N6 EQ 'Total', 
$


TYPE=FOOTING, SIZE=6, $



-IF &&M_GIF.&CNT EQ 'N' GOTO SKIP_MARE;
TYPE=REPORT,
IMAGE=&&MKTSVG.&CNT,
      POSITION=(5.3 1.2), SIZE=(5.0 2.5), $
      
-SKIP_MARE

-IF &&C_GIF.&CNT EQ 'N' GOTO SKIP_CARRE;
TYPE=REPORT,
IMAGE=&&SRSVG.&CNT,
      POSITION=(5.3 3.3), SIZE=(5.0 2.5), $

      
-SKIP_CARRE
-IF &&CAR_GIF.&CNT EQ 'N' GOTO SKIP_CARE;
TYPE=REPORT,
IMAGE=&&CARSVG.&CNT,
     POSITION=(3.9 5.5), SIZE=(4.5 2.4), $

      
-SKIP_CARE
-IF &&H_GIF.&CNT EQ 'N' GOTO SKIP_HOTE;
TYPE=REPORT,
IMAGE=&&HTLSVG.&CNT,
       POSITION=(6.9 5.5), SIZE=(4.5 2.4), $  

       
-SKIP_HOTE


ENDSTYLE
END

-SET &CNT = &CNT + 1;
 

-TOENDE2
-CLOSE SAVTOT

-XXIT

-IF &&OUTFMT NE 'PDF' GOTO XXITA;
EX OVERCOV
-RUN


-XXITA;


