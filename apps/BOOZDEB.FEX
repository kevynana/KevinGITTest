SET ASNAMES = ON


DEFINE FILE A9BOOZ
CHG_COD/A47 = IF LEVEL3 NE ' ' AND LEVEL2 NE ' ' THEN
              LEVEL1  || '-' || LEVEL2 || '-' || LEVEL3 ELSE
              IF LEVEL3 EQ ' ' AND LEVEL2 NE ' ' THEN
              LEVEL1  || '-' || LEVEL2 ELSE
              IF LEVEL3 EQ ' ' AND LEVEL2 EQ ' ' THEN LEVEL1;
CC1/A1 = EDIT(LEVEL1, '9');
CC2/A1 = EDIT(LEVEL2, '9');
CC3/A1 = EDIT(LEVEL3, '9');
CHG_TYPE/A15 = IF CC1 EQ 'B' THEN 'BCHG' ELSE
               IF CC1 EQ 'G' THEN 'GCHG' ELSE
               IF CC1 EQ 'M' THEN 'MCHG' ELSE
               IF CC1 EQ 'P' THEN 'PCHG' ELSE
               IF CC1 EQ '1' THEN 'DEF PARTNERS' 
               ELSE 'DEF ALL OTHER';
CHG_TYPE2/A15 = IF CC2 EQ 'B' THEN 'BCHG' ELSE
               IF CC2 EQ 'G' THEN 'GCHG' ELSE
               IF CC2 EQ 'M' THEN 'MCHG' ELSE
               IF CC2 EQ 'P' THEN 'PCHG' ELSE
               IF CC2 EQ '1' THEN 'DEF PARTNERS' 
               ELSE 'DEF ALL OTHER';
CHG_TYPE3/A15 = IF CC3 EQ 'B' THEN 'BCHG' ELSE
               IF CC3 EQ 'G' THEN 'GCHG' ELSE
               IF CC3 EQ 'M' THEN 'MCHG' ELSE
               IF CC3 EQ 'P' THEN 'PCHG' ELSE
               IF CC3 EQ '1' THEN 'DEF PARTNERS' 
               ELSE 'DEF ALL OTHER';               
END
TABLE FILE A9BOOZ
PRINT CHG_COD CHG_TYPE TKT_NUM LEVEL2 LEVEL3
BY LEVEL1
WHERE BR_CL_IDX EQ 'BO173898' OR 'BO174441'
ON TABLE HOLD AS HOLD1 
END
-RUN

TABLE FILE A9BOOZ
PRINT CHG_COD CHG_TYPE2 AS 'CHG_TYPE' TKT_NUM LEVEL1 LEVEL3
BY LEVEL2
WHERE BR_CL_IDX EQ 'BO173898' OR 'BO174441'
WHERE LEVEL2 NE ' '
WHERE CHG_TYPE2 NE CHG_TYPE
ON TABLE HOLD AS HOLD2 
END
-RUN

TABLE FILE A9BOOZ
PRINT CHG_COD CHG_TYPE3 AS 'CHG_TYPE' TKT_NUM LEVEL1 LEVEL2
BY LEVEL3
WHERE BR_CL_IDX EQ 'BO173898' OR 'BO174441'
WHERE LEVEL3 NE ' '
WHERE CHG_TYPE2 NE CHG_TYPE3
WHERE CHG_TYPE NE CHG_TYPE3
ON TABLE HOLD AS HOLD3 
END
-RUN

 
 


TABLE FILE HOLD1
PRINT CHG_COD TKT_NUM LEVEL1 LEVEL2 LEVEL3
BY CHG_TYPE
ON TABLE HOLD AS CHARGE1 FORMAT FOCUS
END
-RUN


TABLE FILE HOLD2
PRINT CHG_COD  TKT_NUM LEVEL1 LEVEL2 LEVEL3
BY CHG_TYPE
ON TABLE HOLD AS CHARGE2 FORMAT FOCUS
END
-RUN

TABLE FILE HOLD3
PRINT CHG_COD  TKT_NUM LEVEL1 LEVEL2 LEVEL3
BY CHG_TYPE
ON TABLE HOLD AS CHARGE3 FORMAT FOCUS
END
-RUN


-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HNKA=&HLDPATH || 'CHARGE1.FOC';
-SET &HNKB=&HLDPATH || 'CHARGE2.FOC';
-SET &HNKC=&HLDPATH || 'CHARGE3.FOC';
-RUN


-SET &FILENAME = 'CHARGE1'; 
-RUN

-DOS STATE &HNKA
-SET &HOLDFILEC1 = IF &RETCODE.EVAL EQ 0 THEN &HNKA | ' AS ' | &FILENAME ELSE ' ';

-DOS STATE &HNKB
-SET &HOLDFILEC2 = IF &RETCODE.EVAL EQ 0 THEN &HNKC | ' AS ' | &FILENAME ELSE ' ';

-DOS STATE &HNKC
-SET &HOLDFILEC3 = IF &RETCODE.EVAL EQ 0 THEN &HNKB | ' AS ' | &FILENAME ELSE ' ';

USE ADD 
&HOLDFILEC1
&HOLDFILEC2
&HOLDFILEC3
END

TABLE FILE CHARGE1
PRINT CHG_COD CHG_TYPE LEVEL1 LEVEL2 LEVEL3
BY TKT_NUM 


IF CHG_COD CONTAINS 'M29316222XLXTC-B2877600070001-M31286222XSPMY'
OR 'B2820900070001-M28615222XAMRN-M28248222XNTGD'
END
-RUN
-QUIT

