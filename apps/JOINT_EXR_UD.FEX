-*6/27/17 - DLV -S-36481 - Created new routine to extract UDIDS for JTEXCH1

-INCLUDE SETECHO
SET ASNAMES = ON



TABLE FILE ROLLUP
PRINT COMP
IF ROLLUP EQ '&&ROLLUP.EVAL'
ON TABLE HOLD AS ROLLHOLD
END
-RUN

-READ ROLLHOLD &&COMP.A6
-SET &&COMPNY = &&COMP.EVAL;
 
-SET &&COMPUA = 'D:\TNT\TTRACKER\DATA\UA'|| '&&COMPNY.EVAL' ||'.FOC';
-RUN


 


USE 
&&COMPUA AS UDAIR
D:\TNT\TTRACKER\SYSTEM\DATA\UDID_DSC.FOC AS UDID_DSC
END

 

TABLE FILE UDAIR
PRINT AUD_DATA AS 'EN_NBR'  
BY AIR_KEY
IF UDID EQ 'EN-'  
ON TABLE HOLD AS UDIDHOLDA 
END
-RUN


TABLE FILE UDAIR
PRINT AUD_DATA AS 'REASON'
BY AIR_KEY
IF UDID EQ 'EXR'
ON TABLE HOLD AS UDIDHOLDB  
END
-RUN




 


MATCH FILE UDIDHOLDA
PRINT EN_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDIDHOLDB
PRINT REASON
BY AIR_KEY
AFTER MATCH HOLD AS XONE OLD-OR-NEW
END
-RUN

TABLE FILE XONE
PRINT EN_NBR REASON
BY AIR_KEY
ON TABLE HOLD AS UDIDHOLD2 FORMAT FOCUS INDEX AIR_KEY
END
-RUN

DEFINE FILE UDID_DSC
XL01/A4 = EDIT(UDID_ALPHA, '9999');
UDIDA/A4 = XL01;
END
TABLE FILE UDID_DSC
PRINT UD_DESC UDID_ALPHA 
BY UDIDA
WHERE UDID_ID EQ 'EXR'
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
ON TABLE HOLD AS DESCUDID FORMAT FOCUS INDEX UDIDA
END
-RUN

-INCLUDE EXAUSE
-RUN
