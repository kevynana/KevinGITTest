-* File getRankByDesc.fex
-* EX GETRANKBYDESC 1='ABTOPMPC', 2='AIR_PLCY', 3='AVI101' 
-DEFAULT &1='BIOTBNM';
-DEFAULT &2=' ';
-DEFAULT &3=' ';

TABLE FILE RANKBYTOP
PRINT RANKBY1 RANKBY2

-ChkGlobal
-IF '&1.EVAL' EQ ' ' GOTO ChkRPTStream;
WHERE GLOBAL_PARM EQ '&1.EVAL'

-ChkRPTStream
-IF '&2.EVAL' EQ ' ' GOTO ChkUseParm;
WHERE RPT_STREAM EQ '&2.EVAL'

-ChkUseParm
-IF '&3.EVAL' EQ ' ' GOTO HoldFile;
WHERE USE_PARM EQ '&3.EVAL'

-HoldFile

ON TABLE SET HOLDLIST PRINTONLY
ON TABLE PCHOLD
END

