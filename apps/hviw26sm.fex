-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* 8/11/14 - ADDED LOGIC FOR VXTPHDD1 - JK
-* 04/20/15 - S-08393 - DEB - ADDED CHAIN CODE TO VXTPHDD1
-* 05/12/16 - S-19041 - DLV - ADDED SORT BY HOTEL_PHONE DUE TO DRILL DOWN FAILING
-*                            FOR ABTPHDD
-* 02/24/31/17 DLV S-22486 - updated position of header and footer NEW_HDR NEW_FTR
-* 05/24/2017 JEM S-34216 - updating to make styling/heading/positioning more consistent
-* 08/01/2017 RSB S-38044 Place the footer datetime stamp text in a separate file to be -INCLUDED in the stylesheets
-*
-INCLUDE SETECHO
-* File HVIW26.FEX

SET ASNAMES=ON

 
-SET &&RANK_LIMIT = 50;
-SET &&RANK_LIMIT2 = 5;
-SET &&CTY_LMT = &&RANK_LIMIT;
-SET &&HTL_LMT = &&RANK_LIMIT2;
-SET &&RANK_METH = 'CDAY';
-* -SET &&RANK_METH = IF &&RANK_METH EQ 'ROOM_AMT' THEN 'ROOM_AMT'
-* - ELSE IF &&RANK_METH EQ 'NBR_DAYS' THEN 'NBR_DAYS' 
-* - ELSE 'NBR_DAYS';

-IF &&SETF EQ 'VXTPHDD' GOTO VXTP;
-IF &&SETF EQ 'VXTPHDD1' GOTO VXTP1;


TABLE FILE &&RPT_HOLD
SUM CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG 
    PREF_NON
BY CITY_ST
BY PROP_NAME
BY HOTEL_PHONE
-* BY PROP_ZIP5
-* BY PROP_ADDRESS
-* BY HOTEL_PHONE
-* BY CHAIN_CODE
ON TABLE HOLD AS HOLD1
END
-RUN




TABLE FILE HOLD1
PRINT 
    CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG    
    PROP_NAME
-*     PROP_ZIP5
-*     PROP_ADDRESS
     HOTEL_PHONE
-*     CHAIN_CODE
    PREF_NON
BY CITY_ST
RANKED BY HIGHEST &&RANK_METH NOPRINT
ON TABLE HOLD AS HOLD2
END
-RUN



DEFINE FILE HOLD2
 RANK_LIMIT/I5 = &&HTL_LMT;
 DRANK/D5      = RANK;
 ARANKX/A6 = FTOA(DRANK, '(D5)', 'A6');
 ARANK/A5=EDIT(ARANKX,'$99999');
 RANK_VALUE/A9 = IF (RANK_LIMIT EQ 0) THEN (ARANK) ELSE
                  IF RANK GT RANK_LIMIT THEN 'All Other' ELSE ARANK; 
-*  RANK_VALUE/A10 = IF (RANK_LIMIT EQ 0) THEN (ARANK) ELSE
-*                  IF CDAY EQ 0 THEN 'All Other' ELSE
-*                  IF RANK GT RANK_LIMIT THEN 'All Other' ELSE ARANK;  
-* CHAIN_CD/A2= IF RANK_VALUE LE '&&HTL_LMT' THEN CHAIN_CODE ELSE ' ';
 PNPR/A1 = IF RANK_VALUE LE '&&HTL_LMT' THEN PREF_NON ELSE ' ';
-*  HTL_ADDRESS/A35= IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_ADDRESS ELSE ' ';	
 HTL_NAME/A30 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_NAME ELSE 'All Other';
 PROP_PHONE/A15= IF RANK_VALUE LE '&&HTL_LMT' THEN HOTEL_PHONE ELSE ' ';
-*  ZIP5/A5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_ZIP5 ELSE ' ';	                 
                 
                 
END
-RUN

TABLE FILE HOLD2
SUM CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG     
BY CITY_ST
BY RANK_VALUE
BY HTL_NAME
-* BY ZIP5
-* BY HTL_ADDRESS
BY PROP_PHONE
-* BY CHAIN_CD
BY PNPR
ON TABLE HOLD AS HOLD3
END
-RUN



TABLE FILE HOLD1
SUM CDAY
BY CITY_ST
ON TABLE HOLD AS RHOLD1
END
-RUN

TABLE FILE RHOLD1
PRINT *
RANKED BY HIGHEST &&RANK_METH AS 'DAYS_RANK'
ON TABLE HOLD AS RHOLD2
END
-RUN

MATCH FILE HOLD3
PRINT *
BY CITY_ST
ON TABLE HOLD
RUN
FILE RHOLD2
SUM DAYS_RANK
BY CITY_ST
AFTER MATCH HOLD AS HOLD5 OLD-OR-NEW
END
-RUN

TABLE FILE HOLD5
PRINT *
RANKED BY HIGHEST DAYS_RANK
ON TABLE HOLD AS HOLD6
END
-RUN

DEFINE FILE HOLD6
  CTY_LIMIT/I2 = &&CTY_LMT;
  CLIMIT/A2    = EDIT(CTY_LIMIT) ;
  CRANK/D5     = RANK;    
  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
  LIST/D6 = IF CITY_ST NE LAST CITY_ST THEN (LAST LIST + 1) ELSE LAST LIST;
  FRANKX/A7 = FTOA(LIST, '(D6)', 'A7');
  FRANK/A6= EDIT(FRANKX,'$999999');
  CTY_VALUE/A9 = IF CTY_LIMIT EQ 0 THEN BRANK ELSE
                 IF LIST GT CTY_LIMIT THEN 'All Other' ELSE FRANK;
  CTY_PRINT/A35 = IF CTY_VALUE NE 'All Other' THEN CITY_ST ELSE 'All Other';	
                 
-*   CHAIN_CD1/A2= IF CTY_VALUE LT CTY_LIMIT THEN CHAIN_CD ELSE ' ';
  PNPR1/A1 = IF CTY_VALUE NE 'All Other' THEN PNPR ELSE ' ';
-*   HTL_ADDRESS1/A35= IF CTY_VALUE NE 'All Other' THEN HTL_ADDRESS ELSE ' ';	
  HTL_NAME1/A30 = IF CTY_VALUE NE 'All Other' THEN HTL_NAME ELSE ' ';
  HTL_NAME1A/A30 = IF CTY_VALUE EQ 'All Other' THEN 'All Other' ELSE HTL_NAME1;
  PROP_PHONE1/A15= IF CTY_VALUE NE 'All Other' THEN PROP_PHONE ELSE ' ';
-*   ZIP51/A5 = IF CTY_VALUE NE 'All Other' THEN ZIP5 ELSE ' ';	
  RANK_VAL/A10 = IF CTY_VALUE EQ 'All Other' THEN '9999999999' ELSE RANK_VALUE;
END
-RUN

TABLE FILE HOLD6
SUM CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG   
    CLIMIT
BY CTY_VALUE
BY CTY_PRINT 
BY RANK_VAL
BY HTL_NAME1A 
BY PROP_PHONE1
BY PNPR1
ON TABLE HOLD AS HOLD7
END
-RUN
 

DEFINE FILE HOLD7
SPACE/A5 = ' ';
NOWTOD/A8 WITH CTY_VALUE = HHMMSS (NOWTOD);
END

-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-SET &FXM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXY=EDIT(&&FXDATE,'$9999');
-SET &TXM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXY=EDIT(&&TXDATE,'$9999');
-SET &SP='|';
-SET &ROLLNME = TRUNCATE(&&RPTNAM);

-SET &ROLLCTY1 = LCWORD(15, '&&ROLLCTY.EVAL', 'A15');

-SET &ROLLCNCT = TRUNCATE(&&ROLLCNCT);
-SET &ROLLCS = TRUNCATE(&ROLLCTY1) || EDIT(&&ROLLSTA,', 99');

-SET &ROLLPHN = EDIT(&&ROLLFON,'9-999-999-9999');
 
-SET &ROLLCS = IF &&ROLLCS EQ ',' THEN ' ' ELSE &ROLLCS;
-SET &ROLLCS = IF &&ROLLSTA EQ '  ' THEN &&ROLLCTY ELSE &ROLLCS;
-SET &ROLLPHN = IF &&ROLLPHN EQ ' -   -   -    ' THEN ' ' ELSE &ROLLPHN;
-RUN

-IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' GOTO EXLFMT;
-RUN

-PDF;
TABLE FILE HOLD7
HEADING 
"</7"
"&&DTDESC &FXM/&FXD/&FXY - &TOM/&TOD/&TOY  <75 &ROLLNME <+0> &SP <+0> &ROLLCS <+0> &SP <+0> &ROLLCNCT <+0> &SP <+0> &ROLLPHN"
"Page:<TABPAGENO"
" "
"<40 &&RPT_TTL1"
"<39 &&RPT_TTL2"
"</2"
"<27 PERIOD: &FMM/&FMD/&FMY - &TOM/&TOD/&TOY <+0> <65 PERIOD: &FXM/&FXD/&FXY - &TXM/&TXD/&TXY"
" "
SUM CDAY/D12C AS '# OF,NGTS'
    CAMT/D12.2CM AS 'TOTAL,AMNT'
COMPUTE CADR/D12.2CM = IF CDAY EQ 0 THEN 0 ELSE 
                       IF CDAY LT 0 THEN (CAMT/CDAY)*(-1) ELSE (CAMT/CDAY); AS 'AVG,PER,NGT'
    CBK/D12C AS '# OF,BKGS'
COMPUTE CASTAY/D12 = IF CBK EQ 0 THEN 0 ELSE 
                     IF CBK LT 0 THEN (CDAY/CBK)*(-1) ELSE (CDAY/CBK); AS 'AVG,STAY'
    CSVG/D12.2CM AS 'SVGS,AMNT'
COMPUTE CSPN/D12.2CM = IF CDAY EQ 0 THEN 0 ELSE
                       IF CDAY LT 0  THEN (CSVG/CDAY)*(-1) ELSE (CSVG/CDAY); AS 'SVGS,PER,NGT'
SPACE AS ' '                        
    PDAY/D12C AS '# OF,NGTS'
    PAMT/D12.2CM AS 'TOTAL,AMNT'
COMPUTE PADR/D12.2CM = IF PDAY EQ 0 THEN 0 ELSE 
                       IF PDAY LT 0 THEN (PAMT/PDAY)*(-1) ELSE (PAMT/PDAY); AS 'AVG,PER,NGT'
    PBK/D12C AS '# OF,BKGS'
COMPUTE PASTAY/D12 = IF PBK EQ 0 THEN 0 ELSE 
                     IF PBK LT 0 THEN (PDAY/PBK)*(-1) ELSE (PDAY/PBK); AS 'AVG,STAY'
    PSVG/D12.2CM AS 'SVGS,AMNT'
COMPUTE PSPN/D12.2CM = IF PDAY EQ 0 THEN 0 ELSE
                       IF PDAY LT 0  THEN (PSVG/PDAY)*(-1) ELSE (PSVG/PDAY); AS 'SVGS,PER,NGT'                          
                        
BY CTY_VALUE NOPRINT
BY CTY_PRINT AS 'CITY/STATE'
BY RANK_VAL NOPRINT 
BY HTL_NAME1A AS 'HOTEL'
BY PNPR1 NOPRINT
ON CTY_PRINT RECOMPUTE AS 'TOTAL'
-*
-INCLUDE FOOTERSM
-*
ON TABLE PAGE-BREAK AND SUBFOOT
" "
" "
" "
" "
" "
-INCLUDE SBFOOT

ON TABLE SET STYLE *
-INCLUDE GLOBAL_LOGO
 
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.050000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
    
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $

TYPE=HEADING, LINE=9,  SIZE=8,  STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=10, SIZE=8,  STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=12, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=13, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=17, SIZE=9, JUSTIFY=RIGHT, STYLE=BOLD,  FONT='ARIAL', $

TYPE=SUBHEAD, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$
TYPE=FOOTING, SIZE=8, FONT='ARIAL', COLOR=RGB(70 136 177), $
TYPE=TITLE, STYLE=BOLD, JUSTIFY=LEFT, $
TYPE=SUBTOTAL, SIZE=8, JUSTIFY=LEFT, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=8, JUSTIFY=LEFT, STYLE=BOLD, $
TYPE=DATA, JUSTIFY=LEFT, $
TYPE=DATA, COLUMN=N4, WRAP=1, $
-* TYPE=DATA, COLUMN=N13, WRAP=.1, BACKCOLOR='BLACK', $
-* TYPE=DATA, COLUMN=N13, WRAP=.1, $
TYPE=DATA, BACKCOLOR='GREEN', WHEN=PNPR1 EQ 'P', $
TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0.2), SIZE=(2.8 .37),PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.0), SIZE=(10.5 .58), PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&TNTDTPOS), SIZE=(&&ROLDTSIZ), $
-INCLUDE &&DTSTY
ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-GOTO NextStep;


-********************** Excel 2K Output
-EXLFMT;

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADERDD' ELSE 'HDREXLSDD'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

TABLE FILE HOLD7
HEADING 
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
-*
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    &&S_SUBJ11
    &&S_SUBJ12
    &&S_SUBJ13
    &&S_SUBJ14
    &&S_SUBJ15
    &&S_SUBJ16
    &&S_SUBJ17
    &&S_SUBJ18
    &&S_SUBJ19
    &&S_SUBJ20    
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10
-*
-INCLUDE FOOTERSM
-*
ON TABLE PAGE-BREAK AND SUBFOOT
" "
" "
" "
" "
" "
-INCLUDE SBFOOT

ON TABLE SET STYLE *
-INCLUDE &&PASTYS
-GOTO JOY
-INCLUDE GLOBAL_LOGO

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.050000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
    
TYPE=REPORT, FONT=ARIAL, SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $
  

TYPE=HEADING, HEADALIGN=BODY,$

TYPE=HEADING,
     SIZE=9,
     JUSTIFY=LEFT,
     FONT='ARIAL',
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$

TYPE=HEADING,
     SIZE=9,
     LINE=4,
     JUSTIFY=LEFT,
     FONT='ARIAL',
     STYLE=BOLD,
     COLSPAN=2, 
     COLOR=RGB(70 136 177),
$

TYPE=HEADING,
     LINE=6,
     SIZE=10,
     COLSPAN=15,
     JUSTIFY=CENTER,
     FONT='ARIAL',
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$

TYPE=HEADING,
     LINE=7,
     SIZE=10,
     COLSPAN=15,
     JUSTIFY=CENTER,
     FONT='ARIAL',
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$

TYPE=HEADING, 
     LINE=9,
     ITEM=1, 
     COLSPAN=2,
$
TYPE=HEADING,
     LINE=9,
     ITEM=2,
     SIZE=9,
     COLSPAN=7,
     JUSTIFY=LEFT,
     STYLE=BOLD,
$

TYPE=HEADING,
     LINE=9,
     ITEM=3,
     SIZE=9,
     COLSPAN=1,
     JUSTIFY=LEFT,
     STYLE=BOLD,
$

TYPE=HEADING,
     LINE=9,
     ITEM=4,
     SIZE=9,
     COLSPAN=7,
     JUSTIFY=LEFT,
     STYLE=BOLD,
$

TYPE=TITLE,
     FONT='ARIAL',
     STYLE=BOLD,
     SIZE=9,
     JUSTIFY=LEFT,
     BACKCOLOR=NONE,
$


     
TYPE=FOOTING,
     SIZE=7,
     STYLE=BOLD,
     FONT='ARIAL',
$ 

-JOY

TYPE=REPORT, COLUMN=N2, SQUEEZE=1.5, $
TYPE=REPORT, COLUMN=N3, SQUEEZE=1.5, $
TYPE=DATA, JUSTIFY=LEFT, $
TYPE=DATA, COLUMN=N2, COLOR=RGB(0 0 138), $
TYPE=DATA, COLUMN=N4, COLOR=RGB(0 0 138), $
TYPE=DATA, COLUMN=N6, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N7, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N8, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N9, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N10, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N11, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N12, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N14, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N15, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N16, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N17, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N18, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N19, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N20, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N13, SQUEEZE=.1, $

TYPE=SUBTOTAL, JUSTIFY=LEFT, STYLE=BOLD, $
TYPE=GRANDTOTAL, JUSTIFY=LEFT, STYLE=BOLD,$
-IF '&&OUTFMT.EVAL' EQ 'EXCEL' GOTO NODSTY;

-INCLUDE &&DSTY
-NODSTY;
ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-GOTO XXIT;



-VXTP;
TABLE FILE &&RPT_HOLD
SUM CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG 
    PREF_NON
BY CITY_ST
BY PROP_NAME
BY PROP_CODE
BY PROP_LANYON_ID
BY PROP_LATITUDE
BY PROP_LONGITUDE
BY PROP_MOBIL_STARS
BY PROP_AAA_DIAMONDS
BY PROP_OHG_CLASS
ON TABLE HOLD AS HOLD1
END
-RUN


TABLE FILE HOLD1
PRINT 
    CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG    
    PROP_NAME
    PROP_CODE
    PROP_LANYON_ID
    PROP_LATITUDE
    PROP_LONGITUDE
    PROP_MOBIL_STARS
    PROP_AAA_DIAMONDS
    PROP_OHG_CLASS
    PREF_NON
BY CITY_ST
RANKED BY HIGHEST &&RANK_METH NOPRINT
ON TABLE HOLD AS HOLD2
END
-RUN


DEFINE FILE HOLD2
 RANK_LIMIT/I5 = &&HTL_LMT;
 DRANK/D5      = RANK;
 ARANKX/A6 = FTOA(DRANK, '(D5)', 'A6');
 ARANK/A5=EDIT(ARANKX,'$99999');
 RANK_VALUE/A9 = IF (RANK_LIMIT EQ 0) THEN (ARANK) ELSE
                  IF RANK GT RANK_LIMIT THEN 'All Other' ELSE ARANK; 

-*  PNPR/A1 = IF RANK_VALUE LE '&&HTL_LMT' THEN PREF_NON ELSE ' ';
-*  HTL_NAME/A30 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_NAME ELSE 'All Other';
 -* PROP_CD/A7 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_CODE ELSE ' ';
 -* LANYON_ID/A15 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_LANYON_ID ELSE ' ';
 -* PROP_LAT/D13.2 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_LATITUDE ELSE 0;               
 -* PROP_LON/D13.2  = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_LONGITUDE ELSE 0; 
 -* MOBIL_STARS/I5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_MOBIL_STARS ELSE 0;
 -* AAA_DIAMONDS/I5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_AAA_DIAMONDS ELSE 0;
 -* OHG_CLASS/A5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_OHG_CLASS ELSE ' ';
                
END
-RUN

TABLE FILE HOLD2
PRINT CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG  
    PROP_NAME
    PROP_CODE
    PROP_LANYON_ID
    PROP_LATITUDE
    PROP_LONGITUDE
    PROP_MOBIL_STARS
    PROP_AAA_DIAMONDS
    PROP_OHG_CLASS
    PREF_NON
BY CITY_ST
BY RANK_VALUE
-* BY PROP_NAME
-* BY PROP_CODE
-* BY PROP_LANYON_ID
-* BY PROP_LATITUDE
-* BY PROP_LONGITUDE
-* BY PROP_MOBIL_STARS
-* BY PROP_AAA_DIAMONDS
-* BY PROP_OHG_CLASS
-* BY PREF_NON
ON TABLE HOLD AS HOLD3
END
-RUN

DEFINE FILE HOLD3
HTL_NAME/A30 = IF RANK_VALUE NE 'All Other' THEN PROP_NAME ELSE 'All Other';
PNPR/A1 = IF RANK_VALUE NE 'All Other' THEN PREF_NON ELSE ' ';
PROP_CD/A7 = IF RANK_VALUE NE 'All Other' THEN PROP_CODE ELSE ' ';
LANYON_ID/A15 = IF RANK_VALUE NE 'All Other' THEN PROP_LANYON_ID ELSE ' ';
PROP_LAT/D13.8 = IF RANK_VALUE NE 'All Other' THEN PROP_LATITUDE ELSE 0;               
PROP_LON/D13.8  = IF RANK_VALUE NE 'All Other' THEN PROP_LONGITUDE ELSE 0; 
MOBIL_STARS/I5 = IF RANK_VALUE NE 'All Other' THEN PROP_MOBIL_STARS ELSE 0;
AAA_DIAMONDS/I5 = IF RANK_VALUE NE 'All Other' THEN PROP_AAA_DIAMONDS ELSE 0;
OHG_CLASS/A5 = IF RANK_VALUE NE 'All Other' THEN PROP_OHG_CLASS ELSE ' ';
END
-RUN

TABLE FILE HOLD3
SUM CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG 
BY CITY_ST
BY RANK_VALUE
BY HTL_NAME
BY PROP_CD
BY LANYON_ID
BY PROP_LAT
BY PROP_LON
BY MOBIL_STARS
BY AAA_DIAMONDS
BY OHG_CLASS
BY PNPR
ON TABLE HOLD AS HOLD4
END
-RUN


TABLE FILE HOLD1
SUM CDAY
BY CITY_ST
ON TABLE HOLD AS RHOLD1
END
-RUN

TABLE FILE RHOLD1
PRINT *
RANKED BY HIGHEST &&RANK_METH AS 'DAYS_RANK'
ON TABLE HOLD AS RHOLD2
END
-RUN

MATCH FILE HOLD4
PRINT *
BY CITY_ST
ON TABLE HOLD
RUN
FILE RHOLD2
SUM DAYS_RANK
BY CITY_ST
AFTER MATCH HOLD AS HOLD5 OLD-OR-NEW
END
-RUN

TABLE FILE HOLD5
PRINT *
RANKED BY HIGHEST DAYS_RANK
ON TABLE HOLD AS HOLD6
END
-RUN

DEFINE FILE HOLD6
  CTY_LIMIT/I2 = &&CTY_LMT;
  CLIMIT/A2    = EDIT(CTY_LIMIT) ;
  CRANK/D5     = RANK;    
  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
  LIST/D6 = IF CITY_ST NE LAST CITY_ST THEN (LAST LIST + 1) ELSE LAST LIST;
  FRANKX/A7 = FTOA(LIST, '(D6)', 'A7');
  FRANK/A6= EDIT(FRANKX,'$999999');
  CTY_VALUE/A9 = IF CTY_LIMIT EQ 0 THEN BRANK ELSE
                 IF LIST GT CTY_LIMIT THEN 'All Other' ELSE FRANK;
  CTY_PRINT/A35 = IF CTY_VALUE NE 'All Other' THEN CITY_ST ELSE 'All Other';	
                 
  PNPR1/A1 = IF CTY_VALUE NE 'All Other' THEN PNPR ELSE ' ';
  HTL_NAME1/A30 = IF CTY_VALUE NE 'All Other' THEN HTL_NAME ELSE ' ';
  HTL_NAME1A/A30 = IF CTY_VALUE EQ 'All Other' THEN 'All Other' ELSE HTL_NAME1;
  PROP_C1/A7 = IF CTY_VALUE NE 'All Other' THEN PROP_CD ELSE ' ';
  LID_P1/A15 = IF CTY_VALUE NE 'All Other' THEN LANYON_ID ELSE ' ';
  LON_P/D13.8 = IF CTY_VALUE NE 'All Other' THEN PROP_LON ELSE 0;
  LAT_P/D13.8 = IF CTY_VALUE NE 'All Other' THEN PROP_LAT ELSE 0;
  MOS_P/I5 = IF CTY_VALUE NE 'All Other' THEN MOBIL_STARS ELSE 0;
  AAA_P/I5 = IF CTY_VALUE NE 'All Other' THEN AAA_DIAMONDS ELSE 0;
  OHG_P/A5 = IF CTY_VALUE NE 'All Other' THEN OHG_CLASS ELSE ' ';
  RANK_VAL/A10 = IF CTY_VALUE EQ 'All Other' THEN '9999999999' ELSE RANK_VALUE;
END
-RUN

TABLE FILE HOLD6
SUM CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG   
    CLIMIT
    LON_P
BY CTY_VALUE
BY CTY_PRINT 
BY RANK_VAL
BY HTL_NAME1A 
BY PROP_C1
BY LID_P1
BY LON_P
BY LAT_P
BY MOS_P
BY AAA_P
BY OHG_P
BY PNPR1
ON TABLE HOLD AS HOLD7
END
-RUN

DEFINE FILE HOLD7
SPACE/A5 = ' ';
NOWTOD/A8 WITH CTY_VALUE = HHMMSS (NOWTOD);
END

-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-SET &FXM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXY=EDIT(&&FXDATE,'$9999');
-SET &TXM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXY=EDIT(&&TXDATE,'$9999');
-SET &SP='|';
-SET &ROLLNME = TRUNCATE(&&RPTNAM);

-SET &ROLLCTY1 = LCWORD(15, '&&ROLLCTY.EVAL', 'A15');

-SET &ROLLCNCT = TRUNCATE(&&ROLLCNCT);
-SET &ROLLCS = TRUNCATE(&ROLLCTY1) || EDIT(&&ROLLSTA,', 99');

-SET &ROLLPHN = EDIT(&&ROLLFON,'9-999-999-9999');
 
-SET &ROLLCS = IF &&ROLLCS EQ ',' THEN ' ' ELSE &ROLLCS;
-SET &ROLLCS = IF &&ROLLSTA EQ '  ' THEN &&ROLLCTY ELSE &ROLLCS;
-SET &ROLLPHN = IF &&ROLLPHN EQ ' -   -   -    ' THEN ' ' ELSE &ROLLPHN;
-RUN

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADERDD' ELSE 'HDREXLSDD'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

TABLE FILE HOLD7
HEADING 
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
-*
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    &&S_SUBJ11
    &&S_SUBJ12
    &&S_SUBJ13
    &&S_SUBJ14
    &&S_SUBJ15
    &&S_SUBJ16
    &&S_SUBJ17
    &&S_SUBJ18
    &&S_SUBJ19
    &&S_SUBJ20    
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10
-*
-INCLUDE FOOTERSM
-*
ON TABLE PAGE-BREAK AND SUBFOOT
" "
" "
" "
" "
" "
-INCLUDE SBFOOT

ON TABLE SET STYLE *
-INCLUDE &&PASTYS

TYPE=REPORT, COLUMN=N2, SQUEEZE=1.5, $
TYPE=REPORT, COLUMN=N3, SQUEEZE=1.5, $
TYPE=DATA, JUSTIFY=LEFT, $
TYPE=DATA, COLUMN=N2, COLOR=RGB(0 0 138), $
TYPE=DATA, COLUMN=N4, COLOR=RGB(0 0 138), $
-* TYPE=DATA, COLUMN=N6, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
-* TYPE=DATA, COLUMN=N7, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N13, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N14, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N15, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N16, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N17, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N18, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N19, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
-*TYPE=DATA, COLUMN=N15, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N21, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N22, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N23, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N24, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N25, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N26, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N27, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $

-*TYPE=DATA, COLUMN=N14, SQUEEZE=.1, $

TYPE=SUBTOTAL, JUSTIFY=LEFT, STYLE=BOLD, $
TYPE=GRANDTOTAL, JUSTIFY=LEFT, STYLE=BOLD,$
-IF '&&OUTFMT.EVAL' EQ 'EXCEL' GOTO NODSTY1;

-INCLUDE &&DSTY
-NODSTY1;
ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-GOTO XXIT;




-VXTP1;
TABLE FILE &&RPT_HOLD
SUM CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG 
    PREF_NON
BY CITY_ST
BY PROP_NAME
BY PROP_ZIP5
BY PROP_ADDRESS
BY PROP_CODE
BY PROP_LANYON_ID
BY PROP_LATITUDE
BY PROP_LONGITUDE
BY PROP_MOBIL_STARS
BY PROP_AAA_DIAMONDS
BY PROP_OHG_CLASS
BY CHAIN_CODE
ON TABLE HOLD AS HOLD1
END
-RUN


TABLE FILE HOLD1
PRINT 
    CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG    
    PROP_NAME
    PROP_ZIP5
    PROP_ADDRESS
    PROP_CODE
    PROP_LANYON_ID
    PROP_LATITUDE
    PROP_LONGITUDE
    PROP_MOBIL_STARS
    PROP_AAA_DIAMONDS
    PROP_OHG_CLASS
    CHAIN_CODE
    PREF_NON
BY CITY_ST
RANKED BY HIGHEST &&RANK_METH NOPRINT
ON TABLE HOLD AS HOLD2
END
-RUN

-SET &&HTL_LMT = '9999';

DEFINE FILE HOLD2
 RANK_LIMIT/I5 = &&HTL_LMT;
 DRANK/D5      = RANK;
 ARANKX/A6 = FTOA(DRANK, '(D5)', 'A6');
 ARANK/A5=EDIT(ARANKX,'$99999');
 RANK_VALUE/A9 = IF (RANK_LIMIT EQ 0) THEN (ARANK) ELSE
                  IF RANK GT RANK_LIMIT THEN 'All Other' ELSE ARANK; 

-*  PNPR/A1 = IF RANK_VALUE LE '&&HTL_LMT' THEN PREF_NON ELSE ' ';
-*  HTL_NAME/A30 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_NAME ELSE 'All Other';
 -* PROP_CD/A7 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_CODE ELSE ' ';
 -* LANYON_ID/A15 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_LANYON_ID ELSE ' ';
 -* PROP_LAT/D13.2 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_LATITUDE ELSE 0;               
 -* PROP_LON/D13.2  = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_LONGITUDE ELSE 0; 
 -* MOBIL_STARS/I5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_MOBIL_STARS ELSE 0;
 -* AAA_DIAMONDS/I5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_AAA_DIAMONDS ELSE 0;
 -* OHG_CLASS/A5 = IF RANK_VALUE LE '&&HTL_LMT' THEN PROP_OHG_CLASS ELSE ' ';
                
END
-RUN

TABLE FILE HOLD2
PRINT CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG  
    PROP_NAME
    PROP_ZIP5
    PROP_ADDRESS
    PROP_CODE
    PROP_LANYON_ID
    PROP_LATITUDE
    PROP_LONGITUDE
    PROP_MOBIL_STARS
    PROP_AAA_DIAMONDS
    PROP_OHG_CLASS
    CHAIN_CODE
    PREF_NON
BY CITY_ST
BY RANK_VALUE
-* BY PROP_NAME
-* BY PROP_CODE
-* BY PROP_LANYON_ID
-* BY PROP_LATITUDE
-* BY PROP_LONGITUDE
-* BY PROP_MOBIL_STARS
-* BY PROP_AAA_DIAMONDS
-* BY PROP_OHG_CLASS
-* BY PREF_NON
ON TABLE HOLD AS HOLD3
END
-RUN

DEFINE FILE HOLD3
HTL_NAME/A30 = IF RANK_VALUE NE 'All Other' THEN PROP_NAME ELSE 'All Other';
PNPR/A1 = IF RANK_VALUE NE 'All Other' THEN PREF_NON ELSE ' ';
PROP_CD/A7 = IF RANK_VALUE NE 'All Other' THEN PROP_CODE ELSE ' ';
LANYON_ID/A15 = IF RANK_VALUE NE 'All Other' THEN PROP_LANYON_ID ELSE ' ';
PROP_LAT/D13.8 = IF RANK_VALUE NE 'All Other' THEN PROP_LATITUDE ELSE 0;               
PROP_LON/D13.8  = IF RANK_VALUE NE 'All Other' THEN PROP_LONGITUDE ELSE 0; 
MOBIL_STARS/I5 = IF RANK_VALUE NE 'All Other' THEN PROP_MOBIL_STARS ELSE 0;
AAA_DIAMONDS/I5 = IF RANK_VALUE NE 'All Other' THEN PROP_AAA_DIAMONDS ELSE 0;
OHG_CLASS/A5 = IF RANK_VALUE NE 'All Other' THEN PROP_OHG_CLASS ELSE ' ';
ZIP/A5 = IF RANK_VALUE NE 'All Other' THEN PROP_ZIP5 ELSE ' ';
ADDRESS/A35 = IF RANK_VALUE NE 'All Other' THEN PROP_ADDRESS ELSE ' ';
CHAIN_CD/A2 = IF RANK_VALUE NE 'All Other' THEN CHAIN_CODE ELSE ' ';
-RUN

TABLE FILE HOLD3
SUM CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG 
BY CITY_ST
BY RANK_VALUE
BY HTL_NAME
BY ZIP
BY ADDRESS
BY PROP_CD
BY LANYON_ID
BY PROP_LAT
BY PROP_LON
BY MOBIL_STARS
BY AAA_DIAMONDS
BY OHG_CLASS
BY PNPR
BY CHAIN_CD
ON TABLE HOLD AS HOLD4
END
-RUN


TABLE FILE HOLD1
SUM CDAY
BY CITY_ST
ON TABLE HOLD AS RHOLD1
END
-RUN

TABLE FILE RHOLD1
PRINT *
RANKED BY HIGHEST &&RANK_METH AS 'DAYS_RANK'
ON TABLE HOLD AS RHOLD2
END
-RUN

MATCH FILE HOLD4
PRINT *
BY CITY_ST
ON TABLE HOLD
RUN
FILE RHOLD2
SUM DAYS_RANK
BY CITY_ST
AFTER MATCH HOLD AS HOLD5 OLD-OR-NEW
END
-RUN

TABLE FILE HOLD5
PRINT *
RANKED BY HIGHEST DAYS_RANK
ON TABLE HOLD AS HOLD6
END
-RUN

-SET &&CTY_LMT = '9999';

DEFINE FILE HOLD6
  CTY_LIMIT/I2 = &&CTY_LMT;
  CLIMIT/A2    = EDIT(CTY_LIMIT) ;
  CRANK/D5     = RANK;    
  BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
  LIST/D6 = IF CITY_ST NE LAST CITY_ST THEN (LAST LIST + 1) ELSE LAST LIST;
  FRANKX/A7 = FTOA(LIST, '(D6)', 'A7');
  FRANK/A6= EDIT(FRANKX,'$999999');
  CTY_VALUE/A9 = IF CTY_LIMIT EQ 0 THEN BRANK ELSE
                 IF LIST GT CTY_LIMIT THEN 'All Other' ELSE FRANK;
  CTY_PRINT/A35 = IF CTY_VALUE NE 'All Other' THEN CITY_ST ELSE 'All Other';	
                 
  PNPR1/A1 = IF CTY_VALUE NE 'All Other' THEN PNPR ELSE ' ';
  HTL_NAME1/A30 = IF CTY_VALUE NE 'All Other' THEN HTL_NAME ELSE ' ';
  HTL_NAME1A/A30 = IF CTY_VALUE EQ 'All Other' THEN 'All Other' ELSE HTL_NAME1;
  PROP_C1/A7 = IF CTY_VALUE NE 'All Other' THEN PROP_CD ELSE ' ';
  LID_P1/A15 = IF CTY_VALUE NE 'All Other' THEN LANYON_ID ELSE ' ';
  LON_P/D13.8 = IF CTY_VALUE NE 'All Other' THEN PROP_LON ELSE 0;
  LAT_P/D13.8 = IF CTY_VALUE NE 'All Other' THEN PROP_LAT ELSE 0;
  MOS_P/I5 = IF CTY_VALUE NE 'All Other' THEN MOBIL_STARS ELSE 0;
  AAA_P/I5 = IF CTY_VALUE NE 'All Other' THEN AAA_DIAMONDS ELSE 0;
  OHG_P/A5 = IF CTY_VALUE NE 'All Other' THEN OHG_CLASS ELSE ' ';
  RANK_VAL/A10 = IF CTY_VALUE EQ 'All Other' THEN '9999999999' ELSE RANK_VALUE;
  ZIP51/A5 = IF CTY_VALUE NE 'All Other' THEN ZIP ELSE ' ';
  HTL_ADDRESS/A35 = IF CTY_VALUE NE 'All Other' THEN ADDRESS ELSE ' ';
  CH_CD/A2 = IF CTY_VALUE NE 'All Other' THEN CHAIN_CD ELSE ' ';
END
-RUN

TABLE FILE HOLD6
SUM CDAY
    PDAY
    CAMT
    PAMT
    CBK
    PBK
    CSVG
    PSVG   
    CLIMIT
    LON_P
BY CTY_VALUE
BY CTY_PRINT 
BY RANK_VAL
BY HTL_NAME1A 
BY ZIP51
BY HTL_ADDRESS
BY PROP_C1
BY LID_P1
BY LON_P
BY LAT_P
BY MOS_P
BY AAA_P
BY OHG_P
BY PNPR1
BY CH_CD
ON TABLE HOLD AS HOLD7
END
-RUN

DEFINE FILE HOLD7
SPACE/A5 = ' ';
NOWTOD/A8 WITH CTY_VALUE = HHMMSS (NOWTOD);
END

-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-SET &FXM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXY=EDIT(&&FXDATE,'$9999');
-SET &TXM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXY=EDIT(&&TXDATE,'$9999');
-SET &SP='|';
-SET &ROLLNME = TRUNCATE(&&RPTNAM);

-SET &ROLLCTY1 = LCWORD(15, '&&ROLLCTY.EVAL', 'A15');

-SET &ROLLCNCT = TRUNCATE(&&ROLLCNCT);
-SET &ROLLCS = TRUNCATE(&ROLLCTY1) || EDIT(&&ROLLSTA,', 99');

-SET &ROLLPHN = EDIT(&&ROLLFON,'9-999-999-9999');
 
-SET &ROLLCS = IF &&ROLLCS EQ ',' THEN ' ' ELSE &ROLLCS;
-SET &ROLLCS = IF &&ROLLSTA EQ '  ' THEN &&ROLLCTY ELSE &ROLLCS;
-SET &ROLLPHN = IF &&ROLLPHN EQ ' -   -   -    ' THEN ' ' ELSE &ROLLPHN;
-RUN

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADERDD' ELSE 'HDREXLSDD'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

TABLE FILE HOLD7
HEADING 
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
-*
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    &&S_SUBJ11
    &&S_SUBJ12
    &&S_SUBJ13
    &&S_SUBJ14
    &&S_SUBJ15
    &&S_SUBJ16
    &&S_SUBJ17
    &&S_SUBJ18
    &&S_SUBJ19
    &&S_SUBJ20    
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10
-*
-INCLUDE FOOTERSM
-*
ON TABLE PAGE-BREAK AND SUBFOOT
" "
" "
" "
" "
" "
-INCLUDE SBFOOT

ON TABLE SET STYLE *
-INCLUDE &&PASTYS

TYPE=REPORT, COLUMN=N2, SQUEEZE=1.5, $
TYPE=REPORT, COLUMN=N3, SQUEEZE=1.5, $
TYPE=DATA, JUSTIFY=LEFT, $
TYPE=DATA, COLUMN=N2, COLOR=RGB(0 0 138), $
TYPE=DATA, COLUMN=N4, COLOR=RGB(0 0 138), $
-GOTO NOBACKCOLOR;
-* TYPE=DATA, COLUMN=N6, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
-* TYPE=DATA, COLUMN=N7, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N13, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N14, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N15, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N16, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N17, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N18, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N19, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
-*TYPE=DATA, COLUMN=N15, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N21, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N22, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N23, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N24, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N25, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N26, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
TYPE=DATA, COLUMN=N27, BACKCOLOR=RGB(17 185 38), WHEN=PNPR1 EQ 'P', $
-NOBACKCOLOR
-*TYPE=DATA, COLUMN=N14, SQUEEZE=.1, $

TYPE=SUBTOTAL, JUSTIFY=LEFT, STYLE=BOLD, $
TYPE=GRANDTOTAL, JUSTIFY=LEFT, STYLE=BOLD,$
-IF '&&OUTFMT.EVAL' EQ 'EXCEL' GOTO NODSTY1;

-INCLUDE &&DSTY
-NODSTY1;
ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-GOTO XXIT;



-NextStep;






-XXIT;