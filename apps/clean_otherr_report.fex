-*======================================================================
-*  PROGRAM : CLEAN_OTHERR_REPORT.FEX                   DATE: 01/30/2014
-*======================================================================
-*  DESCRIPTION: This program read the log file created by
-*  clean_otherr_clients.fex and outputs it to a report.
-*
-*  PROGRAMMER: GSE                               REQUESTOR: STEVE CORDS
-*  DATE       PROGRAMMER  CHANGE
-*  ----       ----------  ---------------------------------
-*======================================================================
EX -LINES 3 EDAPUT MASTER, tempmast,CV,MEM,FILENAME=TEMPMAST, SUFFIX=FIX, $
SEGNAME=ONE, SEGTYPE=S0,
 FIELD=FIELD1, ALIAS=FIELD1, A80, A80, $
 
CHECK FILE TEMPMAST
-RUN
 
FILEDEF TEMPMAST DISK D:\TEMP\clean_otherr.log
-RUN
 
TABLE FILE TEMPMAST
PRINT FIELD1
WHERE FIELD1 CONTAINS '(FOC' OR 'ERROR' OR 'Error' OR 'error'
WHERE FIELD1 OMITS '(FOC1364'
ON TABLE HOLD AS ERRORS
END
-RUN
 
-SET &LOGERR = IF &RECORDS GT 0 THEN ' ' ELSE 'FOC_NONE';
 
TABLE FILE TEMPMAST
PRINT FIELD1 AS ''
HEADING
"OTHER-R Cleanup Processing Log"
" "
"Errors were encountered" &LOGERR
"Please search below for '(FOC' " &LOGERR
ON TABLE SET LINES 99999
ON TABLE SET PAGE-NUM OFF
ON TABLE NOTOTAL
ON TABLE PCHOLD FORMAT HTML
ON TABLE SET HTMLCSS OFF
ON TABLE SET STYLE *
     UNITS=IN,
     PAGESIZE='Letter',
     LEFTMARGIN=0.250000,
     RIGHTMARGIN=0.250000,
     TOPMARGIN=0.250000,
     BOTTOMMARGIN=0.250000,
     SQUEEZE=ON,
     ORIENTATION=PORTRAIT,
$
TYPE=REPORT,
     FONT='ARIAL',
     SIZE=10,
     COLOR='BLACK',
     BACKCOLOR='NONE',
     STYLE=NORMAL,
$
TYPE=DATA,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8,
     BACKCOLOR=( RGB(242 242 242) 'WHITE' ),
$
TYPE=TITLE,
     COLUMN=N9,
     JUSTIFY=CENTER,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
$
TYPE=TITLE,
     COLUMN=N7,
     JUSTIFY=CENTER,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
$
TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=9,
     COLOR='WHITE',
     BACKCOLOR=RGB(154 175 212),
     STYLE=BOLD,
$
TYPE=HEADING,
     SIZE=10,
     COLOR=RGB(36 43 114),
     STYLE=BOLD,
     JUSTIFY=LEFT,
$
TYPE=HEADING,
     LINE=1,
	 SIZE=12,
	 JUSTIFY=CENTER,
$
TYPE=FOOTING,
     STYLE=BOLD,
$
TYPE=SUBHEAD,
     SIZE=9,
     STYLE=BOLD,
$
ENDSTYLE
END
