-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-* File COVER.FEX
-***************** M O D I F I C A T I O N S *******************
-*  DATE        NAME         DESCRIPTION OF CHANGE
-*  ----        ----         ---------------------
-*  5/22/98     JK           CHANGED HEADINGS
-* 06/20/98     SAC          CHANGED CLASS OF SERVICE FIELDS
-**********************************************************************
-* Cover Page Routine
-**********************************************************************
-*
-IF &&COVER EQ 'N' THEN GOTO ENDCOVER;

-* 10/16/00  IBISTL-RJ  ADDED IF STATEMENT TO PREVENT GENERATION OF COVER
-*                      PAGE IF BEING RETURNED TO BROWSER
-IF &&OUTLINE1 CONTAINS 'ONLINE-FMT' OR 'PCHOLD' GOTO ENDCOVER;
-*

-SET &&RPTSUF = 'CPG';
-INCLUDE FDEFRPTS
-RUN

-TYPE COVER1

-SET &&RPT_TTL3='            REFERENCE TABLES            ';
-IF &&REPTTYPE EQ 'AIR' THEN GOTO AIRCOV;
-IF &&REPTTYPE EQ 'CAR' THEN GOTO CARCOV;
-IF &&REPTTYPE EQ 'HTL' THEN GOTO HTLCOV;
-*
-**********************************************************************
-* Air cover report
-**********************************************************************
-AIRCOV
-*
-* JOIN CLEAR *
-RUN

JOIN AIRLINE IN &&RPT_HOLD TO AIRLINE IN AIRLINE AS J1
JOIN REFUSE_KEY IN &&RPT_HOLD TO REFUSE_KEY IN AIR_REF AS J2
JOIN DOC_TYPE IN &&RPT_HOLD TO DOC_TYPE IN TKT_TYPE AS J3
-RUN

DEFINE FILE &&RPT_HOLD
   HYPHEN/A1='-';
END
TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM HYPHEN AND AIRLINE_NAME BY AIRLINE
WHERE AIRLINE NE ' ' 
ON TABLE NOTOTAL
ON TABLE SAVE AS AIRCOD
END
-RUN

-SET &CNT=IF (&LINES LE 45) THEN &LINES ELSE 45;

-REPEAT INITIT1 FOR &I FROM 1 TO 45
-SET &&AIR.&I='                ';
-INITIT1
-REPEAT LOADIT1 FOR &K FROM 1 TO &CNT
-READ AIRCOD &&AIR.&K
-LOADIT1
-RUN

TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM HYPHEN AND REFUSAL_DESC BY REFUSE_KEY
ON TABLE NOTOTAL
ON TABLE SAVE AS REFDESC
END
-RUN
-SET &CNT=&LINES;

-REPEAT INITIT2 FOR &I FROM 1 TO 27
-SET &&REF.&I='                                           ';
-INITIT2
-REPEAT LOADIT2 FOR &K FROM 1 TO &CNT
-READ REFDESC &FILL.A8. &&REF.&K
-LOADIT2
-RUN

TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM HYPHEN AND DOC_DESC BY DOC_ABBR
ON TABLE NOTOTAL
ON TABLE SAVE AS DOCTYP
END
-RUN
-SET &CNT=&LINES;

-REPEAT INITIT3 FOR &I FROM 1 TO 9
-SET &&DOCTYP.&I='                        ';
-INITIT3
-REPEAT LOADIT3 FOR &K FROM 1 TO &CNT
-READ DOCTYP &&DOCTYP.&K
-LOADIT3
-RUN

TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM CLASS NOPRINT 
HEADING
-INCLUDE HEADAIR
"<10 AIRLINE CODES <47 CLASS CATEGORIES"
"&&AIR1 <20 &&AIR23 <45 F-FIRST CLASS" 
"&&AIR2 <20 &&AIR24 <45 B-BUSINESS CLASS" 
"&&AIR3 <20 &&AIR25 <45 C-COACH CLASS"
"&&AIR4 <20 &&AIR26 <45 D-DISCOUNTED COACH CLASS"
"&&AIR5 <20 &&AIR27" 
"&&AIR6 <20 &&AIR28 <47 DOCUMENT TYPES"
"&&AIR7 <20 &&AIR29 <45 &&DOCTYP1"
"&&AIR8 <20 &&AIR30 <45 &&DOCTYP2"
"&&AIR9 <20 &&AIR31 <45 &&DOCTYP3"
"&&AIR10 <20 &&AIR32 <45 &&DOCTYP4"
"&&AIR11 <20 &&AIR33 <45 &&DOCTYP5" 
"&&AIR12 <20 &&AIR34 <45 &&DOCTYP6" 
"&&AIR13 <20 &&AIR35 <45 &&DOCTYP7"
"&&AIR14 <20 &&AIR36 <45 &&DOCTYP8"
"&&AIR15 <20 &&AIR37 <45 &&DOCTYP9"
"&&AIR16 <20 &&AIR38 <43 CLASS OF SERVICE-CATEGORY-AIRLINE"
"&&AIR17 <20 &&AIR39 <40 A,D,F,P,R-FIRST-ALL"
"&&AIR18 <20 &&AIR40 <40 U-COACH-ALL" 
"&&AIR19 <20 &&AIR41 <40 G,K,KN,Q,T,V,VN,W,Z-DISCOUNTED-ALL"
"&&AIR20 <20 &&AIR42 <40 B,BN-COACH-DL,HP,NW,TW,UA,US"
"&&AIR21 <20 &&AIR43 <40 B-DISCOUNTED-ALL OTHER"
"&&AIR22 <20 &&AIR44 <40 C-COACH-KL"
"        <20 &&AIR45 <40 C-BUSINESS-ALL OTHER" 
"<10 REASON CODES <40 CA,CB,CD-DISCOUNTED-2V"
"&&REF1 <40 C,CE,CM,DA,EA,EB-COACH-2V" 
"&&REF2 <40 FA,HA,VA,VN-COACH-2V"
"&&REF3 <40 CF-BUSINESS-2V"
"&&REF4 <40 E-DISCOUNTED-RG"
"&&REF5 <40 FN-FIRST-HP,US"
"&&REF6 <40 H-COACH-YX"
"&&REF7 <40 H-DISCOUNTED-ALL OTHER"
"&&REF8 <40 HN,MN-COACH-US"
"&&REF9 <40 J-DISCOUNTED-AA"
"&&REF10 <40 J-COACH-SQ,TG"
"&&REF11 <40 J-BUSINESS-ALL OTHER"
"&&REF12 <40 L-COACH-LN,WN"
"&&REF13 <40 L-DISCOUNTED-ALL OTHER"
"&&REF14 <40 L-DISCOUNTED-ALL OTHER"
"&&REF15 <40 M-COACH-AC,AS,NW,UA,US,YX,ZK"
"&&REF16 <40 M-DISCOUNTED-ALL OTHER"
"&&REF17 <40 N,NF-FIRST-UA"
"&&REF18 <40 NC-BUSINESS-UA"
"&&REF19 <40 QN-DISCOUNTED-HP"
"&&REF20 <40 S-BUSINESS-AA,AF,BA"
"&&REF21 <40 S-DISCOUNTED-ALL OTHER"
"&&REF22 <40 Y-DISCOUNTED-AF,AH"
"&&REF23 <40 Y-COACH-ALL OTHER"
"&&REF24 <40 YN-DISCOUNTED-DL,HP,NW"
"&&REF25 <40 YN-COACH-UA,US" 
"&&REF26"
"&&REF27"   
WHERE RECORDLIMIT EQ 1
ON TABLE NOTOTAL
-*ON TABLE SET STYLE &&DTSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**************************************************************************
ON TABLE SET STYLE *
-INCLUDE &&DTSTY
ENDSTYLE
&&OUTLINE1
&&COVERDEST
&&OUTLINE2
END
-RUN
-*
-GOTO ENDCOVER
-*
-**********************************************************************
-* Car cover report
-**********************************************************************
-*
-CARCOV
-*
-* JOIN CLEAR *
-RUN

JOIN CAR_TYPE      IN &&RPT_HOLD TO CAR_TYPE     IN CAR_TYPE AS J3
JOIN ALPHA_RATE    IN &&RPT_HOLD TO ALPHA_RATE   IN AL_RATE  AS J4
JOIN REFUSE_KEY    IN &&RPT_HOLD TO REFUSE_KEY   IN CAR_REF  AS J5
-RUN
-*
DEFINE FILE &&RPT_HOLD
   HYPHEN/A1 = '-';
   SHORTREF/A2=EDIT(REFUSE_KEY,'$$$$$$$$99');
END
TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM HYPHEN AND CAR_CAT BY CAR_TYPE
ON TABLE NOTOTAL
ON TABLE SAVE AS CARTYP
END
-RUN

-SET &CNT=IF (&LINES LE 45) THEN &LINES ELSE 45;

-REPEAT INITIT4 FOR &I FROM 1 TO 45
-SET &&CAR.&I='                  ';
-INITIT4
-REPEAT LOADIT4 FOR &K FROM 1 TO &CNT
-READ CARTYP &&CAR.&K
-LOADIT4

TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM HYPHEN AND REFUSAL_DESC BY REFUSE_KEY
WHERE SHORTREF NE ' '
ON TABLE NOTOTAL
ON TABLE SAVE AS CARREFUS
END
-RUN

-SET &CNT=&LINES;

-REPEAT INITIT5 FOR &I FROM 1 TO 15
-SET &&REF.&I='                                           ';
-INITIT5
-REPEAT LOADIT5 FOR &K FROM 1 TO &CNT
-READ CARREFUS &FILL.A8. &&REF.&K
-LOADIT5

TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM HYPHEN AND RATE_DESC BY ALPHA_RATE
ON TABLE NOTOTAL
ON TABLE SAVE AS RATETYP
END
-RUN

-SET &CNT=&LINES;

-REPEAT INITIT6 FOR &I FROM 1 TO 12
-SET &&ALRATE.&I='             ';
-INITIT6
-REPEAT LOADIT6 FOR &K FROM 1 TO &CNT
-READ RATETYP &&ALRATE.&K
-LOADIT6

TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM TICKET_BRANCH NOPRINT
HEADING
-INCLUDE HEADAIR
"<10 CAR TYPES"
"&&CAR1 <20 &&CAR16 <40 &&CAR31"
"&&CAR2 <20 &&CAR17 <40 &&CAR32"
"&&CAR3 <20 &&CAR18 <40 &&CAR33"
"&&CAR4 <20 &&CAR19 <40 &&CAR34"
"&&CAR5 <20 &&CAR20 <40 &&CAR35"
"&&CAR6 <20 &&CAR21 <40 &&CAR36"
"&&CAR7 <20 &&CAR22 <40 &&CAR37"
"&&CAR8 <20 &&CAR23 <40 &&CAR38"
"&&CAR9 <20 &&CAR24 <40 &&CAR39"
"&&CAR10 <20 &&CAR25 <40 &&CAR40"
"&&CAR11 <20 &&CAR26 <40 &&CAR41"
"&&CAR12 <20 &&CAR27 <40 &&CAR42"
"&&CAR13 <20 &&CAR28 <40 &&CAR43"
"&&CAR14 <20 &&CAR29 <40 &&CAR44"
"&&CAR15 <20 &&CAR30 <40 &&CAR45"
"  "
"<10 REASON CODES <52 RATE TYPES"
"&&REF1 <47 &&ALRATE1"
"&&REF2 <47 &&ALRATE2"
"&&REF3 <47 &&ALRATE3"
"&&REF4 <47 &&ALRATE4"
"&&REF5 <47 &&ALRATE5"
"&&REF6 <47 &&ALRATE6"
"&&REF7 <47 &&ALRATE7"
"&&REF8 <47 &&ALRATE8"
"&&REF9 <47 &&ALRATE9"
"&&REF10 <47 &&ALRATE10"
"&&REF11 <47 &&ALRATE11"
"&&REF12 <47 &&ALRATE12"
"&&REF13 "
"&&REF14 "
"&&REF15 "

WHERE RECORDLIMIT EQ 1
ON TABLE NOTOTAL
-*ON TABLE SET STYLE &&DTSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**************************************************************************
ON TABLE SET STYLE *
-INCLUDE &&DTSTY 
ENDSTYLE
&&OUTLINE1
&&COVERDEST
&&OUTLINE2
END
-RUN
-*
-GOTO ENDCOVER
-*
-**********************************************************************
-* Hotel cover report
-**********************************************************************
-*
-HTLCOV
-*
-* JOIN CLEAR *
-RUN

-*JOIN CHAIN_CODE    IN &&RPT_HOLD TO CHAIN_CODE  IN HOTL_CHN AS J3
JOIN ALPHA_RATE    IN &&RPT_HOLD TO ALPHA_RATE  IN AL_RATE  AS J4
JOIN REFUSE_KEY    IN &&RPT_HOLD TO REFUSE_KEY  IN HTL_REF  AS J5
-RUN
-*
DEFINE FILE &&RPT_HOLD
   HYPHEN/A1 = '-';
   SHORTREF/A2=EDIT(REFUSE_KEY,'$$$$$$$$99');
END
TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM HYPHEN AND CHAIN_NAME/A25 BY CHAIN_CODE
ON TABLE NOTOTAL
ON TABLE SAVE AS HTLCHN
END
-RUN

-SET &CNT=IF (&LINES LE 45) THEN &LINES ELSE 45;

-REPEAT INITIT FOR &I FROM 1 TO 45
-SET &&HTL.&I='                            ';
-INITIT
-REPEAT LOADIT FOR &K FROM 1 TO &CNT
-READ HTLCHN &&HTL.&K

-LOADIT

TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM HYPHEN AND REFUSAL_DESC BY REFUSE_KEY
WHERE SHORTREF NE ' '
ON TABLE NOTOTAL
ON TABLE SAVE AS HTLREFUS
END
-RUN

-SET &CNT=&LINES;

-REPEAT INITIT7 FOR &I FROM 1 TO 15
-SET &&REF.&I='                                           ';
-INITIT7
-REPEAT LOADIT7 FOR &K FROM 1 TO &CNT
-READ HTLREFUS &FILL.A8. &&REF.&K
-LOADIT7

TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM HYPHEN AND RATE_DESC BY ALPHA_RATE
ON TABLE NOTOTAL
ON TABLE SAVE AS RATETYP
END
-RUN

-SET &CNT=&LINES;

-REPEAT INITIT8 FOR &I FROM 1 TO 12
-SET &&ALRATE.&I='             ';
-INITIT8
-REPEAT LOADIT8 FOR &K FROM 1 TO &CNT
-READ RATETYP &&ALRATE.&K
-LOADIT8

TABLE FILE &&RPT_HOLD
ON TABLE SET PAGE-NUM OFF
SUM TICKET_BRANCH NOPRINT
HEADING
-INCLUDE HEADAIR
"<10 HOTEL CHAINS"
"&&HTL1 <32 &&HTL16"
"&&HTL2 <32 &&HTL17"
"&&HTL3 <32 &&HTL18"
"&&HTL4 <32 &&HTL19"
"&&HTL5 <32 &&HTL20"
"&&HTL6 <32 &&HTL21"
"&&HTL7 <32 &&HTL22"
"&&HTL8 <32 &&HTL23"
"&&HTL9 <32 &&HTL24"
"&&HTL10 <32 &&HTL25"
"&&HTL11 <32 &&HTL26"
"&&HTL12 <32 &&HTL27"
"&&HTL13 <32 &&HTL28"
"&&HTL14 <32 &&HTL29"
"&&HTL15 <32 &&HTL30"
"  "
"<10 REASON CODES <49 RATE TYPES"
"&&REF1 <47 &&ALRATE1"
"&&REF2 <47 &&ALRATE2"
"&&REF3 <47 &&ALRATE3"
"&&REF4 <47 &&ALRATE4"
"&&REF5 <47 &&ALRATE5"
"&&REF6 <47 &&ALRATE6"
"&&REF7 <47 &&ALRATE7"
"&&REF8 <47 &&ALRATE8"
"&&REF9 <47 &&ALRATE9"
"&&REF10 <47 &&ALRATE10"
"&&REF11 <47 &&ALRATE11"
"&&REF12 <47 &&ALRATE12"
"&&REF13 "
"&&REF14 "
"&&REF15 "
 
WHERE RECORDLIMIT EQ 1
ON TABLE NOTOTAL
-*ON TABLE SET STYLE &&DTSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**************************************************************************
ON TABLE SET STYLE *
-INCLUDE &&DTSTY   
ENDSTYLE
&&OUTLINE1
&&COVERDEST
&&OUTLINE2
END
-RUN
-*
-ENDCOVER
-*
-SET &&RPT_TTL3=' ';
-SET &&TTL3=' '; 

-* JOIN CLEAR *
-RUN

-IF &&DRILLABLE EQ 'Y' GOTO DRILL;

EX REPORT_2
END
-RUN

-DRILL

-*-EXIT














