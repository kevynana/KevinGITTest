SET ASNAMES = ON




TABLE FILE SYNYL
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS DEBHOLD
END
-RUN
-QUIT


TABLE FILE AYNYL
PRINT AIR_KEY
BY AIR_KEY NOPRINT 
WHERE TKT_NUM CONTAINS '7688110772' OR '7688110780' OR '7688110782'
ON TABLE HOLD AS DEBHOLD2
END
-RUN


MATCH FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  
BY AIR_KEY NOPRINT
ON TABLE HOLD
RUN
FILE DEBHOLD2
PRINT AIR_KEY
BY AIR_KEY NOPRINT
AFTER MATCH HOLD AS SEGFIX OLD-NOT-NEW
END
-RUN

TABLE FILE SEGFIX
PRINT *
END
-RUN
-QUIT




JOIN AIR_KEY IN DYNYL TO AIR_KEY IN AYNYL AS J1
TABLE FILE DYNYL
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR PRINT
WHERE TKT_NUM CONTAINS '7688110772' OR '7688110780' OR '7688110782'
ON TABLE HOLD AS DSTFIX
END
-RUN

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN MYNYL TO AIR_KEY IN AYNYL AS J1
TABLE FILE MYNYL
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR PRINT
WHERE TKT_NUM CONTAINS '7688110772' OR '7688110780' OR '7688110782'
ON TABLE HOLD AS MKTFIX
END
-RUN

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN TYNYL TO AIR_KEY IN AYNYL AS J1
TABLE FILE TYNYL
PRINT AIR_KEY
BY AIR_KEY NOPRINT
WHERE TKT_NUM CONTAINS '7688110772' OR '7688110780' OR '7688110782'
ON TABLE HOLD AS TKTFIX
END
-RUN

JOIN CLEAR *
-RUN

TABLE FILE AYNYL
PRINT AIR_KEY
BY AIR_KEY NOPRINT
WHERE TKT_NUM CONTAINS '7688110772' OR '7688110780' OR '7688110782'
ON TABLE HOLD AS AIRFIX
END
-RUN

MODIFY FILE SYNYL
LOG NOMATCH MSG OFF
FIXFORM FROM SEGFIX
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON SEGFIX
END
-RUN

MODIFY FILE DYNYL
LOG NOMATCH MSG OFF
FIXFORM FROM DSTFIX
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON DSTFIX
END
-RUN

MODIFY FILE MYNYL
LOG NOMATCH MSG OFF
FIXFORM FROM MKTFIX
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON MKTFIX
END
-RUN

MODIFY FILE TYNYL
LOG NOMATCH MSG OFF
FIXFORM FROM TKTFIX
MATCH AIR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON TKTFIX
END
-RUN

MODIFY FILE AYNYL
LOG NOMATCH MSG OFF
FIXFORM FROM AIRFIX
MATCH AIR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON AIRFIX
END
-RUN

