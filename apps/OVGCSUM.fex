-* Story ID S-10086 Added &&overdrill flag logic for use in 5.0 to choose to for the report to be drillable or non-drillable - 9/15/15 - JM
-* 02/24/17 DLV S-22486 - updated position of header and footer NEW_HDR NEW_FTR
-* 05/18/17 JEM S-34624 - Updating heading/stylesheet to standardize
-*10/25/2017 RSB S-38044 Place the footer date/time stamp text in a separate file to be -INCLUDED in the stylesheets
-*
-INCLUDE SETECHO
-*
-* FRT_DateTimePosit sets the position of the Post-trip date/time stamp text within the footer image.
-* The default line number (&FTR_DateTimeLine) in the FOOTING for the date/time stamp text is: 4.
-INCLUDE FTR_DateTimePosit
-* 
-INCLUDE DTRANGE
-RUN




-SET &&HEADING = 'GLOBAL EXECUTIVE OVERVIEW'; 
-* CURRENT DATES
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');
-SET &&SP='|';
-SET &&SP3 = IF &&ROLLCNCT EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP4 = IF &&ROLLPHN EQ ' ' THEN ' ' ELSE &&SP;
-SET &&RCNCT = &&ROLLCNCT.LENGTH;
-SET &&CSL = &&ROLLCS.LENGTH;
-SET &&REL = &&ROLLEMAIL.LENGTH;

-SET &&RCSL = &&RCNCT.EVAL + &&CSL.EVAL;

-SET &&CSLPA = IF '&&ROLLUP.EVAL' EQ 'ABCD-R' THEN 70 ELSE 
-              IF '&&ROLLEMAIL.EVAL' NE ' ' AND &&REL GT 20 THEN 63 ELSE
-              IF &&RCSL LE 21 THEN 75 ELSE 
-              IF &&RCSL LE 31 THEN 68 ELSE 63;


-* -SET &&CSLPA = IF &&RCNCT.EVAL GE 15 OR &&CSL.EVAL GE 10 THEN 68 ELSE 75;
-*-SET &&CSLP = IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' THEN 88 ELSE &&CSLPA;

-SET &&CSLP = IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' AND &&ORIENTATION LIKE 'L%' THEN 88 
- ELSE IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' AND &&ORIENTATION LIKE 'P%' THEN 68 
- ELSE IF '&&ROLLUP.EVAL' EQ 'HDRR-R' AND &&ORIENTATION LIKE 'L%' THEN 75
- ELSE IF &&ORIENTATION LIKE 'P%' THEN &&CSLPA-15 ELSE &&CSLPA;

-SET &&ROLLEMPH = IF '&&ROLLEMAIL.EVAL' GT ' ' THEN &&ROLLEMAIL ELSE &&ROLLPHN;


-IF &&OUTLINE1 CONTAINS 'ONLINE-FMT' OR 'PCHOLD' GOTO ONFMT;
-IF &&OUTFMT EQ 'PDF' THEN GOTO CFMT ELSE GOTO OFMT;
-RUN

-CFMT
-SET &&OUTLINE1 = 'ON TABLE SAVE AS SAVREP';
-SET &&OUTLINE2 = 'FORMAT PDF OPEN';
-SET &&RPTSUF = ' ';
-INCLUDE FDEFRPTS
-RUN
-GOTO NEXTPART

-OFMT
-SET &&RPTSUF = 'OVERVIEW';
-INCLUDE FDEFRPTS
-RUN
-GOTO NEXTPART

-ONFMT
-IF &&OUTFMT NE 'PDF' GOTO ONFMT1;
-SET &&OUTLINE1 = 'ON TABLE PCHOLD';
-SET &&OUTLINE2 = 'FORMAT PDF OPEN';
-SET &&RPTSUF = '';
-RUN
-GOTO NEXTPART

-ONFMT1
-SET &&RPTSUF = '';
-RUN
-GOTO NEXTPART

-NEXTPART
-SET &&TNTPIC='OneCompanyGlobally.gif';


DEFINE FILE OV1_GC
-* ORGDSTNW/A6 = EDIT(ROW_LABEL, '999$$$$999');  
ORGDSTNW/A6 = EDIT(ROW_LABEL, '999$999$$$');  
KEY/A1 = IF OV1_GC.CAT_ORDER EQ 1 THEN 'A' ELSE
         IF OV1_GC.CAT_ORDER EQ 2 THEN 'B' ELSE
         IF OV1_GC.CAT_ORDER EQ 3 THEN 'C' ELSE
         IF OV1_GC.CAT_ORDER EQ 4 THEN 'D' ELSE
         IF OV1_GC.CAT_ORDER EQ 5 THEN 'E' ELSE
         IF OV1_GC.CAT_ORDER EQ 6 THEN 'F' ELSE ' ';

ALABEL/A12='Volume     ';
ALABEL1/A12='Tickets     ';
ALABEL2/A12='Markets     ';
BLABEL/A12='Savings     ';
BLABEL1/A12='Average    ';
CLABEL/A12='Days        ';
HLABEL/A12='Nights      ';

FLABEL/A12= IF KEY EQ 'A' THEN ALABEL ELSE
            IF KEY EQ 'B' THEN BLABEL1 ELSE
            IF KEY EQ 'C' THEN ALABEL ELSE
            IF KEY EQ 'D' THEN ALABEL ELSE 
            IF KEY EQ 'E' THEN ALABEL ELSE 
            IF KEY EQ 'F' THEN ALABEL ELSE ' ';

FLABEL1/A12= IF KEY EQ 'A' THEN ALABEL1 ELSE
             IF KEY EQ 'B' THEN ALABEL1 ELSE 
             IF KEY EQ 'C' THEN ALABEL2 ELSE 
             IF KEY EQ 'D' THEN ALABEL2 ELSE
             IF KEY EQ 'E' THEN CLABEL ELSE 
             IF KEY EQ 'F' THEN HLABEL ELSE ' ';

TEST/A1='';
-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*7/31/00    IBISTL-KR          ADDED DEFINE FOR NOWTOD
-*************************************************************************
NOWTOD/A8 WITH CAT_ORDER = HHMMSS (NOWTOD);
P1/A10='Period 1:';
P2/A33='Period 2:';
END
-RUN

TABLE FILE OV1_GC
PRINT OV1_GC.ROW_LABEL AS ''
      OV1_GC.VOL_CURR  AS '' IN 16
      OV1_GC.TKT_CURR  AS '' IN 26
      OV1_GC.VOL_PRIOR AS '' IN 32
      OV1_GC.TKT_PRIOR AS '' IN 42
BY OV1_GC.CAT_ORDER NOPRINT
BY OV1_GC.ROW_ORDER NOPRINT
BY KEY NOPRINT
BY ORGDSTNW NOPRINT
ON OV1_GC.CAT_ORDER SUBHEAD
" "
"<ST.OV1_GC.CATEGORY"
" "
"<16<FLABEL <24<FLABEL1 <32<FLABEL <40<FLABEL1"
" "
ON TABLE NOTOTAL
ON TABLE SET PAGE-NUM OFF
&&OUTLINE1
&&OUTLINE2
HEADING
-IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' GOTO ALTHD;
-* "</2"
"<37 &&HEADING <75 &&DTDESC"
"<32 &&LVL_DSC <75 <P1 &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
"<75 <P2 &FXMM/&FXMD/&FXMY - &TXOM/&TXOD/&TXOY"
"<&&CSLP &&ROLLNME <+0> &&SP <+0> &&ROLLCS <+0> &&SP3 <+0> &&ROLLCNCT <+0> &&SP4 <+0> &&ROLLEMPH"
" "
" <19 --Period1-- <35 --Period2-- "
-GOTO RPT;
-ALTHD;
-INCLUDE HDREXLSDD
"Period1 <+0> Period2"
-RPT;
-*
-INCLUDE FOOTERSM
-*
-* "&&FOOTER"
-* "<65 &&FOOTR"
-* "A REPORT FROM eTTek Review RUN ON &DATE AT <NOWTOD
ON TABLE SET STYLE *

-IF &&SETF EQ 'OVABCDND' THEN GOTO SKIP;

-IF &&OVERDRILL EQ 'Y' GOTO OVERDRILL;

-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*10/4/00    IBISTL-SB          ADDED DRILL DOWN
-*************************************************************************
-* CURRENT ROW 6**************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N6, WHEN=KEY EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR' PARM1='CY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N6, WHEN=KEY EQ 'B', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR' PARM1='CY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR ROW 8**************************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N8, WHEN=KEY EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR' PARM1='PY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N8, WHEN=KEY EQ 'B', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCAIR' PARM1='PY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT MARKETS ROW 6************************************************
TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N6, WHEN=KEY EQ 'C', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCORG' ORGDSTNW=N4 FLAGPARM='CY' VALUERANK=N1  \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR MARKETS ROW 8 

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N8, WHEN=KEY EQ 'C', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCORG' ORGDSTNW=N4 FLAGPARM='PY' VALUERANK=N1  \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT CARRIERS ROW 6

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N6, WHEN=KEY EQ 'D', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCR' ROW_LABEL=N5 FLAGPARM='CY' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR CARRIERS ROW 8

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N8, WHEN=KEY EQ 'D', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCR' ROW_LABEL=N5 FLAGPARM='PY' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT CAR ROW 6

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N6, WHEN=KEY EQ 'E', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCAR' ROW_LABEL=N5 FLAGPARM='CY' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR CAR ROW 8 

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N8, WHEN=KEY EQ 'E', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCCAR' ROW_LABEL=N5 FLAGPARM='PY' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT HOTEL ROW 6

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N6, WHEN=KEY EQ 'F', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCHTL' ROW_LABEL=N5 FLAGPARM='CY' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR HOTEL ROW 8 

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), COLUMN=N8, WHEN=KEY EQ 'F', \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRGCHTL' ROW_LABEL=N5 FLAGPARM='PY' VALUERANK=N1 \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-OVERDRILL;

-IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' THEN GOTO XLSTY;

-GOTO SKIP

-******************DRILL DOWN END************************************
-SKIP

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.050000, RIGHTMARGIN=0.050000,
    TOPMARGIN=0.250000, BOTTOMMARGIN=0.150000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $

TYPE=REPORT, FOCEXEC=NONE, FONT=TIMES NEW ROMAN, SIZE=8, COLOR=BLACK,
    BACKCOLOR=NONE, STYLE=NORMAL, $

TYPE=HEADING,
     FONT='ARIAL',
     JUSTIFY=LEFT,
     SIZE=8,
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$    

TYPE=HEADING,
     LINE=1,
     ITEM=1,
     FONT='ARIAL',
     JUSTIFY=LEFT,
     SIZE=9,
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$

TYPE=HEADING,
     LINE=2,
     ITEM=1,
     FONT='ARIAL',
     JUSTIFY=LEFT,
     SIZE=9,
     STYLE=BOLD,
     COLOR=RGB(70 136 177),
$

TYPE=SUBHEAD, BY=1, LINE=2, OBJECT=FIELD, ITEM=1, FONT=ARIAL, SIZE=10,
    STYLE=BOLD+UNDERLINE, $
TYPE=SUBHEAD, BY=1, LINE=4, OBJECT=FIELD, FONT=ARIAL, SIZE=7,
    STYLE=BOLD+UNDERLINE, $
TYPE=SUBHEAD, BY=1, LINE=7, OBJECT=FIELD, FONT=ARIAL, SIZE=7,
    STYLE=BOLD, $
TYPE=FOOTING, SIZE=7, FONT=ARIAL, STYLE=BOLD, COLOR=RGB(70 136 177), $ 

-*******************
TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0.2), SIZE=(4.5 .375),PRESERVERATIO=ON, $    
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.0), SIZE=(10.5 .58), PRESERVERATIO=ON, $       
-*
TYPE=FOOTING, LINE=&FTR_DateTimeLine, STYLE=BOLD,POSITION=(&FTR_DatePosit),$ 
-*
-IF &&M_GIF EQ 'N' GOTO SKIP_MAR;
TYPE=REPORT,
IMAGE=MARKET.SVG,
      POSITION=(5.3 1.2), SIZE=(5.0 2.5), $
-SKIP_MAR
-IF &&C_GIF EQ 'N' GOTO SKIP_CARR;
TYPE=REPORT,
IMAGE=CARRIER.SVG,
      POSITION=(5.3 3.3), SIZE=(5.0 2.5), $
-SKIP_CARR
-IF &&CAR_GIF EQ 'N' GOTO SKIP_CAR;
TYPE=REPORT,
IMAGE=CAR.SVG,
-*       POSITION=(3.9 5.5), SIZE=(4.5 2.4), $
      POSITION=(3.6 5.5), SIZE=(4.5 2.4), $

-SKIP_CAR
-IF &&H_GIF EQ 'N' GOTO SKIP_HOT;
TYPE=REPORT,
IMAGE=HOTEL.SVG,
-*        POSITION=(6.9 5.5), SIZE=(4.5 2.4), $  
        POSITION=(6.8 5.5), SIZE=(4.7 2.4), $  

-SKIP_HOT
ENDSTYLE
END
-RUN

-GOTO nx;

-XLSTY;

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000, 
    TOPMARGIN=0.300000, BOTTOMMARGIN=0.050000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
    
TYPE=REPORT, FONT=ARIAL, SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=HEADING, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(31 114 164), BACKCOLOR=NONE, $
TYPE=HEADING, HEADALIGN=BODY, $
TYPE=HEADING, LINE=1, COLSPAN=3, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=2, COLSPAN=3, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=3, COLSPAN=9, SIZE=9, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=4, COLSPAN=9, SIZE=9,JUSTIFY=CENTER, $
TYPE=HEADING, LINE=5, ITEM=1, COLSPAN=3, JUSTIFY=LEFT, $


TYPE=DATA,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8, 
     BACKCOLOR=(RGB(242 242 242) 'WHITE' ),$
-JOY
TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8,
     COLOR='WHITE',
     BACKCOLOR=RGB(31 114 164),
     STYLE=BOLD,$
     
TYPE=TITLE, JUSTIFY=LEFT, $     
    
TYPE=TABFOOTING, FONT=ARIAL, COLOR=GRAY,$
     
TYPE=FOOTING, FONT=ARIAL, COLOR=GRAY,$

TYPE=SUBHEAD,
     STYLE=BOLD,
$

TYPE=SUBTOTAL, 
     STYLE=BOLD, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER', $
     
TYPE=GRANDTOTAL, STYLE=BOLD, $
ENDSTYLE
END
-RUN

-nx;
-IF &&OUTFMT EQ 'EXCEL' GOTO XXIT1;
EX OVERCOV
-RUN

-XXIT1


-*-EXIT

