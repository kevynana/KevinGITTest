-* File CREATEASM.FEX
-***************************************************************************
-* This program will create the T_XXXX databases for all Non Quartered
-* clients.
-* DATE           NAME
-* 06/05/02       Steve Cords - Initial Creation
-***************************************************************************
-AIR
-SET &&DATPATH = 'K:\TNT\TTRACKER\DATA\';
-SET &&ROLLTARG = '      ';

-UPDLOOP
-TYPE "AIR"

-* This is the trigger file containing the target rollups for update
-*   action - each rollup shall be identified by a single entry
-*   consisting of the company id - e.g. METX or
-*   BAIR - the last record in this trigger file must be END
FILEDEF ROLLLIST DISK K:\TNT\TTRACKER\TEMP\ROLLLIST.TXT (LRECL 80
-RUN
FILEDEF ROLLNEW DISK K:\TNT\TTRACKER\TEMP\ROLLNEW.TXT (LRECL 80
-RUN

-READ ROLLLIST &&ROLLTARG
-IF &&ROLLTARG EQ 'END' THEN GOTO XFER;
-TYPE ROLLTARG &&ROLLTARG

-REPEAT BNEW WHILE &IORETURN EQ 0;
-READ ROLLLIST &&SLINE.80
-IF &IORETURN NE 0 THEN GOTO BNEW;
-WRITE ROLLNEW &&SLINE
-BNEW

FILEDEF ROLLLIST CLEAR
-RUN
FILEDEF ROLLNEW CLEAR
-RUN

COPY K:\TNT\TTRACKER\TEMP\ROLLNEW.TXT K:\TNT\TTRACKER\TEMP\ROLLLIST.TXT
-RUN

-TYPE ROLLTARG &&ROLLTARG

-SET &&COMPNY = SUBSTR(6, &&ROLLTARG, 1, 6, 6, 'A6');

-TYPE COMPANY &&COMPNY

-SET &&ROLLASM = 'T_' || &&COMPNY || '.FOC';
-SET &&TCOMP = 'T_' || &&COMPNY;
-SET &&ASMPATH = &&DATPATH || &&TCOMP || '.MAS';

COPY K:\TNT\TTRACKER\DATA\T_SYSTEM.MAS &&ASMPATH
-RUN

CREATE FILE &&TCOMP
END
-RUN
-***************************************************************************
-SET &&SMD = 'S';

EX AIRXUSEX
END
-RUN

-* AIRPORT CODES

-* FIELD 1 = ADIR_ALL

DEFINE FILE SR_50
MADIRX/A13 = '-'||EMBARK||ROUTE||'/'||AIRLINE|'*'||CL_CAT;
END
-RUN

TABLE FILE SR_50
PRINT AIR_KEY SEG_NBR MADIRX
BY AIR_KEY NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END
-RUN

CREATE FILE TTEMP
END
-RUN

SET ASNAMES=ON

-* SEGMENT 1

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX1'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '01'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX1
DATA ON HOLD1
END
-RUN

-* SEGMENT 2

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX2'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '02'
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX2
DATA ON HOLD2
END
-RUN

-* SEGMENT 3

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX3'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '03'
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD3
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX3
DATA ON HOLD3
END
-RUN

-* SEGMENT 4

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX4'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '04'
ON TABLE HOLD AS HOLD4
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD4
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX4
DATA ON HOLD4
END
-RUN

-* SEGMENT 5

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX5'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '05'
ON TABLE HOLD AS HOLD5
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD5
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX5
DATA ON HOLD5
END
-RUN

-* SEGMENT 6

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX6'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '06'
ON TABLE HOLD AS HOLD6
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD6
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX6
DATA ON HOLD6
END
-RUN

-* SEGMENT 7

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX7'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '07'
ON TABLE HOLD AS HOLD7
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD7
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX7
DATA ON HOLD7
END
-RUN

-* SEGMENT 8

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX8'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '08'
ON TABLE HOLD AS HOLD8
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD8
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX8
DATA ON HOLD8
END
-RUN

-* SEGMENT 9

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX9'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '09'
ON TABLE HOLD AS HOLD9
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD9
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX9
DATA ON HOLD9
END
-RUN

-* SEGMENT 10

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX10'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '10'
ON TABLE HOLD AS HOLD10
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD10
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX10
DATA ON HOLD10
END
-RUN

-* SEGMENT 11

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX11'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '11'
ON TABLE HOLD AS HOLD11
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD11
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX11
DATA ON HOLD11
END
-RUN

-* SEGMENT 12

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX12'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '12'
ON TABLE HOLD AS HOLD12
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD12
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX12
DATA ON HOLD12
END
-RUN

-* SEGMENT 13

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX13'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '13'
ON TABLE HOLD AS HOLD13
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD13
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX13
DATA ON HOLD13
END
-RUN

-* SEGMENT 14

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX14'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '14'
ON TABLE HOLD AS HOLD14
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD14
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX14
DATA ON HOLD14
END
-RUN

-* SEGMENT 15

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX15'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '15'
ON TABLE HOLD AS HOLD15
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD15
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX15
DATA ON HOLD15
END
-RUN

-* SEGMENT 16

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX16'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '16'
ON TABLE HOLD AS HOLD16
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD16
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX16
DATA ON HOLD16
END
-RUN

TABLE FILE TTEMP
PRINT AIR_KEY AND COMPUTE
MADIRX/A208 = MADIRX1||MADIRX2||MADIRX3||MADIRX4||MADIRX5||MADIRX6||
MADIRX7||MADIRX8||MADIRX9||MADIRX10||MADIRX11||MADIRX12||MADIRX13||
MADIRX14||MADIRX15||MADIRX16;
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP1
END
-RUN

TABLE FILE TTEMP1
PRINT AIR_KEY MADIRX
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP2
END
-RUN

CREATE FILE &&TCOMP
END
-RUN

MODIFY FILE &&TCOMP
FIXFORM FROM TTEMP2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX
DATA ON TTEMP2
END
-RUN

-* FIELD 2 = ANON_ALL

DEFINE FILE SR_50
TEMBARK/A3 = IF EMBARK LT ROUTE THEN EMBARK ELSE ROUTE;
TROUTE/A3 = IF EMBARK GT ROUTE THEN EMBARK ELSE ROUTE;
MADIRX/A13 = '-'||TEMBARK||TROUTE||'/'||AIRLINE|'*'||CL_CAT;
END
-RUN

TABLE FILE SR_50
PRINT AIR_KEY SEG_NBR MADIRX
BY AIR_KEY NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END
-RUN

CREATE FILE TTEMP
END
-RUN

SET ASNAMES=ON

-* SEGMENT 1

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX1'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '01'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX1
DATA ON HOLD1
END
-RUN

-* SEGMENT 2

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX2'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '02'
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX2
DATA ON HOLD2
END
-RUN


-* SEGMENT 3

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX3'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '03'
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD3
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX3
DATA ON HOLD3
END
-RUN

-* SEGMENT 4

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX4'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '04'
ON TABLE HOLD AS HOLD4
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD4
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX4
DATA ON HOLD4
END
-RUN

-* SEGMENT 5

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX5'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '05'
ON TABLE HOLD AS HOLD5
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD5
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX5
DATA ON HOLD5
END
-RUN

-* SEGMENT 6

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX6'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '06'
ON TABLE HOLD AS HOLD6
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD6
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX6
DATA ON HOLD6
END
-RUN

-* SEGMENT 7

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX7'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '07'
ON TABLE HOLD AS HOLD7
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD7
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX7
DATA ON HOLD7
END
-RUN

-* SEGMENT 8

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX8'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '08'
ON TABLE HOLD AS HOLD8
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD8
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX8
DATA ON HOLD8
END
-RUN

-* SEGMENT 9

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX9'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '09'
ON TABLE HOLD AS HOLD9
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD9
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX9
DATA ON HOLD9
END
-RUN

-* SEGMENT 10

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX10'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '10'
ON TABLE HOLD AS HOLD10
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD10
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX10
DATA ON HOLD10
END
-RUN

-* SEGMENT 11

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX11'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '11'
ON TABLE HOLD AS HOLD11
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD11
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX11
DATA ON HOLD11
END
-RUN

-* SEGMENT 12

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX12'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '12'
ON TABLE HOLD AS HOLD12
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD12
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX12
DATA ON HOLD12
END
-RUN

-* SEGMENT 13

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX13'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '13'
ON TABLE HOLD AS HOLD13
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD13
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX13
DATA ON HOLD13
END
-RUN

-* SEGMENT 14

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX14'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '14'
ON TABLE HOLD AS HOLD14
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD14
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX14
DATA ON HOLD14
END
-RUN

-* SEGMENT 15

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX15'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '15'
ON TABLE HOLD AS HOLD15
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD15
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX15
DATA ON HOLD15
END
-RUN

-* SEGMENT 16

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX16'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '16'
ON TABLE HOLD AS HOLD16
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD16
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX16
DATA ON HOLD16
END
-RUN

TABLE FILE TTEMP
PRINT AIR_KEY AND COMPUTE
MADIRX/A208 = MADIRX1||MADIRX2||MADIRX3||MADIRX4||MADIRX5||MADIRX6||
MADIRX7||MADIRX8||MADIRX9||MADIRX10||MADIRX11||MADIRX12||MADIRX13||
MADIRX14||MADIRX15||MADIRX16;
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP1
END
-RUN

TABLE FILE TTEMP1
PRINT AIR_KEY MADIRX AS 'MANONX'
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP2
END
-RUN

MODIFY FILE &&TCOMP
FIXFORM FROM TTEMP2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MANONX
DATA ON TTEMP2
END
-RUN

-* FIELD 3 - ADIR_STP

-SET &&SMD = 'M';

EX AIRXUSEX
END
-RUN

DEFINE FILE MR_50
MADIRX/A13 = '-'||EMBARK||ROUTE||'/'||AIRLINE;
END
-RUN

TABLE FILE MR_50
PRINT AIR_KEY SEG_NBR MADIRX
BY AIR_KEY NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END
-RUN

CREATE FILE TTEMP
END
-RUN

SET ASNAMES=ON

-* SEGMENT 1

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX1'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '01'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX1
DATA ON HOLD1
END
-RUN

-* SEGMENT 2

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX2'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '02'
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX2
DATA ON HOLD2
END
-RUN


-* SEGMENT 3

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX3'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '03'
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD3
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX3
DATA ON HOLD3
END
-RUN

-* SEGMENT 4

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX4'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '04'
ON TABLE HOLD AS HOLD4
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD4
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX4
DATA ON HOLD4
END
-RUN

-* SEGMENT 5

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX5'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '05'
ON TABLE HOLD AS HOLD5
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD5
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX5
DATA ON HOLD5
END
-RUN

-* SEGMENT 6

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX6'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '06'
ON TABLE HOLD AS HOLD6
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD6
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX6
DATA ON HOLD6
END
-RUN

-* SEGMENT 7

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX7'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '07'
ON TABLE HOLD AS HOLD7
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD7
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX7
DATA ON HOLD7
END
-RUN

-* SEGMENT 8

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX8'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '08'
ON TABLE HOLD AS HOLD8
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD8
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX8
DATA ON HOLD8
END
-RUN

-* SEGMENT 9

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX9'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '09'
ON TABLE HOLD AS HOLD9
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD9
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX9
DATA ON HOLD9
END
-RUN

-* SEGMENT 10

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX10'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '10'
ON TABLE HOLD AS HOLD10
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD10
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX10
DATA ON HOLD10
END
-RUN

-* SEGMENT 11

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX11'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '11'
ON TABLE HOLD AS HOLD11
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD11
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX11
DATA ON HOLD11
END
-RUN

-* SEGMENT 12

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX12'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '12'
ON TABLE HOLD AS HOLD12
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD12
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX12
DATA ON HOLD12
END
-RUN

-* SEGMENT 13

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX13'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '13'
ON TABLE HOLD AS HOLD13
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD13
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX13
DATA ON HOLD13
END
-RUN

-* SEGMENT 14

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX14'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '14'
ON TABLE HOLD AS HOLD14
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD14
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX14
DATA ON HOLD14
END
-RUN

-* SEGMENT 15

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX15'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '15'
ON TABLE HOLD AS HOLD15
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD15
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX15
DATA ON HOLD15
END
-RUN

-* SEGMENT 16

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX16'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '16'
ON TABLE HOLD AS HOLD16
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD16
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX16
DATA ON HOLD16
END
-RUN

TABLE FILE TTEMP
PRINT AIR_KEY AND COMPUTE
MADIRX/A208 = MADIRX1||MADIRX2||MADIRX3||MADIRX4||MADIRX5||MADIRX6||
MADIRX7||MADIRX8||MADIRX9||MADIRX10||MADIRX11||MADIRX12||MADIRX13||
MADIRX14||MADIRX15||MADIRX16;
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP1
END
-RUN

TABLE FILE TTEMP1
PRINT AIR_KEY MADIRX AS 'MADIRO'
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP2
END
-RUN

MODIFY FILE &&TCOMP
FIXFORM FROM TTEMP2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRO
DATA ON TTEMP2
END
-RUN

-* FIELD 4 = ANON_STP

DEFINE FILE MR_50
TEMBARK/A3 = IF EMBARK LT ROUTE THEN EMBARK ELSE ROUTE;
TROUTE/A3 = IF EMBARK GT ROUTE THEN EMBARK ELSE ROUTE;
MADIRX/A13 = '-'||TEMBARK||TROUTE||'/'||AIRLINE;
END
-RUN

TABLE FILE MR_50
PRINT AIR_KEY SEG_NBR MADIRX
BY AIR_KEY NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END
-RUN

CREATE FILE TTEMP
END
-RUN

SET ASNAMES=ON

-* SEGMENT 1

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX1'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '01'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX1
DATA ON HOLD1
END
-RUN

-* SEGMENT 2

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX2'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '02'
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX2
DATA ON HOLD2
END
-RUN


-* SEGMENT 3

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX3'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '03'
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD3
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX3
DATA ON HOLD3
END
-RUN

-* SEGMENT 4

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX4'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '04'
ON TABLE HOLD AS HOLD4
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD4
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX4
DATA ON HOLD4
END
-RUN

-* SEGMENT 5

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX5'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '05'
ON TABLE HOLD AS HOLD5
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD5
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX5
DATA ON HOLD5
END
-RUN

-* SEGMENT 6

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX6'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '06'
ON TABLE HOLD AS HOLD6
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD6
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX6
DATA ON HOLD6
END
-RUN

-* SEGMENT 7

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX7'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '07'
ON TABLE HOLD AS HOLD7
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD7
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX7
DATA ON HOLD7
END
-RUN

-* SEGMENT 8

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX8'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '08'
ON TABLE HOLD AS HOLD8
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD8
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX8
DATA ON HOLD8
END
-RUN

-* SEGMENT 9

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX9'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '09'
ON TABLE HOLD AS HOLD9
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD9
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX9
DATA ON HOLD9
END
-RUN

-* SEGMENT 10

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX10'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '10'
ON TABLE HOLD AS HOLD10
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD10
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX10
DATA ON HOLD10
END
-RUN

-* SEGMENT 11

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX11'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '11'
ON TABLE HOLD AS HOLD11
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD11
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX11
DATA ON HOLD11
END
-RUN

-* SEGMENT 12

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX12'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '12'
ON TABLE HOLD AS HOLD12
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD12
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX12
DATA ON HOLD12
END
-RUN

-* SEGMENT 13

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX13'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '13'
ON TABLE HOLD AS HOLD13
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD13
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX13
DATA ON HOLD13
END
-RUN

-* SEGMENT 14

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX14'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '14'
ON TABLE HOLD AS HOLD14
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD14
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX14
DATA ON HOLD14
END
-RUN

-* SEGMENT 15

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX15'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '15'
ON TABLE HOLD AS HOLD15
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD15
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX15
DATA ON HOLD15
END
-RUN

-* SEGMENT 16

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX16'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '16'
ON TABLE HOLD AS HOLD16
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD16
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX16
DATA ON HOLD16
END
-RUN

TABLE FILE TTEMP
PRINT AIR_KEY AND COMPUTE
MADIRX/A208 = MADIRX1||MADIRX2||MADIRX3||MADIRX4||MADIRX5||MADIRX6||
MADIRX7||MADIRX8||MADIRX9||MADIRX10||MADIRX11||MADIRX12||MADIRX13||
MADIRX14||MADIRX15||MADIRX16;
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP1
END
-RUN

TABLE FILE TTEMP1
PRINT AIR_KEY MADIRX AS 'MANONO'
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP2
END
-RUN

MODIFY FILE &&TCOMP
FIXFORM FROM TTEMP2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MANONO
DATA ON TTEMP2
END
-RUN

-* CITY CODES
-CITY

-* FIELD 5 = CDIR_ALL

-SET &&SMD = 'S';

EX AIRXUSEX
END
-RUN

DEFINE FILE SR_50
MADIRX/A13 =
'-'||EMB_CTY.EMB_CITY||RTE_CTY.RTE_CITY||'/'||AIRLINE|'*'||CL_CAT;
END
-RUN

TABLE FILE SR_50
PRINT AIR_KEY SEG_NBR MADIRX
BY AIR_KEY NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END
-RUN

CREATE FILE TTEMP
END
-RUN

SET ASNAMES=ON

-* SEGMENT 1

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX1'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '01'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX1
DATA ON HOLD1
END
-RUN

-* SEGMENT 2

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX2'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '02'
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX2
DATA ON HOLD2
END
-RUN


-* SEGMENT 3

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX3'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '03'
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD3
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX3
DATA ON HOLD3
END
-RUN

-* SEGMENT 4

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX4'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '04'
ON TABLE HOLD AS HOLD4
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD4
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX4
DATA ON HOLD4
END
-RUN

-* SEGMENT 5

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX5'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '05'
ON TABLE HOLD AS HOLD5
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD5
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX5
DATA ON HOLD5
END
-RUN

-* SEGMENT 6

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX6'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '06'
ON TABLE HOLD AS HOLD6
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD6
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX6
DATA ON HOLD6
END
-RUN

-* SEGMENT 7

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX7'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '07'
ON TABLE HOLD AS HOLD7
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD7
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX7
DATA ON HOLD7
END
-RUN

-* SEGMENT 8

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX8'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '08'
ON TABLE HOLD AS HOLD8
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD8
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX8
DATA ON HOLD8
END
-RUN

-* SEGMENT 9

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX9'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '09'
ON TABLE HOLD AS HOLD9
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD9
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX9
DATA ON HOLD9
END
-RUN

-* SEGMENT 10

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX10'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '10'
ON TABLE HOLD AS HOLD10
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD10
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX10
DATA ON HOLD10
END
-RUN

-* SEGMENT 11

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX11'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '11'
ON TABLE HOLD AS HOLD11
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD11
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX11
DATA ON HOLD11
END
-RUN

-* SEGMENT 12

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX12'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '12'
ON TABLE HOLD AS HOLD12
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD12
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX12
DATA ON HOLD12
END
-RUN

-* SEGMENT 13

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX13'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '13'
ON TABLE HOLD AS HOLD13
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD13
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX13
DATA ON HOLD13
END
-RUN

-* SEGMENT 14

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX14'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '14'
ON TABLE HOLD AS HOLD14
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD14
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX14
DATA ON HOLD14
END
-RUN

-* SEGMENT 15

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX15'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '15'
ON TABLE HOLD AS HOLD15
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD15
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX15
DATA ON HOLD15
END
-RUN

-* SEGMENT 16

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX16'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '16'
ON TABLE HOLD AS HOLD16
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD16
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX16
DATA ON HOLD16
END
-RUN

TABLE FILE TTEMP
PRINT AIR_KEY AND COMPUTE
MADIRX/A208 = MADIRX1||MADIRX2||MADIRX3||MADIRX4||MADIRX5||MADIRX6||
MADIRX7||MADIRX8||MADIRX9||MADIRX10||MADIRX11||MADIRX12||MADIRX13||
MADIRX14||MADIRX15||MADIRX16;
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP1
END
-RUN

TABLE FILE TTEMP1
PRINT AIR_KEY MADIRX AS 'MCDIRX'
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP2
END
-RUN

MODIFY FILE &&TCOMP
FIXFORM FROM TTEMP2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MCDIRX
DATA ON TTEMP2
END
-RUN

-* FIELD 6 = CNON_ALL

DEFINE FILE SR_50
TEMBARK/A3 = IF EMB_CTY.EMB_CITY LT RTE_CTY.RTE_CITY
THEN EMB_CTY.EMB_CITY ELSE RTE_CTY.RTE_CITY;
TROUTE/A3 = IF EMB_CTY.EMB_CITY GT RTE_CTY.RTE_CITY
THEN EMB_CTY.EMB_CITY ELSE RTE_CTY.RTE_CITY;
MADIRX/A13 = '-'||TEMBARK||TROUTE||'/'||AIRLINE|'*'||CL_CAT;
END
-RUN

TABLE FILE SR_50
PRINT AIR_KEY SEG_NBR MADIRX
BY AIR_KEY NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END
-RUN

CREATE FILE TTEMP
END
-RUN

SET ASNAMES=ON

-* SEGMENT 1

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX1'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '01'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX1
DATA ON HOLD1
END
-RUN

-* SEGMENT 2

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX2'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '02'
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX2
DATA ON HOLD2
END
-RUN


-* SEGMENT 3

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX3'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '03'
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD3
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX3
DATA ON HOLD3
END
-RUN

-* SEGMENT 4

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX4'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '04'
ON TABLE HOLD AS HOLD4
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD4
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX4
DATA ON HOLD4
END
-RUN

-* SEGMENT 5

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX5'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '05'
ON TABLE HOLD AS HOLD5
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD5
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX5
DATA ON HOLD5
END
-RUN

-* SEGMENT 6

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX6'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '06'
ON TABLE HOLD AS HOLD6
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD6
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX6
DATA ON HOLD6
END
-RUN

-* SEGMENT 7

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX7'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '07'
ON TABLE HOLD AS HOLD7
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD7
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX7
DATA ON HOLD7
END
-RUN

-* SEGMENT 8

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX8'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '08'
ON TABLE HOLD AS HOLD8
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD8
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX8
DATA ON HOLD8
END
-RUN

-* SEGMENT 9

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX9'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '09'
ON TABLE HOLD AS HOLD9
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD9
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX9
DATA ON HOLD9
END
-RUN

-* SEGMENT 10

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX10'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '10'
ON TABLE HOLD AS HOLD10
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD10
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX10
DATA ON HOLD10
END
-RUN

-* SEGMENT 11

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX11'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '11'
ON TABLE HOLD AS HOLD11
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD11
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX11
DATA ON HOLD11
END
-RUN

-* SEGMENT 12

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX12'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '12'
ON TABLE HOLD AS HOLD12
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD12
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX12
DATA ON HOLD12
END
-RUN

-* SEGMENT 13

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX13'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '13'
ON TABLE HOLD AS HOLD13
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD13
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX13
DATA ON HOLD13
END
-RUN

-* SEGMENT 14

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX14'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '14'
ON TABLE HOLD AS HOLD14
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD14
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX14
DATA ON HOLD14
END
-RUN

-* SEGMENT 15

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX15'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '15'
ON TABLE HOLD AS HOLD15
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD15
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX15
DATA ON HOLD15
END
-RUN

-* SEGMENT 16

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX16'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '16'
ON TABLE HOLD AS HOLD16
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD16
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX16
DATA ON HOLD16
END
-RUN

TABLE FILE TTEMP
PRINT AIR_KEY AND COMPUTE
MADIRX/A208 = MADIRX1||MADIRX2||MADIRX3||MADIRX4||MADIRX5||MADIRX6||
MADIRX7||MADIRX8||MADIRX9||MADIRX10||MADIRX11||MADIRX12||MADIRX13||
MADIRX14||MADIRX15||MADIRX16;
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP1
END
-RUN

TABLE FILE TTEMP1
PRINT AIR_KEY MADIRX AS 'MCNONX'
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP2
END
-RUN

MODIFY FILE &&TCOMP
FIXFORM FROM TTEMP2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MCNONX
DATA ON TTEMP2
END
-RUN

-* FIELD 7 - CDIR_STP

-SET &&SMD = 'M';

EX AIRXUSEX
END
-RUN

DEFINE FILE MR_50
MADIRX/A13 = '-'||EMB_CTY.EMB_CITY||RTE_CTY.RTE_CITY||'/'||AIRLINE;
END
-RUN

TABLE FILE MR_50
PRINT AIR_KEY SEG_NBR MADIRX
BY AIR_KEY NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END
-RUN

CREATE FILE TTEMP
END
-RUN

SET ASNAMES=ON

-* SEGMENT 1

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX1'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '01'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX1
DATA ON HOLD1
END
-RUN

-* SEGMENT 2

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX2'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '02'
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX2
DATA ON HOLD2
END
-RUN


-* SEGMENT 3

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX3'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '03'
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD3
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX3
DATA ON HOLD3
END
-RUN

-* SEGMENT 4

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX4'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '04'
ON TABLE HOLD AS HOLD4
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD4
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX4
DATA ON HOLD4
END
-RUN

-* SEGMENT 5

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX5'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '05'
ON TABLE HOLD AS HOLD5
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD5
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX5
DATA ON HOLD5
END
-RUN

-* SEGMENT 6

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX6'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '06'
ON TABLE HOLD AS HOLD6
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD6
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX6
DATA ON HOLD6
END
-RUN

-* SEGMENT 7

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX7'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '07'
ON TABLE HOLD AS HOLD7
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD7
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX7
DATA ON HOLD7
END
-RUN

-* SEGMENT 8

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX8'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '08'
ON TABLE HOLD AS HOLD8
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD8
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX8
DATA ON HOLD8
END
-RUN

-* SEGMENT 9

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX9'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '09'
ON TABLE HOLD AS HOLD9
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD9
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX9
DATA ON HOLD9
END
-RUN

-* SEGMENT 10

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX10'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '10'
ON TABLE HOLD AS HOLD10
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD10
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX10
DATA ON HOLD10
END
-RUN

-* SEGMENT 11

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX11'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '11'
ON TABLE HOLD AS HOLD11
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD11
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX11
DATA ON HOLD11
END
-RUN

-* SEGMENT 12

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX12'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '12'
ON TABLE HOLD AS HOLD12
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD12
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX12
DATA ON HOLD12
END
-RUN

-* SEGMENT 13

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX13'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '13'
ON TABLE HOLD AS HOLD13
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD13
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX13
DATA ON HOLD13
END
-RUN

-* SEGMENT 14

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX14'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '14'
ON TABLE HOLD AS HOLD14
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD14
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX14
DATA ON HOLD14
END
-RUN

-* SEGMENT 15

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX15'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '15'
ON TABLE HOLD AS HOLD15
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD15
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX15
DATA ON HOLD15
END
-RUN

-* SEGMENT 16

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX16'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '16'
ON TABLE HOLD AS HOLD16
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD16
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX16
DATA ON HOLD16
END
-RUN

TABLE FILE TTEMP
PRINT AIR_KEY AND COMPUTE
MADIRX/A208 = MADIRX1||MADIRX2||MADIRX3||MADIRX4||MADIRX5||MADIRX6||
MADIRX7||MADIRX8||MADIRX9||MADIRX10||MADIRX11||MADIRX12||MADIRX13||
MADIRX14||MADIRX15||MADIRX16;
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP1
END
-RUN

TABLE FILE TTEMP1
PRINT AIR_KEY MADIRX AS 'MCDIRO'
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP2
END
-RUN

MODIFY FILE &&TCOMP
FIXFORM FROM TTEMP2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MCDIRO
DATA ON TTEMP2
END
-RUN

-* FIELD 8 = CNON_STP

DEFINE FILE MR_50
TEMBARK/A3 = IF EMB_CTY.EMB_CITY LT RTE_CTY.RTE_CITY
THEN EMB_CTY.EMB_CITY ELSE RTE_CTY.RTE_CITY;
TROUTE/A3 = IF EMB_CTY.EMB_CITY GT RTE_CTY.RTE_CITY
THEN EMB_CTY.EMB_CITY ELSE RTE_CTY.RTE_CITY;
MADIRX/A13 = '-'||TEMBARK||TROUTE||'/'||AIRLINE;
END
-RUN

TABLE FILE MR_50
PRINT AIR_KEY SEG_NBR MADIRX
BY AIR_KEY NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END
-RUN

CREATE FILE TTEMP
END
-RUN

SET ASNAMES=ON

-* SEGMENT 1

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX1'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '01'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX1
DATA ON HOLD1
END
-RUN

-* SEGMENT 2

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX2'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '02'
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX2
DATA ON HOLD2
END
-RUN


-* SEGMENT 3

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX3'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '03'
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD3
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX3
DATA ON HOLD3
END
-RUN

-* SEGMENT 4

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX4'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '04'
ON TABLE HOLD AS HOLD4
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD4
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX4
DATA ON HOLD4
END
-RUN

-* SEGMENT 5

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX5'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '05'
ON TABLE HOLD AS HOLD5
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD5
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX5
DATA ON HOLD5
END
-RUN

-* SEGMENT 6

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX6'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '06'
ON TABLE HOLD AS HOLD6
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD6
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX6
DATA ON HOLD6
END
-RUN

-* SEGMENT 7

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX7'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '07'
ON TABLE HOLD AS HOLD7
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD7
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX7
DATA ON HOLD7
END
-RUN

-* SEGMENT 8

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX8'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '08'
ON TABLE HOLD AS HOLD8
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD8
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX8
DATA ON HOLD8
END
-RUN

-* SEGMENT 9

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX9'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '09'
ON TABLE HOLD AS HOLD9
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD9
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX9
DATA ON HOLD9
END
-RUN

-* SEGMENT 10

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX10'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '10'
ON TABLE HOLD AS HOLD10
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD10
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX10
DATA ON HOLD10
END
-RUN

-* SEGMENT 11

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX11'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '11'
ON TABLE HOLD AS HOLD11
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD11
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX11
DATA ON HOLD11
END
-RUN

-* SEGMENT 12

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX12'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '12'
ON TABLE HOLD AS HOLD12
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD12
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX12
DATA ON HOLD12
END
-RUN

-* SEGMENT 13

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX13'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '13'
ON TABLE HOLD AS HOLD13
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD13
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX13
DATA ON HOLD13
END
-RUN

-* SEGMENT 14

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX14'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '14'
ON TABLE HOLD AS HOLD14
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD14
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX14
DATA ON HOLD14
END
-RUN

-* SEGMENT 15

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX15'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '15'
ON TABLE HOLD AS HOLD15
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD15
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX15
DATA ON HOLD15
END
-RUN

-* SEGMENT 16

TABLE FILE HOLD
PRINT AIR_KEY MADIRX AS 'MADIRX16'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '16'
ON TABLE HOLD AS HOLD16
END
-RUN

MODIFY FILE TTEMP
FIXFORM FROM HOLD16
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MADIRX16
DATA ON HOLD16
END
-RUN

TABLE FILE TTEMP
PRINT AIR_KEY AND COMPUTE
MADIRX/A208 = MADIRX1||MADIRX2||MADIRX3||MADIRX4||MADIRX5||MADIRX6||
MADIRX7||MADIRX8||MADIRX9||MADIRX10||MADIRX11||MADIRX12||MADIRX13||
MADIRX14||MADIRX15||MADIRX16;
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP1
END
-RUN

TABLE FILE TTEMP1
PRINT AIR_KEY MADIRX AS 'MCNONO'
BY AIR_KEY NOPRINT
ON TABLE HOLD AS TTEMP2
END
-RUN

MODIFY FILE &&TCOMP
FIXFORM FROM TTEMP2
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MCNONO
DATA ON TTEMP2
END
-RUN

-OVRLAY

SET ASNAMES=ON

DEFINE FILE &&TCOMP
MADIRXT/A208 = SUBSTR (208, MADIRX, 2, 208, 207, MADIRXT);
MANONXT/A208 = SUBSTR (208, MANONX, 2, 208, 207, MANONXT);
MADIROT/A176 = SUBSTR (176, MADIRO, 2, 176, 175, MADIROT);
MANONOT/A176 = SUBSTR (176, MANONO, 2, 176, 175, MANONOT);
MCDIRXT/A208 = SUBSTR (208, MCDIRX, 2, 208, 207, MCDIRXT);
MCNONXT/A208 = SUBSTR (208, MCNONX, 2, 208, 207, MCNONXT);
MCDIROT/A176 = SUBSTR (176, MCDIRO, 2, 176, 175, MCDIROT);
MCNONOT/A176 = SUBSTR (176, MCNONO, 2, 176, 175, MCNONOT);
END
-RUN

TABLE FILE &&TCOMP
PRINT AIR_KEY
MADIRXT AS 'MADIRX'
MANONXT AS 'MANONX'
MADIROT AS 'MADIRO'
MANONOT AS 'MANONO'
MCDIRXT AS 'MCDIRX'
MCNONXT AS 'MCNONX'
MCDIROT AS 'MCDIRO'
MCNONOT AS 'MCNONO'
ON TABLE HOLD
END
-RUN

MODIFY FILE &&TCOMP
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH UPDATE MADIRX MANONX MADIRO MANONO MCDIRX MCNONX MCDIRO MCNONO
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* GEO CODES
-* COUNTRY CODES

-* FIELD 9 = GEO_ZONE
-* FIELD 10 = COUNTRY CODE

-GEO

-SET &&SMD = 'S';

EX AIRXUSEX
END
-RUN

SET ASNAMES=ON

TABLE FILE SR_50
PRINT AIR_KEY SEG_NBR
EMB_APT.GEO_ZONE AS 'EGEOZONE'
RTE_APT.GEO_ZONE AS 'RGEOZONE'
AND COMPUTE ECNTCDE/A2 = EDIT (EMB_APT.COUNTRY_CODE, '99$');
RCNTCDE/A2 = EDIT (RTE_APT.COUNTRY_CODE, '99$');
ON TABLE HOLD
END
-RUN

CREATE FILE TTEMG
END
-RUN

-* SEGMENT 1

TABLE FILE HOLD
PRINT AIR_KEY
EGEOZONE AS 'GEOCNT1'
RGEOZONE AS 'GEOCNT2'
ECNTCDE AS 'CNTCNT1'
RCNTCDE AS 'CNTCNT2'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '01'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT1 GEOCNT2 CNTCNT1 CNTCNT2
DATA ON HOLD1
END
-RUN

-* SEGMENT 2

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT3'
RCNTCDE AS 'CNTCNT3'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '02'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT3 CNTCNT3
DATA ON HOLD1
END
-RUN

-* SEGMENT 3

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT4'
RCNTCDE AS 'CNTCNT4'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '03'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT4 CNTCNT4
DATA ON HOLD1
END
-RUN

-* SEGMENT 4

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT5'
RCNTCDE AS 'CNTCNT5'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '04'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT5 CNTCNT5
DATA ON HOLD1
END
-RUN

-* SEGMENT 5

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT6'
RCNTCDE AS 'CNTCNT6'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '05'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT6 CNTCNT6
DATA ON HOLD1
END
-RUN

-* SEGMENT 6

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT7'
RCNTCDE AS 'CNTCNT7'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '06'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT7 CNTCNT7
DATA ON HOLD1
END
-RUN

-* SEGMENT 7

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT8'
RCNTCDE AS 'CNTCNT8'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '07'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT8 CNTCNT8
DATA ON HOLD1
END
-RUN

-* SEGMENT 8

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT9'
RCNTCDE AS 'CNTCNT9'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '08'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT9 CNTCNT9
DATA ON HOLD1
END
-RUN

-* SEGMENT 9

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT10'
RCNTCDE AS 'CNTCNT10'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '09'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT10 CNTCNT10
DATA ON HOLD1
END
-RUN

-* SEGMENT 10

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT11'
RCNTCDE AS 'CNTCNT11'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '10'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT11 CNTCNT11
DATA ON HOLD1
END
-RUN

-* SEGMENT 11

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT12'
RCNTCDE AS 'CNTCNT12'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '11'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT12 CNTCNT12
DATA ON HOLD1
END
-RUN

-* SEGMENT 12

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT13'
RCNTCDE AS 'CNTCNT13'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '12'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT13 CNTCNT13
DATA ON HOLD1
END
-RUN

-* SEGMENT 13

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT14'
RCNTCDE AS 'CNTCNT14'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '13'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT14 CNTCNT14
DATA ON HOLD1
END
-RUN

-* SEGMENT 14

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT15'
RCNTCDE AS 'CNTCNT15'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '14'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT15 CNTCNT15
DATA ON HOLD1
END
-RUN

-* SEGMENT 15

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT16'
RCNTCDE AS 'CNTCNT16'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '15'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT16 CNTCNT16
DATA ON HOLD1
END
-RUN

-* SEGMENT 16

TABLE FILE HOLD
PRINT AIR_KEY
RGEOZONE AS 'GEOCNT17'
RCNTCDE AS 'CNTCNT17'
BY AIR_KEY NOPRINT
IF SEG_NBR EQ '16'
ON TABLE HOLD AS HOLD1
END
-RUN

MODIFY FILE TTEMG
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE GEOCNT17 CNTCNT17
DATA ON HOLD1
END
-RUN

DEFINE FILE TTEMG
MGEOZ/A68 = IF GEOCNT17 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 | '-' |
GEOCNT8 | '-' | GEOCNT9 | '-' | GEOCNT10 | '-' | GEOCNT11 | '-' |
GEOCNT12 | '-' | GEOCNT13 | '-' | GEOCNT14 | '-' |
GEOCNT15 | '-' | GEOCNT16 | '-' | GEOCNT17 ELSE
IF GEOCNT16 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 | '-' |
GEOCNT8 | '-' | GEOCNT9 | '-' | GEOCNT10 | '-' | GEOCNT11 | '-' |
GEOCNT12 | '-' | GEOCNT13 | '-' | GEOCNT14 | '-' |
GEOCNT15 | '-' | GEOCNT16 ELSE
IF GEOCNT15 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 | '-' |
GEOCNT8 | '-' | GEOCNT9 | '-' | GEOCNT10 | '-' | GEOCNT11 | '-' |
GEOCNT12 | '-' | GEOCNT13 | '-' | GEOCNT14 | '-' |
GEOCNT15 ELSE
IF GEOCNT14 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 | '-' |
GEOCNT8 | '-' | GEOCNT9 | '-' | GEOCNT10 | '-' | GEOCNT11 | '-' |
GEOCNT12 | '-' | GEOCNT13 | '-' | GEOCNT14 ELSE
IF GEOCNT13 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 | '-' |
GEOCNT8 | '-' | GEOCNT9 | '-' | GEOCNT10 | '-' | GEOCNT11 | '-' |
GEOCNT12 | '-' | GEOCNT13 ELSE
IF GEOCNT12 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 | '-' |
GEOCNT8 | '-' | GEOCNT9 | '-' | GEOCNT10 | '-' | GEOCNT11 | '-' |
GEOCNT12 ELSE
IF GEOCNT11 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 | '-' |
GEOCNT8 | '-' | GEOCNT9 | '-' | GEOCNT10 | '-' | GEOCNT11 ELSE
IF GEOCNT10 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 | '-' |
GEOCNT8 | '-' | GEOCNT9 | '-' | GEOCNT10 ELSE
IF GEOCNT9 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 | '-' |
GEOCNT8 | '-' | GEOCNT9 ELSE
IF GEOCNT8 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 | '-' |
GEOCNT8 ELSE
IF GEOCNT7 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 | '-' | GEOCNT7 ELSE
IF GEOCNT6 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 | '-' | GEOCNT6 ELSE
IF GEOCNT5 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 | '-' | GEOCNT5 ELSE
IF GEOCNT4 NE '   ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 | '-' |
GEOCNT4 ELSE
IF GEOCNT3 NE '  ' THEN
GEOCNT1 | '-' | GEOCNT2 | '-' | GEOCNT3 ELSE
GEOCNT1 | '-' | GEOCNT2;
MCNTC/A68 = IF CNTCNT17 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7||'-'||
CNTCNT8||'-'||CNTCNT9||'-'||CNTCNT10||'-'||CNTCNT11||'-'||
CNTCNT12||'-'||CNTCNT13||'-'||CNTCNT14||'-'||
CNTCNT15||'-'||CNTCNT16||'-'||CNTCNT17 ELSE
IF CNTCNT16 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7||'-'||
CNTCNT8||'-'||CNTCNT9||'-'||CNTCNT10||'-'||CNTCNT11||'-'||
CNTCNT12||'-'||CNTCNT13||'-'||CNTCNT14||'-'||
CNTCNT15||'-'||CNTCNT16 ELSE
IF CNTCNT15 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7||'-'||
CNTCNT8||'-'||CNTCNT9||'-'||CNTCNT10||'-'||CNTCNT11||'-'||
CNTCNT12||'-'||CNTCNT13||'-'||CNTCNT14||'-'||
CNTCNT15 ELSE
IF CNTCNT14 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7||'-'||
CNTCNT8||'-'||CNTCNT9||'-'||CNTCNT10||'-'||CNTCNT11||'-'||
CNTCNT12||'-'||CNTCNT13||'-'||CNTCNT14 ELSE
IF CNTCNT13 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7||'-'||
CNTCNT8||'-'||CNTCNT9||'-'||CNTCNT10||'-'||CNTCNT11||'-'||
CNTCNT12||'-'||CNTCNT13 ELSE
IF CNTCNT12 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7||'-'||
CNTCNT8||'-'||CNTCNT9||'-'||CNTCNT10||'-'||CNTCNT11||'-'||
CNTCNT12 ELSE
IF CNTCNT11 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7||'-'||
CNTCNT8||'-'||CNTCNT9||'-'||CNTCNT10||'-'||CNTCNT11 ELSE
IF CNTCNT10 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7||'-'||
CNTCNT8||'-'||CNTCNT9||'-'||CNTCNT10 ELSE
IF CNTCNT9 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7||'-'||
CNTCNT8||'-'||CNTCNT9 ELSE
IF CNTCNT8 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7||'-'||
CNTCNT8 ELSE
IF CNTCNT7 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6||'-'||CNTCNT7 ELSE
IF CNTCNT6 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5||'-'||CNTCNT6 ELSE
IF CNTCNT5 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4||'-'||CNTCNT5 ELSE
IF CNTCNT4 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3||'-'||
CNTCNT4 ELSE
IF CNTCNT3 NE '  ' THEN
CNTCNT1||'-'||CNTCNT2||'-'||CNTCNT3 ELSE
CNTCNT1||'-'||CNTCNT2;
END
-RUN

TABLE FILE TTEMG
PRINT AIR_KEY MGEOZ MCNTC
BY AIR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE &&TCOMP
FIXFORM FROM HOLD
MATCH AIR_KEY
ON NOMATCH INCLUDE
ON MATCH UPDATE MGEOZ MCNTC
DATA ON HOLD
END
-RUN

-GOTO UPDLOOP

-XFER
-TYPE PROGRAM COMPLETED.......
-EXIT
