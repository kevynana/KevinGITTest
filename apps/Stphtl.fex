-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-*4/25/2017-JEM-S-33318-updated logic for no records report

SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

DEFINE FILE &&EXTRACT
LEVEL_DESC/A60  = &&LDESC;  
NEW_TOTAL_AMT/P12 = TOTAL_AMT; 
END
-RUN

TABLEF FILE &&EXTRACT
PRINT AROLL_DSC3
      AROLL_DSC4
      INVOICE_DATE 	
      LEVEL_DESC	
      NEW_TOTAL_AMT  
WHERE (INVOICE_DATE GE &&FROMDT.EVAL) AND (INVOICE_DATE LE &&TODT.EVAL) OR
      (INVOICE_DATE GE &&FXDATE.EVAL AND INVOICE_DATE LE &&TXDATE.EVAL)
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10



-INCLUDE RPTPARMS
ON TABLE HOLD AS HTLHLD
END
-RUN

DEFINE FILE HTLHLD
CURRENT/A1 = IF INVOICE_DATE GE &&FROMDT.EVAL AND
                INVOICE_DATE LE &&TODT.EVAL THEN 'Y' ELSE 'N';
PRIOR/A1 =  IF INVOICE_DATE GE &&FXDATE.EVAL AND
               INVOICE_DATE LE &&TXDATE.EVAL THEN 'Y' ELSE 'N';

-* DEFINES ON PREVIOUS DEFINES

CHAMT/P12C = IF CURRENT EQ 'Y' THEN NEW_TOTAL_AMT ELSE 0;
PHAMT/P12C = IF PRIOR EQ 'Y' THEN NEW_TOTAL_AMT ELSE 0;
END

TABLE FILE HTLHLD
SUM CHAMT
    PHAMT
BY LEVEL_DESC
-* BY AROLL_DSC3
-* BY AROLL_DSC4
ON TABLE HOLD AS HTLTTL
END
-RUN

-SET &&HTLREC=IF &RECORDS EQ 0 THEN 'N' ELSE 'Y';
