-*  02/02/2015  REJ  S-05681 Changes to the no data report to prepare for the Available
-*                           Report changes.  Rollup Code is being removed from BRPTINST in
-*                           ER5, so I'm removing the reference to the ROLLUP_CODE in that report.
-*  08/23/2016  REJ  S-17914 Changes for ER5.
-*  12/29/2016  REJ  S-28553 Move ER5 My Reports to production.
-*4/27/2017-JEM-S-33318-updated logic for no records report

-*SET TEMPERASE = OFF
EX SETCG SETFILE=&&SETF
-RUN
-INCLUDE OTHPARMS
 
-SET &&DRILLABLE = 'N';
 
-SET &&RPT_HOLD = 'RPTHOLD';
-SET &OUTDEST = EDIT('&&OUTTO.EVAL','9$');
 
-SET &&OUTLINE1 = IF '&OUTDEST.EVAL' EQ 'E' OR '&OUTDEST.EVAL' EQ 'T'
- THEN 'ON TABLE SAVE AS SAVREP FORMAT EXL2K'
- ELSE 'ON TABLE PCHOLD FORMAT EXL2K';
-SET &&OUTLINE2 = '';
 
 
 
 
-INCLUDE SETPARMTIME
 

 
-*-INCLUDE SetParmtime
-*-RUN
-**********************************************************************
-* DETERMINE IF WE HAVE WEB DEPLOYMENT OR LOCAL STAND ALONE
-* SET PATH FOR SAVING THE SETFILE
-**********************************************************************
-******LOCAL DEPLOYMENT
-IF &&DEPLOY EQ 'W' GOTO SETWEB;
-SET &&SETFNM= &&LOCPATH || &&DTTMSTRM ||'.FTM';
COPY &&SETF &&SETFNM
-RUN
 
-******WEB DEPLOYMENT
-SETWEB
-SET &&WEBPATH = '&&WEBSRV.EVAL' || '\TTWEB\ ' || &&ROLLUP || '\ '||&&UNAME.EVAL|| '\';
-SET &&SETFNM = &&WEBPATH || &&DTTMSTRM ||'.FTM';
 
COPY &&VARFWEB &&SETFNM
-INCLUDE SETFPARM
-RUN
 
 
FILEDEF AUSEINCL DISK &&AUSEPASS
-RUN
FILEDEF CUSEINCL DISK &&CUSEPASS
-RUN
FILEDEF HUSEINCL DISK &&HUSEPASS
-RUN
FILEDEF LUSEINCL DISK &&LUSEPASS
-RUN
 
-INCLUDE SELCATQT
-RUN
 
EX &&CATQTRPR
-RUN
 
FILEDEF AUSEINCL CLEAR
-RUN
FILEDEF CUSEINCL CLEAR
-RUN
FILEDEF HUSEINCL CLEAR
-RUN
FILEDEF LUSEINCL CLEAR
-RUN
 
-* SET EMPTYREPORT = ON
-* -RUN
 
-SET &&SMD = 'S';
-RUN
 
-IF &&FROMAVRP NE 'Y' GOTO :TA1;
-SET &&RPTGRP_OVERRIDE='AIR';
EX CODEGEN
-INCLUDE SELCATQT
-RUN
-:TA1
 
EX AIRUSE
-RUN
 
EX SELDESC2
-RUN
 
 
EX BBAIREX
-RUN

-IF &&AIRREC EQ 'N' AND &&CARREC EQ 'N' AND &&HTLREC EQ 'N' THEN GOTO NORECORDS;

 
EX BBAIRSUM
-RUN
 
-IF &&FROMAVRP NE 'Y' GOTO :TA2;
-SET &&RPTGRP_OVERRIDE='HTL';
EX CODEGEN
-INCLUDE SELCATQT
-RUN
-:TA2
 
EX BBHTLSUM
-RUN
 
-IF &&FROMAVRP NE 'Y' GOTO :TA3;
-SET &&RPTGRP_OVERRIDE='CAR';
EX CODEGEN
-INCLUDE SELCATQT
-RUN
-:TA3
 
EX BBCARSUM
-RUN
 
EX BBTOTSUM
-RUN

-SET &&RPTSUF = 'BBCMCH';
-INCLUDE FDEFRPTS
-RUN
 
-IF &&FROMAVRP NE 'Y' GOTO :AVSF0;
-INCLUDE AVRP_SUBFOOT
-:AVSF0
 
-SET &&COMPOUND=IF &&OUTLINE1 CONTAINS 'ONLINE-FMT' OR 'PCHOLD' THEN
- 'COMPOUND LAYOUT PCHOLD FORMAT ' | '&&OUTFMT.EVAL' ELSE
- 'COMPOUND LAYOUT HOLD FORMAT ' | '&&OUTFMT.EVAL';
 
 
 
 
EX BBMULTI3
-RUN
 
 
 
-IF &&OUTTO EQ 'XB' GOTO SKIP_TRIG;
 
-SET &OFL=&&OUTFMT.LENGTH;
-SET &OFM='A' || '&OFL.EVAL';
-SET &&OUTFMTX=LOCASE(&OFL.EVAL, '&&OUTFMT.EVAL', '&OFM.EVAL');
 
-SET &HFILE=&&WEB_PATH || 'SAVREP.' || &&OUTFMTX;
-IF &&OUTTO EQ 'TC' GOTO SRV_SAVE;
 
-GOTO SKIP_TRIG;
 
-SRV_SAVE
COPY &HFILE &&SAVSUM
 
 
-SKIP_TRIG
SET EMPTYREPORT=OFF
-RUN
 
 
 
-GOTO XXITrpt
 
 
-* REJ ADDED TO TRAP ERRORS
-SET &&FEXNOW=&&EXPARM;
-INCLUDE ERRORCHK
-IF &&RET GT 1 GOTO XXIT;
-* REJ ADDED TO TRAP ERRORS
 
-IF &RECORDS GT 0 THEN GOTO DOIT;
 
-NORECORDS

-IF &&FROMAVRP NE 'Y' GOTO :AVSF2;
-INCLUDE OTHPARMS
-INCLUDE AVRP_SUBFOOT
-:AVSF2

-INCLUDE NORECRPT
-RUN

-DOIT
 
-XXITrpt
 
