-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-* File CVIEW1SM.FEX
-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-*4/17/01      TANDT-SS             Added DOD_TYPE
-*07/03/02   STEVE              CHANGED TO eTTek Review and Copyright
-**********************************************************************


SET ASNAMES = ON
-RUN

TABLE FILE &&RPT_HOLD
SUM AVG_DLY_RATE/D12.2CS AS 'CAVG'
    BOOKINGS/D8 AS 'CBOOK'
    DAILY_RATE/D12.2CS AS 'CDRTE'
    MIDBOOK/D8 AS 'CMBOOK'
    MID_DAYS/D8 AS 'CMDAYS'
    MID_AMT/D12.2CS AS 'CMAMT'
    NBR_DAYS AS 'CNDAY'
    NONMIDBOOK/D8 AS 'CNMBOOK'
    NONMID_AMT/D12.2CS AS 'CNMAMT'
    NONMID_DAYS/D8 AS 'CNMDAYS'
    NONZE_AMT/D12.2CS AS 'CNZEAMT'
    NONZEBOOK/D8 AS 'CNZEBK'
    NONZE_DAYS/D8 AS 'CNZDAYS'
    RENTAL_AMT/D12.2CS AS 'CRAMT'
    RENTAL_DAYS/D12.2CS AS 'CRDAYS'
    RESV_BRANCH
    STD_RATE/D12.2CS AS 'CSTD'
    ZE_AMT/D12.2CS AS 'CZEAMT'
    ZEBOOK/D8 AS 'CZEBOOK'
    ZE_DAYS/D8 AS 'CZDAYS'
    
COMPUTE AVGDR/D12.2CS=IF (RENTAL_AMT LT 0) AND (NBR_DAYS LT 0)
  THEN ((RENTAL_AMT/NBR_DAYS) * (-1)) 
   ELSE RENTAL_AMT/NBR_DAYS; AS 'AVG,DAILY,RATE'
   
-INCLUDE CARRATE

    BY LEVEL_DESC    
    ON TABLE HOLD AS HOLDONE
END
-RUN

TABLE FILE &&RPT_HOLD
PRINT AIRPORT_CODE	
  AIRPORT_NAME
  AVG_DLY_RATE
  BOOKINGS
  CAR	
  CAR_CAT
  CAR_DESC
  CAR_TOT
  CAR_TYPE	
  CREDIT_CARD	
  DAILY_RATE
  DOD_TYPE	
  DROP_DAY
  DROP_OFF_DT	
  IBOOK
  LEVEL1
  MIDBOOK
  MID_AMT
  MID_DAYS
  NBR_DAYS	
  NONMIDBOOK
  NONMID_AMT
  NONMID_DAYS
  NONZE_AMT
  NONZEBOOK
  NONZE_DAYS
  NUM_CARS
  PASSNGR_NAME	
  PICK_DAY
  PICK_UP_DT
  PICK_CTY_NAME	
  RENTAL_AMT
  RENTAL_DAYS	
  RESV_BRANCH
  STD_RATE	
  VENDOR_NAME
  XSPACE	
  ZE_AMT
  ZEBOOK
  ZE_DAYS

-INCLUDE OTHPARMS

BY LEVEL_DESC
BY REFUSE_CD
ON TABLE HOLD AS XTWO
END
-RUN

MATCH FILE XTWO
PRINT AIRPORT_CODE	
  AIRPORT_NAME	
  AVG_DLY_RATE	
  BOOKINGS
  CAR
  CAR_CAT
  CAR_DESC	
  CAR_TOT
  CAR_TYPE	
  CREDIT_CARD	
  DAILY_RATE
  DOD_TYPE	
  DROP_DAY
  DROP_OFF_DT
  IBOOK	
  LEVEL1
  MIDBOOK
  MID_AMT
  MID_DAYS
  NBR_DAYS	
  NONMIDBOOK
  NONMID_AMT
  NONMID_DAYS
  NONZE_AMT
  NONZEBOOK
  NONZE_DAYS
  NUM_CARS
  PASSNGR_NAME	
  PICK_CTY_NAME
  PICK_DAY
  PICK_UP_DT	
  RENTAL_AMT
  RENTAL_DAYS	
  RESV_BRANCH
  STD_RATE	
  VENDOR_NAME
  XSPACE	
  ZE_AMT
  ZEBOOK
  ZE_DAYS
BY LEVEL_DESC
BY REFUSE_CD
ON TABLE HOLD
RUN
FILE HOLDONE
SUM 
    CAVG 
    CBOOK
    CDRTE
    CMAMT
    CMBOOK
    CMDAYS
    CNDAY
    CNMAMT
    CNMBOOK
    CNMDAYS
    CNZEAMT
    CNZEBK
    CNZDAYS
    CRAMT
    CRDAYS
    CSTD
    CZEAMT
    CZEBOOK
    CZDAYS
    BY LEVEL_DESC
AFTER MATCH HOLD AS XTHREE OLD-OR-NEW 
END
-RUN

DEFINE FILE XTHREE
-*   PCTCRAMT/D8.1S=IF (RENTAL_AMT LT 0) AND (CRAMT LT 0) THEN
-*                  ((RENTAL_AMT/CRAMT)*(-100)) ELSE ((RENTAL_AMT/CRAMT)*100);
  PCTCRAMT/D81.S = IF ((CRAMT LT 1) AND (CRAMT GT (-1))) THEN 0
                   ELSE ((RENTAL_AMT/CRAMT)*100);
-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-**********************************************************************
  NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
END

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

TABLE FILE XTHREE
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    &&S_SUBJ11
    &&S_SUBJ12
    &&S_SUBJ13
    &&S_SUBJ14
    &&S_SUBJ15
    &&S_SUBJ16
    &&S_SUBJ17
    &&S_SUBJ18
    &&S_SUBJ19
    &&S_SUBJ20
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
&&BREAKOPTION
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10

-INCLUDE FOOTERSM
ON TABLE COLUMN-TOTAL
-*ON TABLE SET STYLE &&SMSTY
-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *

-INCLUDE &&PASTYS

-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILL;
-INCLUDE &&DSTY

-SKIP_DRILL

ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN

-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3;

EX REPORT_3

-SKIP_R3
