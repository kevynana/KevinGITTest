-********************************************************************
-* LOADCOMPUTEDFIELDS.FEX
-* Load from COMPUTEDFIELDS.csv file to ADHOCCOMPUTEDFIELDS
-********************************************************************
-SET &ECHO = ALL;
-DEFAULT &REVIEW5='Y';

-SET &CSVFILE = IF &REVIEW5 EQ 'Y' THEN 'COMPUTEDFIELDS50' ELSE 'COMPUTEDFIELDS';

-IF &REVIEW5 EQ 'N' GOTO tableIt;
-INCLUDE REVIEW5PATH
-RUN

-tableIt
TABLE FILE ADHOCCOMPUTEDFIELDS
PRINT *
ON TABLE HOLD
END
MODIFY FILE ADHOCCOMPUTEDFIELDS
FIXFORM FROM HOLD
MATCH USE_PARM COLUMN_NAME
  ON MATCH DELETE
DATA ON HOLD
END
-RUN

TABLE FILE &CSVFILE
PRINT *
ON TABLE HOLD
END
MODIFY FILE ADHOCCOMPUTEDFIELDS
FIXFORM FROM HOLD
MATCH USE_PARM COLUMN_NAME
  ON NOMATCH INCLUDE
  ON MATCH UPDATE DATA_FMT EXPRESSION
DATA ON HOLD
END
-RUN


-* CREATE PREVIEW FILES
-*EX ER5_LoadAdhocPreview
-*-RUN
-QUIT

TABLE FILE ADHOCCOMPUTEDFIELDS
PRINT *
END

