-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-*7/26/04    JOY                Added/Changed Norecords logic
-*5/23/14    DEB                ADDED EX5 TO BE EXCLUDED WHEN EX1 IS EXCLUDED
-* 03/31/2017 - DLV - S-32239 - created new drilldown for ABCTRNTF VMTRNTF 
-INCLUDE SETECHO
-*SET TEMPERASE = OFF
-* File DRTRAN.FEX  
-*****************************************************************
-*DATE           NAME                 DESCRIPTION OF CHANGE
-*----           ----                 ---------------------
-*8/31/00        SAC                   Initial Creation
-*10/16/00        IBISTL-KR            ACCEPT DRILL DOWN PARMS
-*                                     AND USE ORIGINAL SETFILE
-*09/10/01       SAC         Changed EXCHGS, EXCH_AMT, EXCH_MCO defines to
-*                           match summary
-*02/15/02       SAC         Added additional WHERE DOD_TYP selections below
-* 4/18/02       SAC         Changed SIDESTEP booking to WEB Booking
-* 2/10/03       JEK         Changed MCO_Cnt to include Refunded MCOS
-*12/13/04  joy          Changed Exch_amt/Exch_tax to not exclude embark(DT1)
-*12/21/04       DEB     CHANGED WHERE DOD_TYPE TO INCLUDE ADDTL DOD_TYPES
-*                       CHANGED INTERNET_FLAG DEFINE TO INCL ADDTL DOD_TYP
-* 12/29/04      DEB     ADDED FILEDEF FOR FUJI REPORT - DEB
-* 1/26/05       DEB     ADDED CODE FOR GLOBAL CURRENCY
-* 8/29/05       DEB     ADDED BDGA_DPT DEFINE
-*10/11/05       DEB     ADDED DOD_TYPE H TO BOOKING TYPE DEFINES
-*1/23/14 UPDATED ONLINE/TRADITIONAL DEFINES TO USE ONLINE_TRADITIONAL FIELD INSTEAD OF DOD_TYPE
-*12/3/14 UPDATED WHEREI DEFINE TO USE THE DOD_DESC FIELD - JK
-*  06/12/2015  REJ  S-08389 Changes for Available Reports.  Adding code so that the
-*                           program will run in current Review and in Available Reports.
-*12/01/15  Joy    S-07987  Corrected for running Currency Enabled Version
-*01/20/16 - DEB - S-14801 changed   EXCHGS defines
-*                         to exclude RF_FLAG so exchanges with partial refunds
-*                         would not appear twice under exchanges and partial refunds on the report
-*3/2/16 - JOY - S-16262 Bug fix removed hard coded where statements and hard coded table file so report would produce correct results
-*3/2/16 - JEM -S-16367 Updated hard coded d:\ to use &&WFSRV1.EVAL
-*  03/22/2016  REJ  S-13250 Changes for Available Reports to include parameters on the subfooter page.
-*12/14/16 - DLV - S-28295  Changed FULL_RFNDS PART_RFNDS to match defines in AVIW23DT
-*                          Added sort to hold file RPTHOLD
-*04/03/2017  - DLV - S-32239 Created for drilldown of TF Ticketing AAF Ticketing
-*09/28/2017 - JEM - S-35422 Place the footer date/time stamp text in a separate file to be -INCLUDED in the stylesheets
-*****************************************************************

-* FRT_DateTimePosit sets the position of the Post-trip date/time stamp text within the footer image.
-* The default line number (&FTR_DateTimeLine) in the FOOTING for the date/time stamp text is: 4. 
-INCLUDE FTR_DateTimePosit
 
 
-SET &&FIELD = &TRANTYPE;
-SET &&FROMDT = &FRMDT;
-SET &&TODT = &TODT;
-SET &&WRRUN = 'Y';
-SET &&IFLAG = &IFLAG;
-SET &&WHERETF = ' ';
 
-SET &WHEREI = 'WHERE DOD_DESC EQ ''&&IFLAG.EVAL''';
 
-**********************************************************************
-* EX RPTRESET TO RESET PARAMS
-**********************************************************************
-SET &&ROLLUP = &ROLUP;
-* -SET &&UNAME = &UID;
-SET &&UNAME = &user;
-**** the following two lines added 11/03/2003 ****
-DEFAULT &FPARM = ' ';
-SET &&FIPARM = &FPARM;
-SET &&DRILLED_RUN = 'Y';
 
EX RPTRESET
-RUN
-*
EX RESET
-RUN
 
-**********************************************************************
-* CHECK FOR PRESENCE OF ORIGINAL SET FILE
-*********************************************************************
-*****  USE VALUE PASSED AS &SETFNM TO DETERMINE FILE NAME
-IF &&DEPLOY EQ 'W' GOTO SETWEB;
-SET &&LOCPATH = '&&DATASRV.EVAL' || '\TT\ '|| &&ROLLUP || '\ '||&&UNAME.EVAL||'\';
-SET &FILEXIST = &&LOCPATH || &SETFNM || '.FTM';
-GOTO CHKFILE;
 
-SETWEB
-SET &&WEBPATH = '&&WEBSRV.EVAL' || '\TTWEB\ ' || &&ROLLUP || '\ '||&&UNAME.EVAL||'\';
-SET &FILEXIST = &&WEBPATH || &SETFNM || '.FTM';
 
-CHKFILE
STATE &FILEXIST
-RUN
 
-TYPE &RETCODE
 
-IF &RETCODE NE 0 GOTO NOFILE;
-**********************************************************************
-* USE ORIGINAL SETFILE
-**********************************************************************
-*EX TSSETDB SETFILE=DRTRNSF
-SET &TMPDRIL = &&WEB_PATH || 'TEMPDRIL.FEX' ;
COPY &FILEXIST &TMPDRIL
-RUN
-SET &&SETF='TEMPDRIL';
 
 
 
 
EX SETDBLS SETFILE=&&SETF
-RUN
 
 
-* REJ added for er5
-IF &&FROMAVRP NE 'Y' GOTO :DRD1;
APP PREPENDPATH REVIEW_50_SHARED REVIEW_50_AVRP ttapps_sql
-RUN
-:DRD1
 
-INCLUDE GetForDrillDown
-RUN
-*EX WRBATCH
-*-RUN
-*EX LOADBINS
-*-RUN
-*EX CODEGEN
-*-RUN
-*-INCLUDE OTHPARMS
 
-*EX GETFPARM
-*-RUN
 
-SET &&OUTLINE1 = 'ON TABLE SET ONLINE-FMT';
-SET &&OUTLINE2 = IF &&OUTLINE2 CONTAINS 'PDF' THEN 'PDF' ELSE
-          IF &&OUTLINE2 CONTAINS 'EXCEL' THEN 'EXCEL' ELSE
-          IF &&OUTLINE2 CONTAINS 'EXL2K' THEN 'EXL2K' ELSE 'PDF';
 
FILEDEF AUSEINCL DISK &&AUSEPASS
-RUN
FILEDEF CUSEINCL DISK &&CUSEPASS
-RUN
FILEDEF HUSEINCL DISK &&HUSEPASS
-RUN
FILEDEF LUSEINCL DISK &&LUSEPASS
-RUN
 
-IF &&FROMAVRP NE 'Y' GOTO :DDTA1;
-SET &&RPTGRP_OVERRIDE='AIR';
EX CODEGEN
-:DDTA1
-RUN
 
 
-SET &&RPTTYP = ' ';
-INCLUDE SELCATQT
-RUN
 
EX CATQTR
-RUN
 
FILEDEF AUSEINCL CLEAR
-RUN
FILEDEF CUSEINCL CLEAR
-RUN
FILEDEF HUSEINCL CLEAR
-RUN
FILEDEF LUSEINCL CLEAR
-RUN
EX AIRUSE
-RUN
 
 
-TYPE Before Extract
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN
 
-IF &&CURRENCY NE 'USD' THEN GOTO GLOBAL;
 
-IF &&FIELD EQ '   Mcos' THEN GOTO MCOS
-  ELSE IF &&FIELD EQ '   Tour Orders' THEN GOTO TOUR
-  ELSE IF &&FIELD EQ '   Handwrites' THEN GOTO HAND
-  ELSE IF &&FIELD EQ '   Ptas' THEN GOTO PTAS
-  ELSE IF &&FIELD EQ '   Paper/Etkt' THEN GOTO OTHR
-  ELSE IF &&FIELD EQ '   Ticketless' THEN GOTO TKTL
-  ELSE IF &&FIELD EQ '   Exchg Sales' THEN GOTO EXCH
-  ELSE IF &&FIELD EQ '   Exchg Mcos' THEN GOTO EMCO
-  ELSE IF &&FIELD EQ '   Full Refunds' THEN GOTO FRFD
-  ELSE IF &&FIELD EQ '   Partial Rfnd' THEN GOTO PRFD
-  ELSE IF &&FIELD EQ 'VOIDS' THEN GOTO VOID
-  ELSE IF &&FIELD EQ 'TF TICKETING' THEN GOTO TFT
-  ELSE IF &&FIELD EQ 'AAP TICKETING' THEN GOTO AAP
-  ELSE GOTO OUTSIDE;
 
-MCOS
-SET &&FIELD = 'WHERE MCO_CNT NE 0';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'FARE_AMT1';
-SET &&RPT_TTL1 = '                   MCO TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-TOUR
-SET &&FIELD = 'WHERE DOC_TYPE EQ ''2''';
-SET &&FIELD1 = 'WHERE EXCHG_SALE EQ '' ''';
-SET &&FIELD2 = 'WHERE EMBARK NE ''EX1'' OR ''RF1'' OR ''EX5''';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'FARE_AMT';
-SET &&RPT_TTL1 = '               TOUR ORDER TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-HAND
-SET &&FIELD = 'WHERE DOC_TYPE EQ ''3''';
-SET &&FIELD1 = 'WHERE EXCHG_SALE EQ '' ''';
-SET &&FIELD2 = 'WHERE EMBARK NE ''EX1'' OR ''RF1'' OR ''EX5''';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'FARE_AMT';
-SET &&RPT_TTL1 = '                HANDWRITE TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-PTAS
-SET &&FIELD = 'WHERE DOC_TYPE EQ ''4''';
-SET &&FIELD1 = 'WHERE EXCHG_SALE EQ '' ''';
-SET &&FIELD2 = 'WHERE EMBARK NE ''EX1'' OR ''RF1'' OR ''EX5''';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'FARE_AMT';
-SET &&RPT_TTL1 = '                  PTA TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-OTHR
-SET &&FIELD = 'WHERE DOC_TYPE EQ ''5'' OR ''6'' OR ''7'' OR ''8''';
-SET &&FIELD1 = 'WHERE EXCHG_SALE EQ '' ''';
-SET &&FIELD2 = 'WHERE EMBARK NE ''EX1'' OR ''RF1'' OR ''EX5''';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'FARE_AMT';
-SET &&RPT_TTL1 = '              PAPER/ETICKET TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-TKTL
-SET &&FIELD = 'WHERE DOC_TYPE EQ ''9''';
-SET &&FIELD1 = 'WHERE EXCHG_SALE EQ '' ''';
-SET &&FIELD2 = 'WHERE EMBARK NE ''EX1'' OR ''RF1'' OR ''EX5''';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'FARE_AMT';
-SET &&RPT_TTL1 = '              TICKETLESS TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-EXCH
-SET &&FIELD = 'WHERE EXCHGS NE 0';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'NET_TKT_CNT1';
-SET &&FARE = 'FARE_AMT1';
-SET &&RPT_TTL1 = '             EXCHANGE SALE TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-EMCO
-SET &&FIELD = 'WHERE EXCH_MCO NE 0';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'FARE_AMT1';
-SET &&RPT_TTL1 = '             EXCHANGE MCO TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-FRFD
-SET &&FIELD = 'WHERE RF_FLAG EQ ''F''';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'FRF_CNT';
-SET &&FARE = 'FARE_AMT1';
-SET &&RPT_TTL1 = '              FULL REFUND TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-PRFD
-SET &&FIELD = 'WHERE RF_FLAG EQ ''P''';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'PRF_CNT';
-SET &&FARE = 'FARE_AMT1';
-SET &&RPT_TTL1 = '             PARTIAL REFUND TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-VOID
-SET &&FIELD = 'WHERE VOID_DATE NE 0';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'FARE_AMT1';
-SET &&RPT_TTL1 = '                  VOID TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-TFT
-SET &&FIELD = '';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'NET_TKT_CNT2';
-SET &&FARE = 'TFARE_AMT';
-SET &&RPT_TTL1 = '                 TF TICKETING DETAIL';
-SET &&WHERETF = 'WHERE TF_TKT2  EQ ''T''';
-GOTO OUTSIDE

-AAP 
-SET &&FIELD = '';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'NET_TKT_CNT2';
-SET &&FARE = 'TFARE_AMT';
-SET &&RPT_TTL1= '                 AAP TICKETING DETAIL';
-SET &&WHERETF = 'WHERE AAPD2  EQ ''Y''';

-GOTO OUTSIDE
 
 
 
-GLOBAL;
-IF &&FIELD EQ '   Mcos' THEN GOTO MCOS
-  ELSE IF &&FIELD EQ '   Tour Orders' THEN GOTO TOUR
-  ELSE IF &&FIELD EQ '   Handwrites' THEN GOTO HAND
-  ELSE IF &&FIELD EQ '   Ptas' THEN GOTO PTAS
-  ELSE IF &&FIELD EQ '   Paper/Etkt' THEN GOTO OTHR
-  ELSE IF &&FIELD EQ '   Ticketless' THEN GOTO TKTL 
-  ELSE IF &&FIELD EQ '   Exchg Sales' THEN GOTO EXCH
-  ELSE IF &&FIELD EQ '   Exchg Mcos' THEN GOTO EMCO
-  ELSE IF &&FIELD EQ '   Full Refunds' THEN GOTO FRFD
-  ELSE IF &&FIELD EQ '   Partial Rfnd' THEN GOTO PRFD
-  ELSE IF &&FIELD EQ 'VOIDS' THEN GOTO VOID
-  ELSE GOTO OUTSIDE;
 
-MCOS
-SET &&FIELD = 'WHERE MCO_CNT NE 0';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'GFARE_AMT1';
-SET &&RPT_TTL1 = '                   MCO TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-TOUR
-SET &&FIELD = 'WHERE DOC_TYPE EQ ''2''';
-SET &&FIELD1 = 'WHERE EXCHG_SALE EQ '' ''';
-SET &&FIELD2 = 'WHERE EMBARK NE ''EX1'' OR ''RF1'' OR ''EX5''';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'GFARE_AMT';
-SET &&RPT_TTL1 = '               TOUR ORDER TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-HAND
-SET &&FIELD = 'WHERE DOC_TYPE EQ ''3''';
-SET &&FIELD1 = 'WHERE EXCHG_SALE EQ '' ''';
-SET &&FIELD2 = 'WHERE EMBARK NE ''EX1'' OR ''RF1'' OR ''EX5''';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'GFARE_AMT';
-SET &&RPT_TTL1 = '                HANDWRITE TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-PTAS
-SET &&FIELD = 'WHERE DOC_TYPE EQ ''4''';
-SET &&FIELD1 = 'WHERE EXCHG_SALE EQ '' ''';
-SET &&FIELD2 = 'WHERE EMBARK NE ''EX1'' OR ''RF1''';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'GFARE_AMT';
-SET &&RPT_TTL1 = '                  PTA TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-OTHR
-SET &&FIELD = 'WHERE DOC_TYPE EQ ''5'' OR ''6'' OR ''7'' OR ''8''';
-SET &&FIELD1 = 'WHERE EXCHG_SALE EQ '' ''';
-SET &&FIELD2 = 'WHERE EMBARK NE ''EX1'' OR ''RF1'' OR ''EX5''';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'GFARE_AMT';
-SET &&RPT_TTL1 = '            PAPER/ETICKET TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-TKTL
-SET &&FIELD = 'WHERE DOC_TYPE EQ ''9''';
-SET &&FIELD1 = 'WHERE EXCHG_SALE EQ '' ''';
-SET &&FIELD2 = 'WHERE EMBARK NE ''EX1'' OR ''RF1'' OR ''EX5''';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'GFARE_AMT';
-SET &&RPT_TTL1 = '              TICKETLESS TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-EXCH
-SET &&FIELD = 'WHERE EXCHGS NE 0';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'NET_TKT_CNT1';
-SET &&FARE = 'GFARE_AMT1';
-SET &&RPT_TTL1 = '             EXCHANGE SALE TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-EMCO
-SET &&FIELD = 'WHERE EXCH_MCO NE 0';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'GFARE_AMT1';
-SET &&RPT_TTL1 = '             EXCHANGE MCO TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-FRFD
-SET &&FIELD = 'WHERE RF_FLAG EQ ''F''';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'FRF_CNT';
-SET &&FARE = 'GFARE_AMT1';
-SET &&RPT_TTL1 = '              FULL REFUND TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-PRFD
-SET &&FIELD = 'WHERE RF_FLAG EQ ''P''';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'PRF_CNT';
-SET &&FARE = 'GFARE_AMT1';
-SET &&RPT_TTL1 = '             PARTIAL REFUND TRANSACTION DETAIL';
-GOTO OUTSIDE
 
-VOID
-SET &&FIELD = 'WHERE VOID_DATE NE 0';
-SET &&FIELD1 = '';
-SET &&FIELD2 = '';
-SET &&COUNT = 'NET_TKT_CNT';
-SET &&FARE = 'GFARE_AMT1';
-SET &&RPT_TTL1 = '                  VOID TRANSACTION DETAIL';
 
 
 
-OUTSIDE
 
FI FUJILIST DISK &&WFSRV1.EVAL\TNT\TTRACKER\TEMP\FUJILIST.TXT
 
-SET &AIRDATES = &&WEB_PATH || 'AIRDATES.fex';
 
DEFINE FILE SR_50
  INTERNET_FLAG/A42 = DOD_DESC;
 
  NEW_SALES/D12.2CS = IF (SEG_AMT GT 0) AND (SEG_COUNT GE 0) THEN
                      SEG_AMT ELSE 0;
-*  GNEW_SALES/D16.2CS = IF (SEG_AMT GT 0) AND (SEG_COUNT GE 0) THEN
-*                       GSEG_AMT ELSE 0;
 
  NEW_TAX/D12.2CS = IF (SEG_TAX GT 0) AND (SEG_COUNT GE 0) THEN
                    SEG_TAX ELSE 0;
-*  GNEW_TAX/D16.2CS = IF (SEG_TAX GT 0) AND (SEG_COUNT GE 0) THEN
-*                     GSEG_TAX ELSE 0;
  FARE_PAID/D12.2CS = NEW_SALES + NEW_TAX;
-*  GFARE_PAID/D16.2CS = GNEW_SALES + GNEW_TAX
  FARE_PAY/D12.2CS = SEG_AMT + SEG_TAX;
-*  GFARE_PAY/D16.2CS = GSEG_AMT + GSEG_TAX;
-*  FULL_RFNDS/D9 = IF ((VOID_DATE EQ 0) AND (RF_FLAG EQ 'F') AND
-*             (TKT_NUM NE LAST TKT_NUM) AND (SEG_COUNT LT 0)) THEN 1 ELSE 0;
FULL_RFNDS/D9 = IF ((VOID_DATE EQ 0) AND (RF_FLAG EQ 'F') AND (DOC_TYPE NE '1')
           AND (TKT_NUM NE LAST TKT_NUM) AND (SEG_COUNT LT 0)) THEN 1 ELSE 0;   
 
  NET_TKT_CNT/P8CS = IF (SEG_NBR EQ '01') AND (FARE_PAID GE 0) AND
                (SEG_COUNT EQ 1) THEN 1 ELSE IF DOC_TYPE EQ '1' THEN 1 ELSE 0;
 
  TKT_CNT/P8CS = IF (SEG_NBR EQ '01') AND (FARE_PAID GE 0) AND
             (SEG_COUNT EQ 1) THEN 1 ELSE 0;
 
  EXCH_AMT/D12 = IF (DOC_TYPE EQ '1' AND EXCHG_SALE NE ' ') THEN 0 ELSE
                 IF ((EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND (RF_FLAG EQ ' ') AND
                    (EMBARK NE 'DT1' OR 'RF1' OR 'FP3')) THEN FARE_PAY ELSE
-*                     (EMBARK NE 'RF1' OR 'FP3')) THEN FARE_PAY ELSE
                 IF ((SEG_COUNT GE 0) AND (EXCHG_SALE NE ' ') AND (EMBARK NE 'RF1'))
                     THEN FARE_PAY ELSE 0;
 
-*  EXCH_AMT/D12 = IF (DOC_TYPE EQ '1' AND EXCHG_SALE NE ' ') THEN 0 ELSE IF
-*                 IF ((EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND (EMBARK NE 'DT1' OR
-*                    'RF1' OR 'FP3') AND (RF_FLAG EQ ' ')) OR ((SEG_COUNT GE 0) AND
-*                   (EXCHG_SALE NE ' ')) OR (EMBARK EQ 'EX1') THEN FARE_PAY ELSE 0;
 
-*  GEXCH_AMT/D16 = IF (DOC_TYPE EQ '1' AND EXCHG_SALE NE ' ') THEN 0 ELSE
-*     IF ((EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND
-*     (EMBARK NE 'RF1' OR 'FP3')) THEN GFARE_PAY ELSE
-*     IF ((SEG_COUNT GE 0) AND (EXCHG_SALE NE ' ') AND (EMBARK NE 'RF1'))
-*     THEN GFARE_PAY ELSE 0;
 
 
 
 
 EXCHGS/D9 = IF (DOC_TYPE EQ '1' AND EXCHG_SALE NE ' ') THEN 0 ELSE
             IF ((EX_FLAG EQ 'F' OR 'P') AND (RF_FLAG EQ ' ') AND (SEG_COUNT LE 0) AND
                (EMBARK NE 'DT1' OR 'RF1' OR 'FP3')) THEN 1 ELSE
             IF ((SEG_COUNT GE 0) AND (EXCHG_SALE NE ' ')) AND (EMBARK NE 'RF1')
                 THEN 1 ELSE 0;
 
-*  EXCHGS/D9 = IF (EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND (EMBARK
-*  NE 'DT1' OR 'RF1' OR 'FP3') THEN 1 ELSE
-*   IF (DOC_TYPE EQ '1') AND (EXCHG_SALE EQ 'E') THEN 0 ELSE
-*   IF (SEG_COUNT GE 0) AND (EXCHG_SALE NE ' ') THEN 1 ELSE 0;
 
 
  EXCH_MCO/D9 = IF (EX_FLAG NE ' ') AND (DOC_TYPE EQ '1') THEN 1 ELSE 0;
 
  MCO_CNT/D9 = IF (EX_FLAG EQ ' ') AND (DOC_TYPE EQ '1') AND
                  (EXCHG_SALE NE ' ') THEN 1 ELSE
               IF (EX_FLAG EQ ' ') AND (DOC_TYPE EQ '1') AND
                  (RF_FLAG EQ 'F') THEN 1 ELSE 0;
 
 
-*  PART_RFNDS/D9 = IF ((VOID_DATE EQ 0) AND (RF_FLAG EQ 'P') AND
-*                     (TKT_SORT NE LAST TKT_SORT) AND
-*                     (SEG_COUNT LT 0)) THEN 1 ELSE 0;
PART_RFNDS/D9 = IF ((VOID_DATE EQ 0) AND (RF_FLAG EQ 'P') AND (TKT_NUM 
  NE LAST TKT_NUM) AND (SEG_COUNT LE 0)) THEN 1 ELSE 0; 

  TKT_TYPE/A4         = IF (SEG_COUNT LE 0) AND
                          (RF_FLAG EQ 'P') THEN 'P-RF' ELSE
                        IF (SEG_COUNT LE 0) AND
                          (RF_FLAG EQ 'F') THEN 'F-RF' ELSE
                        IF (SEG_COUNT LE 0) AND
                          (EX_FLAG EQ 'P') THEN 'P-EX' ELSE
                        IF (SEG_COUNT LE 0) AND
                          (EX_FLAG EQ 'F') THEN 'F-EX' ELSE ' ';
  XDPT_DT/MDYY         = DPT_DATE;
  XTRAN_DT/MDYY        = TRN_DATE;
  MONTH/MT = TRN_DATE;
  BDGA_DPT/A3 = EDIT(LEVEL1, '999$$$$$$$$$$$$');
VOIDS/D9 = IF (VOID_DATE NE 0) AND (SEG_COUNT EQ 1) AND (SEG_NBR EQ '01') 
  THEN 1 ELSE IF (DOC_TYPE EQ '1' AND VOID_DATE NE 0) THEN 1 ELSE 0;	
VOID_AMT/D12.2CS = IF VOID_DATE NE 0 THEN FARE_PAID ELSE 0;
END
-RUN
 
TABLEF FILE SR_50
PRINT AIR_KEY
  AIRLINE
  AROLL_LEV3
  BDGA_DPT
  BR_CL_IDX
  DOD_TYPE
  EMB_APT.AIRPORT_NAME AS 'EMB_APT_NM'
  EXCHG_SALE
  FARE_PAID
  FARE_PAY
  FULL_RFNDS
  INTERNET_FLAG
  NET_TKT_CNT
  PART_RFNDS
  PASSNGR_NAME
  REFUSE_CODE
  RTE_APT.AIRPORT_NAME AS 'RTE_APT_NM'
  TKT_CNT
  TKT_DATE
  TKT_NUM
  TKT_TYPE
  TRN_DATE
  VAL_AIRLINE
  VOIDS
  VOID_AMT
  VOID_DATE
  DPT_TIME
  XDPT_DT
  XTRAN_DT
  MONTH
  TKT_SORT
  SEG_NBR
  SEG_COUNT
-***************************************************************
-* Where statements to select data specified in user profile
-***************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
 
-INCLUDE &AIRDATES
 
 
-IF '&&SETF.EVAL' EQ 'CEXPTRAN' THEN GOTO NextWhere;
&WHEREI.EVAL
&&FIELD
&&FIELD1
&&FIELD2
-INCLUDE RPTPARMS
ON TABLE HOLD AS RPTHOLD1
END
-RUN
 

 


-IF &&FROMAVRP NE 'Y' GOTO :AVSF1;
-INCLUDE AVRP_SUBFOOT
-:AVSF1
 
-GOTO SkipThis;
-NextWhere
&&FIELD
&&FIELD1
&&FIELD2
-INCLUDE RPTPARMS
ON TABLE HOLD AS RPTHOLD1
END
-RUN
 
-SkipThis
TABLE FILE RPTHOLD1
PRINT AIR_KEY
  AIRLINE
  AROLL_LEV3
  BR_CL_IDX
  BDGA_DPT
  DOD_TYPE
  EMB_APT_NM
  EXCHG_SALE
  FARE_PAID
  FARE_PAY
  FULL_RFNDS
  INTERNET_FLAG
  NET_TKT_CNT
  PART_RFNDS
  PASSNGR_NAME
  REFUSE_CODE
  RTE_APT_NM
  TKT_CNT
  TKT_NUM
  TKT_TYPE
  TRN_DATE
  VAL_AIRLINE
  VOID_AMT
  VOIDS
  VOID_DATE
  DPT_TIME
  XDPT_DT
  XTRAN_DT
  MONTH
  TKT_SORT
  SEG_NBR
  SEG_COUNT
BY TKT_DATE
ON TABLE HOLD AS RHOLD FORMAT FOCUS INDEX TKT_DATE
END
-RUN
 
-* Global Reporting JOIN
JOIN RHOLD.TKT_DATE IN RHOLD TO GLOBAL.DATE IN GLOBAL AS J1
 
 
DEFINE FILE RHOLD
NAMEC/A30 = CNAME;
 
-******************************************************************************
-*                         Global Currency Conversion Defines
-******************************************************************************
CURR1X/D20.6 = 1 / USDPU ;
 
-* DEFINES ON PREVIOUS DEFINES
GFARE_PAID/D20.6 = FARE_PAID * CURR1X;
GFARE_PAY/D20.6 = FARE_PAY * CURR1X;
END
 
 
TABLE FILE RHOLD
PRINT AIR_KEY
  AIRLINE
  AROLL_LEV3
  BDGA_DPT
  BR_CL_IDX
  DOD_TYPE
  EMB_APT_NM
  EXCHG_SALE
  FARE_PAID
  FARE_PAY
  FULL_RFNDS
  INTERNET_FLAG
  NET_TKT_CNT
  PART_RFNDS
  PASSNGR_NAME
  REFUSE_CODE
  RTE_APT_NM
  TKT_CNT
  TKT_DATE
  TKT_NUM
  TKT_TYPE
  TRN_DATE
  VAL_AIRLINE
  VOID_AMT
  VOIDS
  VOID_DATE
  DPT_TIME
  XDPT_DT
  XTRAN_DT
  MONTH
  TKT_SORT
  SEG_NBR
  NAMEC
  GFARE_PAID/D16.2
  GFARE_PAY/D16.2

BY TKT_NUM
BY SEG_COUNT
BY NAMEC
WHERE GLOBAL.COUNTRYCODE EQ '&&CURRENCY'
ON TABLE HOLD AS RPTHOLD
END
-RUN
 

-TYPE After Extract
-IF &RECORDS EQ 0 GOTO NORECORDS;
-RUN
 
-IF '&&SETF.EVAL' NE 'ABCTRNTF' OR 'VMTRNTF' THEN GOTO CONTrpt;
-INCLUDE RETUDID
-RUN


TABLE FILE RPTHOLD
PRINT  
  AIRLINE
  AROLL_LEV3
  BR_CL_IDX
  BDGA_DPT
  DOD_TYPE
  EMB_APT_NM
  EXCHG_SALE
  FARE_PAID
  FARE_PAY
  FULL_RFNDS
  INTERNET_FLAG
  NET_TKT_CNT
  PART_RFNDS
  PASSNGR_NAME
  REFUSE_CODE
  RTE_APT_NM
  TKT_CNT
  TKT_DATE
  TKT_NUM
  TKT_TYPE
  TRN_DATE
  VAL_AIRLINE
  VOID_AMT
  VOIDS
  VOID_DATE
  DPT_TIME
  XDPT_DT
  XTRAN_DT
  MONTH
  TKT_SORT
  SEG_NBR
  NAMEC
  GFARE_PAID/D16.2
  GFARE_PAY/D16.2
  TKT_NUM 
  SEG_COUNT 
  NAMEC
BY AIR_KEY
ON TABLE HOLD AS AIRHOLD1
END
-RUN
 


-INCLUDE UDTFDTLD
-RUN


 

-CONTrpt;

 
-TYPE Before Report
TABLE FILE RPTHOLD
SUM NET_TKT_CNT AS 'TTKT'
FARE_PAID AS 'TFARE'
FARE_PAY AS 'TFP'
GFARE_PAID/D16.2 AS 'GTFARE'
GFARE_PAY/D16.2 AS 'GTFP'
TKT_CNT AS 'TEX'
FULL_RFNDS AS 'TRFD'
PART_RFNDS AS 'TPRFD'
VOIDS AS 'TVOID'
VOID_AMT AS 'TVFP'
-************************IBISTL KR*******************
-*TOT_TRANS AS 'TTRNS'
-****************************************************
BY PASSNGR_NAME
BY TKT_SORT
BY TRN_DATE
ON TABLE HOLD AS AIRHOLD1
END
-RUN


 
TABLE FILE RPTHOLD
PRINT AIRLINE
      AROLL_LEV3
      EMB_APT_NM
      FARE_PAID
      FARE_PAY
      GFARE_PAID
      GFARE_PAY
      INTERNET_FLAG
      NAMEC
      REFUSE_CODE
      RTE_APT_NM
      TKT_NUM
      TKT_TYPE
      DPT_TIME
      XDPT_DT
      XTRAN_DT
      TF_TKT2
      AAPD2
      VOIDS
      VOID_DATE
BY PASSNGR_NAME
BY TKT_SORT
BY TRN_DATE
BY SEG_NBR
ON TABLE HOLD AS XTWO
END
-RUN
 
 
MATCH FILE XTWO
PRINT AIRLINE
      AROLL_LEV3
      EMB_APT_NM
      FARE_PAID
      FARE_PAY
      GFARE_PAID
      GFARE_PAY
      INTERNET_FLAG
      NAMEC
      REFUSE_CODE
      RTE_APT_NM
      TKT_NUM
      TKT_TYPE
      DPT_TIME
      XDPT_DT
      XTRAN_DT
      TF_TKT2
      AAPD2
      VOIDS
      VOID_DATE
BY PASSNGR_NAME
BY TKT_SORT
BY TRN_DATE
BY SEG_NBR
ON TABLE HOLD
RUN
FILE AIRHOLD1
SUM GTFARE
      GTFP
      TFARE
      TTKT
      TFP
      TEX
      TPRFD
      TRFD
      TVOID
      TVFP
-**************************IBISTL KR******************
-*      TTRNS
-*****************************************************
BY PASSNGR_NAME
BY TKT_SORT
BY TRN_DATE
AFTER MATCH HOLD AS AIRHOLD2 OLD-OR-NEW
END
-RUN


DEFINE FILE AIRHOLD2
ROLL/A8 = '&&ROLLUP.EVAL';
END
TABLE FILE AIRHOLD2
PRINT AIRLINE
      AROLL_LEV3
      EMB_APT_NM
      FARE_PAID
      FARE_PAY
      GFARE_PAID
      GFARE_PAY
      GTFARE
      GTFP
      INTERNET_FLAG
      NAMEC
      PASSNGR_NAME
      REFUSE_CODE
      RTE_APT_NM
      VOIDS
      TEX
      TFARE
      TFP
      TKT_NUM
      TKT_TYPE
      TPRFD
      TRFD
      TRN_DATE
      TTKT
      TVOID
      VOID_DATE
-*************************IBISTL KR*****************
-*      TTRNS
-***************************************************
      XDPT_DT
      DPT_TIME
      XTRAN_DT
      TF_TKT2
      AAPD2
      TVFP
      ROLL
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD AS AIRHOLD3
END
-RUN
 
 


-IF &&CURRENCY EQ 'USD' THEN GOTO SKIPTHIS;
 
-SET &&DTSTY='DT';
-RUN
 
-SET &&SUBHEAD = <NAMEC;
 
DEFINE FILE AIRHOLD3
PASNGR_NAME/A33 = IF TKT_NUM NE LAST TKT_NUM THEN PASSNGR_NAME ELSE ' ';
REASON_CD/A2 =  IF TKT_NUM NE LAST TKT_NUM THEN REFUSE_CODE ELSE ' ';
TICKET_NMBR/A10 = IF TKT_NUM NE LAST TKT_NUM THEN TKT_NUM ELSE ' ';
XT_DTE/A8 = EDIT(TRN_DATE);
XTKT_SRT/A10 = EDIT(TKT_SORT,'9999999999$');
XTRAN_DTE/MDYY = IF TKT_NUM NE LAST TKT_NUM THEN XTRAN_DT ELSE 0;
 
-* ****DEFINES ON PREVIOUS DEFINES****
SRT_DT/A100 = TKT_SORT||XT_DTE||PASSNGR_NAME;
NET_TKT_CNT/P9S = IF SRT_DT NE LAST SRT_DT THEN TTKT ELSE 0;
NET_TKT_CNT1/P9S = IF SRT_DT NE LAST SRT_DT THEN TEX ELSE 0;
TOTNTKT/P9S= TTKT + TVOID;
NET_TKT_CNT2/P9S = IF SRT_DT NE LAST SRT_DT THEN TOTNTKT ELSE 0;
FRF_CNT/P9S = IF SRT_DT NE LAST SRT_DT THEN TRFD ELSE 0;
PRF_CNT/P9S = IF SRT_DT NE LAST SRT_DT THEN TPRFD ELSE 0;
GFARE_AMT/P16.2CS = IF SRT_DT NE LAST SRT_DT THEN GTFARE ELSE 0;
GFARE_AMT1/P16.2CS = IF SRT_DT NE LAST SRT_DT THEN GTFP ELSE 0;
NOWTOD/A8 WITH TKT_SORT = HHMMSS (NOWTOD);
 
END
 
 
-SET &FARE_CUR = 'FARE,PAID, (' | &&CURRENCY || ')';
TABLE FILE AIRHOLD3
-INCLUDE HEADAIR
"&&SUBHEAD"
"</1"
-*
-*******************************************************************
-* Print statement with fields passed from the user profile database
-*******************************************************************
-*
PRINT
REASON_CD AS 'REASON, CODE'
XDPT_DT AS 'DEPART, DATE' DPT_TIME AS 'TIME'
EMB_APT_NM AS 'ORG'  RTE_APT_NM AS 'DST'
AIRLINE AS 'CR'

-* FARE_AMT AS 'FARE,PAID'
&&FARE AS '&FARE_CUR.EVAL'; 
&&COUNT AS 'TRAN,CNT'
-* NET_TKT_CNT AS 'TRAN,CNT'
-GOTO NEXT;
 
 
 
-SKIPTHIS;
 
 

-SET &&DTSTY= 'DT';

-RUN
JOIN ROLL IN AIRHOLD3 TO ROLLUP_CODE IN ROLLUP_SQL AS J1.
-RUN 
DEFINE FILE AIRHOLD3
PASNGR_NAME/A33 = IF TKT_NUM NE LAST TKT_NUM THEN PASSNGR_NAME ELSE ' ';
REASON_CD/A2 =  IF TKT_NUM NE LAST TKT_NUM THEN REFUSE_CODE ELSE ' ';
TICKET_NMBR/A10 = IF TKT_NUM NE LAST TKT_NUM THEN TKT_NUM ELSE ' ';
XT_DTE/A8 = EDIT(TRN_DATE);
XTKT_SRT/A10 = EDIT(TKT_SORT,'9999999999$');
XTRAN_DTE/MDYY = IF TKT_NUM NE LAST TKT_NUM THEN XTRAN_DT ELSE 0;
 
-* ****DEFINES ON PREVIOUS DEFINES****
SRT_DT/A100 = TKT_SORT||XT_DTE||PASSNGR_NAME;
NET_TKT_CNT/P9S = IF SRT_DT NE LAST SRT_DT THEN TTKT ELSE 0;
NET_TKT_CNT1/P9S = IF SRT_DT NE LAST SRT_DT THEN TEX ELSE 0;
TOTNTKT/P9S= TTKT + TVOID;
NET_TKT_CNT2/P9S = IF SRT_DT NE LAST SRT_DT THEN TOTNTKT ELSE 0;
FRF_CNT/P9S = IF SRT_DT NE LAST SRT_DT THEN TRFD ELSE 0;
PRF_CNT/P9S = IF SRT_DT NE LAST SRT_DT THEN TPRFD ELSE 0;
FARE_AMT/P12.2CS = IF SRT_DT NE LAST SRT_DT THEN TFARE ELSE 0;
FARE_AMT1/P12.2CS = IF SRT_DT NE LAST SRT_DT THEN TFP ELSE 0;
TFAMT/P12.2CS = TFP - TVFP;
TFARE_AMT/P12.2CS = IF SRT_DT NE LAST SRT_DT THEN TFAMT ELSE 0;

  XPSNGR_NM/A15=EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
 
NOWTOD/A8 WITH TKT_SORT = HHMMSS (NOWTOD);
ROLL/A8='&&ROLLUP.EVAL';
LVL/A60='&&LVL_DSC.EVAL';
RPHONE/A15=EDIT(ROLL_PHONE,'9-999-999-9999');
RN/A60=TRIM('B', '&&RPT_TTL1.EVAL', 60, ' ', 1, 'A60');
TDATE1/A8MDYY='&MDYY';
TDATE2/A10=EDIT(TDATE1,'99/99/9999');
TIME1/A8=HHMMSS('A8');
TIME2/A8=EDIT(TIME1,'99$:99$:99');
RD/A10 = 'Run Date:';
RT/A10 = 'Run Time:';
PAX_NAME/A15 = EDIT (PASSNGR_NAME, '999999999999999');
END
 
 
-IF &&OUTFMT NE 'PDF' THEN GOTO EXLFMT;
 
TABLE FILE AIRHOLD3
-INCLUDE HEADAIR
"&&SUBHEAD"
"</1"
-*

-*******************************************************************
-* Print statement with fields passed from the user profile database
-*******************************************************************
-*
PRINT 
-IF &&SETF NE 'VMTRNTF' THEN GOTO NoDivn;
AROLL_LEV3 AS 'DIV'
-NoDivn
REASON_CD AS 'REASON, CODE'
XDPT_DT AS 'DEPART, DATE' DPT_TIME AS 'TIME'
EMB_APT_NM/A17 AS 'ORG'  RTE_APT_NM/A17 AS 'DST'
AIRLINE AS 'CR'
-IF &&SETF NE 'VMTRNTF' THEN GOTO SkipVdate;
VOID_DATE AS 'VOID,DATE'
-SkipVdate
&&FARE AS 'FARE,PAID'
&&COUNT AS 'TRAN,CNT'

 
 
 
 
-NEXT;
-*
-******************************************************************
-* By statements (one per field)
-******************************************************************
-*
 
BY PASSNGR_NAME AS 'PASSENGER NAME'
BY XTKT_SRT NOPRINT
BY TKT_SORT NOPRINT BY TRN_DATE NOPRINT
BY SEG_NBR NOPRINT
BY XDPT_DT NOPRINT BY DPT_TIME NOPRINT
BY XTRAN_DT AS 'TRANSACTION,DATE'
-* BY TICKET_NMBR AS 'TICKET,NUMBER'
BY TKT_NUM AS 'TICKET,NUMBER'
BY TKT_TYPE AS 'TKT,TYPE'
 
-*
&&WHERETF
-******************************************************************
-* On Table statements for code appropriate to On Table commands
-******************************************************************
-*
ON TABLE COLUMN-TOTAL
ON XTKT_SRT SKIP-LINE
ON TABLE PAGE-BREAK AND SUBFOOT


-INCLUDE SBFOOT
 
FOOTING
-INCLUDE FOOTERDT
-******************************************************************
-* Report specific footer(s)
-******************************************************************
ON TABLE SET STYLE *
-INCLUDE &&DTSTY
ENDSTYLE
 
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO NORECORDS;

-TYPE After Report
-GOTO XXIT;

-EXLFMT
 

-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');




TABLE FILE AIRHOLD3
HEADING
"<ROLL_NAME"
"&&ROLLCNCT"
"&&DTDESC"
"&FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
" "
"<RN"
"<LVL"
" "
PRINT 
-IF &&SETF NE 'VMTRNTF' THEN GOTO NoDiv;
AROLL_LEV3 AS 'DIV'
-NoDiv
REASON_CD AS 'REASON, CODE'
XDPT_DT AS 'DEPART, DATE' DPT_TIME AS 'TIME'
EMB_APT_NM  AS 'ORG'  RTE_APT_NM AS 'DST'
AIRLINE AS 'CR'
-IF &&SETF NE 'VMTRNTF' THEN GOTO SkipVdatE;
VOID_DATE AS 'VOID,DATE'
-SkipVdatE
&&FARE AS 'FARE,PAID'
&&COUNT AS 'TRAN,CNT'

 
 
 
 
-NEXT;
-*
-******************************************************************
-* By statements (one per field)
-******************************************************************
-*
 
BY PASSNGR_NAME AS 'PASSENGER NAME'
BY XTKT_SRT NOPRINT
BY TKT_SORT NOPRINT BY TRN_DATE NOPRINT
BY SEG_NBR NOPRINT
BY XDPT_DT NOPRINT BY DPT_TIME NOPRINT
BY XTRAN_DT AS 'TRANSACTION,DATE'
-* BY TICKET_NMBR AS 'TICKET,NUMBER'
BY TKT_NUM AS 'TICKET,NUMBER'
BY TKT_TYPE AS 'TKT,TYPE'
 
-*
&&WHERETF
-******************************************************************
-* On Table statements for code appropriate to On Table commands
-******************************************************************
-*
ON TABLE COLUMN-TOTAL
ON XTKT_SRT SKIP-LINE
ON TABLE PAGE-BREAK AND SUBFOOT
" "
-INCLUDE SBFOOT
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.050000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
    
TYPE=REPORT, FONT='ARIAL', SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=HEADING, SIZE=8,  STYLE=BOLD, FONT='ARIAL', COLOR=RGB(31 114 164), BACKCOLOR=NONE, $
TYPE=HEADING, HEADALIGN=BODY, $
TYPE=HEADING, LINE=1, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=2, COLSPAN=3, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=3, COLSPAN=15,  JUSTIFY=LEFT, $
TYPE=HEADING, LINE=4, COLSPAN=15, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=5, COLSPAN=3, JUSTIFY=LEFT,  $
TYPE=HEADING, LINE=6, COLSPAN=15, JUSTIFY=CENTER, $

TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8,
     COLOR='WHITE',
     BACKCOLOR=RGB(31 114 164),
     STYLE=BOLD,$
     
-* TYPE=DATA, BACKCOLOR=RGB(242 242 242), WHEN=XTS_FLAG EQ 'Y', $      
   TYPE=DATA, BACKCOLOR=( RGB(239 239 239) 'WHITE'), $

-* TYPE=SKIPLINE, BACKCOLOR=RGB(242 242 242), $
-* $

    
TYPE=TABFOOTING, FONT=ARIAL, COLOR=GRAY,$
     
-* TYPE=FOOTING, FONT=ARIAL, COLOR=GRAY,$
TYPE=FOOTING, LINE=&FTR_DateTimeLine, STYLE=BOLD,POSITION=(&FTR_DatePosit),$ 


TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=8, STYLE=BOLD, $
 
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
-IF &RECORDS EQ 0 THEN GOTO NORECORDS;
-*
-TYPE After Report
-GOTO XXIT;
 
-NOFILE
-HTMLFORM BEGIN
<HTML>
<HEAD>
 
</HEAD>
<BODY>
 
 
<TITLE> TRAVEL & TRANSPORT</TITLE>
<CENTER><H2>THE REPORT IS NO LONGER DRILLABLE!!!</H2></CENTER>
 
<CENTER><H4>PLEASE GO BACK TO THE PREVIOUS PAGE USING </H4></CENTER>
<CENTER><H3>BACK BUTTON OF THE BROWSER</H3></CENTER>
 
</BODY>
</HTML>
-HTMLFORM END
-GOTO XXIT;
 
-NORECORDS
-HTMLFORM BEGIN
<HTML>
<HEAD>
 
</HEAD>
<BODY>
 
 
<TITLE> TRAVEL & TRANSPORT</TITLE>
<CENTER><H2>NO RECORDS FOUND FOR THIS SELECTION!!!</H2></CENTER>
 
<CENTER><H4>PLEASE GO BACK TO THE PREVIOUS PAGE USING </H4></CENTER>
<CENTER><H3>BACK BUTTON OF THE BROWSER</H3></CENTER>
 
</BODY>
</HTML>
-HTMLFORM END
 
 
-XXIT
