-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Created for the new quarterly review -  DV
-******************************************************************************
-INCLUDE SETECHO
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

-SET &POS0=0;
-SET &INC = 11;
-SET &POS1T = &POS0 + 1 * &INC;

-SET &POS1 = &POS1T + 0;
-SET &POS2 = &POS1T + 6;
-SET &POS3 = &POS1T + 12;
-SET &POS4 = &POS1T + 18;
-SET &POS5 = &POS1T + 24;
-SET &POS6 = &POS1T + 30;
-SET &POS7 = &POS1T + 36;
-SET &POS8 = &POS1T + 42;

-SET &POS1A = &POS1 - 1;
-SET &POS2A = &POS2 - 1;
-SET &POS3A = &POS3 - 1;
-SET &POS4A = &POS4 - 1;
-SET &POS5A = &POS5 - 1;
-SET &POS6A = &POS6 - 1;
-SET &POS7A = &POS7 - 1;
-SET &POS8A = &POS8 - 1;

-SET &POSI1 = &POS0 + 69;
-SET &POSI2 = &POSI1 + 6;
-SET &POSI3 = &POSI2 + 6;
-SET &POSI4 = &POSI3 + 6;
-SET &POSI5 = &POSI4 + 6;
-SET &POSI6 = &POSI5 + 6;
-SET &POSI7 = &POSI6 + 6;
-SET &POSI8 = &POSI7 + 6;

-SET &POSI1A = &POSI1 - 1;
-SET &POSI2A = &POSI2 - 1;
-SET &POSI3A = &POSI3 - 1;
-SET &POSI4A = &POSI4 - 1;
-SET &POSI5A = &POSI5 - 1;
-SET &POSI6A = &POSI6 - 1;
-SET &POSI7A = &POSI7 - 1;
-SET &POSI8A = &POSI8 - 1;


-* YTD

-SET &POSYD1 = &POS0 + 82;
-SET &POSYD2 = &POSYD1 + 7;
-SET &POSYD3 = &POSYD2 + 7;
-SET &POSYD4 = &POSYD3 + 7;
-SET &POSYD5 = &POSYD4 + 6;
-SET &POSYD6 = &POSYD5 + 8;
-SET &POSYD7 = &POSYD6 + 6;
-SET &POSYD8 = &POSYD7 + 6;


-SET &POSYD1A = &POSYD1 - 1;
-SET &POSYD2A = &POSYD2 - 1;
-SET &POSYD3A = &POSYD3 - 1;
-SET &POSYD4A = &POSYD4 - 1;
-SET &POSYD5A = &POSYD5 - 1;
-SET &POSYD6A = &POSYD6 - 1;
-SET &POSYD7A = &POSYD7 - 1;
-SET &POSYD8A = &POSYD8 - 1;

-* Set up Base roll variables
-SET &TD1 = ' ';
-SET &TD2 = ' ';
-SET &TD3 = ' ';
-SET &TD4 = ' ';
-SET &TD5 = ' ';
-SET &TD6 = ' ';
-SET &TD7 = ' ';
-SET &TD8 = ' ';
-SET &BAVGD1 = ' ';
-SET &BAVGD2 = ' ';
-SET &BAVGD3 = ' ';
-SET &BAVGD4 = ' ';
-SET &BAVGD5 = ' ';
-SET &BAVGD6 = ' ';
-SET &BAVGD7 = ' ';
-SET &BAVGD8 = ' ';
-SET &BAVGI1 = ' ';
-SET &BAVGI2 = ' ';
-SET &BAVGI3 = ' ';
-SET &BAVGI4 = ' ';
-SET &BAVGI5 = ' ';
-SET &BAVGI6 = ' ';
-SET &BAVGI7 = ' ';
-SET &BAVGI8 = ' ';
-SET &BAVGC1 = ' ';
-SET &BAVGC2 = ' ';
-SET &BAVGC3 = ' ';
-SET &BAVGC4 = ' ';
-SET &BAVGC5 = ' ';
-SET &BAVGC6 = ' ';
-SET &BAVGC7 = ' ';
-SET &BAVGC8 = ' ';
-* Set up Peer group variables

-SET &PAVGD1 = ' ';
-SET &PAVGD2 = ' ';
-SET &PAVGD3 = ' ';
-SET &PAVGD4 = ' ';
-SET &PAVGD5 = ' ';
-SET &PAVGD6 = ' ';
-SET &PAVGD7 = ' ';
-SET &PAVGD8 = ' ';
-SET &PAVGI1 = ' ';
-SET &PAVGI2 = ' ';
-SET &PAVGI3 = ' ';
-SET &PAVGI4 = ' ';
-SET &PAVGI5 = ' ';
-SET &PAVGI6 = ' ';
-SET &PAVGI7 = ' ';
-SET &PAVGI8 = ' ';
-SET &PAVGC1 = ' ';
-SET &PAVGC2 = ' ';
-SET &PAVGC3 = ' ';
-SET &PAVGC4 = ' ';
-SET &PAVGC5 = ' ';
-SET &PAVGC6 = ' ';
-SET &PAVGC7 = ' ';
-SET &PAVGC8 = ' ';
-* Set up Topaz variables

-SET &TAVGD1 = ' ';
-SET &TAVGD2 = ' ';
-SET &TAVGD3 = ' ';
-SET &TAVGD4 = ' ';
-SET &TAVGD5 = ' ';
-SET &TAVGD6 = ' ';
-SET &TAVGD7 = ' ';
-SET &TAVGD8 = ' ';
-SET &TAVGI1 = ' ';
-SET &TAVGI2 = ' ';
-SET &TAVGI3 = ' ';
-SET &TAVGI4 = ' ';
-SET &TAVGI5 = ' ';
-SET &TAVGI6 = ' ';
-SET &TAVGI7 = ' ';
-SET &TAVGI8 = ' ';
-SET &TAVGC1 = ' ';
-SET &TAVGC2 = ' ';
-SET &TAVGC3 = ' ';
-SET &TAVGC4 = ' ';
-SET &TAVGC5 = ' ';
-SET &TAVGC6 = ' ';
-SET &TAVGC7 = ' ';
-SET &TAVGC8 = ' ';

-* initialize graph variables
-SET &G_IATP = 'N';
-SET &G_DATP = 'N';
-SET &G_CATP = 'N';

-INCLUDE GETTOPAZ
-RUN

-* Put Topaz data into database with baseroll data
MODIFY FILE QRATP2
FIXFORM ROLLUP_CODE/8 YEAR/4 TRAN/7 AVGD/6 AVGI/6 AVGC/6 CURRENT/1 PRIOR/1 PYTD/1 PQ/1 CQ/1
MATCH ROLLUP_CODE YEAR TRAN
ON NOMATCH INCLUDE
DATA ON SAVE
END
-RUN

-* Put Peer data into database with Baseroll and Topaz

DEFINE FILE QRATP4
ROLL/A8 = IF ROLLUP_CODE EQ '&&BASEROLL.EVAL' THEN '&&BASEROLL.EVAL' ELSE
          'PEER-R';
END
TABLE FILE QRATP4
SUM FARE_PAID NET_TKT_CNT DFARE DTKTS IFARE ITKTS
CURRENT PRIOR PYTD PQ CQ
BY ROLL 
BY YEAR
BY TRAN
WHERE ROLL EQ 'PEER-R'
ON TABLE HOLD AS PHOLD
END
-RUN


-IF &LINES EQ 0 THEN GOTO NOPEER;

TABLE FILE PHOLD
SUM
COMPUTE AVGD/D8.2 = IF ((DTKTS LT 1) AND (DTKTS GT (-1))) THEN 0 ELSE
                           (DFARE/DTKTS);
COMPUTE AVGI/D8.2 = IF ((ITKTS LT 1) AND (ITKTS GT (-1))) THEN 0 ELSE
                           (IFARE/ITKTS);

COMPUTE AVGC/D8.2 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                          (FARE_PAID/NET_TKT_CNT);
      
CURRENT PRIOR PYTD PQ CQ      
BY ROLL AS 'ROLLUP_CODE'
BY YEAR
BY TRAN 
ON TABLE HOLD AS PHOLD1
END
-RUN

TABLE FILE PHOLD1
PRINT AVGD  
      AVGI  
      AVGC  
CURRENT PRIOR PYTD PQ CQ      
BY ROLLUP_CODE
BY YEAR
BY TRAN
ON TABLE SAVE 
END
-RUN


MODIFY FILE QRATP2
FIXFORM ROLLUP_CODE/8 YEAR/4 TRAN/7 AVGD/8 AVGI/8 AVGC/8 CURRENT/1 PRIOR/1 PYTD/1 PQ/1 CQ/1
MATCH ROLLUP_CODE YEAR TRAN
ON NOMATCH INCLUDE
DATA ON SAVE
END
-RUN

-NOPEER
TABLE FILE QRATP2
PRINT AVGD
      AVGI
      AVGC
BY ROLLUP_CODE
BY YEAR
BY TRAN
-*WHERE PRIOR EQ 'Y' OR CURRENT EQ 'Y'
ON TABLE HOLD AS GHOLD1
END
-RUN

DEFINE FILE GHOLD1
BAVGD/D6 = IF ( ROLLUP_CODE EQ '&&BASEROLL.EVAL') THEN AVGD ELSE 0;
BAVGI/D6 = IF ( ROLLUP_CODE EQ '&&BASEROLL.EVAL') THEN AVGI ELSE 0;
BAVGC/D6 = IF ( ROLLUP_CODE EQ '&&BASEROLL.EVAL') THEN AVGC ELSE 0;
TAVGD/D6 = IF ( ROLLUP_CODE EQ 'TOPAZ-R') THEN AVGD ELSE 0;
TAVGI/D6 = IF ( ROLLUP_CODE EQ 'TOPAZ-R') THEN AVGI ELSE 0;
TAVGC/D6 = IF ( ROLLUP_CODE EQ 'TOPAZ-R') THEN AVGC ELSE 0;
PAVGD/D6 = IF ( ROLLUP_CODE EQ 'PEER-R') THEN AVGD ELSE 0;
PAVGI/D6 = IF ( ROLLUP_CODE EQ 'PEER-R') THEN AVGI ELSE 0;
PAVGC/D6 = IF ( ROLLUP_CODE EQ 'PEER-R') THEN AVGC ELSE 0;
END
TABLE FILE GHOLD1
SUM BAVGD 
    BAVGI 
    BAVGC 
    PAVGD 
    PAVGI 
    PAVGC 
    TAVGD 
    TAVGI 
    TAVGC 
BY TRAN
ON TABLE SAVE AS ALLATP
END
-RUN

-IF &LINES EQ 0 THEN GOTO NOATP;

-SET &CNT = 1;
-REPEAT BASEEND &LINES TIMES
-READ ALLATP NOCLOSE  &TRAN.7. &BAVGD.6. &BAVGI.6. &BAVGC.6. &PAVGD.6. &PAVGI.6. &PAVGC.6. &TAVGD.6. &TAVGI.6. &TAVGC.6.
-SET &TD.&CNT = &TRAN;
-SET &BAVGD.&CNT = FTOA(&BAVGD, '(D6M)', 'A8');
-SET &BAVGI.&CNT = FTOA(&BAVGI, '(D6M)', 'A8');
-SET &BAVGC.&CNT = FTOA(&BAVGC, '(D6M)', 'A8');
-SET &PAVGD.&CNT = FTOA(&PAVGD, '(D6M)', 'A8');
-SET &PAVGI.&CNT = FTOA(&PAVGI, '(D6M)', 'A8');
-SET &PAVGC.&CNT = FTOA(&PAVGC, '(D6M)', 'A8');
-SET &TAVGD.&CNT = FTOA(&TAVGD, '(D6M)', 'A8');
-SET &TAVGI.&CNT = FTOA(&TAVGI, '(D6M)', 'A8');
-SET &TAVGC.&CNT = FTOA(&TAVGC, '(D6M)', 'A8');

-SET &CNT = &CNT + 1;
-BASEEND
-CLOSE BASEHLD2

-* Graph

TABLE FILE GHOLD1
SUM BAVGD 
    BAVGI 
    BAVGC 
    PAVGD 
    PAVGI 
    PAVGC 
    TAVGD 
    TAVGI 
    TAVGC 
BY TRAN
ON TABLE HOLD AS GHOLD2 
END
-RUN

-IF &&SKIPGRAPH EQ 'Y' OR &LINES EQ 0 THEN GOTO AROUNDGD;

-* -GOTO AROUNDGD;
-* Domestic ATP graph


GRAPH FILE GHOLD2
PRINT BAVGD AS 'Company'
    TAVGD AS 'Topaz'
    PAVGD AS 'Peer Group'
ACROSS TRAN AS ' '
ON GRAPH SET 3D OFF
ON GRAPH SET GRAPHSTYLE *
setGraphType(41);
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(1, new Color, 145 207 255));
setSeriesFillColor(2, new Color, 125 0 0));
setSeriesFillColor(3, new Color, 160 0 181));
setSeriesFillColor(4, new Color, 255 255 128));
setMarkerDisplay(true);
setUseSeriesShapes(true);
setConnectLineMarkers(true);
setSeriesType(2,2);
setSeriesType(3,2);
setSeriesType(4,2);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setY2MajorGridDisplay(false);
setY2MinorGridDisplay(false);
setO1LabelRotate(0);
setPieFeelerTextDisplay(1);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(2);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(1);
setLegendTextAutofix(true);
setLegendMarkersPerRow(3);
setTitleString("Domestic Average Ticket Price");
setSubtitleString(" ");
setY1LabelDisplay(true);
setY1LabelFormat(6);
setY2LabelDisplay(true);
setY2LabelFormat(6);
setY1AxisSide(0);
setY2AxisSide(1);
setFontSizeAbsolute(getTitle(),false); 
setAutofit(getTitle(),true);

setTextJustHoriz(getTitle(),1);
setFontSizeAbsolute(getTitle(),true); 
setFontStyle(getTitle(),0);
setFontSize(getTitle(),12);

setFontSizeAbsolute(getSubtitle(),true); 
setAutofit(getSubtitle(),false);
setTextJustHoriz(getSubtitle(),1);
setFontStyle(getSubtitle(),1);
setFontSize(getSubtitle(),20);
setFontSizeAbsolute(getLegendText(),true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
ON GRAPH HOLD AS DATP FORMAT SVG
END
-RUN
-SET &G_DATP=IF &LINES GT 0 THEN 'Y' ELSE 'N';
-AROUNDGD

-IF &&SKIPGRAPH EQ 'Y' OR &LINES EQ 0 THEN GOTO AROUNDGI;
-* -GOTO AROUNDGI;
-* International ATP graph

GRAPH FILE GHOLD2
PRINT BAVGI AS 'Company'
      TAVGI AS 'Topaz'
      PAVGI AS 'Peer Group'
ACROSS TRAN AS ' '
ON GRAPH SET 3D OFF
ON GRAPH SET GRAPHSTYLE *
setGraphType(41);
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(1, new Color, 145 207 255));
setSeriesFillColor(2, new Color, 125 0 0));
setSeriesFillColor(3, new Color, 160 0 181));
setSeriesFillColor(4, new Color, 255 255 128));
setMarkerDisplay(true);
setUseSeriesShapes(true);
setConnectLineMarkers(true);
setSeriesType(2,2);
setSeriesType(3,2);
setSeriesType(4,2);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setY2MajorGridDisplay(false);
setY2MinorGridDisplay(false);
setO1LabelRotate(0);
setPieFeelerTextDisplay(1);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(2);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(1);
setLegendTextAutofix(true);
setLegendMarkersPerRow(3);
setTitleString("International Average Ticket Price");
setSubtitleString(" ");
setY1LabelDisplay(true);
setY1LabelFormat(6);
setY2LabelDisplay(true);
setY2LabelFormat(6);
setY1AxisSide(0);
setY2AxisSide(1);
setFontSizeAbsolute(getTitle(),false); 
setAutofit(getTitle(),true);

setTextJustHoriz(getTitle(),1);
setFontSizeAbsolute(getTitle(),true); 
setFontStyle(getTitle(),0);
setFontSize(getTitle(),12);

setAutofit(getSubtitle(),false);
setTextJustHoriz(getSubtitle(),1);
setFontStyle(getSubtitle(),1);
setFontSize(getSubtitle(),20);
setFontSizeAbsolute(getLegendText(),true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
ON GRAPH HOLD AS IATP FORMAT SVG
END
-RUN
-SET &G_IATP=IF &LINES GT 0 THEN 'Y' ELSE 'N';
-AROUNDGI


-IF &&SKIPGRAPH EQ 'Y' OR &LINES EQ 0 THEN GOTO AROUNDGC;
-* Combined ATP Graph
GRAPH FILE GHOLD2
PRINT BAVGC AS 'Company'
      TAVGC AS 'Topaz'
      PAVGC AS 'Peer Group'
ACROSS TRAN AS ' '
ON GRAPH SET 3D OFF
ON GRAPH SET GRAPHSTYLE *
setGraphType(41);
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(1, new Color, 145 207 255));
setSeriesFillColor(2, new Color, 125 0 0));
setSeriesFillColor(3, new Color, 160 0 181));
setSeriesFillColor(4, new Color, 255 255 128));
setMarkerDisplay(true);
setUseSeriesShapes(true);
setConnectLineMarkers(true);
setSeriesType(2,2);
setSeriesType(3,2);
setSeriesType(4,2);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setY2MajorGridDisplay(false);
setY2MinorGridDisplay(false);
setO1LabelRotate(0);
setPieFeelerTextDisplay(1);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(2);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(1);
setLegendTextAutofix(true);
setLegendMarkersPerRow(3);
setTitleString("Combined Average Ticket Price");
setSubtitleString(" ");
setY1LabelDisplay(true);
setY1LabelFormat(6);
setY2LabelDisplay(true);
setY2LabelFormat(6);
setY1AxisSide(0);
setY2AxisSide(1);
setFontSizeAbsolute(getTitle(),false); 

setAutofit(getTitle(),true);
setTextJustHoriz(getTitle(),1);
setFontSizeAbsolute(getTitle(),true); 
setFontStyle(getTitle(),0);
setFontSize(getTitle(),12);

setAutofit(getSubtitle(),false);
setTextJustHoriz(getSubtitle(),1);
setFontStyle(getSubtitle(),1);
setFontSize(getSubtitle(),20);
setFontSizeAbsolute(getLegendText(),true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
ON GRAPH HOLD AS CATP FORMAT SVG
END
-RUN
-SET &G_CATP=IF &LINES GT 0 THEN 'Y' ELSE 'N';
-AROUNDGC
-*********************************************************
-NOATP;


-SET &B1AVGD1 = 0;
-SET &B1AVGI1 = 0;
-SET &B1AVGC1 = 0;
-SET &B1AVGDA1 = ' ';
-SET &B1AVGIA1 = ' ';
-SET &B1AVGCA1 = ' ';
-SET &B1AVGD2 = 0;
-SET &B1AVGI2 = 0;
-SET &B1AVGC2 = 0;
-SET &B1AVGDA2 = ' ';
-SET &B1AVGIA2 = ' ';
-SET &B1AVGCA2 = ' ';
-SET &P1AVGD1 = 0;
-SET &P1AVGI1 = 0;
-SET &P1AVGC1 = 0;
-SET &P1AVGDA1 = ' ';
-SET &P1AVGIA1 = ' ';
-SET &P1AVGCA1 = ' ';
-SET &P1AVGD2 = 0;
-SET &P1AVGI2 = 0;
-SET &P1AVGC2 = 0;
-SET &P1AVGDA2 = ' ';
-SET &P1AVGIA2 = ' ';
-SET &P1AVGCA2 = ' ';
-SET &T1AVGD1 = 0;
-SET &T1AVGI1 = 0;
-SET &T1AVGC1 = 0;
-SET &T1AVGDA1 = ' ';
-SET &T1AVGIA1 = ' ';
-SET &T1AVGCA1 = ' ';
-SET &T1AVGD2 = 0;
-SET &T1AVGI2 = 0;
-SET &T1AVGC2 = 0;
-SET &T1AVGDA2 = ' ';
-SET &T1AVGIA2 = ' ';
-SET &T1AVGCA2 = ' ';
-SET &YEAR1 = ' ';
-SET &YEAR2 = ' ';

-*Retrieve Base Roll and Peer ATP YTD
TABLE FILE QRATP2
BY TRAN
WHERE ROLLUP_CODE EQ '&&BASEROLL.EVAL' AND PRIOR EQ 'Y'
ON TABLE HOLD
END
-RUN
-SET &PYTD = IF &LINES EQ 4 THEN 'Y' ELSE 'N';

DEFINE FILE QRATP4
ROLL/A8 = IF ROLLUP_CODE EQ '&&BASEROLL.EVAL' THEN '&&BASEROLL.EVAL' ELSE
          'PEER-R';
END
TABLE FILE QRATP4
SUM FARE_PAID
    NET_TKT_CNT
    DFARE
    DTKTS
    IFARE
    ITKTS
COMPUTE AVGD/D8.2 = IF ((DTKTS LT 1) AND (DTKTS GT (-1))) THEN 0 ELSE
                           (DFARE/DTKTS);
COMPUTE AVGI/D8.2 = IF ((ITKTS LT 1) AND (ITKTS GT (-1))) THEN 0 ELSE
                           (IFARE/ITKTS);

COMPUTE AVGC/D8.2 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                          (FARE_PAID/NET_TKT_CNT);                         
BY ROLL
BY YEAR
WHERE CURRENT EQ 'Y' OR PYTD EQ 'Y'
ON TABLE HOLD AS YTDATP
END
-RUN

DEFINE FILE YTDATP
B1AVGD/D6 = IF ROLL EQ '&&BASEROLL.EVAL' THEN AVGD ELSE 0;
B1AVGI/D6 = IF ROLL EQ '&&BASEROLL.EVAL' THEN AVGI ELSE 0;
B1AVGC/D6 = IF ROLL EQ '&&BASEROLL.EVAL' THEN AVGC ELSE 0;
P1AVGD/D6 = IF ROLL EQ 'PEER-R' THEN AVGD ELSE 0;
P1AVGI/D6 = IF ROLL EQ 'PEER-R' THEN AVGI ELSE 0;
P1AVGC/D6 = IF ROLL EQ 'PEER-R' THEN AVGC ELSE 0;
END
TABLE FILE YTDATP
SUM B1AVGD B1AVGI B1AVGC P1AVGD P1AVGI P1AVGC
BY YEAR
ON TABLE HOLD AS YTDATP1
END
-RUN

-*Retrieve TOPAZ ATP YTD
TABLE FILE QRATP2
SUM AVE.AVGD AVE.AVGI AVE.AVGC
BY YEAR
WHERE CURRENT EQ 'Y' OR PYTD EQ 'Y'
WHERE ROLLUP_CODE EQ 'TOPAZ-R'
ON TABLE HOLD AS TOPAZYTD1
END
-RUN

TABLE FILE TOPAZYTD1
PRINT AVGD/D6 AS 'T1AVGD'
      AVGI/D6 AS 'T1AVGI'
      AVGC/D6 AS 'T1AVGC'
BY YEAR
ON TABLE HOLD AS TPZYTD2
END
-RUN

-* Combine Topaz YTD Baseroll YTD and Peer YTD into 1 file

MATCH FILE TPZYTD2
PRINT T1AVGD
      T1AVGI
      T1AVGC
BY YEAR
RUN
FILE YTDATP1
SUM B1AVGD
    B1AVGI
    B1AVGC
    P1AVGD
    P1AVGI
    P1AVGC
BY YEAR
AFTER MATCH HOLD AS YTDATP2 OLD-OR-NEW
END
-RUN

TABLE FILE YTDATP2
PRINT B1AVGD B1AVGI B1AVGC P1AVGD P1AVGI P1AVGC T1AVGD T1AVGI T1AVGC
BY YEAR
ON TABLE SAVE AS YRATP
END
-RUN

-IF &LINES EQ 0 THEN GOTO NOYTD;

-SET &CNT = 0;
-REPEAT TOYREND &LINES TIMES
-READ YRATP NOCLOSE &YEAR.4. &B1AVGD.6. &B1AVGI.6. &B1AVGC.6. &P1AVGD.6. &P1AVGI.6. &P1AVGC.6. &T1AVGD.6. &T1AVGI.6. &T1AVGC.6.
-SET &CNT = &CNT + 1;
-SET &YEAR.&CNT = &YEAR;
-SET &B1AVGD.&CNT = &B1AVGD;
-SET &B1AVGI.&CNT = &B1AVGI;
-SET &B1AVGC.&CNT = &B1AVGC;
-SET &B1AVGDA.&CNT = FTOA(&B1AVGD, '(D6M)', 'A8');
-SET &B1AVGIA.&CNT = FTOA(&B1AVGI, '(D6M)', 'A8');
-SET &B1AVGCA.&CNT = FTOA(&B1AVGC, '(D6M)', 'A8');
-SET &P1AVGD.&CNT = &P1AVGD;
-SET &P1AVGI.&CNT = &P1AVGI;
-SET &P1AVGC.&CNT = &P1AVGC;
-SET &P1AVGDA.&CNT = FTOA(&P1AVGD, '(D6M)', 'A8');
-SET &P1AVGIA.&CNT = FTOA(&P1AVGI, '(D6M)', 'A8');
-SET &P1AVGCA.&CNT = FTOA(&P1AVGC, '(D6M)', 'A8');
-SET &T1AVGD.&CNT = &T1AVGD;
-SET &T1AVGI.&CNT = &T1AVGI;
-SET &T1AVGC.&CNT = &T1AVGC;
-SET &T1AVGDA.&CNT = FTOA(&T1AVGD, '(D6M)', 'A8');
-SET &T1AVGIA.&CNT = FTOA(&T1AVGI, '(D6M)', 'A8');
-SET &T1AVGCA.&CNT = FTOA(&T1AVGC, '(D6M)', 'A8');
-TOYREND
-CLOSE YRATP


-NOYTD

-*Calculate ATP variations Last Q over Last Q


-SET &B2AVGD1 = 0;
-SET &B2AVGI1 = 0;
-SET &B2AVGC1 = 0;
-SET &B2AVGD2 = 0;
-SET &B2AVGI2 = 0;
-SET &B2AVGC2 = 0;
-SET &P2AVGD1 = 0;
-SET &P2AVGI1 = 0;
-SET &P2AVGC1 = 0;
-SET &P2AVGD2 = 0;
-SET &P2AVGI2 = 0;
-SET &P2AVGC2 = 0;
-SET &T2AVGD1 = 0;
-SET &T2AVGI1 = 0;
-SET &T2AVGC1 = 0;
-SET &T2AVGD2 = 0;
-SET &T2AVGI2 = 0;
-SET &T2AVGC2 = 0;
-SET &TRAN1 = ' ';
-SET &TRAN2 = ' ';

-*to calculate the comparison current Q to prior Q
-SET &BAVGDL1 = ' ';
-SET &BAVGDL2 = ' ';

TABLE FILE QRATP2 
BY TRAN 
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
WHERE ROLL EQ '&&BASEROLL.EVAL'
ON TABLE SAVE
END
-RUN

-IF &LINES LT 2 THEN GOTO NoPQtr;
-SET &NOQTRCOMP =  IF &LINES EQ 2 THEN 'Y' ELSE 'N';

-GOTO chktopaz;
-NoPQtr;
-SET &NOQTRCOMP = 'Y';

-chktopaz
TABLE FILE QRATP2 
BY TRAN
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
WHERE ROLL EQ 'TOPAZ-R'
ON TABLE SAVE
END
-RUN

-READ SAVE NOCLOSE &Y1LSTTRAN.7.
-READ SAVE &Y2LSTTRAN.7.
-SET &NOTOPCOMP = IF &LINES EQ 2 THEN 'Y' ELSE 'N';

TABLE FILE QRATP2 
SUM TRAN AVGD AVGI AVGC
BY ROLL
BY YEAR 
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
ON TABLE HOLD AS LQATP
END
-RUN


DEFINE FILE LQATP
B2AVGD/D6 = IF ROLL EQ '&&BASEROLL.EVAL' THEN AVGD ELSE 0;
B2AVGI/D6 = IF ROLL EQ '&&BASEROLL.EVAL' THEN AVGI ELSE 0;
B2AVGC/D6 = IF ROLL EQ '&&BASEROLL.EVAL' THEN AVGC ELSE 0;
P2AVGD/D6 = IF ROLL EQ 'PEER-R' THEN AVGD ELSE 0;
P2AVGI/D6 = IF ROLL EQ 'PEER-R' THEN AVGI ELSE 0;
P2AVGC/D6 = IF ROLL EQ 'PEER-R' THEN AVGC ELSE 0;
T2AVGD/D6 = IF ROLL EQ 'TOPAZ-R' THEN AVGD ELSE 0;
T2AVGI/D6 = IF ROLL EQ 'TOPAZ-R' THEN AVGI ELSE 0;
T2AVGC/D6 = IF ROLL EQ 'TOPAZ-R' THEN AVGC ELSE 0;
END
TABLE FILE LQATP
SUM B2AVGD
    B2AVGI
    B2AVGC
    P2AVGD
    P2AVGI
    P2AVGC
    T2AVGD
    T2AVGC
    T2AVGI
BY TRAN
ON TABLE SAVE AS LQATP1
END
-RUN

-IF &LINES EQ 0 THEN GOTO NOQTR;

-SET &CNT = 0;
-REPEAT LQTREND &LINES TIMES
-READ LQATP1 NOCLOSE  &TRAN.7. &B2AVGD.6. &B2AVGI.6. &B2AVGC.6. &P2AVGD.6. &P2AVGI.6. &P2AVGC.6. &T2AVGD.6. &T2AVGI.6. &T2AVGC.6.
-SET &CNT = &CNT + 1;
-SET &B2AVGD.&CNT = &B2AVGD;
-SET &B2AVGI.&CNT = &B2AVGI;
-SET &B2AVGC.&CNT = &B2AVGC;
-SET &P2AVGD.&CNT = &P2AVGD;
-SET &P2AVGI.&CNT = &P2AVGI;
-SET &P2AVGC.&CNT = &P2AVGC;
-SET &T2AVGD.&CNT = &T2AVGD;
-SET &T2AVGI.&CNT = &T2AVGI;
-SET &T2AVGC.&CNT = &T2AVGC;
-SET &TRAN.&CNT = &TRAN;
-LQTREND
-CLOSE LQATP1

-NOQTR

-SET &BYAVGD = 0;
-SET &BYAVGI = 0;
-SET &BQAVGD = 0;
-SET &BQAVGI = 0;
-SET &BQATPD = 0;
-SET &PYAVGD = 0;
-SET &PYAVGI = 0;
-SET &TYAVGD = 0;
-SET &TYAVGI = 0;
-SET &TQAVGD = 0;
-SET &TQAVGI = 0;
-SET &TQATPD = 0;
-SET &ABSBQD = 0;
-SET &ABSBQC = 0;
-SET &ABSTQD = 0;
-SET &ABSTQC = 0;

DEFINE FILE BRPTINST
  BYAVGD/D6 = IF ((&B1AVGD2 LT 1) AND (&B1AVGD2 GT (-1))) THEN 0 ELSE
                 (((&B1AVGD2 - &B1AVGD1)/&B1AVGD1) * 100);
  BYAVGI/D6 = IF ((&B1AVGI2 LT 1) AND (&B1AVGI2 GT (-1))) THEN 0 ELSE
                 (((&B1AVGI2 - &B1AVGI1)/&B1AVGI1) * 100);
  BQAVGD/D6 = IF ((&B2AVGD2 LT 1) AND (&B2AVGD2 GT (-1))) THEN 0 ELSE
                 (((&B2AVGD2 - &B2AVGD1)/&B2AVGD1) * 100);
  BQAVGI/D6 = IF ((&B2AVGI2 LT 1) AND (&B2AVGI2 GT (-1))) THEN 0 ELSE
                 (((&B2AVGI2 - (&B2AVGI1))/(&B2AVGI1)) * 100);
  BQATPD/D6 = ((&B2AVGD2) - (&B2AVGD1));
  
  PYAVGD/D6 = IF ((&P1AVGD2 LT 1) AND (&P1AVGD2 GT (-1))) THEN 0 ELSE
                 (((&P1AVGD2 - &P1AVGD1)/&P1AVGD1) * 100);
  PYAVGI/D6 = IF ((&P1AVGI2 LT 1) AND (&P1AVGI2 GT (-1))) THEN 0 ELSE
                 (((&P1AVGI2 - &P1AVGI1)/&P1AVGI1) * 100);
  
  TYAVGD/D6 = IF ((&T1AVGD2 LT 1) AND (&T1AVGD2 GT (-1))) THEN 0 ELSE
                   (((&T1AVGD2 - &T1AVGD1)/&T1AVGD1) * 100);
  TYAVGI/D6 = IF ((&T1AVGI2 LT 1) AND (&T1AVGI2 GT (-1))) THEN 0 ELSE
                   (((&T1AVGI2 - &T1AVGI1)/&T1AVGI1) * 100);
  TQAVGD/D6 = IF ((&T2AVGD2 LT 1) AND (&B2AVGD2 GT (-1))) THEN 0 ELSE
                   (((&T2AVGD2 - &T2AVGD1)/&T2AVGD1) * 100);
  TQAVGI/D6 = IF ((&T2AVGI2 LT 1) AND (&T2AVGI2 GT (-1))) THEN 0 ELSE
                 (((&T2AVGI2 - &T2AVGI1)/&T2AVGI1) * 100);
  TQATPD/D6 = ((&T2AVGD2) - (&T2AVGD1));


  ABSBQD/D6 = ABS(BQAVGD);
  ABSBQC/D6 = ABS(BQATPD);
  ABSTQD/D6 = ABS(TQAVGD);
  ABSTQC/D6 = ABS(TQATPD);
  FLAG/A1 = IF &B2AVGD1 EQ 0 THEN 'Y' ELSE 'N';
END

TABLE FILE BRPTINST

PRINT BYAVGD BYAVGI BQAVGD BQAVGI PYAVGD PYAVGI TYAVGD TYAVGI TQAVGD TQAVGI BQATPD TQATPD
      ABSBQD ABSBQC ABSTQD ABSTQC FLAG
BY INST_KEY NOPRINT
ON TABLE SAVE  
END
-RUN

-READ SAVE &BYAVGD.6. &BYAVGI.6. &BQAVGD.6. &BQAVGI.6. &PYAVGD.6. &PYAVGI.6. &TYAVGD.6. &TYAVGI.6. &TQAVGD.6. &TQAVGI.6. &BQATPD.6. &TQATPD.6. &ABSBQD.6. &ABSBQC.6. &ABSTQD.6. &ABSTQC.6. &FLAG.1.

-CLOSE SAVE

-*Comment lines
-*first comment line - base rollup
-IF &NOQTRCOMP EQ 'N' THEN GOTO NoQTRComp;

EX FMTNUMBER VALUE=&BQAVGD,DOLLAR='N',ALIGNED='N'
-RUN
-SET &BQAVGD = &&RETVAL;

EX FMTNUMBER VALUE=&ABSBQD,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSBQD = &&RETVAL;

EX FMTNUMBER VALUE=&TQAVGD,DOLLAR='N',ALIGNED='N'
-RUN
-SET &TQAVGD = &&RETVAL;

EX FMTNUMBER VALUE=&ABSTQD,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSTQD = &&RETVAL;

-SET &AVGDL1 = IF &BQATPD GT 0 THEN ' increased ' | '&BQAVGD.EVAL%' ELSE IF &BQATPD LT 0 THEN ' decreased ' | '&ABSBQD.EVAL%' ELSE 'remains same';
-SET &BAVGDL1 = IF &FLAG EQ 'Y' THEN ' ' ELSE 'Average domestic ticket price ' | '&AVGDL1.EVAL' | ' while';

-NoQTRComp
-IF &NOTOPCOMP EQ 'N' THEN GOTO EndOfCMT;
-SET &AVGDL2 = IF &TQATPD GT 0 THEN ' increased ' | '&TQAVGD.EVAL%' ELSE IF &TQATPD LT 0 THEN ' decreased ' | '&ABSTQD.EVAL%' ELSE 'remains same';
-SET &BAVGDL2 = 'Topaz ' | '&AVGDL2.EVAL' | ' &Y2LSTTRAN.EVAL' | ' over ' | '&Y1LSTTRAN.EVAL' | '.';

-EndOfCMT;
-*** The end of comment section ***

-*if there is no pytd data, reformat these 4 variables to be blank.
-SET &B1AVGIA1 = IF '&PYTD.EVAL' EQ 'N' THEN ' ' ELSE '&B1AVGIA1.EVAL';
-SET &BYAVGI   = IF '&PYTD.EVAL' EQ 'N' THEN ' ' ELSE '&BYAVGI.EVAL' | '%';

-SET &B1AVGDA1 = IF '&PYTD.EVAL' EQ 'N' THEN ' ' ELSE '&B1AVGDA1.EVAL';
-SET &BYAVGD   = IF '&PYTD.EVAL' EQ 'N' THEN ' ' ELSE '&BYAVGD.EVAL' | '%';

TABLE FILE BRPTINST
BY INST_KEY NOPRINT
ON TABLE SET PAGE-NUM OFF
-*ON TABLE PAGE-BREAK 
&&OUTLINE1
&&OUTLINE2
FOOTING
"</24"  
" ___________________________________________________________________________________________________________<60 ________________________________________________________________________________________________________"
 -*"| <9 | <&POS1 &TD1 <&POS2A | <&POS2 &TD2 <&POS3A | <&POS3 &TD3 <&POS4A | <&POS4 &TD4 <&POS5A | <&POS5 &TD5 <&POS6A | <&POS6 &TD6 <&POS7A | <&POS7 &TD7  <&POS8A | <&POS8 &TD8  <58 | <60 | <&POSI1A |  <&POSI1 &TD1 <&POSI2A | <&POSI2 &TD2 <&POSI3A | <&POSI3 &TD3  <&POSI4A | <&POSI4 &TD4 <&POSI5A | <&POSI5 &TD5 <&POSI6A | <&POSI6 &TD6 <&POSI7A | <&POSI7 &TD7 <&POSI8A | <&POSI8 &TD8 <115 |"
 "| <10 | <&POS1 &TD1 <&POS2A | <&POS2 &TD2 <&POS3A | <&POS3 &TD3 <&POS4A | <&POS4 &TD4 <&POS5A | <&POS5 &TD5 <&POS6A | <&POS6 &TD6 <&POS7A | <&POS7 &TD7  <&POS8A | <&POS8 &TD8  <58 |                                 <60 |           <&POSI1A  |  <&POSI1 &TD1 <&POSI2A | <&POSI2 &TD2 <&POSI3A | <&POSI3 &TD3  <&POSI4A | <&POSI4 &TD4 <&POSI5A | <&POSI5 &TD5 <&POSI6A | <&POSI6 &TD6 <&POSI7A | <&POSI7 &TD7 <&POSI8A | <&POSI8 &TD8 <115 |"
 "|___________________________________________________________________________________________________________<58 | <60 |________________________________________________________________________________________________________<115 |"
"|&&SHORTNM <10 | <&POS1 &BAVGD1 <&POS2A | <&POS2 &BAVGD2 <&POS3A | <&POS3 &BAVGD3 <&POS4A | <&POS4 &BAVGD4 <&POS5A | <&POS5 &BAVGD5 <&POS6A | <&POS6 &BAVGD6 <&POS7A | <&POS7 &BAVGD7 <&POS8A | <&POS8 &BAVGD8 <58 |   <60 |&&SHORTNM  <&POSI1A  | <&POSI1 &BAVGI1 <&POSI2A | <&POSI2 &BAVGI2 <&POSI3A | <&POSI3 &BAVGI3 <&POSI4A | <&POSI4 &BAVGI4 <&POSI5A | <&POSI5 &BAVGI5 <&POSI6A | <&POSI6 &BAVGI6 <&POSI7A | <&POSI7 &BAVGI7 <&POSI8A | <&POSI8 &BAVGI8 <115 |"
"|___________________________________________________________________________________________________________<58 | <60 |________________________________________________________________________________________________________<115 |"
"|Topaz  <10 | <&POS1 &TAVGD1 <&POS2A | <&POS2 &TAVGD2 <&POS3A | <&POS3 &TAVGD3 <&POS4A | <&POS4 &TAVGD4 <&POS5A | <&POS5 &TAVGD5 <&POS6A | <&POS6 &TAVGD6 <&POS7A | <&POS7 &TAVGD7 <&POS8A | <&POS8 &TAVGD8 <58 |      <60 |Topaz      <&POSI1A  | <&POSI1 &TAVGI1 <&POSI2A | <&POSI2 &TAVGI2 <&POSI3A | <&POSI3 &TAVGI3 <&POSI4A | <&POSI4 &TAVGI4 <&POSI5A | <&POSI5 &TAVGI5 <&POSI6A | <&POSI6 &TAVGI6 <&POSI7A | <&POSI7 &TAVGI7 <&POSI8A | <&POSI8 &TAVGI8 <115 |"
"|___________________________________________________________________________________________________________<58 | <60 |________________________________________________________________________________________________________<115 |"
"|Peer Group  <10 | <&POS1 &PAVGD1 <&POS2A | <&POS2 &PAVGD2 <&POS3A | <&POS3 &PAVGD4 <&POS4A | <&POS4 &PAVGD4 <&POS5A | <&POS5 &PAVGD5 <&POS6A | <&POS6 &PAVGD6 <&POS7A | <&POS7 &PAVGD7 <&POS8A | <&POS8 &PAVGD8 <58 | <60 |Peer Group <&POSI1A  | <&POSI1 &PAVGI1 <&POSI2A | <&POSI2 &PAVGI2 <&POSI3A | <&POSI3 &PAVGI3 <&POSI4A | <&POSI4 &PAVGI4 <&POSI5A | <&POSI5 &PAVGI5 <&POSI6A | <&POSI6 &PAVGI6 <&POSI7A | <&POSI7 &PAVGI7 <&POSI8A | <&POSI8 &PAVGI8 <115 |"
"|___________________________________________________________________________________________________________<58 | <60 |________________________________________________________________________________________________________<115 |"
"</1"
"<60 &BAVGDL1"
"<60 &BAVGDL2"
"</12"
" <&POSYD1A Year to Date Average Ticket Price"
"<67  _____________________________________________________________________________"
"<67 | <68   <&POSYD1A |  YTD&YEAR2 <&POSYD2A |  YTD&YEAR1 <&POSYD3A | <&POSYD3 Variance  <&POSYD5A |"
"<67 |_____________________________________________________________________________<&POSYD5A |"
"<67 | <68 Domestic ATP <&POSYD1A | <&POSYD1 &B1AVGDA2 <&POSYD2A | <&POSYD2 &B1AVGDA1  <&POSYD3A | <&POSYD3 &BYAVGD.EVAL <&POSYD5A |"
"<67 |_____________________________________________________________________________<&POSYD5A |"
"<67 | <68 Topaz Domestic ATP <&POSYD1A | <&POSYD1 &T1AVGDA2 <&POSYD2A | <&POSYD2 &T1AVGDA1 <&POSYD3A | <&POSYD3 &TYAVGD.EVAL%  <&POSYD5A |"
"<67 |_____________________________________________________________________________<&POSYD5A |"
"<67 | <68 Peer Group Domestic ATP <&POSYD1A | <&POSYD1 &P1AVGDA2 <&POSYD2A | <&POSYD2 &P1AVGDA1 <&POSYD3A | <&POSYD3 &PYAVGD.EVAL% <&POSYD5A |"
"___________________________________________________________________________________________________________ <67 |_____________________________________________________________________________<&POSYD5A |"
"| <10 | <&POS1 &TD1 <&POS2A | <&POS2 &TD2 <&POS3A | <&POS3 &TD3 <&POS4A | <&POS4 &TD4 <&POS5A | <&POS5 &TD5 <&POS6A | <&POS6 &TD6 <&POS7A | <&POS7 &TD7 <&POS8A | <&POS8 &TD8 <58 | "
"|__________________________________________________________________________________________________________<58 | <67 ______________________________________________________________________________<&POSYD5A "
"|&&SHORTNM <10 | <&POS1 &BAVGC1 <&POS2A | <&POS2 &BAVGC2 <&POS3A | <&POS3 &BAVGC3 <&POS4A | <&POS4 &BAVGC4 <&POS5A | <&POS5 &BAVGC5 <&POS6A | <&POS6 &BAVGC6 <&POS7A | <&POS7 &BAVGC7 <&POS8A | <&POS8 &BAVGC8 <58 | <67 | <68 International ATP <&POSYD1A | <&POSYD1 &B1AVGIA2  <&POSYD2A | <&POSYD2 &B1AVGIA1  <&POSYD3A | <&POSYD3 &BYAVGI.EVAL <&POSYD5A |"
"|__________________________________________________________________________________________________________<58 | <67 |_____________________________________________________________________________<&POSYD5A |"
"|Topaz <10 | <&POS1 &TAVGC1 <&POS2A | <&POS2 &TAVGC2 <&POS3A | <&POS3 &TAVGC3 <&POS4A | <&POS4 &TAVGC4 <&POS5A | <&POS5 &TAVGC5 <&POS6A | <&POS6 &TAVGC6 <&POS7A | <&POS7 &TAVGC7 <&POS8A | <&POS8 &TAVGC8 <58 | <67 | <68 Topaz International ATP <&POSYD1A | <&POSYD1 &T1AVGIA2 <&POSYD2A | <&POSYD2 &T1AVGIA1 <&POSYD3A | <&POSYD3 &TYAVGI.EVAL% <&POSYD5A |"
"|___________________________________________________________________________________________________________<58 | <67 |_____________________________________________________________________________<&POSYD5A |"
"|Peer Group <10 | <&POS1 &PAVGC2 <&POS2A | <&POS2 &PAVGC2 <&POS3A | <&POS3 &PAVGC3 <&POS4A | <&POS4 &PAVGC4 <&POS5A | <&POS5 &PAVGC5 <&POS6A | <&POS6 &PAVGC6 <&POS7A | <&POS7 &PAVGC7 <&POS8A | <&POS8 &PAVGC8 <58 | <67 | <68 Peer Group International ATP <&POSYD1A | <&POSYD1 &P1AVGIA2 <&POSYD2A | <&POSYD2 &P1AVGIA1 <&POSYD3A | <&POSYD3 &PYAVGI.EVAL% <&POSYD5A |"
"|___________________________________________________________________________________________________________<58 | <67 |_____________________________________________________________________________<&POSYD5A |"


ON TABLE SET STYLE *
-INCLUDE ASSTY2
TYPE=FOOTING, SIZE=15, LINE=37, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=38, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=39, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=REPORT, IMAGE=AvgTktP.GIF,POSITION=(0.1 0.2), SIZE=(10.75 .75), $
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' THEN GOTO NOIMAGE;
-IF &G_DATP EQ 'N' GOTO SKIP_DATP;
 TYPE=REPORT,
 IMAGE=DATP.SVG,
    POSITION=(0.25 0.95), SIZE=(5.5 2.5),$
-SKIP_DATP
-IF &G_IATP EQ 'N' GOTO SKIP_IATP;
TYPE=REPORT,
IMAGE=IATP.SVG,
  POSITION=(5.7  0.95), SIZE=(5.5 2.5), $
-SKIP_IATP
-IF &G_CATP EQ 'N' GOTO SKIP_CATP;
TYPE=REPORT,
IMAGE=CATP.SVG,
  POSITION=(0.25  4.5), SIZE=(5.5 2.5), $
-SKIP_CATP
-NOIMAGE
ENDSTYLE
END
-RUN