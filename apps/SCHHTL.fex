-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-INCLUDE SETECHO
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN
-SET &HTLDATES = &&WEB_PATH || 'HTLDATES.fex';
DEFINE FILE &&EXTRACT
-*  INV_MONTH/MT = INVOICE_DATE;
  INV_MONTH/MT = IF '&&DATETYPE.EVAL' EQ 'I' THEN INVOICE_DATE ELSE CHKIN_DATE;
  INVY/A3 = 'YTD';
  LEVEL_DESC/A60  = &&LDESC;
  NBR_DAYS/D12 =  NUM_DAYS;
  NEW_ROOM_RATE/D12.2 = ROOM_RATE;
  NEW_TOTAL_AMT/D12.2 = TOTAL_AMT;  
  XPSNGR_NM/A15 =EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
-* ****DEFINES ON PREVIOUS DEFINES****
  BOOKINGS/D8 = IF NEW_ROOM_RATE GE 0 THEN 1 ELSE (-1);
  NNROOMS/D12 = IF ((NBR_DAYS LT 0) AND (NUM_ROOMS LT 0)) THEN 
                ((NBR_DAYS*NUM_ROOMS) * (-1)) ELSE NBR_DAYS*NUM_ROOMS;  
 
END
-RUN

TABLEF FILE &&EXTRACT
PRINT 
  BOOKINGS
  INV_MONTH
  INVY
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
-INCLUDE &HTLDATES    
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10

-INCLUDE RPTPARMS
ON TABLE HOLD AS SCHHHOLD
END
-RUN

DEFINE FILE SCHHHOLD
HLABEL1/A25='HOTEL BOOKINGS';
HLABEL2/A25='HOTEL NIGHTS';
HLABEL3/A25='HOTEL COST';
HLABEL4/A25='AVERAGE HOTEL NIGHTS';
HLABEL5/A25='AVERAGE HOTEL RATE';
END
-RUN 

TABLE FILE SCHHHOLD
SUM 
  BOOKINGS
  HLABEL1
  HLABEL2
  HLABEL3
  HLABEL4
  HLABEL5
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
BY INV_MONTH
BY INVY
ON TABLE HOLD AS HHLD1
END
-RUN

-JAN
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'JAN'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO FEB;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JANHBOOK
END
-RUN

TABLE FILE JANHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JANHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JANHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JANHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JANHDAYS
END
-RUN

TABLE FILE JANHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JANHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JANHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JANHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JANHAMT
END
-RUN

TABLE FILE JANHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JANHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JANHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JANHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JANAVGHD
END
-RUN

TABLE FILE JANAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JANAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JANAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JANAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_JAN' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JANAHAMT
END
-RUN

TABLE FILE JANAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JAN 
ON TABLE HOLD AS JANAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JANAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JAN
DATA ON JANAHAMT1
END
-RUN

    



-FEB
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'FEB'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO MAR;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS FEBHBOOK
END
-RUN

TABLE FILE FEBHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS FEBHDAYS
END
-RUN

TABLE FILE FEBHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS FEBHAMT
END
-RUN

TABLE FILE FEBHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS FEBAVGHD
END
-RUN

TABLE FILE FEBAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_FEB' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS FEBAHAMT
END
-RUN

TABLE FILE FEBAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_FEB 
ON TABLE HOLD AS FEBAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM FEBAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_FEB
DATA ON FEBAHAMT1
END
-RUN




-MAR
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'MAR'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO APR;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS MARHBOOK
END
-RUN

TABLE FILE MARHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS MARHDAYS
END
-RUN

TABLE FILE MARHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS MARHAMT
END
-RUN

TABLE FILE MARHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS MARAVGHD
END
-RUN

TABLE FILE MARAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_MAR' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS MARAHAMT
END
-RUN

TABLE FILE MARAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAR 
ON TABLE HOLD AS MARAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MARAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAR
DATA ON MARAHAMT1
END
-RUN




-APR
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'APR'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO MAY;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS APRHBOOK
END
-RUN

TABLE FILE APRHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS APRHDAYS
END
-RUN

TABLE FILE APRHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS APRHAMT
END
-RUN

TABLE FILE APRHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS APRAVGHD
END
-RUN

TABLE FILE APRAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_APR' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS APRAHAMT
END
-RUN

TABLE FILE APRAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_APR 
ON TABLE HOLD AS APRAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM APRAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_APR
DATA ON APRAHAMT1
END
-RUN




-MAY
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'MAY'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO JUN;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS MAYHBOOK
END
-RUN

TABLE FILE MAYHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS MAYHDAYS
END
-RUN

TABLE FILE MAYHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS MAYHAMT
END
-RUN

TABLE FILE MAYHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS MAYAVGHD
END
-RUN

TABLE FILE MAYAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_MAY' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS MAYAHAMT
END
-RUN

TABLE FILE MAYAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_MAY 
ON TABLE HOLD AS MAYAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM MAYAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_MAY
DATA ON MAYAHAMT1
END
-RUN




-JUN
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'JUN'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO JUL;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JUNHBOOK
END
-RUN

TABLE FILE JUNHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JUNHDAYS
END
-RUN

TABLE FILE JUNHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JUNHAMT
END
-RUN

TABLE FILE JUNHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JUNAVGHD
END
-RUN

TABLE FILE JUNAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_JUN' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JUNAHAMT
END
-RUN

TABLE FILE JUNAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUN 
ON TABLE HOLD AS JUNAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JUNAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUN
DATA ON JUNAHAMT1
END
-RUN




-JUL
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'JUL'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO AUG;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JULHBOOK
END
-RUN

TABLE FILE JULHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JULHDAYS
END
-RUN

TABLE FILE JULHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JULHAMT
END
-RUN

TABLE FILE JULHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JULAVGHD
END
-RUN

TABLE FILE JULAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_JUL' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JULAHAMT
END
-RUN

TABLE FILE JULAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_JUL 
ON TABLE HOLD AS JULAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM JULAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_JUL
DATA ON JULAHAMT1
END
-RUN




-AUG
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'AUG'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO SEP;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS AUGHBOOK
END
-RUN

TABLE FILE AUGHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS AUGHDAYS
END
-RUN

TABLE FILE AUGHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS AUGHAMT
END
-RUN

TABLE FILE AUGHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS AUGAVGHD
END
-RUN

TABLE FILE AUGAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_AUG' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS AUGAHAMT
END
-RUN

TABLE FILE AUGAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_AUG 
ON TABLE HOLD AS AUGAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM AUGAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_AUG
DATA ON AUGAHAMT1
END
-RUN




-SEP
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'SEP'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO OCT;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS SEPHBOOK
END
-RUN

TABLE FILE SEPHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS SEPHDAYS
END
-RUN

TABLE FILE SEPHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS SEPHAMT
END
-RUN

TABLE FILE SEPHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS SEPAVGHD
END
-RUN

TABLE FILE SEPAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_SEP' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS SEPAHAMT
END
-RUN

TABLE FILE SEPAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_SEP 
ON TABLE HOLD AS SEPAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM SEPAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_SEP
DATA ON SEPAHAMT1
END
-RUN




-OCT
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'OCT'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO NOV;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS OCTHBOOK
END
-RUN

TABLE FILE OCTHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS OCTHDAYS
END
-RUN

TABLE FILE OCTHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS OCTHAMT
END
-RUN

TABLE FILE OCTHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS OCTAVGHD
END
-RUN

TABLE FILE OCTAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_OCT' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS OCTAHAMT
END
-RUN

TABLE FILE OCTAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_OCT 
ON TABLE HOLD AS OCTAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM OCTAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_OCT
DATA ON OCTAHAMT1
END
-RUN




-NOV
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'NOV'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO DEC;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS NOVHBOOK
END
-RUN

TABLE FILE NOVHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS NOVHDAYS
END
-RUN

TABLE FILE NOVHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS NOVHAMT
END
-RUN

TABLE FILE NOVHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS NOVAVGHD
END
-RUN

TABLE FILE NOVAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_NOV' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS NOVAHAMT
END
-RUN

TABLE FILE NOVAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_NOV 
ON TABLE HOLD AS NOVAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM NOVAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_NOV
DATA ON NOVAHAMT1
END
-RUN


-DEC
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INV_MONTH EQ 'DEC'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO YTD;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS DECHBOOK
END
-RUN

TABLE FILE DECHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS DECHDAYS
END
-RUN

TABLE FILE DECHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS DECHAMT
END
-RUN

TABLE FILE DECHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS DECAVGHD
END
-RUN

TABLE FILE DECAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_DEC' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS DECAHAMT
END
-RUN

TABLE FILE DECAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_DEC 
ON TABLE HOLD AS DECAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM DECAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_DEC
DATA ON DECAHAMT1
END
-RUN


-YTD
TABLE FILE HHLD1
SUM 
  BOOKINGS
  LEVEL_DESC
  NEW_TOTAL_AMT
  NNROOMS
COMPUTE AVHDAYS/D12= IF (NNROOMS LT 0) AND (BOOKINGS LT 0) THEN 
                      ((NNROOMS/BOOKINGS)*(-1)) ELSE
                   IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                      (NNROOMS/BOOKINGS); 
COMPUTE AVHAMT/D12 = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        (NEW_TOTAL_AMT/NNROOMS);
BY HLABEL1
BY HLABEL2
BY HLABEL3
BY HLABEL4
BY HLABEL5
WHERE INVY EQ 'YTD'
ON TABLE HOLD AS HHLD2
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO XXIT;
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL1/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND BOOKINGS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS YTDHBOOK
END
-RUN

TABLE FILE YTDHBOOK
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDHBOOK1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDHBOOK1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDHBOOK1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL2/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS YTDHDAYS
END
-RUN

TABLE FILE YTDHDAYS
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDHDAYS1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDHDAYS1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDHDAYS1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL3/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NEW_TOTAL_AMT/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS YTDHAMT
END
-RUN

TABLE FILE YTDHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDHAMT1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL4/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHDAYS/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS YTDAVGHD
END
-RUN

TABLE FILE YTDAVGHD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDAVGHD1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDAVGHD1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDAVGHD1
END
-RUN

DEFINE FILE HHLD2
CATEGORY/A8 = 'HOTELS';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE HHLD2
PRINT CATEGORY/A8 AND HLABEL5/A25 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND AVHAMT/D12 AS 'VOL_YTD' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS YTDAHAMT
END
-RUN

TABLE FILE YTDAHAMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_YTD 
ON TABLE HOLD AS YTDAHAMT1
END
MODIFY FILE SCH_MAIN
FIXFORM FROM YTDAHAMT1
MATCH CAT_ORDER CATEGORY ROW_LABEL ROW_ORDER 
ON NOMATCH INCLUDE
ON MATCH UPDATE VOL_YTD
DATA ON YTDAHAMT1
END
-RUN

-XXIT
