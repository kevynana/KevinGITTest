-* 07/27/15 - DEB - S-10299 COMMENTED OUT SET &ECHO=ALL
-*-SET &ECHO=ALL;

-* DP 	999803
-* DP 	999825
-* DP 	999917
-* DP 	999833
-* DP 	999842
-* DP 	999850
-* DP 	999869
-* DP 	999899
-* DP 	999920
-* DP 	999911

-SET ASNAMES = ON


-* MARKET

JOIN AIR_KEY IN A1HROM TO ALL AIR_KEY IN M1HROM AS J1
END

TABLE FILE A1HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
WHERE BR_CL_IDX EQ 'DP999833' OR 'DP999803' OR 'DP999842' OR 'DP999869' OR 'DP999911' OR 'DP999920' OR 'DP999917' OR 'DP999825' OR 'DP999850' OR 'DP999899'
WHERE TRN_DATE GE '20130101'
WHERE TRN_DATE LE '20130228'
ON TABLE HOLD
END

MODIFY FILE M1HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END

-* DESTINATION

JOIN AIR_KEY IN A1HROM TO ALL AIR_KEY IN D1HROM AS J1
END

TABLE FILE A1HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
WHERE BR_CL_IDX EQ 'DP999833' OR 'DP999803' OR 'DP999842' OR 'DP999869' OR 'DP999911' OR 'DP999920' OR 'DP999917' OR 'DP999825' OR 'DP999850' OR 'DP999899'
WHERE TRN_DATE GE '20130101'
WHERE TRN_DATE LE '20130228'
ON TABLE HOLD
END

MODIFY FILE D1HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END

-* SEGMENT

JOIN AIR_KEY IN A1HROM TO ALL AIR_KEY IN S1HROM AS J1
END

TABLE FILE A1HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
WHERE BR_CL_IDX EQ 'DP999833' OR 'DP999803' OR 'DP999842' OR 'DP999869' OR 'DP999911' OR 'DP999920' OR 'DP999917' OR 'DP999825' OR 'DP999850' OR 'DP999899'
WHERE TRN_DATE GE '20130101'
WHERE TRN_DATE LE '20130228'
ON TABLE HOLD
END

-* FOR UDID 

TABLE FILE A1HROM
PRINT AIR_KEY
WHERE BR_CL_IDX EQ 'DP999833' OR 'DP999803' OR 'DP999842' OR 'DP999869' OR 'DP999911' OR 'DP999920' OR 'DP999917' OR 'DP999825' OR 'DP999850' OR 'DP999899'
WHERE TRN_DATE GE '20130101'
WHERE TRN_DATE LE '20130228'
ON TABLE HOLD AS AHOLD FORMAT FOCUS INDEX AIR_KEY
END

MODIFY FILE S1HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END

-* UDID

JOIN AIR_KEY IN AHOLD TO ALL AIR_KEY IN UAHROM AS J2
END

TABLE FILE AHOLD
PRINT AIR_KEY UDID
ON TABLE HOLD
END

MODIFY FILE UAHROM
FIXFORM FROM HOLD
MATCH AIR_KEY UDID
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* TKT_MAIN

TABLE FILE AHOLD
PRINT AIR_KEY
ON TABLE HOLD
END

MODIFY FILE T1HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END

-* AIR_MAIN

MODIFY FILE A1HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END

-* CAR

JOIN CAR_KEY IN C1HROM TO ALL CAR_KEY IN UCHROM AS J1
END

TABLE FILE C1HROM
PRINT CAR_KEY UDID
WHERE BR_CL_IDX EQ 'DP999833' OR 'DP999803' OR 'DP999842' OR 'DP999869' OR 'DP999911' OR 'DP999920' OR 'DP999917' OR 'DP999825' OR 'DP999850' OR 'DP999899'
WHERE INVOICE_DATE GE '20130101'
WHERE INVOICE_DATE LE '20130228'
ON TABLE HOLD AS CHOLD
END

-* UDID

MODIFY FILE UCHROM
FIXFORM FROM CHOLD
MATCH CAR_KEY UDID
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON CHOLD
END

TABLE FILE C1HROM
PRINT CAR_KEY
WHERE BR_CL_IDX EQ 'DP999833' OR 'DP999803' OR 'DP999842' OR 'DP999869' OR 'DP999911' OR 'DP999920' OR 'DP999917' OR 'DP999825' OR 'DP999850' OR 'DP999899'
WHERE INVOICE_DATE GE '20130101'
WHERE INVOICE_DATE LE '20130228'
ON TABLE HOLD AS CHOLD
END

MODIFY FILE C1HROM
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON CHOLD
END

-* HOTEL

JOIN HTL_KEY IN H1HROM TO ALL HTL_KEY IN UHHROM AS J1
END

TABLE FILE H1HROM
PRINT HTL_KEY UDID
WHERE BR_CL_IDX EQ 'DP999833' OR 'DP999803' OR 'DP999842' OR 'DP999869' OR 'DP999911' OR 'DP999920' OR 'DP999917' OR 'DP999825' OR 'DP999850' OR 'DP999899'
WHERE INVOICE_DATE GE '20130101'
WHERE INVOICE_DATE LE '20130228'
ON TABLE HOLD AS CHOLD
END

-* UDID

MODIFY FILE UHHROM
FIXFORM FROM CHOLD
MATCH HTL_KEY UDID
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON CHOLD
END

TABLE FILE H1HROM
PRINT HTL_KEY
WHERE BR_CL_IDX EQ 'DP999833' OR 'DP999803' OR 'DP999842' OR 'DP999869' OR 'DP999911' OR 'DP999920' OR 'DP999917' OR 'DP999825' OR 'DP999850' OR 'DP999899'
WHERE INVOICE_DATE GE '20130101'
WHERE INVOICE_DATE LE '20130228'
ON TABLE HOLD AS CHOLD
END

MODIFY FILE H1HROM
FIXFORM FROM CHOLD
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON CHOLD
END

-* LIMO

JOIN CAR_KEY IN L1HROM TO ALL CAR_KEY IN ULHROM AS J1
END

TABLE FILE L1HROM
PRINT CAR_KEY UDID
WHERE BR_CL_IDX EQ 'DP999833' OR 'DP999803' OR 'DP999842' OR 'DP999869' OR 'DP999911' OR 'DP999920' OR 'DP999917' OR 'DP999825' OR 'DP999850' OR 'DP999899'
WHERE INVOICE_DATE GE '20130101'
WHERE INVOICE_DATE LE '20130228'
ON TABLE HOLD AS CHOLD
END

-* UDID

MODIFY FILE ULHROM
FIXFORM FROM CHOLD
MATCH CAR_KEY UDID
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON CHOLD
END

TABLE FILE L1HROM
PRINT CAR_KEY
WHERE BR_CL_IDX EQ 'DP999833' OR 'DP999803' OR 'DP999842' OR 'DP999869' OR 'DP999911' OR 'DP999920' OR 'DP999917' OR 'DP999825' OR 'DP999850' OR 'DP999899'
WHERE INVOICE_DATE GE '20130101'
WHERE INVOICE_DATE LE '20130228'
ON TABLE HOLD AS CHOLD
END

MODIFY FILE L1HROM
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON CHOLD
END

-EXIT
-QUIT







