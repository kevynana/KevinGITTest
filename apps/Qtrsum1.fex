-* 03/14/17 JEM S-22486 - updated position of header and footer NEW_HDR NEW_FTR
-* 05/17/2017 JEM S-34216 - updating to make styling/heading/positioning more consistent
-* 10/13/17 CA S-37498 Updated heading settings to get them to line up over data. 



-INCLUDE SETECHO
-* File QTRSUM1.FEX


 

-INCLUDE DTRANGE
-RUN

-SET &&HEADING = 'QUARTERLY REVIEW';
-* CURRENT DATES
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');
-SET &&SP = '|';
-SET &&SP3 = IF &&ROLLCNCT EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP4 = IF &&ROLLPHN EQ ' ' THEN ' ' ELSE &&SP;
-SET &&RCNCT = &&ROLLCNCT.LENGTH;
-SET &&CSL = &&ROLLCS.LENGTH;
-SET &&REL = &&ROLLEMAIL.LENGTH;
-SET &&RCSL = &&RCNCT.EVAL + &&CSL.EVAL;

-SET &&CSLPA = IF &&ROLLNME EQ 'TOTAL COMPANY REPORTING' THEN 45 ELSE
-              IF '&&ROLLUP.EVAL' EQ 'ABCD-R' THEN 70 ELSE 
-              IF '&&ROLLEMAIL.EVAL' NE ' ' AND &&REL GT 20 THEN 58 ELSE
-              IF &&RCSL LE 21 THEN 75 ELSE 
-              IF &&RCSL GT 21 AND &&RCSL LE 26 THEN 68 ELSE 
-              IF &&RCSL GT 26 AND &&RCSL LE 31 THEN 65 ELSE 58;


-SET &&CSLP = IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' AND &&ORIENTATION LIKE 'L%' THEN 78 
- ELSE IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' AND &&ORIENTATION LIKE 'P%' THEN 55 
- ELSE IF '&&ROLLUP.EVAL' EQ 'HDRR-R' AND &&ORIENTATION LIKE 'L%' THEN 70
- ELSE IF &&ORIENTATION LIKE 'P%' THEN &&CSLPA-15 ELSE &&CSLPA;
-RUN

-IF &&SETF EQ 'ABQTRRV2' THEN GOTO SKIPTHIS;

-SET &&RPTSUF = 'QTRREVIEW1';
-INCLUDE FDEFRPTS
-RUN

-GOTO CONTINUE;

-SKIPTHIS

-SET &&RPTSUF = 'QTRREVIEW2';
-INCLUDE FDEFRPTS
-RUN


-CONTINUE

DEFINE FILE QTR_REV1
LLABEL1/A20 = 'CURRENT';
LLABEL2/A20 = 'PRIOR';
LLABEL3/A20 = 'INCREASE/DECREASE %';
NOWTOD/A8 WITH CAT_ORDER = HHMMSS (NOWTOD);
END
-RUN

TABLE FILE QTR_REV1
SUM 
-* QTR_REV1.ROW_LABEL  AS '' 
      QTR_REV1.CURRENT   IN +5 AS 'Period 1' 
      QTR_REV1.PRIOR     IN +5 AS 'Period 2' 
      QTR_REV1.IDPERCENT IN +5 AS 'VAR %' 
   

BY QTR_REV1.CAT_ORDER NOPRINT
BY QTR_REV1.ROW_ORDER NOPRINT
BY QTR_REV1.ROW_LABEL AS ' '
ON QTR_REV1.CAT_ORDER SUBHEAD
" "
"<ST.QTR_REV1.CATEGORY"
ON TABLE NOTOTAL
ON TABLE SET PAGE-NUM OFF
&&OUTLINE1
&&OUTLINE2
HEADING
"</2"
"Period1: &FMM/&FMD/&FMY - &TOM/&TOD/&TOY <&&CSLP &&ROLLNME <+0> &&SP <+0> &&ROLLCS <+0> &&SP3 <+0> &&ROLLCNCT <+0> &&SP4 <+0> &&ROLLPHN"
"Period2: &FXMM/&FXMD/&FXMY - &TXOM/&TXOD/&TXOY"
"<30 &&RPT_TTL1"
"<30 &&RPT_TTL2"
" "
" "
" "
" "
-* "</2"
-* "<38 &&HEADING"
-* "<18 &&LVL_DSC </1"
-* " <34 Current: <40 &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
-* " <34   Prior: <40 &FXMM/&FXMD/&FXMY - &TXOM/&TXOD/&TXOY"
-* " "
-* " <14 --CURRENT-- <31 --PRIOR-- <43 --INCREASE/DECREASE--"
-*
-INCLUDE FOOTERSM
-*
ON TABLE SET PAGE-NUM OFF
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET HTMLCSS ON
ON TABLE SET STYLE *
-*
-* FRT_DateTimePosit sets the position of the Post-trip date/time stamp text within the footer image.
-* The default line number (&FTR_DateTimeLine) in the FOOTING for the date/time stamp text is: 4.
-INCLUDE FTR_DateTimePosit
-* 
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000, 
    TOPMARGIN=0.300000, BOTTOMMARGIN=0.050000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT,FONT='ARIAL', SIZE=8, COLOR=BLACK, 
    BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=HEADING, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$
TYPE=HEADING, LINE=6, SIZE=10, $
TYPE=HEADING, LINE=7, SIZE=10, $
TYPE=HEADING, LINE=10, COLOR=BLACK, $
TYPE=SUBHEAD, BY=1, LINE=2, OBJECT=FIELD, ITEM=1, FONT=ARIAL, SIZE=8,
              STYLE=BOLD+UNDERLINE, JUSTIFY=LEFT, $
-* TYPE=SUBHEAD, BY=1, LINE=3, OBJECT=FIELD, ITEM=1, FONT=ARIAL, SIZE=7,
-*     STYLE=BOLD+UNDERLINE, $
-* TYPE=SUBHEAD, BY=1, LINE=3, OBJECT=FIELD, ITEM=2, FONT=ARIAL, SIZE=7,
-*     STYLE=BOLD+UNDERLINE, $
-* TYPE=SUBHEAD, BY=1, LINE=3, OBJECT=FIELD, ITEM=3, FONT=ARIAL, SIZE=7,
-*     STYLE=BOLD+UNDERLINE, $
-* TYPE=SUBHEAD, BY=1, LINE=3, OBJECT=FIELD, ITEM=4, FONT=ARIAL, SIZE=7,
-*     STYLE=BOLD+UNDERLINE, $
-* TYPE=DATA, JUSTIFY=LEFT, $

-*******************
TYPE=TITLE, STYLE=-UNDERLINE,$
TYPE=TITLE, STYLE=BOLD, $

TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0.2), SIZE=(2.8 .37),PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.0), SIZE=(10.5 .58), PRESERVERATIO=ON, $  
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&TNTDTPOS), SIZE=(&&ROLDTSIZ), $

TYPE=FOOTING, SIZE=7, COLOR=RGB(70 136 177), $
-*
TYPE=FOOTING, LINE=&FTR_DateTimeLine, STYLE=BOLD,POSITION=(&FTR_DatePosit),$ 
-*
ENDSTYLE
END
-RUN

-IF &RECORDS NE 0 THEN GOTO EXIT;


-NORECORDS
-IF &&FROMAVRP NE 'Y' GOTO :AVSF1;
-INCLUDE AVRP_SUBFOOT
-:AVSF1
 
-SET &&RPTSUF = 'MSG';
-INCLUDE FDEFRPTS
-RUN
JOIN SET_KEY IN BRPTINST TO SET_KEY IN BRPT_SET AS J1
DEFINE FILE BRPTINST
EMPTY/A35 = 'NO RECORDS FOUND FOR THIS SELECTION';
NOWTOD/A8 WITH INST_KEY = HHMMSS (NOWTOD);
END
TABLE FILE BRPTINST
-INCLUDE HEADAIR
PRINT EMPTY AS 'REPORT,MESSAGE'
BY ROLLUP_CODE AS 'ROLLUP,CODE'
BY RPT_NAME AS 'REPORT,NAME'
BY SELECT_LEV AS 'BREAK,LEVEL'
IF INST_KEY EQ &&IKEY
IF RECORDLIMIT EQ 1
-INCLUDE FOOTERSM
ON TABLE SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET PAGE-NUM OFF
ON TABLE SET STYLE *
-INCLUDE &&DTSTY
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
 
 
-GOTO XXIT


-EXIT

-XXIT

