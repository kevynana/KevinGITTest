-*SET TEMPERASE = OFF
-INCLUDE SETECHO
FILEDEF DBGRAPH1 DISK D:\IBI\DBGRAPH1.PNG

-*-GOTO JOYGRAPH;

GRAPH FILE E1CONG
SUM VOLUME AS ''
BY TRAVELBY AS ''

-* ON GRAPH HOLD AS 'DBGRAPH1' FORMAT PNG

ON GRAPH SET LOOKGRAPH PIE
ON GRAPH SET GRAPHEDIT SERVER
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D ON
ON GRAPH SET VZERO ON
ON GRAPH SET GRID OFF

-*Optimal display format for Applet Rectangule is 1.618 units in width 
-*for every 1 unit in height.
ON GRAPH SET VAXIS 140
ON GRAPH SET HAXIS 300

ON GRAPH SET GRAPHSTYLE *
-*display pie feelers
setPieFeelerTextDisplay(2);

-* display absolute value in pie chart
setPieLabelDisplay(0);
-* sets preset Pie Label format type ($, %)
setTextFormatPreset(getPieSliceLabel(),6);
-* absolute sizing on pie label
setFontSizeAbsolute(getPieSliceLabel(),true);
-* specific font size for pie label
setFontSize(getPieLabelDisplay(),10);
-* specific font style for pie label (bold, underline)
setFontStyle(getPieLabelDisplay(),1);
-* does not allow the label to be resized or moved.
setPlaceResize(getPieSliceLabel(),0);
setPlaceAlign(getPieSliceLabel(),1);

-* pie border
setRiserBorderMode(1);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);

-* sets title string
setTitleString("Total Expense");
-* positions title on graph
setTextJustHoriz(getTitle(),1);
-* absolute title sizing
setFontSizeAbsolute(getTitle(),true);
-* specific title font size
setFontSize(getTitle(),14);
-* specific title font style
setFontStyle(getTitle(),2);
-* allows resizing of title with Fontsize command when set place is on
setPlaceResize(getTitle(),0);

-* Determines whether to show a legend
setLegendDisplay(true);
-* absolute Legend Text Sizing
setFontSizeAbsolute(getLegendText(),true);
-* specific legend text font size
setFontSize(getLegendText(),10);
-* specific legend text font style
setFontStyle(getLegendText(),0);
-* rotates legend text
setTextRotation(getLegendText(),0);
-* allows resizing of legend text when set place is true
setPlaceResize(getLegendText(),0);
-* allows rotation of legend text when set place is true
setPlaceRotate(getLegendText(),0);
-* allows legend text alignment when set place is true
setPlaceAlign(getLegendText(),0);
-* sets graph colors
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(2, new Color, 115 160 247));
-* sets pie thickness and tilt
setPieDepth(50);
setPieTilt(50);
-*change the size of graph
setPlace(true);

ENDSTYLE


END
-RUN
-EXIT

-JOYGRAPH;

GRAPH FILE E1CONG
SUM VOLUME AS ' '
ACROSS TRAVELBY
ON GRAPH SET LOOKGRAPH PIE
ON GRAPH SET GRAPHEDIT SERVER
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D ON
ON GRAPH SET VZERO ON
ON GRAPH SET GRID OFF
ON GRAPH SET VAXIS 140
ON GRAPH SET HAXIS 450

ON GRAPH SET GRAPHSTYLE *
setMarkerDisplay(true);
setConnectLineMarkers(false);
setConnectScatterMarkers(false);
setO1LabelDisplay(true);
setO1AxisSide(0);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setAxisAssignment(0,0);
setY1LabelDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setTextFormatPreset(getY1Label(),6);
setPieFeelerTextDisplay(2);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),6);
setFontSizeAbsolute(getPieSliceLabel(),true);
setFontSize(getPieLabelDisplay(),9);
setFontStyle(getPieLabelDisplay(),1);
setRiserBorderMode(1);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setTitleString("Total Expense");
setTextJustHoriz(getTitle(),1);
setFontSizeAbsolute(getTitle(),true);
setFontSize(getTitle(),12);
setFontStyle(getTitle(),2);
setTextRotation(getTitle(),0);
setTextWrap(getTitle(),false);
setTextJustHoriz(getLegendText(),2);
setFontSizeAbsolute(getLegendText(),true);
setFontSize(getLegendText(),10);
setFontStyle(getLegendText(),0);
setTextRotation(getLegendText(),0);
setTextWrap(getLegendText(),false);
setTextJustHoriz(getY1Title(),1);
setFontSizeAbsolute(getY1Title(),true);
setFontSize(getY1Title(),12);
setTextRotation(getY1Title(),1);
setTextWrap(getY1Title(),false);
setTextJustHoriz(getY1Label(),2);
setFontSizeAbsolute(getY1Label(),true);
setFontSize(getY1Label(),16);
setTextRotation(getY1Label(),0);
setTextWrap(getY1Label(),false);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlaceResize(getTitle(),0);
setPlaceRotate(getTitle(),0);
setPlaceAlign(getTitle(),0);
setPlaceWordWrap(getTitle(),0);
setPlaceResize(getPieSliceLabel(),0);
setPlaceRotate(getPieSliceLabel(),0);
setPlaceAlign(getPieSliceLabel(),0);
setPlaceWordWrap(getPieSliceLabel(),0);
setPlaceResize(getLegendText(),0);
setPlaceRotate(getLegendText(),0);
setPlaceAlign(getLegendText(),0);
setPlaceWordWrap(getLegendText(),0);
setPlaceResize(getY1Title(),0);
setPlaceRotate(getY1Title(),0);
setPlaceAlign(getY1Title(),0);
setPlaceWordWrap(getY1Title(),0);
setPlaceResize(getY1Label(),0);
setPlaceRotate(getY1Label(),0);
setPlaceAlign(getY1Label(),0);
setPlaceWordWrap(getY1Label(),0);
setPlace(true);
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(2, new Color, 115 160 247));
setPieDepth(50);
setPieTilt(50);
ENDSTYLE
ON GRAPH HOLD AS 'DBGRAPH1' FORMAT PNG
ON GRAPH SET STYLE *
     SQUEEZE=ON,
     ORIENTATION=PORTRAIT,
     TITLETEXT='Total Expense',
$
TYPE=REPORT,
     GRID=OFF,
     FONT='TIMES NEW ROMAN',
     SIZE=10,
$
ENDSTYLE
END
