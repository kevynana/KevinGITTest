SET ASNAMES=ON
SET MESSAGE=ON

-SET ECHO=ALL;

USE
    D:\TNT\TTRACKER\SUDATA\ROLLUP.FOC
END
-RUN

FI CUSTS DISK D:\LOAD\FOCTEMP\CUSTS.DAT
-*=======================================================================

-*=======================================================================

-SET &CNT=0;

-TOP
TABLE FILE ROLLUP
BY ROLLUP NOPRINT
PRINT ROLLUP COMP
IF UPD_ENABLE NE ' '
IF RECORDLIMIT EQ 1
IF QTR_ENABLE EQ 'X'
IF ROLLUP NE 'TOTAL-R'
-* WHERE ROLLUP EQ 'ABCD-R'
ON TABLE SAVE AS CUSTS
END
-RUN

-READ CUSTS &&ROLLUP.A8 &&COMP.A6.
-RUN


-IF &RECORDS EQ 0 GOTO STOP;
-RUN


USE CLEAR *
-RUN


-SET &&COMPA=&&COMP.EVAL;
-SET &&TKTM1 = 'T1'||&&COMPA||'.FOC';
-SET &&TKTM2 = 'T2'||&&COMPA||'.FOC';
-SET &&TKTM3 = 'T3'||&&COMPA||'.FOC';
-SET &&TKTM4 = 'T4'||&&COMPA||'.FOC';
-SET &&TKTM5 = 'T5'||&&COMPA||'.FOC';
-SET &&TKTM6 = 'T6'||&&COMPA||'.FOC';
-SET &&TKTM7 = 'T7'||&&COMPA||'.FOC';
-SET &&TKTM8 = 'T8'||&&COMPA||'.FOC';
-SET &&TKTM9 = 'T9'||&&COMPA||'.FOC';
-SET &&TKTM0 = 'T0'||&&COMPA||'.FOC';
-SET &&TKTMY = 'TY'||&&COMPA||'.FOC';
-SET &&TKTMZ = 'TZ'||&&COMPA||'.FOC';


USE 
D:\TNT\TTRACKER\DATA\&&TKTM1 AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTM2 AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTM3 AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTM4 AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTM5 AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTM6 AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTM7 AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTM8 AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTM9 AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTM0 AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTMY AS TKT_MAIN
D:\TNT\TTRACKER\DATA\&&TKTMZ AS TKT_MAIN
END
-RUN

-GOTO TOP

-* -GOTO JOY2
-* USE ADD
-* D:\TNT\TTRACKER\DATA\S_BCBS.FOC AS SR_50
-* D:\TNT\TTRACKER\DATA\A_BCBS.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\T_BCBS.FOC AS TKT_MAIN
-* END


DEFINE FILE TKT_MAIN
FDCC/A3 = IF FNL_DEST_CNTY_CODE  EQ ' ' THEN FST_DEST_CNTRY_CODE ELSE FNL_DEST_CNTY_CODE;
FDSC/A2 = IF FNL_DEST_STATE_CODE EQ ' ' THEN FST_DEST_STATE_CODE ELSE FNL_DEST_STATE_CODE;
FDAP/A3 = IF FNL_DEST_AIRPORT    EQ ' ' THEN ORG_APC ELSE FNL_DEST_AIRPORT;
END
-RUN
TABLE FILE TKT_MAIN
PRINT FDAP AS 'FNL_DEST_AIRPORT'
      FDSC AS 'FNL_DEST_STATE_CODE'
      FDCC AS 'FNL_DEST_CNTY_CODE' 
BY AIR_KEY
WHERE RECORDLIMIT EQ 1000
-* ON TABLE HOLD AS HOLD1
END
-RUN
-QUIT

TABLE FILE HOLD1
PRINT FNL_DEST_AIRPORT FNL_DEST_STATE_CODE FNL_DEST_CNTY_CODE 
BY AIR_KEY
ON TABLE HOLD AS HOLD2
END
-RUN      

-***********  T1 MODIFY

MODIFY FILE &&TKTM1
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T2 MODIFY

MODIFY FILE &&TKTM2
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T3 MODIFY

MODIFY FILE &&TKTM3
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T4 MODIFY

MODIFY FILE &&TKTM4
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T5 MODIFY

MODIFY FILE &&TKTM5
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T6MODIFY

MODIFY FILE &&TKTM6
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T7 MODIFY

MODIFY FILE &&TKTM7
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T8 MODIFY

MODIFY FILE &&TKTM8
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T9 MODIFY

MODIFY FILE &&TKTM9
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  T0 MODIFY

MODIFY FILE &&TKTM0
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  TY MODIFY

MODIFY FILE &&TKTMY
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-***********  TZ MODIFY

MODIFY FILE &&TKTMZ
LOG NOMATCH MSG OFF
FIXFORM FROM HOLD2
MATCH AIR_KEY
ON MATCH UPDATE FNL_DEST_AIRPORT
ON MATCH UPDATE FNL_DEST_STATE_CODE
ON MATCH UPDATE FNL_DEST_CNTY_CODE
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN

-GOTO TOP
-*======================================================================
-STOP

-XFER
-TYPE PROGRAM COMPLETED.......
-EXIT

-XXIT
-EXIT