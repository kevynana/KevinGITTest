-*7/11/16 -DLV -  S-20630  Added code to include EMP_ID 
-* 08/01/2016 - DLV - S-21658 Added 'Not Available' to variable &LV1 &LV2 &LV3  &LV4
-*                                   

-******************************************************************************
-* DVRUNUT.FEX
-* RPT_STREAM for Data Vault Report Unused Tickets
-* No Set file for the report
-******************************************************************************
-INCLUDE SETECHO
SET EMPTYREPORT = ON
 
-IF '&&OUTTO.EVAL' EQ 'XB' THEN GOTO NOFILEDEF;
-INCLUDE SETPARMTIME
-SET &&RPTSUF = 'DT';
-INCLUDE FDEFRPTS
 
-NOFILEDEF
-SET &&OUTLINE1 = IF '&&OUTTO.EVAL' EQ 'XB' THEN 'ON TABLE SET ONLINE-FMT'
- ELSE 'ON TABLE SAVE AS SAVREP FORMAT';
-*-SET &&OUTLINE2 = &&OUTFMT;
-SET &&OUTLINE2 = 'EXL2K';
 
DEFINE FILE ROLLUP
LV1/A20 = UPCASE(20, LEV1, LV1);
LV2/A20 = UPCASE(20, LEV2, LV2);
LV3/A20 = UPCASE(20, LEV3, LV3);
LV4/A20 = UPCASE(20, LEV4, LV4);
EMPID/A20 =  UPCASE(20, EMPID_DESC, EMPID);

END
TABLE FILE ROLLUP
PRINT LV1 LV2 LV3 LV4 EMPID
WHERE ROLLUP EQ '&&ROLLUP.EVAL'
ON TABLE SAVE AS ROLLLEV
END
-RUN
-READ ROLLLEV &&LV1.A20. &&LV2.A20. &&LV3.A20. &&LV4.A20. &&EMPID.A20.
-CLOSE ROLLLEV
 
-SET &LEV1 = '&&LV1.EVAL';
-SET &LEV2 = '&&LV2.EVAL';
-SET &LEV3 = '&&LV3.EVAL';
-SET &LEV4 = '&&LV4.EVAL';
-SET &EMP_ID = '&&EMPID.EVAL';

 
-SET &&LV1 = IF '&LEV1.EVAL' EQ 'NOT USED' OR 'NOT AVAILABLE' THEN 'NOPRINT' ELSE 'AS' | ' ' | '''&LEV1.EVAL''';
-SET &&LV2 = IF '&LEV2.EVAL' EQ 'NOT USED' OR 'NOT AVAILABLE' THEN 'NOPRINT' ELSE 'AS' | ' ' | '''&LEV2.EVAL''';
-SET &&LV3 = IF '&LEV3.EVAL' EQ 'NOT USED' OR 'NOT AVAILABLE' THEN 'NOPRINT' ELSE 'AS' | ' ' | '''&LEV3.EVAL''';
-SET &&LV4 = IF '&LEV4.EVAL' EQ 'NOT USED' OR 'NOT AVAILABLE' THEN 'NOPRINT' ELSE 'AS' | ' ' | '''&LEV4.EVAL''';
-SET &EMPID = IF '&EMP_ID.EVAL' EQ ' ' THEN 'NOPRINT' ELSE 'AS' | ' ' | '''&EMP_ID.EVAL'''; 

 
-SET &DSC = 'Unused Tickets    ';
-SET &&FOOTER1 = &&SETF | ' - ' | &&IKEY;
-SET &&FOOTER2 = '';
 


-INCLUDE DVUNUSED
-RUN
-GOTO XXIT


-XXIT