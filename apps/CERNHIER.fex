-* CERNHIER.FEX
-* This is created to correct global hierarchy for CERN-R. 
TABLE FILE DIM_HIERARCHYLEVELS
PRINT *
BY HLVL_LEVEL NOPRINT
WHERE HLVL_ROLLUP_CODE EQ 'CERN-R'
WHERE HLVL_LEVEL EQ '01' AND HLVL_ORDERBY NE '0'
ON TABLE HOLD
END


MODIFY FILE DIM_HIERARCHYLEVELS
FIXFORM FROM HOLD
MATCH HLVL_KEY
  ON MATCH DELETE
  ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


-EXIT
-*Backup data

APP MAP CERNDATA D:\LUSHENG
APP HOLDDATA CERNDATA
APP HOLDMETA CERNDATA

TABLE FILE DIM_HIERARCHYLEVELS
PRINT *
BY HLVL_LEVEL NOPRINT
WHERE HLVL_ROLLUP_CODE EQ 'CERN-R'
WHERE HLVL_LEVEL EQ '01' AND HLVL_ORDERBY NE '0'
ON TABLE HOLD AS CERNGLB
END
-RUN