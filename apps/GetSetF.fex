MAINTAIN FILES DOWNLIST AND CONTROL AND ROLLSET

COMPUTE Cnt1/I4 = ;

INFER ROLLSET.ROLLUP_CODE INTO R_Stack
INFER ROLLSET.ROLLUP_CODE INTO O_Stack
INFER REPORTS.FILE_NAME INTO F_Stack

REPOSITION CONTROL.CONTROL_ID
NEXT CONTROL.CONTROL_ID INTO Ctl_Stack

REPOSITION REPORTS.FILE_NAME
STACK CLEAR F_Stack
FOR ALL NEXT FILE_NAME INTO F_Stack

COMPUTE Cnt1 = 1;
REPEAT WHILE Cnt1 LE F_Stack.FocCount  
  REPOSITION ROLLSET.ROLLUP_CODE
  STACK CLEAR R_Stack
  NEXT ROLLSET.ROLLUP_CODE INTO R_Stack WHERE
    ROLLSET.ROLLUP_CODE EQ Ctl_Stack(1).ROLLUP_CODE AND
    ROLLSET.GLOBAL_PARM EQ F_Stack(Cnt1).FILE_NAME
  IF (R_Stack.FocCount EQ 0) AND (F_Stack(Cnt1).EXTENTION EQ 'FEX') THEN
  BEGIN
    COMPUTE O_Stack(1).ROLLUP_CODE = Ctl_Stack(1).ROLLUP_CODE;
    COMPUTE O_Stack(1).GLOBAL_PARM = F_Stack(Cnt1).FILE_NAME;
    REPOSITION ROLLSET.ROLLUP_CODE
    INCLUDE ROLLSET.ROLLUP_CODE FROM O_Stack(1)
    COMMIT
  ENDBEGIN
  COMPUTE Cnt1 = Cnt1 + 1;
ENDREPEAT

case Winform_Form1
   Winform show Form1
endcase




END
