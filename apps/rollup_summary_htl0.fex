-SET &GWHERE=IF '&&RUP.EVAL' EQ 'KIEWIT-R' THEN '-*' ELSE 'WHERE CATEGORY NE ' | '''' | 'GLOBAL' | '''';
 
DEFINE FILE HR_50
 NBR_DAYS/D12 =  NUM_DAYS;
 NBR_ROOMS/D12 = NUM_ROOMS;
 NEW_TOTAL_AMT/P15.2 = TOTAL_AMT;
 NNROOMS/I8 = IF ((NBR_DAYS LT 0) AND (NUM_ROOMS LT 0)) THEN ((NBR_DAYS*NUM_ROOMS) * (-1)) ELSE NBR_DAYS*NUM_ROOMS;
 T_MONTH/YYM=INVOICE_DATE;
END
TABLE FILE HR_50
SUM NNROOMS AS HOTEL_NIGHTS
    NEW_TOTAL_AMT AS HOTEL_COST
BY ROLLUP_CODE
BY T_MONTH AS MONTH
BY CATEGORY
BY PROP_KEY
&GWHERE.EVAL
ON TABLE SET ASNAMES ON
ON TABLE HOLD AS HLDHTL01
END
 
MODIFY FILE ROLLUP_SUMMARY2
FIXFORM FROM HLDHTL01
MATCH ROLLUP_CODE MONTH CATEGORY PROP_KEY
 ON NOMATCH INCLUDE
 ON MATCH UPDATE HOTEL_NIGHTS HOTEL_COST
DATA ON HLDHTL01
END
-RUN
