-* update id-level3 & aroll_lev3

SET ASNAMES=ON


USE
D:\TNT\TTRACKER\DATA\A5SCHNEI.FOC
D:\TNT\TTRACKER\DATA\C5SCHNEI.FOC
D:\TNT\TTRACKER\DATA\D5SCHNEI.FOC
D:\TNT\TTRACKER\DATA\H5SCHNEI.FOC
D:\TNT\TTRACKER\DATA\M5SCHNEI.FOC
D:\TNT\TTRACKER\DATA\S5SCHNEI.FOC
END
-RUN

-GOTO JOY;

DEFINE FILE A5SCHNEI
INT3/A5 = GETTOK(INT_CODE, 36, -1, '-', 5, INT3);
INT3A/A6 =  
END
-RUN
TABLE FILE A5SCHNEI
PRINT INT3 INT3A INT_CODE
BY AIR_KEY
WHERE INT_CODE CONTAINS 'GROSS'
-* ON TABLE HOLD
END
-RUN
-QUIT

MODIFY FILE A5SCHNEI
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3 = 'ROURKE';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN



TABLE FILE C5SCHNEI
PRINT LEVEL3 AROLL_LEV3 
BY CAR_KEY
WHERE AROLL_LEV3 EQ 'GROSS'
ON TABLE HOLD AS CARHLD
END
-RUN

MODIFY FILE C5SCHNEI
FIXFORM FROM CARHLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL3 = 'ROURKE';
ON MATCH COMPUTE AROLL_LEV3 = 'ROURKE';
ON MATCH UPDATE LEVEL3 AROLL_LEV3
ON NOMATCH REJECT
DATA ON CARHLD
END
-RUN

TABLE FILE H5SCHNEI
PRINT LEVEL3 AROLL_LEV3 
BY HTL_KEY
WHERE AROLL_LEV3 EQ 'GROSS'
ON TABLE HOLD AS HTLHLD
END
-RUN

MODIFY FILE H5SCHNEI
FIXFORM FROM HTLHLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL3 = 'ROURKE';
ON MATCH COMPUTE AROLL_LEV3 = 'ROURKE';
ON MATCH UPDATE LEVEL3 AROLL_LEV3
ON NOMATCH REJECT
DATA ON HTLHLD
END
-RUN

-JOY;

TABLE FILE S5SCHNEI
PRINT AROLL_LEV3
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
WHERE AROLL_LEV3 EQ 'GROSS'
ON TABLE HOLD AS HOLD
END
-RUN

MODIFY FILE S5SCHNEI
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3 = 'ROURKE';
ON MATCH UPDATE AROLL_LEV3
DATA ON HOLD
END