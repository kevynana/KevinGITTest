-INCLUDE SETECHO

SET ASNAMES = ON

-IF '&&TSMT.EVAL' EQ 'AIR' THEN GOTO AIR ELSE
-IF '&&TSMT.EVAL' EQ 'HTL' THEN GOTO HOTEL ELSE
-IF '&&TSMT.EVAL' EQ 'CAR' THEN GOTO CAR ELSE GOTO LIM;


-AIR

TABLE FILE TSAIRSUM
SUM TRN_MO
BY TRN_MO NOPRINT
ON TABLE SAVE AS AIRS
END
-RUN
 
-READ AIRS &&TRNM.A2.
-CLOSE AIRS

-TYPE &&TRNM
 


-GOTO EndThis;
 
-HOTEL

TABLE FILE TSHTLSUM
SUM TRN_MO
BY TRN_MO NOPRINT
ON TABLE SAVE AS HTLS
END
-RUN

-READ HTLS &&TRNM.A2.
-CLOSE HTLS

-GOTO EndThis;


-CAR

TABLE FILE TSCARSUM
SUM TRN_MO
BY TRN_MO NOPRINT
ON TABLE SAVE AS CARS
END
-RUN

-READ CARS &&TRNM.A2.
-CLOSE CARS

-GOTO EndThis;


-LIM
TABLE FILE TSLIMSUM
SUM TRN_MO
BY TRN_MO NOPRINT
ON TABLE SAVE AS LIMS
END
-RUN

-READ LIMS &&TRNM.A2.
-CLOSE LIMS

-EndThis


-IF '&&TRNM.EVAL' EQ '02' THEN GOTO FEB;   
-IF '&&TRNM.EVAL' EQ '03' THEN GOTO MAR;
-IF '&&TRNM.EVAL' EQ '04' THEN GOTO APR;   
-IF '&&TRNM.EVAL' EQ '05' THEN GOTO MAY;   
-IF '&&TRNM.EVAL' EQ '06' THEN GOTO JUN;   
-IF '&&TRNM.EVAL' EQ '07' THEN GOTO JUL;   
-IF '&&TRNM.EVAL' EQ '08' THEN GOTO AUG;   
-IF '&&TRNM.EVAL' EQ '09' THEN GOTO SEP;   
-IF '&&TRNM.EVAL' EQ '10' THEN GOTO OCT;   
-IF '&&TRNM.EVAL' EQ '11' THEN GOTO NOV;   
-IF '&&TRNM.EVAL' EQ '12' THEN GOTO DEC ELSE GO TO JAN;
 

-FEB
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB''';
-GOTO DONE
 
-MAR
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'''; 
-GOTO DONE

-APR
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'' OR ''APR'''; 
-GOTO DONE 

-MAY
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'' OR ''APR'' OR ''MAY'''; 
-GOTO DONE 

-JUN
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'' OR ''APR'' OR ''MAY'' OR ''JUN'''; 
-GOTO DONE 

-JUL
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'' OR ''APR'' OR ''MAY'' OR ''JUN'' OR ''JUL'''; 
-GOTO DONE 

-AUG
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'' OR ''APR'' OR ''MAY'' OR ''JUN'' OR ''JUL'' OR ''AUG'''; 
-GOTO DONE 

-SEP
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'' OR ''APR'' OR ''MAY'' OR ''JUN'' OR ''JUL'' OR ''AUG'' OR ''SEP'''; 
-GOTO DONE 

-OCT
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'' OR ''APR'' OR ''MAY'' OR ''JUN'' OR ''JUL'' OR ''AUG'' OR ''SEP'' OR ''OCT'''; 
-GOTO DONE 

-NOV
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'' OR ''APR'' OR ''MAY'' OR ''JUN'' OR ''JUL'' OR ''AUG'' OR ''SEP'' OR ''OCT'' OR ''NOV'''; 
-GOTO DONE 

-DEC
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'' OR ''APR'' OR ''MAY'' OR ''JUN'' OR ''JUL'' OR ''AUG'' OR ''SEP'' OR ''OCT'' OR ''NOV'' OR ''DEC'''; 
-GOTO DONE 

-JAN
-SET &&WHERES = 'WHERE TRAN_M EQ ''FEB'' OR ''MAR'' OR ''APR'' OR ''MAY'' OR ''JUN'' OR ''JUL'' OR ''AUG'' OR ''SEP'' OR ''OCT'' OR ''NOV'' OR ''DEC'' OR ''JAN'''; 
-GOTO DONE 


-DONE

 

 

