-INCLUDE SETECHO

SET ASNAMES = ON;

TABLE FILE S_TMOBIL 
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AROLL_LEV2 EQ 'TMOBILM'
ON TABLE HOLD AS SHOLD
END
-RUN

MODIFY FILE S_TMOBIL
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='TMOBILM';
ON MATCH COMPUTE AROLL_LEV4='TMOBILM';

ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN


TABLE FILE D_TMOBIL 
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AROLL_LEV2 EQ 'TMOBILM'
ON TABLE HOLD AS DHOLD
END
-RUN

MODIFY FILE D_TMOBIL
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='TMOBILM';
ON MATCH COMPUTE AROLL_LEV4='TMOBILM';

ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

TABLE FILE M_TMOBIL 
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AROLL_LEV2 EQ 'TMOBILM'
ON TABLE HOLD AS MHOLD
END
-RUN

MODIFY FILE M_TMOBIL
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='TMOBILM';
ON MATCH COMPUTE AROLL_LEV4='TMOBILM';

ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN


TABLE FILE C_TMOBIL 
PRINT CAR_KEY  
BY CAR_KEY NOPRINT
IF AROLL_LEV2 EQ 'TMOBILM'
ON TABLE HOLD AS CHOLD
END
-RUN

MODIFY FILE C_TMOBIL
FIXFORM FROM CHOLD
MATCH CAR_KEY  
ON MATCH COMPUTE AROLL_LEV3='TMOBILM';
ON MATCH COMPUTE AROLL_LEV4='TMOBILM';

ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN

TABLE FILE H_TMOBIL 
PRINT HTL_KEY  
BY HTL_KEY NOPRINT
IF AROLL_LEV2 EQ 'TMOBILM'
ON TABLE HOLD AS HHOLD
END
-RUN

MODIFY FILE H_TMOBIL
FIXFORM FROM HHOLD
MATCH HTL_KEY  
ON MATCH COMPUTE AROLL_LEV3='TMOBILM';
ON MATCH COMPUTE AROLL_LEV4='TMOBILM';

ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


TABLE FILE L_TMOBIL 
PRINT CAR_KEY  
BY CAR_KEY NOPRINT
IF AROLL_LEV2 EQ 'TMOBILM'
ON TABLE HOLD AS LHOLD
END
-RUN

MODIFY FILE L_TMOBIL
FIXFORM FROM LHOLD
MATCH CAR_KEY  
ON MATCH COMPUTE AROLL_LEV3='TMOBILM';
ON MATCH COMPUTE AROLL_LEV4='TMOBILM';

ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON LHOLD
END
-RUN
