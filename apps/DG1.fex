SET ASNAMES=ON
-*SET TEMPERASE = OFF

JOIN AIR_KEY IN AYMETX TO ALL AIR_KEY IN SYMETX AS J1
END

DEFINE FILE AYMETX
FARE_PAID/D12.2 = SEG_AMT + SEG_TAX;
TYPE/A12 = IF DOD_TYPE EQ 'I' THEN 'ONLINE' 
           ELSE 'TRADITIONAL';
NET_TKT_CNT/D8CS    = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
END

TABLE FILE AYMETX
SUM FARE_PAID NET_TKT_CNT AS 'TICKETS' PCT.NET_TKT_CNT/D12.2 AS 'PERCENT'
AND COMPUTE AVG/D12.2 = FARE_PAID/NET_TKT_CNT;
BY TYPE
ON TABLE HOLD
END
-RUN

GRAPH FILE HOLD
SUM TICKETS PERCENT FARE_PAID AVG
-* SUM PERCENT AVG
ACROSS TYPE
ON GRAPH SAVE AS G1 FORMAT SVG
ON GRAPH SET GRAPHEDIT SERVER
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D ON
ON GRAPH SET VZERO ON
ON GRAPH SET GRID ON
ON GRAPH SET GRAPHSTYLE *
setGraphType(55);
setPiesPerRow(2);
setMarkerDisplay(true);
setConnectLineMarkers(false);
setConnectScatterMarkers(false);
setO1LabelDisplay(true);
setO1AxisSide(0);
setO1MajorGridDisplay(true);
setO1MajorGridStyle(0);
setO1MinorGridDisplay(false);
setAxisAssignment(0,0);
setSeriesType(0,1);
setAxisAssignment(1,0);
setSeriesType(1,1);
setY1LabelDisplay(true);
setY1AxisSide(0);
setY1MajorGridDisplay(true);
setY1MajorGridStyle(0);
setY1MinorGridDisplay(false);
setTextFormatPreset(getY1Label(),-1);
setTextFormatPattern(getY1Label(),"#.##");
setPieFeelerTextDisplay(1);
setPieFeelerTextFormatPattern("##.##");
setDataTextDisplay(true);
setDataTextFormat(4);
-****
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setLegendDisplay(true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setLegendPosition(2);
setPlace(true);
ENDSTYLE

END

-RUN

GRAPH FILE CAR
SUM RETAIL_COST DEALER_COST SALES
-* SUM PERCENT AVG
ACROSS CAR
ON GRAPH SAVE AS G2 FORMAT SVG
ON GRAPH SET GRAPHEDIT SERVER
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D ON
ON GRAPH SET VZERO ON
ON GRAPH SET GRID ON
ON GRAPH SET GRAPHSTYLE *
setGraphType(55);
setPiesPerRow(2);
setMarkerDisplay(true);
setConnectLineMarkers(false);
setConnectScatterMarkers(false);
setO1LabelDisplay(true);
setO1AxisSide(0);
setO1MajorGridDisplay(true);
setO1MajorGridStyle(0);
setO1MinorGridDisplay(false);
setAxisAssignment(0,0);
setSeriesType(0,1);
setAxisAssignment(1,0);
setSeriesType(1,1);
setY1LabelDisplay(true);
setY1AxisSide(0);
setY1MajorGridDisplay(true);
setY1MajorGridStyle(0);
setY1MinorGridDisplay(false);
setTextFormatPreset(getY1Label(),-1);
setTextFormatPattern(getY1Label(),"#.##");
setPieFeelerTextDisplay(1);
setPieFeelerTextFormatPattern("##.##");
setDataTextDisplay(true);
setDataTextFormat(4);
-****
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setLegendDisplay(true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setLegendPosition(2);
setPlace(true);
ENDSTYLE
END
-RUN

SET PAGE = OFF
TABLE FILE CAR
HEADING CENTER
"CAR REPORT"
PRINT COUNTRY  
IF COUNTRY NE 'ENGLAND'
ON TABLE SET ONLINE-FMT PDF 
-*ON TABLE PCHOLD FORMAT HTML
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.150000, 
TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=10, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=FOOTING,FONT=COURIER NEW,$
TYPE=REPORT,IMAGE=G1.SVG,POSITION=(0.25 2.75), SIZE=(5 7.5),$
TYPE=REPORT,IMAGE=G2.SVG,POSITION=(5.25 2.75), SIZE=(5 7.5),$
ENDSTYLE
END
-RUN