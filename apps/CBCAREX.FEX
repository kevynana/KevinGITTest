-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* 1/24/05 - DEB - ADDED CODE FOR GLOBAL CURRENCY
-* File CVIEW1EX.FEX
-* 12/14/13 - ADDED ADV PUR DAYS AND REFUSE CODE PER CLIENT RQ - DEB
-* 12/17/13  - ADDED REFUSAL_DESC PER CLIENT REQ - DEB
-* 6/25/14 - ADDED TRIP_PURPOSE PER CLIENT REQ - CA

-********************************************************************
-* MODIFICAIONS:
-*SET &ECHO=ALL;
-INCLUDE SETECHO
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

-SET &CARDATES = &&WEB_PATH || 'CARDATES.fex';

 
 

 
DEFINE FILE &&EXTRACT
  BLANK/A3 = '   ';
  BLANK2/A20 = ' ';
  BLANKITIN/A67 = ' ';
  DROP_OFF_DT/MDYY = DROP_DATE; 
  FLAG/A1 = 'C'; 
  IFLAG/A8 = IF DOD_TYPE EQ 'H' OR 'I' OR 'J' THEN 'ONLINE' ELSE 'OFFLINE';
  LEVEL_DESC/A60 = &&LDESC;
  NBR_DAYS/D12S = NUM_DAYS;
  NEW_RENTAL_AMT/D12.2CS = RENTAL_AMT;
  PICK_UP_DT/MDYY = PICKUP_DATE;

  RENTAL_DAYS/D12S = IF (NUM_DAYS LT 0) AND (NUM_CARS LT 0) THEN
                   ((NUM_DAYS * NUM_CARS) * (-1)) ELSE NUM_DAYS * NUM_CARS;
  TKTN/A10 = IF TKT_NUM EQ '0000000000' THEN ' ' ELSE  TKT_NUM;    
  TKT_TYPE/A8 = ' ';
   TRAN_MY/MTYY = INVOICE_DATE;
  TRAN_TYPE/A13 = ' ';
  VALAL_NM/A12 = 'UNDEFINED';
  PADV/P8 = 0;
END
-RUN

TABLEF FILE &&EXTRACT
PRINT 
  BLANK2 AS 'BLANK'
  BR_CL_IDX 
  BLANKITIN AS 'C_ITIN'
  NEW_RENTAL_AMT  
  FLAG
  BLANK AS 'FNL_DEST_AIRPORT'
  IFLAG
  INT_CODE
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3
  LEVEL4
  BLANK AS 'ORG_APC'
  PADV
  PASSNGR_NAME                      
  PNR_LOCATOR    
  PICK_UP_DT AS 'RTN_DT'
  REFUSE_CODE
  REFUSAL_DESC
  INVOICE_DATE AS 'TKT_DATE'
  TKTN AS 'TKT_NUM'
  TKT_TYPE
  TRAN_MY
  TRAN_TYPE
  INVOICE_DATE AS 'TRN_DATE'
  TRIP_PURPOSE
  RENTAL_DAYS  
  VALAL_NM
  PICK_UP_DT AS 'XFST_DPT'
  VENDOR_CODE
-INCLUDE &CARDATES 
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
-* &&WHERE1
-* &&WHERE2
-* &&WHERE3
-* &&WHERE4
-* &&WHERE5
-* &&WHERE6
&&WHERE7
&&WHERE8
-* &&WHERE9
-* &&WHERE10
-INCLUDE RPTPARMS
ON TABLE HOLD AS CBCARHLD
END
-RUN
 

TABLE FILE CBCARHLD
 
SUM  
    NEW_RENTAL_AMT AS 'CRAMT'
    RENTAL_DAYS  AS 'CRDAYS'
BY LEVEL_DESC    
BY PASSNGR_NAME
BY PNR_LOCATOR
BY VENDOR_CODE
BY TKT_NUM
ON TABLE HOLD AS CBCAR1
END
-RUN
 

MATCH FILE CBCARHLD
PRINT  BLANK  
  BR_CL_IDX  
  C_ITIN  
  NEW_RENTAL_AMT 
  FLAG
  FNL_DEST_AIRPORT  
  IFLAG  
  INT_CODE  
  INVOICE_NUM  
  LEVEL1  
  LEVEL2  
  LEVEL3  
  LEVEL4    
  ORG_APC 
  PADV
  REFUSE_CODE
  REFUSAL_DESC
  RTN_DT  
  TKT_DATE  
  TKT_TYPE 
  TRAN_MY  
  TRAN_TYPE  
  TRN_DATE
  TRIP_PURPOSE
  RENTAL_DAYS
  VALAL_NM
  
  XFST_DPT  
BY LEVEL_DESC    
BY PASSNGR_NAME
BY PNR_LOCATOR
BY TKT_NUM
ON TABLE HOLD
RUN
FILE CBCAR1
SUM CRAMT
    CRDAYS
BY LEVEL_DESC
BY PASSNGR_NAME
BY PNR_LOCATOR
BY TKT_NUM
AFTER MATCH HOLD AS CTWO OLD-OR-NEW
END
-RUN

 
TABLE FILE CTWO
PRINT
  BLANK  
  BR_CL_IDX  
  C_ITIN  
  CRAMT AS 'FARE_PAID' 
  FLAG
  FNL_DEST_AIRPORT  
  IFLAG  
  INT_CODE  
  INVOICE_NUM  
  LEVEL_DESC 
  LEVEL1  
  LEVEL2  
  LEVEL3  
  LEVEL4    
  ORG_APC  
  PADV
  PASSNGR_NAME  
  PNR_LOCATOR  
  REFUSE_CODE
  REFUSAL_DESC
  RTN_DT  
  TKT_DATE  
  TKT_NUM  
  TKT_TYPE 
  TRAN_MY  
  TRAN_TYPE  
  TRN_DATE
  TRIP_PURPOSE
  CRDAYS/D8 AS 'TRP_LEN'
  VALAL_NM
  
  XFST_DPT  
BY FLAG
ON TABLE HOLD AS CARHOLD2
END
-RUN


TABLE FILE CARHOLD2
PRINT
  BLANK  
  BR_CL_IDX  
  C_ITIN  
  FARE_PAID
  FNL_DEST_AIRPORT  
  IFLAG  
  INT_CODE  
  INVOICE_NUM  
  LEVEL_DESC 
  LEVEL1  
  LEVEL2  
  LEVEL3  
  LEVEL4    
  ORG_APC  
  PASSNGR_NAME  
  PNR_LOCATOR  
  REFUSE_CODE
  REFUSAL_DESC
  RTN_DT  
  TKT_DATE  
  TKT_NUM  
  TKT_TYPE 
  TRAN_MY  
  TRAN_TYPE  
  TRN_DATE
  TRP_LEN
  TRIP_PURPOSE
  VALAL_NM
  XFST_DPT  
  PADV
BY FLAG
ON TABLE HOLD AS CBCARFNL FORMAT FOCUS INDEX FLAG

END
-RUN
 





 



 
