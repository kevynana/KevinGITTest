-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
 
-*                     FOCEXEC: UAVW48DT
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*7/24/06    STEVE          New creation from AVIW48DT due to CCC UDID
-* 8/23/06 - DEB - Added udid BPAY_AMT BUS_FAR PAY_AMT TIER
-*1/15/14  - joy - Added PNR_LOCATOR to the TENAS report
-*2/27/14 - joy - Added EX for Metlife VTC UDID report  
-*10/7/14    DEB  ADDED ROUTINE FOR MKTRND
-*2/10/15   DEB S-07357 ADDED ROUTINE FOR TMBTRND  
-* S-13531 ADDED LOGIC FOR NEW REPORT KFUDTRN JEM 01/14/16
-*3/21/16-S-16901-JEM Added LEVEL6 LEVEL3 AROLL_LEV2 for new report CHTRNUD1
-*7/11/16  DLV               S-20630   Carried through EMP_ID
-*09/12/16  DLV S-24526 - Changed all TRND report to show literal ID-level names in title
-*11/01/16-JEM-S-26559-Added norecords flag to ALL routine
-*12/21/16 - DLV - S-28295  Changed REFUND define to be similar to FULL_RFNDS PART_RFNDS in
-*                          AVIW23DT
-*3/16/17-JEM-S-31889 Added logic for new report ABTRNDGN
-*4/5/17-JEM-S-32461 Adding EBT UDID
-*4/26/2017-JEM-S-33318-updated logic for no records report

-**************************************************************************
-INCLUDE SETECHO
SET ASNAMES=ON
-RUN  

-IF '&&SETF.EVAL' EQ 'TDUDTRND' THEN GOTO SKIPudid;
-INCLUDE RETUDID
-RUN

-SKIPudid;

DEFINE FILE &&RPT_HOLD ADD

COMM/D12.2 = IF VOID_DATE EQ 0 THEN SEG_COM ELSE 0;
GCOMM/D16.2 = IF VOID_DATE EQ 0 THEN GSEG_COM ELSE 0;
PAID_FARE/D12.2 = IF VOID_DATE EQ 0 THEN FARE_PAID ELSE 0;
GPAID_FARE/D16.2 = IF VOID_DATE EQ 0 THEN PAID_FAREX ELSE 0;
FARE/D12.2 = IF VOID_DATE EQ 0 THEN SEG_AMT ELSE 0;
GFARE/D16.2 = IF VOID_DATE EQ 0 THEN GSEG_AMT ELSE 0;
EXEC_FLAG/A4 = IF DOD_TYPE EQ 'J' OR 'K' OR 'L' OR 'M' OR 'N' THEN 'EXEC' ELSE ' ';
MANI_FLAG/A8 = IF DOD_TYPE EQ 'J' OR 'K' OR 'L' OR 'M' OR 'N' THEN 'EXEC' ELSE 'NON EXEC';
INTERNET_FLAG/A41 = IF DOD_TYPE EQ 'H' THEN 'AGENT ASSIST' ELSE
  IF DOD_TYPE EQ 'I' THEN 'ONLINE BOOKINGS' ELSE
  IF DOD_TYPE EQ 'J' THEN 'EXECUTIVE ONLINE BOOKINGS' ELSE
  IF DOD_TYPE EQ 'M' THEN 'EXECUTIVE EXCHANGE FROM AN ONLINE BOOKING' ELSE
  IF DOD_TYPE EQ 'X' THEN 'EXCHANGE FROM AN ONLINE BOOKING' ELSE
  IF DOD_TYPE EQ 'A' THEN 'AGENCY WEB BOOKINGS' ELSE
  IF DOD_TYPE EQ 'L' THEN 'EXECUTIVE WEB BOOKINGS' ELSE
  IF DOD_TYPE EQ 'N' THEN 'EXECUTIVE AGENCY WEB BOOKINGS' ELSE
  IF DOD_TYPE EQ 'S' THEN 'WEB BOOKINGS' ELSE
  IF DOD_TYPE EQ 'K' THEN 'EXECUTIVE TRADITIONAL BOOKINGS' ELSE
  'TRADITIONAL BOOKINGS'; 	
TAX/D12.2 = IF VOID_DATE EQ 0 THEN SEG_TAX ELSE 0;
GTAX/D16.2 = IF VOID_DATE EQ 0 THEN GSEG_TAX ELSE 0;
-*REFUND/D9CS    = IF (VOID_DATE EQ 0) AND
-*                    (SEG_COUNT LE 0) AND
-*                    (TKT_SORT NE LAST TKT_SORT) AND
-*                    (EMBARK NE 'DT1' OR 'RF1' OR 'FP3') AND
-*                    (RF_FLAG NE ' ') THEN 1 ELSE 0;
REFUND/D9 = IF ((VOID_DATE EQ 0) AND (RF_FLAG EQ 'F') AND (DOC_TYPE NE '1')
           AND (TKT_NUM NE LAST TKT_NUM) AND (SEG_COUNT LT 0)) THEN 1 ELSE  
              IF ((VOID_DATE EQ 0) AND (RF_FLAG EQ 'P') AND (TKT_NUM 
           NE LAST TKT_NUM) AND (SEG_COUNT LE 0)) THEN 1 ELSE 0; 
EXMCOS/D9 = IF (EX_FLAG NE ' ') AND (DOC_TYPE EQ '1') AND (EXCHG_SALE 
	NE ' ') THEN 1 ELSE 0;  


END
-RUN

-IF &&CURRENCY NE 'USD' THEN GOTO CHECK1 ELSE GOTO NEXT;
-CHECK1;
-IF &&SETF EQ 'ABTRND' OR 'ABTRNDWN' THEN GOTO ABTRND ELSE GOTO CHECK2;
-CHECK2;
-IF &&SETF EQ 'ABTRANS1' THEN GO TO ABTRANS1 ELSE GOTO OTHER;

-ABTRND;
-SET &&SUBHEAD = <NAMEC;
-SET &GFAR_CUR = 'FARE, (' | &&CURRENCY || ')';
-SET &GTAX_CUR = 'TAX, (' | &&CURRENCY || ')';
-SET &GCOM_CUR = 'COMMISSION, (' | &&CURRENCY || ')';
-SET &&PRINT5= ' GSEG_AMT1/D16.2CS AS ' | '''&GFAR_CUR.EVAL''';
-SET &&PRINT6= ' GSEG_TAX1/D16.2CS AS ' | '''&GTAX_CUR.EVAL''';
-SET &&PRINT10= 'GXCOMM/D16.2CS AS ' | '''&GCOM_CUR.EVAL''';

-GOTO NEXT;

-ABTRANS1;
-SET &&SUBHEAD = <NAMEC;
-SET &GFAR_CUR = 'FARE, (' | &&CURRENCY || ')';
-SET &GTAX_CUR = 'TAX, (' | &&CURRENCY || ')';
-SET &GCOM_CUR = 'COMMISSION, (' | &&CURRENCY || ')';
-SET &&PRINT5= ' GSEG_AMT1/D16.2CS AS ' | '''&GFAR_CUR.EVAL''';
-SET &&PRINT6= ' GSEG_TAX1/D16.2CS AS ' | '''&GTAX_CUR.EVAL''';
-SET &&PRINT10= 'GFEE/D16.2CS AS ' | '''&GCOM_CUR.EVAL''';

-GOTO NEXT;



-OTHER;

-SET &&SUBHEAD = <NAMEC;
-SET &TAMT_CUR = 'FARE,PAID, (' | &&CURRENCY || ')';
-SET &&PRINT5='GFARE_AMT/D16.2CS AS ' | '''&TAMT_CUR.EVAL''';



-NEXT;

TABLE FILE &&RPT_HOLD
SUM COMM AS 'TCOMM'
    GCOMM/D16.2CS AS 'GTCOMM'
    EXCHGS AS 'TEXCH'
    FARE AS 'TFP'
    GFARE/D16.2CS AS 'GTFP'
    PAID_FARE AS 'TFARE'
    GPAID_FARE/D16.2CS AS 'GTFARE'
    MCOS AS 'TMCO'
    EXMCOS AS 'TEXMCO'
    NET_TKT_CNT1 AS 'TNET'
    REFUND AS 'TREF'
    TAX AS 'TTAX'
    GTAX/D16.2CS AS 'GTTAX'
    VOIDS AS 'TVOID'
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
ON TABLE HOLD AS AIRHOLD1
END
-RUN


TABLE FILE &&RPT_HOLD
PRINT ACCT_FLAG
      AGENT_NUM
      AIR_KEY	
      AIRLINE
      AROLL_LEV2
      AROLL_LEV4
      AROLL_LEV5
      BKD_ONLINE
      BR_CL_IDX	
      C_ITIN
      CLASS_CAT
      CLIENT_NUM
      COMM
      CURR1X
      DOC_TYPE
      DOD_DESC
      DPT_TIME
      EMAIL_ADDR
      EMB_APT_CD
      EMP_ID
      EXCHGS
      EXMCOS
      EX_FLAG
      EXEC_FLAG
      FARE_PAID
      FST_DPT_DATE
      GEOAREA
      GCOMM
      GFARE
      GPAID_FARE
      GTAX	
      FLIGHT	
      IDFLAG
      INT_CODE
      INTERNET_FLAG	
      LEVEL1	
      LEVEL2	
      LEVEL3
      LEVEL4
      LEVEL5
      LEVEL6
      LEVEL7
      LVL3
      MANI_FLAG
      MCOS
      NAMEC
      NET_TKT_CNT1
      NEW_SEG_MILES
      ONL_FLAG
      PAID_FARE
      PNR_LOCATOR
      RESV_BRANCH
      RTE_APT_CD
      RF_FLAG
      SEG_COUNT	
      TICKET_BRANCH
      TKT_NUM	
      TKT_TYPE
      TRAN_MYA	
      VAL_AIRLINE
      XDPT_DT	
      XTRAN_DT
      DEPT_CD
      ACCT_CD
      SOURCE_CD
      PRJCT_CD
      OFFICE_CD
      XFST_DPT
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
BY SEG_NBR
ON TABLE HOLD AS XTWO
END
-RUN

MATCH FILE XTWO
PRINT ACCT_FLAG
      AGENT_NUM
      AIR_KEY	
      AIRLINE
      AROLL_LEV2
      AROLL_LEV4
      AROLL_LEV5
      BKD_ONLINE
      BR_CL_IDX	
      C_ITIN
      CLASS_CAT
      CLIENT_NUM
      COMM
      CURR1X
      DOC_TYPE	
      DOD_DESC
      DPT_TIME
      EMAIL_ADDR
      EMB_APT_CD
      EMP_ID
      EXCHGS
      EXMCOS
      EX_FLAG
      EXEC_FLAG
      FARE_PAID	
      FST_DPT_DATE
      FLIGHT
      GEOAREA
      GCOMM
      GFARE
      GPAID_FARE
      GTAX	
      IDFLAG	
      INT_CODE
      INTERNET_FLAG	
      LEVEL1	
      LEVEL2	
      LEVEL3
      LEVEL4
      LEVEL5
      LEVEL6
      LEVEL7
      MANI_FLAG
      LVL3
      MCOS
      NAMEC
      NET_TKT_CNT1
      NEW_SEG_MILES
      ONL_FLAG
      PAID_FARE
      PNR_LOCATOR
      RESV_BRANCH
      RF_FLAG
      RTE_APT_CD	
      SEG_COUNT
      TICKET_BRANCH
      TKT_NUM	
      TKT_TYPE      
      TRAN_MYA	
      VAL_AIRLINE
      XDPT_DT	
      XTRAN_DT
      DEPT_CD
      ACCT_CD
      SOURCE_CD
      PRJCT_CD
      OFFICE_CD
      XFST_DPT
      SEG_NBR
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
-* BY SEG_NBR
ON TABLE HOLD
RUN
FILE AIRHOLD1
PRINT GTCOMM
      GTFARE
      GTFP
      GTTAX 
      TCOMM
      TEXCH
      TEXMCO
      TFARE
      TFP
      TMCO
      TNET
      TREF
      TTAX
      TVOID
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
AFTER MATCH HOLD AS AIRHOLD2 OLD-OR-NEW
END
-RUN


DEFINE FILE AIRHOLD2
FLAG/A1 = IF SEG_NBR EQ '01' OR RF_FLAG EQ 'P' OR EX_FLAG EQ 'P'
          OR DOC_TYPE EQ '1' THEN 'Y' ELSE 'N';
END
-RUN

TABLE FILE AIRHOLD2
PRINT XDPT_DT AS 'ODPT_DT'
      AIRLINE
BY LEVEL_DESC
BY TKT_NUM
-*IF SEG_NBR EQ '01'
IF FLAG EQ 'Y'
-* WHERE XDPT_DT NE ' '
WHERE AIRLINE NE ' '
ON TABLE HOLD AS ONEHLD FORMAT ALPHA
END
-RUN

MATCH FILE AIRHOLD2
PRINT ACCT_FLAG
      AGENT_NUM
      AIR_KEY
      AROLL_LEV2
      AROLL_LEV4
      AROLL_LEV5
      BKD_ONLINE
      BR_CL_IDX
      C_ITIN
      CLASS_CAT
      CLIENT_NUM
      COMM
      CURR1X
      DOC_TYPE
      DOD_DESC
      DPT_TIME
      EMAIL_ADDR
      EMB_APT_CD
      EMP_ID
      EXCHGS
      EXEC_FLAG
      EXMCOS
      FARE_PAID	
      FLIGHT
      FST_DPT_DATE
      GEOAREA
      GCOMM
      GFARE
      GPAID_FARE
      GTAX
      GTCOMM
      GTFARE
      GTFP
      GTTAX 	
      IDFLAG
      INT_CODE
      INTERNET_FLAG
      LEVEL1	
      LEVEL2	
      LEVEL3
      LEVEL4
      LEVEL5
      LEVEL6
      LEVEL7
      LVL3
      MANI_FLAG
      MCOS
      NAMEC
      NET_TKT_CNT1
      NEW_SEG_MILES
      ONL_FLAG
      PAID_FARE
      PNR_LOCATOR
      RESV_BRANCH	
      RTE_APT_CD	
      SEG_COUNT
      SEG_NBR
      TICKET_BRANCH
      TCOMM
      TEXCH
      TEXMCO
      TFARE
      TFP
      TMCO
      TNET
      TREF
      TTAX
      TVOID
      TKT_SORT
      TKT_TYPE      
      TRAN_MYA
      TRN_DATE	
      VAL_AIRLINE
      XDPT_DT
      XPSNGR_NM	
      XTRAN_DT
      DEPT_CD
      ACCT_CD
      SOURCE_CD
      PRJCT_CD
      OFFICE_CD
      XFST_DPT
BY LEVEL_DESC
BY TKT_NUM
-* ON TABLE HOLD
RUN
FILE ONEHLD
SUM ODPT_DT
    AIRLINE
BY LEVEL_DESC
BY TKT_NUM
AFTER MATCH HOLD AS XTHREE OLD-OR-NEW
END
-RUN





TABLE FILE XTHREE
PRINT ACCT_FLAG
      AGENT_NUM
      AIRLINE
      AIR_KEY
      AROLL_LEV2
      AROLL_LEV4
      AROLL_LEV5
      BKD_ONLINE
      BR_CL_IDX
      C_ITIN
      CLASS_CAT
      CLIENT_NUM
      COMM
      CURR1X
      DOC_TYPE	
      DOD_DESC
      DPT_TIME
      EMAIL_ADDR
      EMB_APT_CD
      EMP_ID
      EXCHGS
      EXEC_FLAG
      EXMCOS
      FARE_PAID	
      FLIGHT
      FST_DPT_DATE
      GEOAREA
      GCOMM
      GFARE
      GPAID_FARE
      GTAX
      GTCOMM
      GTFARE
      GTFP
      GTTAX 	
      IDFLAG
      INT_CODE
      INTERNET_FLAG
      LEVEL_DESC
      LEVEL1	
      LEVEL2	
      LEVEL3
      LEVEL4
      LEVEL5
      LEVEL6
      LEVEL7
      LVL3
      MANI_FLAG
      MCOS
      NAMEC
      NET_TKT_CNT1
      NEW_SEG_MILES
      ONL_FLAG
      PAID_FARE
      PNR_LOCATOR
      RESV_BRANCH	
      RTE_APT_CD	
      SEG_COUNT
      TICKET_BRANCH
      TCOMM
      TEXCH
      TEXMCO
      TFARE
      TFP
      TMCO
      TNET
      TREF
      TTAX
      TVOID
      TKT_NUM
      TKT_TYPE
      
      TRAN_MYA
      TRN_DATE	
      VAL_AIRLINE
      XDPT_DT
      XPSNGR_NM	
      XTRAN_DT
      DEPT_CD 
      ACCT_CD
      SOURCE_CD
      PRJCT_CD
      OFFICE_CD
      ODPT_DT
      XFST_DPT
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD AS AIRHOLD3
END
-RUN

-NEXTSTEP

-JOIN
JOIN AGENT_NUM IN AIRHOLD3 TO AGENT IN AGENT AS J1
-RUN


TABLE FILE AIRHOLD3
PRINT ACCT_FLAG
      AGENT
      AGENT_NUM
      AIRLINE
      AIR_KEY
      AROLL_LEV2
      AROLL_LEV4
      AROLL_LEV5
      BKD_ONLINE
      BR_CL_IDX
      C_ITIN
      CLASS_CAT
      CLIENT_NUM
      COMM
      CURR1X
      DOC_TYPE	
      DOD_DESC
      DPT_TIME
      EMAIL_ADDR
      EMB_APT_CD
      EMP_ID
      EXCHGS
      EXEC_FLAG
      EXMCOS
      FARE_PAID	
      FLIGHT
      GEOAREA
      GCOMM
      GFARE
      GPAID_FARE
      GTAX
      GTCOMM
      GTFARE
      GTFP
      GTTAX 	
      IDFLAG
      INT_CODE
      INTERNET_FLAG
      LEVEL_DESC
      LEVEL1	
      LEVEL2	
      LEVEL3
      LEVEL4
      LEVEL5
      LEVEL6
      LEVEL7
      LVL3
      MANI_FLAG
      MCOS
      NAMEC
      NET_TKT_CNT1
      NEW_SEG_MILES
      ONL_FLAG
      PAID_FARE
      PNR_LOCATOR
      RESV_BRANCH	
      RTE_APT_CD	
      SEG_COUNT
      SEG_NBR
      TICKET_BRANCH
      TCOMM
      TEXCH
      TEXMCO
      TFARE
      TFP
      TMCO
      TNET
      TREF
      TTAX
      TVOID
      TKT_NUM
      TKT_SORT
      TKT_TYPE      
      TRAN_MYA
      TRN_DATE	
      VAL_AIRLINE
      XDPT_DT
      XPSNGR_NM	
      XTRAN_DT
      DEPT_CD 
      ACCT_CD
      SOURCE_CD
      PRJCT_CD
      OFFICE_CD
      ODPT_DT
      XFST_DPT
BY AIR_KEY
ON TABLE HOLD AS AIRHOLD4
END
-RUN


-IF '&&SETF.EVAL' EQ 'TDUDTRND' THEN GOTO EXTENAS;
-IF '&&SETF.EVAL' EQ 'MSTRND' THEN GOTO EXMUSCO;
-IF '&&SETF.EVAL' EQ 'MXTRNVTC' THEN GOTO EXMETX;
-IF '&&SETF.EVAL' EQ 'NYTRND' THEN GOTO EXNYL;
-IF '&&SETF.EVAL' EQ 'CHTRNDUD' OR 'CHTRNUD1' THEN GOTO EXCH2M;
-IF '&&SETF.EVAL' EQ 'ALTRND' THEN GOTO ALL;
-IF '&&SETF.EVAL' EQ 'KFUDTRN' THEN GOTO KAUFF;
-IF '&&SETF.EVAL' EQ 'KMCTRND' THEN GOTO KMC;
-IF '&&SETF.EVAL' EQ 'STUDTRN' THEN GOTO STAPLE;
-IF '&&SETF.EVAL' EQ 'MANITRND' THEN GOTO MANI;
-IF '&&SETF.EVAL' EQ 'ALUTRND' THEN GOTO ALUTII;
-IF '&&SETF.EVAL' EQ 'SPGTRND' THEN GOTO SPG;
-IF '&&SETF.EVAL' EQ 'DOLTRND' THEN GOTO DOLE;
-IF '&&SETF.EVAL' EQ 'TNTRND' THEN GOTO TENAS;
-IF '&&SETF.EVAL' EQ 'MKTRND' THEN GOTO MERK;
-IF '&&SETF.EVAL' EQ 'TMBTRND' THEN GOTO TMOBIL;
-IF '&&SETF.EVAL' EQ 'ABTRNDGN' THEN GOTO UDABTRNGN;

-EXTENAS;
EX UDTENAS2
-RUN

-GOTO CONTINUE;



-EXMUSCO;
EX UDMUSCO
-RUN

-GOTO CONTINUE;


-EXMETX;
EX UDMXVTC
-RUN

-GOTO CONTINUE;

-EXNYL;
EX UDNYL
-RUN

-GOTO CONTINUE;


-EXCH2M;
EX UDCHTRN
-RUN

-GOTO CONTINUE;

-ALL
EX UDALL
-RUN
-IF &&NOFE2REC EQ 'Y' GOTO NORECORDS;
-GOTO CONTINUE;

-KAUFF
EX UDKAUFFTRN
-RUN
-GOTO CONTINUE;


-ALUTII
EX UDALUTII
-RUN
-GOTO CONTINUE;


-KMC;
EX UDKMCTRN
-RUN
-GOTO CONTINUE;


-STAPLE;
EX UDSTTRN
-RUN
-GOTO CONTINUE;

-MANI;
EX UDMANI
-RUN
-GOTO CONTINUE;

-SPG;
EX UDSPGT
-RUN
-GOTO CONTINUE;


-DOLE
EX UDDOLE
-RUN
-GOTO CONTINUE;


-TENAS;
EX UDTENAS1
-RUN
-GOTO CONTINUE;

-MERK
EX UDMERK
-RUN
-GOTO CONTINUE;

-UDABTRNGN
EX UDABTRNGN
-RUN

-IF &&NOGNREC EQ 'Y' GOTO NORECORDS;
-GOTO CONTINUE;


-TMOBIL
EX UDTMOBIL
-RUN


-CONTINUE  


-IF &&DRILLED_RUN EQ 'N' GOTO SKIP_DRIL;

-************************************************************
-* INCLUDE PROGRAM TO GEN WHERE STATEMENTS
-************************************************************
-SET &&DRILLRPT = 'AIRHOLD5';
-INCLUDE DRILWHRS
-************************************************************
-SKIP_DRIL 

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

-INCLUDE DATAVROLL
-RUN


TABLE FILE AIRHOLD5
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
-IF '&&SETF.EVAL' EQ 'TNTRND' GOTO TENASPRINT;

-*
-**********************************************************************
-* Print statement with fields passed from the user profile database
-**********************************************************************
-*
-IF '&&SETF.EVAL' EQ 'CHTRNDUD' THEN GOTO CH2M;
-IF '&&SETF.EVAL' EQ 'MSTRND' THEN GOTO MUSCO;
-IF '&&SETF.EVAL' EQ 'TDUDTRND' THEN GOTO TENAS;
-IF '&&SETF.EVAL' EQ 'ABTRNDGN' GOTO ABTRNDGN;

-IF '&&SETF.EVAL' EQ 'ALTRND' OR 'ALUTRND' OR 'KMCTRND' OR 'MANITRND' OR 'MKTRND' OR 
- 'NYTRND' OR 'SPGTRND' OR 'TMBTRND' THEN GOTO LVLinfo ELSE GOTO NOlvlINFO;

-CH2M;
 

&&PRINT1
EMP_ID &EMPID
LEVEL1 &LV1
AROLL_LEV5 AS 'DEPT' 
LEVEL2 &LV2
-GOTO PRINT3;
 
-MUSCO;

&&PRINT1

LEVEL1 &LV1
EMP_ID &EMPID
-GOTO PRINT3;
 
-TENAS
 
&&PRINT1
EMP_ID &EMPID
LEVEL2 &LV2
-GOTO PRINT3;


-LVLinfo;

&&PRINT1
EMP_ID &EMPID
LEVEL1 &LV1
LEVEL2 &LV2
LEVEL3 &LV3
-GOTO PRINT3;

 
-NOlvlINFO
&&PRINT1
&&PRINT2 
-PRINT3
&&PRINT3
&&PRINT4
&&PRINT5
&&PRINT6
&&PRINT7
&&PRINT8
&&PRINT9
&&PRINT10

 
-GOTO NOTENAS;
-TENASPRINT;
SUM SUM XPSNGR_NM AS 'PASSENGER,NAME' ONL_FLAG AS 'O/T/W FLAG' 
IDFLAG AS 'I/D,FLAG' EXEC_FLAG AS 'EXECUTIVE' AGENT_NUM AS 'AGENT,NUMBER' TKT_NUM AS 'TICKET,NUMBER' PNR_LOCATOR AS 'PNR'
VAL_AIRLINE AS 'VALIDATING,AIRLINE' CLASS_CAT AS 'CLASS,CATEGORY' SEG_AMT1 AS 'FARE' SEG_TAX1 AS 'TAX' FARE_AMT AS 'TOTAL,FARE'
NET_TKT_CNT1 AS 'NEW,SALES' EXCH_CNT AS 'EXCHGS,SALES' EMCO_CNT AS 'EXCHG,MCOS' MCO_CNT AS 'MCOS' REFUNDS AS 'REFUNDS'
VOID_CNT AS 'VOIDS' TOTAL_TRAN AS 'CHARGED,TRANSACTIONS'
C1 AS 'PROJ CODE OR %' C2 AS 'PROJ CODE OR %' C3 AS 'PROJ CODE OR %' C4 AS 'PROJ CODE OR %' C5 AS 'PROJ CODE OR %' C6 AS 'PROJ CODE OR %'
C6 AS 'PROJ CODE OR %' C7 AS 'PROJ CODE OR %' C8 AS 'PROJ CODE OR %' C9 AS 'PROJ CODE OR %' C10 AS 'PROJ CODE OR %' C11 AS 'PROJ CODE OR %'
C12 AS 'PROJ CODE OR %' C13 AS 'PROJ CODE OR %' C14 AS 'PROJ CODE OR %' C15 AS 'PROJ CODE OR %' C16 AS 'PROJ CODE OR %' C17 AS 'PROJ CODE OR %'
C18 AS 'PROJ CODE OR %' C19 AS 'PROJ CODE OR %' C20 AS 'PROJ CODE OR %' C21 AS 'PROJ CODE OR %' C22 AS 'PROJ CODE OR %' C23 AS 'PROJ CODE OR %'
C24 AS 'PROJ CODE OR %' C25 AS 'PROJ CODE OR %'

-NOTENAS;
-GOTO BYCONT;

-ABTRNDGN
SUM XPSNGR_NM AS 'PASSENGER,NAME' 
EMP_ID &EMPID
LEVEL1 &LV1
LEVEL2 &LV2
LEVEL3 &LV3
LEVEL4 &LV4
LEVEL5 &LV5
LEVEL6 &LV6
GRP_NUM AS 'GROUP,NUMBER'
PNR_LOCATOR AS 'PNR'
ONL_FLAG AS 'ONLINE/,TRADITIONAL/,WEB FLAG'
DOD_DESC AS 'BOOKING TYPE'
IDFLAG AS 'I/D,FLAG'
EXEC_FLAG AS 'EXECUTIVE'
EBT_TYPE AS 'EVENTS,BOOKING,TYPE'
AGENT_NUM AS 'AGENT,NUMBER'
TKT_NUM AS 'TICKET,NUMBER'
XTRAN_DT AS 'TRAN,DATE' 
VAL_AIRLINE AS 'VALIDATING,AIRLINE'
SEG_COUNT AS '# OF AIRLINE,SEGMENTS'
XFST_DPT AS 'DEPT,DATE'
C_ITIN AS 'ITIN' 
SEG_AMT1 AS 'FARE'
SEG_TAX1 AS 'TAX' 
NET_TKT_CNT1 AS 'NEW,SALES'
EXCH_CNT AS 'EXCHGS,SALES' EMCO_CNT AS 'EXCHG,MCOS'
MCO_CNT AS 'MCOS' REFUNDS AS 'REFUNDS' VOID_CNT AS 'VOIDS'
TOTAL_TRAN AS  'CHARGED,TRANSACTIONS' XCOMM AS 'COMMISSION'

BY XPSNGR_NM NOPRINT BY LEVEL1 NOPRINT BY LEVEL2 NOPRINT
BY LEVEL3 NOPRINT BY LEVEL4 NOPRINT BY GRP_NUM NOPRINT BY ONL_FLAG NOPRINT
BY TKT_NUM NOPRINT BY XTRAN_DT NOPRINT
BY VAL_AIRLINE NOPRINT
-GOTO ONCONT;

-BYCONT;
-*
-**********************************************************************
-* By statements (one per field)
-**********************************************************************
-*
&&BY1
&&BY2
&&BY3
&&BY4
&&BY5
&&BY6
&&BY7
&&BY8
&&BY9
&&BY10

-*
-*********************************************************************
-*DATE           NAME               DESCRIPTION 
-*8/18/00      IBISTL-KR            INCLUDE WHERE STATEMENTS WHEN
-*                                  DRILLED_RUN EQ 'Y'.
-*********************************************************************
-*

-ONCONT;

-**********************************************************************
-* Where statements for Drilled Report
-**********************************************************************
-*
-IF &&DRILLED_RUN EQ 'N' GOTO SKIP_WHR;
-INCLUDE &&DRILLWHR
-SKIP_WHR
-*
-**********************************************************************
-* On Table statements for code appropriate to On Table commands
-**********************************************************************
-*
&&ONTABLE1
&&ONTABLE2
&&ONTABLE3
&&ONTABLE4
&&ONTABLE5
&&ONTABLE6
&&ONTABLE7
&&ONTABLE8
&&ONTABLE9
&&ONTABLE10

-*
-**********************************************************************
-* Report specific footer(s)
-**********************************************************************
-*
-INCLUDE FOOTERTR
-*
-*ON TABLE SET STYLE &&SMSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**************************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *

-INCLUDE &&PASTYS
ENDSTYLE
-*
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
-GOTO XXIT;


-NORECORDS
-RUN

 

-TYPE "NORECORDSDTRPT"

-SET &INST_KEY = &&IKEY;

TABLE FILE BRPTINST
PRINT PAIR_DB RPT_GROUP RPT_STREAM GLOBAL_PARM USE_PARM INST_KEY
WHERE INST_KEY EQ &INST_KEY
ON TABLE SAVE AS PAIRDB
END
-RUN

-READ PAIRDB &PAIRDB.A1. &RPTGRP.A3. &RPTSTREAM.A8. &SETFILE.A8. &VIEW.A8.
-CLOSE PAIRDB
 
-SET &RPTGRP = '&RPTGRP.EVAL';
-SET &VIEW = '&VIEW.EVAL';
-SET &STREAM = '&RPTSTREAM.EVAL';

-SET &HEADER = IF &RPTGRP EQ 'ADD' OR 'CDD' OR 'HDD' THEN 'NORECHDRDD' ELSE 'NORECHDR';
-RUN


-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN &HEADER ELSE  
-              IF &RPTGRP EQ 'ADD' OR 'CDD' OR 'HDD' THEN 'HDREXLSDD' ELSE 
-              IF &STREAM EQ 'AIR_BNM' THEN 'HDREXLSDD' ELSE 'HDREXLS';

-RUN


-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE 'NORECSTY';

JOIN SET_KEY IN BRPTINST TO SET_KEY IN BRPT_SET AS J1
-RUN

DEFINE FILE BRPTINST
EMPTY/A35 = 'NO RECORDS FOUND FOR THIS SELECTION';
NOWTOD/A8 WITH INST_KEY = HHMMSS (NOWTOD);
END
TABLE FILE BRPTINST
-INCLUDE &&PAHDR
PRINT EMPTY AS 'REPORT,MESSAGE'
BY ROLLUP_CODE AS 'ROLLUP,CODE'
BY RPT_NAME AS 'REPORT,NAME'
BY SELECT_LEV AS 'BREAK,LEVEL'
IF INST_KEY EQ &&IKEY
IF RECORDLIMIT EQ 1
-INCLUDE FOOTERDT
ON TABLE SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET PAGE-NUM OFF
ON TABLE SET STYLE *
-INCLUDE &&PASTYD
ENDSTYLE
 
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN



-XXIT;