FILEDEF * CLEAR
FI WLT DISK D:\FOCTEMP\WLT.DAT
-RUN

USE ADD
  Z:\TNT\TTRACKER\SUDATA\STATS.FOC
END
-RUN

-* -SET &ECHO  = ALL ;
-SET &ZYR   = TODAY('A8');
-SET &ZSE  = HHMMSS('A8');
-SET &&DT  = &ZYR ;
-SET &&TM  = &ZSE ;

-SET &&UKEY = '''' || &&XNAME || '''';
-SET &&UKEY = UPCASE(10,&&UKEY,'A10');

SET ALL=ON
SET ASNAMES=ON
SET YRTHRESH=30

DEFINE FILE STATS
XL00/A10 WITH USERID = '&&XNAME'   ;
XL01/A10 = EDIT(XL00,'9999999999') ;
XL02/A10 = UPCASE(10,XL01,XL02);
XL03/I6  = 0 ;
END
TABLE FILE STATS
BY XL00 NOPRINT
PRINT XL02 AS 'USERID'
      XL03 AS 'TRANSID'
ON TABLE HOLD
END
MODIFY FILE STATS
 LOG INVALID MSG OFF
 LOG DUPL    MSG OFF
 LOG FORMAT  MSG OFF
 LOG NOMATCH MSG OFF
FIXFORM FROM HOLD
MATCH USERID TRANSID
 ON NOMATCH INCLUDE
 DATA ON HOLD
END
-RUN

DEFINE FILE STATS
XL00/I6 = TRANSID + 1 ;
XL01A/A10 WITH USERID = '&&XNAME' ;
XL01B/A10    = UPCASE(40,XL01A,XL01B);
XL02A/A60    = '&&RN' ;
XL03A/A8     = '&&VNAME';
XL04A/A10    = '&&FM_PM' ;
XL04B/A8     = EDIT(XL04A,'99$99$9999') ;
XL04C/I8MDYY = EDIT(XL04B) ;
XL04D/MDYY   = XL04C ;
XL05A/A10    = '&&TO_PM' ;
XL05B/A8     = EDIT(XL05A,'99$99$9999') ;
XL05C/I8MDYY = EDIT(XL05B) ;
XL05D/MDYY   = XL05C ;
XL06A/A10    = '&&FX_PM' ;
XL06B/A8     = EDIT(XL06A,'99$99$9999') ;
XL06C/I8MDYY = EDIT(XL06B) ;
XL06D/MDYY   = XL06C ;
XL07A/A10    = '&&TX_PM' ;
XL07B/A8     = EDIT(XL07A,'99$99$9999') ;
XL07C/I8MDYY = EDIT(XL07B) ;
XL07D/MDYY   = XL07C ;
XL08A/A8     = '&&DT' ;
XL08B/A8     = EDIT(XL08A,'99$99$99') ;
XL08C/I6MDY  = EDIT(XL08B) ;
XL08D/MDYY   = XL08C ;
XL09A/A8     = '&&TM';
XL09B/A6     = EDIT(XL09A,'99$99$99');
XL10/A8      = '&&RNAME'  ;
XL12/A22     = '&&IDKEY';
XL13/A60     = '&&RS' ;
XL14/A8      = '&&STREAM';
XL15/A10     = '&&OUTFMT';
XL16/A10     = '&&OUTTO' ;
END
TABLE FILE STATS
BY XL01A NOPRINT
BY TRANSID NOPRINT
PRINT XL01B AS 'USERID'
      XL00  AS 'TRANSID'
      XL10  AS 'ROLLUP_CODE'
      XL12  AS 'INSTANCE_ID'
      XL13  AS 'SET_NAME'
      XL02A AS 'REPORT_NAME'
      XL03A AS 'VIEW_NAME'
      XL14  AS 'STREAM'
      XL15  AS 'FORMAT_TYPE'
      XL16  AS 'RUN_TYPE'
      XL04D AS 'C_FROM_DATE1' 
      XL05D AS 'C_TO_DATE1'
      XL06D AS 'C_FROM_DATE2'
      XL07D AS 'C_TO_DATE2'
      XL08D AS 'DATESTAMP'
      XL09A AS 'TIMESTAMP'
IF RECORDLIMIT EQ 1
IF USERID EQ &&UKEY.EVAL
ON TABLE HOLD
END
MODIFY FILE STATS
FIXFORM FROM HOLD
MATCH USERID
ON NOMATCH INCLUDE
MATCH USERID TRANSID
ON NOMATCH INCLUDE
DATA ON HOLD
END
-RUN
