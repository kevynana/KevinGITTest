-* 07/27/15 - DEB - S-10299 COMMENTED OUT SET &ECHO=ALL
-*getRIParmGeoZone.fex
-*-SET &ECHO=ALL;
-SET &SPC='&' | 'nbsp;';
 
DEFINE FILE GEO
CNT/I5 = CNT + 1;
IMD/I5 = IMOD(CNT, 2, IMD);
GEO_DESC/A25= GEO_ZONE || ' - ' | GEO_NAME;

OPTS/A200=IF IMD NE 0 THEN '<option value="' || GEO_ZONE || '">' || GEO_DESC 
  ELSE '<option style="background-color:#dcdcdc;" value="' || GEO_ZONE || '">' || GEO_DESC ;
END

TABLE FILE GEO
PRINT OPTS 
-*BY GEO_ZONE NOPRINT
WHERE GEO_ZONE NE ' '
ON TABLE SET HOLDLIST PRINTONLY
ON TABLE HOLD AS HOLDGEO
END
-RUN

-HTMLFORM BEGIN
<html>
<head>Select Geo Regions
<script>
function moveItems() {
 var  from=document.geo.geo;
 var len = from.options.length;
// var nbr = &nbrSelected;
  
// var startPos = from.options.selectedIndex;
 for (i=0; i<len;i++) {
     if (from.options[i].selected) { 
         txt = from.options[i].text;  
         val = from.options[i].value; 
         window.opener.pasteGeoZone(val,txt);  
     }
 }
 window.close();
}
 
</script>
</head>
<body >
<form name="geo">
<table border=0>
<tr>
<td>
<select name="geo" size="9" multiple>
!IBI.FIL.HOLDGEO;
</select>
</td>
</tr>
<tr>
<td>&SPC</td>
</tr>
<tr>
<td>
<input type="button" value="  OK  " onclick="moveItems();">&SPC &SPC
<input type="button" value="Close" onclick="window.close();">
</td>
</tr>
</table>
</form>
</body>
</html>
-HTMLFORM END
