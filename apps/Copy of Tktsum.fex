-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-INCLUDE SETECHO
-* File TKTSUM.FEX
-* 5/18/04 - DEB - ADDED AIRLINE_FEE COLUMN PER MONICA COLLIGAN
-*10/08/04 - DV - CHANGED PROGRAM SO SETFILE WOULD PRODUCE REPORT
-*                ADDED LEVEL1 LEVEL2 LEVEL3
-*01/04/05 - DV - ADDED CODE FOR GLOBAL CURRENCY
-*10/10/05 - DV - ADDED GEO_ZONE
-**********************************************************************

-**********************************************************************

SET ASNAMES=ON



-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HNKA=&HLDPATH || 'HOLDA.FOC';
-SET &HNKB=&HLDPATH || 'HOLDH.FOC';
-SET &HNKC=&HLDPATH || 'HOLDC.FOC';
-RUN


-SET &FILENAME = 'HOLDA'; 
-RUN

-DOS STATE &HNKA
-SET &HOLDFILEA = IF &RETCODE.EVAL EQ 0 THEN &HNKA | ' AS ' | &FILENAME ELSE ' ';

-DOS STATE &HNKC
-SET &HOLDFILEC = IF &RETCODE.EVAL EQ 0 THEN &HNKC | ' AS ' | &FILENAME ELSE ' ';

-DOS STATE &HNKB
-SET &HOLDFILEH = IF &RETCODE.EVAL EQ 0 THEN &HNKB | ' AS ' | &FILENAME ELSE ' ';

USE ADD 
&HOLDFILEA
&HOLDFILEC
&HOLDFILEH
END


TABLE FILE HOLDA
PRINT
  AMOUNT
  GAMOUNT
  TTL_COUNT
  FEE
  FEEX
  GEO_ZONE
-INCLUDE BYHIERARCHY  
BY LEVEL_DESC
BY PASSNGR_NAME
BY PNR_LOCATOR
BY TRAN_DATE
BY TKT_NUM
BY TSORT
BY SEG
BY TYPE
BY NAME 
BY DATE
BY AIRT
BY CITY1
BY CITY2
BY FLAG
BY LEVEL1
BY LEVEL2
BY LEVEL3
BY NAMEC
BY TRIP_PURPOSE
BY CHG_COD
BY CCA_CARD
-IF &&SETF NE 'GAACHD' THEN GOTO NoWhere;
WHERE LEVEL2 EQ '146484' OR '146142' OR '146718' OR '146949' OR '146328' OR 
      '147706' OR '147405' OR '147346' OR '147734' OR '147261' OR '148292' OR
      '148550' OR '148782' OR '148337' OR '148869' OR '148601' OR '148875' OR
      '148956' OR '148400' OR '148686' OR '148405' OR '148026' OR '148311' OR 
      '148503' OR '149528' OR '149157' OR '149308' OR '149548' OR '149638' OR
      '149450' OR '149715' OR '149891' OR '149904' OR '149718' OR '149213' OR
      '149317' OR '149540' OR '149809' OR '149677' OR '149805' OR '149465' OR 
      '149371' OR '149508' OR '149954' OR '149156' OR '149906' OR '149529' OR 
      '149518' OR '149893' OR '149866' OR '149325' OR '149496' OR '149925' OR 
      '149407' OR '149318' OR '149121' OR '149190' OR '149782' OR '149362' OR 
      '149770' OR '149542' OR '149449' OR '149030' OR '149113' OR '149658' OR 
      '149674' OR '149409' OR '149717' OR '150664' OR '150586' OR '150576' OR
      '150911' OR '150724' OR '150270' OR '150776' OR '150251' OR '150599' OR 
      '150051' OR '150271' OR '150209' OR '150987' OR '150312' OR '150143' OR 
      '150527' OR '150274' OR '150338' OR '150985' OR '150963' OR '150721' OR 
      '150104' OR '150508' OR '150766' OR '150004' OR '150112' OR '150268' OR 
      '150330' OR '150489' OR '150289' OR '150301' OR '150598' OR '150100' OR 
      '150640' OR '151701' OR '151603' OR '151338' OR '151079' OR '151529' OR
      '151515' OR '151411' OR '151449' OR '151207' OR '151011' OR '151272' OR
      '151013' OR '151206' OR '151129' OR '151204'
-NoWhere
ON TABLE HOLD AS HOLDE 
END
-RUN


-IF &RECORDS EQ 0 THEN GOTO xxit;



-SET &&RPTSUF = 'DTL';
-INCLUDE FDEFRPTS
-RUN


-**************************************************************************
DEFINE FILE HOLDE
COUNT1/D12CS = IF (FLAG EQ 'A') THEN TTL_COUNT ELSE 0;
COUNT2/D12CS = IF (FLAG EQ 'C') THEN TTL_COUNT ELSE 0;
COUNT3/D12CS = IF (FLAG EQ 'H') THEN TTL_COUNT ELSE 0;
AMT1/D12.2CS = IF (FLAG EQ 'A') THEN AMOUNT ELSE 0;
AMT2/D12.2CS = IF (FLAG EQ 'C') THEN AMOUNT ELSE 0;
AMT3/D12.2CS = IF (FLAG EQ 'H') THEN AMOUNT ELSE 0;
FLAGA/A5 = DECODE FLAG ('A' 'AIR'   'C' 'CAR'  'H' 'HOTEL');                         
XPSNGR_NM/A15        = 
    EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
TICKET_NMBR/A10 = IF (TKT_NUM EQ '0000000000') THEN ' ' ELSE
                  TKT_NUM;
-* CUR_DESC/A95 = LEVEL_DESC||'-'||NAMEC;
CUR_DESC/A50 = NAMEC;
  
                 
-*DEFINES ON PREVIOUS DEFINES 
PASNGR_NAME/A15 = IF TKT_NUM NE LAST TKT_NUM THEN XPSNGR_NM ELSE ' ';
LVL1/A15 = IF TKT_NUM NE LAST TKT_NUM THEN LEVEL1 ELSE ' ';
TRAN_MYA/I6MTYY = TRAN_DATE;
NOWTOD/A8 WITH TKT_NUM = HHMMSS (NOWTOD);
-INCLUDE DefineSubtotalFields  
END


-IF &&DRILLED_RUN EQ 'N' GOTO SKIP_DRIL;
-************************************************************
-* INCLUDE PROGRAM TO GEN WHERE STATEMENTS
-************************************************************
-SET &&DRILLRPT = 'HOLDE';
-INCLUDE DRILWHRS
-SKIP_DRIL
-************************************************************


-IF &&CURRENCY EQ 'USD' THEN GOTO NEXT;

-SET &&SUBHEAD = <CUR_DESC;
-SET &GFAR_CUR = 'AMOUNT, (' | &&CURRENCY || ')';
-SET &GFEE_CUR = 'ARLN, FEE, (' | &&CURRENCY || ')';
-SET &&PRINT3='CITY1/A20 AS ''ORG'' CITY2/A18 AS ''DST'' ';
-SET &&PRINT4='GAMOUNT/D16.2CS AS ' | '''&GFAR_CUR.EVAL''';
-SET &&PRINT5='FEEX/D16.2CS AS ' | '''&GFEE_CUR.EVAL''';
-SET &&PRINT7='COUNT2 AS ''CAR,DAY'' ';

-NEXT;

 


TABLE FILE HOLDE
-INCLUDE HEADACH
-*"&&SUBHEAD"
"</2"
-*
-**********************************************************************
-* Print statement with fields passed from the user profile database
-**********************************************************************
-*
&&PRINT1
&&PRINT2
&&PRINT3
&&PRINT4
&&PRINT5
&&PRINT6
&&PRINT7
&&PRINT8
&&PRINT9
&&PRINT10

-*
-**********************************************************************
-* By statements (one per field)
-**********************************************************************
-*
-IF &&MULTIBREAK NE 'Y' OR &&ALTHIER NE 'Y' THEN GOTO :NOMULTBREAK;
-INCLUDE LevelNOPRINT
-:NOMULTBREAK
&&BY1
&&BY2
&&BY3
&&BY4
&&BY5
&&BY6
&&BY7
&&BY8
&&BY9
&&BY10
-*
-*********************************************************************
-*DATE           NAME               DESCRIPTION 
-*8/18/00      IBISTL-KR            INCLUDE WHERE STATEMENTS WHEN
-*                                  DRILLED_RUN EQ 'Y'.
-*********************************************************************
-*
-**********************************************************************
-* Where statements for Drilled Report
-**********************************************************************
-*

-IF &&DRILLED_RUN EQ 'N' GOTO SKIP_WHR;
-INCLUDE &&DRILLWHR
-SKIP_WHR
-*
-**********************************************************************
-* On Table statements for code appropriate to On Table commands
-**********************************************************************
-*
-IF &&MULTIBREAK NE 'Y' OR &&ALTHIER NE 'Y' THEN GOTO :NOMULTOTAL;
-INCLUDE TOTALBYHIERARCHY
-GOTO SKIPBREAKOPT;
-:NOMULTOTAL
&&BREAKOPTION
&&ONTABLE1
&&ONTABLE2
&&ONTABLE3
-SKIPBREAKOPT
&&ONTABLE4
&&ONTABLE5
&&ONTABLE6
&&ONTABLE7
&&ONTABLE8
&&ONTABLE9
&&ONTABLE10

 
-*
-**********************************************************************
-* Report specific footer(s)
-**********************************************************************
-*
-INCLUDE FOOTERDT
-*
-*ON TABLE SET STYLE &&DTSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**************************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *

-IF '&&SETF.EVAL' EQ 'BZACHDCC' THEN GOTO BOOZ;
-IF &&CURRENCY EQ 'TRL' THEN GOTO SMALLER;
-INCLUDE &&DTSTY 
-GOTO FINFONT;
-SMALLER
-INCLUDE DT7
-FINFONT


-* -INCLUDE &&DTSTY
ENDSTYLE
-*
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
-GOTO xxit

-BOOZ
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=7, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=REPORT, WRAP=1,$
TYPE=REPORT, COLUMN=N1,  WRAP= 1.5,$
-*TYPE=REPORT, COLUMN=N2,  WRAP= .50,$
-*TYPE=REPORT, COLUMN=N3,  WRAP= .50,$
TYPE=REPORT, COLUMN=N6, WRAP=  1.0,$
TYPE=REPORT, COLUMN=N13, WRAP= .65,$
TYPE=REPORT, COLUMN=N14, WRAP= .65,$
TYPE=REPORT, COLUMN=N15, WRAP= 2.0,$
TYPE=REPORT, COLUMN=N16, WRAP= 1.20,$
TYPE=REPORT, COLUMN=N17, WRAP= .75,$
TYPE=REPORT, COLUMN=N18, WRAP= 1.15,$
TYPE=REPORT, COLUMN=N19, WRAP= 1.15,$
TYPE=REPORT, COLUMN=N20, WRAP= 1.0,$
TYPE=REPORT, COLUMN=N21, WRAP= .75,$
TYPE=REPORT, COLUMN=N22, WRAP= .75,$
TYPE=REPORT, COLUMN=N23, WRAP= .75,$
TYPE=REPORT, COLUMN=N24, WRAP= .75,$
TYPE=REPORT, COLUMN=N25, WRAP= .75,$

TYPE=HEADING, LINE=4, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=13, SIZE=10, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $

TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD,$
-*TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD, N=10, BACKCOLOR=RGB(128 255 255),$
TYPE=GRANDTOTAL, SIZE=8, STYLE=BOLD,$
TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(&&TNTDTPOS), SIZE=(&&TNTDTSIZ), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLDTPOS), SIZE=(&&ROLDTSIZ), $

ENDSTYLE

&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN







-xxit
