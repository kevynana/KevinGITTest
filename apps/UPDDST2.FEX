
SET ASNAMES = ON

FILEDEF DST_LVL DISK D:\AS400\DST_LVL.TXT

 

TABLE FILE DST_LVL 
PRINT ROLLUP_CODE LOWEST_VAL LEVEL1 LEVEL2 LEVEL3 LEVEL4 LEVEL5
BY ROLLUP_CODE NOPRINT
BY LOWEST_VAL NOPRINT NOPRINT
ON TABLE HOLD
END
-RUN

TABLE FILE HOLD
PRINT LOWEST_VAL LEVEL1 AS 'NEW1' LEVEL2 AS 'NEW2' LEVEL3 AS 'NEW3' LEVEL4 AS 'NEW4' LEVEL5 AS 'NEW5'
BY LOWEST_VAL NOPRINT
ON TABLE HOLD AS DSTMFIX FORMAT FOCUS INDEX LOWEST_VAL
END
-RUN
 

-* QUARTER 9
-DEB

                                                                                                                                                           0001010199991231DSTM-R|DSTM|BFDS|054013                                                                                                                                                                                                                         

JOIN AIR_KEY IN S6DSTM TO AIR_KEY IN A6DSTM AS J1
DEFINE FILE S6DSTM
LV_LEN/I2 = ARGLEN(15, LEVEL1, LV_LEN);
NWLVL1/A15 = EDIT(LEVEL1, '$$$999999');
TEST/I2 = ARGLEN(15, AROLL_LEV5, TEST);
END
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV5 AS 'LEVEL1'
WHERE AROLL_LEV1 EQ ' '
IF LEVEL1 EQ '003' OR '332'
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE DEBHOLD
PRINT AIR_KEY LEVEL1
BY AIR_KEY NOPRINT
ON TABLE HOLD
END

MODIFY FILE A6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

 
 
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR 
BY LEVEL1
ON TABLE HOLD AS DEBHOLD2
END
-RUN



JOIN LEVEL1 IN DEBHOLD2 TO ALL LOWEST_VAL IN DSTMFIX AS J2
TABLE FILE DEBHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END

 

TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE S6DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN


JOIN AIR_KEY IN M6DSTM TO AIR_KEY IN A6DSTM AS J1
DEFINE FILE M6DSTM
LV_LEN/I2 = ARGLEN(15, LEVEL1, LV_LEN);
NWLVL1/A15 = EDIT(LEVEL1, '$$$999999');
TEST/I2 = ARGLEN(15, AROLL_LEV5, TEST);
END
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV5 AS 'LEVEL1'
WHERE AROLL_LEV1 EQ ' '
IF LEVEL1 EQ '003' OR '332'
ON TABLE HOLD AS DEBHOLDM
END
-RUN


 
 
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR 
BY LEVEL1
ON TABLE HOLD AS DEBHOLD2
END
-RUN





 




JOIN LEVEL1 IN DEBHOLD2 TO ALL LOWEST_VAL IN DSTMFIX AS J2
TABLE FILE DEBHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END

 

TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE M6DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN
 

 

-* MARKET

JOIN AIR_KEY IN M6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
WHERE AROLL_LEV1 EQ ' '
WHERE AROLL_LEV5 CONTAINS '5'
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

 


JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE M6DSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN D6DSTM TO AIR_KEY IN A6DSTM AS J1
DEFINE FILE D6DSTM
LV_LEN/I2 = ARGLEN(15, LEVEL1, LV_LEN);
NWLVL1/A15 = EDIT(LEVEL1, '$$$999999');
TEST/I2 = ARGLEN(15, AROLL_LEV5, TEST);
END
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV5 AS 'LEVEL1'
WHERE AROLL_LEV1 EQ ' '
IF LEVEL1 CONTAINS '332' OR '003'
ON TABLE HOLD AS DEBHOLDD
END
-RUN




JOIN CLEAR *
-RUN

 
 



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE D6DSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

-QUIT

-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE C6DSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C6DSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT CAR_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE H6DSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE H6DSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN


-TYPE QUARTER 9 COMPLETED


-* QUARTER0
JOIN AIR_KEY IN S6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE S6DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN M6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE M6DSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN D6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE D6DSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE C6DSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C6DSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT CAR_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE H6DSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE H6DSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

-TYPE QUARTER 0 COMPLETED

-* QUARTER Y

JOIN AIR_KEY IN SYDSTM TO AIR_KEY IN AYDSTM AS J1
TABLE FILE SYDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE SYDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE SYDSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE SYDSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN MYDSTM TO AIR_KEY IN AYDSTM AS J1
TABLE FILE MYDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE MYDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE MYDSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE MYDSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN DYDSTM TO AIR_KEY IN AYDSTM AS J1
TABLE FILE DYDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE DYDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE DYDSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE DYDSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE CYDSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE CYDSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE CYDSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT CAR_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE CYDSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE HYDSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE HYDSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE HYDSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' NEW5 AS 'AROLL_LEV6' NEW5 AS 'AROLL_LEV7'
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE HYDSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5

ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

-TYPE QUARTER Y COMPLETED

-* QUARTER Z

JOIN AIR_KEY IN SZDSTM TO AIR_KEY IN AZDSTM AS J1
TABLE FILE SZDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE SZDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE SZDSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE SZDSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN MZDSTM TO AIR_KEY IN AZDSTM AS J1
TABLE FILE MZDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE MZDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE MZDSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE MZDSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN DZDSTM TO AIR_KEY IN AZDSTM AS J1
TABLE FILE DZDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE DZDSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE DZDSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE DZDSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE CZDSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE CZDSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE CZDSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE CZDSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE HZDSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE HZDSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE HZDSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE HZDSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

- TYPE QUARTER Z COMPLETED

-* QUARTER 1
JOIN AIR_KEY IN S1DSTM TO AIR_KEY IN A1DSTM AS J1
TABLE FILE S1DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE S1DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S1DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE S1DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN M1DSTM TO AIR_KEY IN A1DSTM AS J1
TABLE FILE M1DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE M1DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M1DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE M1DSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN D1DSTM TO AIR_KEY IN A1DSTM AS J1
TABLE FILE D1DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE D1DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D1DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE D1DSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE C1DSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE C1DSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C1DSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE C1DSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE H1DSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE H1DSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE H1DSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE H1DSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

-TYPE QUARTER 1 COMPLETED

-* QUARTER 2

JOIN AIR_KEY IN S2DSTM TO AIR_KEY IN A2DSTM AS J1
TABLE FILE S2DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE S2DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S2DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE S2DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN M2DSTM TO AIR_KEY IN A2DSTM AS J1
TABLE FILE M2DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE M2DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M2DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE M2DSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN D2DSTM TO AIR_KEY IN A2DSTM AS J1
TABLE FILE D2DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE D2DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D2DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE D2DSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE C2DSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE C2DSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C2DSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE C2DSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE H2DSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE H2DSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE H2DSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE H2DSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

-TYPE QUARTER 2 COMPLETED

-* QUARTER 3

JOIN AIR_KEY IN S6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE S6DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN M6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE M6DSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN D6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE D6DSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE C6DSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C6DSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE H6DSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE H6DSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

-TYPE QUARTER 3 COMPLETED

-* QUARTER 4

JOIN AIR_KEY IN S6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE S6DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5

ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN M6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE M6DSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN D6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE D6DSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5

ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE C6DSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C6DSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE H6DSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE H6DSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5' 
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

-TYPE QUARTER 4 COMPLETED

-* QUARTER 5
JOIN AIR_KEY IN S6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE S6DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN M6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE M6DSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN D6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE D6DSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5

ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE C6DSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C6DSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5

ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE H6DSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE H6DSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

-TYPE QUARTER 5 COMPLETED

-* QUARTER 6

JOIN AIR_KEY IN S6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE S6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE S6DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN M6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE M6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE M6DSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN D6DSTM TO AIR_KEY IN A6DSTM AS J1
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE D6DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D6DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE D6DSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE C6DSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C6DSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE C6DSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE H6DSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE H6DSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE H6DSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

-TYPE QUARTER 6 COMPLETED

-* QUARTER 7

JOIN AIR_KEY IN S7DSTM TO AIR_KEY IN A7DSTM AS J1
TABLE FILE S7DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE S7DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S7DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE S7DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN M7DSTM TO AIR_KEY IN A7DSTM AS J1
TABLE FILE M7DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE M7DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M7DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE M7DSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN D7DSTM TO AIR_KEY IN A7DSTM AS J1
TABLE FILE D7DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE D7DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D7DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE D7DSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE C7DSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE C7DSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C7DSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE C7DSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE H7DSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE H7DSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE H7DSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE H7DSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

-TYPE QUARTER 7 COMPLETED

-* QUARTER 8
JOIN AIR_KEY IN S8DSTM TO AIR_KEY IN A8DSTM AS J1
TABLE FILE S8DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE S8DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S8DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXSEG
END


TABLE FILE FIXSEG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG1
END
-RUN

MODIFY FILE S8DSTM
FIXFORM FROM FIXSEG1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXSEG1
END
-RUN

 
-* MARKET

JOIN AIR_KEY IN M8DSTM TO AIR_KEY IN A8DSTM AS J1
TABLE FILE M8DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDM
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE M8DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M8DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDM TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXMKT
END


TABLE FILE FIXMKT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT1
END
-RUN

MODIFY FILE M8DSTM
FIXFORM FROM FIXMKT1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXMKT1
END
-RUN

 
 
-* DESTINATION



-* MARKET

JOIN AIR_KEY IN D8DSTM TO AIR_KEY IN A8DSTM AS J1
TABLE FILE D8DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY LEVEL1
ON TABLE HOLD AS DEBHOLDD
END
-RUN


JOIN CLEAR *
-RUN

-* Blank out AROLL_LEV1 in segment data base
TABLE FILE D8DSTM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D8DSTM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN LEVEL1 IN DEBHOLDD TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDD
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXDST
END


TABLE FILE FIXDST
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST1
END
-RUN

MODIFY FILE D8DSTM
FIXFORM FROM FIXDST1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXDST1
END
-RUN

 
-* CAR

-*BLANK OUT AROLL_LEV1 IN CAR FILES
TABLE FILE C8DSTM
PRINT CAR_KEY
BY CAR_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE C8DSTM
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C8DSTM
PRINT CAR_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDC
END
-RUN


JOIN LEVEL1 IN DEBHOLDC TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDC
PRINT CAR_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXCAR
END

TABLE FILE FIXCAR
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR1
END
-RUN

MODIFY FILE C8DSTM
FIXFORM FROM FIXCAR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXCAR1
END
-RUN

-* HOTEL

-*BLANK OUT AROLL_LEV1 IN HOTEL FILES
TABLE FILE H8DSTM
PRINT HTL_KEY
BY HTL_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE H8DSTM
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV1='               ';
ON MATCH COMPUTE AROLL_LEV6='               ';
ON MATCH COMPUTE AROLL_LEV7='               ';
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE H8DSTM
PRINT HTL_KEY
BY LEVEL1
ON TABLE HOLD AS DEBHOLDH
END
-RUN


JOIN LEVEL1 IN DEBHOLDH TO ALL LOWEST_VAL IN DSTMFIX AS J1
TABLE FILE DEBHOLDH
PRINT HTL_KEY LEVEL1 LOWEST_VAL NEW1 NEW2 NEW3 NEW4 NEW5
BY LEVEL1
ON TABLE HOLD AS FIXHTL
END

TABLE FILE FIXHTL
PRINT HTL_KEY NEW1 AS 'AROLL_LEV1' NEW2 AS 'AROLL_LEV2' NEW3 AS 'AROLL_LEV3' NEW4 AS 'AROLL_LEV4' NEW5 AS 'AROLL_LEV5'  
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL1
END
-RUN

MODIFY FILE H8DSTM
FIXFORM FROM FIXHTL1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV1
ON MATCH UPDATE AROLL_LEV2
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON FIXHTL1
END
-RUN

-TYPE QUARTER 8 COMPLTED
-ALL COMPLETED
