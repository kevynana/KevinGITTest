-* File FIXSECUR.FEX

-***************************************************************************
-* This program will check the security levels and make sure they are setup
-* correctly in each report set.
-* DATE           NAME
-* 02/28/03       Steve Cords - Initial Creation
-***************************************************************************
-GOTO FIXSEC


TABLE FILE RPT_SET
PRINT ROLLUP_CODE USER_NAME USER_SECURITY
BY ROLLUP_CODE NOPRINT
BY USER_NAME NOPRINT
BY USER_SECURITY NOPRINT
IF USER_NAME NE ' '
ON TABLE HOLD AS RPTSET
END

TABLE FILE USERS
PRINT *
ON TABLE HOLD AS USER1
END

MATCH FILE RPTSET
PRINT ROLLUP_CODE USER_NAME USER_SECURITY
BY ROLLUP_CODE NOPRINT
BY USER_NAME NOPRINT
RUN
FILE USER1
SUM USER_SECURITY_LEVEL
BY ROLLUP_CODE NOPRINT
BY USER_NAME NOPRINT
AFTER MATCH HOLD AS NEWDATA OLD
END
-RUN

TABLE FILE NEWDATA
PRINT *
ON TABLE HOLD AS  USERCHG FORMAT EXCEL2K
END
-EXIT

-FIXSEC

TABLE FILE RPT_SET
PRINT SET_KEY USER_SECURITY
-* IF USER_NAME EQ 'lindas'
-* IF USER_NAME EQ 'mikeg'
-* IF USER_NAME EQ 'kevinkee' OR 'tonyaa' OR 'joegreen'

-* IF USER_NAME EQ 'steve99' OR 'mikecara' OR 'peggym'
-* OR 'joegreen' OR 'kevinkee' OR 'tonyaa'

-* IF USER_NAME EQ 'danielle' OR 'kima' OR 'toddhew'
-* OR 'waltg' OR 'scottr' OR 'lisab' OR 'thawyrsz'
-* OR 'tconway' OR 'bevh' OR 'brendas' OR 'dianej'
-* OR 'ritak' OR 'shellyr' OR 'dianet' OR 'kellyf'
-* OR 'kima'

-* IF USER_NAME EQ 'aprilw' OR 'monicac' OR 'afici'
-* OR 'teresaf' OR 'beckyn' OR 'margiec' OR 'aprilw'
-* OR 'kellym' OR 'dawnj' OR 'tarnold' OR 'judyw'
-* OR 'melaniec' OR 'teresac' OR 'haydeeg' OR 'paulm'
-* OR 'ibi' OR 'khansen' OR 'pattic' OR 'mkubasik'
-* OR 'melissab'

IF USER_NAME EQ 'deb' OR 'master' OR 'sherri' OR 'jolynm'
OR 'rjones' OR 'lusheng' OR 'wtorres' OR 'joy'

ON TABLE HOLD
END

MODIFY FILE RPT_SET
FIXFORM FROM HOLD
MATCH SET_KEY
ON MATCH COMPUTE USER_SECURITY=9;
ON MATCH UPDATE USER_SECURITY
ON NOMATCH REJECT
DATA ON HOLD
END
-EXIT





