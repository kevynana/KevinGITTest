
SET ASNAMES = ON

-INCLUDE SETECHO



JOIN INST_KEY IN RPT_INST TO ALL INST_KEY IN RPT_FLDS AS J1
JOIN SET_KEY IN RPT_INST TO SET_KEY IN RPT_SET AS J2

TABLE FILE RPT_INST
PRINT INST_KEY SET_KEY
BY ROLLUP
WHERE RPT_STREAM EQ 'ADHOCRPT'
WHERE USER_NAME EQ 'template'
WHERE SET_NAME CONTAINS 'Air'
ON TABLE HOLD AS 'DEBHOLD'
END	
-RUN
JOIN CLEAR *



-QUIT

TABLE FILE DEBHOLD
PRINT INST_KEY
BY INST_KEY NOPRINT
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE DEBHOLD
PRINT SET_KEY
BY SET_KEY NOPRINT
ON TABLE HOLD AS DEBHOLD3
END
-RUN

MODIFY FILE RPT_INST
LOG NOMATCH MSG OFF
FIXFORM FROM DEBHOLD2
MATCH INST_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON DEBHOLD2
END
-RUN

MODIFY FILE RPT_FLDS
LOG NOMATCH MSG OFF

FIXFORM FROM DEBHOLD2
MATCH INST_KEY 
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON DEBHOLD2
END
-RUN

MODIFY FILE RPT_SET
LOG NOMATCH MSG OFF 
FIXFORM FROM DEBHOLD3
MATCH SET_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON DEBHOLD3
END
-RUN

