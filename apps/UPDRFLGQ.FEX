SET ASNAMES=ON


USE CLEAR *-
USE
    D:\TNT\TTRACKER\SUDATA\ROLLUP.FOC
END

  FI CUSTS DISK D:\LOAD\FOCTEMP\CUSTS.DAT
SET MESSAGE=ON
-*=======================================================================
SET ASNAMES=ON
DEFINE FILE ROLLUP
XL01/A1 = 'W' ;
END
TABLE FILE ROLLUP
BY ROLLUP NOPRINT
PRINT ROLLUP AS 'ROLLUP_CODE'
      XL01   AS 'PR_STAMP'
IF UPD_ENABLE NE ' '
IF QTR_ENABLE EQ 'X'
IF ROLLUP NE 'CH2M-R' OR 'TOTAL-R'
-* IF ROLLUP EQ 'METX-R'
ON TABLE HOLD
END
-RUN


MODIFY FILE ROLLUP
FIXFORM FROM HOLD
MATCH ROLLUP
ON MATCH UPDATE PR_STAMP
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-*======================================================================
USE CLEAR *
-RUN
SET TEMPDIR=D:\FOCTEMP
SET MESSAGE=ON
SET WARNING=OFF
SET YRTHRESH=30
SET DEFCENT=19
-RUN
-*=======================================================================

-SET &CNT=0;

-TOP
TABLE FILE ROLLUP
BY ROLLUP NOPRINT
PRINT ROLLUP COMP
BY ROLLUP_CODE NOPRINT
IF UPD_ENABLE NE ' '
IF RECORDLIMIT EQ 1
IF QTR_ENABLE EQ 'X'
IF PR_STAMP EQ 'W'
IF ROLLUP NE 'CH2M-R' OR 'TOTAL-R'
ON TABLE SAVE AS CUSTS
END
-RUN

-READ CUSTS &&ROLLUP.A8 &&COMP.A6.
-RUN

-IF &RECORDS EQ 0 THEN GOTO STOP;
-RUN


-* -SET &&SMD = 'S';

-* EX AIRXUSEX
-* -RUN

-* SEGMENT FILES
-SET &&FOCSNAME1 = 'S1'||&&COMP;
-SET &&FOCSNAME2 = 'S2'||&&COMP;
-SET &&FOCSNAME3 = 'S3'||&&COMP;
-SET &&FOCSNAME4 = 'S4'||&&COMP;
-SET &&FOCSNAME5 = 'S5'||&&COMP;
-SET &&FOCSNAME6 = 'S6'||&&COMP;
-SET &&FOCSNAME7 = 'S7'||&&COMP;
-SET &&FOCSNAME8 = 'S8'||&&COMP;
-SET &&FOCSNAME9 = 'S9'||&&COMP;
-SET &&FOCSNAME0 = 'S0'||&&COMP;
-SET &&FOCSNAMEY = 'SY'||&&COMP;
-SET &&FOCSNAMEZ = 'SZ'||&&COMP;



-TYPE DEBTEST &&FOCSNAME1

-* ************************* S1 UPDATE ***********************


TABLE FILE &&FOCSNAME1
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAME1
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAME1
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAME1
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAME1
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAME1
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN



-* **************************S2 UPDATE *********************
-TYPE DEBTEST &&FOCSNAME2



TABLE FILE &&FOCSNAME2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAME2
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAME2
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAME2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAME2
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAME2
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN

-* *********************S3 UPDATE ***********************
-TYPE DEBTEST &&FOCSNAME3

TABLE FILE &&FOCSNAME3
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAME3
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAME3
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAME3
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAME3
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAME3
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN



-* *********************S4 UPDATE ***********************
-TYPE DEBTEST &&FOCSNAME4

TABLE FILE &&FOCSNAME4
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAME4
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAME4
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAME4
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAME4
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAME4
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN


-* *********************S5 UPDATE ***********************
-TYPE DEBTEST &&FOCSNAME5


TABLE FILE &&FOCSNAME5
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAME5
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAME5
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAME5
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAME5
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAME5
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN



-* *********************S6 UPDATE ***********************
-TYPE DEBTEST &&FOCSNAME6



TABLE FILE &&FOCSNAME6
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAME6
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAME6
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAME6
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAME6
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAME6
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN



-* *********************S7 UPDATE ***********************

-TYPE DEBTEST &&FOCSNAME7


TABLE FILE &&FOCSNAME7
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAME7
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAME7
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAME7
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAME7
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAME7
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN





-* *********************S8 UPDATE ***********************
-TYPE DEBTEST &&FOCSNAME8

TABLE FILE &&FOCSNAME8
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAME8
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAME8
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAME8
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAME8
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAME8
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN






-* *********************S9 UPDATE ***********************
-TYPE DEBTEST &&FOCSNAME9



TABLE FILE &&FOCSNAME9
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAME9
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAME9
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAME9
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAME9
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAME9
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN







-* *********************S0 UPDATE ***********************
-TYPE DEBTEST &&FOCSNAME0

TABLE FILE &&FOCSNAME0
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAME0
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAME0
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAME0
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAME0
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAME0
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN







-* *********************SY UPDATE ***********************
-TYPE DEBTEST &&FOCSNAMEY


TABLE FILE &&FOCSNAMEY
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAMEY
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAMEY
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAMEY
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAMEY
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAMEY
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN


-* *********************SZ UPDATE ***********************

-TYPE DEBTEST &&FOCSNAMEZ

TABLE FILE &&FOCSNAMEZ
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'RF1'
IF RF_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD
END
-RUN

TABLE FILE &&FOCSNAMEZ
-* PRINT AIR_KEY RF_FLAG AS 'XL02'
SUM AIR_KEY RF_FLAG AS 'XL02'
BY AIR_KEY NOPRINT
IF RF_FLAG NE ' '
IF EMBARK NE 'RF1'
ON TABLE HOLD AS HLD1
END
-RUN

MATCH FILE DEBHOLD
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HLD1
SUM XL02
BY AIR_KEY
AFTER MATCH HOLD AS HOLD2 OLD
END
-RUN

TABLE FILE HOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL02 AS 'RF_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE &&FOCSNAMEZ
FIXFORM FROM HOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE RF_FLAG = RF_FLAG;
ON MATCH UPDATE RF_FLAG
ON NOMATCH REJECT
DATA ON HOLD3
END
-RUN





TABLE FILE &&FOCSNAMEZ
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF EMBARK EQ 'EX1'
IF EX_FLAG EQ ' '
ON TABLE HOLD AS DEBHOLD2
END
-RUN

TABLE FILE &&FOCSNAMEZ
SUM AIR_KEY EX_FLAG AS 'XL03'
BY AIR_KEY NOPRINT
IF EX_FLAG NE ' '
IF EMBARK NE 'EX1'
ON TABLE HOLD AS EXHLD
END
-RUN

MATCH FILE DEBHOLD2
PRINT EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY
ON TABLE HOLD
RUN
FILE EXHLD
SUM XL03
BY AIR_KEY
AFTER MATCH HOLD AS EXHOLD2 OLD
END
-RUN

TABLE FILE EXHOLD2
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL03 AS 'EX_FLAG'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS EXHOLD3
END
-RUN


MODIFY FILE &&FOCSNAMEZ
FIXFORM FROM EXHOLD3
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
-* ON MATCH COMPUTE EX_FLAG = EX_FLAG;
ON MATCH UPDATE EX_FLAG
ON NOMATCH REJECT
DATA ON EXHOLD3
END
-RUN



DEFINE FILE ROLLUP
XL01/A1 = 'Z' ;
END
TABLE FILE ROLLUP
BY ROLLUP NOPRINT
PRINT ROLLUP AS 'ROLLUP_CODE'
      XL01   AS 'PR_STAMP'
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
ON TABLE HOLD
END
MODIFY FILE ROLLUP
FIXFORM FROM HOLD
MATCH ROLLUP
ON MATCH UPDATE PR_STAMP
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-GOTO TOP
-RUN
-*======================================================================
-STOP

-XFER
-TYPE PROGRAM COMPLETED.......
-EXIT

-XXIT
-EXIT





