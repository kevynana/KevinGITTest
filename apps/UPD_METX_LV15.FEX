-INCLUDE SETECHO
SET ASNAMES = ON

DEFINE FILE SZMETX
XL01/A15 = AROLL_LEV14;
END
TABLE FILE SZMETX
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL01 AS 'AROLL_LEV15'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT 
BY SEG_NBR NOPRINT
IF AROLL_LEV15 EQ ' '
ON TABLE HOLD AS SHOLD
END
-RUN

MODIFY FILE SZMETX
 LOG NOMATCH MSG OFF
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV15
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN



DEFINE FILE DZMETX
XL01/A15 = AROLL_LEV14;
END
TABLE FILE DZMETX
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL01 AS 'AROLL_LEV15'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT 
BY SEG_NBR NOPRINT
IF AROLL_LEV15 EQ ' '
ON TABLE HOLD AS DHOLD
END
-RUN

MODIFY FILE DZMETX
 LOG NOMATCH MSG OFF
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV15
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN


DEFINE FILE MZMETX
XL01/A15 = AROLL_LEV14;
END
TABLE FILE MZMETX
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL01 AS 'AROLL_LEV15'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT 
BY SEG_NBR NOPRINT
IF AROLL_LEV15 EQ ' '
ON TABLE HOLD AS MHOLD
END
-RUN

MODIFY FILE MZMETX
 LOG NOMATCH MSG OFF
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV15
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN


DEFINE FILE CZMETX
XL01/A15 = AROLL_LEV14;
END
TABLE FILE CZMETX
PRINT CAR_KEY XL01 AS 'AROLL_LEV15'
BY CAR_KEY NOPRINT
IF AROLL_LEV15 EQ ' '
ON TABLE HOLD AS CHOLD
END
-RUN

MODIFY FILE CZMETX
 LOG NOMATCH MSG OFF
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV15
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN

DEFINE FILE HZMETX
XL01/A15 = AROLL_LEV14;
END
TABLE FILE HZMETX
PRINT HTL_KEY XL01 AS 'AROLL_LEV15'
BY HTL_KEY NOPRINT
IF AROLL_LEV15 EQ ' '
ON TABLE HOLD AS HHOLD
END
-RUN

MODIFY FILE HZMETX
LOG NOMATCH MSG OFF
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV15
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE LZMETX
XL01/A15 = AROLL_LEV14;
END
TABLE FILE LZMETX
PRINT CAR_KEY XL01 AS 'AROLL_LEV15'
BY CAR_KEY NOPRINT
IF AROLL_LEV15 EQ ' '
ON TABLE HOLD AS LHOLD
END
-RUN

MODIFY FILE LZMETX
 LOG NOMATCH MSG OFF
FIXFORM FROM LHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV15
ON NOMATCH REJECT
DATA ON LHOLD
END
-RUN