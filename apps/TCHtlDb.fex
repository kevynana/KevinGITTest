-**********************************************************************
-* This program will set up the databases to be used.
-* Date: Feb 09, 2004
-**********************************************************************
-INCLUDE SETECHO

-SET &&EXTRACT = HR_50;
-SET &&HTL_PATH = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\';
-SET &&COM_PATH = '&&DATASRV.EVAL' || '\TNT\TTRACKER\SYSTEM\DATA\';
USE CLEAR *

TABLE FILE ROLLUP
PRINT ROLLUP_CODE COMP QTR_ENABLE
BY ROLLUP_CODE NOPRINT
WHERE ROLLUP_CODE EQ '&&ROLL.EVAL' 
ON TABLE SAVE AS ROLLSEL
END
-RUN
-READ ROLLSEL &&ROLL.A8. &&COMPNY1.A6. &&QTR.A1.

-SET &&AH_DB1 = 'AL' || &&COMPNY1 || '.FOC';
-SET &&USE_AH1 = &&HTL_PATH || &&AH_DB1;

-IF &&QTR EQ 'X' THEN GOTO QUART ELSE GOTO NONQUART;

-QUART
-SET &&COMP1H = 'H0' ||&&COMPNY1 || '.FOC';
-SET &&COMP2H = 'H1' ||&&COMPNY1 || '.FOC';
-SET &&COMP3H = 'H2' ||&&COMPNY1 || '.FOC';
-SET &&COMP4H = 'H3' ||&&COMPNY1 || '.FOC';
-SET &&COMP5H = 'H4' ||&&COMPNY1 || '.FOC';
-SET &&COMP6H = 'H5' ||&&COMPNY1 || '.FOC';
-SET &&COMP7H = 'H6' ||&&COMPNY1 || '.FOC';
-SET &&COMP8H = 'H7' ||&&COMPNY1 || '.FOC';
-SET &&COMP9H = 'H8' ||&&COMPNY1 || '.FOC';
-SET &&COMP10H = 'H9' ||&&COMPNY1 || '.FOC';
-SET &&COMP11H = 'HY' ||&&COMPNY1 || '.FOC';
-SET &&COMP12H = 'HZ' ||&&COMPNY1 || '.FOC';

-SET &FILE1H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP1H.EVAL AS ' | '&&EXTRACT.EVAL';
-SET &FILE2H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP2H.EVAL AS ' | '&&EXTRACT.EVAL';
-SET &FILE3H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP3H.EVAL AS ' | '&&EXTRACT.EVAL';

-SET &FILE4H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP4H.EVAL AS ' | '&&EXTRACT.EVAL';
-SET &FILE5H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP5H.EVAL AS ' | '&&EXTRACT.EVAL';
-SET &FILE6H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP6H.EVAL AS ' | '&&EXTRACT.EVAL';

-SET &FILE7H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP7H.EVAL AS ' | '&&EXTRACT.EVAL';
-SET &FILE8H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP8H.EVAL AS ' | '&&EXTRACT.EVAL';
-SET &FILE9H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP9H.EVAL AS ' | '&&EXTRACT.EVAL';

-SET &FILE10H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP10H.EVAL AS ' | '&&EXTRACT.EVAL';
-SET &FILE11H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP11H.EVAL AS ' | '&&EXTRACT.EVAL';
-SET &FILE12H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP12H.EVAL AS ' | '&&EXTRACT.EVAL';

USE ADD
&FILE1H
&FILE2H
&FILE3H

&FILE4H
&FILE5H
&FILE6H

&FILE7H
&FILE8H
&FILE9H

&FILE10H
&FILE11H
&FILE12H
&&USE_AH1  AS AH_50
END
-RUN

-*USE ADD
-*D:\TNT\TTRACKER\DATA\&&COMP1H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP2H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP3H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP4H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP5H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP6H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP7H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP8H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP9H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP10H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP11H AS &&EXTRACT
-*D:\TNT\TTRACKER\DATA\&&COMP12H AS &&EXTRACT
-*&&USE_AH1  AS AH_50
-*END
-*-RUN

-GOTO ENDALLOC;

-NONQUART
-SET &&COMP1H = 'H_' ||&&COMPNY1 || '.FOC';
-SET &FILE1H = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\' |  '&&COMP1H.EVAL AS ' | '&&EXTRACT.EVAL';

USE ADD
&FILE1H
&&USE_AH1 AS AH_50
END
-RUN

-ENDALLOC
