-GOTO ALMUSA

DEFINE FILE ALTONE
AROLL_LEV1/A15=' ';
AROLL_DSC1/A60=' ';
AROLL_LEV2/A15=' ';
AROLL_DSC2/A60=' ';
AROLL_LEV3/A15=' ';
AROLL_DSC3/A60=' ';
AROLL_LEV4/A15=' ';
AROLL_DSC4/A60=' ';
AROLL_LEV5/A15=' ';
AROLL_DSC5/A60=' ';
AROLL_LEV6/A15=' ';
AROLL_DSC6/A60=' ';
AROLL_LEV7/A15=' ';
AROLL_DSC7/A60=' ';
AROLL_LEV8/A15=' ';
AROLL_DSC8/A60=' ';
AROLL_LEV9/A15=' ';
AROLL_DSC9/A60=' ';
END
-RUN

TABLE FILE ALTONE
PRINT AIR_KEY AROLL_LEV1 AROLL_DSC1
AROLL_LEV2 AROLL_DSC2
AROLL_LEV3 AROLL_DSC3
AROLL_LEV4 AROLL_DSC4
AROLL_LEV5 AROLL_DSC5
AROLL_LEV6 AROLL_DSC6
AROLL_LEV7 AROLL_DSC7
AROLL_LEV8 AROLL_DSC8
AROLL_LEV9 AROLL_DSC9
BY AIR_KEY NOPRINT
IF AROLL_LEV1 EQ ' ';
ON TABLE HOLD
END
-RUN

MODIFY FILE ALTONE
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH UPDATE
AROLL_LEV1 AROLL_DSC1
AROLL_LEV2 AROLL_DSC2
AROLL_LEV3 AROLL_DSC3
AROLL_LEV4 AROLL_DSC4
AROLL_LEV5 AROLL_DSC5
AROLL_LEV6 AROLL_DSC6
AROLL_LEV7 AROLL_DSC7
AROLL_LEV8 AROLL_DSC8
AROLL_LEV9 AROLL_DSC9
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-ALMUSA
-TYPE STEVE
-* AIR
TABLE FILE ALMUSA
PRINT AIR_KEY AROLL_DSC4
BY AIR_KEY NOPRINT
IF AROLL_LEV4 EQ 'DEFBU';
ON TABLE HOLD
END
-RUN

MODIFY FILE ALMUSA
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE
AROLL_DSC4='(DEFBU) BUSINESS UNIT DEFAULT - LEVEL4                      ';
ON MATCH UPDATE AROLL_DSC4
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* CAR
TABLE FILE CLMUSA
PRINT CAR_KEY AROLL_DSC4
BY CAR_KEY NOPRINT
IF AROLL_LEV4 EQ 'DEFBU';
ON TABLE HOLD
END
-RUN

MODIFY FILE CLMUSA
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE
AROLL_DSC4='(DEFBU) BUSINESS UNIT DEFAULT - LEVEL4                      ';
ON MATCH UPDATE AROLL_DSC4
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* HOTEL
TABLE FILE HLMUSA
PRINT HTL_KEY AROLL_DSC4
BY HTL_KEY NOPRINT
IF AROLL_LEV4 EQ 'DEFBU';
ON TABLE HOLD
END
-RUN

MODIFY FILE HLMUSA
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE
AROLL_DSC4='(DEFBU) BUSINESS UNIT DEFAULT - LEVEL4                      ';
ON MATCH UPDATE AROLL_DSC4
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT



