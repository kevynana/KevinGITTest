SET ASNAMES = ON
-INCLUDE SETECHO

TABLE FILE AYBOOZ
PRINT AIR_KEY
BY AIR_KEY NOPRINT
IF VAL_AIRLINE EQ 'XA'
ON TABLE HOLD
END

MODIFY FILE AYBOOZ
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE VAL_AIRLINE='2V';
ON MATCH COMPUTE AUX_VAL_ALN='2V';
ON MATCH UPDATE VAL_AIRLINE
ON MATCH UPDATE AUX_VAL_ALN
ON NOMATCH REJECT
DATA ON HOLD
END


TABLE FILE SYBOOZ
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AIRLINE EQ 'XA'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE SYBOOZ
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AIRLINE='2V';
ON MATCH UPDATE AIRLINE
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE MYBOOZ
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AIRLINE EQ 'XA'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE MYBOOZ
FIXFORM FROM MKTHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AIRLINE='2V';
ON MATCH UPDATE AIRLINE
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE DYBOOZ
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AIRLINE EQ 'XA'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE DYBOOZ
FIXFORM FROM DSTHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AIRLINE='2V';
ON MATCH UPDATE AIRLINE
ON NOMATCH REJECT
DATA ON DSTHOLD
END


 