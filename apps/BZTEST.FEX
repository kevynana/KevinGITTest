SET ASNAMES=ON

JOIN AIR_KEY IN A4BOOZ TO ALL AIR_KEY IN S4BOOZ AS J1
-RUN



DEFINE FILE A4BOOZ
  LEV/A1 = EDIT(LEVEL1, '9');
  
  CHG_CAT/A10 = IF LEV EQ 'B' THEN 'B' ELSE
                IF LEV EQ 'G' THEN 'G' ELSE 
                IF LEV EQ 'M' THEN 'M' ELSE 'NONBMG';
                
  
  
  FARE_PAID/D12.2CS   = SEG_AMT + SEG_TAX;
  
  NET_TKT_CNT/D8CS    = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
  

-* ****DEFINES ON PREVIOUS DEFINES****
 
  DISSAVINGS/D11.2CS  = IF EMBARK EQ 'DT1' THEN 0 ELSE
                         FARE_PAID - SEG_LOWEST;
  
               
END
-RUN



TABLE FILE A4BOOZ
SUM NET_TKT_CNT
    FARE_PAID
    DISSAVINGS
BY CHG_CAT    
BY REFUSE_CODE   
WHERE VOID_DATE EQ 0
WHERE (TRN_DATE GE '20101101') AND (TRN_DATE LE '20101130')
WHERE AROLL_LEV2 EQ 'BOOZB'
ON CHG_CAT SUMMARIZE AS 'TOTAL FOR'
ON TABLE PCHOLD FORMAT EXL2K
END
-RUN




