-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-*  Deb  - 9/8/06 added dod_type K to fee
-* REMOVED SPLIT FEES TO 90201401 PER CHERYL COUGHLIN - DEB 8/18/2008


SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

-SET &HTLDATES = &&WEB_PATH || 'HTLDATES.fex';
DEFINE FILE &&EXTRACT
  XPSNGR_NM/A15        = 
    EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
  PAX/A5 = EDIT(XPSNGR_NM, '99999$$$$$$$$$$');
  ACCOUNT/A8 = '6022001';
  LINE_DESC/A38 = XPSNGR_NM||TKT_NUM||PNR_LOCATOR|' '|'H';
  FEE/P5.2S = IF DOD_TYPE NE ' '  OR 'K' AND TKT_NUM EQ '0000000000' THEN 5 ELSE 0;
  FEE1/P5.2S = IF DOD_TYPE NE ' ' OR 'K' AND TKT_NUM EQ '0000000000' THEN 2 ELSE 0; 
  
END
-RUN

TABLEF FILE &&EXTRACT
PRINT ACCOUNT
  FEE
  FEE1
  INVOICE_DATE
  LINE_DESC
  LEVEL1  
  PAX
  PNR_LOCATOR
  XPSNGR_NM    
-INCLUDE &HTLDATES    
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10

-INCLUDE RPTPARMS
ON TABLE HOLD AS HTLHOLD

END
-RUN

DEFINE FILE HTLHOLD
FLAG/A1 = 'E';
END
TABLE FILE HTLHOLD
PRINT ACCOUNT 
      FEE
      LEVEL1 
      LINE_DESC
      PAX
      PNR_LOCATOR
      XPSNGR_NM
      INVOICE_DATE AS 'XTRAN_DT'
BY FLAG
ON TABLE HOLD AS HH1 FORMAT FOCUS
END
-RUN

-GOTO SkipItHtl;

DEFINE FILE HTLHOLD
FLAG/A1 = 'F';
LEVEL1/A15 = '90201401';
END
TABLE FILE HTLHOLD
PRINT ACCOUNT 
      FEE1 AS 'FEE'
      LEVEL1 
      LINE_DESC
      PAX
      PNR_LOCATOR
      XPSNGR_NM
      INVOICE_DATE AS 'XTRAN_DT'
BY FLAG
ON TABLE HOLD AS HH2 FORMAT FOCUS
END
-RUN


-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HA=&HLDPATH || 'HH1.FOC';
-SET &HB=&HLDPATH || 'HH2.FOC';
-RUN

USE CLEAR *
-RUN

EX SUUSES
-RUN 

USE ADD 
&HA AS HH1
&HB AS HH1
END
-RUN

-SkipItHtl;

TABLE FILE HH1
PRINT FEE LEVEL1 LINE_DESC XPSNGR_NM XTRAN_DT PNR_LOCATOR PAX
BY FLAG
BY ACCOUNT
ON TABLE HOLD AS HH2 FORMAT FOCUS
END
-RUN