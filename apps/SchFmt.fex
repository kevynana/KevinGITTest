-**************************************************************
-* This program is used to reformat the report as some rows 
-* are integers, and some are double precision numbers in the
-* same column.  Integer row do not print decimal point.
-*
-* Read data from the file OUT1 and format the data,
-* and the formatted data in the file SCHMAIN2.
-* Date: March 23, 2004
-* 
-**************************************************************
-SET &SP2 = '  ';
-SET &SP5 = '     ';
-SET &CNT = 1;
-REPEAT TOEND &LINES TIMES
-READ OUT1 NOCLOSE &CO.2. &CAT.8. &RO.2. &KEY.1. &RL.25. &M1.12. &M2.12. , 
- &M3.12. &M4.12. &M5.12. &M6.12. &M7.12. &M8.12. &M9.12. &M10.12 &M11.12. , 
- &M12.12. &YTD.12.

-IF &RL EQ 'TICKETS ISSUED' OR &RL EQ 'NET TICKETS' OR &RL EQ 'FULL REFUNDS' OR
- &RL EQ 'DOMESTIC NET TICKETS'  OR &RL EQ 'INTERNATIONAL NET TICKETS' OR
- &RL EQ 'HOTEL BOOKINGS' OR &RL EQ 'HOTEL NIGHTS' OR 
- &RL EQ 'CAR BOOKINGS' OR &RL EQ 'CAR DAYS'
- THEN GOTO IFORMAT ELSE GOTO DFORMAT;

-**********************************************
-* integer format
-**********************************************
-IFORMAT
-SET &LEN = IF &M1 EQ 0 THEN 0 
- ELSE IF &M1 LT 1000 THEN 1 
- ELSE IF &M1 LT 1000000 THEN 2 
- ELSE 3;

-SET &M1A  = IF &LEN EQ 0 THEN &SP2 |  &M1 
- ELSE &SP5 |  EDIT('&M1.EVAL', '999999999');

-SET &LEN = IF &M2 EQ 0 THEN 0 
- ELSE IF &M2 LT 1000 THEN 1 
- ELSE IF &M2 LT 1000000 THEN 2 
- ELSE 3;

-SET &M2A  = IF &LEN EQ 0 THEN &SP2 |   &M2 
- ELSE &SP5 |  EDIT('&M2.EVAL', '999999999');

-SET &LEN = IF &M3 EQ 0 THEN 0 
- ELSE IF &M3 LT 1000 THEN 1 
- ELSE IF &M3 LT 1000000 THEN 2 
- ELSE 3;

-SET &M3A  = IF &LEN EQ 0 THEN &SP2 |   &M3 
- ELSE &SP5 |  EDIT('&M3.EVAL', '999999999');

-SET &LEN = IF &M4 EQ 0 THEN 0 
- ELSE IF &M4 LT 1000 THEN 1 
- ELSE IF &M4 LT 1000000 THEN 2 
- ELSE 3;

-SET &M4A  = IF &LEN EQ 0 THEN &SP2 |   &M4 
- ELSE &SP5 |  EDIT('&M4.EVAL', '999999999');

-SET &LEN = IF &M5 EQ 0 THEN 0 
- ELSE IF &M5 LT 1000 THEN 1 
- ELSE IF &M5 LT 1000000 THEN 2 
- ELSE 3;

-SET &M5A  = IF &LEN EQ 0 THEN &SP2 |  &M5 
- ELSE &SP5 |  EDIT('&M5.EVAL', '999999999');

-SET &LEN = IF &M6 EQ 0 THEN 0 
- ELSE IF &M6 LT 1000 THEN 1 
- ELSE IF &M6 LT 1000000 THEN 2 
- ELSE 3;

-SET &M6A  = IF &LEN EQ 0 THEN &SP2 |  &M6 
- ELSE &SP5 |  EDIT('&M6.EVAL', '999999999');

-SET &LEN = IF &M7 EQ 0 THEN 0 
- ELSE IF &M7 LT 1000 THEN 1 
- ELSE IF &M7 LT 1000000 THEN 2 
- ELSE 3;

-SET &M7A  = IF &LEN EQ 0 THEN &SP2 |  &M7 
- ELSE &SP5 |  EDIT('&M7.EVAL', '999999999');

-SET &LEN = IF &M8 EQ 0 THEN 0 
- ELSE IF &M8 LT 1000 THEN 1 
- ELSE IF &M8 LT 1000000 THEN 2 
- ELSE 3;

-SET &M8A  = IF &LEN EQ 0 THEN &SP2 |  &M8 
- ELSE &SP5 |  EDIT('&M8.EVAL', '999999999');

-SET &LEN = IF &M9 EQ 0 THEN 0 
- ELSE IF &M9 LT 1000 THEN 1 
- ELSE IF &M9 LT 1000000 THEN 2 
- ELSE 3;

-SET &M9A  = IF &LEN EQ 0 THEN &SP2 |  &M9 
- ELSE &SP5 |  EDIT('&M9.EVAL', '999999999');

-SET &LEN = IF &M10 EQ 0 THEN 0 
- ELSE IF &M10 LT 1000 THEN 1 
- ELSE IF &M10 LT 1000000 THEN 2 
- ELSE 3;

-SET &M10A = IF &LEN EQ 0 THEN &SP2 |  &M10 
- ELSE &SP5 |  EDIT('&M10.EVAL', '999999999');

-SET &LEN = IF &M11 EQ 0 THEN 0 
- ELSE IF &M11 LT 1000 THEN 1 
- ELSE IF &M11 LT 1000000 THEN 2 
- ELSE 3;

-SET &M11A = IF &LEN EQ 0 THEN &SP2 |  &M11 
- ELSE &SP5 |  EDIT('&M11.EVAL', '999999999');

-SET &LEN = IF &M12 EQ 0 THEN 0 
- ELSE IF &M12 LT 1000 THEN 1 
- ELSE IF &M12 LT 1000000 THEN 2 
- ELSE 3;

-SET &M12A = IF &LEN EQ 0 THEN &SP2 |  &M12 
- ELSE &SP5 |  EDIT('&M12.EVAL', '999999999');

-SET &LEN = IF &YTD EQ 0 THEN 0 
- ELSE IF &YTD LT 1000 THEN 1 
- ELSE IF &YTD LT 1000000 THEN 2 
- ELSE 3;

-SET &YTDA = IF &LEN EQ 0 THEN &SP2 |  &YTD 
- ELSE &SP5 |  EDIT('&YTD.EVAL', '999999999');

-GOTO ADDCOUNTER;

-**********************************************
-* double precision numbers
-**********************************************
-DFORMAT
-SET &LEN = IF &M1 EQ 0 THEN 0 
- ELSE IF &M1 LT 1000 THEN 1 
- ELSE IF &M1 LT 1000000 THEN 2 
- ELSE 3;

-SET &M1A  = IF &LEN EQ 0 THEN '  ' | &M1 
- ELSE IF &LEN EQ 1 THEN EDIT('&M1.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M1.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M1.EVAL', '999,999,999999');

-SET &LEN = IF &M2 EQ 0 THEN 0 
- ELSE IF &M2 LT 1000 THEN 1 
- ELSE IF &M2 LT 1000000 THEN 2 
- ELSE 3;

-SET &M2A  = IF &LEN EQ 0 THEN &SP2 | &M2 
- ELSE IF &LEN EQ 1 THEN EDIT('&M2.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M2.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M2.EVAL', '999,999,999999');

-SET &LEN = IF &M3 EQ 0 THEN 0 
- ELSE IF &M3 LT 1000 THEN 1 
- ELSE IF &M3 LT 1000000 THEN 2 
- ELSE 3;

-SET &M3A  = IF &LEN EQ 0 THEN &SP2 | &M3 
- ELSE IF &LEN EQ 1 THEN EDIT('&M3.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M3.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M3.EVAL', '999,999,999999');

-SET &LEN = IF &M4 EQ 0 THEN 0 
- ELSE IF &M4 LT 1000 THEN 1 
- ELSE IF &M4 LT 1000000 THEN 2 
- ELSE 3;

-SET &M4A  = IF &LEN EQ 0 THEN &SP2 | &M4 
- ELSE IF &LEN EQ 1 THEN EDIT('&M4.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M4.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M4.EVAL', '999,999,999999');

-SET &LEN = IF &M5 EQ 0 THEN 0 
- ELSE IF &M5 LT 1000 THEN 1 
- ELSE IF &M5 LT 1000000 THEN 2 
- ELSE 3;

-SET &M5A  = IF &LEN EQ 0 THEN &SP2 | &M5 
- ELSE IF &LEN EQ 1 THEN EDIT('&M5.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M5.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M5.EVAL', '999,999,999999');

-SET &LEN = IF &M6 EQ 0 THEN 0 
- ELSE IF &M6 LT 1000 THEN 1 
- ELSE IF &M6 LT 1000000 THEN 2 
- ELSE 3;

-SET &M6A  = IF &LEN EQ 0 THEN &SP2 | &M6 
- ELSE IF &LEN EQ 1 THEN EDIT('&M6.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M6.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M6.EVAL', '999,999,999999');

-SET &LEN = IF &M7 EQ 0 THEN 0 
- ELSE IF &M7 LT 1000 THEN 1 
- ELSE IF &M7 LT 1000000 THEN 2 
- ELSE 3;

-SET &M7A  = IF &LEN EQ 0 THEN &SP2 | &M7 
- ELSE IF &LEN EQ 1 THEN EDIT('&M7.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M7.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M7.EVAL', '999,999,999999');

-SET &LEN = IF &M8 EQ 0 THEN 0 
- ELSE IF &M8 LT 1000 THEN 1 
- ELSE IF &M8 LT 1000000 THEN 2 
- ELSE 3;

-SET &M8A  = IF &LEN EQ 0 THEN &SP2 | &M8 
- ELSE IF &LEN EQ 1 THEN EDIT('&M8.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M8.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M8.EVAL', '999,999,999999');

-SET &LEN = IF &M9 EQ 0 THEN 0 
- ELSE IF &M9 LT 1000 THEN 1 
- ELSE IF &M9 LT 1000000 THEN 2 
- ELSE 3;

-SET &M9A  = IF &LEN EQ 0 THEN &SP2 | &M9 
- ELSE IF &LEN EQ 1 THEN EDIT('&M9.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M9.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M9.EVAL', '999,999,999999');

-SET &LEN = IF &M10 EQ 0 THEN 0 
- ELSE IF &M10 LT 1000 THEN 1 
- ELSE IF &M10 LT 1000000 THEN 2 
- ELSE 3;

-SET &M10A = IF &LEN EQ 0 THEN &SP2 | &M10 
- ELSE IF &LEN EQ 1 THEN EDIT('&M10.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M10.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M10.EVAL', '999,999,999999');

-SET &LEN = IF &M11 EQ 0 THEN 0 
- ELSE IF &M11 LT 1000 THEN 1 
- ELSE IF &M11 LT 1000000 THEN 2 
- ELSE 3;

-SET &M11A = IF &LEN EQ 0 THEN &SP2 | &M11 
- ELSE IF &LEN EQ 1 THEN EDIT('&M11.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M11.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M11.EVAL', '999,999,999999');

-SET &LEN = IF &M12 EQ 0 THEN 0 
- ELSE IF &M12 LT 1000 THEN 1 
- ELSE IF &M12 LT 1000000 THEN 2 
- ELSE 3;

-SET &M12A = IF &LEN EQ 0 THEN &SP2 | &M12 
- ELSE IF &LEN EQ 1 THEN EDIT('&M12.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&M12.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&M12.EVAL', '999,999,999999');

-SET &LEN = IF &YTD EQ 0 THEN 0 
- ELSE IF &YTD LT 1000 THEN 1 
- ELSE IF &YTD LT 1000000 THEN 2 
- ELSE 3;

-SET &YTDA = IF &LEN EQ 0 THEN &SP2 | &YTD 
- ELSE IF &LEN EQ 1 THEN EDIT('&YTD.EVAL', '  999999999999')
- ELSE IF &LEN EQ 2 THEN EDIT('&YTD.EVAL', ' 999999,999999')
- ELSE IF &LEN EQ 3 THEN EDIT('&YTD.EVAL', '999,999,999999');

-ADDCOUNTER
-SET &PRINTLINE.&CNT = &CO | &CAT | &RO | &KEY | &RL | &M1A | &M2A | &M3A | 
- &M4A | &M5A | &M6A | &M7A | &M8A | &M9A | &M10A | &M11A | &M12A | &YTDA;

-SET &CNT = &CNT + 1;
-TOEND

-SET &CNT = &CNT - 1;
-SET &CNT2 = 1;
-REPEAT TOWEND2 &CNT TIMES
-SET &PRINT = &PRINTLINE.&CNT2;
-WRITE SCHMAIN2 NOCLOSE &PRINT
-SET &CNT2 = &CNT2 + 1;
-TOWEND2
-CLOSE SCHMAIN2

