-SET ASNAMES = ON

-INCLUDE SETECHO

-SET &&BRAU_AIR = &&WEB_PATH || 'BRAU_AIR.FOC';
-RUN
FILEDEF BRAU_AIR DISK &&BRAU_AIR
-RUN

CREATE FILE BRAU_AIR
-RUN





DEFINE FILE HOLDTWO
NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
PERIOD1/A40 = 'PERIOD1';
PERIOD2/A40 = 'PERIOD2';
LVL_DSC/A40 = EDIT (LEVEL_DESC, '9999999999999999999999999999999999999999');
END
TABLE FILE HOLDTWO
SUM P1FARE
       P1NET_TKTS
       P1ONL_TKTS
       P1ONL_FARE
       P2FARE
       P2NET_TKTS
       P2ONL_TKTS
       P2ONL_FARE
       PERIOD1
       PERIOD2
BY LVL_DSC
ON TABLE HOLD AS HOLDTHREE
END
-RUN




-* Monthly

DEFINE FILE HOLDTHREE
CATEGORY/A40 = PERIOD1;
CAT_ORDER/I2 = 1;
END
TABLE FILE HOLDTHREE
PRINT CATEGORY/A40 AND LVL_DSC/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND P1NET_TKTS/D12 AS 'CNT_1' AND
P1FARE/D12.2 AS 'AMT_1' AND
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
ON TABLE HOLD AS MONTHLY
END
-RUN


TABLE FILE MONTHLY
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND CNT_1 AND AMT_1
ON TABLE HOLD AS MONTHLY1
END
MODIFY FILE BRAU_AIR
FIXFORM FROM MONTHLY1
MATCH CATEGORY ROW_LABEL ROW_ORDER CNT_1 AMT_1
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MONTHLY1
END
-RUN


-* YTD

DEFINE FILE HOLDTHREE
CATEGORY/A40 = PERIOD2;
CAT_ORDER/I2 = 2;
END
TABLE FILE HOLDTHREE
PRINT CATEGORY/A40 AND LVL_DSC/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND P2NET_TKTS/D12 AS 'CNT_1' AND
P2FARE/D12.2 AS 'AMT_1' AND
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
ON TABLE HOLD AS YTD
END
-RUN


TABLE FILE YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND CNT_1 AND AMT_1
ON TABLE HOLD AS YTD1
END
MODIFY FILE BRAU_AIR
FIXFORM FROM YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER CNT_1 AMT_1
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON YTD1
END
-RUN


-CAR

-SET &&BRAU_CAR = &&WEB_PATH || 'BRAU_CAR.FOC';
-RUN
FILEDEF BRAU_CAR DISK &&BRAU_CAR
-RUN 
CREATE FILE BRAU_CAR
-RUN


DEFINE FILE CARHOLD
NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
PERIOD1/A40 = 'PERIOD1';
PERIOD2/A40 = 'PERIOD2';
LVL_DSC/A40 = EDIT (LEVEL_DESC, '9999999999999999999999999999999999999999');
END
TABLE FILE CARHOLD
SUM MRNTL_DAYS
    MRNTL_AMT
    YRNTL_DAYS
    YRNTL_AMT
     PERIOD1
     PERIOD2
BY LVL_DSC
ON TABLE HOLD AS CARTHREE
END
-RUN

-* Monthly

DEFINE FILE CARTHREE
CATEGORY/A40 = PERIOD1;
CAT_ORDER/I2 = 1;
END
TABLE FILE CARTHREE
PRINT CATEGORY/A40 AND LVL_DSC/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND MRNTL_DAYS/D12 AS 'CNT_1' AND
MRNTL_AMT/D12.2 AS 'AMT_1' AND
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
ON TABLE HOLD AS CARMNTH
END
-RUN


TABLE FILE CARMNTH
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND CNT_1 AND AMT_1
ON TABLE HOLD AS CARMNTH1
END
MODIFY FILE BRAU_CAR
FIXFORM FROM CARMNTH1
MATCH CATEGORY ROW_LABEL ROW_ORDER CNT_1 AMT_1
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON CARMNTH1
END
-RUN


-* YTD

DEFINE FILE CARTHREE
CATEGORY/A40 = PERIOD2;
CAT_ORDER/I2 = 2;
END
TABLE FILE CARTHREE
PRINT CATEGORY/A40 AND LVL_DSC/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND YRNTL_DAYS/D12 AS 'CNT_1' AND
YRNTL_AMT/D12.2 AS 'AMT_1' AND
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
ON TABLE HOLD AS CARYTD
END
-RUN


TABLE FILE CARYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND CNT_1 AND AMT_1
ON TABLE HOLD AS CARYTD1
END
MODIFY FILE BRAU_CAR
FIXFORM FROM CARYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER CNT_1 AMT_1
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON CARYTD1
END
-RUN


-*Hotel

 
 
DEFINE FILE HOTEL2
NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
PERIOD1/A40 = 'PERIOD1';
PERIOD2/A40 = 'PERIOD2';
LVL_DSC/A40 = EDIT (LEVEL_DESC, '9999999999999999999999999999999999999999');
END
TABLE FILE HOTEL2
SUM MROOMS
    YROOMS
    MTTL_AMT
    YTTL_AMT
    PERIOD1
    PERIOD2
BY LVL_DSC
ON TABLE HOLD AS HTLTHREE
END
-RUN

-* Monthly

DEFINE FILE HTLTHREE
CATEGORY/A40 = PERIOD1;
CAT_ORDER/I2 = 1;
END
TABLE FILE HTLTHREE
PRINT CATEGORY/A40 AND LVL_DSC/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND MROOMS/D12 AS 'CNT_1' AND
MTTL_AMT/D12.2 AS 'AMT_1' AND
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
ON TABLE HOLD AS HTLMNTH
END
-RUN


TABLE FILE HTLMNTH
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND CNT_1 AND AMT_1
ON TABLE HOLD AS HTLMNTH1
END
MODIFY FILE BRAU_HTL
FIXFORM FROM HTLMNTH1
MATCH CATEGORY ROW_LABEL ROW_ORDER CNT_1 AMT_1
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON HTLMNTH1
END
-RUN


-* YTD

DEFINE FILE HTLTHREE
CATEGORY/A40 = PERIOD2;
CAT_ORDER/I2 = 2;
END
TABLE FILE HTLTHREE
PRINT CATEGORY/A40 AND LVL_DSC/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND YROOMS/D12 AS 'CNT_1' AND
YTTL_AMT/D12.2 AS 'AMT_1' AND
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
ON TABLE HOLD AS HTLYTD
END
-RUN


TABLE FILE HTLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND
      ROW_ORDER AND CNT_1 AND AMT_1
ON TABLE HOLD AS HTLYTD1
END
MODIFY FILE BRAU_HTL
FIXFORM FROM HTLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER CNT_1 AMT_1
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON HTLYTD1
END
-RUN





-GOTO XXIT 



TABLE FILE BRAU_HTL
PRINT BRAU_HTL.ROW_LABEL AS 'DIVISION'
      BRAU_HTL.CNT_1  AS 'TRIPS'  
      BRAU_HTL.AMT_1 AS 'TICKET AMOUNT' 
      
BY BRAU_HTL.CAT_ORDER NOPRINT
 BY BRAU_HTL.CATEGORY AS ' '      

BY BRAU_HTL.ROW_ORDER NOPRINT

ON BRAU_HTL.CATEGORY SKIP-LINE
END
-RUN
-QUIT

-XXIT