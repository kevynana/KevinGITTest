-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Created for Metlife Commercial Flight Analysis
-* ADDED TRANTYPE INCLUDE - JK 12/29/14 STORY ID S-06492

-********************************************************************


-INCLUDE SETECHO

SET ASNAMES = ON
-RUN

FI METX_PAX DISK D:\TNT\TTRACKER\TEMP\METX_PAX.TXT

-SET HOLDATTR = ON;

-SET &AIRDATES = &&WEB_PATH || 'AIRDATES.fex';

DEFINE FILE SR_50
-*   FARE_PAID/D12.2CSM = TICKET_AMT + TAX_AMT;
  FARE/D12.2CSM = SEG_AMT + SEG_TAX;
 
  LEVEL_DESC/A60      = &&LDESC;  
  NET_TKT_CNT/P9S    = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
  NEW_SEG_MILES/P9S = SEG_MILES;
  XDPT_DT/MDYY         = DPT_DATE;  
  TSORT/A1 = EDIT(TKT_SORT,'$$$$$$$$$$9');
-INCLUDE TRANTYPE  
END
-RUN

TABLEF FILE SR_50
PRINT   AIR_KEY
        CITYPAIR.EMBARK      AS 'EMB_APT_CD'	
        CITYPAIR.ROUTE       AS 'RTE_APT_CD'	
        EMB_APT.AIRPORT_NAME AS 'EMB_APT_NM'	
        EMBARK
        FARE
        LEVEL_DESC	
        NET_TKT_CNT
        NEW_SEG_MILES
        PASSNGR_NAME
        RTE_APT.AIRPORT_NAME AS 'RTE_APT_NM'
        ROUTE
        SEG_COUNT	
        SEG_NBR	
        TKT_NUM	
        TKT_SORT
        TSORT
        TRN_DATE
        XDPT_DT	
                 
-INCLUDE &AIRDATES
WHERE VOID_DATE EQ 0
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10


-INCLUDE RPTPARMS

ON TABLE HOLD AS MXTVL1
END
-RUN

-* Segment 01 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC1' EMB_APT_NM AS 'DPTN1' RTE_APT_CD AS 'ARRC1' 
      RTE_APT_NM AS 'ARRN1' NEW_SEG_MILES AS 'MILES1' XDPT_DT AS 'DPT1'
      TKT_NUM PASSNGR_NAME FARE AS 'FARE1'
BY AIR_KEY      
WHERE SEG_NBR EQ '01'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP01 
END
-RUN

-* Segment 02 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC2' EMB_APT_NM AS 'DPTN2' RTE_APT_CD AS 'ARRC2' 
      RTE_APT_NM AS 'ARRN2' NEW_SEG_MILES AS 'MILES2' XDPT_DT AS 'DPT2' FARE AS 'FARE2'
BY AIR_KEY      
WHERE SEG_NBR EQ '02'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP02 
END
-RUN

-* Segment 01/02 Positive Match

MATCH FILE HOLDP01
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP02
SUM DPTC2 DPTN2 ARRC2 ARRN2 MILES2 DPT2 FARE2
BY AIR_KEY
AFTER MATCH HOLD AS MH1 OLD-OR-NEW
END
-RUN

-* Segment 03 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC3' EMB_APT_NM AS 'DPTN3' RTE_APT_CD AS 'ARRC3' 
      RTE_APT_NM AS 'ARRN3' NEW_SEG_MILES AS 'MILES3' XDPT_DT AS 'DPT3' FARE AS 'FARE3'
BY AIR_KEY      
WHERE SEG_NBR EQ '03'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP03 
END
-RUN


-* Segment 01/02/03 Positive Match

MATCH FILE MH1
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
      DPTC2 DPTN2 ARRC2 ARRN2 MILES2 DPT2 FARE2
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP03
SUM DPTC3 DPTN3 ARRC3 ARRN3 MILES3 DPT3 FARE3
BY AIR_KEY
AFTER MATCH HOLD AS MH2 OLD-OR-NEW
END
-RUN

-* Segment 04 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC4' EMB_APT_NM AS 'DPTN4' RTE_APT_CD AS 'ARRC4' 
      RTE_APT_NM AS 'ARRN4' NEW_SEG_MILES AS 'MILES4' XDPT_DT AS 'DPT4' FARE AS 'FARE4'
BY AIR_KEY      
WHERE SEG_NBR EQ '04'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP04
END
-RUN


-* Segment 01/02/03/04 Positive Match

MATCH FILE MH2
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP04
SUM DPTC4 DPTN4 ARRC4 ARRN4 MILES4 DPT4 FARE4
BY AIR_KEY
AFTER MATCH HOLD AS MH3 OLD-OR-NEW
END
-RUN

-* Segment 05 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC5' EMB_APT_NM AS 'DPTN5' RTE_APT_CD AS 'ARRC5' 
      RTE_APT_NM AS 'ARRN5' NEW_SEG_MILES AS 'MILES5' XDPT_DT AS 'DPT5' FARE AS 'FARE5'
BY AIR_KEY      
WHERE SEG_NBR EQ '05'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP05
END
-RUN


-* Segment 01/02/03/04/05 Positive Match

MATCH FILE MH3
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP05
SUM DPTC5 DPTN5 ARRC5 ARRN5 MILES5 DPT5 FARE5
BY AIR_KEY
AFTER MATCH HOLD AS MH4 OLD-OR-NEW
END
-RUN

-* Segment 06 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC6' EMB_APT_NM AS 'DPTN6' RTE_APT_CD AS 'ARRC6' 
      RTE_APT_NM AS 'ARRN6' NEW_SEG_MILES AS 'MILES6' XDPT_DT AS 'DPT6' FARE AS 'FARE6'
BY AIR_KEY      
WHERE SEG_NBR EQ '06'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP06
END
-RUN


-* Segment 01/02/03/04/05/06 Positive Match

MATCH FILE MH4
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP06
SUM DPTC6 DPTN6 ARRC6 ARRN6 MILES6 DPT6 FARE6
BY AIR_KEY
AFTER MATCH HOLD AS MH5 OLD-OR-NEW
END
-RUN

-* Segment 07 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC7' EMB_APT_NM AS 'DPTN7' RTE_APT_CD AS 'ARRC7' 
      RTE_APT_NM AS 'ARRN7' NEW_SEG_MILES AS 'MILES7' XDPT_DT AS 'DPT7' FARE AS 'FARE7'
BY AIR_KEY      
WHERE SEG_NBR EQ '07'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP07
END
-RUN


-* Segment 01/02/03/04/05/06/07 Positive Match

MATCH FILE MH5
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP07
SUM DPTC7 DPTN7 ARRC7 ARRN7 MILES7 DPT7 FARE7
BY AIR_KEY
AFTER MATCH HOLD AS MH6 OLD-OR-NEW
END
-RUN

-* Segment 08 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC8' EMB_APT_NM AS 'DPTN8' RTE_APT_CD AS 'ARRC8' 
      RTE_APT_NM AS 'ARRN8' NEW_SEG_MILES AS 'MILES8' XDPT_DT AS 'DPT8' FARE AS 'FARE8'
BY AIR_KEY      
WHERE SEG_NBR EQ '08'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP08
END
-RUN


-* Segment 01/02/03/04/05/06/07/08 Positive Match

MATCH FILE MH6
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP08
SUM DPTC8 DPTN8 ARRC8 ARRN8 MILES8 DPT8 FARE8
BY AIR_KEY
AFTER MATCH HOLD AS MH7 OLD-OR-NEW
END
-RUN

-* Segment 09 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC9' EMB_APT_NM AS 'DPTN9' RTE_APT_CD AS 'ARRC9' 
      RTE_APT_NM AS 'ARRN9' NEW_SEG_MILES AS 'MILES9' XDPT_DT AS 'DPT9' FARE AS 'FARE9'
BY AIR_KEY      
WHERE SEG_NBR EQ '09'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP09
END
-RUN


-* Segment 01/02/03/04/05/06/07/08/09 Positive Match

MATCH FILE MH7
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP09
SUM DPTC9 DPTN9 ARRC9 ARRN9 MILES9 DPT9 FARE9
BY AIR_KEY
AFTER MATCH HOLD AS MH8 OLD-OR-NEW
END
-RUN

-* Segment 10 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC10' EMB_APT_NM AS 'DPTN10' RTE_APT_CD AS 'ARRC10' 
      RTE_APT_NM AS 'ARRN10' NEW_SEG_MILES AS 'MILES10' XDPT_DT AS 'DPT10' FARE AS 'FARE10'
BY AIR_KEY      
WHERE SEG_NBR EQ '10'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP10
END
-RUN


-* Segment 01/02/03/04/05/06/07/08/09/10 Positive Match

MATCH FILE MH8
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
      DPTC9 DPTN9 ARRC9 ARRN9 FARE9 MILES9 DPT9
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP10
SUM DPTC10 DPTN10 ARRC10 ARRN10 MILES10 DPT10 FARE10
BY AIR_KEY
AFTER MATCH HOLD AS MH9 OLD-OR-NEW
END
-RUN

-* Segment 11 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC11' EMB_APT_NM AS 'DPTN11' RTE_APT_CD AS 'ARRC11' 
      RTE_APT_NM AS 'ARRN11' NEW_SEG_MILES AS 'MILES11' XDPT_DT AS 'DPT11' FARE AS 'FARE11'
BY AIR_KEY      
WHERE SEG_NBR EQ '11'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP11
END
-RUN


-* Segment 01/02/03/04/05/06/07/08/09/10/11 Positive Match

MATCH FILE MH9
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
      DPTC9 DPTN9 ARRC9 ARRN9 FARE9 MILES9 DPT9
      DPTC10 DPTN10 ARRC10 ARRN10 FARE10 MILES10 DPT10
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP11
SUM DPTC11 DPTN11 ARRC11 ARRN11 MILES11 DPT11 FARE11
BY AIR_KEY
AFTER MATCH HOLD AS MH10 OLD-OR-NEW
END
-RUN

-* Segment 12 Positive

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC12' EMB_APT_NM AS 'DPTN12' RTE_APT_CD AS 'ARRC12' 
      RTE_APT_NM AS 'ARRN12' NEW_SEG_MILES AS 'MILES12' XDPT_DT AS 'DPT12' FARE AS 'FARE12'
BY AIR_KEY      
WHERE SEG_NBR EQ '12'
WHERE SEG_COUNT GT 0
ON TABLE HOLD AS HOLDP12
END
-RUN


-* Segment 01/02/03/04/05/06/07/08/09/10/11/12 Positive Match

MATCH FILE MH10
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
      DPTC9 DPTN9 ARRC9 ARRN9 FARE9 MILES9 DPT9
      DPTC10 DPTN10 ARRC10 ARRN10 FARE10 MILES10 DPT10
      DPTC11 DPTN11 ARRC11 ARRN11 FARE11 MILES11 DPT11
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDP12
SUM DPTC12 DPTN12 ARRC12 ARRN12 MILES12 DPT12 FARE12
BY AIR_KEY
AFTER MATCH HOLD AS MH11 OLD-OR-NEW
END
-RUN

-*************************************************************************************************
-* Start of Negative 
-*************************************************************************************************
DEFINE FILE MXTVL1
RF_FARE/D12.2CSM = IF TSORT EQ 'E' THEN FARE ELSE 0;
END
-RUN
TABLE FILE MXTVL1
SUM AIR_KEY PASSNGR_NAME TKT_NUM RF_FARE
BY AIR_KEY NOPRINT
WHERE SEG_COUNT LT 0 OR TSORT EQ 'E'
ON TABLE HOLD AS AKHLD
END
-RUN



-* Segment 01 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC1' EMB_APT_NM AS 'DPTN1' RTE_APT_CD AS 'ARRC1' 
      RTE_APT_NM AS 'ARRN1' FARE AS 'FARE1' NEW_SEG_MILES AS 'MILES1' XDPT_DT AS 'DPT1'  
-*       TKT_NUM PASSNGR_NAME
BY AIR_KEY      
WHERE SEG_NBR EQ '01' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN01 
END
-RUN

MATCH FILE AKHLD
PRINT AIR_KEY TKT_NUM PASSNGR_NAME RF_FARE
BY AIR_KEY 
ON TABLE HOLD
RUN
FILE HOLDN01
SUM DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 
BY AIR_KEY
AFTER MATCH HOLD AS MH0 OLD
END
-RUN


-* Segment 02 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC2' EMB_APT_NM AS 'DPTN2' RTE_APT_CD AS 'ARRC2' 
      RTE_APT_NM AS 'ARRN2' NEW_SEG_MILES AS 'MILES2' XDPT_DT AS 'DPT2' FARE AS 'FARE2'
BY AIR_KEY      
WHERE SEG_NBR EQ '02' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN02 
END
-RUN


-* Segment 01/02 Negative Match

MATCH FILE MH0
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN02
SUM DPTC2 DPTN2 ARRC2 ARRN2 MILES2 DPT2 FARE2
BY AIR_KEY
AFTER MATCH HOLD AS MHN1 OLD
END
-RUN


-* Segment 03 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC3' EMB_APT_NM AS 'DPTN3' RTE_APT_CD AS 'ARRC3' 
      RTE_APT_NM AS 'ARRN3' NEW_SEG_MILES AS 'MILES3' XDPT_DT AS 'DPT3' FARE AS 'FARE3'
BY AIR_KEY      
WHERE SEG_NBR EQ '03' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN03 
END
-RUN

-* Segment 01/02/03 Negative Match

MATCH FILE MHN1
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN03
SUM DPTC3 DPTN3 ARRC3 ARRN3 MILES3 DPT3 FARE3
BY AIR_KEY
AFTER MATCH HOLD AS MHN2 OLD
END
-RUN

-* Segment 04 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC4' EMB_APT_NM AS 'DPTN4' RTE_APT_CD AS 'ARRC4' 
      RTE_APT_NM AS 'ARRN4' NEW_SEG_MILES AS 'MILES4' XDPT_DT AS 'DPT4' FARE AS 'FARE4'
BY AIR_KEY      
WHERE SEG_NBR EQ '04' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN04
END
-RUN


-* Segment 01/02/03/04 Negative Match

MATCH FILE MHN2
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN04
SUM DPTC4 DPTN4 ARRC4 ARRN4 MILES4 DPT4 FARE4
BY AIR_KEY
AFTER MATCH HOLD AS MHN3 OLD
END
-RUN

-* Segment 05 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC5' EMB_APT_NM AS 'DPTN5' RTE_APT_CD AS 'ARRC5' 
      RTE_APT_NM AS 'ARRN5' NEW_SEG_MILES AS 'MILES5' XDPT_DT AS 'DPT5' FARE AS 'FARE5'
BY AIR_KEY      
WHERE SEG_NBR EQ '05' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN05
END
-RUN


-* Segment 01/02/03/04/05 Negative Match

MATCH FILE MHN3
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN05
SUM DPTC5 DPTN5 ARRC5 ARRN5 MILES5 DPT5 FARE5
BY AIR_KEY
AFTER MATCH HOLD AS MHN4 OLD
END
-RUN

-* Segment 06 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC6' EMB_APT_NM AS 'DPTN6' RTE_APT_CD AS 'ARRC6' 
      RTE_APT_NM AS 'ARRN6' NEW_SEG_MILES AS 'MILES6' XDPT_DT AS 'DPT6' FARE AS 'FARE6'
BY AIR_KEY      
WHERE SEG_NBR EQ '06' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN06
END
-RUN


-* Segment 01/02/03/04/05/06 Negative Match

MATCH FILE MHN4
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN06
SUM DPTC6 DPTN6 ARRC6 ARRN6 MILES6 DPT6 FARE6
BY AIR_KEY
AFTER MATCH HOLD AS MHN5 OLD
END
-RUN

-* Segment 07 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC7' EMB_APT_NM AS 'DPTN7' RTE_APT_CD AS 'ARRC7' 
      RTE_APT_NM AS 'ARRN7' NEW_SEG_MILES AS 'MILES7' XDPT_DT AS 'DPT7' FARE AS 'FARE7'
BY AIR_KEY      
WHERE SEG_NBR EQ '07' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN07
END
-RUN


-* Segment 01/02/03/04/05/06/07 Negative Match

MATCH FILE MHN5
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN07
SUM DPTC7 DPTN7 ARRC7 ARRN7 MILES7 DPT7 FARE7
BY AIR_KEY
AFTER MATCH HOLD AS MHN6 OLD
END
-RUN

-* Segment 08 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC8' EMB_APT_NM AS 'DPTN8' RTE_APT_CD AS 'ARRC8' 
      RTE_APT_NM AS 'ARRN8' NEW_SEG_MILES AS 'MILES8' XDPT_DT AS 'DPT8' FARE AS 'FARE8'
BY AIR_KEY      
WHERE SEG_NBR EQ '08' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN08
END
-RUN


-* Segment 01/02/03/04/05/06/07/08 Negative Match

MATCH FILE MHN6
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN08
SUM DPTC8 DPTN8 ARRC8 ARRN8 MILES8 DPT8 FARE8
BY AIR_KEY
AFTER MATCH HOLD AS MHN7 OLD
END
-RUN

-* Segment 09 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC9' EMB_APT_NM AS 'DPTN9' RTE_APT_CD AS 'ARRC9' 
      RTE_APT_NM AS 'ARRN9' NEW_SEG_MILES AS 'MILES9' XDPT_DT AS 'DPT9' FARE AS 'FARE9'
BY AIR_KEY      
WHERE SEG_NBR EQ '09' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN09
END
-RUN


-* Segment 01/02/03/04/05/06/07/08/09 Negative Match

MATCH FILE MHN7
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN09
SUM DPTC9 DPTN9 ARRC9 ARRN9 MILES9 DPT9 FARE9
BY AIR_KEY
AFTER MATCH HOLD AS MHN8 OLD
END
-RUN

-* Segment 10 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC10' EMB_APT_NM AS 'DPTN10' RTE_APT_CD AS 'ARRC10' 
      RTE_APT_NM AS 'ARRN10' NEW_SEG_MILES AS 'MILES10' XDPT_DT AS 'DPT10' FARE AS 'FARE10'
BY AIR_KEY      
WHERE SEG_NBR EQ '10' OR EMBARK EQ 'RF1' OR ROUTE EQ 'RF1'
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN10
END
-RUN


-* Segment 01/02/03/04/05/06/07/08/09/10 Negative Match

MATCH FILE MHN8
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
      DPTC9 DPTN9 ARRC9 ARRN9 FARE9 MILES9 DPT9  
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN10
SUM DPTC10 DPTN10 ARRC10 ARRN10 MILES10 DPT10 FARE10
BY AIR_KEY
AFTER MATCH HOLD AS MHN9 OLD
END
-RUN

-* Segment 11 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC11' EMB_APT_NM AS 'DPTN11' RTE_APT_CD AS 'ARRC11' 
      RTE_APT_NM AS 'ARRN11' NEW_SEG_MILES AS 'MILES11' XDPT_DT AS 'DPT11' FARE AS 'FARE11'
BY AIR_KEY      
WHERE SEG_NBR EQ '11' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN11
END
-RUN


-* Segment 01/02/03/04/05/06/07/08/09/10/11 Negative Match

MATCH FILE MHN9
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
      DPTC9 DPTN9 ARRC9 ARRN9 FARE9 MILES9 DPT9
      DPTC10 DPTN10 ARRC10 ARRN10 FARE10 MILES10 DPT10      
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN11
SUM DPTC11 DPTN11 ARRC11 ARRN11 MILES11 DPT11 FARE11
BY AIR_KEY
AFTER MATCH HOLD AS MHN10 OLD
END
-RUN

-* Segment 12 Negative

TABLE FILE MXTVL1
PRINT EMB_APT_CD AS 'DPTC12' EMB_APT_NM AS 'DPTN12' RTE_APT_CD AS 'ARRC12' 
      RTE_APT_NM AS 'ARRN12' NEW_SEG_MILES AS 'MILES12' XDPT_DT AS 'DPT12' FARE AS 'FARE12'
BY AIR_KEY      
WHERE SEG_NBR EQ '12' 
WHERE SEG_COUNT LT 0
ON TABLE HOLD AS HOLDN12
END
-RUN


-* Segment 01/02/03/04/05/06/07/08/09/10/11/12 Negative Match

MATCH FILE MHN10
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
      DPTC9 DPTN9 ARRC9 ARRN9 FARE9 MILES9 DPT9
      DPTC10 DPTN10 ARRC10 ARRN10 FARE10 MILES10 DPT10
      DPTC11 DPTN11 ARRC11 ARRN11 FARE11 MILES11 DPT11
BY AIR_KEY
ON TABLE HOLD
RUN
FILE HOLDN12
SUM DPTC12 DPTN12 ARRC12 ARRN12 MILES12 DPT12 FARE12
BY AIR_KEY
AFTER MATCH HOLD AS MHN11 OLD
END
-RUN


DEFINE FILE MH11
RF_FARE/D12.2CSM = 0.00;
END
-RUN
TABLE FILE MH11
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
      DPTC9 DPTN9 ARRC9 ARRN9 FARE9 MILES9 DPT9
      DPTC10 DPTN10 ARRC10 ARRN10 FARE10 MILES10 DPT10
      DPTC11 DPTN11 ARRC11 ARRN11 FARE11 MILES11 DPT11
      DPTC12 DPTN12 ARRC12 ARRN12 FARE12 MILES12 DPT12
BY AIR_KEY
ON TABLE HOLD AS POS12 FORMAT FOCUS INDEX AIR_KEY
END
-RUN


TABLE FILE MHN11
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
      DPTC9 DPTN9 ARRC9 ARRN9 FARE9 MILES9 DPT9
      DPTC10 DPTN10 ARRC10 ARRN10 FARE10 MILES10 DPT10
      DPTC11 DPTN11 ARRC11 ARRN11 FARE11 MILES11 DPT11
      DPTC12 DPTN12 ARRC12 ARRN12 FARE12 MILES12 DPT12
BY AIR_KEY
ON TABLE HOLD AS NEG12 FORMAT FOCUS INDEX AIR_KEY
END
-RUN


-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HPOS=&HLDPATH || 'POS12.FOC';
-SET &HNEG=&HLDPATH || 'NEG12.FOC';
-RUN

USE CLEAR *
-RUN

EX SUUSES
-RUN

USE ADD 
&HPOS AS POS12
&HNEG AS POS12
END
-RUN

-GOTO JEKK1;

TABLE FILE MXTVL1
PRINT FARE AS 'FAREA'
BY AIR_KEY
WHERE EMBARK EQ 'RF1' OR ROUTE EQ 'RF1'
WHERE SEG_COUNT EQ 0
ON TABLE HOLD AS RFHLD
END
-RUN

MATCH FILE POS12
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 TKT_NUM PASSNGR_NAME RF_FARE
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
      DPTC9 DPTN9 ARRC9 ARRN9 FARE9 MILES9 DPT9
      DPTC10 DPTN10 ARRC10 ARRN10 FARE10 MILES10 DPT10
      DPTC11 DPTN11 ARRC11 ARRN11 FARE11 MILES11 DPT11
      DPTC12 DPTN12 ARRC12 ARRN12 FARE12 MILES12 DPT12
BY AIR_KEY
ON TABLE HOLD
RUN
FILE RFHLD
SUM FAREA
BY AIR_KEY
AFTER MATCH HOLD AS POS12A OLD
END
-RUN

-JEKK1;

DEFINE FILE POS12
FARET/D12.2CSM = RF_FARE+FARE1+FARE2+FARE3+FARE4+FARE5+FARE6+FARE7+FARE8+FARE9+FARE10+FARE11+FARE12;
TMIL/D9S = MILES1+MILES2+MILES3+MILES4+MILES5+MILES6+MILES7+MILES8+MILES9+MILES10+MILES11+MILES12;
END
-RUN
TABLE FILE POS12
PRINT DPTC1 DPTN1 ARRC1 ARRN1 FARE1 MILES1 DPT1 
      DPTC2 DPTN2 ARRC2 ARRN2 FARE2 MILES2 DPT2
      DPTC3 DPTN3 ARRC3 ARRN3 FARE3 MILES3 DPT3 
      DPTC4 DPTN4 ARRC4 ARRN4 FARE4 MILES4 DPT4
      DPTC5 DPTN5 ARRC5 ARRN5 FARE5 MILES5 DPT5
      DPTC6 DPTN6 ARRC6 ARRN6 FARE6 MILES6 DPT6 
      DPTC7 DPTN7 ARRC7 ARRN7 FARE7 MILES7 DPT7
      DPTC8 DPTN8 ARRC8 ARRN8 FARE8 MILES8 DPT8
      DPTC9 DPTN9 ARRC9 ARRN9 FARE9 MILES9 DPT9
      DPTC10 DPTN10 ARRC10 ARRN10 FARE10 MILES10 DPT10
      DPTC11 DPTN11 ARRC11 ARRN11 FARE11 MILES11 DPT11
      DPTC12 DPTN12 ARRC12 ARRN12 FARE12 MILES12 DPT12
      FARET TMIL
BY PASSNGR_NAME
BY TKT_NUM
ON TABLE HOLD AS POS12A
END
-RUN

DEFINE FILE POS12A
NOWTOD/A8 WITH PASSNGR_NAME = HHMMSS (NOWTOD);
END

-SET &&RPTSUF = 'DTL';

-INCLUDE FDEFRPTS
-RUN

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXLS'; 
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&DTSTY;
-RUN

TABLE FILE POS12A
-* -INCLUDE HEADEX
PRINT PASSNGR_NAME AS 'Last Name/First Name' TKT_NUM AS 'Ticket Number' DPT1 AS 'Depature Date,01' DPTC1 AS 'Departure,01' DPTN1 AS 'Departure 01,Airport,Name' ARRC1 AS 'Arrival,01' ARRN1 AS 'Arrival,01,Airport,Name' MILES1 AS 'Miles,01'
DPT2 AS 'Depature Date,02' DPTC2 AS 'Departure,02' DPTN2 AS 'Departure 02,Airport,Name' ARRC2 AS 'Arrival,02' ARRN2 AS 'Arrival,02,Airport,Name' MILES2 AS 'Miles,02'
DPT3 AS 'Depature Date,03' DPTC3 AS 'Departure,03' DPTN3 AS 'Departure 03,Airport,Name' ARRC3 AS 'Arrival,03' ARRN3 AS 'Arrival,03,Airport,Name' MILES3 AS 'Miles,03'
DPT4 AS 'Depature Date,04' DPTC4 AS 'Departure,04' DPTN4 AS 'Departure 04,Airport,Name' ARRC4 AS 'Arrival,04' ARRN4 AS 'Arrival,04,Airport,Name' MILES4 AS 'Miles,04'
DPT5 AS 'Depature Date,05' DPTC5 AS 'Departure,05' DPTN5 AS 'Departure 05,Airport,Name' ARRC5 AS 'Arrival,05' ARRN5 AS 'Arrival,05,Airport,Name' MILES5 AS 'Miles,05'
DPT6 AS 'Depature Date,06' DPTC6 AS 'Departure,06' DPTN6 AS 'Departure 06,Airport,Name' ARRC6 AS 'Arrival,06' ARRN6 AS 'Arrival,06,Airport,Name' MILES6 AS 'Miles,06'
DPT7 AS 'Depature Date,07' DPTC7 AS 'Departure,07' DPTN7 AS 'Departure 07,Airport,Name' ARRC7 AS 'Arrival,07' ARRN7 AS 'Arrival,07,Airport,Name' MILES7 AS 'Miles,07'
DPT8 AS 'Depature Date,08' DPTC8 AS 'Departure,08' DPTN8 AS 'Departure 08,Airport,Name' ARRC8 AS 'Arrival,08' ARRN8 AS 'Arrival,08,Airport,Name' MILES8 AS 'Miles,08'
DPT9 AS 'Depature Date,09' DPTC9 AS 'Departure,09' DPTN9 AS 'Departure 09,Airport,Name' ARRC9 AS 'Arrival,09' ARRN9 AS 'Arrival,09,Airport,Name' MILES9 AS 'Miles,09'
DPT10 AS 'Depature Date,10' DPTC10 AS 'Departure,10' DPTN10 AS 'Departure 10,Airport,Name' ARRC10 AS 'Arrival,10' ARRN10 AS 'Arrival,10,Airport,Name' MILES10 AS 'Miles,10'
DPT11 AS 'Depature Date,11' DPTC11 AS 'Departure,11' DPTN11 AS 'Departure 11,Airport,Name' ARRC11 AS 'Arrival,11' ARRN11 AS 'Arrival,11,Airport,Name' MILES11 AS 'Miles,11'
DPT12 AS 'Depature Date,12' DPTC12 AS 'Departure,12' DPTN12 AS 'Departure 12,Airport,Name' ARRC12 AS 'Arrival,12' ARRN12 AS 'Arrival,12,Airport,Name' MILES12 AS 'Miles,12'
FARET AS 'Total,Fare' 
TMIL AS 'Total,Miles'

-INCLUDE FOOTERDT
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *
-INCLUDE &&PASTYD
-GOTO JOY
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=6, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=HEADING, OBJECT=TEXT, SIZE=7, COLOR=BLACK, $
TYPE=HEADING, LINE=4, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=8, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=7, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=7, STYLE=BOLD, $
TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(&&TNTDTPOS), SIZE=(&&TNTDTSIZ), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLDTPOS), SIZE=(&&ROLDTSIZ), $
-JOY
ENDSTYLE
-*
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
 

