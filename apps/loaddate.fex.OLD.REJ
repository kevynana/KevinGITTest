-*  File LOADDATE.FEX

SET ASNAMES=ON

-SET &&CHKDATE = '        ';

DEFINE FILE ROLLUP
UPDATE_DATE/MDYY = '03/30/2008';
END
-RUN

-CHKLOOP

FILEDEF CHKDATE DISK D:\TNT\TTRACKER\LOADCHK\CHKDATE.TXT (LRECL 80
-RUN

FILEDEF NEWDATE DISK D:\TNT\TTRACKER\LOADCHK\NEWDATE.TXT (LRECL 80
-RUN

-READ CHKDATE &&CHKDATE
-IF &&CHKDATE EQ 'END' THEN GOTO XFER;
-TYPE CHKDATE &&CHKDATE

-REPEAT BNEW WHILE &IORETURN EQ 0;
-READ CHKDATE &&SLINE.80
-IF &IORETURN NE 0 THEN GOTO BNEW;
-WRITE NEWDATE &&SLINE
-BNEW

FILEDEF CHKDATE CLEAR
-RUN

FILEDEF NEWDATE CLEAR
-RUN

COPY D:\TNT\TTRACKER\LOADCHK\NEWDATE.TXT D:\TNT\TTRACKER\LOADCHK\CHKDATE.TXT
-RUN

-TYPE CHKDATE &&CHKDATE

-SET &&ROLLUP = SUBSTR(8, &&CHKDATE, 1, 8, 8, 'A8');

-TYPE ROLLUP &&ROLLUP

TABLE FILE ROLLUP
PRINT ROLLUP_CODE UPDATE_DATE AS 'END_DATE'
BY ROLLUP_CODE
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
ON TABLE HOLD
END
-RUN

MODIFY FILE ROLLUP
FIXFORM FROM HOLD
MATCH ROLLUP_CODE
ON MATCH UPDATE END_DATE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-GOTO CHKLOOP

-XFER
-TYPE PROGRAM COMPLETED SUCCESSFULLY.....
-*-EXIT




























