
CREATE FILE UDHEAD
-RUN

FILEDEF UDHEAD DISK D:\UDHEAD.TXT

SET ASNAMES=ON

-RUN
-QUIT

TABLE FILE UDHEAD
PRINT ST_CITY H_MARKET
BY ROLLUP_CODE
BY ST_CITY
WHERE ROLLUP_CODE EQ 'METX-R'
ON TABLE HOLD AS DELETEHLD
END
-RUN

MODIFY FILE METXHTL
FIXFORM FROM DELETEHLD
MATCH ROLLUP_CODE ST_CITY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON DELETEHLD
END


DEFINE FILE METXHTL1
STATE/A40=UPCASE(40, ST_CITY, STATE);
MKT/A40=UPCASE(40, H_MARKET, MKT);
END
TABLE FILE METXHTL1
PRINT MKT  AS 'H_MARKET'
BY ROLLUP_CODE
BY STATE AS 'ST_CITY'
ON TABLE HOLD
END



MODIFY FILE METXHTL
FIXFORM FROM HOLD
MATCH ROLLUP_CODE ST_CITY
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON HOLD
END
-RUN







