-INCLUDE SETECHO
-* File RUN_DRIL.FEX
-**********************************************************************
-*  DATE        NAME         DESCRIPTION OF CHANGE
-*  ----        ----         ---------------------
-*
-**********************************************************************
-* EX RESET TO BRING IN ROLLUP CODE, USERNAME AND OTHER PARAMS
-**********************************************************************
-*EX RESET
-*-RUN

-**********************************************************************
-* EX RPTRESET TO RESET PARAMS
-**********************************************************************
-SET &&ROLLUP = &ROLUP;
-SET &&UNAME = &UID;
EX RPTRESET
-RUN
EX RESET
-RUN
-**********************************************************************
-* CHECK FOR PRESENCE OF ORIGINAL SET FILE
-*********************************************************************
-*****  USE VALUE PASSED AS &SETFNM TO DETERMINE FILE NAME
-IF &&DEPLOY EQ 'W' GOTO SETWEB;
-*-SET &&LOCPATH = 'D:\TT\ '|| &&ROLLUP || '\ '||&&UNAME.EVAL||'\';
-SET &FILEXIST = &&LOCPATH || &SETFNM || '.FTM';
-*-SET &FILEXIST = &&WEB_PATH || &SETFNM || '.FTM';
-GOTO CHKFILE;

-SETWEB
-*-SET &&WEBPATH = 'D:\TTWEB\ ' || &&ROLLUP || '\ '||&&UNAME.EVAL||'\';
-SET &FILEXIST = &&WEBPATH || &SETFNM || '.FTM';
-*-SET &FILEXIST = &&WEB_PATH || &SETFNM || '.FTM';

-CHKFILE
STATE &FILEXIST
-RUN
-IF &RETCODE NE 0 GOTO NOFILE;
-GOTO CONT;

-*
-*
-**********************************************************************
-*
-**********************************************************************
-CONT
-SET &&DTTMSTRM = &SETFNM;
-SET &&DRILLED_RUN = 'Y';
-SET &&NOW_CYC = 'NOW'; 
-SET &&OUTTO = 'X';
-*
-*
-***********************************************************
-* MAKE DRILLABLE FIELDS GLOBAL VARIABLES
-***********************************************************
-SET &&COLNBR = &COLNBR;
-IF &&COLNBR EQ 0 GOTO SETFLD 
- ELSE IF &&COLNBR EQ 1 GOTO SETFLD1
- ELSE IF &&COLNBR EQ 2 GOTO SETFLD2
- ELSE IF &&COLNBR EQ 3 GOTO SETFLD3;

-SETFLD
-SET &&SFLD1 = '';
-SET &&BYFLD1 = '';
-SET &&SFLD2 = '';
-SET &&BYFLD2 = '';
-SET &&SFLD3 = '';
-SET &&BYFLD3 = '';
-GOTO ENDSET;

-SETFLD1
-SET &&SFLD1 = &SFLD1;
-SET &&BYFLD1 = &BYFLD1;
-GOTO ENDSET;

-SETFLD2
-SET &&SFLD1 = &SFLD1;
-SET &&BYFLD1 = &BYFLD1;
-SET &&SFLD2 = &SFLD2;
-SET &&BYFLD2 = &BYFLD2;
-GOTO ENDSET;

-SETFLD3
-SET &&SFLD1 = &SFLD1;
-SET &&BYFLD1 = &BYFLD1;
-SET &&SFLD2 = &SFLD2;
-SET &&BYFLD2 = &BYFLD2;
-SET &&SFLD3 = &SFLD3;
-SET &&BYFLD3 = &BYFLD3;

-ENDSET
-*
-*
-**********************************************************************
-* PARSE SET FILE NAME TO DETERMINE THE STREAM TO EXECUTE
-**********************************************************************
-*LOOK FOR AIR_PLCY, CAR_PLCY, HTL_PLCY, AIR_HTL, TX_PLCY, TXT_PLCY
-*
-*
-SET &STRM1=GETTOK (&SETFNM, &SETFNM.LENGTH, 3, '_', 8, 'A8');
-SET &STRM2=GETTOK (&SETFNM, &SETFNM.LENGTH, 4, '_', 8, 'A8');
-SET &&STRMFEX = &STRM1 || '_' || &STRM2;
-SET &&RPTTYP = &STRM1;
-*-SET &&INSTID = SUBSTR(52, &SETFNM, 28, 49, 'A22');
-*COPY &FILEXIST &&WEB_PATH || 'TEMPDRIL.FEX' 
-SET &TMPDRIL = &&WEB_PATH || 'TEMPDRIL.FEX' ;
COPY &FILEXIST &TMPDRIL
-SET &&SETF='TEMPDRIL';
-RUN
-*
-*
-**********************************************************************
-* EXECUTE THE STREAM ROUTINE
-**********************************************************************
-STREAMNEXT
-SET &&NOW_CYC = 'NOW';
-TYPE Executing &&STRMFEX

EX &&STRMFEX
-RUN

-**********************************************************************
-*
-**********************************************************************

-EXIT


-NOFILE
-HTMLFORM BEGIN
<HTML>
<HEAD>

</HEAD>
<BODY>


<TITLE> TRAVEL & TRANSPORT</TITLE>
<CENTER><H2>THE REPORT IS NO LONGER DRILLABLE!!!</H2></CENTER>

<CENTER><H4>PLEASE GO BACK TO THE PREVIOUS PAGE USING </H4></CENTER>
<CENTER><H3>BACK BUTTON OF THE BROWSER</H3></CENTER> 

</BODY>
</HTML>
-HTMLFORM END

-EXIT








