-* BustReports_listing.fex
-INCLUDE SETECHO
-DEFAULT &EADDRS='FOC_NONE';
-DEFAULT &ROLL='$*';
-DEFAULT &SCHED_OWNER='$*';
-DEFAULT &FREQ='A';
 
-SET &EADDRS=IF &EADDRS EQ ' ' THEN 'FOC_NONE' ELSE &EADDRS;
 
-SET &WHERE1=IF &FREQ EQ 'W' THEN 'WHERE SCHED_WEEKLY EQ ' | '''' | '1' | '''' ELSE
-            IF &FREQ EQ 'M' THEN 'WHERE SCHED_M EQ ' | '''' | '1' | '''' ELSE
-            IF &FREQ EQ 'MYTD' THEN 'WHERE SCHED_MYTD EQ ' | '''' | '1' | '''' ELSE
-            IF &FREQ EQ 'Q' THEN 'WHERE SCHED_Q EQ ' | '''' | '1' | '''' ELSE
-            IF &FREQ EQ 'QYTD' THEN 'WHERE SCHED_QYTD EQ ' | '''' | '1' | '''' ELSE
-            IF &FREQ EQ 'A' THEN 'WHERE SCHED_A EQ ' | '''' | '1' | '''' ELSE '';
SET ASNAMES=ON
SET PAGE-NUM=OFF
SET EMPTYREPORT=ON
 
JOIN CLEAR *
JOIN INNER BREAK_KEY IN BURST_GROUPS TO MULTIPLE BREAK_KEY IN BURST_REPORT_KEYS AS J1
JOIN INNER BREAK_KEY IN BURST_GROUPS TO MULTIPLE BREAK_KEY IN BURST_REPORT_HIERS AS J2
END
 
TABLE FILE BURST_GROUPS
PRINT 
BREAK_LEVEL SCHED_WEEKLY SCHED_M SCHED_MYTD SCHED_Q SCHED_QYTD SCHED_A OWNER ROLLUP_CODE
BY BREAK_KEY 
BY BREAK_NAME 
BY INST_KEY
BY SET_KEY
 
&WHERE1
WHERE EMAIL_ADDRS CONTAINS '&EADDRS';
WHERE OWNER EQ '&SCHED_OWNER';
WHERE ROLLUP_CODE EQ '&ROLL';
 
ON TABLE HOLD AS HOLD
END
-RUN
 
JOIN CLEAR *
JOIN BREAK_KEY IN HOLD TO MULTIPLE BREAK_KEY IN BURST_REPORT_HIERS AS J2
END
TABLE FILE HOLD
PRINT 
BREAK_LEVEL SCHED_WEEKLY SCHED_M SCHED_MYTD SCHED_Q SCHED_QYTD SCHED_A ROLL_LEV EMAIL_ADDRS OWNER ROLLUP_CODE
BY BREAK_KEY 
BY BREAK_NAME 
BY INST_KEY
BY SET_KEY
ON TABLE HOLD AS HOLD1
END
-RUN
 
-IF &LINES EQ 0 THEN GOTO NODATA;
 
JOIN SET_KEY IN HOLD1 TO SET_KEY IN RPT_SET
DEFINE FILE HOLD1
  RPTNAME/A50 WITH BREAK_KEY = 'ALL REPORTS';
END
TABLE FILE HOLD1
PRINT SET_NAME RPTNAME AS 'RPT_NAME'
BREAK_LEVEL SCHED_WEEKLY SCHED_M SCHED_MYTD SCHED_Q SCHED_QYTD SCHED_A ROLL_LEV EMAIL_ADDRS OWNER ROLLUP_CODE
BY BREAK_KEY 
BY BREAK_NAME 
WHERE INST_KEY EQ 0
ON TABLE HOLD AS HOLD1A FORMAT FOCUS
END
-RUN
 
JOIN INST_KEY IN HOLD1 TO INST_KEY IN RPT_INST
TABLE FILE HOLD1
PRINT SET_KEY RPT_NAME
BREAK_LEVEL SCHED_WEEKLY SCHED_M SCHED_MYTD SCHED_Q SCHED_QYTD SCHED_A ROLL_LEV EMAIL_ADDRS OWNER ROLLUP_CODE
BY BREAK_KEY 
BY BREAK_NAME 
WHERE INST_KEY NE 0
ON TABLE HOLD AS HOLD2
END
-RUN
 
JOIN SET_KEY IN HOLD2 TO SET_KEY IN RPT_SET
TABLE FILE HOLD2
PRINT SET_NAME RPT_NAME
BREAK_LEVEL SCHED_WEEKLY SCHED_M SCHED_MYTD SCHED_Q SCHED_QYTD SCHED_A ROLL_LEV EMAIL_ADDRS OWNER ROLLUP_CODE
BY BREAK_KEY 
BY BREAK_NAME 
ON TABLE HOLD AS HOLD2A FORMAT FOCUS
END
-RUN
 
USE
HOLD1A AS HOLD1A
HOLD2A AS HOLD1A
END
 
TABLE FILE HOLD1A
HEADING CENTER
" "
"eTTek Review"
"&DATE @&TOD        All Burst Report Groups "
""
PRINT  
SCHED_WEEKLY AS 'Weekly' SCHED_M AS 'Monthly' SCHED_MYTD AS 'MYTD' SCHED_Q AS 'Quarterly'
SCHED_QYTD AS 'QYTD' SCHED_A AS 'Annually'
 
BREAK_LEVEL AS 'Org. Level' ROLL_LEV AS 'Org. Member' EMAIL_ADDRS AS 'Email Addresses'
 
BY ROLLUP_CODE AS 'ROLLUP'
BY OWNER AS 'SETUP,BY'
 
BY BREAK_KEY NOPRINT
BY BREAK_NAME AS 'Burst Report Groups'
BY SET_NAME
BY RPT_NAME
 
-*ON TABLE SET ONLINE-FMT EXL2K
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=9, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=DATA, SIZE=9, COLUMN=N2, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N3, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N4, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N5, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N6, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N7, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N8, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N9, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N10, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N11, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N12, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N13, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N14, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
TYPE=DATA, SIZE=9, COLUMN=N15, BACKCOLOR=( RGB(242 242 242) 'WHITE' ),$
 
 
TYPE=HEADING, OBJECT=TEXT, SIZE=12, COLOR=BLACK, STYLE = BOLD ,$
TYPE=HEADING, LINE=4, SIZE=12, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=12, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=12, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=12, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=12, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBFOOT, SIZE=10, STYLE=BOLD, BACKCOLOR=SILVER, GRID=ON, JUSTIFY=CENTER,  $
TYPE=SUBTOTAL, SIZE=9, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=9, STYLE=BOLD, $
-*TYPE=REPORT, IMAGE=&LOGO2, POSITION=(.5 .5 ), SIZE=(1.5 .4), $
 
$
TYPE=DATA,
     COLUMN=N4, JAVASCRIPT=loadMnt(N3),
$
 
END
-RUN
 
-IF &LINES EQ 0 GOTO NODATA;
 
-HTMLFORM BEGIN
<HTML>
<HEAD>
<SCRIPT>
function loadMnt(gkey) {
 gotoadd1="/ibi_apps/WFServlet?IBIS_connect=on" + "&" + "IBIS_passthru=on" + "&" + "IBIAPP_app=''";
 gotoadd2="&" + "GKEY=" + gkey + "&" + "rndm=" + Math.random();
 gotoadd3="&" + "IBIF_cmd=MNTCON EX ettekadmin/burstadmin";
 location.href=gotoadd1 + gotoadd2 + gotoadd3;
}
</SCRIPT>
</HEAD>
<BODY BGCOLOR="#F2F2F2">
!IBI.FIL.HLD01;
</BODY>
</HTML>
-HTMLFORM END
-GOTO XXIT;
 
-NODATA
-HTMLFORM BEGIN
<HTML>
<BODY BGCOLOR="#F2F2F2">
<br><br><br><br>
<b><center>
No Data Found for Your Selection.
</center><b>
</BODY>
</HTML>
-HTMLFORM END
-GOTO XXIT;
 
-NODATA
-HTMLFORM BEGIN
<HTML>
<BODY BGCOLOR="#F2F2F2">
<br><br><br><br>
<b><center>
No Data Found for Your Selection.
</center><b>
</BODY>
</HTML>
-HTMLFORM END
-XXIT
