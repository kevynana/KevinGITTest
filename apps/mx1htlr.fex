-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* -*04/29/10   DEB         CHANGED RATE_GRP1  FOR ROUNDING


DEFINE FILE CURHTLM1
NNROOMS/D10 = IF  (NUM_DAYS LT 0) AND
                  (NUM_ROOMS LT 0) THEN
                  (NUM_DAYS * NUM_ROOMS) * (-1) ELSE
                  (NUM_DAYS * NUM_ROOMS);

TH_AMT/D12.2 = TOTAL_AMT;


-*RATE_GRP1/A10 = IF ROOM_RATE GE 0 AND ROOM_RATE LT 150 OR
-*                   ROOM_RATE LE 0 AND ROOM_RATE GT (-150)
-*                   THEN '0-149' ELSE 
-*                IF  ROOM_RATE GE 150 AND ROOM_RATE LE 199 OR
-*                   ROOM_RATE LE (-150) AND ROOM_RATE GE (-199)
-*                   THEN '150-199' ELSE 
-*                IF  ROOM_RATE GE 200 AND ROOM_RATE LE 249 OR
-*                   ROOM_RATE LE (-200) AND ROOM_RATE GE (-249)
-*                   THEN '200-249' ELSE '250+';
RATE_GRP1/A10 = IF ((ROOM_RATE GE 0 AND ROOM_RATE LT 149.50) OR
                      (ROOM_RATE LE 0 AND ROOM_RATE GT (-149.50)))
                   THEN '0-149' ELSE
                   IF ((ROOM_RATE GE 149.50 AND ROOM_RATE LT 199.50) OR
                      (ROOM_RATE LE (-149.50) AND ROOM_RATE GT (-199.50)))
                   THEN '150-199' ELSE
                   IF ((ROOM_RATE GE 199.50 AND ROOM_RATE LT 249.50) OR
                      (ROOM_RATE LE (-199.50) AND ROOM_RATE GT (-249.50)))
                    THEN '200-249' ELSE '250+';

RATE_GRPT/A10 = IF RATE_GRP1 EQ '0-149' THEN '0-149' ELSE
                IF RATE_GRP1 EQ '150-199' THEN '150-199' ELSE
                IF RATE_GRP1 EQ '200-249' THEN '200-249' ELSE
                '250+';
END
-RUN

TABLE FILE CURHTLM1
SUM NNROOMS
    PCT.NNROOMS AS 'NRPCT'
BY RATE_GRP1
ON TABLE HOLD AS CURRATE1
END
-RUN

DEFINE FILE PRIORHTLM1
NNROOMS/D10 = IF  (NUM_DAYS LT 0) AND
                  (NUM_ROOMS LT 0) THEN
                  (NUM_DAYS * NUM_ROOMS) * (-1) ELSE
                  (NUM_DAYS * NUM_ROOMS);

TH_AMT/D12.2 = TOTAL_AMT;


-*RATE_GRP1/A10 = IF ROOM_RATE GE 0 AND ROOM_RATE LT 150 OR
-*                   ROOM_RATE LE 0 AND ROOM_RATE GT (-150)
-*                   THEN '0-149' ELSE 
-*                IF  ROOM_RATE GE 150 AND ROOM_RATE LE 199 OR
-*                   ROOM_RATE LE (-150) AND ROOM_RATE GE (-199)
-*                   THEN '150-199' ELSE 
-*                IF  ROOM_RATE GE 200 AND ROOM_RATE LE 249 OR
-*                   ROOM_RATE LE (-200) AND ROOM_RATE GE (-249)
-*                   THEN '200-249' ELSE '250+';
RATE_GRP1/A10 = IF ((ROOM_RATE GE 0 AND ROOM_RATE LT 149.50) OR
                      (ROOM_RATE LE 0 AND ROOM_RATE GT (-149.50)))
                   THEN '0-149' ELSE
                   IF ((ROOM_RATE GE 149.50 AND ROOM_RATE LT 199.50) OR
                      (ROOM_RATE LE (-149.50) AND ROOM_RATE GT (-199.50)))
                   THEN '150-199' ELSE
                   IF ((ROOM_RATE GE 199.50 AND ROOM_RATE LT 249.50) OR
                      (ROOM_RATE LE (-199.50) AND ROOM_RATE GT (-249.50)))
                    THEN '200-249' ELSE '250+';

 
RATE_GRPT/A10 = IF RATE_GRP1 EQ '0-149' THEN '0-149' ELSE
                IF RATE_GRP1 EQ '150-199' THEN '150-199' ELSE
                IF RATE_GRP1 EQ '200-249' THEN '200-249' ELSE
                '250+';
END
-RUN

TABLE FILE PRIORHTLM1
SUM NNROOMS 
    PCT.NNROOMS AS 'NRPCT'
BY RATE_GRP1
ON TABLE HOLD AS PRRATE1
END
-RUN


DEFINE FILE CURRATE1
CATEGORY/A30 = 'HIGH HOTELS';
CAT_ORDER/I2 = 6;
END
-RUN

TABLE FILE CURRATE1
PRINT CATEGORY/A30 AND RATE_GRP1/A30 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D15 AS 'VOL_CURR' AND 
NRPCT/D15 AS 'TKT_CURR' AND 
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
WHERE RATE_GRP1 NE ' '
ON TABLE HOLD AS CURRATE2
END
-RUN

TABLE FILE CURRATE2
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND VOL_CURR AND TKT_CURR
ON TABLE HOLD AS CURRATE3
END
MODIFY FILE OV1_MAIN
FIXFORM FROM CURRATE3
MATCH CATEGORY ROW_LABEL
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON CURRATE3
END
-RUN


DEFINE FILE PRRATE1
CATEGORY/A30 = 'HIGH HOTELS';
CAT_ORDER/I2 = 6;
END
-RUN

TABLE FILE PRRATE1
PRINT CATEGORY/A30 AND RATE_GRP1/A30 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NNROOMS/D15 AS 'VOL_PRIOR' AND 
NRPCT/D15 AS 'TKT_PRIOR' AND 
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;  
WHERE RATE_GRP1 NE ' '  
ON TABLE HOLD AS PRRATE2
END
-RUN

TABLE FILE PRRATE2
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND VOL_PRIOR AND TKT_PRIOR
ON TABLE HOLD AS PRRATE3 
END
MODIFY FILE OV1_MAIN
FIXFORM FROM PRRATE3
MATCH CATEGORY ROW_LABEL
ON MATCH UPDATE VOL_PRIOR TKT_PRIOR
ON NOMATCH INCLUDE
DATA ON PRRATE3
END
-RUN






