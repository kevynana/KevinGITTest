-* File FIXAX.FEX

-***************************************************************************
-* This program will will update the air, segment, market, destionation
-* from AX to AA for validating and flown airline codes.
-* DATE           NAME
-* 02/24/2003     Steve - creation
-***************************************************************************
-GOTO AIRREC

-SET &&CHKTARG = '        ';

-CHKLOOP

FILEDEF ALIST DISK K:\TNT\TTRACKER\TEMP\ALIST.TXT (LRECL 80
-RUN

FILEDEF BLIST DISK K:\TNT\TTRACKER\TEMP\BLIST.TXT (LRECL 80
-RUN

-READ ALIST &&CHKTARG
-IF &&CHKTARG EQ 'END' THEN GOTO XFER;
-TYPE CHKTARG &&CHKTARG
-TYPE IORETURN &IORETURN

-REPEAT BNEW WHILE &IORETURN EQ 0;
-READ ALIST &&SLINE.80
-TYPE IORETURN &IORETURN
-IF &IORETURN NE 0 THEN GOTO BNEW;
-WRITE BLIST &&SLINE
-BNEW

FILEDEF ALIST CLEAR
-RUN

FILEDEF BLIST CLEAR
-RUN

DOS COPY K:\TNT\TTRACKER\TEMP\BLIST.TXT K:\TNT\TTRACKER\TEMP\ALIST.TXT
-RUN

-SET &&COMP = SUBSTR(8, &&CHKTARG, 1, 8, 8, 'A8');

-* -TYPE CHKTARG &&CHKTARG
-TYPE COMPANY &&COMP

SET ASNAMES=ON

TABLE FILE &&COMP
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
AIRLINE
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AIRLINE EQ 'AX'
ON TABLE HOLD
END
-RUN

MODIFY FILE &&COMP
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AIRLINE='AA';
ON MATCH UPDATE AIRLINE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-GOTO CHKLOOP

-XFER
-EXIT

-* AIR RECORDS

-AIRREC

-SET &&CHKTARG = '        ';

-CHKLOOP

FILEDEF ALIST DISK K:\TNT\TTRACKER\TEMP\ALIST.TXT (LRECL 80
-RUN

FILEDEF BLIST DISK K:\TNT\TTRACKER\TEMP\BLIST.TXT (LRECL 80
-RUN

-READ ALIST &&CHKTARG
-IF &&CHKTARG EQ 'END' THEN GOTO XFER;
-TYPE CHKTARG &&CHKTARG
-TYPE IORETURN &IORETURN

-REPEAT BNEW WHILE &IORETURN EQ 0;
-READ ALIST &&SLINE.80
-TYPE IORETURN &IORETURN
-IF &IORETURN NE 0 THEN GOTO BNEW;
-WRITE BLIST &&SLINE
-BNEW

FILEDEF ALIST CLEAR
-RUN

FILEDEF BLIST CLEAR
-RUN

DOS COPY K:\TNT\TTRACKER\TEMP\BLIST.TXT K:\TNT\TTRACKER\TEMP\ALIST.TXT
-RUN

-SET &&COMP = SUBSTR(8, &&CHKTARG, 1, 8, 8, 'A8');

-* -TYPE CHKTARG &&CHKTARG
-TYPE COMPANY &&COMP

SET ASNAMES=ON

TABLE FILE &&COMP
PRINT AIR_KEY VAL_AIRLINE
BY AIR_KEY NOPRINT
IF VAL_AIRLINE EQ 'AX'
ON TABLE HOLD
END
-RUN

MODIFY FILE &&COMP
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE VAL_AIRLINE='AA';
ON MATCH UPDATE VAL_AIRLINE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-GOTO CHKLOOP

-XFER
-EXIT







