-* This extract gathers udid information 
-* Created 9/30/05  - JK
-*10/11/05 -DV - ADDED DOD_TYPE H TO ALL DEFINES INCL DOD_TYPE
-*05/08/06 -SAC - Added WWF_FSR for WWF-R US Aid Report
-* 8/23/06 - DEB - Added udid BPAY_AMT BUS_FAR PAY_AMT TIER
-*1/9/08 - DEB - ADDED EXCHG_SALE
-* 7/16/08 - JK - ADDED LEVEL1 AND LEVEL3
-*1/31/14 UPDATED ONLINE/TRADITIONAL DEFINES TO USE ONLINE_TRADITIONAL FIELD INSTEAD OF DOD_TYPE
-*Added Defines for new Cost Opportunities Report JK 4/01/14
-*5/23/14 - DEB - ADDED EX5 TO EX_RF_FLAG DEFINE
-*6/13/14 - DEB - ADDED DTKTS DEFINE FOR DOM TKTS
-* CHANGED FEXR to use TKT_PURCH instead of NET_TKT_CNT - Deb 6/16/14
-* ADDED EMBARK/ROUTE AIRPORT COUNTRY CODES - JK 7/31/14
-* CHANGED FIELD NAMES FOR EMB AND RTE COUNTRY CODE REPORT PRODUCING NO HTML ERROR
-* 8/6/14 - DEB
-* 8/7/14 - JOY ADDED LEVEL5
-* 4/29/15 - DEB - S-08628 - Added ADDCOLLECT EX_FLAG   NEW_ADV_PURCH1
-* 5/20/15 - DEB - S-08628 - Added ORG_SALE DOC_NUMBER EXG_ISS PEXG_ISS FARE_PAID2
-* 6/09/15 - DEB - S-09563 - Added code if no partial exchange records so report would not 
-*                           return norecords report
-*7/01/15 - JEK - STORY ID - S-09964 - updated programs/created new routine for add collects and airline fees for request and to balance to other reports
-*7/27/15 - DLV - S-10496 - CORRECTED NO HTLM ERROR FOR SDACHC
-*02/12/16 - DLV - S-13286  Updated to allow reports to sort/subtotal by id-levels
-*06/29/16 - RSB - S-20630 New Employee ID database field
-*                         Changed LEVEL1 to EMP_ID in the Define
-*                         Added LEVEL1 to the Table request
-*-*08/10/16 - DLV - S-22735 - Changed format of FARE_PAID2 to 12.2CS
-INCLUDE SETECHO
  
SET ASNAMES = ON
-SET HOLDATTR = ON; 
SET TEMPERASE = OFF
-RUN

-SET &&IDLEVELBREAK = '';
-RUN
-SET &AIRDATES = &&WEB_PATH || 'AIRDATES.fex';

-INCLUDE IDLEVROLLDEF
-RUN

DEFINE FILE &&EXTRACT
  BASE_FARE/D12.2CS = SEG_AMT - SEG_COM;
  ADDCOLLECT/D12.2CS = EXCH_NET_FARE + EXCH_NET_TAX;
  
-* CLASS_CAT/A8 = DECODE CL_CAT ('F' 'FIRST'     'C' 'COACH'   
-*                              'D' 'DISCOUNT'  'B' 'BUSINESS'
-*                                 ' ' 'OTHER');  


CLASS_CAT/A15 = DECODE CL_CAT ('F' 'FIRST'     'P' 'PREMIUM ECONOMY'   
			        'D' 'DEFAULT'   'B' 'BUSINESS'
			        'E' 'ECONOMY'   'U'  'UPGRADE' 
                                ' ' 'DEFAULT'); 

  FARE_PAID/D12.2CS   = SEG_AMT + SEG_TAX;   
  FARE_PAID2/D12.2CS = TICKET_AMT + TAX_AMT;

  LEVEL_DESC1/A60 = &&LDESC;
  ADV_CAT/A8          = IF (ADV_PURCH LT 7) THEN '0 - 6' ELSE
                        IF (ADV_PURCH LT 14) THEN '07 - 13' ELSE
                        IF (ADV_PURCH LT 21) THEN '14 - 20' ELSE '21 +';
  NET_TKT_CNT/P8CS    = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
  NEW_ADV_PURCH/D9     = ADV_PURCH;
  NEW_ADV_PURCH1/D9    = IF SEG_NBR EQ '01' THEN ADV_PURCH ELSE 0;

  NEW_SEG_AMT/D12.2CS  = SEG_AMT;
  NEW_SEG_DISC/D12.2CS = SEG_DISC;
  NEW_SEG_LOW/D12.2CS = SEG_LOWEST;
  NEW_SEG_MILES/D9= SEG_MILES;
  ORG_SALE/D12.2CS    = PARENT_FARE + PARENT_TAX;

  OTFLAG/A15 = IF ONLINE_TRADITIONAL EQ 'ONLINE' THEN 'ONLINE' ELSE 'TRADITIONAL';

  REF_EXCH_CNT/D8CS    = IF (TICKET_CODE EQ '1') AND
                            (SEG_NBR EQ '01') AND
                            (FARE_PAID GE 0) AND
                            (SEG_COUNT EQ 1) AND 
                            (CONJ_REL EQ 1) THEN 0 ELSE 
                         IF (TICKET_CODE EQ '1') AND
                            (SEG_NBR EQ '01') AND 
                            (EX_FLAG EQ 'F') THEN 1 ELSE 
                         IF (TICKET_CODE EQ '1') AND
                            (SEG_NBR EQ '01') AND
                            (RF_FLAG EQ 'F') THEN 1 ELSE 0;
  SAVINGS/D11.2CS      = SEG_STANDARD - FARE_PAID; 
  TKT_PURCH/D8CS       = IF (TICKET_CODE EQ '1') AND
                            (SEG_NBR EQ '01') AND
                            (FARE_PAID GE 0)  AND                    
                            (SEG_COUNT EQ 1)  AND
                            (CONJ_REL EQ 1) THEN 1 ELSE 0;
  TKT_TYPE/A4          = IF (SEG_COUNT LE 0) AND
                            (RF_FLAG EQ 'P') THEN 'P-RF' ELSE
                         IF (SEG_COUNT LE 0) AND 
                            (RF_FLAG EQ 'F') THEN 'F-RF' ELSE
                         IF (SEG_COUNT LE 0) AND 
                             (EX_FLAG EQ 'P') THEN 'P-EX' ELSE
                         IF (SEG_COUNT LE 0) AND 
                           (EX_FLAG EQ 'F') THEN 'F-EX' ELSE ' ';
  TKT_TYP2/A10          =   IF EXCHG_SALE NE ' ' AND VOID_DATE EQ 0 THEN 'EXCHG SALE' ELSE 
                            IF TKT_TYPE EQ ' ' AND VOID_DATE NE 0 THEN 'VOID' ELSE
                            IF TKT_TYPE EQ ' ' AND VOID_DATE EQ 0 THEN 'SALE' ELSE
                            IF TKT_TYPE EQ 'P-RF' OR 'F-RF' THEN 'REFUND' ELSE
                            'EXCHANGE';                           
-*  WWF_FSR/A1           = EDIT(LEVEL2,'$$$$$$$$$$$9$$$');
-*  WWF_FSR/A1           = EDIT(LEVEL2,'9');
-* WWF_FSR1/A4            =  EDIT(LEVEL1, '$$$$$$$$$$$9999');
 WWF_FSR1/A4            =  EDIT(EMP_ID, '$$$$$$$$$$$9999');
 WWF_FSR/A1             = EDIT(WWF_FSR1, '9');

  XAP/A8               = EDIT(ADV_PURCH);
  XARR_DT/MDYY         = ARR_DATE;
  XDPT_DT/MDYY         = DPT_DATE;
  XPSNGR_NM/A15        = EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
  XTRAN_DT/MDYY        = TRN_DATE;
  XFST_DTA/A8YYMD     = FST_DEST_DEPART_DATE;
  XFST_DT/MDYY        = XFST_DTA;  
  XFNL_DTA/A8YYMD     = FNL_DEST_ARRIVAL_DATE; 
  XFNL_DT/MDYY        = XFNL_DTA;
  VASAVINGS/D12.2CS    = NEW_SEG_DISC - FARE_PAID;

-* ****DEFINES ON PREVIOUS DEFINES****
  ADV_DAYS/A8        = IF ADV_PURCH LT 21 THEN XAP ELSE ADV_CAT;
  AIRLINE_FEE/D8.2CS = IF EMBARK EQ 'FP2' OR 'FP3' 
     THEN FARE_PAID ELSE 0;
  DISSAVINGS/D11.2CS = IF EMBARK EQ 'DT1' THEN 0 ELSE
                         FARE_PAID - SEG_LOWEST; 
  TKT_AMT/D12.2CS  = TICKET_AMT + TAX_AMT;
  
  EX_RF_FLAG/A1 = IF VOID_DATE NE 0  THEN ' ' ELSE
                  IF (((RF_FLAG EQ 'F' OR 'P') AND (EMBARK NE 'EX1' OR 'FP2' OR 'EX5') AND (SEG_COUNT LE 0)) OR (EMBARK EQ 'RF1')) THEN 'R' ELSE
                  IF (((EXSALE NE ' ') AND (SEG_COUNT GE 0)) OR ((EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND (RF_FLAG EQ ' '))) THEN 'E' ELSE ' ';
 
  SALES_FLAG/A1 = IF RF_FLAG EQ ' ' AND EX_FLAG EQ ' '  AND VOID_DATE EQ 0 THEN 'S' ELSE IF RF_FLAG EQ ' ' AND EX_FLAG EQ ' '  AND VOID_DATE NE 0 THEN 'V' ELSE ' ';
 
  SERV_FLAG/A1 = IF SALES_FLAG EQ 'S' THEN 'S' ELSE
                IF SALES_FLAG EQ 'V' THEN 'V' ELSE
                IF EX_RF_FLAG EQ 'E' THEN 'E' ELSE
                IF EX_RF_FLAG EQ 'R' THEN 'R' ELSE '';  
  
                          
  TRIP_KEY/A2   = EDIT(TRP_KEY, '$$$$$$$$99');
  TRIPRSN/A10 = IF TRIP_KEY NE ' ' THEN TRIP_KEY ELSE 'ZZZZZZZZZZ';
  TRIP_RSN/A10 = IF TRIPRSN EQ 'ZZZZZZZZZZ' THEN 'NONE GIVEN' ELSE TRIPRSN;   
  ONLTKTS/P8CS = IF (OTFLAG EQ 'ONLINE') AND (AIR_MAIN.INTL_DOM EQ 'D') THEN NET_TKT_CNT ELSE 0;
  DTKTS/P8CS = IF (AIR_MAIN.INTL_DOM EQ 'D') THEN NET_TKT_CNT ELSE 0;
  06_TKT/P8CS = IF ADV_CAT EQ '0 - 6' THEN NET_TKT_CNT ELSE 0;
  713_TKT/P8CS = IF ADV_CAT EQ '07 - 13' THEN NET_TKT_CNT ELSE 0;
  1420_TKT/P8CS = IF ADV_CAT EQ '14 - 20' THEN NET_TKT_CNT ELSE 0;
  21_TKT/P8CS = IF ADV_CAT EQ '21 +' THEN NET_TKT_CNT ELSE 0;
  FULL_EXCH/I11 = IF SERV_FLAG EQ 'E' THEN NET_TKT_CNT ELSE 0;
  FULLE_FARE/P15.2 = IF SERV_FLAG EQ 'E' THEN FARE_PAID ELSE 0;
-*  FEXR/P8CS = IF NET_TKT_CNT EQ 0 THEN 0 ELSE (FULL_EXCH*(-1))/NET_TKT_CNT;   
  FEXR/P8CS = IF TKT_PURCH EQ 0 THEN 0 ELSE (FULL_EXCH*(-1))/TKT_PURCH;   
  NFVSV/D12.2CS = VASAVINGS;    
  EXG_ISS/D12CS = IF (EX_FLAG EQ 'F') AND (SEG_COUNT EQ -1) AND (SEG_NBR EQ '01') THEN 1 ELSE 0;
  PEXG_ISS/D12CS = IF (EX_FLAG EQ 'P') AND (TKT_NUM NE LAST TKT_NUM) THEN 1 ELSE 0;
  
-INCLUDE TRANTYPE  
-INCLUDE IDLEVDEFINE  
               
END
 
TABLE FILE &&EXTRACT
PRINT  ADDCOLLECT
  ADV_CAT
  ADV_DAYS 
  AGENT_NUM
  AIR_KEY	
  AIR_MAIN.INTL_DOM AS 'INTL_DOM'	
  AIRLINE	
  AIRLINE_FEE	
  AIRLINE_NAME	
  AROLL_LEV3
  AROLL_DSC3
  AROLL_DSC4
  ARR_TIME
  BASE_FARE
  BR_CL_IDX
  CC_NUM
  C_ITIN
  CL_CAT	
  CLASS	
  CLASS_CAT	
  DISSAVINGS	
  DPT_TIME	
  CITYPAIR.EMBARK      AS 'EMB_APT_CD'	
  CITYPAIR.ROUTE       AS 'RTE_APT_CD'
  DOC_NUMBER
  DTKTS
  EMB_APT.AIRPORT_NAME AS 'EMB_APT_NM'
  EMB_CTY.CITY_NAME    AS 'EMB_CTY_NM'
  EMBARK
  EXCHG_SALE
  EX_FLAG
  EXG_ISS
  EX_RF_FLAG
  FARE_BAS
  FARE_PAID
  FARE_PAID2
  FLIGHT
  FST_DPT_DATE
  FULL_EXCH
  INVOICE_NUM	
  LEVEL_DESC
  EMP_ID
  LEVEL1
  LEVEL2
  LEVEL3
  LEVEL4
  LEVEL5
  NET_TKT_CNT
  NEW_ADV_PURCH	
  NEW_ADV_PURCH1
  NEW_SEG_AMT
  NEW_SEG_DISC	
  NEW_SEG_MILES
  ORG_SALE
  OTFLAG
  ONLTKTS
  PEXG_ISS
  PNR_LOCATOR
  REF_EXCH_CNT
  REFUSAL_DESC	
  REFUSE_CODE	
  REFUSE_KEY   
  ROLLUP_CODE
  RTE_APT.AIRPORT_NAME AS 'RTE_APT_NM'	
  RTE_CTY.CITY_NAME    AS 'RTE_CTY_NM'
  RTE_CTY.COUNTRY_CODE AS 'RTE_CNTRY_CODE'
  SAVINGS
  SEG_AMT
  SEG_COUNT	
  SEG_DESIG	
  SEG_LOWEST	
  SEG_NBR	
  SEG_STANDARD
  SEG_TAX
  TKT_DATE	
  TKT_NUM
  TKT_PURCH	
  TKT_SORT	
  TKT_TYPE
  TKT_TYP2
  TRN_DATE
  TRIP_PURPOSE
  TRP_REF.TRP_DESC 
  TKT_AMT
  XARR_DT
  XDPT_DT	
  XPSNGR_NM
  XTRAN_DT	
  STD_FARE
  LOWEST_AMT
  VOID_DATE
  TRIP_KEY
  TRIP_RSN
  XFST_DT
  XFNL_DT
  XTRAN_DT
  06_TKT
  713_TKT
  1420_TKT
  21_TKT
  VAL_AIRLINE
  CATEGORY
  AIR_MAIN.INTL_DOM AS 'DOM_INTL_CODE'
  FULL_EXCH
  FEXR
  NEW_SEG_LOW
  NFVSV
-*  EMBARPT.COUNTRY_CODE AS 'ECNTRY'
-*  RTEARPT.COUNTRY_CODE AS 'RCNTRY'
  EMB_CTY.COUNTRY_CODE AS 'ECNTRY'
  RTE_CTY.COUNTRY_CODE AS 'RCNTRY'
  
-INCLUDE &AIRDATES
-IF &&SETF EQ 'VSUDADTL' THEN GOTO InclVoid;
WHERE VOID_DATE EQ 0
-InclVoid
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10

-INCLUDE RPTPARMS
-IF '&&SETF.EVAL' EQ 'SDACHC' THEN GOTO NEXThld;
-* ON TABLE HOLD AS REPHOLD
-*ON TABLE HOLD AS &&RPT_HOLD
ON TABLE HOLD AS AIRHOLD1
END
-RUN
-GOTO SKIPIT
-NEXThld
ON TABLE HOLD AS &&RPT_HOLD
END
-RUN


-IF &&SETF NE 'SDACHC' GOTO SKIPIT;

TABLE FILE &&RPT_HOLD
SUM EMB_CTY_NM
BY LEVEL_DESC
BY AROLL_DSC3
BY AROLL_DSC4
BY XPSNGR_NM
BY TKT_NUM
WHERE SEG_NBR EQ '01'
ON TABLE HOLD AS AIRHOLD1
END
-RUN

TABLE FILE &&RPT_HOLD
PRINT FARE_PAID NET_TKT_CNT TKT_TYPE XFST_DT AIRLINE C_ITIN XTRAN_DT INVOICE_NUM DISSAVINGS REFUSAL_DESC AIRLINE_NAME
BY LEVEL_DESC
BY AROLL_DSC3
BY AROLL_DSC4
BY XPSNGR_NM
BY TKT_NUM
ON TABLE HOLD AS AIRHOLD
END
-RUN

MATCH FILE AIRHOLD
PRINT FARE_PAID NET_TKT_CNT TKT_TYPE XFST_DT AIRLINE C_ITIN XTRAN_DT INVOICE_NUM DISSAVINGS REFUSAL_DESC AIRLINE_NAME
BY LEVEL_DESC
BY AROLL_DSC3
BY AROLL_DSC4
BY XPSNGR_NM
BY TKT_NUM
ON TABLE HOLD
RUN
FILE AIRHOLD1
SUM EMB_CTY_NM
BY LEVEL_DESC
BY AROLL_DSC3
BY AROLL_DSC4
BY XPSNGR_NM
BY TKT_NUM
AFTER MATCH HOLD AS AIRHOLD2 OLD-AND-NEW
END
-RUN

-GOTO XXIT



-SKIPIT

DEFINE FILE AIRHOLD1
PEXG_ISS1/D12CS = IF TKT_NUM NE LAST TKT_NUM THEN PEXG_ISS ELSE 0;
END
-RUN
TABLE FILE AIRHOLD1
SUM PEXG_ISS PEXG_ISS1  
BY TKT_NUM
BY TKT_SORT
BY SEG_NBR
WHERE EX_RF_FLAG EQ 'E'
WHERE TKT_TYPE EQ 'P-EX'
ON TABLE HOLD AS EHLD
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO NOmatchrec;

MATCH FILE AIRHOLD1
PRINT 
  06_TKT
  1420_TKT
  21_TKT
  713_TKT
  ADDCOLLECT
  ADV_CAT
  ADV_DAYS 
  AGENT_NUM
  AIR_KEY
  AIRLINE
  AIRLINE_FEE
  AIRLINE_NAME
  AROLL_DSC3
  AROLL_DSC4
  AROLL_LEV3
  ARR_TIME
  BASE_FARE
  BR_CL_IDX
  C_ITIN
  CATEGORY
  CC_NUM
  CL_CAT
  CLASS
  CLASS_CAT
  DISSAVINGS
  DOC_NUMBER
  DOM_INTL_CODE 
  DPT_TIME
  DTKTS
  ECNTRY 
  EMB_APT_CD
  EMB_APT_NM
  EMB_CTY_NM
  EMBARK
  EX_FLAG
  EXCHG_SALE
  EXG_ISS
  FARE_BAS
  FARE_PAID
  FARE_PAID2
  FEXR
  FLIGHT
  FST_DPT_DATE
  FULL_EXCH
-*  FULL_EXCH
  INTL_DOM 
  INVOICE_NUM
  LEVEL_DESC
  EMP_ID
  LEVEL1
  LEVEL2
  LEVEL3
  LEVEL4
  LEVEL5
  LOWEST_AMT
  NET_TKT_CNT
  NEW_ADV_PURCH
  NEW_ADV_PURCH1
  NEW_SEG_AMT
  NEW_SEG_DISC
  NEW_SEG_LOW
  NEW_SEG_MILES
  NFVSV
  ONLTKTS
  ORG_SALE
  OTFLAG
  PEXG_ISS
  PNR_LOCATOR
  RCNTRY
  REF_EXCH_CNT
  REFUSAL_DESC
  REFUSE_CODE
  REFUSE_KEY   
  ROLLUP_CODE
  RTE_APT_CD 
  RTE_APT_NM 
  RTE_CNTRY_CODE 
  RTE_CTY_NM 
  SAVINGS
  SEG_AMT
  SEG_COUNT
  SEG_DESIG
  SEG_LOWEST
  SEG_STANDARD
  SEG_TAX
  STD_FARE
  TKT_AMT
  TKT_DATE
  TKT_PURCH
  TKT_TYP2
  TKT_TYPE
  TRIP_KEY
  TRIP_PURPOSE
  TRIP_RSN
  TRN_DATE
  TRP_DESC 
  VAL_AIRLINE
  VOID_DATE
  XARR_DT
  XDPT_DT
  XFNL_DT
  XFST_DT
  XPSNGR_NM
  XTRAN_DT
BY TKT_NUM
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD
RUN
FILE EHLD
PRINT PEXG_ISS1
BY TKT_NUM
BY TKT_SORT
BY SEG_NBR
AFTER MATCH HOLD AS &&RPT_HOLD OLD-OR-NEW
END
-RUN  

-GOTO XXIT;

-NOmatchrec

DEFINE FILE AIRHOLD1
PEXG_ISS1/D12CS =  0;
END
TABLE FILE AIRHOLD1
PRINT 
  06_TKT
  1420_TKT
  21_TKT
  713_TKT
  ADDCOLLECT
  ADV_CAT
  ADV_DAYS 
  AGENT_NUM
  AIR_KEY
  AIRLINE
  AIRLINE_FEE
  AIRLINE_NAME
  AROLL_DSC3
  AROLL_DSC4
  AROLL_LEV3
  ARR_TIME
  BASE_FARE
  BR_CL_IDX
  C_ITIN
  CATEGORY
  CC_NUM
  CL_CAT
  CLASS
  CLASS_CAT
  DISSAVINGS
  DOC_NUMBER
  DOM_INTL_CODE 
  DPT_TIME
  DTKTS
  ECNTRY 
  EMB_APT_CD
  EMB_APT_NM
  EMB_CTY_NM
  EMBARK
  EX_FLAG
  EXCHG_SALE
  EXG_ISS
  FARE_BAS
  FARE_PAID
  FARE_PAID2
  FEXR
  FLIGHT
  FST_DPT_DATE
  FULL_EXCH
  FULL_EXCH
  INTL_DOM 
  INVOICE_NUM
  LEVEL_DESC
  EMP_ID
  LEVEL1
  LEVEL2
  LEVEL3
  LEVEL4
  LEVEL5
  LOWEST_AMT
  NET_TKT_CNT
  NEW_ADV_PURCH
  NEW_ADV_PURCH1
  NEW_SEG_AMT
  NEW_SEG_DISC
  NEW_SEG_LOW
  NEW_SEG_MILES
  NFVSV
  ONLTKTS
  ORG_SALE
  OTFLAG
  PEXG_ISS
  PNR_LOCATOR
  RCNTRY
  REF_EXCH_CNT
  REFUSAL_DESC
  REFUSE_CODE
  REFUSE_KEY   
  ROLLUP_CODE
  RTE_APT_CD 
  RTE_APT_NM 
  RTE_CNTRY_CODE 
  RTE_CTY_NM 
  SAVINGS
  SEG_AMT
  SEG_COUNT
  SEG_DESIG
  SEG_LOWEST
  SEG_STANDARD
  SEG_TAX
  STD_FARE
  TKT_AMT
  TKT_DATE
  TKT_PURCH
  TKT_TYP2
  TKT_TYPE
  TRIP_KEY
  TRIP_PURPOSE
  TRIP_RSN
  TRN_DATE
  TRP_DESC 
  VAL_AIRLINE
  VOID_DATE
  XARR_DT
  XDPT_DT
  XFNL_DT
  XFST_DT
  XPSNGR_NM
  XTRAN_DT
  PEXG_ISS1
BY TKT_NUM
BY TKT_SORT
BY SEG_NBR 

ON TABLE HOLD AS &&RPT_HOLD
END
-RUN

-XXIT;

 

 
