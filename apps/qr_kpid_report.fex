 
-INCLUDE SETECHO
SET ASNAMES = ON 
 

TABLE FILE &&HXCAD001
SUM CURNET CURNETT PRNET PRNETT CPREF CPREFT PPREF PPREFT
COMPUTE CPRPCT/P5  = IF ((CURNET LT 1) AND (CURNET GT (-1))) THEN 0 ELSE (CPREF/CURNET) *100;
COMPUTE PPRPCT/P5  = IF ((PRNET LT 1) AND (PRNET GT (-1))) THEN 0 ELSE (PPREF/PRNET) *100;
COMPUTE CPRPCTT/P5  = IF ((CURNETT LT 1) AND (CURNETT GT (-1))) THEN 0 ELSE (CPREFT/CURNETT) *100;
COMPUTE PPRPCTT/P5  = IF ((PRNETT LT 1) AND (PRNETT GT (-1))) THEN 0 ELSE (PPREFT/PRNETT) *100;
COMPUTE VAR/P5 = CPRPCTT - PPRPCTT; 
DIRECTION/A1='H';
TREND/A15=IF VAR EQ 0 THEN 'equal_large.gif' ELSE
                  IF DIRECTION EQ 'L' AND VAR GT 0 THEN 'rau_large.gif' ELSE
	          IF DIRECTION EQ 'L' AND VAR LT 0 THEN 'gad_large.gif' ELSE
		  IF VAR GT 0 THEN 'gau_large.gif' ELSE 'rad_large.gif';
BY ROLLUP_CODE
ON TABLE HOLD AS QRPREFPCT
END
-RUN
 
TABLE FILE QRPREFPCT
PRINT CPRPCTT  PPRPCTT  TREND
ON TABLE SAVE AS PREF001 FORMAT ALPHA
END
-RUN

-READ PREF001 &CPCT.5. &PPCT.5. &TREND.15.
-CLOSE PREF001

 

-SET &CBC = IF &CPCT GE 88 THEN 'GREEN' ELSE 'RED';
-SET &PBC = IF &PPCT GE 88 THEN 'GREEN' ELSE 'RED';



-TYPE &CBC
-TYPE &PBC
-TYPE &TREND
 

 

DEFINE FILE QRPREFPCT
FLAG/A1 = ' ';
GPCT/P5% = 88;



END

 

TABLE FILE QRPREFPCT
HEADING CENTER
" "
"Preferred Airline KPI"
"<+0> Current <+0> Previous <+0> Trend <+0> Goal" 
SUM 
CPRPCTT AS ' ' 
FLAG AS ' '
PPRPCTT AS ' '  
TREND  NOPRINT
BY FLAG NOPRINT
ON TABLE PCHOLD FORMAT HTML
ON TABLE NOTOTAL
ON TABLE SET PAGE-NUM NOLEAD
ON TABLE SET SQUEEZE ON
ON TABLE SET HTMLCSS ON
ON TABLE SET HTMLENCODE OFF
ON TABLE PCHOLD FORMAT PDF
ON TABLE SET STYLE *
TYPE=REPORT, GRID=ON, BORDER=OFF, BACKCOLOR=NONE, $

TYPE=HEADING, LINE=1, COLOR=BLACK, BORDER=OFF, SIZE=10, FONT=ARIAL,$
TYPE=HEADING, LINE=2, COLOR=BLACK, BORDER=OFF, SIZE=10, STYLE=BOLD,FONT=ARIAL,$
TYPE=HEADING, LINE=3, COLOR=BLACK, BORDER=OFF, SIZE=7,FONT=ARIAL, $
TYPE=HEADING, LINE=4, COLOR=BLACK, BORDER=OFF, $

TYPE=TITLE, COLOR=BLACK, BORDER=OFF, JUSTIFY=CENTER,  SIZE=8, $
TYPE=DATA, COLUMN=N2,COLOR=BLACK, BORDER=OFF, JUSTIFY=CENTER, BACKCOLOR=&CBC.EVAL, SIZE=20,FONT=ARIAL, $
TYPE=DATA, COLUMN=N4,COLOR=BLACK, BORDER=OFF, JUSTIFY=CENTER, BACKCOLOR=&PBC.EVAL, SIZE=20,FONT=ARIAL, $
-*TYPE=DATA, COLUMN=N5, IMAGE=d:\tnt\ttracker\system\image\&TREND, POSITION=(.25 .25),preserveratio=on,$  
 
TYPE=REPORT,
 IMAGE=&TREND,
-*POSITION=(+1.600000 +0.6000000),
POSITION=(+1.600000 +0.7700000),

SIZE=(0.145 0.145),$
$
ENDSTYLE
END
-RUN
-QUIT
TYPE=DATA, COLUMN=N144,  BACKCOLOR=RGB(239 239 239), $

-SET &IBIAPPS = GETTOK(&FOCEXURL,&FOCEXURL.LENGTH,1,'/',64,'A64');
-SET &IBIAPPS = TRUNCATE(&IBIAPPS);
-HTMLFORM BEGIN
<script type="text/javascript" src="./jquery/js/jquery.min.js"></script>
<script>
$('body').css( { 'background-color':'!IBI.AMP.BACKCOLOR;' } );
$('body > table').width( '100%' );
$('.x6').width( '33%' );
</script>
-HTMLFORM END  


 