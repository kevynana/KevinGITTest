-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Created for Metlife Passenger Audit JK 2/27/03
-********************************************************************



SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

DEFINE FILE &&EXTRACT
  FARE_PAID/D12.2CS   = SEG_AMT + SEG_TAX;
  LEVEL_DESC/A60 = &&LDESC;
  NET_TKT_CNT/D8CS    = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;      
  XARR_DT/MDYY         = ARR_DATE;
  XDPT_DT/MDYY         = DPT_DATE;
  XDPT_DATE/MDY        = DPT_DATE;
  XPSNGR_NM/A15        = 
    EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
  XTRAN_DT/MDYY        = TRN_DATE;         
END

TABLE FILE &&EXTRACT
PRINT 
  AIRLINE	
  ARR_TIME
  DPT_TIME	
  EMB_CTY.CITY_NAME    AS 'EMB_CTY_NM'	
  FARE_PAID	
  FLIGHT	
  LEVEL_DESC	
  NET_TKT_CNT	
  RTE_CTY.CITY_NAME    AS 'RTE_CTY_NM'
  SEG_COUNT	
  SEG_NBR
  TKT_NUM	
  TKT_SORT
  TRN_DATE	
  XARR_DT	
  XDPT_DT	
  XPSNGR_NM
  XTRAN_DT
BY AIR_KEY
WHERE TRN_DATE GE &&FROMDT.EVAL AND TRN_DATE LE &&TODT.EVAL
WHERE VOID_DATE EQ 0
-GOTO AROUND
-* 
WHERE PASSNGR_NAME CONTAINS 'ABELA/M' OR 'ALBERTALLI/R' OR 'ALVAREZ/R' OR
'ANATOLE/J' OR 'ANDREA/A' OR 'BAKER/L' OR 'BALZAC/W' OR 'BARDEN/D' OR 
'BARONI/M' OR 'BECK/S' OR 'BELLER/G' OR 'BENMOSCHE/B' OR 'BENNETT/M' OR
'BERKOVITS/D' OR 'BETHEA/R' OR 'BINION/W' OR 'BLESER/R' OR 'BOHMER/R' OR
'BORTEN/D' OR 'BRADHERING/B' OR 'BREN/J' OR 'BRENNAN/D' OR 'BRITTAIN/M' OR
'BROWN/D' OR 'BROWN/T' OR 'BUCCI/R' OR 'BURDEN/C' OR 'BURNETT/M' OR 
'BUSCH/S' OR 'CALLAHAN/P' OR 'CALLERY/B' OR 'CAMPBELL/N' OR 'CANTLON/A' OR
'CARRAGHER/B' OR 'CLARK/G' OR 'CLARK/S' OR 'CLIFTON/A' OR 'COBB/C' OR
'COLLINS/M' OR 'CONTIMICA/S' OR 'COSGROVE/M' OR 'COSGROVE/J' OR 'COUTU/J' OR
'COWAN/G' OR 'COWAN/J' OR 'COX/J' OR 'DALESSANDRO/M' OR 'DANIELS/A' OR
'DAVIDSON/Q' OR 'DAVIDSON/D' OR 'DEGEORGE/D' OR 'DIETRICH/E' OR
'DINSMORE/G' OR 'DORDICK/L' OR 'DREIS/D' OR 'DUNN/M' OR 'DWYER/P' OR 
'EASLEY/T' OR 'EATON/E' OR 'EDSTROM/T' OR 'EHRLICH/J' OR 'ERWIN/J' OR
'FARIA/T' OR 'FARRELL/G' OR 'FARRELL/M' OR 'FECTEAU/J' OR 'FIORANELLI/C' OR
'FLEISS/B' OR 'FORTUNE/R' OR 'FOSTER/K' OR 'FULLER/M' OR 'FUSCO/A' OR 
'GALLANT/T' OR 'GEMUS/J' OR 'GHORPADE/S' OR 'GIEGERICH/D' OR 
'GINOCCHIO/C' OR 'GLORIA/D' OR 'GOMBAS/Z' OR 'GRAINGER/R' OR 'GRANITO/D' OR
'GRIFFIN/B' OR 'GUIFFRE/C' OR 'HAIGH/M' OR 'HAMMERSMITH/M' OR 'HARP/T' OR
'HAYES/R' OR 'HENRIKSON/C' OR 'HENRIKSON/R' OR 'HIRSCHHORN/B' OR 
'JACOBSEN/J' OR 'JANDER/T' OR 'JENKS/P' OR 'JOHNSON/B' OR 'JOHNSON/J' OR
'JOHNSON/R' OR 'KALB/G' OR 'KANE/W' OR 'KATZ/T' OR 'KELLY/D' OR 
'KERKMAZ/D' OR 'KROENUNG/D' OR 'LAFFITTE/H' OR 'LATRENTA/N' OR 'LAWRENCE/K' OR
'LIVOLSI/D' OR 'LOUIE/S' OR 'LOVE/R' OR 'LUDINGTON/H' OR 'LYONS/D' OR 
'MACKEY/L' OR 'MACLEAN/D' OR 'MADSEN/I' OR 'MALIK/M' OR 'MALLETT/C' OR
'MALOUF/M' OR 'MANNING/K' OR 'MARTIN/M' OR 'MATTEFS/P' OR 'MCCONNELL/D' OR
'MCCORMACK/T' OR 'MCCORMACK/M' OR 'MCDERMOTT/M' OR 'MCDERMOTT/J' OR 
'MCDERMOTT/M' OR 'MCGEE/K' OR '
-*

-AROUND
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************

ON TABLE HOLD AS TKT_HOLD1
END
-RUN


TABLE FILE &&EXTRACT
SUM AIR_KEY
BY AIR_KEY
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10

WHERE TRN_DATE GE &&FROMDT.EVAL AND TRN_DATE LE &&TODT.EVAL
WHERE VOID_DATE EQ 0
ON TABLE HOLD AS TKT_HOLD2
END
-RUN

MATCH FILE TKT_HOLD1
PRINT AIRLINE	
  ARR_TIME
  DPT_TIME	
  EMB_CTY_NM
  FARE_PAID	
  FLIGHT	
  LEVEL_DESC	
  NET_TKT_CNT	
  RTE_CTY_NM
  SEG_COUNT	
  SEG_NBR	
  TKT_NUM
  TKT_SORT	
  TRN_DATE
  XARR_DT	
  XDPT_DT	
  XPSNGR_NM
  XTRAN_DT
BY AIR_KEY
ON TABLE HOLD
RUN
FILE TKT_HOLD2
SUM AIR_KEY
BY AIR_KEY
AFTER MATCH HOLD AS &&RPT_HOLD OLD-AND-NEW
END
-RUN







