-*******************************************************************
-* 01/20/2012 - GSE - Fixed double semicolon as this causes problems
-*                    in 7.7.03
-*  12/29/2016  REJ  S-28553 Move ER5 My Reports to production.

-*******************************************************************
 
-* TCBKGSUM report was showing Total as rollup code
-* Label Finishrpt was previously appearing in line 59 moved to line 137
-* DEb 10/8/12
-*  08/23/2016  REJ  S-17914 Changes for ER5.
-INCLUDE SETECHO
 
CREATE FILE TCBKG
-RUN
 
-INCLUDE TCGETROLL
-RUN
 
-SET &CNT = 1;
-REPEAT Loop2 &TOTROLLS TIMES
-SET &&ROLL = &ROLL.&CNT;
EX TCAIRDB
-RUN
- IF &FOCERRNUM EQ 36 THEN GOTO IncLoop2;
 
EX TCBKGEX
-RUN
-IncLoop2
-SET &CNT = &CNT + 1;
-Loop2
 
-INCLUDE SetParmtime
-RUN
 
-IF &&FROMAVRP NE 'Y' GOTO :AVSF0;
-INCLUDE AVRP_SUBFOOT
-:AVSF0
 
-******************************************************************
-* GET THE FINAL REPORT
-******************************************************************
-IF '&&SETF.EVAL' EQ 'TCINTRAB' THEN GOTO STEP2;
 
 
TABLE FILE TCBKG
SUM FARE_PAID
  NET_TKT_CNT
  ABOOK_CNT
  ABOOK_FARE
  IBOOK_CNT
  IBOOK_FARE
  IEBOOK_CNT
  IEBOOK_FARE
  SIBOOK_CNT
  SIBOOK_FARE
BY ROLLCD
ON TABLE HOLD AS HOLD1
END
-RUN
 
 
 
-GOTO Finishrpt;
 
-STEP2
 
 
 
TABLE FILE TCBKG
SUM FARE_PAID
    NET_TKT_CNT
    ABOOK_CNT
    ABOOK_FARE
    IBOOK_CNT
    IBOOK_FARE
    IEBOOK_CNT
    IEBOOK_FARE
    SIBOOK_CNT
    SIBOOK_FARE
BY ROLLCD
ON TABLE HOLD AS AIRHOLD1 FORMAT FOCUS
END
-RUN
 
DEFINE FILE TCBKG
FLAG/A8 = 'TOTAL';
END
TABLE FILE TCBKG
SUM FARE_PAID
    NET_TKT_CNT
    ABOOK_CNT
    ABOOK_FARE
    IBOOK_CNT
    IBOOK_FARE
    IEBOOK_CNT
    IEBOOK_FARE
    SIBOOK_CNT
    SIBOOK_FARE
    FLAG AS 'ROLLCD'
BY FLAG
ON TABLE HOLD AS HOLD2
END
-RUN
 
TABLE FILE HOLD2
PRINT FARE_PAID
    NET_TKT_CNT
    ABOOK_CNT
    ABOOK_FARE
    IBOOK_CNT
    IBOOK_FARE
    IEBOOK_CNT
    IEBOOK_FARE
    SIBOOK_CNT
    SIBOOK_FARE
BY ROLLCD
ON TABLE HOLD
END
-RUN
 
 
MODIFY FILE AIRHOLD1
FIXFORM FROM HOLD
DATA ON HOLD
END
-RUN
 
TABLE FILE AIRHOLD1
PRINT FARE_PAID
    NET_TKT_CNT
    ABOOK_CNT
    ABOOK_FARE
    IBOOK_CNT
    IBOOK_FARE
    IEBOOK_CNT
    IEBOOK_FARE
    SIBOOK_CNT
    SIBOOK_FARE
BY ROLLCD
ON TABLE HOLD AS HOLD1
END
-RUN
 
-Finishrpt
 
-SET &&RPTSUF = 'SMY';
-INCLUDE FDEFRPTS
-RUN
 
-TYPE BEFORE DEFINES
 
DEFINE FILE HOLD1
 
PER_ABOOK/D8.1 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0
                 ELSE ((ABOOK_CNT/NET_TKT_CNT)*100);
PER_IBOOK/D8.1 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0
                 ELSE ((IBOOK_CNT/NET_TKT_CNT)*100);
PER_IEBOOK/D8.1 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0
                 ELSE ((IEBOOK_CNT/NET_TKT_CNT)*100);
PER_SIBOOK/D8.1 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0
                 ELSE ((SIBOOK_CNT/NET_TKT_CNT)*100);
NOWTOD/A8 WITH ROLLCD = HHMMSS (NOWTOD);
-IF &&SETF NE 'TCINTRAB' THEN GOTO DefineDone;
KEY/A1 = IF ROLLCD EQ 'TOTAL' THEN 'C' ELSE 'B';
 
FLAG/A1 = 'A';
 
-DefineDone
END
 
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS';
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
 
 
TABLE FILE HOLD1
-INCLUDE &&PAHDR
   &&S_SUBJ1
   &&S_SUBJ2
   &&S_SUBJ3
   &&S_SUBJ4
   &&S_SUBJ5
   &&S_SUBJ6
   &&S_SUBJ7
   &&S_SUBJ8
   &&S_SUBJ9
   &&S_SUBJ10
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10
 
 
-INCLUDE FOOTERSM1
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *
-INCLUDE &&PASTYS
ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN
 
-IF &LINES GT 0 THEN GOTO XXIT;
EX TCEMPTY
-RUN
-XXIT
