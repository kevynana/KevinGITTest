-GOTO METX99

USE
F:\TNT\TTRACKER\SUDATA\I_SUMM.FOC
END
-RUN

DEFINE FILE I_SUMM
LEVELI/A1 = EDIT(LEVEL, '$9');
HSIF01/A65 = 'IF AROLL_LEV'||LEVELI||' EQ '|''''||''''||HSEL1||''''||'''';
END
-RUN

TABLE FILE I_SUMM
PRINT INST_KEY HSIF01
BY INST_KEY NOPRINT
ON TABLE HOLD
END
-RUN

MODIFY FILE I_SUMM
FIXFORM FROM HOLD
MATCH INST_KEY
ON MATCH UPDATE HSIF01
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-EXIT

-AWWA

USE
C:\TNT\TTRACKER\SUDATA\I_SUMM.FOC
END
-RUN

DEFINE FILE I_SUMM
LEVELI/A1 = '4';
HSIF01/A65 = 'IF AROLL_LEV'||LEVELI||' EQ '|''''||''''||HSEL1||''''||'''';
END
-RUN

TABLE FILE I_SUMM
PRINT INST_KEY HSIF01 LEVEL
BY INST_KEY NOPRINT
IF LEVEL EQ 'TA';
ON TABLE HOLD
END
-RUN

MODIFY FILE I_SUMM
FIXFORM FROM HOLD
MATCH INST_KEY
ON MATCH COMPUTE LEVEL='04';
ON MATCH UPDATE LEVEL
ON MATCH UPDATE HSIF01
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT

-TRAN

USE
F:\TNT\TTRACKER\SUDATA\I_SUMM.FOC
END
-RUN

SET ASNAMES=ON

DEFINE FILE I_SUMM
TEST/A7 = 'I AND E';
HSIFX/A65 = 'IF AROLL_LEV4 EQ '|''''||''''||TEST|''''||'''';
HSELX/A15 = 'I AND E';
HDESX/A60 = '(I AND E) I & E';
END
-RUN

TABLE FILE I_SUMM
PRINT INST_KEY HSELX AS 'HSEL1' HDESX AS 'HDES1' HSIFX AS 'HSIF01'
IF HSEL1 CONTAINS '&';
IF INST_KEY CONTAINS 'TRAN';
ON TABLE HOLD
END
-RUN

MODIFY FILE I_SUMM
FIXFORM FROM HOLD
MATCH INST_KEY
ON MATCH UPDATE HSIF01
ON MATCH UPDATE HSEL1
ON MATCH UPDATE HDES1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-TRAN2

-* AIR

SET ASNAMES=ON

DEFINE FILE ALTRAN
AROLL_LEVX/A15 = 'S AND M';
AROLL_DSCX/A60 = '(S AND M) S & M';
END
-RUN

TABLE FILE ALTRAN
PRINT AIR_KEY AROLL_LEVX AS 'AROLL_LEV3' AROLL_DSCX AS 'AROLL_DSC3'
BY AIR_KEY NOPRINT
IF AROLL_LEV3 CONTAINS '&';
IF AROLL_LEV3 CONTAINS 'S';
ON TABLE HOLD
END
-RUN

MODIFY FILE ALTRAN
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_DSC3
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* CAR

DEFINE FILE CLTRAN
AROLL_LEVX/A15 = 'S AND M';
AROLL_DSCX/A60 = '(S AND M) S & M';
END
-RUN

TABLE FILE CLTRAN
PRINT CAR_KEY AROLL_LEVX AS 'AROLL_LEV3' AROLL_DSCX AS 'AROLL_DSC3'
BY CAR_KEY NOPRINT
IF AROLL_LEV3 CONTAINS '&';
IF AROLL_LEV3 CONTAINS 'S';
ON TABLE HOLD
END
-RUN

MODIFY FILE CLTRAN
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_DSC3
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* HOTEL

DEFINE FILE HLTRAN
AROLL_LEVX/A15 = 'S AND M';
AROLL_DSCX/A60 = '(S AND M) S & M';
END
-RUN

TABLE FILE HLTRAN
PRINT HTL_KEY AROLL_LEVX AS 'AROLL_LEV3' AROLL_DSCX AS 'AROLL_DSC3'
BY HTL_KEY NOPRINT
IF AROLL_LEV3 CONTAINS '&';
IF AROLL_LEV3 CONTAINS 'S';
ON TABLE HOLD
END
-RUN

MODIFY FILE HLTRAN
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_DSC3
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT

-* AIR

SET ASNAMES=ON

DEFINE FILE ALTRAN
AROLL_LEVX/A15 = 'I AND EOLD';
AROLL_DSCX/A60 = '(I AND EOLD) I & EOLD';
END
-RUN

TABLE FILE ALTRAN
PRINT AIR_KEY AROLL_LEVX AS 'AROLL_LEV5' AROLL_DSCX AS 'AROLL_DSC5'
BY AIR_KEY NOPRINT
IF AROLL_LEV5 CONTAINS '&';
ON TABLE HOLD
END
-RUN

MODIFY FILE ALTRAN
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_DSC5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* CAR

DEFINE FILE CLTRAN
AROLL_LEVX/A15 = 'I AND EOLD';
AROLL_DSCX/A60 = '(I AND EOLD) I & EOLD';
END
-RUN

TABLE FILE CLTRAN
PRINT CAR_KEY AROLL_LEVX AS 'AROLL_LEV5' AROLL_DSCX AS 'AROLL_DSC5'
BY CAR_KEY NOPRINT
IF AROLL_LEV5 CONTAINS '&';
ON TABLE HOLD
END
-RUN

MODIFY FILE CLTRAN
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_DSC5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* HOTEL

DEFINE FILE HLTRAN
AROLL_LEVX/A15 = 'I AND EOLD';
AROLL_DSCX/A60 = '(I AND EOLD) I & EOLD';
END
-RUN

TABLE FILE HLTRAN
PRINT HTL_KEY AROLL_LEVX AS 'AROLL_LEV5' AROLL_DSCX AS 'AROLL_DSC5'
BY HTL_KEY NOPRINT
IF AROLL_LEV5 CONTAINS '&';
ON TABLE HOLD
END
-RUN

MODIFY FILE HLTRAN
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_DSC5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT


-CONG2

TABLE FILE SR_50
COUNT LEVEL1
BY LEVEL1
BY BR_CL_IDX
WHERE (AIR_HIER.AROLL_LEV1 EQ ' ') OR (AIR_HIER.AROLL_DSC1 EQ ' ');
END
-RUN

-METX99

SET ASNAMES=ON

TABLE FILE RPT_INST
PRINT INST_KEY RPT_FOOT1 RPT_FOOT2
IF GLOBAL_PARM EQ 'MXNADOD9' OR 'MXNADOD8' OR 'MXNADOD7' OR 'MXNADOD6'
OR 'MXNADOD5' OR 'MXNADOD' OR 'MXLOBDOD' OR 'MXLOBDOA' OR 'MXLOBDD2'
OR 'MXLBDOD1' OR 'MXLBDOD7' OR 'MXLBDOD8';
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
RPTFOOT1/A60 = 'Excludes Amtrak';
RPTFOOT2/A60 = 'Online Exchange Tickets are not included in % calculations';
END
-RUN

TABLE FILE HOLD
PRINT INST_KEY RPTFOOT1 AS 'RPT_FOOT1' RPTFOOT2 AS 'RPT_FOOT2'
BY INST_KEY NOPRINT
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE RPT_INST
FIXFORM FROM HOLD2
MATCH INST_KEY
ON MATCH UPDATE RPT_FOOT1 RPT_FOOT2
ON NOMATCH REJECT
DATA ON HOLD2
END
-RUN
-EXIT
