-* 5/29/13 - DEB CHANGED DIFF PCT TO BE CALCUATED FROM DIVIIDING BY PRIOR
-*           INSTEAD OF CURRENT


-SET ASNAMES = ON

-INCLUDE SETECHO

-SET &&BBCM = &&WEB_PATH || 'BBCM.FOC';
-RUN
FILEDEF BBCM DISK &&BBCM
-RUN

CREATE FILE BBCM
-RUN

DEFINE FILE HOLDONE
LABEL1/A40='Total Air Expenditure';
LABEL2/A40='Average Ticket Price';
LABEL3/A40='Domestic Tickets Issued';
LABEL4/A40='Domestic Expenditure';
LABEL5/A40='International Tickets Issued';
LABEL6/A40='International Expenditure';
LABEL7/A40='# of Tickets';
LABEL8/A40='Less Than 7 Day Adv. Pur.';
LABEL9/A40='LT7DAP Dollars Lost';
LABEL10/A40='Online Transactions';
LABEL11/A40='Online Avg Price';
LABEL12/A40='Total Online Expenditure';
LABEL13/A40='Total Tickets Issued';
END 
TABLE FILE HOLDONE
SUM   CAVOL
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
BY TRNM
ON TABLE HOLD AS HOLDTWO
END
-RUN

-* JAN
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;
-*
-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;
BY TRNM
WHERE TRNM EQ 'JAN'
ON TABLE HOLD AS HLD1
END
-RUN

-SET &&JANNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';
-IF &LINES EQ 0 THEN GOTO FEB;

DEFINE FILE HLD1
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JANTOTAIR
END
-RUN

TABLE FILE JANTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANTOTAIR1
END
-RUN


TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO' AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12 AS 
'PRYR' AND ATPDIFF/D12 AS 'DIFF' ATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JANAVG
END
-RUN

TABLE FILE JANAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANAVG1
END
-RUN

TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JANDOMT
END
-RUN

TABLE FILE JANDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANDOMT1
END
-RUN


TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JANDVOL
END
-RUN


TABLE FILE JANDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANDVOL1
END
-RUN


TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JANITKT
END
-RUN

TABLE FILE JANITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANITKT1
END
-RUN

TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS JANIVOL
END
-RUN

TABLE FILE JANIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANIVOL1
END
-RUN

TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS JANTKT
END
-RUN


TABLE FILE JANTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANTKT1
END
-RUN

TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND CLT7NTKT/D12  AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS JANLT7
END
-RUN

TABLE FILE JANLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANLT71
END
-RUN


TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS JANLSTSV
END
-RUN

TABLE FILE JANLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANLSTSV1
END
-RUN

TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS JANONLT
END
-RUN

TABLE FILE JANONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANONLT1
END
-RUN


TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS JANONVOL
END
-RUN

TABLE FILE JANONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANONVOL1
END
-RUN




TABLE FILE HLD1
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' AND ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS JANONLAVG
END
-RUN

TABLE FILE JANONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JANONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JANONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO CURYR PRYR DIFF IDPERCENT TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JANONLAVG1
END
-RUN


-FEB
-*FEBRUARY

TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'FEB'
ON TABLE HOLD AS HLD2
END
-RUN

-SET &&FEBNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO MAR;

      
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;
BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB'
ON TABLE HOLD AS HLD2YTD
END
-RUN



DEFINE FILE HLD2
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS FEBTOTAIR
END
-RUN

TABLE FILE FEBTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBTOTAIR1
END
-RUN

DEFINE FILE HLD2YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS FEBYTDAIR
END
-RUN


TABLE FILE FEBYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS FEBYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBYTDAIR1
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS FEBAVG
END
-RUN

TABLE FILE FEBAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBAVG1
END
-RUN


TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS FEBYTDAVG
END
-RUN



TABLE FILE FEBYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS FEBYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBYTDAVG1
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS FEBDOMT
END
-RUN

TABLE FILE FEBDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBDOMT1
END
-RUN

TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS FEBTYDDOM 
END
-RUN

TABLE FILE FEBTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS FEBTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBTYDDOM1
END
-RUN



TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS FEBDVOL
END
-RUN


TABLE FILE FEBDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBDVOL1
END
-RUN

TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS FEBYTDDVOL
END
-RUN


TABLE FILE FEBYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS FEBYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBYTDDVOL1
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS FEBITKT
END
-RUN

TABLE FILE FEBITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBITKT1
END
-RUN

TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS FEBYTDITKT
END
-RUN

TABLE FILE FEBYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS FEBYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBYTDITKT1
END
-RUN


TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS FEBIVOL
END
-RUN

TABLE FILE FEBIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBIVOL1
END
-RUN


TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS FEBIVOLYTD
END
-RUN

TABLE FILE FEBIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS FEBIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBIVOLYTD1
END
-RUN


TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS FEBTKT
END
-RUN


TABLE FILE FEBTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBTKT1
END
-RUN


TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS FEBTKTYTD
END
-RUN


TABLE FILE FEBTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS FEBTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBTKTYTD1
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS FEBLT7
END
-RUN


TABLE FILE FEBLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBLT71
END
-RUN
 
TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS FEBLT7YTD
END
-RUN

TABLE FILE FEBLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS FEBLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBLT7YTD1
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS FEBLSTSV
END
-RUN

TABLE FILE FEBLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBLSTSV1
END
-RUN

TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS FEBLSTSVYTD
END
-RUN

TABLE FILE FEBLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS FEBLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBLSTSVYTD1
END
-RUN


TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS FEBONLT
END
-RUN

TABLE FILE FEBONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBONLT1
END
-RUN


TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS FEBONLTYTD
END
-RUN



TABLE FILE FEBONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS FEBONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBONLTYTD1
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS FEBONVOL
END
-RUN

TABLE FILE FEBONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBONVOL1
END
-RUN

TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS FEBONLYTD
END
-RUN

TABLE FILE FEBONLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS FEBONLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBONLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBONLYTD1
END
-RUN

TABLE FILE HLD2
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS FEBONLAVG
END
-RUN

TABLE FILE FEBONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS FEBONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON FEBONLAVG1
END


TABLE FILE HLD2YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' AND ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS FEBONLAVGYTD
END
-RUN

TABLE FILE FEBONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS FEBONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM FEBONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON FEBONLAVGYTD1
END



-MAR

TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'MAR'
ON TABLE HOLD AS HLD3
END
-RUN

-SET &&MARNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO APR;


      
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;
COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;
BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB' OR 'MAR'
ON TABLE HOLD AS HLD3YTD
END
-RUN

DEFINE FILE HLD3
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS MARTOTAIR
END
-RUN

TABLE FILE MARTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARTOTAIR1
END
-RUN

DEFINE FILE HLD3YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS MARYTDAIR
END
-RUN


TABLE FILE MARYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS MARYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARYTDAIR1
END
-RUN

TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS MARAVG
END
-RUN

TABLE FILE MARAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARAVG1
END
-RUN


TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS MARYTDAVG
END
-RUN



TABLE FILE MARYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS MARYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARYTDAVG1
END
-RUN

TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS MARDOMT
END
-RUN

TABLE FILE MARDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARDOMT1
END
-RUN

TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS MARTYDDOM 
END
-RUN

TABLE FILE MARTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MARTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARTYDDOM1
END
-RUN



TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS MARDVOL
END
-RUN


TABLE FILE MARDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARDVOL1
END
-RUN

TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS MARYTDDVOL
END
-RUN


TABLE FILE MARYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MARYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARYTDDVOL1
END
-RUN

TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS MARITKT
END
-RUN

TABLE FILE MARITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARITKT1
END
-RUN

TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS MARYTDITKT
END
-RUN

TABLE FILE MARYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MARYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARYTDITKT1
END
-RUN


TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS MARIVOL
END
-RUN

TABLE FILE MARIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARIVOL1
END
-RUN


TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS MARIVOLYTD
END
-RUN

TABLE FILE MARIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MARIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARIVOLYTD1
END
-RUN


TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS MARTKT
END
-RUN


TABLE FILE MARTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARTKT1
END
-RUN


TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS MARTKTYTD
END
-RUN


TABLE FILE MARTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MARTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARTKTYTD1
END
-RUN

TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS MARLT7
END
-RUN


TABLE FILE MARLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARLT71
END
-RUN
 
TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS MARLT7YTD
END
-RUN

TABLE FILE MARLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MARLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARLT7YTD1
END
-RUN

TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS MARLSTSV
END
-RUN

TABLE FILE MARLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARLSTSV1
END
-RUN

TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS MARLSTSVYTD
END
-RUN

TABLE FILE MARLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MARLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARLSTSVYTD1
END
-RUN


TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS MARONLT
END
-RUN

TABLE FILE MARONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARONLT1
END
-RUN


TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS MARONLTYTD
END
-RUN



TABLE FILE MARONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MARONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARONLTYTD1
END
-RUN


TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS MARONVOL
END
-RUN

TABLE FILE MARONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARONVOL1
END
-RUN

TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS MARONVOLYTD
END
-RUN

TABLE FILE MARONVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MARONVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARONVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARONVOLYTD1
END
-RUN

TABLE FILE HLD3
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS MARONLAVG
END
-RUN

TABLE FILE MARONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MARONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MARONLAVG1
END
-RUN


TABLE FILE HLD3YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS MARONLAVGYTD
END
-RUN

TABLE FILE MARONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MARONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MARONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MARONLAVGYTD1
END
-RUN


-APR

TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'APR'
ON TABLE HOLD AS HLD4
END
-RUN

-SET &&APRNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO MAY;

      
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;
BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB' OR 'MAR' OR 'APR'
ON TABLE HOLD AS HLD4YTD
END
-RUN



DEFINE FILE HLD4
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS APRTOTAIR
END
-RUN

TABLE FILE APRTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRTOTAIR1
END
-RUN

DEFINE FILE HLD4YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS APRYTDAIR
END
-RUN


TABLE FILE APRYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS APRYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRYTDAIR1
END
-RUN

TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS APRAVG
END
-RUN

TABLE FILE APRAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRAVG1
END
-RUN


TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS APRYTDAVG
END
-RUN



TABLE FILE APRYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS APRYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRYTDAVG1
END
-RUN

TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS APRDOMT
END
-RUN

TABLE FILE APRDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRDOMT1
END
-RUN

TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS APRTYDDOM 
END
-RUN

TABLE FILE APRTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS APRTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRTYDDOM1
END
-RUN



TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS APRDVOL
END
-RUN


TABLE FILE APRDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRDVOL1
END
-RUN

TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS APRYTDDVOL
END
-RUN


TABLE FILE APRYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS APRYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRYTDDVOL1
END
-RUN

TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS APRITKT
END
-RUN

TABLE FILE APRITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRITKT1
END
-RUN

TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS APRYTDITKT
END
-RUN

TABLE FILE APRYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS APRYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRYTDITKT1
END
-RUN


TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS APRIVOL
END
-RUN

TABLE FILE APRIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRIVOL1
END
-RUN


TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS APRIVOLYTD
END
-RUN

TABLE FILE APRIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS APRIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRIVOLYTD1
END
-RUN


TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS APRTKT
END
-RUN


TABLE FILE APRTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRTKT1
END
-RUN


TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS APRTKTYTD
END
-RUN


TABLE FILE APRTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS APRTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRTKTYTD1
END
-RUN

TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS APRLT7
END
-RUN


TABLE FILE APRLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRLT71
END
-RUN
 
TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS APRLT7YTD
END
-RUN

TABLE FILE APRLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS APRLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRLT7YTD1
END
-RUN

TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS APRLSTSV
END
-RUN

TABLE FILE APRLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRLSTSV1
END
-RUN

TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS APRLSTSVYTD
END
-RUN

TABLE FILE APRLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS APRLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRLSTSVYTD1
END
-RUN


TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS APRONLT
END
-RUN

TABLE FILE APRONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRONLT1
END
-RUN


TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS APRONLTYTD
END
-RUN


TABLE FILE APRONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS APRONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRONLTYTD1
END
-RUN


TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS APRONVOL
END
-RUN

TABLE FILE APRONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRONVOL1
END
-RUN

TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS APRONVOLYTD
END
-RUN

TABLE FILE APRONVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS APRONVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRONVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRONVOLYTD1
END
-RUN

TABLE FILE HLD4
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS APRONLAVG
END
-RUN

TABLE FILE APRONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS APRONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON APRONLAVG1
END
-RUN


TABLE FILE HLD4YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS APRONLAVGYTD
END
-RUN

TABLE FILE APRONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS APRONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM APRONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON APRONLAVGYTD1
END
-RUN


-MAY

TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'MAY'
ON TABLE HOLD AS HLD5
END
-RUN 

-SET &&MAYNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO JUN;  

TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;
BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB' OR 'MAR' OR 'APR' OR 'MAY'
ON TABLE HOLD AS HLD5YTD
END
-RUN






DEFINE FILE HLD5
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS MAYTOTAIR
END
-RUN

TABLE FILE MAYTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYTOTAIR1
END
-RUN

DEFINE FILE HLD5YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS MAYYTDAIR
END
-RUN


TABLE FILE MAYYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS MAYYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYYTDAIR1
END
-RUN

TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS MAYAVG
END
-RUN

TABLE FILE MAYAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYAVG1
END
-RUN


TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS MAYYTDAVG
END
-RUN



TABLE FILE MAYYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS MAYYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYYTDAVG1
END
-RUN

TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS MAYDOMT
END
-RUN

TABLE FILE MAYDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYDOMT1
END
-RUN

TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS MAYTYDDOM 
END
-RUN

TABLE FILE MAYTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MAYTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYTYDDOM1
END
-RUN



TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS MAYDVOL
END
-RUN


TABLE FILE MAYDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYDVOL1
END
-RUN

TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS MAYYTDDVOL
END
-RUN


TABLE FILE MAYYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MAYYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYYTDDVOL1
END
-RUN

TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS MAYITKT
END
-RUN

TABLE FILE MAYITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYITKT1
END
-RUN

TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS MAYYTDITKT
END
-RUN

TABLE FILE MAYYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MAYYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYYTDITKT1
END
-RUN


TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS MAYIVOL
END
-RUN

TABLE FILE MAYIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYIVOL1
END
-RUN


TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS MAYIVOLYTD
END
-RUN

TABLE FILE MAYIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MAYIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYIVOLYTD1
END
-RUN


TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS MAYTKT
END
-RUN


TABLE FILE MAYTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYTKT1
END
-RUN


TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS MAYTKTYTD
END
-RUN


TABLE FILE MAYTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MAYTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYTKTYTD1
END
-RUN

TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS MAYLT7
END
-RUN


TABLE FILE MAYLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYLT71
END
-RUN
 
TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS MAYLT7YTD
END
-RUN

TABLE FILE MAYLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MAYLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYLT7YTD1
END
-RUN

TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS MAYLSTSV
END
-RUN

TABLE FILE MAYLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYLSTSV1
END
-RUN

TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS MAYLSTSVYTD
END
-RUN

TABLE FILE MAYLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MAYLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYLSTSVYTD1
END
-RUN


TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS MAYONLT
END
-RUN

TABLE FILE MAYONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYONLT1
END
-RUN


TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS MAYONLTYTD
END
-RUN


TABLE FILE MAYONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MAYONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYONLTYTD1
END
-RUN


TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS MAYONVOL
END
-RUN

TABLE FILE MAYONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYONVOL1
END
-RUN

TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS MAYONVOLYTD
END
-RUN

TABLE FILE MAYONVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MAYONVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYONVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYONVOLYTD1
END
-RUN

TABLE FILE HLD5
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS MAYONLAVG
END
-RUN

TABLE FILE MAYONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS MAYONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON MAYONLAVG1
END
-RUN


TABLE FILE HLD5YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS MAYONLAVGYTD
END
-RUN

TABLE FILE MAYONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS MAYONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM MAYONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON MAYONLAVGYTD1
END
-RUN

-JUN


TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'JUN'
ON TABLE HOLD AS HLD6
END
-RUN

-SET &&JUNNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO JUL;

      
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;
BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB' OR 'MAR' OR 'APR' OR 'MAY' OR 'JUN'
ON TABLE HOLD AS HLD6YTD
END
-RUN



DEFINE FILE HLD6
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JUNTOTAIR
END
-RUN

TABLE FILE JUNTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNTOTAIR1
END
-RUN

DEFINE FILE HLD6YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JUNYTDAIR
END
-RUN


TABLE FILE JUNYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS JUNYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNYTDAIR1
END
-RUN

TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JUNAVG
END
-RUN

TABLE FILE JUNAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNAVG1
END
-RUN


TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JUNYTDAVG
END
-RUN



TABLE FILE JUNYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS JUNYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNYTDAVG1
END
-RUN

TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JUNDOMT
END
-RUN

TABLE FILE JUNDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNDOMT1
END
-RUN

TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JUNTYDDOM 
END
-RUN

TABLE FILE JUNTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JUNTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNTYDDOM1
END
-RUN



TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JUNDVOL
END
-RUN


TABLE FILE JUNDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNDVOL1
END
-RUN

TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JUNYTDDVOL
END
-RUN


TABLE FILE JUNYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JUNYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNYTDDVOL1
END
-RUN

TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JUNITKT
END
-RUN

TABLE FILE JUNITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNITKT1
END
-RUN

TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JUNYTDITKT
END
-RUN

TABLE FILE JUNYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JUNYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNYTDITKT1
END
-RUN


TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS JUNIVOL
END
-RUN

TABLE FILE JUNIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNIVOL1
END
-RUN


TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS JUNIVOLYTD
END
-RUN

TABLE FILE JUNIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JUNIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNIVOLYTD1
END
-RUN


TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS JUNTKT
END
-RUN


TABLE FILE JUNTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNTKT1
END
-RUN


TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS JUNTKTYTD
END
-RUN


TABLE FILE JUNTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JUNTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNTKTYTD1
END
-RUN

TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS JUNLT7
END
-RUN


TABLE FILE JUNLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNLT71
END
-RUN
 
TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS JUNLT7YTD
END
-RUN

TABLE FILE JUNLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JUNLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNLT7YTD1
END
-RUN

TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS JUNLSTSV
END
-RUN

TABLE FILE JUNLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNLSTSV1
END
-RUN

TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS JUNLSTSVYTD
END
-RUN

TABLE FILE JUNLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JUNLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNLSTSVYTD1
END
-RUN


TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS JUNONLT
END
-RUN

TABLE FILE JUNONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNONLT1
END
-RUN


TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS JUNONLTYTD
END
-RUN


TABLE FILE JUNONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JUNONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNONLTYTD1
END
-RUN


TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS JUNONVOL
END
-RUN

TABLE FILE JUNONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNONVOL1
END
-RUN

TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS JUNONVOLYTD
END
-RUN

TABLE FILE JUNONVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JUNONVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNONVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNONVOLYTD1
END
-RUN

TABLE FILE HLD6
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS JUNONLAVG
END
-RUN

TABLE FILE JUNONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JUNONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JUNONLAVG1
END
-RUN


TABLE FILE HLD6YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS JUNONLAVGYTD
END
-RUN

TABLE FILE JUNONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JUNONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JUNONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JUNONLAVGYTD1
END
-RUN


-JUL



TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'JUL'
ON TABLE HOLD AS HLD7
END
-RUN

-SET &&JULNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO AUG;
      
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;

BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB' OR 'MAR' OR 'APR' OR 'MAY' OR 'JUN' OR 'JUL'
ON TABLE HOLD AS HLD7YTD
END
-RUN




DEFINE FILE HLD7
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JULTOTAIR
END
-RUN

TABLE FILE JULTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULTOTAIR1
END
-RUN

DEFINE FILE HLD7YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS JULYTDAIR
END
-RUN


TABLE FILE JULYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS JULYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULYTDAIR1
END
-RUN

TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JULAVG
END
-RUN

TABLE FILE JULAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULAVG1
END
-RUN


TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS JULYTDAVG
END
-RUN



TABLE FILE JULYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS JULYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULYTDAVG1
END
-RUN

TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JULDOMT
END
-RUN

TABLE FILE JULDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULDOMT1
END
-RUN

TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS JULTYDDOM 
END
-RUN

TABLE FILE JULTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JULTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULTYDDOM1
END
-RUN



TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JULDVOL
END
-RUN


TABLE FILE JULDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULDVOL1
END
-RUN

TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS JULYTDDVOL
END
-RUN


TABLE FILE JULYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JULYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULYTDDVOL1
END
-RUN

TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JULITKT
END
-RUN

TABLE FILE JULITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULITKT1
END
-RUN

TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS JULYTDITKT
END
-RUN

TABLE FILE JULYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JULYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULYTDITKT1
END
-RUN


TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS JULIVOL
END
-RUN

TABLE FILE JULIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULIVOL1
END
-RUN


TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS JULIVOLYTD
END
-RUN

TABLE FILE JULIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JULIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULIVOLYTD1
END
-RUN


TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS JULTKT
END
-RUN


TABLE FILE JULTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULTKT1
END
-RUN


TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS JULTKTYTD
END
-RUN


TABLE FILE JULTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JULTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULTKTYTD1
END
-RUN

TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS JULLT7
END
-RUN


TABLE FILE JULLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULLT71
END
-RUN
 
TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS JULLT7YTD
END
-RUN

TABLE FILE JULLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JULLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULLT7YTD1
END
-RUN

TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS JULLSTSV
END
-RUN

TABLE FILE JULLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULLSTSV1
END
-RUN

TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS JULLSTSVYTD
END
-RUN

TABLE FILE JULLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JULLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULLSTSVYTD1
END
-RUN


TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS JULONLT
END
-RUN

TABLE FILE JULONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULONLT1
END
-RUN


TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS JULONLTYTD
END
-RUN


TABLE FILE JULONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JULONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULONLTYTD1
END
-RUN


TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS JULONVOL
END
-RUN

TABLE FILE JULONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULONVOL1
END
-RUN

TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS JULONVOLYTD
END
-RUN

TABLE FILE JULONVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JULONVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULONVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULONVOLYTD1
END
-RUN

TABLE FILE HLD7
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS JULONLAVG
END
-RUN

TABLE FILE JULONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS JULONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON JULONLAVG1
END
-RUN


TABLE FILE HLD7YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS JULONLAVGYTD
END
-RUN

TABLE FILE JULONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS JULONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM JULONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON JULONLAVGYTD1
END
-RUN


-AUG 

TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'AUG'
ON TABLE HOLD AS HLD8
END
-RUN

-SET &&AUGNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO SEP;

      
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;
BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB' OR 'MAR' OR 'APR' OR 'MAY' OR 'JUN' OR 'JUL' OR 'AUG'
ON TABLE HOLD AS HLD8YTD
END
-RUN



DEFINE FILE HLD8
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS AUGTOTAIR
END
-RUN

TABLE FILE AUGTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGTOTAIR1
END
-RUN

DEFINE FILE HLD8YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS AUGYTDAIR
END
-RUN


TABLE FILE AUGYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS AUGYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGYTDAIR1
END
-RUN

TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS AUGAVG
END
-RUN

TABLE FILE AUGAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGAVG1
END
-RUN


TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS AUGYTDAVG
END
-RUN



TABLE FILE AUGYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS AUGYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGYTDAVG1
END
-RUN

TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS AUGDOMT
END
-RUN

TABLE FILE AUGDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGDOMT1
END
-RUN

TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS AUGTYDDOM 
END
-RUN

TABLE FILE AUGTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS AUGTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGTYDDOM1
END
-RUN



TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS AUGDVOL
END
-RUN


TABLE FILE AUGDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGDVOL1
END
-RUN

TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS AUGYTDDVOL
END
-RUN


TABLE FILE AUGYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS AUGYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGYTDDVOL1
END
-RUN

TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS AUGITKT
END
-RUN

TABLE FILE AUGITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGITKT1
END
-RUN

TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS AUGYTDITKT
END
-RUN

TABLE FILE AUGYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS AUGYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGYTDITKT1
END
-RUN


TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS AUGIVOL
END
-RUN

TABLE FILE AUGIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGIVOL1
END
-RUN


TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS AUGIVOLYTD
END
-RUN

TABLE FILE AUGIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS AUGIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGIVOLYTD1
END
-RUN


TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS AUGTKT
END
-RUN


TABLE FILE AUGTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGTKT1
END
-RUN


TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS AUGTKTYTD
END
-RUN


TABLE FILE AUGTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS AUGTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGTKTYTD1
END
-RUN

TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS AUGLT7
END
-RUN


TABLE FILE AUGLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGLT71
END
-RUN
 
TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS AUGLT7YTD
END
-RUN

TABLE FILE AUGLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS AUGLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGLT7YTD1
END
-RUN

TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS AUGLSTSV
END
-RUN

TABLE FILE AUGLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGLSTSV1
END
-RUN

TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS AUGLSTSVYTD
END
-RUN

TABLE FILE AUGLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS AUGLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGLSTSVYTD1
END
-RUN


TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS AUGONLT
END
-RUN

TABLE FILE AUGONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGONLT1
END
-RUN


TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS AUGONLTYTD
END
-RUN


TABLE FILE AUGONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS AUGONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGONLTYTD1
END
-RUN


TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS AUGONVOL
END
-RUN

TABLE FILE AUGONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGONVOL1
END
-RUN

TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS AUGONVOLYTD
END
-RUN

TABLE FILE AUGONVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS AUGONVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGONVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGONVOLYTD1
END
-RUN

TABLE FILE HLD8
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS AUGONLAVG
END
-RUN

TABLE FILE AUGONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS AUGONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON AUGONLAVG1
END
-RUN


TABLE FILE HLD8YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS AUGONLAVGYTD
END
-RUN

TABLE FILE AUGONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS AUGONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM AUGONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON AUGONLAVGYTD1
END
-RUN

-SEP
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'SEP'
ON TABLE HOLD AS HLD9
END
-RUN

-SET &&SEPNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO OCT;

      
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;
BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB' OR 'MAR' OR 'APR' OR 'MAY' OR 'JUN' OR 'JUL' OR 'AUG' OR 'SEP'
ON TABLE HOLD AS HLD9YTD
END
-RUN


DEFINE FILE HLD9
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS SEPTOTAIR
END
-RUN

TABLE FILE SEPTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPTOTAIR1
END
-RUN

DEFINE FILE HLD9YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS SEPYTDAIR
END
-RUN


TABLE FILE SEPYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS SEPYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPYTDAIR1
END
-RUN

TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS SEPAVG
END
-RUN

TABLE FILE SEPAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPAVG1
END
-RUN


TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS SEPYTDAVG
END
-RUN



TABLE FILE SEPYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS SEPYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPYTDAVG1
END
-RUN

TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS SEPDOMT
END
-RUN

TABLE FILE SEPDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPDOMT1
END
-RUN

TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS SEPTYDDOM 
END
-RUN

TABLE FILE SEPTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS SEPTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPTYDDOM1
END
-RUN



TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS SEPDVOL
END
-RUN


TABLE FILE SEPDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPDVOL1
END
-RUN

TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS SEPYTDDVOL
END
-RUN


TABLE FILE SEPYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS SEPYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPYTDDVOL1
END
-RUN

TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS SEPITKT
END
-RUN

TABLE FILE SEPITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPITKT1
END
-RUN

TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS SEPYTDITKT
END
-RUN

TABLE FILE SEPYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS SEPYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPYTDITKT1
END
-RUN


TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS SEPIVOL
END
-RUN

TABLE FILE SEPIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPIVOL1
END
-RUN


TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS SEPIVOLYTD
END
-RUN

TABLE FILE SEPIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS SEPIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPIVOLYTD1
END
-RUN


TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS SEPTKT
END
-RUN


TABLE FILE SEPTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPTKT1
END
-RUN


TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS SEPTKTYTD
END
-RUN


TABLE FILE SEPTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS SEPTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPTKTYTD1
END
-RUN

TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS SEPLT7
END
-RUN


TABLE FILE SEPLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPLT71
END
-RUN
 
TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS SEPLT7YTD
END
-RUN

TABLE FILE SEPLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS SEPLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPLT7YTD1
END
-RUN

TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS SEPLSTSV
END
-RUN

TABLE FILE SEPLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPLSTSV1
END
-RUN

TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS SEPLSTSVYTD
END
-RUN

TABLE FILE SEPLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS SEPLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPLSTSVYTD1
END
-RUN


TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS SEPONLT
END
-RUN

TABLE FILE SEPONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPONLT1
END
-RUN


TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS SEPONLTYTD
END
-RUN


TABLE FILE SEPONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS SEPONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPONLTYTD1
END
-RUN


TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS SEPONVOL
END
-RUN

TABLE FILE SEPONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPONVOL1
END
-RUN

TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS SEPONVOLYTD
END
-RUN

TABLE FILE SEPONVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS SEPONVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPONVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPONVOLYTD1
END
-RUN

TABLE FILE HLD9
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS SEPONLAVG
END
-RUN

TABLE FILE SEPONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS SEPONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SEPONLAVG1
END
-RUN


TABLE FILE HLD9YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS SEPONLAVGYTD
END
-RUN

TABLE FILE SEPONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS SEPONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM SEPONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON SEPONLAVGYTD1
END
-RUN


 
-OCT

TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'OCT'
ON TABLE HOLD AS HLD10
END
-RUN

-SET &&OCTNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO NOV;
      
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;
BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB' OR 'MAR' OR 'APR' OR 'MAY' OR 'JUN' OR 'JUL' OR 'AUG' OR 'SEP' OR 'OCT'
ON TABLE HOLD AS HLD10YTD
END
-RUN

 
DEFINE FILE HLD10
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS OCTTOTAIR
END
-RUN

TABLE FILE OCTTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTTOTAIR1
END
-RUN

DEFINE FILE HLD10YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS OCTYTDAIR
END
-RUN


TABLE FILE OCTYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS OCTYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTYTDAIR1
END
-RUN

TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS OCTAVG
END
-RUN

TABLE FILE OCTAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTAVG1
END
-RUN


TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS OCTYTDAVG
END
-RUN



TABLE FILE OCTYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS OCTYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTYTDAVG1
END
-RUN

TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS OCTDOMT
END
-RUN

TABLE FILE OCTDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTDOMT1
END
-RUN

TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS OCTTYDDOM 
END
-RUN

TABLE FILE OCTTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS OCTTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTTYDDOM1
END
-RUN



TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS OCTDVOL
END
-RUN


TABLE FILE OCTDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTDVOL1
END
-RUN

TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS OCTYTDDVOL
END
-RUN


TABLE FILE OCTYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS OCTYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTYTDDVOL1
END
-RUN

TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS OCTITKT
END
-RUN

TABLE FILE OCTITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTITKT1
END
-RUN

TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS OCTYTDITKT
END
-RUN

TABLE FILE OCTYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS OCTYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTYTDITKT1
END
-RUN


TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS OCTIVOL
END
-RUN

TABLE FILE OCTIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTIVOL1
END
-RUN


TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS OCTIVOLYTD
END
-RUN

TABLE FILE OCTIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS OCTIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTIVOLYTD1
END
-RUN


TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS OCTTKT
END
-RUN


TABLE FILE OCTTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTTKT1
END
-RUN


TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS OCTTKTYTD
END
-RUN


TABLE FILE OCTTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS OCTTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTTKTYTD1
END
-RUN

TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS OCTLT7
END
-RUN


TABLE FILE OCTLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTLT71
END
-RUN
 
TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS OCTLT7YTD
END
-RUN

TABLE FILE OCTLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS OCTLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTLT7YTD1
END
-RUN

TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS OCTLSTSV
END
-RUN

TABLE FILE OCTLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTLSTSV1
END
-RUN

TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS OCTLSTSVYTD
END
-RUN

TABLE FILE OCTLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS OCTLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTLSTSVYTD1
END
-RUN


TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS OCTONLT
END
-RUN

TABLE FILE OCTONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTONLT1
END
-RUN


TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS OCTONLTYTD
END
-RUN


TABLE FILE OCTONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS OCTONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTONLTYTD1
END
-RUN


TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS OCTONVOL
END
-RUN

TABLE FILE OCTONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTONVOL1
END
-RUN

TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS OCTONVOLYTD
END
-RUN

TABLE FILE OCTONVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS OCTONVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTONVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTONVOLYTD1
END
-RUN

TABLE FILE HLD10
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS OCTONLAVG
END
-RUN

TABLE FILE OCTONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS OCTONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OCTONLAVG1
END
-RUN


TABLE FILE HLD10YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS OCTONLAVGYTD
END
-RUN

TABLE FILE OCTONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS OCTONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM OCTONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON OCTONLAVGYTD1
END
-RUN


-NOV

TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'NOV'
ON TABLE HOLD AS HLD11
END
-RUN
      
-SET &&NOVNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO DEC;
      
      
      
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;

BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB' OR 'MAR' OR 'APR' OR 'MAY' OR 'JUN' OR 'JUL' OR 'AUG' OR 'SEP' OR 'OCT' OR 'NOV'
ON TABLE HOLD AS HLD11YTD
END
-RUN



DEFINE FILE HLD11
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS NOVTOTAIR
END
-RUN

TABLE FILE NOVTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVTOTAIR1
END
-RUN

DEFINE FILE HLD11YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS NOVYTDAIR
END
-RUN


TABLE FILE NOVYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS NOVYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVYTDAIR1
END
-RUN

TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS NOVAVG
END
-RUN

TABLE FILE NOVAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVAVG1
END
-RUN


TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS NOVYTDAVG
END
-RUN



TABLE FILE NOVYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS NOVYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVYTDAVG1
END
-RUN

TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS NOVDOMT
END
-RUN

TABLE FILE NOVDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVDOMT1
END
-RUN

TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS NOVTYDDOM 
END
-RUN

TABLE FILE NOVTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS NOVTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVTYDDOM1
END
-RUN



TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS NOVDVOL
END
-RUN


TABLE FILE NOVDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVDVOL1
END
-RUN

TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS NOVYTDDVOL
END
-RUN


TABLE FILE NOVYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS NOVYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVYTDDVOL1
END
-RUN

TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS NOVITKT
END
-RUN

TABLE FILE NOVITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVITKT1
END
-RUN

TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS NOVYTDITKT
END
-RUN

TABLE FILE NOVYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS NOVYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVYTDITKT1
END
-RUN


TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS NOVIVOL
END
-RUN

TABLE FILE NOVIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVIVOL1
END
-RUN


TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS NOVIVOLYTD
END
-RUN

TABLE FILE NOVIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS NOVIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVIVOLYTD1
END
-RUN


TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS NOVTKT
END
-RUN


TABLE FILE NOVTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVTKT1
END
-RUN


TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS NOVTKTYTD
END
-RUN


TABLE FILE NOVTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS NOVTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVTKTYTD1
END
-RUN

TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS NOVLT7
END
-RUN


TABLE FILE NOVLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVLT71
END
-RUN
 
TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS NOVLT7YTD
END
-RUN

TABLE FILE NOVLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS NOVLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVLT7YTD1
END
-RUN

TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS NOVLSTSV
END
-RUN

TABLE FILE NOVLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVLSTSV1
END
-RUN

TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS NOVLSTSVYTD
END
-RUN

TABLE FILE NOVLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS NOVLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVLSTSVYTD1
END
-RUN


TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS NOVONLT
END
-RUN

TABLE FILE NOVONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVONLT1
END
-RUN


TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS NOVONLTYTD
END
-RUN


TABLE FILE NOVONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS NOVONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVONLTYTD1
END
-RUN


TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS NOVONVOL
END
-RUN

TABLE FILE NOVONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVONVOL1
END
-RUN

TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS NOVONVOLYTD
END
-RUN

TABLE FILE NOVONVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS NOVONVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVONVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVONVOLYTD1
END
-RUN

TABLE FILE HLD11
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS NOVONLAVG
END
-RUN

TABLE FILE NOVONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS NOVONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON NOVONLAVG1
END
-RUN


TABLE FILE HLD11YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS NOVONLAVGYTD
END
-RUN

TABLE FILE NOVONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS NOVONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM NOVONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON NOVONLAVGYTD1
END
-RUN

-DEC

TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;      
BY TRNM
WHERE TRNM EQ 'DEC'
ON TABLE HOLD AS HLD12
END
-RUN

-SET &&DECNOREC = IF &LINES EQ 0 THEN 'Y' ELSE 'N';

-IF &LINES EQ 0 THEN GOTO XXIT;
      
TABLE FILE HOLDTWO
SUM   CAVOL 
      CNTKT
      CDAVOL
      CIAVOL
      CDNTKT
      CINTKT
      CONL_TKT
      CONLAVOL
      CLT7NTKT
      CLT7LST_SAV
      PAVOL
      PNTKT
      PDAVOL
      PIAVOL
      PDNTKT
      PINTKT
      PONL_TKT
      PONLAVOL
      PLT7NTKT
      PLT7LST_SAV
      TRNY
      TRNM
      CMN_YR
      PMN_YR
      LABEL1
      LABEL2
      LABEL3
      LABEL4
      LABEL5
      LABEL6
      LABEL7
      LABEL8
      LABEL9
      LABEL10
      LABEL11
      LABEL12
      LABEL13      
COMPUTE CAVG_TKT/D12  = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0
                      ELSE (CAVOL/CNTKT);
COMPUTE CONL_AVG_TKT/D12  = IF ((CONL_TKT LT 1) AND (CONL_TKT GT (-1))) THEN 0
                      ELSE (CONLAVOL/CONL_TKT); 
COMPUTE PAVG_TKT/D12  = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0
                      ELSE (PAVOL/PNTKT);
COMPUTE PONL_AVG_TKT/D12  = IF ((PONL_TKT LT 1) AND (PONL_TKT GT (-1))) THEN 0
                      ELSE (PONLAVOL/PONL_TKT);
COMPUTE AIRDIFF/D12C= CAVOL - PAVOL;
COMPUTE ATPDIFF/D12C = CAVG_TKT - PAVG_TKT;
COMPUTE DTKTDIFF/D12 = CDNTKT - PDNTKT;
COMPUTE DOMDIFF/D12 = CDAVOL - PDAVOL;
COMPUTE ITKTDIFF/D12 = CINTKT - PINTKT;
COMPUTE INTDIFF/D12 = CIAVOL - PIAVOL;
COMPUTE TKTDIFF/D12 = CNTKT - PNTKT;
COMPUTE LT7DIFF/D12 = CLT7NTKT - PLT7NTKT;
COMPUTE LT7LSDIFF/D12 = CLT7LST_SAV - PLT7LST_SAV;
COMPUTE OTKTDIFF/D12 = CONL_TKT - PONL_TKT;
COMPUTE ONLATPDIFF/D12 = CONL_AVG_TKT - PONL_AVG_TKT;
COMPUTE ONLDIF = CONLAVOL - PONLAVOL;

-*COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/CAVOL) * 100;
-*COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/CAVG_TKT) * 100;
-*COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/CDNTKT) *100;
-*COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/CDAVOL) * 100; 
-*COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/CINTKT) * 100;
-*COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/CIAVOL) * 100;
-*COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/CNTKT) * 100;
-*COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/CLT7NTKT) * 100;
-*COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/CLT7LST_SAV) * 100;
-*COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/CONL_TKT) * 100;
-*COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/CONL_AVG_TKT) * 100;
-*COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/CONLAVOL) * 100;

COMPUTE AIRPCT/D12C = IF CAVOL EQ 0 THEN 0 ELSE (AIRDIFF/PAVOL) * 100;
COMPUTE ATPPCT/D12C = IF CAVG_TKT EQ 0 THEN 0 ELSE (ATPDIFF/PAVG_TKT) * 100;
COMPUTE DTKTPCT/D12C = IF CDNTKT EQ 0 THEN 0 ELSE (DTKTDIFF/PDNTKT) *100;
COMPUTE DOMPCT/D12C = IF CDAVOL EQ 0 THEN 0 ELSE (DOMDIFF/PDAVOL) * 100; 
COMPUTE ITKTPCT/D12C = IF CINTKT EQ 0 THEN 0 ELSE (ITKTDIFF/PINTKT) * 100;
COMPUTE INTPCT/D12C = IF CIAVOL EQ 0 THEN 0 ELSE (INTDIFF/PIAVOL) * 100;
COMPUTE TKTPCT/D12C = IF CNTKT EQ 0 THEN 0 ELSE (TKTDIFF/PNTKT) * 100;
COMPUTE LT7PCT/D12C = IF CLT7NTKT EQ 0 THEN 0 ELSE (LT7DIFF/PLT7NTKT) * 100;
COMPUTE LT7LSPCT/D12C = IF CLT7LST_SAV EQ 0 THEN 0 ELSE (LT7LSDIFF/PLT7LST_SAV) * 100;
COMPUTE OTKTPCT/D12C = IF CONL_TKT EQ 0 THEN 0 ELSE (OTKTDIFF/PONL_TKT) * 100;
COMPUTE ONLATPPCT/D12C = IF CONL_AVG_TKT EQ 0 THEN 0 ELSE (ONLATPDIFF/PONL_AVG_TKT) * 100;
COMPUTE ONLPCT/D12C = IF CONLAVOL EQ 0 THEN 0 ELSE (ONLDIF/PONLAVOL) * 100;
BY TRNY
WHERE TRNM EQ 'JAN' OR 'FEB' OR 'MAR' OR 'APR' OR 'MAY' OR 'JUN' OR 'JUL' OR 'AUG' OR 'SEP' OR 'OCT' OR 'NOV' OR 'DEC'
ON TABLE HOLD AS HLD12YTD
END
-RUN




DEFINE FILE HLD12
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURMO' AND PAVOL/D12M AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS DECTOTAIR
END
-RUN

TABLE FILE DECTOTAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECTOTAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECTOTAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECTOTAIR1
END
-RUN

DEFINE FILE HLD12YTD
CATEGORY/A8 = 'AIR';
CAT_ORDER/I2 = 1;
END
-RUN

TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL1/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVOL/D12M AS 'CURYR' AND PAVOL/D12M AS 'PRYR' AND
AIRDIFF/D12 AS 'DIFF' AND AIRPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 1;   
ON TABLE HOLD AS DECYTDAIR
END
-RUN


TABLE FILE DECYTDAIR
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS DECYTDAIR1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECYTDAIR1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECYTDAIR1
END
-RUN

TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURMO' AND PAVG_TKT/D12 AS 
'PRMO'  AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS DECAVG
END
-RUN

TABLE FILE DECAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO  TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECAVG1
END
-RUN


TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL2/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CAVG_TKT/D12 AS 'CURYR' AND PAVG_TKT/D12M AS 'PRYR' AND
ATPDIFF/D12 AS 'DIFF' AND ATPPCT AS 'IDPERCENT' AND TRNM AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 2;   
ON TABLE HOLD AS DECYTDAVG
END
-RUN



TABLE FILE DECYTDAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM  
ON TABLE HOLD AS DECYTDAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECYTDAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECYTDAVG1
END
-RUN

TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURMO' AND PDNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS DECDOMT
END
-RUN

TABLE FILE DECDOMT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECDOMT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECDOMT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECDOMT1
END
-RUN

TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL3/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDNTKT/D12  AS 'CURYR' AND PDNTKT/D12 AS 
'PRYR' AND DTKTDIFF/D12 AS 'DIFF' AND DTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 3;   
ON TABLE HOLD AS DECTYDDOM 
END
-RUN

TABLE FILE DECTYDDOM
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS DECTYDDOM1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECTYDDOM1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECTYDDOM1
END
-RUN



TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURMO' AND PDAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS DECDVOL
END
-RUN


TABLE FILE DECDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECDVOL1
END
-RUN

TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL4/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CDAVOL/D12  AS 'CURYR' AND PDAVOL/D12 AS 
'PRYR' AND DOMDIFF/D12 AS 'DIFF' AND DOMPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 4;   
ON TABLE HOLD AS DECYTDDVOL
END
-RUN


TABLE FILE DECYTDDVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS DECYTDDVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECYTDDVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECYTDDVOL1
END
-RUN

TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURMO' AND PINTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS DECITKT
END
-RUN

TABLE FILE DECITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECITKT1
END
-RUN

TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL5/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CINTKT/D12  AS 'CURYR' AND PINTKT/D12 AS 
'PRYR' AND ITKTDIFF/D12 AS 'DIFF' AND ITKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 5;   
ON TABLE HOLD AS DECYTDITKT
END
-RUN

TABLE FILE DECYTDITKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS DECYTDITKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECYTDITKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECYTDITKT1
END
-RUN


TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURMO' AND PIAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;   
ON TABLE HOLD AS DECIVOL
END
-RUN

TABLE FILE DECIVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECIVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECIVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECIVOL1
END
-RUN


TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL6/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CIAVOL/D12  AS 'CURYR' AND PIAVOL/D12 AS 
'PRYR' AND INTDIFF/D12 AS 'DIFF' AND INTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 6;  
ON TABLE HOLD AS DECIVOLYTD
END
-RUN

TABLE FILE DECIVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS DECIVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECIVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECIVOLYTD1
END
-RUN


TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURMO' AND PNTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS DECTKT
END
-RUN


TABLE FILE DECTKT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECTKT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECTKT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECTKT1
END
-RUN


TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL7/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CNTKT/D12  AS 'CURYR' AND PNTKT/D12 AS 
'PRYR' AND TKTDIFF/D12 AS 'DIFF' AND TKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 7;    
ON TABLE HOLD AS DECTKTYTD
END
-RUN


TABLE FILE DECTKTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS DECTKTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECTKTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECTKTYTD1
END
-RUN

TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12  AS 'CURMO' AND PLT7NTKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS DECLT7
END
-RUN


TABLE FILE DECLT7
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECLT71
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECLT71
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECLT71
END
-RUN
 
TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL8/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7NTKT/D12 AS 'CURYR' AND PLT7NTKT/D12 AS 
'PRYR' AND LT7DIFF/D12 AS 'DIFF' AND LT7PCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 8;   
ON TABLE HOLD AS DECLT7YTD
END
-RUN

TABLE FILE DECLT7YTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS DECLT7YTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECLT7YTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECLT7YTD1
END
-RUN

TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURMO' AND PLT7LST_SAV/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS DECLSTSV
END
-RUN

TABLE FILE DECLSTSV
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECLSTSV1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECLSTSV1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECLSTSV1
END
-RUN

TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL9/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CLT7LST_SAV/D12  AS 'CURYR' AND PLT7LST_SAV/D12 AS 
'PRYR' AND LT7LSDIFF/D12 AS 'DIFF' AND LT7LSPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 9;   
ON TABLE HOLD AS DECLSTSVYTD
END
-RUN

TABLE FILE DECLSTSVYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS DECLSTSVYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECLSTSVYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECLSTSVYTD1
END
-RUN


TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12 AS 'CURMO' AND PONL_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS DECONLT
END
-RUN

TABLE FILE DECONLT
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECONLT1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECONLT1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECONLT1
END
-RUN


TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL10/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_TKT/D12  AS 'CURYR' AND PONL_TKT/D12 AS 
'PRYR' AND OTKTDIFF/D12 AS 'DIFF' AND OTKTPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 10;   
ON TABLE HOLD AS DECONLTYTD
END
-RUN


TABLE FILE DECONLTYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS DECONLTYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECONLTYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECONLTYTD1
END
-RUN


TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURMO' AND PONL_AVG_TKT/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS DECONVOL
END
-RUN

TABLE FILE DECONVOL
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECONVOL1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECONVOL1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECONVOL1
END
-RUN

TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL11/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONL_AVG_TKT/D12  AS 'CURYR' AND PONL_AVG_TKT/D12 AS 
'PRYR' AND ONLATPDIFF/D12 AS 'DIFF' AND ONLATPPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 11;   
ON TABLE HOLD AS DECONVOLYTD
END
-RUN

TABLE FILE DECONVOLYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS DECONVOLYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECONVOLYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECONVOLYTD1
END
-RUN

TABLE FILE HLD12
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURMO' AND PONLAVOL/D12 AS 
'PRMO' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS DECONLAVG
END
-RUN

TABLE FILE DECONLAVG
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURMO AND PRMO AND TRANM
ON TABLE HOLD AS DECONLAVG1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECONLAVG1
MATCH CATEGORY ROW_LABEL ROW_ORDER CURMO PRMO TRANM
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON DECONLAVG1
END
-RUN


TABLE FILE HLD12YTD
PRINT CATEGORY/A8 AND LABEL12/A40 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND CONLAVOL/D12  AS 'CURYR' AND PONLAVOL/D12 AS 
'PRYR' ONLDIF/D12 AS 'DIFF' AND ONLPCT/D12 AS 'IDPERCENT' AND TRNM/MT AS 'TRANM' AND
COMPUTE ROW_ORDER/I2 = 12;   
ON TABLE HOLD AS DECONLAVGYTD
END
-RUN

TABLE FILE DECONLAVGYTD
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND CURYR AND PRYR AND DIFF AND IDPERCENT AND TRANM
ON TABLE HOLD AS DECONLAVGYTD1
END
MODIFY FILE BBCM
LOG DUPL MSG OFF
FIXFORM FROM DECONLAVGYTD1
MATCH CATEGORY ROW_LABEL ROW_ORDER TRANM
ON MATCH UPDATE CURYR PRYR DIFF IDPERCENT
ON NOMATCH REJECT
DATA ON DECONLAVGYTD1
END
-RUN

-GOTO XXIT
-DEB
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TXOY=EDIT(&&TXDATE,'$9999'); 

-SET &CURMY = 'JAN' || '&FMY.EVAL';
-SET &PRMY  = 'JAN' || '&TXOY.EVAL';
-SET &CURMY1 = '&CURMY.EVAL' |',' | 'CUMULATIVE'; 
-SET &PRMY1 = '&PRMY.EVAL' |',' | 'CUMULATIVE'; 




DEFINE FILE BBCM
KEY/A1 = IF BBCM.TRANM EQ 'JAN' THEN 'A' ELSE
         IF BBCM.TRANM EQ 'FEB' THEN 'B' ELSE
         IF BBCM.TRANM EQ 'MAR' THEN 'C' ELSE
         IF BBCM.TRANM EQ 'APR' THEN 'D' ELSE
         IF BBCM.TRANM EQ 'MAY' THEN 'E' ELSE 
         IF BBCM.TRANM EQ 'JUN' THEN 'F' ELSE   
         IF BBCM.TRANM EQ 'JUL' THEN 'G' ELSE
         IF BBCM.TRANM EQ 'AUG' THEN 'H' ELSE
         IF BBCM.TRANM EQ 'SEP' THEN 'I' ELSE
         IF BBCM.TRANM EQ 'OCT' THEN 'J' ELSE
         IF BBCM.TRANM EQ 'NOV' THEN 'K' ELSE
         IF BBCM.TRANM EQ 'DEC' THEN 'L' ELSE 'M';
         
END         
         
         

         
TABLE FILE BBCM
 
PRINT BBCM.TRANM AS 'TRAN MONTH'
      BBCM.ROW_LABEL AS 'AIR'
      BBCM.CURMO  AS  '&CURMY.EVAL'
      BBCM.PRMO AS '&PRMY.EVAL'
      BBCM.CURYR AS '&CURMY1.EVAL' 
      BBCM.PRYR AS  '&PRMY1.EVAL' 
      BBCM.DIFF AS 'DIFFERENCE'
      BBCM.IDPERCENT AS '% INC./,DECREASE'
BY KEY NOPRINT       
BY BBCM.CAT_ORDER NOPRINT
BY BBCM.CATEGORY NOPRINT 
BY BBCM.ROW_ORDER NOPRINT
ON BBCM.CATEGORY SKIP-LINE
WHERE BBCM.TRANM EQ 'JAN'

END 
-RUN

-QUIT

END
-RUN
-QUIT
-XXIT
 