-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-*04/18/17-S-29495-JEM-Creation for new report for Ultramar

-INCLUDE SETECHO


-* SET 3D=OFF
-* SET GRID=ON
-* SET VGRID=OFF
SET EMPTYREPORT=ON
-* -DEFAULT &&FROMER5='';


CREATE FILE TC_ULTRA
-RUN

-SET &&DRILLABLE = 'N';

-INCLUDE TCGETROLL
-RUN

-SET &CNT = 1;
-REPEAT Loop2 &TOTROLLS TIMES
-SET &&ROLL = &ROLL.&CNT;
-RUN

-TYPE TCAIRDB
-SET &&PAIRDB = 'S';
EX TCAIRDB
-RUN

- IF &FOCERRNUM EQ 36 THEN GOTO IncLoop2;

-TYPE TCULTRAEX
EX TCULTRAEX
-RUN


-IncLoop2
-SET &CNT = &CNT + 1;
-Loop2


-INCLUDE SetParmtime
-RUN


-SET &&RPTSUF = 'DTL';

-INCLUDE FDEFRPTS
-RUN

DEFINE FILE TC_ULTRA
TOUCHF/A1 = IF CNTRY CONTAINS 'US' THEN 'Y' ELSE 'N';
END
TABLE FILE TC_ULTRA
SUM NEW_SEG_COUNT BASE_FARE MILES ADV_P 
BY ROLLCD 
BY BR_CL_IDX
BY TKT_NUM 
BY AIRLINE 
BY ALLIANCE
BY ND_CTY_NM 
BY ND_APTS 
BY CLASS 
BY CLASS_CAT 
BY TKT_NUM
BY TOUR_CODE
BY FARE_BAS
BY CLASS1
BY CLS_DSC
BY SEG_DESIG
BY EXCHF
BY RFNDF
BY VOIDF
BY INTDOM
BY TOUCHF
BY CNTRY
BY XTRAN_DT
BY EMB_CNTRY_CODE
BY OGEO_ZONE
BY RGEO_ZONE
BY PNR_LOCATOR
ON TABLE HOLD AS TCH4
END
-RUN

TABLE FILE TCH4
SUM ROLLCD BR_CL_IDX TKT_NUM AIRLINE ALLIANCE 
    ND_CTY_NM ND_APTS CLASS CLASS_CAT TKT_NUM
    TOUR_CODE FARE_BAS CLASS1 CLS_DSC SEG_DESIG EXCHF RFNDF VOIDF 
    INTDOM TOUCHF CNTRY XTRAN_DT EMB_CNTRY_CODE OGEO_ZONE RGEO_ZONE
    PNR_LOCATOR NEW_SEG_COUNT BASE_FARE MILES ADV_P 
BY ROLLCD NOPRINT
BY BR_CL_IDX NOPRINT
BY TKT_NUM NOPRINT
BY AIRLINE NOPRINT
BY ALLIANCE NOPRINT
BY ND_CTY_NM NOPRINT 
BY ND_APTS NOPRINT
BY CLASS NOPRINT
BY CLASS_CAT NOPRINT 
ON TABLE HOLD AS TCH4A
END
-RUN


DEFINE FILE TCH4A
ZFLAG/A1 = IF (BASE_FARE EQ 0) AND (NEW_SEG_COUNT EQ 0) AND (MILES EQ 0) THEN 'Y' ELSE 'N';
END
TABLE FILE TCH4A
SUM ROLLCD BR_CL_IDX TKT_NUM AIRLINE ALLIANCE 
    ND_CTY_NM ND_APTS CLASS CLASS_CAT TKT_NUM
    TOUR_CODE FARE_BAS CLASS1 CLS_DSC SEG_DESIG EXCHF RFNDF VOIDF 
    INTDOM TOUCHF CNTRY XTRAN_DT EMB_CNTRY_CODE OGEO_ZONE RGEO_ZONE
    PNR_LOCATOR NEW_SEG_COUNT BASE_FARE MILES ADV_P ZFLAG
COMPUTE ASEGC/P12.2CM = IF NEW_SEG_COUNT EQ 0 THEN BASE_FARE ELSE  BASE_FARE/NEW_SEG_COUNT;
COMPUTE ASEGC1/P12.2CM = IF NEW_SEG_COUNT LT 0 AND BASE_FARE LT 0 THEN ASEGC * (-1) ELSE ASEGC;
COMPUTE CPM/P12.2CM = IF MILES EQ 0 THEN 0.00 ELSE BASE_FARE/MILES;
COMPUTE CPM1/P12.2CM = IF NEW_SEG_COUNT LT 0 AND BASE_FARE LT 0 THEN CPM * (-1) ELSE CPM;    
BY ROLLCD NOPRINT
BY BR_CL_IDX NOPRINT
BY TKT_NUM NOPRINT
BY AIRLINE NOPRINT
BY ALLIANCE NOPRINT
BY ND_CTY_NM NOPRINT 
BY ND_APTS NOPRINT
BY CLASS NOPRINT
BY CLASS_CAT NOPRINT 
BY XTRAN_DT NOPRINT
WHERE ZFLAG EQ 'N'
ON TABLE HOLD AS TCH5
END
-RUN





DEFINE FILE TCH5
NOWTOD/A8 WITH ROLLCD = HHMMSS (NOWTOD);
END
TABLE FILE TCH5
-INCLUDE HEADER
SUM ROLLCD AS 'RollupCode' BR_CL_IDX AS 'ClientCode' AIRLINE AS 'CarrierCode' ALLIANCE AS 'Alliance'
    ND_CTY_NM AS 'City Pair' ND_APTS AS 'City Codes' CLASS AS 'ClassofServiceCode' CLASS_CAT AS 'ClassofServiceDesc' 
    TKT_NUM AS 'TicketNum' TOUR_CODE AS 'TourCode' FARE_BAS AS 'FareBasis' CLASS1 AS 'ClassOfServiceCodePaid' 
    CLS_DSC AS 'ClassOfServiceDescPaid' SEG_DESIG AS 'TktDesignator' NEW_SEG_COUNT AS '# of Segments' 
    BASE_FARE AS 'Segment Total Base Fare' ASEGC1 AS 'Average Segment Cost' MILES AS 'Mileage' CPM1 AS 'Cost Per Mile'
    EXCHF AS 'ExchangeInd' RFNDF AS 'RefundInd' VOIDF AS 'VoidInd' INTDOM AS 'InternationalInd' ADV_P AS 'DaysAdvPurch'
    TOUCHF AS 'Touch US (Y or N)' CNTRY AS 'Country Routing' XTRAN_DT AS 'IssueDate' EMB_CNTRY_CODE AS 'Origin Country'
    OGEO_ZONE AS 'Origin Region' RGEO_ZONE AS 'Dest Region' PNR_LOCATOR AS 'PNRLocator'
BY ROLLCD NOPRINT
BY BR_CL_IDX NOPRINT
BY TKT_NUM NOPRINT
BY AIRLINE NOPRINT
BY ALLIANCE NOPRINT
BY ND_CTY_NM NOPRINT
BY ND_APTS NOPRINT
BY CLASS NOPRINT
BY CLASS_CAT NOPRINT
-*-INCLUDE FOOTERSM
ON TABLE RECOMPUTE AS 'Total'
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT 
ON TABLE SET STYLE *
 

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=ARIAL, SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $
-GOTO JOY;
-* TYPE=REPORT, WRAP=1,$
TYPE=REPORT, COLUMN=N2, WRAP=2.0,$
TYPE=REPORT, COLUMN=N3, WRAP=1.0,$
TYPE=REPORT, COLUMN=N4, WRAP=1.0,$
TYPE=REPORT, COLUMN=N5, WRAP=1.0,$
TYPE=REPORT, COLUMN=N6, WRAP=.75,$
TYPE=REPORT, COLUMN=N7, WRAP=.75,$
TYPE=REPORT, COLUMN=N8, WRAP=.75,$
TYPE=REPORT, COLUMN=N9, WRAP=.75,$
TYPE=REPORT, COLUMN=N10, WRAP=.75,$
TYPE=REPORT, COLUMN=N11, WRAP=1.0,$
TYPE=REPORT, COLUMN=N12, WRAP=.75,$
TYPE=REPORT, COLUMN=N13, WRAP=1.15,$
TYPE=REPORT, COLUMN=N14, WRAP=.75,$
TYPE=REPORT, COLUMN=N15, WRAP=.75,$
TYPE=REPORT, COLUMN=N16, WRAP=.75,$
TYPE=REPORT, COLUMN=N17, WRAP=.75,$
TYPE=REPORT, COLUMN=N18, WRAP=.75,$ 
TYPE=REPORT, COLUMN=N19, WRAP=.75,$
TYPE=REPORT, COLUMN=N20, WRAP=.75,$
TYPE=REPORT, COLUMN=N21, WRAP=.75,$
TYPE=REPORT, COLUMN=N22, WRAP=1.15,$
TYPE=REPORT, COLUMN=N23, WRAP=.75,$
TYPE=REPORT, COLUMN=N24, WRAP=.75,$
TYPE=REPORT, COLUMN=N25, WRAP=.75,$
TYPE=REPORT, COLUMN=N26, WRAP=1.15,$
TYPE=REPORT, COLUMN=N27, WRAP=.75,$
TYPE=REPORT, COLUMN=N28, WRAP=1.15,$
TYPE=REPORT, COLUMN=N29, WRAP=.75,$
TYPE=REPORT, COLUMN=N30, WRAP=.75,$
TYPE=REPORT, COLUMN=N31, WRAP=.75,$
TYPE=REPORT, COLUMN=N32, WRAP=.75,$
TYPE=REPORT, COLUMN=N33, WRAP=.90,$
TYPE=REPORT, COLUMN=N34, WRAP=.90,$
TYPE=REPORT, COLUMN=N35, WRAP=.75,$
TYPE=REPORT, COLUMN=N36, WRAP=.75,$
TYPE=REPORT, COLUMN=N37, WRAP=.75,$
TYPE=REPORT, COLUMN=N38, WRAP=.75,$
TYPE=REPORT, COLUMN=N39, WRAP=.75,$
TYPE=REPORT, COLUMN=N40, WRAP=1.15,$
TYPE=REPORT, COLUMN=N41, WRAP=.75,$
TYPE=REPORT, COLUMN=N42, WRAP=.75,$
TYPE=REPORT, COLUMN=N43, WRAP=.75,$
TYPE=REPORT, COLUMN=N44, WRAP=.75,$
TYPE=REPORT, COLUMN=N45, WRAP=.75,$
TYPE=REPORT, COLUMN=N46, WRAP=.75,$
TYPE=REPORT, COLUMN=N47, WRAP=.75,$
TYPE=REPORT, COLUMN=N48, WRAP=.75,$
TYPE=REPORT, COLUMN=N49, WRAP=.75,$
TYPE=REPORT, COLUMN=N50, WRAP=.75,$
TYPE=REPORT, COLUMN=N51, WRAP=.90,$
TYPE=REPORT, COLUMN=N52, WRAP=.90,$
TYPE=REPORT, COLUMN=N53, WRAP=.75,$
TYPE=REPORT, COLUMN=N54, WRAP=.90,$
TYPE=REPORT, COLUMN=N55, WRAP=.90,$
TYPE=REPORT, COLUMN=N56, WRAP=.90,$
TYPE=REPORT, COLUMN=N57, WRAP=.90,$
TYPE=REPORT, COLUMN=N58, WRAP=.90,$
TYPE=REPORT, COLUMN=N59, WRAP=.90,$
TYPE=REPORT, COLUMN=N60, WRAP=.90,$
TYPE=REPORT, COLUMN=N61, WRAP=.90,$



-* TYPE=HEADING, OBJECT=TEXT, SIZE=8, COLOR=BLACK, $

TYPE=TITLE, STYLE=BOLD, COLUMN=N1, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N2, BACKCOLOR=RGB(255 165 0), $  
TYPE=TITLE, STYLE=BOLD, COLUMN=N3, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N4, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N5, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N6, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N7, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N8, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N9, BACKCOLOR=RGB(255 165 0), $

TYPE=TITLE, STYLE=BOLD, COLUMN=N10, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N11, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N12, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N13, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N14, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N15, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N16, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N17, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N18, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N19, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N20, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N21, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N22, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N23, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N24, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N25, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N26, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N27, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N28, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N29, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N30, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N31, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N32, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N33, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N34, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N35, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N36, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N37, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N38, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N39, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N40, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N41, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N42, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N43, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N44, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N45, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N46, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N47, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N48, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N49, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N50, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N51, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N52, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N53, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N54, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N55, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N56, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N57, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N58, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N59, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N60, BACKCOLOR=RGB(255 165 0), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N61, BACKCOLOR=RGB(255 165 0), $


-JOY;

TYPE=HEADING, LINE=4, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=ARIAL, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=ARIAL, $
TYPE=HEADING, LINE=13, SIZE=10, STYLE=BOLD+ITALIC, FONT=ARIAL, $

TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD,$
-*TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD, N=10, BACKCOLOR=RGB(128 255 255),$
TYPE=GRANDTOTAL, SIZE=8, STYLE=BOLD,$
TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(&&TNTDTPOS), SIZE=(&&TNTDTSIZ), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLDTPOS), SIZE=(&&ROLDTSIZ), $

ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
-*
END
-RUN


-IF &LINES GT 0 THEN GOTO XXIT;
EX TCEMPTY
-RUN
-XXIT

