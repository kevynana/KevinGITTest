-**********************************************************************
-* file name: NQSMBYHRA.fex
-*     Quarterly Review - Summary by Hierarchy - Air
-**********************************************************************
-INCLUDE SETECHO
SET ASNAMES = ON
SET SPACE = 1
-SET HOLDATTR = ON;
-SET &LDSC = IF &&BRK_LVL LT 10 THEN 'AROLL_DSC' | EDIT(&&BRK_LVL.EVAL,'$9') ELSE 'AROLL_DSC' | EDIT(&&BRK_LVL.EVAL);
-RUN

CREATE FILE QRHIER
-RUN

-*********************************************************************************
-* Gather/Add Air Info to QRHIER File
-*********************************************************************************

DEFINE FILE SR_50
  CGADV/A8 = IF (ADV_PURCH LT 7) THEN '0-6' ELSE 
             IF (ADV_PURCH GE 7) AND (ADV_PURCH LE 13) THEN '7-13' ELSE
             IF (ADV_PURCH GE 14) AND (ADV_PURCH LE 20) THEN '14-20' ELSE
                '21+';  
  
  BRK_LVL/I2 = &&BRK_LVL;
  LEVEL_DESC1/A60 = &&LDESC;
  LEVEL_DESC/A25 = EDIT(LEVEL_DESC1, '9999999999999999999999999$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
   
  FARE_PAID/P12.2 = SEG_AMT + SEG_TAX;
  NET_TKT_CNT/P12    = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
  SAVINGS/P12.2     = SEG_STANDARD - FARE_PAID;
  NEW_SEG_MILES/P12 = SEG_MILES;
 -* Defines on Previous Defines
  DISSAVINGS/P12.2 = IF EMBARK EQ 'DT1' THEN 0 ELSE
                   FARE_PAID-SEG_LOWEST;
-INCLUDE QRFTRANA
END
-RUN

TABLEF FILE SR_50
PRINT CGADV
  CQ
  DISSAVINGS
  DOD_TYPE
  AIR_MAIN.INTL_DOM AS 'INTDOM'
  FARE_PAID
  LEVEL_DESC
  NET_TKT_CNT
  NEW_SEG_MILES
  NONREF_FLAG
  PQ
  SEG_COUNT
  SEG_NBR 	
  TKT_NUM
  TRN_DATE
-* WHERE (TRN_DATE GE '&&FROMDT.EVAL') AND (TRN_DATE LE '&&TODT.EVAL') OR
-*       (TRN_DATE GE '&&FXDATE.EVAL') AND (TRN_DATE LE '&&PYTDDATE.EVAL')
-*       (TRN_DATE GE '&&FXDATE.EVAL') AND (TRN_DATE LE '&&TXDATE.EVAL')
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
WHERE VOID_DATE EQ 0
-INCLUDE RPTPARMS
ON TABLE HOLD AS RPTHOLD
END
-RUN

TABLE FILE RPTHOLD
PRINT CGADV
  CQ
  DISSAVINGS
  DOD_TYPE
  INTDOM
  FARE_PAID
  LEVEL_DESC
  NET_TKT_CNT
  NEW_SEG_MILES
  NONREF_FLAG
  PQ
  SEG_COUNT
  SEG_NBR 	
  TKT_NUM
  TRN_DATE
BY CQ
BY PQ
BY LEVEL_DESC	
ON TABLE HOLD AS TRANONE 
END
-RUN


DEFINE FILE TRANONE
CAVOL/P12.2 = IF CQ EQ 'Y' THEN FARE_PAID ELSE 0;
CMILES/P12 = IF CQ EQ 'Y' THEN NEW_SEG_MILES;
PAVOL/P12.2 = IF PQ EQ 'Y' THEN FARE_PAID ELSE 0;
CNTKT/P12 = IF CQ EQ 'Y' THEN NET_TKT_CNT ELSE 0;
CNTKTD/P12 = IF CQ EQ 'Y' AND INTDOM EQ 'D' THEN NET_TKT_CNT ELSE 0;
PNTKT/P12 = IF PQ EQ 'Y' THEN NET_TKT_CNT ELSE 0;
CLSAV/P12.2 = IF CQ EQ 'Y' THEN DISSAVINGS ELSE 0;
CADVT/P12 = IF (CQ EQ 'Y') AND 
                (CGADV EQ '0-6') THEN NET_TKT_CNT ELSE 0;
CADVT1/P12 = IF (CQ EQ 'Y') AND
                 (CGADV EQ '7-13') THEN NET_TKT_CNT ELSE 0;
CONL/P12 = IF (CQ EQ 'Y') AND (DOD_TYPE EQ 'H' OR 'I' OR 'J') AND (INTDOM EQ 'D') THEN
                  NET_TKT_CNT ELSE 0;
CNR/P12 = IF (CQ EQ 'Y') AND (NONREF_FLAG EQ 'N') THEN 
              NET_TKT_CNT ELSE 0;
                
END
-RUN

TABLE FILE TRANONE
SUM CADVT
    CADVT1
    CAVOL
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL   
BY LEVEL_DESC
ON TABLE HOLD AS TRANTWO 
END
-RUN

TABLE FILE TRANTWO
PRINT CAVOL CMILES CNTKT PNTKT CLSAV PAVOL CADVT CADVT1 CONL CNTKTD CNR LEVEL_DESC
RANKED BY HIGHEST CAVOL
ON TABLE HOLD AS RNK1
END
-RUN


DEFINE FILE RNK1
 RANK_LIMIT/I2 = 20;
 RLIMIT/A2    = EDIT(RANK_LIMIT) ;
 CRANK/D5     = RANK;
 BRANK/A6     = FTOA(CRANK, '(D5)', 'A6');
 LIST/D6 = IF LEVEL_DESC NE LAST LEVEL_DESC THEN (LAST LIST + 1) 
           ELSE LAST LIST;
 FRANKX/A7 = FTOA(LIST, '(D6)', 'A7');
 FRANK/A6  = EDIT(FRANKX,'$999999'); 
 RANK_VALUE/A9 = IF RANK_LIMIT EQ 0 THEN BRANK ELSE
                IF LIST GT RANK_LIMIT THEN 'ALL OTHER' ELSE FRANK;
 LVL_PRINT/A25 =IF RANK_VALUE LT (RLIMIT) THEN LEVEL_DESC ELSE 'ALL OTHER';
END
-RUN

TABLE FILE RNK1
SUM CAVOL CMILES CNTKT PNTKT CLSAV PAVOL CADVT CADVT1 CONL CNTKTD CNR 
BY RANK_VALUE
BY LVL_PRINT
ON TABLE HOLD AS RNK2
END
-RUN

TABLE FILE RNK2
PRINT LVL_PRINT RANK_VALUE CADVT CADVT1 CAVOL CLSAV CMILES CNR CNTKT PNTKT CONL CNTKTD PAVOL
ON TABLE SAVE
END
-RUN

MODIFY FILE QRHIER
FIXFORM LVL_PRINT/25 RANK_VALUE/9 CADVT/12 CADVT1/12 CAVOL/12 CLSAV/12 CMILES/12 CNR/12 CNTKT/12 PNTKT/12 CONL/12 CNTKTD/12 PAVOL/12
MATCH RANK_VALUE LVL_PRINT
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON SAVE
END
-RUN

DEFINE FILE RNK2
LVLP/A27 = ''''||LVL_PRINT||'''';
END
-RUN
TABLE FILE RNK2
PRINT LVLP
BY LVL_PRINT NOPRINT
ON TABLE SAVE AS LEVELF
END
-RUN

-*********************************************************************************
-* Gather/Add Car Info to QRHIER File Based upon 
-*********************************************************************************


EX CARUSE
-RUN

DEFINE FILE CR_50
 LEVEL_DESC1/A60 = &&LDESC;
 LEVEL_DESC/A25 = EDIT(LEVEL_DESC1, '9999999999999999999999999$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
 RENTAL_DAYS/P12 = IF (NUM_DAYS LT 0) AND (NUM_CARS LT 0) THEN
                   ((NUM_DAYS * NUM_CARS) * (-1)) ELSE NUM_DAYS * NUM_CARS;
-INCLUDE QRFTRANC
END

-RUN
TABLE FILE CR_50
SUM RENTAL_DAYS
    RENTAL_AMT
BY LEVEL_DESC
-* WHERE (INVOICE_DATE GE '&&FROMDT.EVAL') AND (INVOICE_DATE LE '&&TODT.EVAL') 
WHERE CQ EQ 'Y'
-INCLUDE RPTPARMS
ON TABLE HOLD AS CAR1
END
-RUN

TABLE FILE CAR1
SUM RENTAL_AMT/P12.2 AS 'CARVOL'
    RENTAL_DAYS/P12 AS 'CARDAY'
BY LEVEL_DESC
ON TABLE HOLD AS CAR2
END
-RUN

-******************************************************
-* Matching Hierarchy Levels
-******************************************************

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY LEVEL_DESC 
WHERE LEVEL_DESC IN FILE LEVELF
ON TABLE HOLD AS CARMREC
END
-RUN

TABLE FILE CARMREC
SUM CARVOL
    CARDAY
BY LEVEL_DESC AS 'LVL_PRINT'
ON TABLE HOLD AS CARMREC1
END
-RUN

TABLE FILE CARMREC1
SUM CARVOL CARDAY
BY LVL_PRINT
ON TABLE SAVE
END
-RUN

MODIFY FILE QRHIER
LOG NOMATCH MSG OFF
FIXFORM LVL_PRINT/25 CARVOL/12 CARDAY/12
MATCH LVL_PRINT
ON MATCH UPDATE CARVOL CARDAY
ON NOMATCH REJECT
DATA ON SAVE
END
-RUN

-**********************************************************************
-* Non Matching information ALL OTHER
-**********************************************************************

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY LEVEL_DESC
WHERE NOT LEVEL_DESC IN FILE LEVELF
ON TABLE HOLD AS CARNREC
END
-RUN

DEFINE FILE CARNREC
LVL_PRINT/A25 = 'ALL OTHER';
END
-RUN
TABLE FILE CARNREC
SUM CARVOL CARDAY
BY LVL_PRINT
ON TABLE SAVE
END
-RUN

MODIFY FILE QRHIER
LOG NOMATCH MSG OFF
FIXFORM LVL_PRINT/25 CARVOL/12 CARDAY/12
MATCH LVL_PRINT
ON MATCH UPDATE CARVOL CARDAY
ON NOMATCH REJECT
DATA ON SAVE
END
-RUN

-*********************************************************************************
-* Gather/Add HTL Info to QRHIER File
-*********************************************************************************

EX HTLUSE
-RUN

DEFINE FILE HR_50
 LEVEL_DESC1/A60 = &&LDESC;
 LEVEL_DESC/A25 = EDIT(LEVEL_DESC1, '9999999999999999999999999$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
 NBR_DAYS/P12=NUM_DAYS;
 NEW_TOTAL_AMT/P12.2 = TOTAL_AMT;
 NNROOMS/P12 = IF ((NBR_DAYS LT 0) AND (NUM_ROOMS LT 0)) THEN 
                ((NBR_DAYS*NUM_ROOMS) * (-1)) ELSE NBR_DAYS*NUM_ROOMS;
-INCLUDE QRFTRANC
END
-RUN

TABLE FILE HR_50
SUM NEW_TOTAL_AMT
    NNROOMS
BY LEVEL_DESC
WHERE CQ EQ 'Y'
-INCLUDE RPTPARMS
ON TABLE HOLD AS HTL1
END
-RUN

-**************************************************************************
-* Matching Hotel Records
-**************************************************************************
TABLE FILE HTL1
SUM NEW_TOTAL_AMT AS 'HTLVOL'
    NNROOMS AS 'HTLDAY'
BY LEVEL_DESC 
WHERE LEVEL_DESC IN FILE LEVELF
ON TABLE HOLD AS HTLMREC
END
-RUN

TABLE FILE HTLMREC
SUM HTLVOL HTLDAY
BY LEVEL_DESC AS 'LVL_PRINT'
ON TABLE HOLD AS HTLMREC1
END
-RUN

TABLE FILE HTLMREC1
SUM HTLVOL HTLDAY
BY LVL_PRINT
ON TABLE SAVE
END
-RUN

MODIFY FILE QRHIER
LOG NOMATCH MSG OFF
FIXFORM LVL_PRINT/25 HTLVOL/12 HTLDAY/12
MATCH LVL_PRINT
ON MATCH UPDATE HTLDAY HTLVOL
ON NOMATCH REJECT
DATA ON SAVE
END
-RUN

-**********************************************************************
-* Non Matching ALL OTHER Records
-**********************************************************************
TABLE FILE HTL1
SUM NEW_TOTAL_AMT AS 'HTLVOL'
    NNROOMS AS 'HTLDAY'
BY LEVEL_DESC 
WHERE NOT LEVEL_DESC IN FILE LEVELF
ON TABLE HOLD AS HTLNREC
END
-RUN

DEFINE FILE HTLNREC
LVL_PRINT/A25 = 'ALL OTHER';
END
-RUN
TABLE FILE HTLNREC
SUM HTLVOL HTLDAY
BY LVL_PRINT
ON TABLE HOLD AS HTLNREC1
END
-RUN

TABLE FILE HTLNREC1
SUM HTLVOL HTLDAY
BY LVL_PRINT
ON TABLE SAVE
END
-RUN

MODIFY FILE QRHIER
LOG NOMATCH MSG OFF
FIXFORM LVL_PRINT/25 HTLVOL/12 HTLDAY/12
MATCH LVL_PRINT
ON MATCH UPDATE HTLDAY HTLVOL
ON NOMATCH REJECT
DATA ON SAVE
END
-RUN

DEFINE FILE QRHIER
RANK_VALUEA/A9 = 'TOTAL';
LVL_PRINTA/A25 = 'TOTAL';
END
-RUN

TABLE FILE QRHIER
SUM CAVOL/P12.2M 
  PCT.CAVOL/P4 AS 'PCTVOL'
  CNTKT 
  CLSAV/P12.2M 
COMPUTE CTLS/P12 =  IF CAVOL EQ 0 THEN 0 ELSE ((CLSAV/CAVOL)*100); 
COMPUTE CAVGT/P12.2M = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0 ELSE CAVOL/CNTKT;   
COMPUTE PAVGT/P12.2M = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE PAVOL/PNTKT; NOPRINT
COMPUTE AAVGV/P12.2M = CAVGT - PAVGT; NOPRINT
COMPUTE AAVGV1/P12 = IF PAVGT EQ 0 THEN 0 ELSE (((CAVGT-PAVGT)/PAVGT)*100); 
COMPUTE CADVP1/P12 = IF CNTKT EQ 0 THEN 0 ELSE ((CADVT/CNTKT)*100);  
COMPUTE CADVP2/P12 = IF CNTKT EQ 0 THEN 0 ELSE ((CADVT1/CNTKT)*100); 
COMPUTE CONLP/P12  = IF CNTKTD EQ 0 THEN 0 ELSE ((CONL/CNTKTD)*100); 
COMPUTE CNRP/P12  = IF CNTKT EQ 0 THEN 0 ELSE ((CNR/CNTKT)*100); 
COMPUTE CPMILE/P10.2 = IF CMILES EQ 0 THEN 0 ELSE (CAVOL/CMILES);
COMPUTE CARAR/P12.2M = IF ((CARDAY LT 1) AND (CARDAY GT (-1))) THEN 0 ELSE CARVOL/CARDAY; 
COMPUTE HTLARR/P12.2M = IF ((HTLDAY LT 1) AND (HTLDAY GT (-1))) THEN 0 ELSE HTLVOL/HTLDAY; 
COMPUTE TACH/P12.2M = CAVOL + CARVOL + HTLVOL;  
BY RANK_VALUEA AS 'RANK_VALUE'
BY LVL_PRINTA AS 'LVL_PRINT'
ON TABLE HOLD AS TTL1
END
-RUN


TABLE FILE TTL1
SUM CAVOL/P12 PCTVOL CNTKT/P12 CLSAV/P12 CTLS/P12 CAVGT/P12 AAVGV1/P12
    CADVP1/P12 CADVP2/P12 CONLP/P12 CNRP/P12 CPMILE/P10.2 CARAR/P12 HTLARR/P12 TACH/P12
BY RANK_VALUE 
BY LVL_PRINT
ON TABLE HOLD AS TTL2
END
-RUN

TABLE FILE TTL2
PRINT CAVOL PCTVOL CNTKT CLSAV CTLS CAVGT AAVGV1 CADVP1 CADVP2 
      CONLP CNRP CPMILE CARAR HTLARR TACH
BY RANK_VALUE
BY LVL_PRINT
ON TABLE HOLD AS TTL3 FORMAT FOCUS
END
-RUN

TABLE FILE QRHIER
SUM CAVOL/P12.2M 
  PCT.CAVOL/P4 AS 'PCTVOL'
  CNTKT 
  CLSAV/P12.2M 
COMPUTE CTLS/P12 =  IF CAVOL EQ 0 THEN 0 ELSE ((CLSAV/CAVOL)*100); 
COMPUTE CAVGT/P12.2M = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0 ELSE CAVOL/CNTKT;   
COMPUTE PAVGT/P12.2M = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE PAVOL/PNTKT; NOPRINT
COMPUTE AAVGV/P12.2M = CAVGT - PAVGT; NOPRINT
COMPUTE AAVGV1/P12 = IF PAVGT EQ 0 THEN 0 ELSE (((CAVGT-PAVGT)/PAVGT)*100); 
COMPUTE CADVP1/P12 = IF CNTKT EQ 0 THEN 0 ELSE ((CADVT/CNTKT)*100);  
COMPUTE CADVP2/P12 = IF CNTKT EQ 0 THEN 0 ELSE ((CADVT1/CNTKT)*100); 
COMPUTE CONLP/P12  = IF CNTKTD EQ 0 THEN 0 ELSE ((CONL/CNTKTD)*100); 
COMPUTE CNRP/P12  = IF CNTKT EQ 0 THEN 0 ELSE ((CNR/CNTKT)*100); 
COMPUTE CPMILE/P10.2 = IF CMILES EQ 0 THEN 0 ELSE (CAVOL/CMILES);
COMPUTE CARAR/P12.2M = IF ((CARDAY LT 1) AND (CARDAY GT (-1))) THEN 0 ELSE CARVOL/CARDAY; 
COMPUTE HTLARR/P12.2M = IF ((HTLDAY LT 1) AND (HTLDAY GT (-1))) THEN 0 ELSE HTLVOL/HTLDAY; 
COMPUTE TACH/P12.2M = CAVOL + CARVOL + HTLVOL;  
BY RANK_VALUE
BY LVL_PRINT
ON TABLE HOLD AS TLEV1
END
-RUN

TABLE FILE TLEV1
PRINT CAVOL/P12 PCTVOL/P4 CNTKT/P12 CLSAV/P12 CTLS/P12 CAVGT/P12 AAVGV1/P12 CADVP1/P12 CADVP2/P12 
      CONLP/P12 CNRP/P12 CPMILE/P10.2 CARAR/P12 HTLARR/P12 TACH/P12
BY RANK_VALUE
BY LVL_PRINT
ON TABLE HOLD AS TLEV2 
END
-RUN


TABLE FILE TLEV2
PRINT CAVOL PCTVOL CNTKT CLSAV CTLS CAVGT AAVGV1 CADVP1 CADVP2 
      CONLP CNRP CPMILE CARAR HTLARR TACH
BY RANK_VALUE
BY LVL_PRINT
ON TABLE HOLD AS TLEV3 FORMAT FOCUS
END
-RUN

-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &PHOLD1=&HLDPATH || 'TLEV3.FOC';
-SET &PHOLD2=&HLDPATH || 'TTL3.FOC';
-RUN

USE CLEAR *
-RUN

USE ADD 
&PHOLD1 AS TLEV3
&PHOLD2 AS TLEV3
END
-RUN

DEFINE FILE TLEV3
RANK_VAL1/A9 = IF RANK_VALUE EQ 'TOTAL' THEN 'ZZ' ELSE RANK_VALUE;
END
-RUN

TABLE FILE TLEV3
SUM CAVOL PCTVOL CNTKT CLSAV CTLS CAVGT AAVGV1 CADVP1 CADVP2 
    CONLP CNRP CPMILE CARAR HTLARR TACH
BY RANK_VAL1
BY LVL_PRINT
ON TABLE HOLD AS TLEV4
END
-RUN

TABLE FILE TLEV4
HEADING 
" "
" " 
SUM CAVOL/P12M AS 'Total Volume' 
    PCTVOL AS '% of,Total,Volume'
    CNTKT AS 'Net,Tickets'
    CLSAV/P12M AS 'Total Lost,Savings'
    CTLS AS '% of,LS to,Air,Volume'
    CAVGT AS 'Avg,Ticket,Price'    
    AAVGV1 AS 'Avg,Ticket,Price,Variance %'
    CADVP1 AS '% Of,Net Tickets,Purchased,0-6 Days'
    CADVP2 AS '% of,Net Tickets,Purchased,7-13 Days'   
    CONLP AS '% Dom,Online'
    CNRP AS '% of,NR    
    CPMILE AS 'CPM'
    CARAR/P12M AS 'Avg,Car,Rate'
    HTLARR/P12M AS 'Avg,Hotel,Cost Per,Night'
    TACH/P12M AS 'Total Air,Car &,Hotel,Spend'
BY RANK_VAL1 NOPRINT   
BY LVL_PRINT AS 'HIERARCHY'
ON TABLE SET PAGE-NUM OFF
ON LVL_PRINT SKIP-LINE
&&OUTLINE1
&&OUTLINE2
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.100000,
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=TITLE, STYLE=BOLD, COLUMN=N1, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N2, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N3, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N4, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N5, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N6, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N7, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N8, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N9, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N10, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N11, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N12, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N13, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N14, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N15, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N16, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N17, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N18, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N19, BACKCOLOR=RGB(145 207 255), $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=7, BACKCOLOR=NONE, STYLE=NORMAL, $
-* TYPE=REPORT, FONT=ARIAL, SIZE=7, COLUMN=N2, STYLE=NORMAL,$
TYPE=REPORT, IMAGE=SumByHier.GIF,POSITION=(0.1 0.1), SIZE=(10.75 .75), $
TYPE=DATA, COLUMN=N2,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N3,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N4,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N5,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N6,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N7,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N8,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N9,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N10,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N11,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N12,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N13,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N14,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N15,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N16,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=DATA, COLUMN=N17,WHEN=N2 EQ 'TOTAL', STYLE=BOLD, $
TYPE=SUBTOTAL, STYLE=BOLD, $
TYPE=FOOTING, FONT=TIMES NEW ROMAN, SIZE=7, STYLE=BOLD,$
TYPE=REPORT,GRID=OFF, $
ENDSTYLE
END
-RUN

SET SPACE = 2



