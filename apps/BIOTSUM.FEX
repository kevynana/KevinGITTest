-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Removed Conagra Special from here so that they could have the standard
-* report as well as their specialized version JK 10/16/03
-* Changed online bookings % header to say domestic JK 12/12/03
-* CHANGED % ONLINE DOMESTIC BOOKINGS TO USE CDONLP DV 8/30/04 
-* ADDED CODE FOR GLOBAL CURENCY - DEB - 1/24/05
-* CHANGED HEADER ON CTLSV AND CTLS PER PATTI - DEB 5/6/05
-* CARRIED THRU CBVSV - JOY 3/31/14
-*  02/05/2015  REJ  S-05681 Changes for Available Reports.  Adding code so that the
-*                           program will run in current Review and in Available Reports.
-* 04/13/2015 - DEB - S-07573 - CREATED FOR BIOTBNM 
-* 05/13/2015 - DEB -  S-07573 - Added column title for PAX_NAME
-*                               added code to run in .pdf format
-* 06/15/2015 - DEB - S-09473 - Added total ticket period2 - subtotal prior 
-*                              to ALL OTHER 
-*                              total amount change tickets period1 vs period2
-*                              total amount change spend period1 vs period2

-*04/25/2016 - JEM - S-17947 - Updated title names for period2 to be YTD and removed company name information
-*06/07/2016 - JEM - S-18938 - Added computes for ATP for period1 and YTD
-* 02/24/2017 - DLV - S-22486 CHANGED ettek Review to Post-trip Reporting
-* 05/24/2017 JEM S-34216 - updating to make styling/heading/positioning more consistent
-* 08/28/2017 RSB S-38044 Place the footer datetime stamp text in a separate file to be -INCLUDED in the stylesheets

-INCLUDE SETECHO

 
SET ASNAMES=ON
 
-SET &&RPTSUF = 'SMY';
 
-IF &&FROMAVRP EQ 'Y' GOTO :BNSM1;
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99$');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99$');
-SET &FMY=EDIT(&&FROMDT,'$9999$');
-SET &TOM=EDIT(&&TODT,'$$$$$$99$');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99$');
-SET &TOY=EDIT(&&TODT,'$9999$');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99$');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99$');
-SET &FXMY=EDIT(&&FXDATE,'$9999$');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99$');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99$');
-SET &TXOY=EDIT(&&TXDATE,'$9999$');
-GOTO :BNSM1_CONT;
-:BNSM1
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99$');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99$');
-SET &FMY=EDIT(&&FROMDT,'$9999$');
-SET &TOM=EDIT(&&TODT,'$$$$$$99$');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99$');
-SET &TOY=EDIT(&&TODT,'$9999$');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99$');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99$');
-SET &FXMY=EDIT(&&FXDATE,'$9999$');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99$');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99$');
-SET &TXOY=EDIT(&&TXDATE,'$9999$');
-:BNSM1_CONT

 

 
-SET &&SP = '|';
-SET &&SP1A = IF &&ROLLNME EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP1 = IF &&ROLLCS EQ ' ' THEN ' ' ELSE &&SP1A;
-SET &&SP3 = IF &&ROLLCNCT EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP4 = IF &&ROLLPHN EQ ' ' THEN ' ' ELSE &&SP;
-SET &&RCNCT = &&ROLLCNCT.LENGTH;
-SET &&CSL = &&ROLLCS.LENGTH;
-SET &&REL = &&ROLLEMAIL.LENGTH;
-SET &&RCSL = &&RCNCT.EVAL + &&CSL.EVAL;

-SET &&CSLPA = IF &&ROLLNME EQ 'TOTAL COMPANY REPORTING' THEN 45 ELSE
-              IF '&&ROLLUP.EVAL' EQ 'ABCD-R' THEN 70 ELSE 
-              IF '&&ROLLEMAIL.EVAL' NE ' ' AND &&REL GT 20 THEN 58 ELSE
-              IF &&RCSL LE 21 THEN 75 ELSE 
-              IF &&RCSL GT 21 AND &&RCSL LE 26 THEN 65 ELSE 
-              IF &&RCSL GT 26 AND &&RCSL LE 31 THEN 60 ELSE 55;

-* -SET &&CSLPA = IF &&ROLLNME EQ 'TOTAL COMPANY REPORTING' THEN 45 ELSE
-* -              IF &&RCNCT.EVAL GE 10 OR &&CSL.EVAL GE 10 THEN 58 ELSE 66;

-SET &&CSLP = IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' AND &&ORIENTATION LIKE 'L%' THEN 78 
- ELSE IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' AND &&ORIENTATION LIKE 'P%' THEN 55 
- ELSE IF '&&ROLLUP.EVAL' EQ 'HDRR-R' AND &&ORIENTATION LIKE 'L%' THEN 70
- ELSE IF &&ORIENTATION LIKE 'P%' THEN &&CSLPA-15 ELSE &&CSLPA;

-SET &&ROLLCS11 = TRUNCATE(&&ROLLCS);
-SET &&RCNCT1 = TRUNCATE(&&ROLLCNCT);

-SET &&BLANK = ' ';
-SET &&ROLLPHNEML = IF '&&ROLLEMAIL.EVAL' GT ' ' THEN '&&ROLLEMAIL.EVAL' ELSE '&&ROLLPHN.EVAL';
-INCLUDE FDEFRPTS
-RUN
 

 
 
DEFINE FILE FINALHLD
NOWTOD/A8 WITH CAVOL = HHMMSS (NOWTOD);
BLANK/A1 = ' ';
FLAG/A1 = IF RANK_VALUE NE 'ALL OTHER' THEN 'A' ELSE 'B'; 
FLAG1/A1 = IF FLAG EQ 'A' THEN ' ' ELSE FLAG;
XPSNGR_NM/A17 = EDIT(PAX_NAME, '99999999999999999');
END
-RUN
 
-IF '&&OUTFMT.EVAL' EQ 'PDF' THEN GOTO PdfStyle;

 
TABLE FILE FINALHLD
SUM CNTKT AS 'Total Tickets,Period 1'    
    CAVOL/D12CM AS 'Total Amount,Spend Period 1'
COMPUTE CATP/D12CM = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0 ELSE CAVOL/CNTKT; AS 'Average,Ticket,Price,Period1'   
    CLS_TKT/D8C  AS '# Tickets Issued, with Lost Savings'
    CLSAV/D12CM AS '  Total,Lost Savings'
    PADV AS 'Average Advance Purchase'
    AP_SVG/D12CM AS 'Adv Purchase Savings'
    PCEXCH AS '# of Exchanges'
    P_ADDAMT/D12CM AS 'Exchange Fees,Including Add,Collect'
    PNTKT AS 'Total Tickets,YTD'
    PAVOL/D12CM AS 'Total Amount,Spend YTD'
COMPUTE PATP/D12CM = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE PAVOL/PNTKT; AS 'Average,Ticket,Price,YTD'
    
-*  COMPUTE CAVAR1/P12C = IF ((PAVOL LT 1) AND (PAVOL GT (-1))) THEN 0 ELSE
-*                            (((CAVOL-PAVOL)/PAVOL)*100); NOPRINT
   

-* COMPUTE CAVAR/P8%C = CAVAR1; AS 'Change % of,Total Spend'
-* COMPUTE SPVAR/D12.2CSM = CAVOL - PAVOL; AS 'Change Total Spend,Period 1 VS. YTD' 
-* COMPUTE TVAR/D8CS = CNTKT - PNTKT; AS 'Change Total Tickets,Period 1 VS. YTD' 

BY FLAG NOPRINT
BY FLAG1 NOPRINT
BY RANK_VALUE AS 'Rank'
BY PAX_NAME AS 'Passenger Name'
ON FLAG1 RECOMPUTE  CNTKT CAVOL CLS_TKT CLSAV AP_SVG PCEXCH  P_ADDAMT PNTKT PAVOL AS 'SubTotal'
ON PAX_NAM RECOMPUTE MULTILINES CNTKT CAVOL CLS_TKT CLSAV AP_SVG PCEXCH  P_ADDAMT PNTKT PAVOL AS 'TOTAL FOR'
 
HEADING
-* "&&ROLLNME &&SP1 &&ROLLCS11 &&SP3 &&RCNCT1 &&SP4 &&ROLLPHN"
"&&DTDESC"
"Period1: &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
"<+10> YTD:<ANNUAL_BEGIN - <EOM_DATE1"
"&&RPT_TTL1"
"&&RPT_TTL2"
" "
"&&SUBHEAD"
 
FOOTING BOTTOM
"Post-trip Reporting &DATE AT <NOWTOD <60 &&FOOTR"
ON TABLE SET PAGE-NUM OFF
-*ON TABLE NOTOTAL
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
 
 
-GOTO CONTrpt

-PdfStyle;
TABLE FILE FINALHLD
SUM CNTKT AS 'Total,Tickets,Period 1'    
    CAVOL/D12CM AS 'Total,Amount,Spend,Period 1'
COMPUTE CATP/D12CM = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0 ELSE CAVOL/CNTKT; AS 'Average,Ticket,Price,Period1'
    CLS_TKT/D8C  AS '# Tickets,Issued, with, Lost,Savings'
    CLSAV/D12CM AS ' Total,Lost,Savings'
    PADV AS 'Average,Advance,Purchase'
    AP_SVG/D12CM AS 'Adv,Purchase,Savings'
    PCEXCH AS '# of,Exchanges'
    P_ADDAMT/D12CM AS 'Exchange,Fees,Including,Add,Collect'
    PNTKT AS 'Total,Tickets,YTD'
    PAVOL/D12CM AS 'Total,Amount,Spend,YTD'
COMPUTE PATP/D12CM = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE PAVOL/PNTKT; AS 'Average,Ticket,Price,YTD'
    
-* COMPUTE CAVAR1/P12C = IF ((PAVOL LT 1) AND (PAVOL GT (-1))) THEN 0 ELSE
-*                           (((CAVOL-PAVOL)/PAVOL)*100); NOPRINT
   

-* COMPUTE CAVAR/P8%C = CAVAR1; AS 'Change, % of,Total,Spend'
-* COMPUTE SPVAR/D12.2CSM = CAVOL - PAVOL; AS 'Change,Total,Spend,Period 1,VS. YTD' 
-* COMPUTE TVAR/D8C  = CNTKT - PNTKT; AS 'Change,Total,Tickets,Period 1,VS. YTD' 

BY FLAG NOPRINT
BY FLAG1 NOPRINT
BY RANK_VALUE AS 'Rank'
BY XPSNGR_NM AS 'Passenger Name'
ON FLAG1 RECOMPUTE  CNTKT CAVOL CLS_TKT CLSAV AP_SVG PCEXCH  P_ADDAMT PNTKT PAVOL AS 'SubTotal'
ON XPSNGR_NM RECOMPUTE MULTILINES CNTKT CAVOL CLS_TKT CLSAV AP_SVG PCEXCH  P_ADDAMT PNTKT PAVOL AS 'TOTAL FOR'
 
 

 
-HEAD
HEADING
"</2"
"&&DTDESC  Period1: &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"  
"<12 YTD: <ANNUAL_BEGIN - <EOM_DATE1 <&&CSLP &&ROLLNME &&SP1 &&ROLLCS11 &&SP3 &&RCNCT1 &&SP4 &&ROLLPHNEML"
-* <+0> <&&CSLP &&ROLLNME <+0> &&SP1 <+0> &&ROLLCS11 <+0> &&SP3 <+0> &&RCNCT1 <+0> &&SP4 <+0> &&ROLLPHNEML"
"Page:<TABPAGENO"
" "
"<30 &&RPT_TTL1"
"<30 &&RPT_TTL2"
" "
-*
-INCLUDE FOOTERSM
-*
ON TABLE SET PAGE-NUM OFF
-*ON TABLE NOTOTAL
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

-CONTrpt

ON TABLE SET STYLE *

-IF '&&OUTFMT.EVAL' NE 'PDF' THEN GOTO EXLFMT;
-*
-INCLUDE FTR_DateTimePosit
-* 
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000, 
    TOPMARGIN=0.300000, BOTTOMMARGIN=0.050000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT='ARIAL', SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $


TYPE=HEADING, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$
-*TYPE=HEADING, LINE=6, SIZE=11, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=8, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=9, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
-* TYPE=HEADING, LINE=9, SIZE=9, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=SUBHEAD, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$

TYPE=FOOTING, SIZE=7, FONT='ARIAL', COLOR=RGB(70 136 177), $
TYPE=TABFOOTING, SIZE=7, FONT='ARIAL', COLOR=RGB(70 136 177),$

TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=8, STYLE=BOLD, $

TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0.2), SIZE=(2.8 .37),PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.0), SIZE=(10.5 .58), PRESERVERATIO=ON, $     
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&TNTDTPOS), SIZE=(&&ROLDTSIZ), $
-*
TYPE=FOOTING, LINE=&FTR_DateTimeLine, STYLE=BOLD,POSITION=(&FTR_DatePosit),$ 
-*
$     

-GOTO SkipStyle;

-EXLFMT
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.300000, BOTTOMMARGIN=0.050000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
 
TYPE=REPORT, FONT=ARIAL, SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=HEADING, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(31 114 164), BACKCOLOR=NONE, $
-* TYPE=HEADING, HEADALIGN=BODY, $
-* TYPE=HEADING, LINE=1, COLSPAN=4, JUSTIFY=LEFT, $
-* TYPE=HEADING, LINE=2, COLSPAN=4, JUSTIFY=LEFT, $
-* TYPE=HEADING, LINE=3, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=4, SIZE=9, JUSTIFY=CENTER, $
-* TYPE=HEADING, LINE=5, COLSPAN=20, SIZE=9,JUSTIFY=CENTER, $
-* TYPE=HEADING, LINE=6, COLSPAN=4, JUSTIFY=LEFT, $
 
 
TYPE=DATA,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8,
     JUSTIFY=RIGHT,
     BACKCOLOR=(RGB(242 242 242) 'WHITE' ),$
-JOY
TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8,
     COLOR='WHITE',
     BACKCOLOR=RGB(31 114 164),
     STYLE=BOLD,$
 
TYPE=TITLE, JUSTIFY=CENTER, $
 
TYPE=TABFOOTING, FONT=ARIAL, COLOR=GRAY,$
 
TYPE=FOOTING, FONT=ARIAL, COLOR=GRAY,$
 
TYPE=SUBHEAD,
     STYLE=BOLD,
$
 
TYPE=SUBTOTAL,
     STYLE=BOLD,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER', $
 
TYPE=GRANDTOTAL, STYLE=BOLD, $
 
 
 
    TYPE=REPORT, COLUMN=N5, WRAP=  1.0,$
    TYPE=REPORT, COLUMN=N6, WRAP=  1.0,$
    TYPE=REPORT, COLUMN=N7, WRAP=  1.0,$
    TYPE=REPORT, COLUMN=N8, WRAP=  1.0,$
    TYPE=REPORT, COLUMN=N9, WRAP=  1.0,$
    TYPE=REPORT, COLUMN=N10, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N11, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N12, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N13, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N14, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N15, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N16, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N17, WRAP= 1.2,$
    TYPE=REPORT, COLUMN=N18, WRAP= 1.2,$
    TYPE=REPORT, COLUMN=N19, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N20, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N21, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N22, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N23, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N24, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N25, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N26, WRAP= 1.0,$
    TYPE=REPORT, COLUMN=N27, WRAP= 1.0,$
 

 
-GOTO endsty;
 
-SkipStyle 


-endsty; 
 
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
-*
END
-RUN 
 
