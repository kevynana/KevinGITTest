-* 12/28/04  - DEB - ADDED ADDT'L DOD_TYPE TO BOOKING TYPE DEFINES

-* 4/27/04  SAC   ADDED TRP_REF AND NHR_REF
-*5/23/14   - DEB  = ADDED EX5 TO FARE MILES RADV_PURCH DEFINE
-* 03/27/2017 - REJ - S-32171 Updated for ER5 rollout.




USE CLEAR *

-SET &&AH = AH_50;
-SET &&DAH = AH_50 || '.';
-SET &&EXTRACT = WR_50;
-SET &&EXTJOIN = WR_JOIN;
-SET &&COMPNY = 'TEST' ;

-SET &&AIR_PATH = 'D:\TNT\TTRACKER\DATA\';
-SET &&COM_PATH = 'D:\TNT\TTRACKER\SYSTEM\DATA\';
-SET &&SU_PATH = 'D:\TNT\TTRACKER\SUDATA\';
-SET &&AH_DB = 'AL' || &&COMPNY || '.FOC';
-SET &&USE_AH = &&AIR_PATH || &&AH_DB;
-SET &&USE_AREF = &&COM_PATH || 'AIR_REF.FOC';
-SET &&USE_TREF = &&COM_PATH || 'TRP_REF.FOC';
-SET &&USE_NREF = &&COM_PATH || 'NHR_REF.FOC';
-SET &&USE_CLNT = &&COM_PATH || 'CLIENT.FOC';
-SET &&USE_BRCH = &&COM_PATH || 'BRANCH.FOC';
-SET &&USE_ROLL = &&COM_PATH || 'ROLLUPX.FOC';
-SET &&USE_CCAT = &&COM_PATH || 'CLS_CAT.FOC';
-SET &&USE_ARPT = &&COM_PATH || 'AIRPORT.FOC';
-SET &&USE_AEMB = &&COM_PATH || 'EMBARPT.FOC';
-SET &&USE_ARTE = &&COM_PATH || 'RTEARPT.FOC';
-SET &&USE_ANDO = &&COM_PATH || 'NDOARPT.FOC';
-SET &&USE_ANDD = &&COM_PATH || 'NDDARPT.FOC';
-SET &&USE_MILG = &&COM_PATH || 'MILEAGE.FOC';
-SET &&USE_ARLN = &&COM_PATH || 'AIRLINE.FOC';
-SET &&USE_CITY = &&COM_PATH || 'CITY.FOC';
-SET &&USE_CEMB = &&COM_PATH || 'EMBCITY.FOC';
-SET &&USE_CRTE = &&COM_PATH || 'RTECITY.FOC';
-SET &&USE_CNDO = &&COM_PATH || 'NDOCITY.FOC';
-SET &&USE_CNDD = &&COM_PATH || 'NDDCITY.FOC';
-SET &&USE_VAIR = &&COM_PATH || 'VAL_AIR.FOC';

-GOTO USE_S

-*****************************************************************

-USE50M
-SET &&AH = AH_50;
-SET &&DAH = AH_50 || '.';
-SET &&EXTRACT = MR_50;
-SET &&EXTJOIN = MR_JOIN;

-SET &&AIR_PATH = 'D:\TNT\TTRACKER\DATA\';
-SET &&COM_PATH = 'D:\TNT\TTRACKER\SYSTEM\DATA\';
-SET &&SU_PATH = 'D:\TNT\TTRACKER\SUDATA\';
-SET &&AH_DB = 'AL' || &&COMPNY || '.FOC';
-SET &&USE_AH = &&AIR_PATH || &&AH_DB;
-SET &&USE_AREF = &&COM_PATH || 'AIR_REF.FOC';
-SET &&USE_TREF = &&COM_PATH || 'TRP_REF.FOC';
-SET &&USE_NREF = &&COM_PATH || 'NHR_REF.FOC';
-SET &&USE_CLNT = &&COM_PATH || 'CLIENT.FOC';
-SET &&USE_BRCH = &&COM_PATH || 'BRANCH.FOC';
-SET &&USE_ROLL = '';
-SET &&USE_CCAT = &&COM_PATH || 'CLS_CAT.FOC';
-SET &&USE_ARPT = &&COM_PATH || 'AIRPORT.FOC';
-SET &&USE_AEMB = &&COM_PATH || 'EMBARPT.FOC';
-SET &&USE_ARTE = &&COM_PATH || 'RTEARPT.FOC';
-SET &&USE_ANDO = &&COM_PATH || 'NDOARPT.FOC';
-SET &&USE_ANDD = &&COM_PATH || 'NDDARPT.FOC';
-SET &&USE_MILG = &&COM_PATH || 'MILEAGE.FOC';
-SET &&USE_ARLN = &&COM_PATH || 'AIRLINE.FOC';
-SET &&USE_CITY = &&COM_PATH || 'CITY.FOC';
-SET &&USE_CEMB = &&COM_PATH || 'EMBCITY.FOC';
-SET &&USE_CRTE = &&COM_PATH || 'RTECITY.FOC';
-SET &&USE_CNDO = &&COM_PATH || 'NDOCITY.FOC';
-SET &&USE_CNDD = &&COM_PATH || 'NDDCITY.FOC';
-SET &&USE_VAIR = &&COM_PATH || 'VAL_AIR.FOC';


-GOTO USE_M

-****************************************************************

-USE50D
-SET &&AH = AH_50;
-SET &&DAH = AH_50 || '.';
-SET &&EXTRACT = DR_50;
-SET &&EXTJOIN = DR_JOIN;

-SET &&AIR_PATH = 'D:\TNT\TTRACKER\DATA\';
-SET &&COM_PATH = 'D:\TNT\TTRACKER\SYSTEM\DATA\';
-SET &&SU_PATH = 'D:\TNT\TTRACKER\SUDATA\';
-SET &&AH_DB = 'AL' || &&COMPNY || '.FOC';
-SET &&USE_AH = &&AIR_PATH || &&AH_DB;
-SET &&USE_AREF = &&COM_PATH || 'AIR_REF.FOC';
-SET &&USE_TREF = &&COM_PATH || 'TRP_REF.FOC';
-SET &&USE_NREF = &&COM_PATH || 'NHR_REF.FOC';
-SET &&USE_CLNT = &&COM_PATH || 'CLIENT.FOC';
-SET &&USE_BRCH = &&COM_PATH || 'BRANCH.FOC';
-SET &&USE_ROLL = '';
-SET &&USE_CCAT = &&COM_PATH || 'CLS_CAT.FOC';
-SET &&USE_ARPT = &&COM_PATH || 'AIRPORT.FOC';
-SET &&USE_AEMB = &&COM_PATH || 'EMBARPT.FOC';
-SET &&USE_ARTE = &&COM_PATH || 'RTEARPT.FOC';
-SET &&USE_ANDO = &&COM_PATH || 'NDOARPT.FOC';
-SET &&USE_ANDD = &&COM_PATH || 'NDDARPT.FOC';
-SET &&USE_MILG = &&COM_PATH || 'MILEAGE.FOC';
-SET &&USE_ARLN = &&COM_PATH || 'AIRLINE.FOC';
-SET &&USE_CITY = &&COM_PATH || 'CITY.FOC';
-SET &&USE_CEMB = &&COM_PATH || 'EMBCITY.FOC';
-SET &&USE_CRTE = &&COM_PATH || 'RTECITY.FOC';
-SET &&USE_CNDO = &&COM_PATH || 'NDOCITY.FOC';
-SET &&USE_CNDD = &&COM_PATH || 'NDDCITY.FOC';
-SET &&USE_VAIR = &&COM_PATH || 'VAL_AIR.FOC';

-GOTO USE_D

-USE_S
USE CLEAR *
-RUN

-SET &&COMP1S = 'S_' ||&&COMPNY || '.FOC';
-SET &&COMP1A = 'A_' ||&&COMPNY || '.FOC';
-SET &&COMP1T = 'T_' ||&&COMPNY || '.FOC';

USE

D:\TNT\TTRACKER\DATA\&&COMP1S AS &&EXTRACT
D:\TNT\TTRACKER\DATA\&&COMP1A AS AIR_MAIN
D:\TNT\TTRACKER\DATA\&&COMP1T AS TKT_MAIN

  &&USE_ARLN
  &&USE_MILG
  &&USE_CCAT
  &&USE_AEMB
  &&USE_CEMB
  &&USE_ARTE
  &&USE_CRTE
  &&USE_ANDO
  &&USE_CNDO
  &&USE_ANDD
  &&USE_CNDD
  &&USE_VAIR
  &&USE_AH AS &&AH
  &&USE_AREF
  &&USE_TREF
  &&USE_NREF
  &&USE_CLNT
END
-RUN
-GOTO STOP

-USE_M
USE CLEAR *
-RUN

-SET &&COMP1S = 'M_' ||&&COMPNY || '.FOC';
-SET &&COMP1A = 'A_' ||&&COMPNY || '.FOC';
-SET &&COMP1T = 'T_' ||&&COMPNY || '.FOC';


USE

D:\TNT\TTRACKER\DATA\&&COMP1S AS &&EXTRACT
D:\TNT\TTRACKER\DATA\&&COMP1A AS AIR_MAIN
D:\TNT\TTRACKER\DATA\&&COMP1T AS TKT_MAIN

  &&USE_ARLN
  &&USE_MILG
  &&USE_CCAT
  &&USE_AEMB
  &&USE_CEMB
  &&USE_ARTE
  &&USE_CRTE
  &&USE_ANDO
  &&USE_CNDO
  &&USE_ANDD
  &&USE_CNDD
  &&USE_VAIR
  &&USE_AH AS &&AH
  &&USE_AREF
  &&USE_TREF
  &&USE_NREF
  &&USE_CLNT
END
-RUN
-GOTO JOINIT

-USE_D
USE CLEAR *
-RUN

-SET &&COMP1S = 'D_' ||&&COMPNY || '.FOC';
-SET &&COMP1A = 'A_' ||&&COMPNY || '.FOC';
-SET &&COMP1T = 'T_' ||&&COMPNY || '.FOC';

USE

D:\TNT\TTRACKER\DATA\&&COMP1S AS &&EXTRACT
D:\TNT\TTRACKER\DATA\&&COMP1A AS AIR_MAIN
D:\TNT\TTRACKER\DATA\&&COMP1T AS TKT_MAIN

  &&USE_ARLN
  &&USE_MILG
  &&USE_CCAT
  &&USE_AEMB
  &&USE_CEMB
  &&USE_ARTE
  &&USE_CRTE
  &&USE_ANDO
  &&USE_CNDO
  &&USE_ANDD
  &&USE_CNDD
  &&USE_VAIR
  &&USE_AH AS &&AH
  &&USE_AREF
  &&USE_TREF
  &&USE_NREF
  &&USE_CLNT
END

-STOP

SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

DEFINE FILE WR_50
  BASE_FARE/D12.2CS = SEG_AMT - SEG_COM;
  BOOK_DT/MDYY         = RESV_DATE;
  CARD_NUM/A12=EDIT(CREDIT_CARD, '$$999999999999$$$$');
  CARD1_NUM/A4=EDIT(CREDIT_CARD, '$$$$$$$$$$$$$$9999');
  CARD_NUM1/A16=EDIT(CREDIT_CARD,'$$9999999999999999');
  CCARD/A4 = EDIT(CREDIT_CARD, '$$9999$$$$$$$$$$$$');
  CCARD1/A4 =EDIT(CREDIT_CARD, '$$$$$$9999$$$$$$$$');
  CCARD2/A6 =EDIT(CREDIT_CARD, '$$999999$$$$$$$$$$');
  CCARD3/A6 =EDIT(CREDIT_CARD, '$$999999$$$$$$$$$$');
  CCARD5/A6 = EDIT(CREDIT_CARD, '$$$$$$$$$$$$999999');
  CCARD6/A6 = EDIT(CREDIT_CARD, '999999$$$$$$$$$$$$');
  CGC/A6 = EDIT(CREDIT_CARD, '999999$$$$$$$$$$$$');
  CGC1/A3 = EDIT(CREDIT_CARD, '$$$$$$$$$$$$$$$999');
  CGC2/A9 = 'XXXXXXXXX';
  CLASS_CAT/A8 = DECODE CL_CAT ('F' 'FIRST'     'C' 'COACH'
                              'D' 'DISCOUNT'  'B' 'BUSINESS'
                             ' ' 'OTHER');
  COM_AMTA/D12.2CS = COMM_AMT;
  COM_AMT/D12.2CS = SEG_COM;
  CRD_CRD/A2=EDIT(CREDIT_CARD, '99$$$$$$$$$$$$$$$');
  DEPT_MONTH/MT        = DPT_DATE;
  DEPT_YEAR/YY         = DPT_DATE;
  DIR_CP_CD/A50        = EMBARK||'-'||ROUTE;
-* DIR_CP_CD/A50        = CITYPAIR.EMBARK||'-'||CITYPAIR.ROUTE;
-****************************************************************************
-* 10/3/00  IBISTL-RJ    FIELD WAS BEING TRUNCATED IN FOCUS 6, NEED TO RUN A
-*                       SUBROUTINE IN WEBFOCUS TO TRUNCATE.
  DIR_CP_NMX/A72 = '(' || EMBARK || '/'
           || ROUTE || ') ' |
           EMB_APT.AIRPORT_NAME ||'---' || RTE_APT.AIRPORT_NAME;
  DIR_CP_NM/A50 = SUBSTR(72,DIR_CP_NMX,1,50,50,'A50');
-*
  FARE_PAID/D12.2CS   = SEG_AMT + SEG_TAX;
  FLVL1/A4 = EDIT(ICODEX,'9999$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
  GROSS_FARE/D12.2CS  = IF (RF_FLAG EQ ' ') AND
                           (EX_FLAG EQ ' ') THEN
                        SEG_AMT + SEG_TAX ELSE 0;
  IBOOK/A33 = IF DOD_TYPE EQ 'I' OR 'J' THEN 'ONLINE BOOKINGS' ELSE
    IF DOD_TYPE EQ 'M' OR 'X' THEN 'EXCHANGE FROM AN INTERNET BOOKING' ELSE
    IF DOD_TYPE EQ 'A' OR 'L' OR 'N' OR 'S' THEN 'WEB BOOKINGS' ELSE
    'TRADITIONAL BOOKINGS'; 
  MIR_TYPE/A24 = DECODE AUX_NON_MIR ('X' 'X-DUAL MIR'
                                    'N' 'N-NON-TICKETING MIR'
                                    'J' 'J-NON-FARING MIR'
                                    'A' 'A-NON-ACCOUNTING MIR'
                                    'B' 'B-ACCOUNTING MIR'
                                    'H' 'H-REGULAR TICKET MIR'
                                    'V' 'V-VOID'
                                    'E' 'E-ELECTRONIC TKT NETWORK'
                                    'L' 'L-ELECTRONIC TKT MIR'
                                    ' ' ' -MANUALLY ENTERED TRANS');
  MRK_TKT_CNT/D8CS    = IF (TICKET_CODE EQ '1') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND
                           (CONJ_REL EQ 1) THEN 1 ELSE
                        IF (TICKET_CODE EQ '1') AND
                           (EX_FLAG NE ' ') THEN (-1) ELSE
                        IF (TICKET_CODE EQ '1') AND
                           (RF_FLAG NE ' ') THEN (-1) ELSE 0;
  MTG_NUM/A7 = EDIT(LEVEL3, '$$$$$$$$9999999');
  LEVEL_DESC/A60 = 'AROLL_DSC1' ;
-*LEVEL_DESC/A60 = &&LDESC;
  ND_CITY_NM/A50= NDO_CTY.CITY_NAME | NDD_CTY.CITY_NAME;
  NET_TKT_CNT/D8CS    = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ 1) AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND
                           (CONJ_REL EQ 1) THEN 1 ELSE
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ 1) AND
                           (EX_FLAG EQ 'F') THEN (-1) ELSE
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ 1) AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
  NET_TKT_CNT1/D8CS   = IF (TICKET_CODE EQ '1') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND
                           (CONJ_REL EQ 1) THEN 1 ELSE
                        IF (TICKET_CODE EQ '1') AND
                           (EX_FLAG EQ 'F') THEN (-1) ELSE
                        IF (TICKET_CODE EQ '1') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
  NEW_ADV_PURCH/D9    = ADV_PURCH;
  NEW_SEG_AMT/D12.2CS = SEG_AMT;
  NEW_SEG_COUNT/D8CS = SEG_COUNT;
  NEW_SEG_DISC/D12.2CS = SEG_DISC;
  NEW_SEG_MILES/D9= SEG_MILES;
  NOREF_SEG_COUNT/D8CS = IF (RF_FLAG EQ ' ') AND
                            (EX_FLAG EQ ' ') THEN
                           NEW_SEG_COUNT ELSE 0;
  REF_E_CNT/D8CS      = IF (RF_FLAG NE ' ') OR
                           (EX_FLAG NE ' ') THEN
                            1 ELSE 0;
  REF_EXCH_CNT/D8CS   = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ 1) AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND
                           (CONJ_REL EQ 1) THEN 0 ELSE
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ 1) AND
                           (EX_FLAG EQ 'F') THEN 1 ELSE
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ 1) AND
                           (RF_FLAG EQ 'F') THEN 1 ELSE 0;
  REFEXCH/D12.2CS     = IF (RF_FLAG NE ' ') THEN
                        SEG_AMT + SEG_TAX ELSE
                        IF (EX_FLAG NE ' ') THEN
                        SEG_AMT + SEG_TAX ELSE 0;
  SAVINGS/D11.2CS     = SEG_STANDARD - FARE_PAID;
  TKT_AMOUNT/D12.2CS  = TICKET_AMT + TAX_AMT;
  TKT_PURCH/D8.2CS      = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ 1) AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND
                           (CONJ_REL EQ 1) THEN 1 ELSE 0;
  TKT_TYPE/A4          = IF (SEG_COUNT LE 0) AND
                          (RF_FLAG EQ 'P') THEN 'P-RF' ELSE
                        IF (SEG_COUNT LE 0) AND
                          (RF_FLAG EQ 'F') THEN 'F-RF' ELSE
                        IF (SEG_COUNT LE 0) AND
                          (EX_FLAG EQ 'P') THEN 'P-EX' ELSE
                        IF (SEG_COUNT LE 0) AND
                          (EX_FLAG EQ 'F') THEN 'F-EX' ELSE ' ';
  TRAN_MONTH/MT        = TRN_DATE;
  TRAN_MY/MTYY = TRN_DATE;
  UPCCR/A6 = EDIT(ICODEX,'999999$$$$$$$$$$');
  UPCOSTC/A1 = IF LEVEL1 EQ '0EM999' OR '0EM299' OR '0EM199' OR '0EM167' OR
  '0EM166' OR '0EM165' OR '0EM163' OR '0EM161' OR '0EM112' OR '0EM093' OR
  '0EM092' OR '0EM089' OR '0EM085' OR '0EM079' OR '0EM072' OR '0EM069' OR
  '0EM061' OR '0EM057' OR '0EM056' OR '0EM055' OR '0EM054' OR '0EM053' OR
  '0EM053' OR '0EM051' OR '0EM033' OR '0EM032' OR '0EM027' OR '0EM026' OR
  '0EM022' THEN 'Y' ELSE 'N';
  VALUA/A1 = IF (VAL_AIRLINE EQ 'UA') AND
                (FLIGHT GE '5000')    AND
                (FLIGHT LE '5499') THEN 'Y' ELSE
             IF (VAL_AIRLINE EQ 'UA') AND
                (FLIGHT GE '5500')    AND
                (FLIGHT LE '5899') THEN 'Y' ELSE
             IF (VAL_AIRLINE EQ 'UA') AND
                (FLIGHT GE '6800')    AND
                (FLIGHT LE '7019') THEN 'Y' ELSE
             IF (VAL_AIRLINE EQ 'UA') AND
                (FLIGHT GE '7020')    AND
                (FLIGHT LE '7149') THEN 'Y' ELSE
             IF (VAL_AIRLINE EQ 'UA') AND
                (FLIGHT GE '7150')    AND
                (FLIGHT LE '7899') THEN 'Y' ELSE
             IF (VAL_AIRLINE EQ 'UA') AND
                (FLIGHT GE '7900')    AND
                (FLIGHT LE '7899') THEN 'Y' ELSE 'N';
  XARR_DOW/W           = ARR_DATE;
  XARR_DT/MDYY         = ARR_DATE;
  XDPT_DOW/W           = DPT_DATE;
  XDPT_DT/MDYY         = DPT_DATE;
  XDPT_DATE/MDY        = DPT_DATE;
  XPSNGR_NM/A15        =
    EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
  XTKT_DT/MDYY         = TKT_DATE;
  XTRAN_DT/MDYY        = TRN_DATE;


-* ****DEFINES ON PREVIOUS DEFINES****

  ABOOK_CNT/D8CS = IF DOD_TYPE NE 'I' OR 'J' OR 'M' OR 'X' OR 
     'A' OR 'L' OR 'N' OR 'S' THEN NET_TKT_CNT ELSE 0;
  ABOOK_FARE/D12.2CS = IF DOD_TYPE NE 'I' OR 'J' OR 'M' OR 'X' OR 
     'A' OR 'L' OR 'N' OR 'S' THEN FARE_PAID ELSE 0;
  AIRLINE_FEE/D8.2CS = IF EMBARK EQ 'FP2' OR 'FP3'
     THEN FARE_PAID ELSE 0;
  ARR_DAY/A3           = DECODE XARR_DOW (1 'MON' 2 'TUE' 3 'WED'
                                 4 'THU' 5 'FRI' 6 'SAT' 7 'SUN');
  CGCARD/A18 = CGC||CGC2||CGC1;
  DECLINE_AMT/D12.2CS  = IF EMBARK EQ 'DT1' THEN 0 ELSE
                         TKT_AMOUNT - LOWEST_AMT;
  DISSAVINGS/D11.2CS  = IF EMBARK EQ 'DT1' THEN 0 ELSE
                         FARE_PAID - SEG_LOWEST;
  DPT_DAY/A3           = DECODE XDPT_DOW (1 'MON' 2 'TUE' 3 'WED'
                                 4 'THU' 5 'FRI' 6 'SAT' 7 'SUN');
  GROSS_DSAVE/D12.2CS = IF (RF_FLAG EQ ' ') AND
                           (EX_FLAG EQ ' ') THEN
                           DISSAVINGS ELSE 0;
  IBOOK_CNT/D8CS = IF DOD_TYPE EQ 'I' OR 'J' THEN NET_TKT_CNT ELSE 0;
  IEBOOK_CNT/D8CS = IF DOD_TYPE EQ 'M' OR 'X' THEN NET_TKT_CNT ELSE 0;
  IBOOK_FARE/D12.2CS = IF DOD_TYPE EQ 'I' OR 'J' THEN FARE_PAID ELSE 0;
  IEBOOK_FARE/D12.2CS = IF DOD_TYPE EQ 'M' OR 'X' THEN FARE_PAID ELSE 0;
  SIBOOK_CNT/D8CS = IF DOD_TYPE EQ 'A' OR 'L' OR 'N' OR 'S' THEN
                      NET_TKT_CNT ELSE 0;
  TRIPS/D8CS = IF STAY GT 0 THEN 1 ELSE
               IF STAY LT 0 THEN (-1) ELSE 0;


-*   AIBOOK_CNT/D8CS = ABOOK_CNT + IBOOK_CNT;
  AIBOOK_CNT/D8CS = NET_TKT_CNT - IEBOOK_CNT;


END
TABLEF FILE WR_50
PRINT
  ABOOK_CNT
  ABOOK_FARE
  AIBOOK_CNT
  AGENT_NUM
  AIR_KEY
  AIR_MAIN.INTL_DOM
  AIRLINE
  AIRLINE_FEE
  AIRLINE_NAME
  AR_BRANCH
  ARR_DAY
  ARR_TIME
  AUX_NON_MIR
  BASE_FARE
  BOOK_DT
  BR_CL_IDX
  CARD_NUM
  CARD_NUM1
  CARD1_NUM
  CCARD
  CCARD1
  CCARD2
  CCARD3
  CCARD5
  CCARD6
  CGCARD
  EMBARK      AS 'EMB_APT_CD'
  ROUTE       AS 'RTE_APT_CD'
  CL_CAT
  CLASS
  CLASS_CAT
  CLIENT_NAME
  CLIENT_NUM
  COM_AMTA
  COM_AMT
  CRD_CRD
  CREDIT_CARD
  DEPT_MONTH
  DEPT_YEAR
  DIR_CP_CD
  DIR_CP_NM
  DISSAVINGS
  DOC_TYPE
  DOD_PAX_CAT
  DPT_DAY
  DPT_TIME
  EMB_APT.AIRPORT_NAME AS 'EMB_APT_NM'
  EMB_APT.STATE_CODE   AS 'EMB_STATE'
  EMB_CTY.CITY_NAME    AS 'EMB_CTY_NM'
  EMB_CTY.COUNTRY_CODE AS 'EMB_CNTRY_CODE'
  EMB_CTY.EMB_CITY     AS 'EMB_CTY_CD'
  FARE_BAS
  FARE_PAID
  FLVL1
  FLIGHT
  GROSS_DSAVE
  GROSS_FARE
  GROUP_CODE
  IBOOK
  IBOOK_CNT
  IBOOK_FARE
  IEBOOK_CNT
  IEBOOK_FARE
  INT_CODE
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3
  MIR_TYPE
  MRK_TKT_CNT
  MTG_NUM
  ND_CITY_NM
  NET_TKT_CNT
  NET_TKT_CNT1
  NEW_ADV_PURCH
  NEW_SEG_AMT
  NEW_SEG_COUNT
  NEW_SEG_DISC
  NEW_SEG_MILES
  NOREF_SEG_COUNT
  ORG_DST
  PASSNGR_NAME
  PNR_LOCATOR
  REF_E_CNT
  REF_EXCH_CNT
  REFEXCH
  REFUSAL_DESC
  REFUSE_CODE
  REFUSE_KEY
  RTE_APT.AIRPORT_NAME AS 'RTE_APT_NM'
  RTE_CTY.CITY_NAME    AS 'RTE_CTY_NM'
  RTE_CTY.COUNTRY_CODE AS 'RTE_CNTRY_CODE'
  RTE_CTY.RTE_CITY     AS 'RTE_CTY_CD'
  SAVINGS
  SEG_AMT
  SEG_COM
  SEG_COUNT
  SEG_DESIG
  SEG_DISCOUNT
  SEG_LOWEST
  SEG_MILES
  SEG_NBR
  SEG_STANDARD
  SEG_TAX
  SIBOOK_CNT
  STAY
  TICKET_BRANCH
  TKT_AMOUNT
  TKT_DATE
  TKT_NUM
  TKT_PURCH
  TKT_SORT
  TKT_TYPE
  TOUR_CODE
  TRAN_MONTH
  TRAN_MY
  TRIPS
  TRIP_LENGTH
  TRIP_PURPOSE
  TRN_DATE
  UPCCR
  UPCOSTC
  VAL_AIRLINE
  VALUA
  VOID_DATE
  XARR_DT
  XDPT_DT
  XDPT_DATE
  XPSNGR_NM
  XTKT_DT
  XTRAN_DT
IF TRN_DATE GE 20020101
IF TRN_DATE LE 20020630

ON TABLE HOLD AS TEST1
END

ET ASNAMES=ON
TABLE FILE TEST1
SUM BASE_FARE 		AS 'TBASE'
    DISSAVINGS 		AS 'DTSAVE'
    TKT_AMOUNT 		AS 'TAMT'
    SEG_COM 		AS 'TSCOM'
    SEG_DISCOUNT 	AS 'TDISC'
    FARE_PAID 		AS 'TFARE'
    SEG_LOWEST 		AS 'TLOW'
    NEW_SEG_MILES 	AS 'TMILE'
    TKT_PURCH 		AS 'TPURCH'
    REF_EXCH_CNT 	AS 'TRFEX'
    SAVINGS 		AS 'TSAVE'
    SEG_AMT 		AS 'TSEG'
    SEG_STANDARD 	AS 'TSTD'
    SEG_TAX 		AS 'TTAX'
    NET_TKT_CNT 	AS 'TTKT'
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
ON TABLE HOLD AS AIRHOLD1 FORMAT FOCUS
END
-RUN

TABLE FILE TEST1
PRINT AIR_KEY
      AIRLINE
      AIRLINE_FEE
      AIRLINE_NAME
      ARR_DAY
      ARR_TIME
      BASE_FARE
      BOOK_DT
      BR_CL_IDX
      CARD_NUM1
      CCARD6
      CL_CAT
      CLASS
      CLASS_CAT
      CLIENT_NAME
      CLIENT_NUM
      CREDIT_CARD
      DEPT_MONTH
      DEPT_YEAR
      DIR_CP_CD
      DISSAVINGS
      DOD_PAX_CAT
      DPT_DAY
      DPT_TIME
      EMB_APT_CD
      EMB_APT_NM
      EMB_CNTRY_CODE
      EMB_CTY_NM
      EMB_STATE
      FARE_BAS
      FARE_PAID
      FLIGHT
      FLVL1
      GROUP_CODE
      IBOOK
      INT_CODE
      INTL_DOM
      INVOICE_NUM
      LEVEL1
      LEVEL2
      LEVEL3
      MIR_TYPE
      MRK_TKT_CNT
      MTG_NUM
      ND_CITY_NM
      NEW_ADV_PURCH
      NEW_SEG_AMT
      NEW_SEG_COUNT
      NEW_SEG_MILES
      ORG_DST
      PASSNGR_NAME
      PNR_LOCATOR
      REF_EXCH_CNT
      REFUSAL_DESC
      REFUSE_CODE
      RTE_APT_CD
      RTE_APT_NM
      RTE_CNTRY_CODE
      RTE_CTY_NM
      SAVINGS
      SEG_COUNT
      SEG_DESIG
      SEG_DISCOUNT
      SEG_LOWEST
      SEG_MILES
      SEG_STANDARD
      SIBOOK_CNT
      STAY
      TICKET_BRANCH
      TKT_AMOUNT
      TKT_DATE
      TKT_NUM
      TKT_TYPE
      TOUR_CODE
      TRAN_MY
      TRIP_LENGTH
      TRIPS
      TRIP_PURPOSE
      UPCCR
      UPCOSTC
      VAL_AIRLINE
      VALUA
      XARR_DT
      XDPT_DT
      XDPT_DATE
      XTKT_DT
      XTRAN_DT
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
BY SEG_NBR
ON TABLE HOLD AS XTWO FORMAT FOCUS
END
-RUN
-* JOIN CLEAR *

MATCH FILE XTWO
PRINT AIR_KEY
      AIRLINE
      AIRLINE_FEE
      AIRLINE_NAME
      ARR_DAY
      ARR_TIME
      BASE_FARE
      BOOK_DT
      BR_CL_IDX
      CARD_NUM1
      CCARD6
      CL_CAT
      CLASS
      CLASS_CAT
      CLIENT_NAME
      CLIENT_NUM
      CREDIT_CARD
      DEPT_MONTH
      DEPT_YEAR
      DIR_CP_CD
      DISSAVINGS
      DOD_PAX_CAT
      DPT_DAY
      DPT_TIME
      EMB_APT_CD
      EMB_APT_NM
      EMB_CNTRY_CODE
      EMB_CTY_NM
      EMB_STATE
      FARE_BAS
      FARE_PAID
      FLIGHT
      FLVL1
      GROUP_CODE
      IBOOK
      INT_CODE
      INTL_DOM
      INVOICE_NUM
      LEVEL1
      LEVEL2
      LEVEL3
      MIR_TYPE
      MRK_TKT_CNT
      MTG_NUM
      NEW_ADV_PURCH
      NEW_SEG_AMT
      NEW_SEG_COUNT
      NEW_SEG_MILES
      ND_CITY_NM
      ORG_DST
      PASSNGR_NAME
      PNR_LOCATOR
      REF_EXCH_CNT
      REFUSAL_DESC
      REFUSE_CODE
      RTE_APT_CD
      RTE_APT_NM
      RTE_CNTRY_CODE
      RTE_CTY_NM
      SAVINGS
      SEG_COUNT
      SEG_DESIG
      SEG_DISCOUNT
      SEG_LOWEST
      SEG_MILES
      SEG_STANDARD
      SIBOOK_CNT
      STAY
      TICKET_BRANCH
      TKT_AMOUNT
      TKT_DATE
      TKT_NUM
      TKT_TYPE
      TOUR_CODE
      TRAN_MY
      TRIP_LENGTH
      TRIPS
      TRIP_PURPOSE
      UPCCR
      UPCOSTC
      VAL_AIRLINE
      VALUA
      XARR_DT
      XDPT_DT
      XDPT_DATE
      XTKT_DT
      XTRAN_DT
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
BY SEG_NBR
ON TABLE HOLD
RUN
FILE AIRHOLD1
PRINT DTSAVE
      TAMT
      TBASE
      TDISC
      TFARE
      TLOW
      TMILE
      TPURCH
      TRFEX
      TSAVE
      TSCOM
      TSEG
      TSTD
      TTAX
      TTKT
BY LEVEL_DESC
BY XPSNGR_NM
BY TKT_SORT
BY TRN_DATE
AFTER MATCH HOLD AS AIRHOLD2 OLD-OR-NEW
END
-RUN

TABLE FILE AIRHOLD2
PRINT AIR_KEY
      AIRLINE
      AIRLINE_FEE
      AIRLINE_NAME
      ARR_DAY
      ARR_TIME
      BASE_FARE
      BOOK_DT
      BR_CL_IDX
      CARD_NUM1
      CCARD6
      CL_CAT
      CLASS
      CLASS_CAT
      CLIENT_NAME
      CLIENT_NUM
      CREDIT_CARD
      DEPT_MONTH
      DEPT_YEAR
      DIR_CP_CD
      DISSAVINGS
      DOD_PAX_CAT
      DPT_DAY
      DPT_TIME
      DTSAVE
      EMB_APT_CD
      EMB_APT_NM
      EMB_CNTRY_CODE
      EMB_CTY_NM
      EMB_STATE
      FARE_BAS
      FARE_PAID
      FLIGHT
      FLVL1
      GROUP_CODE
      IBOOK
      INT_CODE
      INTL_DOM
      INVOICE_NUM
      LEVEL_DESC
      LEVEL1
      LEVEL2
      LEVEL3
      MIR_TYPE
      MRK_TKT_CNT
      MTG_NUM
      NEW_ADV_PURCH
      NEW_SEG_AMT
      NEW_SEG_COUNT
      NEW_SEG_MILES
      ND_CITY_NM
      ORG_DST
      PASSNGR_NAME
      PNR_LOCATOR
      REF_EXCH_CNT
      REFUSAL_DESC
      REFUSE_CODE
      RTE_APT_CD
      RTE_APT_NM
      RTE_CNTRY_CODE
      RTE_CTY_NM
      SAVINGS
      SEG_COUNT
      SEG_DESIG
      SEG_DISCOUNT
      SEG_LOWEST
      SEG_MILES
      SEG_STANDARD
      SIBOOK_CNT
      STAY
      TAMT
      TBASE
      TDISC
      TFARE
      TICKET_BRANCH
      TKT_AMOUNT
      TKT_DATE
      TKT_NUM
      TKT_TYPE
      TLOW
      TMILE
      TOUR_CODE
      TPURCH
      TRAN_MY
      TRFEX
      TRIP_LENGTH
      TRIPS
      TRIP_PURPOSE
      TRN_DATE
      TSAVE
      TSCOM
      TSEG
      TSTD
      TTAX
      TTKT
      UPCCR
      UPCOSTC
      VAL_AIRLINE
      VALUA
      XARR_DT
      XDPT_DT
      XDPT_DATE
      XPSNGR_NM
      XTKT_DT
      XTRAN_DT
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD AS AIRHOLD3
END
-RUN
-NOW
DEFINE FILE AIRHOLD3
NEWTIME/I4 = EDIT(DPT_TIME);
STDTIME/I4 = IF NEWTIME LT 1259 THEN NEWTIME
ELSE (NEWTIME-1200);

HOURPART/A2 = EDIT(STDTIME,  '99$$');
MINPART/A2 = EDIT(STDTIME, '$$99');
STD1/A3 = ' am';
STD2/A3 = ' pm';
STD/A3 = IF NEWTIME GT 1200 THEN STD2 ELSE STD1;
HOUR2/A1 = EDIT(HOURPART, '9');
HOUR3/A2 = EDIT(HOURPART, '99');
HOUR4/A1 = ' ';
HOUR5/A1 = EDIT(HOURPART, '$9');

NEWCODE/A8 = IF STDTIME LT 1000 THEN HOUR4 | HOUR5 || ':' || MINPART || STD
ELSE HOUR3 || ':' || MINPART || STD;

TIME_DPT/A8 = IF DPT_TIME EQ ' ' THEN ' '
ELSE NEWCODE;
-*****************************************************************************
-**    				TIME_ARR 				   ***
-*****************************************************************************

NEWTIME1/I4 = EDIT(ARR_TIME);

STDTIME1/I4 = IF NEWTIME1 LT 1259 THEN NEWTIME1
ELSE (NEWTIME1-1200);

HOURPART1/A2 = EDIT(STDTIME1,  '99$$');
MINPART1/A2 = EDIT(STDTIME1, '$$99');
STD3/A3 = ' am';
STD4/A3 = ' pm';
STD5/A3 = IF NEWTIME1 GT 1200 THEN STD4 ELSE STD3;
HOUR6/A1 = EDIT(HOURPART1, '9');
HOUR7/A2 = EDIT(HOURPART1, '99');
HOUR8/A1 = ' ';
HOUR9/A1 = EDIT(HOURPART1, '$9');

NEWCODE1/A8 = IF STDTIME1 LT 1000 THEN HOUR8 | HOUR9 || ':' || MINPART1 || STD5
ELSE HOUR7 || ':' || MINPART1 || STD5;

TIME_ARR/A8 = IF ARR_TIME EQ ' ' THEN ' '
ELSE NEWCODE1;

CONV_AMT/D9.2CS = IF TKT_SORT NE LAST TKT_SORT THEN TDISC ELSE 0;
CPMILE/D12.2CS = FARE_PAID/SEG_MILES;
DPT_DTE/MDYY = IF TKT_NUM NE LAST TKT_NUM THEN XDPT_DATE ELSE ' ';
XCPMILE/D12.2CS = IF TKT_NUM NE LAST TKT_NUM THEN (FARE_PAID/SEG_MILES)
                  ELSE 0;
XINV_NUM/A7 = IF TKT_NUM NE LAST TKT_NUM THEN INVOICE_NUM ELSE ' ';
EMB_CTY/A15 = EDIT(EMB_CTY_NM, '999999999999999$$$$$$$$$$');
RTE_CTY/A15 = EDIT(RTE_CTY_NM, '999999999999999$$$$$$$$$$');
INT_CODEX/A36 = IF TKT_NUM NE LAST TKT_NUM THEN INT_CODE ELSE ' ';
LEV_1/A15 = IF TKT_NUM NE LAST TKT_NUM THEN LEVEL1 ELSE ' ';
LEV_2/A15 = IF TKT_NUM NE LAST TKT_NUM THEN LEVEL2 ELSE ' ';
LEV_3/A15 = IF TKT_NUM NE LAST TKT_NUM THEN LEVEL3 ELSE ' ';
LOST_SAV_AMT/D9.2CS = IF TKT_SORT NE LAST TKT_SORT THEN DTSAVE ELSE 0;
LOW_AMT/D10.2CS = IF TKT_SORT NE LAST TKT_SORT THEN TLOW ELSE 0;
MRK_CNT/D8CS = IF TKT_NUM NE LAST TKT_NUM THEN MRK_TKT_CNT ELSE 0;
NET_TKT_CNT/D9S = IF (SEG_NBR EQ 1) THEN  TTKT ELSE 0;
PASNGR_NAME/A15 = IF TKT_NUM NE LAST TKT_NUM THEN XPSNGR_NM ELSE ' ';
REASON_CD/A2 =  IF TKT_NUM NE LAST TKT_NUM THEN REFUSE_CODE ELSE ' ';
RREFUSE_CODE/A2 = IF TKT_SORT NE LAST TKT_SORT THEN REFUSE_CODE ELSE ' ';
XREFUSAL_DESC/A40 = IF TKT_SORT NE LAST TKT_SORT THEN REFUSAL_DESC ELSE ' ';
SEG_AMT/D9.2CS = IF TKT_SORT NE LAST TKT_SORT THEN TSEG ELSE 0;
SEG_TAX/D9.2CS = IF TKT_SORT NE LAST TKT_SORT THEN TTAX ELSE 0;
STD_FARE/D12.2CS = IF TKT_SORT NE LAST TKT_SORT THEN TSTD ELSE 0;
TICKET_NMBR/A10 = IF TKT_NUM NE LAST TKT_NUM THEN TKT_NUM ELSE ' ';
TOTAL_MILES/D8CS = IF TKT_SORT NE LAST TKT_SORT THEN TMILE ELSE 0;
XBOOK_DT/MDYY = IF TKT_NUM NE LAST TKT_NUM THEN BOOK_DT ELSE 0;
XMTG_NUM/A7 = IF TKT_NUM NE LAST TKT_NUM THEN MTG_NUM ELSE ' ';
XT_DTE/A8 = EDIT(TRN_DATE);
XTKT_SRT/A10 = EDIT(TKT_SORT,'9999999999$');
XTRAN_DTE/MDYY = IF TKT_NUM NE LAST TKT_NUM THEN XTRAN_DT ELSE 0;
PNR_LOC/A6 = IF TKT_NUM NE LAST TKT_NUM THEN PNR_LOCATOR ELSE ' ';
-******************************************************************
-*  9/21/00  IBISTL-RJ    DEFINED AS AN 'A2', SHOULD BE 'A3'
XVAL_ALN/A3 = IF TKT_NUM NE LAST TKT_NUM THEN VAL_AIRLINE ELSE ' ';
TRAN_MONTH/MT = TRN_DATE;


-* ****DEFINES ON PREVIOUS DEFINES****
SRT_DT/A100 = TKT_SORT||XT_DTE||LEVEL_DESC||XPSNGR_NM;
FARE_AMT/D12.2CS = IF SRT_DT NE LAST SRT_DT THEN TFARE ELSE 0;
BASE_AMT/D12.2CS = IF SRT_DT NE LAST SRT_DT THEN TBASE ELSE 0;
COM_AMT/D12.2CS = IF SRT_DT NE LAST SRT_DT THEN TSCOM ELSE 0;
FARE/D12.2CS = IF (EMB_APT_CD EQ 'FP2' OR 'EX1' OR 'RF1' OR 'EX5') THEN 0
ELSE FARE_AMT;
MILES/D8CS = IF (EMB_APT_CD EQ 'FP2' OR 'EX1' OR 'RF1' OR 'EX5') THEN 0
  ELSE IF (TKT_TYPE EQ 'P-RF' OR 'P-EX') THEN 0
  ELSE IF (SEG_NBR EQ 0) THEN 0
  ELSE IF (TKT_SORT NE LAST TKT_SORT) AND (FARE_AMT GT 0) THEN TMILE
  ELSE IF (TKT_SORT NE LAST TKT_SORT) AND (FARE_AMT LT 0)
  THEN TMILE * (-1) ELSE 0;
AMILES/D12.2CS = IF MILES EQ 0 THEN 0 ELSE FARE_AMT;
RADV_PURCH/I8CS = IF (EMB_APT_CD EQ 'FP2' OR 'EX1' OR 'RF1' OR 'EX5') THEN 0
  ELSE IF (TKT_TYPE EQ 'P-RF' OR 'P-EX') THEN 0
  ELSE IF (SEG_NBR EQ 0) THEN 0
  ELSE IF (TKT_SORT NE LAST TKT_SORT) AND (FARE_AMT GT 0) THEN NEW_ADV_PURCH
  ELSE IF (TKT_SORT NE LAST TKT_SORT) AND (FARE_AMT LT 0)
  THEN NEW_ADV_PURCH * (-1) ELSE 0;
SAVE_AMT/D10.2CS = IF SRT_DT NE LAST SRT_DT THEN TSAVE ELSE 0;
TK_AMT/D12.2CS = IF SRT_DT NE LAST SRT_DT THEN TAMT ELSE 0;
XSEG_AMT/D12.2CS = IF SRT_DT NE LAST SRT_DT THEN TSEG ELSE 0;
XTRP_LEN/I3CS = IF SRT_DT NE LAST SRT_DT THEN TRIP_LENGTH * TTKT ELSE 0;
-* FOR PRINCIPAL INTERNATIONAL DESTINATION TRAVEL
PPAXTRP/D8C = IF (SEG_AMT LT 0) THEN (-1) ELSE 1;
PTRPLEN/D8C = IF (SEG_AMT LT 0) THEN (TRIP_LENGTH*(-1)) ELSE TRIP_LENGTH;
XMILES/D8CS = IF SRT_DT NE LAST SRT_DT THEN TMILE ELSE 0;
NOWTOD/A8 WITH TKT_SORT = HHMMSS (NOWTOD);
END

TABLE FILE AIRHOLD3
PRINT REFUSE_CODE AS 'REASON, CODE'
      XDPT_DT     AS 'DEPART, DATE'
	  DPT_TIME    AS 'TIME'
	  EMB_CTY_NM  AS 'ORG'
	  RTE_CTY_NM  AS 'DST'
	  AIRLINE     AS 'CR'
	  CLASS       AS 'CLASS'
	  FARE_AMT    AS 'FARE,PAID'
	  NET_TKT_CNT AS 'TKT,CNT'
BY XPSNGR_NM      AS 'PASSENGER NAME'
BY XTKT_SRT NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR  NOPRINT
BY TRN_DATE NOPRINT
BY XDPT_DT  NOPRINT
BY DPT_TIME NOPRINT
BY TICKET_NMBR    AS 'TICKET,NUMBER'
BY TKT_TYPE       AS 'TKT,TYPE'
WHERE RECORDLIMIT EQ 500
ON TABLE COLUMN-TOTAL
ON XTKT_SRT SKIP-LINE
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000,
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FOCEXEC=NONE, FONT=TIMES NEW ROMAN, SIZE=7, BACKCOLOR=NONE,
STYLE=NORMAL, $
TYPE=HEADING, OBJECT=TEXT, SIZE=8, COLOR=BLACK, $
TYPE=HEADING, LINE=4, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=8, STYLE=BOLD, $
ENDSTYLE
END
