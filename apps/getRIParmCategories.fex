-*getRIParmCategories.fex
-* 03/05/2014 LS - added staple-r and ameres-r for gloable data requested by Deb
-* 03/06/2014 LS - removed staple-r and ameres-r from gloable data requested by Deb
-* 05/20/2014 LS - added CIT-R into global group.
-* 05/21/14 LS added MANI-R SKECH-R GLOFO-R CSPORT-R into global group
-* 07/07/2014 LS Added CH2M-R into global group
-* 09/15/2014 LS Added UTC-R into global group
-* 09/18/2014  LS added PHYSCO-R AND CURT-R to global group
-* 09/25/2014 LS setup all global accounts to include global data in Global Reports.
-* 07/27/15 - DEB - S-10299 COMMENTED OUT SET &ECHO=ALL

-*-SET &ECHO=ALL;
-SET &SPC='&' | 'nbsp;';
-DEFAULT &nbr = 0;
-DEFAULT &1 = 'ABCD-R';
-DEFAULT &2 = 'Y';

TABLE FILE GLOBALEXCL
PRINT *
WHERE ROLLUP_CODE EQ '&1.EVAL'
ON TABLE HOLD
END
-RUN

-SET &GetGlobal = IF &LINES EQ 0 THEN 'Y' ELSE IF &LINES NE 0 AND '&2.EVAL' EQ 'Y' THEN 'Y' ELSE 'N';

TABLE FILE CLIENT 
BY CATEGORY 
WHERE ROLLUP_CODE EQ '&1.EVAL'

-*-IF '&1.EVAL' EQ 'KIEWIT-R' OR '&1.EVAL' EQ 'CERN-R' OR '&1.EVAL' EQ 'HROM-R' OR '&1.EVAL' EQ 'WOODW-R' OR '&1.EVAL' EQ 'ITRON-R' OR '&1.EVAL' EQ 'UPI-R' OR '&1.EVAL' EQ 'PETS-R' OR '&1.EVAL' EQ 'BLV-R' OR '&1.EVAL' EQ 'BING-R' OR '&1.EVAL' EQ 'CIT-R' OR '&1.EVAL' EQ 'MANI-R' OR '&1.EVAL' EQ 'SKECH-R' OR '&1.EVAL' EQ 'GLOFO-R' OR '&1.EVAL' EQ 'CSPORT-R' OR '&1.EVAL' EQ 'CH2M-R' OR '&1.EVAL' EQ 'UTC-R' OR '&1.EVAL' EQ 'PHYSCO-R' OR '&1.EVAL' EQ 'CURT-R' 
-*- THEN GOTO INCLGLOBAL;

-IF &GetGlobal EQ 'Y' THEN GOTO INCLGLOBAL; 
WHERE CATEGORY NE 'GLOBAL' OR ' '
-INCLGLOBAL
ON TABLE HOLD AS HOLDCAT
END
-RUN

 
DEFINE FILE HOLDCAT
CNT/I5 = CNT + 1;
IMD/I5 = IMOD(CNT, 2, IMD);
OPTS/A200=IF IMD NE 0 THEN '<option>' || CATEGORY 
  ELSE '<option style="background-color:#dcdcdc;">' || CATEGORY ;
END

TABLE FILE HOLDCAT
PRINT OPTS
ON TABLE SET HOLDLIST PRINTONLY
ON TABLE HOLD AS HLDCATG
END
-RUN

-HTMLFORM BEGIN
<html>
<head>Select Categories
<script>
function moveItems() {
 from=document.category.category;
 //var nbr = &nbrSelected;
  
 for (i=0; i<from.options.length;i++) {
     if (from.options[i].selected) { 
         txt = from.options[i].text;  
         window.opener.pasteCategory(txt);
         //nbr++; 
         //if (nbr > 25) { alert("A maximum of 25 Categories can be selected.\nOnly the first 25 will be selected."); break;}
         //else {txt = from.options[i].text;  window.opener.pasteCategory(txt);  }
     }
 }
 window.close();
}
 
</script>
</head>
<body >
<form name="category">
<table border=0>
<tr>
<td>
<select name="category" size="5" multiple>
!IBI.FIL.HLDCATG;
</select>
</td>
</tr>
<tr>
<td>&SPC</td>
</tr>
<tr>
<td>
<input type="button" value="  OK  " onclick="moveItems();">&SPC &SPC
<input type="button" value="Close" onclick="window.close();">
</td>
</tr>
</table>
</form>
</body>
</html>
-HTMLFORM END
