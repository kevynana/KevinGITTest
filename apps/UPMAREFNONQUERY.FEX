
USE
D:\TNT\TTRACKER\DATA\A5UPTTL.FOC AS AYUPTTL
D:\TNT\TTRACKER\DATA\A6UPTTL.FOC AS AYUPTTL
D:\TNT\TTRACKER\DATA\A7UPTTL.FOC AS AYUPTTL
D:\TNT\TTRACKER\DATA\A8UPTTL.FOC AS AYUPTTL
D:\TNT\TTRACKER\DATA\A9UPTTL.FOC AS AYUPTTL
D:\TNT\TTRACKER\DATA\A0UPTTL.FOC AS AYUPTTL
D:\TNT\TTRACKER\DATA\AYUPTTL.FOC AS AYUPTTL
D:\TNT\TTRACKER\DATA\S5UPTTL.FOC AS SYUPTTL
D:\TNT\TTRACKER\DATA\S6UPTTL.FOC AS SYUPTTL
D:\TNT\TTRACKER\DATA\S7UPTTL.FOC AS SYUPTTL
D:\TNT\TTRACKER\DATA\S8UPTTL.FOC AS SYUPTTL
D:\TNT\TTRACKER\DATA\S9UPTTL.FOC AS SYUPTTL
D:\TNT\TTRACKER\DATA\S0UPTTL.FOC AS SYUPTTL
D:\TNT\TTRACKER\DATA\SYUPTTL.FOC AS SYUPTTL
END

JOIN AIR_KEY IN AYUPTTL TO ALL AIR_KEY IN SYUPTTL AS J1
-RUN

DEFINE FILE AYUPTTL
FARE_PAID/D12.2CS   = SEG_AMT + SEG_TAX;
NET_TKT_CNT/D8CS  = IF (TICKET_CODE EQ '1') AND
                       (SEG_NBR EQ '01') AND
                       (FARE_PAID GE 0) AND
                       (SEG_COUNT EQ 1) AND 
                       (CONJ_REL EQ 1) THEN 1 ELSE 
                    IF (TICKET_CODE EQ '1') AND
                       (SEG_NBR EQ '01') AND 
                       (EX_FLAG EQ 'F') THEN (-1) ELSE 
                    IF (TICKET_CODE EQ '1') AND
                       (SEG_NBR EQ '01') AND
                       (RF_FLAG EQ 'F') THEN (-1) ELSE 0;                      
END

TABLE FILE AYUPTTL
SUM TKT_NUM TKT_DATE TRN_DATE NONREF_FLAG 
RF_FLAG NET_TKT_CNT FARE_PAID
BY AROLL_LEV2
BY TKT_NUM NOPRINT
BY TKT_DATE NOPRINT
BY TRN_DATE NOPRINT
BY NONREF_FLAG NOPRINT
WHERE AROLL_LEV2 EQ 'UPMA'
WHERE TKT_DATE GE '20080101'
WHERE TKT_DATE LE '20081231'
WHERE RF_FLAG NE ' '
ON TABLE COLUMN-TOTAL
ON TABLE SET ONLINE-FMT EXL2K
END



