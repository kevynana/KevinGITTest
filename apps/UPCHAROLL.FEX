SET ASNAMES = ON
FILEDEF CHTEST DISK D:\TNT\TTRACKER\TEMP\CHTEST.TXT

-* QUARTER 9
DEFINE FILE S9CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE S9CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE S9CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE S9CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE S9CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE S9CH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE D9CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE D9CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE D9CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE D9CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE D9CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE D9CH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE M9CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE M9CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE M9CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE M9CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE M9CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE M9CH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE C9CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE C9CH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE C9CH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE C9CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE C9CH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE C9CH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE H9CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE H9CH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE H9CH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE H9CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE H9CH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE H9CH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER 0

 
DEFINE FILE S0CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE S0CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE S0CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE S0CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE S0CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE S0CH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE D0CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE D0CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE D0CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE D0CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE D0CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE D0CH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE M0CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE M0CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE M0CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE M0CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE M0CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE M0CH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE C0CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE C0CH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE C0CH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE C0CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE C0CH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE C0CH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE H0CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE H0CH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE H0CH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE H0CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE H0CH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE H0CH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER 2

 
DEFINE FILE S1CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE S1CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE S1CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE S1CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE S1CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE S1CH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE D1CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE D1CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE D1CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE D1CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE D1CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE D1CH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE M1CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE M1CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE M1CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE M1CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE M1CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE M1CH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE C1CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE C1CH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE C1CH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE C1CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE C1CH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE C1CH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE H1CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE H1CH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE H1CH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE H1CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE H1CH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE H1CH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER 2
 
DEFINE FILE S2CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE S2CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE S2CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE S2CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE S2CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE S2CH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE D2CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE D2CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE D2CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE D2CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE D2CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE D2CH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE M2CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE M2CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE M2CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE M2CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE M2CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE M2CH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE C2CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE C2CH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE C2CH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE C2CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE C2CH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE C2CH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE H2CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE H2CH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE H2CH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE H2CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE H2CH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE H2CH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER 3
 
DEFINE FILE S3CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE S3CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE S3CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE S3CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE S3CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE S3CH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE D3CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE D3CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE D3CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE D3CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE D3CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE D3CH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE M3CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE M3CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE M3CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE M3CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE M3CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE M3CH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE C3CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE C3CH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE C3CH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE C3CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE C3CH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE C3CH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE H3CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE H3CH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE H3CH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE H3CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE H3CH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE H3CH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER 4
 
DEFINE FILE S4CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE S4CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE S4CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE S4CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE S4CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE S4CH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE D4CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE D4CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE D4CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE D4CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE D4CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE D4CH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE M4CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE M4CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE M4CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE M4CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE M4CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE M4CH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE C4CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE C4CH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE C4CH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE C4CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE C4CH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE C4CH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE H4CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE H4CH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE H4CH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE H4CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE H4CH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE H4CH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER 5

 
DEFINE FILE S5CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE S5CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE S5CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE S5CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE S5CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE S5CH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE D5CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE D5CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE D5CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE D5CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE D5CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE D5CH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE M5CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE M5CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE M5CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE M5CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE M5CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE M5CH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE C5CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE C5CH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE C5CH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE C5CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE C5CH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE C5CH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE H5CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE H5CH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE H5CH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE H5CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE H5CH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE H5CH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER 6
 
DEFINE FILE S6CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE S6CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE S6CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE S6CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE S6CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE S6CH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE D6CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE D6CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE D6CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE D6CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE D6CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE D6CH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE M6CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE M6CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE M6CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE M6CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE M6CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE M6CH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE C6CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE C6CH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE C6CH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE C6CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE C6CH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE C6CH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE H6CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE H6CH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE H6CH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE H6CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE H6CH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE H6CH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER 7
 
DEFINE FILE S7CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE S7CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE S7CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE S7CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE S7CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE S7CH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE D7CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE D7CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE D7CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE D7CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE D7CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE D7CH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE M7CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE M7CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE M7CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE M7CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE M7CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE M7CH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE C7CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE C7CH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE C7CH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE C7CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE C7CH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE C7CH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE H7CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE H7CH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE H7CH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE H7CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE H7CH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE H7CH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER 8
 
DEFINE FILE S8CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE S8CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE S8CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE S8CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE S8CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE S8CH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE D8CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE D8CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE D8CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE D8CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE D8CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE D8CH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE M8CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE M8CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE M8CH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE M8CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE M8CH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE M8CH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE C8CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE C8CH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE C8CH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE C8CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE C8CH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE C8CH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE H8CH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE H8CH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE H8CH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE H8CH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE H8CH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE H8CH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER Y
 
DEFINE FILE SYCH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE SYCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE SYCH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE SYCH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE SYCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE SYCH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE DYCH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE DYCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE DYCH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE DYCH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE DYCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE DYCH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE MYCH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE MYCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE MYCH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE MYCH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE MYCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE MYCH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE CYCH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE CYCH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE CYCH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE CYCH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE CYCH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE CYCH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE HYCH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE HYCH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE HYCH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE HYCH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE HYCH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE HYCH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


-* QUARTER Z
 
DEFINE FILE SZCH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE SZCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE SZCH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE SZCH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE SZCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS SHOLD
END
-RUN




MODIFY FILE SZCH2M
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN






DEFINE FILE DZCH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE DZCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE DZCH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE DZCH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE DZCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS DHOLD
END
-RUN




MODIFY FILE DZCH2M
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

-* 

DEFINE FILE MZCH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE MZCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD
END
-RUN


MODIFY FILE MZCH2M
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


DEFINE FILE MZCH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE MZCH2M
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS MHOLD
END
-RUN




MODIFY FILE MZCH2M
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

-*CAR

DEFINE FILE CZCH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE CZCH2M
PRINT CAR_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE CZCH2M
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


DEFINE FILE CZCH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE CZCH2M
PRINT CAR_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY CAR_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS CHOLD2
END
-RUN




MODIFY FILE CZCH2M
FIXFORM FROM CHOLD2
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON CHOLD2
END
-RUN



-* HOTEL

DEFINE FILE HZCH2M
NEW_AROLL4/A2 = EDIT(AROLL_LEV4, '$$$99');
ARL4_LEN/I2 = ARGLEN(15, AROLL_LEV4, 'I2');
TEST/A2 = IF NEW_AROLL4 NE 'AD' OR 'BP' OR 'CE' OR 'CI' OR 'CP' OR 'DC' OR 'EE' OR 'EI' OR
                           'EG' OR 'EL' OR 'EN' OR 'GF' OR 'GM' OR 'IA' OR 'ID' OR 'IS' OR 
                           'LG' OR 'NU' OR 'OL' OR 'OM' OR 'PH' OR 'PS' OR 'PW' OR 'RS' OR
                           'SV' OR 'TL' OR 'TR' OR 'TS' OR 'WT' OR 'ZZ' THEN '00' ELSE
                           NEW_AROLL4;
NW_AROLL4/A15 = TEST;                           
END
TABLE FILE HZCH2M
PRINT HTL_KEY AROLL_LEV4 NW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE NOT AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE HZCH2M
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


DEFINE FILE HZCH2M
NEW_AROLL4/A15 = IF AROLL_LEV4 EQ 'CANDEF' THEN 'CAN' ELSE
                 IF AROLL_LEV4 EQ 'CCIINTERVIEW' OR 'CCICONTRACT' OR 'CCIDEF' OR 'CCIGUEST' THEN 'CCI' ELSE
                 IF AROLL_LEV4 EQ 'CHGCONTRACT' OR 'CHGDEF' OR 'CHGGUEST' OR 'CHGINTERVIEW' THEN 'CHGCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'CHILCONTRACT' OR 'CHILDEF' OR 'CHILGUEST' OR 'CHILINTERVIEW' THEN 'CHIL' ELSE
                 IF AROLL_LEV4 EQ 'CHREINTERVIEW' OR 'CHREGUEST' OR 'CHRECONTRACT' OR 'CHREDEF' THEN 'CHRE' ELSE
                 IF AROLL_LEV4 EQ 'CWICONTRACT' OR 'CWIDEF' OR 'CWIGUEST' OR 'CWIINTERVIEW' THEN 'CWI' ELSE
                 IF AROLL_LEV4 EQ 'HANDEF' THEN 'HANCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'IDCCONTRACT' OR 'IDCDEF' OR 'IDCGUEST' OR 'IDCINTERVIEW' THEN 'IDC' ELSE
                 IF AROLL_LEV4 EQ 'INCINTERVIEW' OR 'CH2CONTRACT' OR 'CH2GUEST' OR 'CH2INTERVIEW' OR 'INCCONTRACT' OR 
                                  'INCDEF' OR 'INCGUEST' THEN 'INC' ELSE
                 IF AROLL_LEV4 EQ 'KHCDEF' THEN 'KHCCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LGCONTRACT' OR 'LGGUEST' OR 'LGICONTRACT' OR 'LGIDEF' OR 'LGIGUEST' OR 
                                  'LGIINTERVIEW' OR 'LGINTERVIEW' THEN 'LGI' ELSE
                 IF AROLL_LEV4 EQ 'LGIHBU' THEN 'LGICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'LTDCONTRACT' OR 'LTDDEF' OR 'LTDGUEST' OR 'LTDINTERVIEW' THEN 'LTD' ELSE
                 IF AROLL_LEV4 EQ 'MMSGUEST' OR 'MMSINTERVIEW' OR 'MMSCONTRACT' OR 'MMSDEF' THEN 'MMSCOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'OMICONTRACT' OR 'OMIDEF' OR 'OMIGUEST' OR 'OMIINTERVIEW' THEN 'OMI' ELSE
                 IF AROLL_LEV4 EQ 'OMIHBU' THEN 'OMICOMPANY' ELSE
                 IF AROLL_LEV4 EQ 'VECOCONTRACT' OR 'VECOGUEST' OR 'VECOINTERVIEW' THEN 'VECO' ELSE AROLL_LEV4;
END
TABLE FILE HZCH2M
PRINT HTL_KEY NEW_AROLL4 AS 'AROLL_LEV4' AROLL_LEV4 AS 'AROLL_LEV5'
BY HTL_KEY NOPRINT
WHERE AROLL_LEV4 IN FILE CHTEST
ON TABLE HOLD AS HHOLD2
END
-RUN




MODIFY FILE HZCH2M
FIXFORM FROM HHOLD2
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON NOMATCH REJECT
DATA ON HHOLD2
END
-RUN


 