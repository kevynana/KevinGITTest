-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* CHANGED TITLE OF 0-6 AND 7-13 TO INCLUDE ADV PURCHASE DAYS PER PATTI 
-* DEB 1/13/05
-* 9/22/14 Updated to use exclude flags in % - JK
-*01/19/16 - JEM - S-13286 Updated to allow reports to sort/subtotal by id-levels
-* 06/27/2017 - RSB - S-36530 Report stream to be updated with standard footer
-* 09/13/2017 CA S-38044 Place the footer datetime stamp text in a separate file to be -INCLUDED in the stylesheets
-*                       Backed out changes for S-36530 
-*
-*
-INCLUDE SETECHO
SET ASNAMES=ON

-GOTO JOY;

-SET &&RPTSUF = 'NONCOMPLIANCE';
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99$$');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99$$');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');

-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99$$');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99$$');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');



-INCLUDE FDEFRPTS
-RUN


JOIN ABNONHLD.LEVEL_DESC IN ABNONHLD TO ABNONHTL.LEVEL_DESC IN ABNONHTL AS J1
END
JOIN ABNONHLD.LEVEL_DESC IN ABNONHLD TO ABNONCAR.LEVEL_DESC IN ABNONCAR AS J2
-RUN


DEFINE FILE ABNONHLD
NOWTOD/A8 WITH NET_TKT_CNT = HHMMSS (NOWTOD);
BLANK/A1 = ' ';
END
-RUN
-IF &&CURRENCY EQ 'USD' THEN GOTO NEXT;

-SET &&SUBHEAD = <NAMEC;

-NEXT;


TABLE FILE ABNONHLD
-INCLUDE GHEADAIR
SUM MXADV_TKT AS 'DAY ADVANCE PURCHASE 0-6 TICKETS'
COMPUTE 
MXADVP/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXADV_TKT/NET_TKT_CNT)*100); AS '% OF 0-6 TICKETS'
MXADV_TKT1 AS 'DAY ADVANCE PURCHASE 7-13 TICKETS'
COMPUTE 
MXADVP1/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXADV_TKT1/NET_TKT_CNT)*100); AS '% OF 7-13 TICKETS'
REFUNDABLE AS 'REFUNDABLE TICKETS'
COMPUTE 
REFP/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                ((REFUNDABLE/NET_TKT_CNT)*100); AS '% OF REFUNDABLE TICKETS'
MXTRA_TKT AS 'TRADITIONAL TICKETS'
COMPUTE
MXTRAP/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXTRA_TKT/NET_TKT_CNT)*100); AS '% OF TRADITIONAL TICKETS'
LS100 AS 'LOST SAVINGS $100-$200 TICKETS'
COMPUTE
LS100P/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((LS100/NET_TKT_CNT)*100); AS
                  '% OF TICKETS WITH LOST SAVINGS $100-$200'
LS201 AS 'LOST SAVINGS $201-$300 TICKETS
COMPUTE 
LS201P/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((LS201/NET_TKT_CNT)*100); AS
                  '% OF TICKETS WITH LOST SAVINGS $201-$300'
LS301 AS 'LOST SAVINGS $301+'
COMPUTE 
LS301P/P12CS = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((LS301/NET_TKT_CNT)*100); AS
                  '% OF TICKETS WITH LOST SAVINGS $301+'
TOTAL_ROOM AS 'NUMBER OF ROOMS GREATER THAN $150'
COMPUTE HAVG/P12CS = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        ((TOTAL_ROOM/NNROOMS)*100); 
                        AS '% OF ROOMS GREATER THAN $150'
TOTAL_NON AS 'NUMBER OF NON-PREFERRED ROOMS'
COMPUTE
HNONP/P12CS = IF ((NNROOMS3 LT 1) AND (NNROOMS3 GT (-1))) THEN 0 ELSE
                 ((TOTAL_NON1/NNROOMS3)*100); 
                 AS '% OF NON-PREFERRED ROOMS'
NOMIDBK AS 'NUMBER OF BOOKINGS LARGER THAN MIDSIZE'
COMPUTE 
NOMIDP/P12CS = IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                  ((NOMIDBK/BOOKINGS)*100);
                  AS '% OF CARS LARGER THAN MIDSIZE'

BY LEVEL_DESC AS ' '
ON TABLE SET PAGE-NUM OFF
ON LEVEL_DESC RECOMPUTE MULTILINES AS 'TOTAL FOR'
-*
-INCLUDE FOOTERDT
-*
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *
TYPE=DATA, COLUMN=N2, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABADV' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N4, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABADV1' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N6, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABREF' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $


TYPE=DATA, COLUMN=N8, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABTRA' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N10, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABLS1' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N12, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABLS2' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N14, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABLS3' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N16, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRAB150' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N18, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABNONP' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLUMN=N20, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABMID' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=7, BACKCOLOR=NONE, STYLE=NORMAL, $
-* TYPE=HEADING, OBJECT=TEXT, SIZE=8, COLOR=BLACK, $
TYPE=HEADING, LINE=4, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=13, SIZE=10, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=8, STYLE=BOLD, $
TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(&&TNTDTPOS), SIZE=(&&TNTDTSIZ), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLDTPOS), SIZE=(&&ROLDTSIZ), $
-*
-*TYPE=FOOTING, LINE=4, STYLE=BOLD,POSITION=(&FTR_DATEPOS),$ 
-*
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
-*
END
-RUN

-JOY;


-INCLUDE SETECHO

SET ASNAMES=ON

-SET &&RPTSUF = 'NONCOMPLIANCE';
-SET &&RPTSUF = 'NONCOMPLIANCE';
-SET &FMM=EDIT(&&FROMDT,'$$$$$99$$');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'9999');
-SET &TOM=EDIT(&&TODT,'$$$$$99$$');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'9999');

-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$99$$');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$99$$');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'9999');
-INCLUDE FDEFRPTS
-RUN


JOIN ABNONHLD.LEVEL_DESC IN ABNONHLD TO ABNONHTL.LEVEL_DESC IN ABNONHTL AS J1
-RUN
JOIN ABNONHLD.LEVEL_DESC IN ABNONHLD TO ABNONCAR.LEVEL_DESC IN ABNONCAR AS J2
-RUN
JOIN ROLL WITH LEVEL_DESC IN ABNONHLD TO ROLLUP_CODE IN ROLLUP AS J3
-RUN


DEFINE FILE ABNONHLD
NOWTOD/A8 WITH NET_TKT_CNT = HHMMSS (NOWTOD);
BLANK/A1 = ' ';
BLANK1/A1 = '|';
ROLL/A8='&&ROLLUP.EVAL';
LVL/A60='&&LVL_DSC.EVAL';
RPHONE/A15=EDIT(ROLL_PHONE,'9-999-999-9999');
RD/A10 = 'Run Date:';
RT/A10 = 'Run Time:';  
LEV/A25 = EDIT(LEVEL_DESC, '9999999999999999999999999');
RN/A60=TRIM('B', '&&RPT_TTL1.EVAL', 60, ' ', 1, 'A60');
RN1/A60=TRIM('B', '&&RPT_TTL2.EVAL', 60, ' ', 1, 'A60');
TDATE1/A8MDYY='&MDYY';
TDATE2/A10=EDIT(TDATE1,'99/99/9999');
TIME1/A8=HHMMSS('A8');
TIME2/A8=EDIT(TIME1,'99$:99$:99');
DTDESC/A20='Transaction Dates';
END
-RUN
-IF &&CURRENCY EQ 'USD' THEN GOTO NEXT;

-SET &&SUBHEAD = <NAMEC;

-NEXT;


TABLE FILE ABNONHLD
-* -INCLUDE GHEADAIR
HEADING
"<+0> Client:<ROLL_NAME"
"<+0> Contact:<ROLL_CONTACT"
"<+0> Phone:<RPHONE "
"<+0> &&DTDESC <+0> &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
"<+0> <RN"
"<+0> <RN1"
" "
"<+0> <+0> Advanced Purchase <+0> <+0> Refundable <+0> <+0> Traditional <+0> <+0> Lost Savings <+0> <+0> Hotel Rates <+0> <+0> Hotels <+0> <+0> Cars Larger"
"<+0> <+0> 0-6 <+0> <+0> 7-13 <+0> <+0> <+0> <+0> <+0> <+0> $100-$200 <+0> <+0> $201-$300 <+0> <+0> $301+ <+0> <+0> $151 + <+0> <+0> Non-Preferred <+0> <+0> Than Midsize" 
SUM MXADV_TKT AS '# Of Tkts'
COMPUTE 
MXADVP/D5CS% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXADV_TKT/NET_TKT_CNT)*100); AS '% Of Tkts'
BLANK AS ' '                  
MXADV_TKT1 AS '# Of Tkts'
COMPUTE 
MXADVP1/D5CS% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXADV_TKT1/NET_TKT_CNT)*100); AS '% Of Tkts'                  
BLANK AS ' '                  
REFUNDABLE AS '# Of Tkts'
COMPUTE 
REFP/D5CS% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                ((REFUNDABLE/NET_TKT_CNT)*100); AS '% Of Tkts'         
BLANK AS ' '                
MXTRA_TKT AS '# Of Tkts'
COMPUTE
MXTRAP/D5CS% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXTRA_TKT/NET_TKT_CNT)*100); AS '% Of Tkts'
BLANK AS ' '                 
LS100 AS '# Of Tkts'
COMPUTE
LS100P/D5CS% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((LS100/NET_TKT_CNT)*100); AS '% Of Tkts'
BLANK AS ' '                  
LS201 AS '# Of Tkts'
COMPUTE 
LS201P/D5CS% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((LS201/NET_TKT_CNT)*100); AS '% Of Tkts'
BLANK AS ' '
LS301 AS '# Of Tkts'
COMPUTE 
LS301P/D5CS% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((LS301/NET_TKT_CNT)*100); AS '% Of Tkts'
BLANK AS ' '                  
TOTAL_ROOM AS '# of Rooms'
COMPUTE HAVG/D5CS% = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
                        ((TOTAL_ROOM/NNROOMS)*100); AS '% Of Rooms'
BLANK AS ' '                                         
TOTAL_NON AS '# Of Rooms'
COMPUTE
HNONP/D5CS% = IF ((NNROOMS3 LT 1) AND (NNROOMS3 GT (-1))) THEN 0 ELSE
                 ((TOTAL_NON1/NNROOMS3)*100); AS '% Of Rooms'
BLANK AS ' '                 
NOMIDBK AS '# Of Bkgs'
COMPUTE 
NOMIDP/D5CS% = IF ((BOOKINGS LT 1) AND (BOOKINGS GT (-1))) THEN 0 ELSE
                  ((NOMIDBK/BOOKINGS)*100); AS '% Of Bkgs'
BY LEVEL_DESC AS ''
ON TABLE SET PAGE-NUM OFF
ON LEVEL_DESC RECOMPUTE MULTILINES AS 'TOTAL FOR'
-*
-INCLUDE FOOTERDT
-*
ON TABLE PAGE-BREAK AND SUBFOOT
" "
-INCLUDE SBFOOT

ON TABLE SET STYLE *
TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N2, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABADV' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N5, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABADV1' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N8, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABREF' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $


TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N11, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABTRA' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N14, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABLS1' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N17, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABLS2' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N20, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABLS3' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N23, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRAB150' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N26, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABNONP' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N29, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRABMID' ROW_LABEL=N1 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $


UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.030000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.010000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
    

TYPE=REPORT, FOCEXEC=NONE, FONT=ARIAL, SIZE=8, COLOR=BLACK,
    BACKCOLOR=NONE, GRID=OFF, STYLE=NORMAL, $
    
TYPE=TITLE,
     JUSTIFY=LEFT,
     STYLE=BOLD+UNDERLINE,
     FONT=ARIAL,
     COLOR=RGB(5 76 149),
$     

TYPE=HEADING, SIZE=10, GRID=OFF, STYLE=BOLD, $
TYPE=HEADING, LINE=8, SIZE=9, GRID=OFF, STYLE=BOLD, COLOR=RGB(5 76 149), BACKCOLOR=RGB(192 192 192),$
TYPE=HEADING, LINE=9, SIZE=8, GRID=OFF, STYLE=BOLD, COLOR=RGB(5 76 149), $
TYPE=HEADING, HEADALIGN=BODY,$
TYPE=HEADING, LINE=1, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=1, ITEM=2, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=2, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=2, ITEM=2, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=3, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=3, ITEM=2, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=4, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=4, ITEM=2, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=5, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=5, ITEM=2, COLSPAN=20, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=6, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=6, ITEM=2, COLSPAN=20, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=8, ITEM=1, COLSPAN=1,BACKCOLOR=NONE,$
TYPE=HEADING, LINE=8, ITEM=2, COLSPAN=5,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=3, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=4, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=5, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=6, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=7, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=8, COLSPAN=8,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=9, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=10, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=11, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=12, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=13, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=14, COLSPAN=2,JUSTIFY=CENTER,$ 
-* 
TYPE=HEADING, LINE=9, ITEM=1, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=2, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=9, ITEM=3, COLSPAN=1,BACKCOLOR=RGB(192 192 192),$ 
TYPE=HEADING, LINE=9, ITEM=4, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=9, ITEM=5, COLSPAN=1,$ 
TYPE=HEADING, LINE=9, ITEM=6, COLSPAN=2,$ 
TYPE=HEADING, LINE=9, ITEM=7, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=8, COLSPAN=2,$
TYPE=HEADING, LINE=9, ITEM=9, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=10, COLSPAN=2, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=9, ITEM=11, COLSPAN=1,BACKCOLOR=RGB(192 192 192),$ 
TYPE=HEADING, LINE=9, ITEM=12, COLSPAN=2, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=9, ITEM=13, COLSPAN=1,BACKCOLOR=RGB(192 192 192),$ 
TYPE=HEADING, LINE=9, ITEM=14, COLSPAN=2, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=9, ITEM=15, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=16, COLSPAN=2,JUSTIFY=CENTER, $
TYPE=HEADING, LINE=9, ITEM=17, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=18, COLSPAN=2,JUSTIFY=CENTER, $
TYPE=HEADING, LINE=9, ITEM=19, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=20, COLSPAN=2,JUSTIFY=CENTER, $



TYPE=REPORT, COLUMN=N1, JUSTIFY=LEFT, SQUEEZE=2,$
TYPE=REPORT, COLUMN=N2, JUSTIFY=LEFT, WRAP=.5,$
TYPE=REPORT, COLUMN=N3, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N4, JUSTIFY=LEFT, BACKCOLOR=RGB(192 192 192), WRAP=.1, $
TYPE=REPORT, COLUMN=N5, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N6, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N7, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N8, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N9, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N10, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N11, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N12, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N13, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N14, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N15, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N16, JUSTIFY=LEFT, BACKCOLOR=RGB(192 192 192),WRAP=.1, $
TYPE=REPORT, COLUMN=N17, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N18, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N19, JUSTIFY=LEFT, BACKCOLOR=RGB(192 192 192),WRAP=.1, $
TYPE=REPORT, COLUMN=N20, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N21, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N22, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N23, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N24, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N25, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N26, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N27, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N28, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N29, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N30, JUSTIFY=LEFT, WRAP=.5, $

-* 


TYPE=GRANDTOTAL, SIZE=8, JUSTIFY=LEFT, STYLE=BOLD, $
     
TYPE=FOOTING, FONT=ARIAL, SIZE=7, STYLE=BOLD,$
TYPE=REPORT, IMAGE=TSMHEAD.jpg, POSITION=(0 0), $
TYPE=REPORT, IMAGE=FOOTER.jpg, POSITION=(0 8.2), $ 
-*
-*TYPE=FOOTING, LINE=4, STYLE=BOLD,POSITION=(&FTR_DATEPOS),$ 
-*
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN

-XXIT;
