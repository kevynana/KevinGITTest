-**********************************************************************************
-* Created for TeleTech's Non Compliance Analysis
-**********************************************************************************
-* Story ID S-10086 Added &&overdrill flag logic for use in 5.0 to choose to for the report to be drillable or non-drillable - 9/15/15 - JM
-*01/19/16 - JEM - S-13286 Updated to allow reports to sort/subtotal by id-levels
-*4/20/2017-JEM-S-33318-updated logic for no records report


SET ASNAMES = ON
-SET HOLDATTR = ON;

-SET &&IDLEVELBREAK = '';

-SET &AIRDATES = &&WEB_PATH || 'AIRDATES.fex';

-INCLUDE IDLEVROLLDEF
-RUN

DEFINE FILE &&EXTRACT 
  MXTRAD/A1 = IF (DOD_TYPE NE 'H' OR 'I' OR 'J' OR 'M' OR 'X' OR 'A' OR 'L' OR
                  'N' OR 'S') THEN 'Y' ELSE 'N';
  LEVEL_DESC1/A80 = &&LDESC;
  FARE_PAID/D12 = SEG_AMT + SEG_TAX;
  FLAG/A1 = 'A';
  NET_TKT_CNT/D5CS    = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
TKT_AMOUNT/D12.2CS  = TICKET_AMT + TAX_AMT;

-* DEFINES ON PREVIOUS DEFINES
DECLINE_AMT/D12.2CS  = IF EMBARK EQ 'DT1' THEN 0 ELSE
                         TKT_AMOUNT - LOWEST_AMT;
DISSAVINGS/D11.2CS  = IF EMBARK EQ 'DT1' THEN 0 ELSE
                         FARE_PAID - SEG_LOWEST;
MXADV/A1 = IF (ADV_PURCH LT 7) THEN 'Y' ELSE 'N';
MXADV1/A1 = IF (ADV_PURCH GE 7) AND (ADV_PURCH LT 14) THEN 'Y' ELSE 'N';
MXADV2/A1 = IF (ADV_PURCH GE 14) THEN 'Y' ELSE 'N';
MXADV_FP/D12.2CS = IF (MXADV EQ 'Y') THEN FARE_PAID ELSE 0;
MXADV_FP1/D12.2CS = IF (MXADV1 EQ 'Y') THEN FARE_PAID ELSE 0;
MXADV_FP2/D12.2CS = IF (MXADV2 EQ 'Y') THEN FARE_PAID ELSE 0;
MXADV_TKT/D5CS = IF (MXADV EQ 'Y') THEN NET_TKT_CNT ELSE 0;
MXADV_TKT1/D5CS = IF (MXADV1 EQ 'Y') THEN NET_TKT_CNT ELSE 0;
MXADV_TKT2/D5CS = IF (MXADV2 EQ 'Y') THEN NET_TKT_CNT ELSE 0;
MXONL_TKT/D5CS = IF (MXTRAD EQ 'N') THEN NET_TKT_CNT ELSE 0;
MXONL_FP/D12.2CS = IF (MXTRAD EQ 'N') THEN FARE_PAID ELSE 0;
MXTRA_TKT/D5CS = IF (MXTRAD EQ 'Y') THEN NET_TKT_CNT ELSE 0;
MXTRA_FP/D12.2CS = IF (MXTRAD EQ 'Y') THEN FARE_PAID ELSE 0;
CGDOM_TKT/D5CS = IF (CITYPAIR.INTL_DOM EQ 'D') THEN NET_TKT_CNT ELSE 0;
LS/D8CS = IF (DECLINE_AMT GE 1) OR (DECLINE_AMT LE (-1)) THEN NET_TKT_CNT ELSE 0; 
LSA/D12CSM = IF (DECLINE_AMT GE 1) OR (DECLINE_AMT LE (-1)) THEN DISSAVINGS ELSE 0;
REFUNDABLE/D5CS = IF NONREF_FLAG EQ 'R' OR ' ' THEN NET_TKT_CNT ELSE 0;
-INCLUDE IDLEVDEFINE 

END
-RUN

TABLEF FILE &&EXTRACT
PRINT 
  CGDOM_TKT
  FARE_PAID
  LEVEL_DESC
  LS
  LSA
  MXADV_FP
  MXADV_FP1
  MXADV_FP2
  MXADV_TKT
  MXADV_TKT1
  MXADV_TKT2
  MXONL_FP
  MXONL_TKT
  MXTRA_FP
  MXTRA_TKT
  NET_TKT_CNT
  REFUNDABLE
  REFUSE_CODE
  TKT_DATE
WHERE VOID.VOID_DATE EQ 0
-INCLUDE &AIRDATES
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10

-INCLUDE RPTPARMS
ON TABLE HOLD AS GRPTHOLD
END
-RUN

-SET &&AIRREC = IF &RECORDS EQ 0 THEN 'N' ELSE 'Y';
-IF &RECORDS EQ 0 GOTO XXIT;


TABLE FILE GRPTHOLD
PRINT CGDOM_TKT
  FARE_PAID
  LEVEL_DESC
  LS
  LSA
  MXADV_FP
  MXADV_FP1
  MXADV_FP2
  MXADV_TKT
  MXADV_TKT1
  MXADV_TKT2
  MXONL_FP
  MXONL_TKT
  MXTRA_FP
  MXTRA_TKT
  NET_TKT_CNT
  REFUNDABLE
  REFUSE_CODE
BY TKT_DATE
ON TABLE HOLD AS GRPTHLD2 FORMAT FOCUS INDEX TKT_DATE
END
-RUN

-* Global Reporting JOIN
JOIN GRPTHLD2.TKT_DATE IN GRPTHLD2 TO GLOBAL.DATE IN GLOBAL AS J1


DEFINE FILE GRPTHLD2
NAMEC/A30 = CNAME;

-******************************************************************************
-*                         Global Currency Conversion Defines
-******************************************************************************
CURR1X/D20.6 = 1 / USDPU ;

-* DEFINES ON PREVIOUS DEFINES
PAID_FAREX/D20.6 = FARE_PAID * CURR1X;
LEV/A25 = EDIT(LEVEL_DESC, '9999999999999999999999999');

END
-RUN

TABLE FILE GRPTHLD2
PRINT CGDOM_TKT
  FARE_PAID
  LEVEL_DESC 
  LEV
  LS
  LSA
  MXADV_FP
  MXADV_FP1
  MXADV_FP2
  MXADV_TKT
  MXADV_TKT1
  MXADV_TKT2
  MXONL_FP
  MXONL_TKT
  MXTRA_FP
  MXTRA_TKT
  NET_TKT_CNT
  REFUNDABLE
  REFUSE_CODE
  TKT_DATE
  NAMEC
  PAID_FAREX/D16.2CS
WHERE GLOBAL.COUNTRYCODE EQ '&&CURRENCY'
ON TABLE HOLD AS RPTHOLD
END
-RUN


DEFINE FILE RPTHOLD
FLAG/A1 = 'A';
END
TABLE FILE RPTHOLD
SUM CGDOM_TKT
  FARE_PAID
  LS
  LSA
  MXADV_FP
  MXADV_FP1
  MXADV_FP2
  MXADV_TKT
  MXADV_TKT1
  MXADV_TKT2 
  MXONL_FP
  MXONL_TKT
  MXTRA_FP
  MXTRA_TKT
  NET_TKT_CNT
  REFUNDABLE
  PAID_FAREX
  NAMEC
BY FLAG  
BY LEVEL_DESC 
BY LEV
ON TABLE HOLD AS ABNONHLD FORMAT FOCUS
END
-RUN

DEFINE FILE RPTHOLD
FLAG/A1='B';
LEVD/A80 = 'TOTAL';
LEV/A25 = 'TOTAL';
END
-RUN

TABLE FILE RPTHOLD
SUM CGDOM_TKT
  FARE_PAID
  LS
  LSA
  MXADV_FP
  MXADV_FP1
  MXADV_FP2
  MXADV_TKT
  MXADV_TKT1
  MXADV_TKT2 
  MXONL_FP
  MXONL_TKT
  MXTRA_FP
  MXTRA_TKT
  NET_TKT_CNT
  REFUNDABLE
  PAID_FAREX
  NAMEC
BY FLAG
BY LEVD AS 'LEVEL_DESC'
BY LEV
ON TABLE HOLD AS ABNONHLDT
END
-RUN

TABLE FILE ABNONHLDT
SUM CGDOM_TKT
  FARE_PAID
  LS
  LSA
  MXADV_FP
  MXADV_FP1
  MXADV_FP2
  MXADV_TKT
  MXADV_TKT1
  MXADV_TKT2 
  MXONL_FP
  MXONL_TKT
  MXTRA_FP
  MXTRA_TKT
  NET_TKT_CNT
  REFUNDABLE
  PAID_FAREX
  NAMEC
BY FLAG
BY LEVEL_DESC 
BY LEV
ON TABLE HOLD AS ABNONHLDT1 FORMAT FOCUS
END
-RUN


-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &PHOLD1=&HLDPATH || 'ABNONHLD.FOC';
-SET &PHOLD2=&HLDPATH || 'ABNONHLDT1.FOC';
-RUN

USE CLEAR *
-RUN

EX SUUSES
-RUN

USE ADD 
&PHOLD1 AS ABNONHLD
&PHOLD2 AS ABNONHLD
END
-RUN





-SET &&RPTSUF = 'AIRANALYSIS';
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');

-INCLUDE FDEFRPTS
-RUN


JOIN ROLL WITH LEVEL_DESC IN ABNONHLD TO ROLLUP_CODE IN ROLLUP AS J1
-RUN

DEFINE FILE ABNONHLD
NOWTOD/A8 WITH NET_TKT_CNT = HHMMSS (NOWTOD);
ROLL/A8='&&ROLLUP.EVAL';
LVL/A60='&&LVL_DSC.EVAL';
RPHONE/A15=EDIT(ROLL_PHONE,'9-999-999-9999');
RD/A10 = 'Run Date:';
RT/A10 = 'Run Time:';  
LEV/A25 = EDIT(LEVEL_DESC, '9999999999999999999999999');
RN/A60=TRIM('B', '&&RPT_TTL1.EVAL', 60, ' ', 1, 'A60');
RN1/A60=TRIM('B', '&&RPT_TTL2.EVAL', 60, ' ', 1, 'A60');
TDATE1/A8MDYY='&MDYY';
TDATE2/A10=EDIT(TDATE1,'99/99/9999');
TIME1/A8=HHMMSS('A8');
TIME2/A8=EDIT(TIME1,'99$:99$:99');
DTDESC/A20='Transaction Dates';
END
-RUN


TABLE FILE ABNONHLD
SUM MXADV_TKT/D5CS AS '# OF,0-6,TKTS'
COMPUTE 
MXADVP/D5S% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXADV_TKT/NET_TKT_CNT)*100); AS '% OF,0-6,TKTS'
COMPUTE MXADVTP/D8CSM = IF ((MXADV_TKT LT 1) AND (MXADV_TKT GT (-1))) THEN 0 ELSE
                           (MXADV_FP/MXADV_TKT); AS '0-6,ATP'
MXADV_TKT1 AS '# OF,7-13,TKTS'
COMPUTE 
MXADVP1/D5S% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXADV_TKT1/NET_TKT_CNT)*100); AS '% OF,7-13,TKTS'
COMPUTE MXADVTP1/D8CSM = IF ((MXADV_TKT1 LT 1) AND (MXADV_TKT1 GT (-1))) THEN 0 ELSE
                            (MXADV_FP1/MXADV_TKT1); AS '7-13,ATP'
MXADV_TKT2 AS '14+,TKTS'
COMPUTE 
MXADVP2/D5S% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXADV_TKT2/NET_TKT_CNT)*100); AS '% OF,14+,TKTS'
COMPUTE MXADVTP2/D8CSM = IF ((MXADV_TKT2 LT 1) AND (MXADV_TKT2 GT (-1))) THEN 0 ELSE
                              (MXADV_FP2/MXADV_TKT2); AS '14+,ATP'
MXTRA_TKT AS 'AGT,BKD,TKTS'
COMPUTE
MXTRAP/D5S% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXTRA_TKT/NET_TKT_CNT)*100); AS '% OF,AGT,BKD,TKTS'
COMPUTE
MXTRATP/D8CSM = IF ((MXTRA_TKT LT 1) AND (MXTRA_TKT GT (-1))) THEN 0 ELSE
                     (MXTRA_FP/MXTRA_TKT); AS 'AGT,BKD,ATP'
MXONL_TKT AS 'ONL,TKTS'
COMPUTE
MXONLP/D5CS% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                  ((MXONL_TKT/NET_TKT_CNT)*100); AS '% OF,ONL,TKTS'
COMPUTE
MXONLTP/D8CSM = IF ((MXONL_TKT LT 1) AND (MXONL_TKT GT (-1))) THEN 0 ELSE
                     (MXONL_FP/MXONL_TKT); AS 'ONL,ATP'

LS AS 'LOST,SVGS,TKTS'
LSA AS 'LOST,SVGS,AMT'
COMPUTE 
LSP/D5CS% = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
              ((LS/NET_TKT_CNT)*100); AS '% OF,LOST,SVGS,TKTS'
BY FLAG NOPRINT              
BY LEVEL_DESC NOPRINT
BY LEV AS ' '

-IF '&&OUTFMT.EVAL' EQ 'PDF' THEN GOTO PDFHEAD;    
HEADING
"Client: <6 <ROLL_NAME "
"Contact: <6 <ROLL_CONTACT"
"Phone: <6 <RPHONE "
" "
"<DTDESC &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
" "
"<RN "
"<RN1"
-GOTO FTR;
-PDFHEAD;
HEADING 
"Client: <6 <ROLL_NAME <38 <RN <90 <RD <TDATE1"
"Contact: <6 <ROLL_CONTACT <32 <LVL <90 <RT <TIME2"
"Phone: <6 <RPHONE <90 &&DTDESC &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
"</1"
-FTR;
FOOTING BOTTOM
-INCLUDE CRIGHT_FOOTER
"</1"
"<15 &M1.EVAL <45 &M2.EVAL <75 &M3.EVAL"
ON TABLE SET PAGE-NUM OFF
ON TABLE NOTOTAL
ON TABLE PAGE-BREAK AND SUBFOOT
" "
-INCLUDE SBFOOT

ON TABLE SET STYLE *

-IF &&OVERDRILL EQ 'Y' GOTO OVERDRILL;

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N4, WHEN=FLAG EQ 'A',\
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRTTADV1' ROW_LABEL=N2 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $


TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N7, WHEN=FLAG EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRTTADV2' ROW_LABEL=N2 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N10, WHEN=FLAG EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRTTADV3' ROW_LABEL=N2 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N13, WHEN=FLAG EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRTTTRA' ROW_LABEL=N2 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N16, WHEN=FLAG EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRTTONL' ROW_LABEL=N2 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N19, WHEN=FLAG EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRTTLS' ROW_LABEL=N2 LSEL=LEVEL_DESC PARM2='&&IDLEVELBREAK.EVAL'\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-OVERDRILL;


UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.030000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.010000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
    

TYPE=REPORT, FOCEXEC=NONE, FONT=TIMES NEW ROMAN, SIZE=7, COLOR=BLACK,
    BACKCOLOR=NONE, STYLE=NORMAL, $  


TYPE=HEADING,
     LINE=1,
     OBJECT=TEXT,
     ITEM=1,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD,
$
TYPE=HEADING,   
     LINE=1,
     OBJECT=FIELD,
     ITEM=1,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD,
$
TYPE=HEADING,
     LINE=1,
     OBJECT=FIELD,
     ITEM=2,
     SIZE=10,
     JUSTIFY=CENTER,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD+ITALIC,
$
TYPE=HEADING,   
     LINE=1,
     OBJECT=FIELD,
     ITEM=3,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD,
$
TYPE=HEADING,   
     LINE=1,
     OBJECT=FIELD,
     ITEM=4,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD,
$
TYPE=HEADING,
     LINE=2,
     OBJECT=TEXT,
     ITEM=1,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD,
$
TYPE=HEADING,   
     LINE=2,
     OBJECT=FIELD,
     ITEM=1,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD,
$
TYPE=HEADING,
     LINE=2,
     OBJECT=FIELD,
     ITEM=2,
     SIZE=10,
     JUSTIFY=CENTER,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD+ITALIC,
$
TYPE=HEADING,   
     LINE=2,
     OBJECT=FIELD,
     ITEM=3,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD,
$
TYPE=HEADING,   
     LINE=2,
     OBJECT=FIELD,
     ITEM=4,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD,
$
TYPE=HEADING,
     LINE=3,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR='WHITE',
     FONT='TIMES NEW ROMAN',
     STYLE=BOLD,
$

TYPE=TITLE,
     JUSTIFY=LEFT,
     STYLE=BOLD,
     COLOR=RGB(5 76 149),
$     

-IF '&&OUTFMT.EVAL' NE 'PDF' THEN GOTO EXLFMT; 

TYPE=DATA,
     GRID=OFF,
     SIZE=7,
     BACKCOLOR=( RGB(239 239 239) 'WHITE' ),
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR=RGB(5 76 149),
     BORDER-BOTTOM-COLOR=RGB(5 76 149),
     BORDER-LEFT-COLOR=RGB(5 76 149),
     BORDER-RIGHT-COLOR=RGB(5 76 149),
     JUSTIFY=LEFT,  
     WHEN=N1 EQ 'A',
$

TYPE=DATA,
     SIZE=7,
     COLOR='BLACK',
     STYLE=BOLD,
     JUSTIFY=LEFT,
     WHEN=N3 EQ 'TOTAL',
$     


-* TYPE=GRANDTOTAL, SIZE=8, JUSTIFY=LEFT, STYLE=BOLD, $
     
TYPE=FOOTING, FONT=TIMES NEW ROMAN, SIZE=7, COLOR=WHITE,$
     

TYPE=REPORT, IMAGE=TSMHEAD.jpg, POSITION=(0 0), $
TYPE=REPORT, IMAGE=FOOTER.jpg, POSITION=(0 8.2), $ 
-GOTO PDFDNE

-EXLFMT
TYPE=HEADING, SIZE=10, STYLE=BOLD, $
-* TYPE=REPORT, COLUMN=N2, JUSTIFY=LEFT, WRAP=1,$
TYPE=REPORT, COLUMN=N3, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N4, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N5, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N6, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N7, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N8, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N9, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N10, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N11, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N12, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N13, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N14, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N15, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N16, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N17, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N18, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N19, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N20, JUSTIFY=LEFT, WRAP=.5, $

TYPE=GRANDTOTAL, SIZE=8, JUSTIFY=LEFT, STYLE=BOLD, $
     
TYPE=FOOTING, FONT=TIMES NEW ROMAN, SIZE=7, STYLE=BOLD,$
TYPE=REPORT, IMAGE=TSMHEAD.jpg, POSITION=(0 0), $
TYPE=REPORT, IMAGE=FOOTER.jpg, POSITION=(0 8.2), $ 
-*    

-PDFDNE
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
-*
END
-RUN
\
-XXIT;



