-***************************************************************************
-* REPORT NAME: BENCHMARKING ANALYSIS (HOTEL EXTRACT)
-* TOTAL COMPANY REPORTING
-*2/22/05        JK                 ADDED TNT_COMPANY WHERE STATEMENT
-***************************************************************************
-INCLUDE SETECHO
SET ASNAMES = ON

DEFINE FILE HR_50
  NBR_DAYS/P12S = NUM_DAYS;
  NBR_ROOMS/P12S = NUM_ROOMS;
  NEW_TOTAL_AMT/D14.2S = TOTAL_AMT;
  NNROOMS/P12S = IF (NBR_DAYS LT 0) AND (NUM_ROOMS LT 0) THEN
                    ((NBR_DAYS * NUM_ROOMS) * (-1)) ELSE
                    (NBR_DAYS * NUM_ROOMS);  
  INT_DOM/A1 =IF (CITY.INTL_DOM EQ 'I') THEN 'I' ELSE 'D';
 
END
-RUN

TABLEF FILE HR_50
PRINT INVOICE_DATE
  HTL_KEY	
  INT_DOM
  NBR_DAYS	
  NBR_ROOMS
  NEW_TOTAL_AMT
  NNROOMS    
WHERE (INVOICE_DATE GE &&FROMDT.EVAL) AND (INVOICE_DATE LE &&TODT.EVAL) OR
      (INVOICE_DATE GE &&FXDATE.EVAL AND INVOICE_DATE LE &&TXDATE.EVAL)
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
-* &&WHERE1
-* &&WHERE2
-* &&WHERE3
-* &&WHERE4
-* &&WHERE5
-* &&WHERE6
-* &&WHERE7
-* &&WHERE8
&&WHERE9
&&WHERE10
-INCLUDE RPTPARMS
ON TABLE HOLD AS TC_HBNM
END
-RUN

-IF &LINES EQ 0 THEN GOTO NEXTONE;

DEFINE FILE TC_HBNM
ROLLCD/A8 = '&&ROLL';
END

TABLE FILE TC_HBNM
SUM
  INVOICE_DATE
  INT_DOM
  NBR_DAYS	
  NBR_ROOMS
  NEW_TOTAL_AMT
  NNROOMS
BY ROLLCD
BY HTL_KEY
ON TABLE HOLD AS HTLHLD1 
END
-RUN


TABLE FILE HTLHLD1
PRINT  INT_DOM
      INVOICE_DATE
      NBR_DAYS
      NBR_ROOMS
      NEW_TOTAL_AMT
      NNROOMS
BY ROLLCD
BY HTL_KEY
ON TABLE HOLD AS TCH1
END
-RUN

DEFINE FILE TCH1
CURRENT/A1 = IF INVOICE_DATE GE &&FROMDT.EVAL AND
                INVOICE_DATE LE &&TODT.EVAL THEN 'Y' ELSE 'N';
PRIOR/A1 =  IF INVOICE_DATE GE &&FXDATE.EVAL AND
               INVOICE_DATE LE &&TXDATE.EVAL THEN 'Y' ELSE 'N';
END

TABLE FILE TCH1
PRINT 
  CURRENT
  NBR_DAYS
  NNROOMS
  NEW_TOTAL_AMT
  PRIOR
BY ROLLCD
ON TABLE HOLD AS HTLHLD1
END
-RUN

DEFINE FILE HTLHLD1
CHTTLA/D12.2S = IF CURRENT EQ 'Y' THEN NEW_TOTAL_AMT ELSE 0;
CHTTLN/D12S = IF CURRENT EQ 'Y' THEN NNROOMS ELSE 0;
END

TABLE FILE HTLHLD1
SUM CHTTLA
    CHTTLN
BY ROLLCD
ON TABLE HOLD AS TCH2
END
-RUN



MODIFY FILE TCHBNM
FIXFORM FROM TCH2
DATA ON TCH2
END
-RUN



-NEXTONE
