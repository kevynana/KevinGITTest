-GOTO STEVE2


USE F:\TNT\TTRACKER\SUDATA\HRPTFLDS.FOC AS HRPTFLDS
END

SET ASNAMES=ON

-GOTO TABLE1

-TABLE1

TABLE FILE HRPTFLDS
PRINT SEG.COMMON1.INCL1
BY INST_KEY
-* BY INTIME
BY COMMON1.INCL1
END
-EXIT

-TABLE2

TABLE FILE HRPTFLDS
PRINT COMMON2.SEQ_NO
BY INST_KEY
-* BY INTIME
BY COMMON2.SEQ_NO NOPRINT
END
-EXIT

-TABLE3

TABLE FILE HRPTFLDS
PRINT AIR.ID
AIR.INCL1 AS 'AIR.INCL1'
AIR.INCL2 AS 'AIR.INCL2'
AIR.INCL3 AS 'AIR.INCL3'
AIR.INCL4 AS 'AIR.INCL4'
AIR.INCL5 AS 'AIR.INCL5'
AIR.INCL6 AS 'AIR.INCL6'
AIR.INCL7 AS 'AIR.INCL7'
AIR.INCL8 AS 'AIR.INCL8'
AIR.INTDOMT AS 'AIR.INTDOMT'
AIR.INTDOMS AS 'AIR.INTDOMS'
AIR.RANKBYTOP1 AS 'AIR.RANKBYTOP1'
AIR.RANKMETHOD AS 'AIR.RANKMETHOD'
AIR.CLASSCAT_A AS 'AIR.CLASSCAT_A'
AIR.CLASSCAT_F AS 'AIR.CLASSCAT_F'
AIR.CLASSCAT_B AS 'AIR.CLASSCAT_B'
AIR.CLASSCAT_C AS 'AIR.CLASSCAT_C'
AIR.CLASSCAT_D AS 'AIR.CLASSCAT_D'
AIR.TRANS_TYPE_S AS 'AIR.TRANS_TYPE_S'
AIR.TRANS_TYPE_E AS 'AIR.TRANS_TYPE_E'
AIR.TRANS_TYPE_R AS 'AIR.TRANS_TYPE_R'
AIR.TRANS_TYPE_V AS 'AIR.TRANS_TYPE_V'
AIR.ADV_PUR_A AS 'AIR.ADV_PUR_A'
AIR.ADV_PUR_0 AS 'AIR.ADV_PUR_0'
AIR.ADV_PUR_7 AS 'AIR.ADV_PUR_7'
AIR.ADV_PUR_14 AS 'AIR.ADV_PUR_14'
AIR.ADV_PUR_21 AS 'AIR.ADV_PUR_21'
AIR.RANKBYTOP2 AS 'AIR.RANKBYTOP2'
AIR.CITYPAIRFLD AS 'AIR.CITYPAIRFLD'
BY INST_KEY
-* BY INTIME
BY AIR.ID NOPRINT
END
-EXIT

-TABLE4

TABLE FILE HRPTFLDS
PRINT AIRFLDS.SEQ_NO AS 'AIRFLDS.SEQ_NO'
AIRFLDS.PASSENGER AS 'AIRFLDS.PASSENGER'
AIRFLDS.TICKET_NO AS 'AIRFLDS.TICKET_NO'
AIRFLDS.ORG_AIRPORT AS 'AIRFLDS.ORG_AIRPORT'
AIRFLDS.RTE_AIRPORT AS 'AIRFLDS.RTE_AIRPORT'
AIRFLDS.VAL_AIR AS 'AIRFLDS.VAL_AIR'
AIRFLDS.FLOWN_AIR AS 'AIRFLDS.FLOWN_AIR'
AIRFLDS.REFUSE_CODE AS 'AIRFLDS.REFUSE_CODE'
AIRFLDS.CP_AIRPORT AS 'AIRFLDS.CP_AIRPORT'
BY INST_KEY
-* BY INTIME
BY AIRFLDS.SEQ_NO NOPRINT
END
-EXIT

-TABLE5

TABLE FILE HRPTFLDS
PRINT CAR.ID AS 'CAR.ID'
CAR.INCL1 AS 'CAR.INCL1'
CAR.INCL2 AS 'CAR.INCL2'
CAR.INCL3 AS 'CAR.INCL3'
CAR.INCL4 AS 'CAR.INCL4'
CAR.INCL5 AS 'CAR.INCL5'
CAR.INCL6 AS 'CAR.INCL6'
CAR.RANKBYTOP AS 'CAR.RANKBYTOP'
CAR.RANKMETHOD AS 'CAR.RANKMETHOD'
CAR.RATEALL AS 'CAR.RATEALL'
CAR.RATE1 AS 'CAR.RATE1'
CAR.RATE2 AS 'CAR.RATE2'
CAR.RATE3 AS 'CAR.RATE3'
CAR.RATE4 AS 'CAR.RATE4'
CAR.RATE5 AS 'CAR.RATE5'
CAR.RATE6 AS 'CAR.RATE6'
BY INST_KEY
-* BY INTIME
BY CAR.ID NOPRINT
END
-EXIT

-TABLE6

TABLE FILE HRPTFLDS
PRINT CARFLDS.SEQ_NO AS 'CARFLDS.SEQ_NO'
CARFLDS.SEQ_NO AS 'CARFLDS.SEQ_NO'
CARFLDS.PASSENGER AS 'CARFLDS.PASSENGER'
CARFLDS.VENDOR_CODE AS 'CARFLDS.VENDOR_CODE'
CARFLDS.REFUSE_CODE AS 'CARFLDS.REFUSE_CODE'
CARFLDS.PICKUP_CITY AS 'CARFLDS.PICKUP_CITY'
CARFLDS.DROPOFF_CITY AS 'CARFLDS.DROPOFF_CITY'
CARFLDS.CAR_TYPE AS 'CARFLDS.CAR_TYPE'
BY INST_KEY
-* BY INTIME
BY CARFLDS.SEQ_NO NOPRINT
END
-EXIT

-TABLE7

TABLE FILE HRPTFLDS
PRINT HTL.ID AS 'HTL.ID'
HTL.INCL1 AS 'HTL.INCL1'
HTL.INCL2 AS 'HTL.INCL2'
HTL.INCL3 AS 'HTL.INCL3'
HTL.INCL4 AS 'HTL.INCL4'
HTL.RANKBYTOP1 AS 'HTL.RANKBYTOP1'
HTL.RANKMETHOD AS 'HTL.RANKMETHOD'
HTL.RANKBYTOP2 AS 'HTL.RANKBYTOP2'
BY INST_KEY
-* BY INTIME
BY HTL.ID NOPRINT
END
-EXIT

-TABLE8

TABLE FILE HRPTFLDS
PRINT HTLFLDS.SEQ_NO AS 'HTLFLDS.SEQ_NO'
HTLFLDS.PASSENGER AS 'HTLFLDS.PASSENGER'
HTLFLDS.CHAIN_CODE AS 'HTLFLDS.CHAIN_CODE'
HTLFLDS.HTL_CITY AS 'HTLFLDS.HTL_CITY'
HTLFLDS.REFUSE_CODE AS 'HTLFLDS.REFUSE_CODE'
BY INST_KEY
-* BY INTIME
BY HTLFLDS.SEQ_NO NOPRINT
END
-EXIT





TABLE FILE HR_50
ON TABLE SET PAGE-NUM OFF
PRINT HTL_MAIN.HOTEL_PHONE AND HTL_MAIN.CHAIN_CODE AND CITY.CITY_CODE AND
CITY.CITY_NAME AND HOTL_PRP.PROP_CITY_CD AND HOTL_PRP.PROP_AIRPORT AND
CITY.STATE_CODE AND CITY.PICKUP_CITY AND HTL_MAIN.PASSNGR_NAME AND
CITY.DROP_CITY AND CITY.INTL_DOM
HEADING
"PAGE <TABPAGENO  "
ON TABLE NOTOTAL
WHERE HTL_MAIN.HOTEL_PHONE EQ '4029999999';
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000,
    TOPMARGIN=0.250000, BOTTOMMARGIN=0.250000, SQUEEZE=ON,
    ORIENTATION=PORTRAIT, $
TYPE=REPORT, GRID=OFF, FONT='TIMES NEW ROMAN', SIZE=10, COLOR=BLACK,
    BACKCOLOR=NONE, STYLE=NORMAL, $
ENDSTYLE
ON TABLE SET ONLINE-FMT HTML
END

TABLE FILE HRPTINST
PRINT INST_KEY RPT_NAME
IF INST_KEY CONTAINS 'ar20030213150417'
IF ROLLUP EQ 'BAIRD-R'
END




TABLE FILE HR_50
ON TABLE SET PAGE-NUM OFF
PRINT HTL_MAIN.HOTEL_PHONE AND HTL_MAIN.CHAIN_CODE AND HTL_MAIN.AR_BRANCH AND
HTL_MAIN.CLIENT_NUM AND CITY.CITY_CODE AND CITY.CITY_NAME AND CITY.INTL_DOM AND
HTL_MAIN.CITY_CODE HOTL_PRP.PROP_CITY HOTL_PRP.PROP_CITY_CD
BY INVOICE_DATE
HEADING
"PAGE <TABPAGENO  "
ON TABLE NOTOTAL
WHERE HOTL_PRP.PROP_CITY_CD EQ 'FDY'
-* WHERE ( CITY.INTL_DOM EQ ' ') AND
-* (HTL_MAIN.INVOICE_DATE GE '20020401')
-* AND (HTL_MAIN.INVOICE_DATE LE '20020430');
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000,
    TOPMARGIN=0.250000, BOTTOMMARGIN=0.250000, SQUEEZE=ON,
    ORIENTATION=PORTRAIT, $
TYPE=REPORT, GRID=OFF, FONT='TIMES NEW ROMAN', SIZE=10, COLOR=BLACK,
    BACKCOLOR=NONE, STYLE=NORMAL, $
ENDSTYLE
ON TABLE SET ONLINE-FMT HTML
END


-STEVE1

TABLE FILE RPT_INST
PRINT ROLLUP_CODE CATG1 CATG2 CATG3 CLIENT1 CLIENT2
CLSEL CASEL
IF INSTANCE_ID CONTAINS '20020413002843'
IF ROLLUP_CODE EQ 'METX-R'
END
-RUN
-EXIT


TABLE FILE I_SUMM
PRINT INST_KEY HDES1
IF HDES1 CONTAINS 'All Selected'
ON TABLE HOLD
END

MODIFY FILE I_SUMM
FIXFORM FROM HOLD
MATCH INST_KEY
ON MATCH COMPUTE HDES1=' ';
ON MATCH COMPUTE HSEL1=' ';
ON MATCH COMPUTE HSIF01=' ';
ON MATCH UPDATE HDES1
ON MATCH UPDATE HSEL1
ON MATCH UPDATE HSIF01
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT

-STEVE2

DEFINE FILE SR_50
FARE_PAID/D12 = SEG_AMT + SEG_TAX;
  NET_TKT_CNT/D8CS  =   IF (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) THEN 1 ELSE 
                        IF (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') AND (SEG_COUNT EQ -1)
				   THEN (-1) ELSE 
                        IF (DOC_TYPE NE '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') AND
				   (SEG_COUNT EQ -1)
				   THEN (-1) ELSE 0;

  NET_TKT_CNT2/D8CS   = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
END

TABLE FILE SR_50
PRINT TKTNBR NET_TKT_CNT NET_TKT_CNT2 SEG_NBR FARE_PAID TICKET_CODE CONJ_REL
RF_FLAG EX_FLAG DOC_TYPE SEG_COUNT
IF TRN_DATE GE '20030101'
IF TRN_DATE LE '20030331'
ON TABLE HOLD AS ISUTEST FORMAT EXCEL2K
END


TABLE FILE HR_50
ON TABLE SET PAGE-NUM OFF
PRINT HTL_MAIN.HOTEL_PHONE AND HTL_MAIN.CITY_CODE AND HTL_MAIN.AIRPORT_CODE AND
HOTL_PRP.PROP_AIRPORT AND HOTL_PRP.PROP_CITY_CD AND HOTL_PRP.PROP_STATE_CD AND
HOTL_PRP.PROP_CITY AND CITY.CITY_NAME
HEADING
"PAGE <TABPAGENO  "
ON TABLE NOTOTAL
WHERE HTL_MAIN.HOTEL_PHONE EQ '8474807500';
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.250000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=PORTRAIT, $
TYPE=REPORT, GRID=OFF, FONT='TIMES NEW ROMAN', SIZE=10, COLOR=BLACK, 
    BACKCOLOR=NONE, STYLE=NORMAL, $
ENDSTYLE
ON TABLE SET ONLINE-FMT HTML
END

TABLE FILE SR_50
ON TABLE SET PAGE-NUM OFF
ON TABLE SET PRINT ONLINE
PRINT AIR_MAIN.TKT_NUM AND AIR_MAIN.LEVEL2 AND AIR_MAIN.LEVEL1 AND
AIR_MAIN.LEVEL3 AND AIR_MAIN.PASSNGR_NAME AND CITYPAIR.AROLL_LEV1 AND
CITYPAIR.AROLL_LEV2 AND CITYPAIR.AROLL_LEV3 AND CITYPAIR.AROLL_LEV4 AND
CITYPAIR.AROLL_LEV5 AND CITYPAIR.AROLL_LEV6 AND CITYPAIR.AROLL_LEV7 AND
CITYPAIR.AROLL_LEV8 AND CITYPAIR.AROLL_LEV9 AND LEV_1.AROLL_DSC1X AND
LEV_2.AROLL_DSC2X AND LEV_3.AROLL_DSC3X AND LEV_4.AROLL_DSC4X AND
LEV_5.AROLL_DSC5X AND LEV_6.AROLL_DSC6X AND LEV_7.AROLL_DSC7X AND
LEV_8.AROLL_DSC8X AND LEV_9.AROLL_DSC9X
HEADING
"PAGE <TABPAGENO  "
ON TABLE NOTOTAL
WHERE ( AIR_MAIN.PASSNGR_NAME CONTAINS 'DODGE/T' OR 'THOMASSEN/D') AND
  (CITYPAIR.TRN_DATE GE
'20030501');
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000,
    TOPMARGIN=0.250000, BOTTOMMARGIN=0.250000, SQUEEZE=ON,
    ORIENTATION=PORTRAIT, $
TYPE=REPORT, GRID=OFF, FONT='TIMES NEW ROMAN', SIZE=10, COLOR=BLACK,
    BACKCOLOR=NONE, STYLE=NORMAL, $
ENDSTYLE
ON TABLE HOLD AS GENENCOR FORMAT EXCEL2K 
END

