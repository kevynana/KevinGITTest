-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* 12/28/04 - DEB - ADDED ADDT'L DOD_TYPE TO INT_FLAG DEFINE
-* 10/11/05 - DEB - ADDED DOD_TYPE 'H' TO INT_FLAG DEFINE
-*1/29/14 UPDATED ONLINE/TRADITIONAL DEFINES TO USE ONLINE_TRADITIONAL FIELD INSTEAD OF DOD_TYPE

SET ASNAMES=ON


DEFINE FILE CUROFF
INT_FLAG/A15 = IF ONLINE_TRADITIONAL EQ 'ONLINE' THEN 'ONLINE' ELSE 'TRADITIONAL';
END
-RUN

TABLE FILE CUROFF
SUM NET_TKT_CNT
    PCT.NET_TKT_CNT AS 'PCTTKT'
BY INT_FLAG
ON TABLE HOLD AS OVINT1 
END
-RUN

DEFINE FILE PROFF
INT_FLAG/A15 = IF ONLINE_TRADITIONAL EQ 'ONLINE' THEN 'ONLINE' ELSE 'TRADITIONAL';
END

TABLE FILE PROFF
SUM NET_TKT_CNT
    PCT.NET_TKT_CNT AS 'PCTTKT'
BY INT_FLAG
ON TABLE HOLD AS POVINT1
END
-RUN 

DEFINE FILE OVINT1
CATEGORY/A30 = 'BOOKING TYPE';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE OVINT1
PRINT CATEGORY/A30 AND INT_FLAG/A30 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKT_CNT/D15 AS 'VOL_CURR' AND 
PCTTKT/D15 AS 'TKT_CURR' AND 
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
ON TABLE HOLD AS OVINT2
END
-RUN

TABLE FILE OVINT2
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND VOL_CURR AND TKT_CURR
ON TABLE HOLD AS OVINT3
END
MODIFY FILE OV1_MAIN
FIXFORM FROM OVINT3
MATCH CATEGORY ROW_LABEL
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OVINT3
END


DEFINE FILE POVINT1
CATEGORY/A30 = 'BOOKING TYPE';
CAT_ORDER/I2 = 3;
END
-RUN

TABLE FILE POVINT1
PRINT CATEGORY/A30 AND INT_FLAG/A30 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKT_CNT/D15 AS 'VOL_PRIOR' AND 
PCTTKT/D15 AS 'TKT_PRIOR' AND 
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
ON TABLE HOLD AS POVINT2
END
-RUN

TABLE FILE POVINT2
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER AND VOL_PRIOR AND TKT_PRIOR
ON TABLE HOLD AS POVINT3
END
MODIFY FILE OV1_MAIN
FIXFORM FROM POVINT3
MATCH CATEGORY ROW_LABEL
ON MATCH UPDATE VOL_PRIOR TKT_PRIOR
ON NOMATCH INCLUDE
DATA ON POVINT3
END








