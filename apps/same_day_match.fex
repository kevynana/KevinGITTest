-* Match for Same Day Savings Analysis Udid repor
-*4/18/16 - JEM - S-17913 Corrected issue with validating airline selection so in ER5 will select correctly 


SET ASNAMES=ON
-*-INCLUDE UDAUSE
-*-RUN

-SET &&COMPUA = 'UA' | '&&COMPNY.EVAL';

-*TABLE FILE UDAIR
TABLE FILE &&COMPUA
PRINT AUD_DATA AS 'VAL_ALN'
BY AIR_KEY
WHERE UDID EQ 'SDV'
ON TABLE HOLD AS UDH1
END
-RUN


TABLE FILE &&COMPUA
PRINT NUD_DATA/P12.2CS AS 'STD_FEE'
BY AIR_KEY
WHERE UDID EQ 'SDS'
ON TABLE HOLD AS UDH2
END
-RUN

TABLE FILE &&COMPUA
PRINT NUD_DATA/P12.2CS AS 'PD_FEE'
BY AIR_KEY
WHERE UDID EQ 'SDF'
ON TABLE HOLD AS UDH3
END
-RUN


MATCH FILE UDH1 
PRINT VAL_ALN
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH2
SUM STD_FEE
BY AIR_KEY
AFTER MATCH HOLD AS UDHOLD1 OLD-OR-NEW
END
-RUN


MATCH FILE UDHOLD1
PRINT VAL_ALN STD_FEE
BY AIR_KEY
ON TABLE HOLD
RUN
FILE UDH3
SUM PD_FEE
BY AIR_KEY
AFTER MATCH HOLD AS UDHOLD2 OLD-OR-NEW
END
-RUN
