-* *****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-* File HVIEW1EX.FEX
-********************************************************************
-* MODIFICAIONS:
-********************************************************************
-*
-* This program extracts data for the series of basic hotel location listing
-* reports.  Based on the user profile selected, one of many report
-* formats will be produced.  
-*
-*DATE       NAME          DESCRIPTION
-*4/17/01    TANDT-SS      ADDED DOD_TYPE.
-*7/20/01    TANDT-SS      ADDED AGENT_NUM.
-*4/16/02    TANDT-DB      ADDED DEFINE FOR CHKIN_MONTH
-*8/06/02    TANDT-DB      ADDED DEFINE FOR RATE_GRP2
-*11/5/02    TANDT-DB      ADDED DEFINE FOR PROP_ZIP5
-*08/22/03   TANDT-DV      ADDED GSA_GTR
-*10/08/03   TANDT-DV      ADDED AROLL_LEV6 AROLL_LEV7 AROLL_LEV8 AROLL_LEV9
-*12/02/03   TANDT-DV      ADDED AROLL_LEV5  ADDED FOP FOP2 DEFINE
-*12/10/03   TANDT-DV      ADDED AROLL_LEV4
-*03/31/04   TANDT-DV      CHANGED BOOKINGS DEFINE PER STEVE
-*5/11/04    TANDT-JK      ADDED MX_DAY DEFINE
-*5/11/04    TANDT-JK      MODIFIED BOOKINGS DEFINE TO BACK OUT NEGATIVES
-*6/15/04    TANDT-DV      ADDED XLEVEL3 XLEV_3 DEFINES
-*6/22/04    TANDT-SC      ADDED RESV_STATUS
-*8/26/04    TANDT-DV      ADDED GROSS_BOOK DEFINE 
-*9/24/04    TANDT-DV      ADDED CODE FOR GLOBAL CURRENCY
-*10/27/04   TANDT-JK      ADDED PROD_COD DEFINE
-*11/3/04    TANDT-JK      ADDED IN_MONTH DEFINE
-*11/17/04   TANDT-JK      ADDED LVL3 DEFINE
-*12/28/04   DEB           ADDED DOD_TYPE 'J' TO IBOOK DEFINE
-*10/11/05   DEB           ADDED DOD_TYPE 'H' TO IBOOK DEFINE
-*10/31/06   DEB           ADDED BK_SRC DEFINE
-*4/26/07    DEB           ADDED XLVL3 DEFINE FOR WERNER REPORT
-*5/09/07    STEVE         CHANGED BOOKINGS to GE from GT
-*7/23/07    DEB           ADDED KB_AGT DEFINE  
-*11/6/07    DEB           ADDED CARD_POS AND CCNUM1 DEFINE
-*01/08/08   DEB           ADDED SH_LVL DEFINE
-*04/28/10   STEVE         CHANGED RATE_GRP AND RATE_GRP2 FOR ROUNDING
-*6/11/13    Joy           Added Hotel Ranking Define for new standard Report
-*9/17/13    Joy           Added week defines
-*9/18/13    Joy           Updated Pref/Non-Flag 
-*11/6/13    Deb           Chanaged IBOOK verbiage per Kate A
-*1/29/14 UPDATED ONLINE/TRADITIONAL DEFINES TO USE ONLINE_TRADITIONAL FIELD INSTEAD OF DOD_TYPE
-*3/12/14    Joy           Updated descriptions within the HTL_PREF_RNK Define per Neely
-*4/29/14    Joy           Updated to include the new client pref file join
-*9/8/14     Deb           Added L_NAME define GEO_ZONE
-* 9/9/14 Updated Pref_non define to use exclude_flags - jk
-*11/25/15  Joy    S-07987  Corrected for running Currency Enabled Version
-*02/12/16 - DLV - S-13284  Updated to allow reports to sort/subtotal by id-levels
-*3/2/16 - JEM -S-16367 Updated hard coded d:\ to use &&WFSRV1.EVAL
-*07/14/16   RSB   S-20630 - New Employee ID database field
-*                 Changed LEVEL1 to EMP_ID in the Define and added EMP_ID to the Table requests.
-*                 Also needed to add EMP_ID to CPREFJOIN.fex
-*8/29/16-S-24005-JEM Added define for Kohtldtl that if category ne 'group' it will show level1 or if category is group it will show level5

-********************************************************************
SET ASNAMES = ON
SET WEEKFIRST= 1
-SET HOLDATTR = ON;
-RUN
-*SET TEMPERASE=OFF
-INCLUDE SETECHO


FI UPTKTLS2 DISK &&WFSRV1.EVAL\TNT\TTRACKER\TEMP\UPTKTLS2.TXT
-SET &RPARM = &&WEB_PATH || 'RPTPARMS.fex';

-SET &&IDLEVELBREAK = '';
-RUN

-SET &HTLDATES = &&WEB_PATH || 'HTLDATES.fex';
-SET &&HTLHLD = 'HTLHLD';

-INCLUDE IDLEVROLLDEF
-RUN

DEFINE FILE &&EXTRACT

  CARD_NUM/A12 = EDIT(CC_NUM, '$$999999999999$$$$');
  CHKIN_MONTH/MT  = CHKIN_DATE;
  CARD_POS/I2  = POSIT (CREDIT_CARD, 18, ' ', 2, 'I2');

  CARD1_NUM/A4 = EDIT(CC_NUM, '$$$$$$$$$$$$$$9999');  
  CARD2_NUM/A5 = EDIT(CREDIT_CARD, '$$$$$$$$$$$$$99999');
  CHG_COD/A47 = IF LEVEL3 NE ' ' AND LEVEL2 NE ' ' THEN
                 EMP_ID  || '-' || LEVEL2 || '-' ||LEVEL3 ELSE
                 IF LEVEL3 EQ ' ' AND LEVEL2 NE ' ' THEN
                 EMP_ID  || '-' || LEVEL2 ELSE
                 IF LEVEL3 EQ ' ' AND LEVEL2 EQ ' ' THEN EMP_ID;

  CHN_GRP/A3 = CHAIN_GROUP;

  CITY_ST/A35 = PROP_CITY||(', '| PROP_STATE);
  BK_SRC/A13 = IF ENTRY_SOURCE EQ '1' THEN 'GDS BOOKED' ELSE 'DIRECT BOOKED';
  BWS_DPT/A1 = EDIT(LEVEL2, '9$$$$$$$$$$$$$$');
  BWS_DPT1/A2 = EDIT(LEVEL2, '99$$$$$$$$$$$$$');
  FOP/A2 = EDIT(CC_NUM,'99$$$$$$$$$$$$$$$$');
  FOP2/A7 = IF FOP EQ 'AX' THEN EDIT(CC_NUM, '99$$$$$$$$$$99999')
              ELSE EDIT(CC_NUM, '99$$$$$$$$$$$$9999');             
              
                
                
  ID_FLAG/A1 = IF CITY.INTL_DOM EQ 'D' THEN 'D' ELSE 'I';
  KB_AGT/A9 = IF AGENT_NUM EQ '00111' THEN 'NO TOUCH' ELSE 'LOW TOUCH';
  L_NAME/A25 = GETTOK(PASSNGR_NAME, 33, 1, '/', 25, L_NAME);

  LEV_1/A10 = EDIT(EMP_ID, '9999999999$$$$$');
  LEV_2/A15 = IF PASSNGR_NAME NE LAST PASSNGR_NAME THEN LEVEL2 ELSE ' ';
  LEVEL_DESC1/A60  = &&LDESC;
-*  IBOOK/A13 = IF DOD_TYPE EQ 'H' OR 'I' OR 'J' THEN 'INTERNET' ELSE 'NON-INTERNET';
  IBOOK/A13 = IF ONLINE_TRADITIONAL EQ 'ONLINE' THEN 'ONLINE' ELSE 'TRADITIONAL';
  -* IBOOK/A33 = ONLINE_TRADITIONAL;
             
  IN_DATE/MDYY = CHKIN_DATE;
  IN_MONTH/MTYY = CHKIN_DATE;
  INV_MO/MTYY  = INVOICE_DATE;
  INV_DATE/MDYY = INVOICE_DATE;
  KOLEV/A20 = IF CATEGORY NE 'GROUP' THEN LEVEL1 ELSE LEVEL5;
  
  LVL3/A15 = IF LEVEL3 EQ ' ' THEN 'NONE GIVEN' ELSE LEVEL3;
  NBR_DAYS/D12 =  NUM_DAYS;
  NBR_ROOMS/D12 = NUM_ROOMS;
  NEW_ROOM_RATE/D14.2C = ROOM_RATE;
  NEW_STD_RATE/D14.2C = STD_RATE;
  NEW_TOTAL_AMT/D14.2C = TOTAL_AMT;
  NNROOMS/D12 = IF ((NBR_DAYS LT 0) AND (NUM_ROOMS LT 0)) THEN 
                ((NBR_DAYS*NUM_ROOMS) * (-1)) ELSE NBR_DAYS*NUM_ROOMS;
  OUT_DATE/MDYY = CHKOUT_DATE;
 
  PROD_COD/A9 = EDIT(LEVEL3, '$$$$$$999999999');
  
  RATE_GRP/A15 = IF ((ROOM_RATE GE 0 AND ROOM_RATE LT 149.50) OR
                      (ROOM_RATE LE 0 AND ROOM_RATE GT (-149.50)))
                   THEN '$0 - $149' ELSE
                   IF ((ROOM_RATE GE 149.50 AND ROOM_RATE LT 199.50) OR
                      (ROOM_RATE LE (-149.50) AND ROOM_RATE GT (-199.50)))
                   THEN '$150 - $199' ELSE
                   IF ((ROOM_RATE GE 199.50 AND ROOM_RATE LT 249.50) OR
                      (ROOM_RATE LE (-199.50) AND ROOM_RATE GT (-249.50)))
                   THEN '$200 - $249' ELSE '$250 OR GREATER';
  RATE_GRP2/A15 =IF ((ROOM_RATE GE 0 AND ROOM_RATE LT 99.50) OR
                       (ROOM_RATE LE 0 AND ROOM_RATE GT (-99.50)))
                   THEN '$0 - $99' ELSE
                   IF ((ROOM_RATE GE 99.50 AND ROOM_RATE LT 150.50) OR
                       (ROOM_RATE LE (-99.50) AND ROOM_RATE GT (-150.50)))
                   THEN '$100 - $150' ELSE
                   IF ((ROOM_RATE GE 150.50 AND ROOM_RATE LT 200.50) OR
                      (ROOM_RATE LE (-150.50) AND ROOM_RATE GT (-200.50)))
                   THEN '$151 - $200' ELSE '$201 OR GREATER';
    
-* RATE_GRP/A15 = IF ((ROOM_RATE GE 0 AND ROOM_RATE LT 150) OR
-*                      (ROOM_RATE LE 0 AND ROOM_RATE GT (-150)))
-*                  THEN '$0 - $149' ELSE
-*                  IF ((ROOM_RATE GE 150 AND ROOM_RATE LE 199) OR
-*                      (ROOM_RATE LE (-150) AND ROOM_RATE GE (-199)))
-*                  THEN '$150 - $199' ELSE
-*                  IF ((ROOM_RATE GE 200 AND ROOM_RATE LE 249) OR
-*                      (ROOM_RATE LE (-200) AND ROOM_RATE GE (-249)))
-*                  THEN '$200 - $249' ELSE '$250 OR GREATER';
-*   RATE_GRP2/A15 =IF ((ROOM_RATE GE 0 AND ROOM_RATE LT 100) OR
-*                      (ROOM_RATE LE 0 AND ROOM_RATE GT (-100)))
-*                  THEN '$0 - $99' ELSE
-*                  IF ((ROOM_RATE GE 100 AND ROOM_RATE LE 150) OR
-*                      (ROOM_RATE LE (-100) AND ROOM_RATE GE (-150)))
-*                  THEN '$100 - $150' ELSE
-*                  IF ((ROOM_RATE GE 151 AND ROOM_RATE LE 200) OR
-*                      (ROOM_RATE LE (-151) AND ROOM_RATE GE (-200)))
-*                  THEN '$151 - $200' ELSE '$201 OR GREATER';
  REASON_CD/A2=EDIT(REFUSE_KEY,'$$$$$$$$99');
  REFUSE_CD/A2=EDIT(REFUSE_KEY,'$$$$$$$$99');
  RSNCDE/A48=REFUSE_CD|| '-' ||REFUSAL_DESC;
  ROLLPREF_KEY/A9 = ROLLUP_CODE|CLIENT_PREF;
  SH_LVL/A2 = EDIT(LEVEL2, '99');
  XPSNGR_NM/A15 =EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
  PROP_ZIP5/A5=EDIT(PROP_ZIP, '99999$$$$$');
  PRP_ADDRSS/A18 = EDIT(PROP_ADDRESS,'999999999999999999$$$$$$$$$$$$');
  PRP_NM/A15 = EDIT(PROP_NAME, '999999999999999$$$$$$$$$$$$$$$');
  XLEVEL3/A5 = EDIT(LEVEL3, '99999$$$$$$$$$$');
  XLEV_3/A3 = EDIT(LEVEL3, '$$$$$$999$$$$$$');
  XLVL3/A2 = EDIT(LEVEL3, '$$$99$$$$$$$$$$');
-* ****DEFINES ON PREVIOUS DEFINES****
   CARD3_NUM/A6 = IF FOP EQ 'AX'  OR 'DL' OR 'TP' THEN EDIT(CREDIT_CARD, '$$$$$$$$$$$999999$') ELSE
                                     EDIT(CREDIT_CARD, '$$$$$$$$$$$$999999')  ;
   GROSS_BOOK/D8 = IF NEW_TOTAL_AMT GE 0 THEN 1 ELSE 0;
   BOOKINGS/D8 = IF NEW_TOTAL_AMT GE 0 THEN 1 ELSE (-1);
-*                  IF NEW_TOTAL_AMT LT 0 THEN (-1) ELSE 0;
   MX_DY/I6 = IF NBR_DAYS LT 1 THEN NBR_DAYS * (-1)
              ELSE NBR_DAYS;
   MXREFUSE_CD/A9 = IF REFUSE_CD EQ 'A' OR 'C' THEN 'A OR C'
                    ELSE 'ALL OTHER';
   TOTAL_STD/D12.2C = IF ((NNROOMS LT 0) AND (NEW_STD_RATE LT 0))
                      THEN ((NNROOMS * NEW_STD_RATE) * (-1))
                      ELSE NNROOMS * NEW_STD_RATE;
-*    PREF_NON/A15 = IF REFUSE_CD EQ 'A' OR 'T' OR 'R' THEN 'PREFERRED'
-*                   ELSE 'NON-PREFERRED';
 PNP_FLAG/A1 = EDIT(EXCLUDE_FLAGS, '$9');
 PNP_IE/A1 = EDIT(EXCLUDE_FLAGS, '$$9');
-* PREF_NON/A15 = IF CLIENT_PREF EQ 'C' OR 'P' OR 'N' OR 'M' OR 'L'  THEN 'PREFERRED' ELSE 'NON-PREFERRED';
 PREF_NON/A15 = IF PNP_FLAG EQ 'I'  THEN 'PREFERRED' ELSE 'NON-PREFERRED';

-* ****DEFINES ON PREVIOUS DEFINED DEFINES***
   TOTAL_SLSAV/D12.2C = TOTAL_STD - NEW_TOTAL_AMT;
   UP_STD/D12.2C = NEW_STD_RATE/NNROOMS;
   CCNUM1/A4 = IF CARD_POS EQ 0 OR 1 THEN EDIT(CREDIT_CARD, '$$$$$$$$$$$$$$9999') ELSE
                                       EDIT(CREDIT_CARD, '$$$$$$$$$$$$$9999$');
   AROLL_LEV/A15 = &&AROLL_LEV;   
MIR_SEQ1/A1 = EDIT(MIR_SEQ, '9$$$$$');

RES_SYS/A1 = IF MIR_SEQ1 EQ 'X' THEN 'S' ELSE 'A';

PROP_CODE1/A7 = IF RES_SYS EQ 'S' THEN PROP_SABRE_CODE ELSE PROP_APOLLO_CODE;
-* DEFINES ADDED TO NUMBER WEEKS
DT1/HYYMD = HDTTM(CHKIN_DATE, 8, 'HYYMDIA');
WEEK_NBR/I2 = HPART(DT1, 'WEEK', 'I2');
-INCLUDE IDLEVDEFINE  

  
END
-RUN

TABLEF FILE &&EXTRACT
PRINT AIRPORT_CODE
  AGENT_NUM 
  ALPHA_RATE    
  AR_BRANCH
  AROLL_DSC1
  AROLL_DSC2
  AROLL_DSC3
  AROLL_DSC4
  AROLL_DSC5
  AROLL_DSC6
  AROLL_DSC7
  AROLL_DSC8
  AROLL_DSC9
  AROLL_DSC10
  AROLL_DSC11
  AROLL_DSC12
  AROLL_DSC13
  AROLL_DSC14
  AROLL_DSC15
  BK_SRC
  BOOKINGS  
  BR_CL_IDX 
  CARD_NUM
  CARD_POS
  CARD1_NUM
  CARD2_NUM
  CARD3_NUM
  CCNUM1
  CHAIN_CODE    
  CHAIN_NAME
  CHG_COD
  CHKIN_DATE
  CHKIN_MONTH
  CHKOUT_DATE
  CHN_GRP
  CITY_ST
  CITY.COUNTRY_CODE AS 'COUNTRY'
  CLIENT_NAME  
  CC_NUM
  CURR_DATE
  DAILY_RATE
  DOD_TYPE
  FOP2
  CITY.GEO_ZONE AS 'GEO_ZONE'
  GROSS_BOOK
  GSA_GTR   
  HHL_CONFIRM   
  HOTEL_PHONE   
  HTL_KEY
  IBOOK
  ID_FLAG
  IN_DATE   
  IN_MONTH
  INV_DATE
  INV_MO
  INVOICE_DATE  
  INVOICE_NUM 
  KB_AGT
  KOLEV
  L_NAME
  LEV_1
  LEV_2 
  LEVEL_DESC    
  AROLL_LEV
  EMP_ID
  KOLEV
  LEVEL1
  LEVEL2    
  LEVEL3 
  LEVEL4
  LEVEL5
  LVL3
  MX_DY
  MXREFUSE_CD   
  NBR_DAYS  
  NBR_ROOMS
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT 
  NNROOMS   
  NUM_DAYS  
  NUM_ROOMS 
  OUT_DATE  
  PASSNGR_NAME  
  PNR_LOCATOR
  PREF_NON
  PROD_COD
  PROP_ADDRESS  
  PROP_CITY 
  PROP_CODE1 AS 'PROP_CODE'
  PROP_CNTRY    
  PROP_NAME     
  PROP_STATE_CD 
  PROP_ZIP5
  PRP_ADDRSS
  PRP_NM
  RATE_CODE
  RATE_GRP
  RATE_GRP2 
  REFUSAL_DESC  
  REFUSE_CD 
  REFUSE_KEY
  RESV_BRANCH
  RESV_DATE
  RESV_STATUS   
  ROOM_RATE     
  ROOM_TYPE
  ROLLPREF_KEY
  RSNCDE    
  STD_RATE  
  TICKET_BRANCH 
  TKT_NUM   
  TOTAL_AMT     
  TOTAL_SLSAV
  TOTAL_STD 
  UP_STD
  WEEK_NBR
  XPSNGR_NM
  XLEVEL3
  XLEV_3
  XLVL3
-INCLUDE AROLLLEVELS  
-INCLUDE BYHIERARCHY
-INCLUDE &HTLDATES  
-*WHERE INVOICE_DATE GE &&FROMDT.EVAL AND INVOICE_DATE LE &&TODT.EVAL
-* WHERE TOTAL_AMT NE 0
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10

-* -INCLUDE RPTPARMS
-INCLUDE &RPARM

ON TABLE HOLD AS HHOLD
END
-RUN


-INCLUDE CPREFJOIN
-RUN

TABLE FILE CPHLD
PRINT AIRPORT_CODE
  AGENT_NUM 
  ALPHA_RATE    
  AR_BRANCH
  AROLL_DSC1
  AROLL_DSC2
  AROLL_DSC3
  AROLL_DSC4
  AROLL_DSC5
  AROLL_DSC6
  AROLL_DSC7
  AROLL_DSC8
  AROLL_DSC9
  AROLL_DSC10
  AROLL_DSC11
  AROLL_DSC12
  AROLL_DSC13
  AROLL_DSC14
  AROLL_DSC15
  BK_SRC
  BOOKINGS  
  BR_CL_IDX 
  CARD_NUM
  CARD_POS
  CARD1_NUM
  CARD2_NUM
  CARD3_NUM
  CCNUM1
  CHAIN_CODE    
  CHAIN_NAME
  CHG_COD
  CHKIN_DATE
  CHKIN_MONTH
  CHKOUT_DATE 
  CHN_GRP
  CITY_ST
  CLIENT_NAME   
  COUNTRY
  CC_NUM
  DAILY_RATE
  DOD_TYPE
  FOP2
  GEO_ZONE
  GROSS_BOOK
  GSA_GTR   
  HHL_CONFIRM   
  HOTEL_PHONE   
  HTL_KEY
  HTL_PREF_DESC AS 'HTL_PREF_RNK'
  IBOOK 
  ID_FLAG
  IN_DATE   
  IN_MONTH
  INV_DATE
  INV_MO
  INVOICE_DATE  
  INVOICE_NUM 
  KB_AGT
  KOLEV
  L_NAME
  LEV_1
  LEV_2 
  LEVEL_DESC   
  AROLL_LEV
  EMP_ID  
  LEVEL1
  LEVEL2    
  LEVEL3 
  LEVEL4
  LEVEL5
  LVL3
  MX_DY
  MXREFUSE_CD   
  NBR_DAYS  
  NBR_ROOMS
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT 
  NNROOMS   
  NUM_DAYS  
  NUM_ROOMS 
  OUT_DATE  
  PASSNGR_NAME  
  PNR_LOCATOR 
  PREF_NON
  PROD_COD
  PROP_ADDRESS  
  PROP_CITY 
  PROP_CODE
  PROP_CNTRY    
  PROP_NAME     
  PROP_STATE_CD 
  PROP_ZIP5
  PRP_ADDRSS
  PRP_NM
  RATE_CODE
  RATE_GRP
  RATE_GRP2 
  REFUSAL_DESC  
  REFUSE_CD 
  REFUSE_KEY
  RESV_BRANCH
  RESV_DATE
  RESV_STATUS   
  ROOM_RATE     
  ROOM_TYPE
  RSNCDE    
  STD_RATE  
  TICKET_BRANCH 
  TKT_NUM   
  TOTAL_AMT     
  TOTAL_SLSAV
  TOTAL_STD 
  UP_STD
  WEEK_NBR
  XPSNGR_NM
  XLEVEL3
  XLEV_3
  XLVL3 
-INCLUDE AROLLLEVELS    
-INCLUDE BYHIERARCHY
BY CURR_DATE 
ON TABLE HOLD AS HTLHOLD FORMAT FOCUS INDEX CURR_DATE
END
-RUN


-* Global Reporting JOIN
JOIN HTLHOLD.CURR_DATE IN HTLHOLD TO GLOBAL.DATE IN GLOBAL AS J1
END

DEFINE FILE HTLHOLD
NAMEC/A30 = CNAME;
  AMT_TOTAL/D12.2 = NEW_TOTAL_AMT;

-******************************************************************************
-*                         Global Currency Conversion Defines
-******************************************************************************
CURR1X/D20.6 = 1 / USDPU ;

-* DEFINES ON PREVIOUS DEFINES
AMT_TOTALX/D20.6 = AMT_TOTAL * CURR1X;
AMT_TOTL1/D20.6C = AMT_TOTALX;
RATE_ROOMX/D20.6 = NEW_ROOM_RATE * CURR1X;
RATE_ROOM1/D20.6 = RATE_ROOMX;
TOTAL_SLSAVX/D20.6 = TOTAL_SLSAV;
TOTAL_SLSAV1/D16.2 = TOTAL_SLSAVX;
END


TABLE FILE HTLHOLD
PRINT AIRPORT_CODE
  AGENT_NUM 
  ALPHA_RATE    
  AR_BRANCH
-*  AROLL_LEV4
-*  AROLL_LEV5
-*  AROLL_LEV6
-*  AROLL_LEV7
-*  AROLL_LEV8
-*  AROLL_LEV9
  AROLL_DSC1
    AROLL_DSC2
    AROLL_DSC3
    AROLL_DSC4
    AROLL_DSC5
    AROLL_DSC6
    AROLL_DSC7
    AROLL_DSC8
    AROLL_DSC9
    AROLL_DSC10
    AROLL_DSC11
    AROLL_DSC12
    AROLL_DSC13
    AROLL_DSC14
  AROLL_DSC15
  BK_SRC
  BOOKINGS  
  BR_CL_IDX 
  CARD_NUM
  CARD_POS
  CARD1_NUM
  CARD2_NUM
  CARD3_NUM
  CCNUM1
  CHAIN_CODE    
  CHAIN_NAME
  CHG_COD
  CHKIN_DATE
  CHKIN_MONTH
  CHKOUT_DATE
  CHN_GRP
  CITY_ST
  CLIENT_NAME   
  COUNTRY
  CC_NUM
  DAILY_RATE
  DOD_TYPE
  FOP2
  GEO_ZONE
  GROSS_BOOK
  GSA_GTR   
  HHL_CONFIRM   
  HOTEL_PHONE 
  HTL_KEY
  HTL_PREF_RNK
  IBOOK 
  ID_FLAG
  IN_DATE   
  IN_MONTH
  INV_DATE
  INV_MO
  INVOICE_DATE  
  INVOICE_NUM 
  KB_AGT
  KOLEV
  L_NAME
  LEV_1
  LEV_2 
  LEVEL_DESC   
  AROLL_LEV
  EMP_ID   
  LEVEL1
  LEVEL2    
  LEVEL3 
  LEVEL4
  LEVEL5
  LVL3
  MX_DY
  MXREFUSE_CD   
  NBR_DAYS  
  NBR_ROOMS
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT 
  NNROOMS   
  NUM_DAYS  
  NUM_ROOMS 
  OUT_DATE  
  PASSNGR_NAME  
  PNR_LOCATOR
  PREF_NON
  PROD_COD
  PROP_ADDRESS  
  PROP_CITY 
  PROP_CODE
  PROP_CNTRY    
  PROP_NAME     
  PROP_STATE_CD 
  PROP_ZIP5
  PRP_ADDRSS
  PRP_NM
  RATE_CODE
  RATE_GRP
  RATE_GRP2 
  REFUSAL_DESC  
  REFUSE_CD 
  REFUSE_KEY
  RESV_BRANCH
  RESV_DATE
  RESV_STATUS   
  ROOM_RATE     
  ROOM_TYPE
  RSNCDE    
  STD_RATE  
  TICKET_BRANCH 
  TKT_NUM   
  TOTAL_AMT     
  TOTAL_SLSAV1 AS 'TOTAL_SLSAV'
  TOTAL_STD 
  UP_STD
  XPSNGR_NM
  XLEVEL3
  XLEV_3
  XLVL3
  NAMEC
  AMT_TOTALX
  AMT_TOTL1
  RATE_ROOM1
  WEEK_NBR
-INCLUDE AROLLLEVELS    
-INCLUDE BYHIERARCHY
WHERE GLOBAL.COUNTRYCODE EQ '&&CURRENCY'
ON TABLE HOLD AS HTLHLD
END
-RUN
 
-SET &&RPT_HOLD = 'HTLHLD';
-XXIT

 
 