-* File HROM_DOM_INT_UPD.fex


SET ASNAMES=ON
-RUN

-JKK;
USE 
D:\ibi\apps\STEVE_PROJECTS\A7HROM.FOC AS A7HROM
D:\ibi\apps\STEVE_PROJECTS\A8HROM.FOC AS A8HROM
D:\ibi\apps\STEVE_PROJECTS\A9HROM.FOC AS A9HROM
D:\ibi\apps\STEVE_PROJECTS\A0HROM.FOC AS A0HROM
D:\ibi\apps\STEVE_PROJECTS\AYHROM.FOC AS AYHROM
D:\ibi\apps\STEVE_PROJECTS\AZHROM.FOC AS AZHROM
D:\ibi\apps\STEVE_PROJECTS\T7HROM.FOC AS T7HROM
D:\ibi\apps\STEVE_PROJECTS\T8HROM.FOC AS T8HROM
D:\ibi\apps\STEVE_PROJECTS\T9HROM.FOC AS T9HROM
D:\ibi\apps\STEVE_PROJECTS\T0HROM.FOC AS T0HROM
D:\ibi\apps\STEVE_PROJECTS\TYHROM.FOC AS TYHROM
D:\ibi\apps\STEVE_PROJECTS\TZHROM.FOC AS TZHROM
D:\ibi\apps\STEVE_PROJECTS\S7HROM.FOC AS S7HROM
D:\ibi\apps\STEVE_PROJECTS\S8HROM.FOC AS S8HROM
D:\ibi\apps\STEVE_PROJECTS\S9HROM.FOC AS S9HROM
D:\ibi\apps\STEVE_PROJECTS\S0HROM.FOC AS S0HROM
D:\ibi\apps\STEVE_PROJECTS\SYHROM.FOC AS SYHROM
D:\ibi\apps\STEVE_PROJECTS\SZHROM.FOC AS SZHROM
D:\ibi\apps\STEVE_PROJECTS\M7HROM.FOC AS M7HROM
D:\ibi\apps\STEVE_PROJECTS\M8HROM.FOC AS M8HROM
D:\ibi\apps\STEVE_PROJECTS\M9HROM.FOC AS M9HROM
D:\ibi\apps\STEVE_PROJECTS\M0HROM.FOC AS M0HROM
D:\ibi\apps\STEVE_PROJECTS\MYHROM.FOC AS MYHROM
D:\ibi\apps\STEVE_PROJECTS\MZHROM.FOC AS MZHROM
D:\ibi\apps\STEVE_PROJECTS\D7HROM.FOC AS D7HROM
D:\ibi\apps\STEVE_PROJECTS\D8HROM.FOC AS D8HROM
D:\ibi\apps\STEVE_PROJECTS\D9HROM.FOC AS D9HROM
D:\ibi\apps\STEVE_PROJECTS\D0HROM.FOC AS D0HROM
D:\ibi\apps\STEVE_PROJECTS\DYHROM.FOC AS DYHROM
D:\ibi\apps\STEVE_PROJECTS\DZHROM.FOC AS DZHROM
D:\ibi\apps\STEVE_PROJECTS\AIRPORT.FOC AS AIRPORT

END

-* -GOTO SEGUPD;
-* -GOTO JEK;

-* QUARTER DATABASE 1
-* BLANK OUT AIR.INTL_DOM ON ALL RECORDS


TABLE FILE A7HROM
PRINT AIR_KEY INTL_DOM 
BY AIR_KEY NOPRINT
ON TABLE HOLD 
END
-RUN

MODIFY FILE A7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE A8HROM
PRINT AIR_KEY INTL_DOM 
BY AIR_KEY NOPRINT
ON TABLE HOLD 
END
-RUN

MODIFY FILE A8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE A9HROM
PRINT AIR_KEY INTL_DOM 
BY AIR_KEY NOPRINT
ON TABLE HOLD 
END
-RUN

MODIFY FILE A9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE A0HROM
PRINT AIR_KEY INTL_DOM 
BY AIR_KEY NOPRINT
ON TABLE HOLD 
END
-RUN

MODIFY FILE A0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE AYHROM
PRINT AIR_KEY INTL_DOM 
BY AIR_KEY NOPRINT
ON TABLE HOLD 
END
-RUN

MODIFY FILE AYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE AZHROM
PRINT AIR_KEY INTL_DOM 
BY AIR_KEY NOPRINT
ON TABLE HOLD 
END
-RUN

MODIFY FILE AZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-JEK;

-* UPDATE AIR.INTL_DOM BASED ON INTERNATIONAL GEO ZONES
JOIN CLEAR *
JOIN AIR_KEY IN A7HROM TO ALL AIR_KEY IN T7HROM AS J1
-RUN

TABLE FILE A7HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
ON TABLE HOLD 
END
-RUN

MODIFY FILE A7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN A8HROM TO ALL AIR_KEY IN T8HROM AS J1
-RUN

TABLE FILE A8HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
ON TABLE HOLD 
END
-RUN

MODIFY FILE A8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN A9HROM TO ALL AIR_KEY IN T9HROM AS J1
-RUN

TABLE FILE A9HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
ON TABLE HOLD 
END
-RUN

MODIFY FILE A9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN A0HROM TO ALL AIR_KEY IN T0HROM AS J1
-RUN

TABLE FILE A0HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
ON TABLE HOLD 
END
-RUN

MODIFY FILE A0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN AYHROM TO ALL AIR_KEY IN TYHROM AS J5
-RUN

TABLE FILE AYHROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
ON TABLE HOLD 
END
-RUN

MODIFY FILE AYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN AZHROM TO ALL AIR_KEY IN TZHROM AS J5
-RUN

TABLE FILE AZHROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
ON TABLE HOLD 
END
-RUN

MODIFY FILE AZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* UPDATE AIR.INTL_DOM BASED ON COUNTRY CODE - MX

JOIN CLEAR *
JOIN AIR_KEY IN A7HROM TO ALL AIR_KEY IN T7HROM AS J1
-RUN


TABLE FILE A7HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE CTRY_COD CONTAINS 'MX'
ON TABLE HOLD 
END
-RUN

MODIFY FILE A7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN A8HROM TO ALL AIR_KEY IN T8HROM AS J1
-RUN

TABLE FILE A8HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE CTRY_COD CONTAINS 'MX'
ON TABLE HOLD 
END

MODIFY FILE A8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN A9HROM TO ALL AIR_KEY IN T9HROM AS J1
-RUN


TABLE FILE A9HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE CTRY_COD CONTAINS 'MX'
ON TABLE HOLD 
END

MODIFY FILE A9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN A0HROM TO ALL AIR_KEY IN T0HROM AS J1
-RUN


TABLE FILE A0HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE CTRY_COD CONTAINS 'MX'
ON TABLE HOLD 
END

MODIFY FILE A0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN AYHROM TO ALL AIR_KEY IN TYHROM AS J1
-RUN

TABLE FILE AYHROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE CTRY_COD CONTAINS 'MX'
ON TABLE HOLD 
END

MODIFY FILE AYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN AZHROM TO ALL AIR_KEY IN TZHROM AS J1
-RUN

TABLE FILE AZHROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE CTRY_COD CONTAINS 'MX'
ON TABLE HOLD 
END

MODIFY FILE AZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* UPDATE AIR.INTL_DOM BASED ON GEO_ZONE - LAM

JOIN CLEAR *
JOIN AIR_KEY IN A7HROM TO ALL AIR_KEY IN T7HROM AS J1
-RUN

TABLE FILE A7HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'LAM'
ON TABLE HOLD 
END

MODIFY FILE A7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN A8HROM TO ALL AIR_KEY IN T8HROM AS J1
-RUN

TABLE FILE A8HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'LAM'
ON TABLE HOLD 
END

MODIFY FILE A8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN A9HROM TO ALL AIR_KEY IN T9HROM AS J1
-RUN

TABLE FILE A9HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'LAM'
ON TABLE HOLD 
END

MODIFY FILE A9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN A0HROM TO ALL AIR_KEY IN T0HROM AS J1
-RUN

TABLE FILE A0HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'LAM'
ON TABLE HOLD 
END

MODIFY FILE A0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN AYHROM TO ALL AIR_KEY IN TYHROM AS J1
-RUN

TABLE FILE AYHROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'LAM'
ON TABLE HOLD 
END

MODIFY FILE AYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN CLEAR *
JOIN AIR_KEY IN AZHROM TO ALL AIR_KEY IN TZHROM AS J1
-RUN

TABLE FILE AZHROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
WHERE GEO_ZONE CONTAINS 'LAM'
ON TABLE HOLD 
END

MODIFY FILE AZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* UPDATE AIR.INTL_DOM REMAINING RECORDS TO "D"

TABLE FILE A7HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
ON TABLE HOLD 
END

MODIFY FILE A7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE A8HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
ON TABLE HOLD 
END

MODIFY FILE A8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE A9HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
ON TABLE HOLD 
END

MODIFY FILE A9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE A0HROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
ON TABLE HOLD 
END

MODIFY FILE A0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE AYHROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
ON TABLE HOLD 
END

MODIFY FILE AYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE AZHROM
PRINT INTL_DOM
BY AIR_KEY
WHERE INTL_DOM EQ ' '
ON TABLE HOLD 
END

MODIFY FILE AZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-SEGUPD
-****************************************************
-* CITYPAIR RECORDS UPDATED
-****************************************************
-* SEGMENT
-* BLANK OUT INTL_DOM FLAG ON ALL RECORDS

TABLE FILE S7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END


TABLE FILE S8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE S9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE S0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE S0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE SYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE SYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE SZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE SZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* UPDATE BASED ON EMBARK INTERNATIONAL GEO ZONE
JOIN CLEAR *
JOIN EMBARKX IN S7HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE S7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END
-RUN

MODIFY FILE S7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN S8HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE S8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END
-RUN

MODIFY FILE S8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN S9HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE S9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END
-RUN

MODIFY FILE S9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN S0HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE S0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END
-RUN

MODIFY FILE S0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN SYHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE SYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END
-RUN

MODIFY FILE SYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN SZHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE SZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END
-RUN

MODIFY FILE SZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END



JOIN CLEAR *
JOIN ROUTEX IN S7HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE S7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN S8HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE S8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN S9HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE S9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN S0HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE S0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN SYHROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE SYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE SYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN SZHROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE SZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE SZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END


-* UPDATE BASED ON EMBARK COUNTRY CODE

JOIN CLEAR *
JOIN EMBARKX IN S7HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE S7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN S8HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE S8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN S9HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE S9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN S0HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE S0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN SYHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE SYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE SYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN SZHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE SZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE SZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

-* UPDATE BASED ON ROUTE COUNTRY CODE

JOIN CLEAR *
JOIN ROUTEX IN S0HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE S0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

-* UPDATE BASED ON ROUTE COUNTRY CODE
JOIN CLEAR *
JOIN ROUTEX IN S7HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE S7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN S9HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE S9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN S0HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE S0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE S0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN SYHROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE SYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE SYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN SZHROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE SZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE SZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END


-* UPDATE ALL REMAINING RECORDS TO "D"

TABLE FILE S7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE S7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE S8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE S8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE S9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE S9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE S0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE S0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE SYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE SYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE SZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE SZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END


-* MARKET
-* BLANK OUT INTL_DOM FLAG ON ALL RECORDS

TABLE FILE M7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE M8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE M9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE M0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE M0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE MYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE MYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE MZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE MZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END


-* UPDATE BASED ON EMBARK INTERNATIONAL GEO ZONE

JOIN CLEAR *
JOIN EMBARKX IN M7HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE M7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN M8HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE M8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN M9HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE M9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN M0HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE M0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN MYHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE MYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE MYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN MZHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE MZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE MZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END


-* UPDATE BASED ON ROUTE INTERNATIONAL GEO ZONE

JOIN CLEAR *
JOIN ROUTEX IN M7HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE M7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN M8HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE M8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN M9HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE M9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN M0HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE M0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN MYHROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE MYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE MYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN MZHROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE MZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE MZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END


-* UPDATE BASED ON EMBARK COUNTRY CODE

JOIN CLEAR *
JOIN EMBARKX IN M7HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE M7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN M8HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE M8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN M9HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE M9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN M0HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE M0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN MYHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE MYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE MYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN MZHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE MZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE MZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

-* UPDATE BASED ON ROUTE COUNTRY CODE

JOIN CLEAR *
JOIN ROUTEX IN M7HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE M7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN M8HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE M8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN M9HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE M9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN M0HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE M0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE M0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN MYHROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE MYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE MYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN MZHROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE MZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE MZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END


-* UPDATE ALL REMAINING RECORDS TO "D"

TABLE FILE M7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE M7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE M8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE M8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE M9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE M9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE M0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE M0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE MYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE MYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE MZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE MZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

-* DESTINATION
-* BLANK OUT INTL_DOM FLAG ON ALL RECORDS

TABLE FILE D7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE D8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE D9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE D0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE D0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE DYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE DYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE DZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END

MODIFY FILE DZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM=' ';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

-* UPDATE BASED ON EMBARK INTERNATIONAL GEO ZONE

JOIN CLEAR *
JOIN EMBARKX IN D7HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE D7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN D8HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE D8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN D9HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE D9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN D0HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE D0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN DYHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE DYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE DYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN DZHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE DZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE DZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

-* UPDATE BASED ON ROUTE INTERNATIONAL GEO ZONE

JOIN CLEAR *
JOIN ROUTEX IN D7HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE D7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN D8HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE D8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN D9HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE D9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN D0HROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE D0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN DYHROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE DYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE DYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN DZHROM TO ALL ROUTEX IN AIRPORT AS J1
-RUN

TABLE FILE DZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE GEO_ZONE EQ 'AFR' OR 'ASA' OR 'EUR' OR 'MES' OR 'PAC' OR 'SAM'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE DZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END


-* UPDATE BASED ON EMBARK COUNTRY CODE

JOIN CLEAR *
JOIN EMBARKX IN D7HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE D7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN D8HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE D8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN D9HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE D9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN D0HROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE D0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN DYHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE DYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE DYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN EMBARKX IN DZHROM TO ALL EMBARKX IN AIRPORT AS J1
-RUN

TABLE FILE DZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE DZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END


-* UPDATE BASED ON ROUTE COUNTRY CODE

JOIN CLEAR *
JOIN ROUTEX IN D7HROM TO ALL ROUTEX IN AIRPORT AS J1
END

TABLE FILE D7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN D8HROM TO ALL ROUTEX IN AIRPORT AS J1
END

TABLE FILE D8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN D9HROM TO ALL ROUTEX IN AIRPORT AS J1
END

TABLE FILE D9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN D0HROM TO ALL ROUTEX IN AIRPORT AS J1
END

TABLE FILE D0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE D0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN DYHROM TO ALL ROUTEX IN AIRPORT AS J1
END

TABLE FILE DYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE DYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

JOIN CLEAR *
JOIN ROUTEX IN DZHROM TO ALL ROUTEX IN AIRPORT AS J1
END

TABLE FILE DZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM COUNTRY_CODE GEO_ZONE
WHERE COUNTRY_CODE NE 'US' OR 'CA' OR 'MX'
WHERE INTL_DOM EQ ' '
ON TABLE HOLD
END

MODIFY FILE DZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='I';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

-* UPDATE ALL REMAINING RECORDS TO "D"

TABLE FILE D7HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE D7HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE D8HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE D8HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE D9HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE D9HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE D0HROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE D0HROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE DYHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE DYHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END

TABLE FILE DZHROM
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR INTL_DOM
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
WHERE INTL_DOM=' '
ON TABLE HOLD
END

MODIFY FILE DZHROM
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE INTL_DOM='D';
ON MATCH UPDATE INTL_DOM
ON NOMATCH REJECT
DATA ON HOLD
END
-****** END ********

