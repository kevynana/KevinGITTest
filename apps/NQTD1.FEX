-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Created for the new quarterly review - JK 8/2/05
-******************************************************************************

SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN


-GOTO NEXTPART
-IF &&OUTLINE1 CONTAINS 'ONLINE-FMT' OR 'PCHOLD' GOTO ONFMT;
-IF &&OUTFMT EQ 'PDF' THEN GOTO CFMT ELSE GOTO OFMT;
-RUN

-CFMT
-SET &&OUTLINE1 = 'ON TABLE SAVE AS SAVREP';
-SET &&OUTLINE2 = 'FORMAT PDF OPEN';
-SET &&RPTSUF = ' ';
-INCLUDE FDEFRPTS
-RUN
-GOTO NEXTPART

-OFMT
-SET &&RPTSUF = 'NEWQREV';
-INCLUDE FDEFRPTS
-RUN
-GOTO NEXTPART

-ONFMT
-IF &&OUTFMT NE 'PDF' GOTO ONFMT1;
-SET &&OUTLINE1 = 'ON TABLE PCHOLD';
-SET &&OUTLINE2 = 'FORMAT PDF OPEN';
-SET &&RPTSUF = '';
-RUN
-GOTO NEXTPART

-ONFMT1
-SET &&RPTSUF = '';
-RUN
-GOTO NEXTPART

-NEXTPART


-SET &&RPTSUF = 'NEWQREV';
-INCLUDE FDEFRPTS
-RUN

-SET &POS0=0;
-SET &INC = 11;
-SET &POS1T = &POS0 + 1 * &INC;

-SET &POS1 = &POS1T + 0;
-SET &POS2 = &POS1T + 6;
-SET &POS3 = &POS1T + 12;
-SET &POS4 = &POS1T + 18;
-SET &POS5 = &POS1T + 24;
-SET &POS6 = &POS1T + 30;
-SET &POS7 = &POS1T + 36;
-SET &POS8 = &POS1T + 42;

-SET &POS1A = &POS1 - 1;
-SET &POS2A = &POS2 - 1;
-SET &POS3A = &POS3 - 1;
-SET &POS4A = &POS4 - 1;
-SET &POS5A = &POS5 - 1;
-SET &POS6A = &POS6 - 1;
-SET &POS7A = &POS7 - 1;
-SET &POS8A = &POS8 - 1;

-SET &POSI1 = &POS0 + 69;
-SET &POSI2 = &POSI1 + 6;
-SET &POSI3 = &POSI2 + 6;
-SET &POSI4 = &POSI3 + 6;
-SET &POSI5 = &POSI4 + 6;
-SET &POSI6 = &POSI5 + 6;
-SET &POSI7 = &POSI6 + 6;
-SET &POSI8 = &POSI7 + 6;

-SET &POSI1A = &POSI1 - 1;
-SET &POSI2A = &POSI2 - 1;
-SET &POSI3A = &POSI3 - 1;
-SET &POSI4A = &POSI4 - 1;
-SET &POSI5A = &POSI5 - 1;
-SET &POSI6A = &POSI6 - 1;
-SET &POSI7A = &POSI7 - 1;
-SET &POSI8A = &POSI8 - 1;


-* YTD

-SET &POSYD1 = &POS0 + 82;
-SET &POSYD2 = &POSYD1 + 7;
-SET &POSYD3 = &POSYD2 + 7;
-SET &POSYD4 = &POSYD3 + 7;
-SET &POSYD5 = &POSYD4 + 6;
-SET &POSYD6 = &POSYD5 + 8;
-SET &POSYD7 = &POSYD6 + 6;
-SET &POSYD8 = &POSYD7 + 6;


-SET &POSYD1A = &POSYD1 - 1;
-SET &POSYD2A = &POSYD2 - 1;
-SET &POSYD3A = &POSYD3 - 1;
-SET &POSYD4A = &POSYD4 - 1;
-SET &POSYD5A = &POSYD5 - 1;
-SET &POSYD6A = &POSYD6 - 1;
-SET &POSYD7A = &POSYD7 - 1;
-SET &POSYD8A = &POSYD8 - 1;


DEFINE FILE SR_50  
  LEVEL_DESC/A60 = &&LDESC;
  FARE_PAID/D12 = SEG_AMT + SEG_TAX;
  NET_TKT_CNT/D10  =   IF (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) THEN 1 ELSE 
                        IF (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') AND (SEG_COUNT EQ -1)
				   THEN (-1) ELSE 
                        IF (DOC_TYPE NE '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') AND
				   (SEG_COUNT EQ -1)
				   THEN (-1) ELSE 0;

TKT_PURCH/D8CS      = IF (TICKET_CODE EQ '1') AND
                             (SEG_NBR EQ '01') AND
                             (FARE_PAID GE 0) AND
                             (SEG_COUNT EQ 1) AND 
                             (CONJ_REL EQ 1) THEN 1 ELSE 0;
TRAN/QY = TRN_DATE;
YEAR/YY = TRN_DATE;

-* Defines on Previous Defines
  DISSAVINGS/D12 = IF EMBARK EQ 'DT1' THEN 0 ELSE
                         FARE_PAID - SEG_LOWEST;
  VASAVINGS/D12 = SEG_DISCOUNT - FARE_PAID;
-* Defines on Previously Defined Defines
 
END
-RUN

TABLEF FILE SR_50
PRINT AIR_MAIN.INTL_DOM AS 'INTL_DOM'
  DISSAVINGS
  DOC_TYPE	
  DOD_TYPE
  DPT_DATE	
  EMBARK	
  EX_FLAG	
  EXCHG_SALE
  FARE_PAID	
  LEVEL_DESC
  NET_TKT_CNT
  REFUSE_CODE
  RF_FLAG
  SEG_AMT	
  SEG_COM	
  SEG_COUNT
  SEG_NBR 	
  SEG_TAX 
  TKT_NUM
  TKT_PURCH	
  TRAN
  TRN_DATE
  YEAR
  VASAVINGS
  VOID_DATE 	
  VOID_STATUS 	

WHERE (TRN_DATE GE &&FROMDT.EVAL) AND (TRN_DATE LE &&TODT.EVAL) OR
      (TRN_DATE GE &&FXDATE.EVAL) AND (TRN_DATE LE &&TXDATE.EVAL)
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10


-INCLUDE RPTPARMS
ON TABLE HOLD AS &&RPT_HOLD
END
-RUN


DEFINE FILE &&RPT_HOLD
CURRENT/A1 = IF TRN_DATE GE &&FROMDT.EVAL AND
                TRN_DATE LE &&TODT.EVAL THEN 'Y' ELSE 'N';
PRIOR/A1 =  IF TRN_DATE GE &&FXDATE.EVAL AND
               TRN_DATE LE &&TXDATE.EVAL THEN 'Y' ELSE 'N';
DOMNT/D10 = IF INTL_DOM EQ 'D' THEN NET_TKT_CNT ELSE 0;
DOMFP/D12 = IF INTL_DOM EQ 'D' THEN FARE_PAID ELSE 0;
CPFLAG/A1 = IF CURRENT EQ 'Y' THEN '1' ELSE '2';
QTR/A1 = IF TRAN EQ ' ' THEN ' ' ELSE 'Q';
END

-* Report Data
TABLE FILE &&RPT_HOLD
SUM DOMFP
    DOMNT
    FARE_PAID
    NET_TKT_CNT
BY QTR
BY TRAN
ON TABLE HOLD AS RPT
END
-RUN

TABLE FILE RPT
SUM 
COMPUTE DATP/D12 = IF ((DOMNT LT 1) AND (DOMNT GT (-1))) THEN 0 ELSE
                   (DOMFP/DOMNT);
        TATP/D12 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                   (FARE_PAID/NET_TKT_CNT);
BY QTR
BY TRAN
ON TABLE SAVE AS ATP FORMAT ALPHA
END
-RUN



-* -GOTO AROUNDG
-*  ATP, Online %, NonRefundable %, Advanced Purchase % Graph
DEFINE FILE &&RPT_HOLD
CURRENT/A1 = IF TRN_DATE GE &&FROMDT.EVAL AND
                TRN_DATE LE &&TODT.EVAL THEN 'Y' ELSE 'N';
PRIOR/A1 =  IF TRN_DATE GE &&FXDATE.EVAL AND
               TRN_DATE LE &&TXDATE.EVAL THEN 'Y' ELSE 'N';
DOMNT/D10 = IF INTL_DOM EQ 'D' THEN NET_TKT_CNT ELSE 0;
DOMFP/D12 = IF INTL_DOM EQ 'D' THEN FARE_PAID ELSE 0;
CPFLAG/A1 = IF CURRENT EQ 'Y' THEN '1' ELSE '2';
QTR/A1 = IF TRAN EQ ' ' THEN ' ' ELSE 'Q';
END

TABLE FILE &&RPT_HOLD
SUM DOMNT DOMFP FARE_PAID NET_TKT_CNT
BY QTR
BY TRAN
ON TABLE HOLD AS FIRST
END
-RUN

TABLE FILE FIRST
SUM 
COMPUTE DATP/D12 = IF ((DOMNT LT 1) AND (DOMNT GT (-1))) THEN 0 ELSE
                   (DOMFP/DOMNT);
        TATP/D12 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                   (FARE_PAID/NET_TKT_CNT);
BY QTR
BY TRAN
ON TABLE HOLD AS DGHOLD
END
-RUN

GRAPH FILE DGHOLD
SUM DATP AS 'Domestic ATP'
    TATP AS 'Total ATP'
ACROSS TRAN AS ' '
ON GRAPH SET LOOKGRAPH VBAR2AX
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D OFF
ON GRAPH SET VZERO ON
ON GRAPH SET GRID OFF
ON GRAPH SET GRAPHSTYLE *
-* setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(0, new Color, 145 207 255));
setSeriesFillColor(1, new Color, 125 0 0));
setMarkerDisplay(true);
setUseSeriesShapes(true);
setConnectLineMarkers(true);
setConnectScatterMarkers(true);
setO1LabelDisplay(true);
setO1LabelRotate(0);
setAxisAssignment(0,0);
setSeriesType(0,1);
setAxisAssignment(1,1);
setSeriesType(1,2);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setY2MajorGridDisplay(false);
setY2MinorGridDisplay(false);
setTextFormatPreset(getY1Label(),6);
setTextFormatPreset(getY2Label(),-1);
setTextFormatPattern(getY2Label(),"#,###");
setPieFeelerTextDisplay(1);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(1);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(1);
setTitleString("Average Ticket Price (ATP), Domestic Online %, Nonrefundable %");
setSubtitleString("and Advance Purchase %");
setTextJustHoriz(getTitle(), 1);
setTextJustHoriz(getSubtitle(), 1);
setFontSizeAbsolute(getTitle(),false);
setFontSizeAbsolute(getSubtitle(),false);
setFontStyle(getTitle(),1);
setFontStyle(getSubtitle(),1);
setFontSizeAbsolute(getLegendText(),true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
ON GRAPH HOLD AS TDG1 FORMAT SVG
END
-RUN

-AROUNDG


-SET &&G_TDG1=IF &LINES GT 0 THEN 'Y' ELSE 'N';


-SET &Q1 = ' ';
-SET &Q2 = ' ';
-SET &Q3 = ' ';
-SET &Q4 = ' ';
-SET &Q5 = ' ';
-SET &Q6 = ' ';
-SET &Q7 = ' ';
-SET &Q8 = ' ';
-SET &TD1 = ' ';
-SET &TD2 = ' ';
-SET &TD3 = ' ';
-SET &TD4 = ' ';
-SET &TD5 = ' ';
-SET &TD6 = ' ';
-SET &TD7 = ' ';
-SET &TD8 = ' ';
-SET &DATP1 = ' ';
-SET &DATP2 = ' ';
-SET &DATP3 = ' ';
-SET &DATP4 = ' ';
-SET &DATP5 = ' ';
-SET &DATP6 = ' ';
-SET &DATP7 = ' ';
-SET &DATP8 = ' ';
-SET &TATP1 = ' ';
-SET &TATP2 = ' ';
-SET &TATP3 = ' ';
-SET &TATP4 = ' ';
-SET &TATP5 = ' ';
-SET &TATP6 = ' ';
-SET &TATP7 = ' ';
-SET &TATP8 = ' ';


-SET &CNT = 0;
-REPEAT TOEND &LINES TIMES
-SET &CNT = &CNT + 1;
-READ ATP NOCLOSE &Q.&CNT.1. &TD.&CNT.3. &DATP.&CNT.12. &TATP.&CNT.12.
-TOEND 
-CLOSE ATP

-SET &DATP1 = TRIM('L', &DATP1, 12, ' ', 1, 'A12');
-SET &DATP2 = TRIM('L', &DATP2, 12, ' ', 1, 'A12');
-SET &DATP3 = TRIM('L', &DATP3, 12, ' ', 1, 'A12');
-SET &DATP4 = TRIM('L', &DATP4, 12, ' ', 1, 'A12');
-SET &DATP5 = TRIM('L', &DATP5, 12, ' ', 1, 'A12');
-SET &DATP6 = TRIM('L', &DATP6, 12, ' ', 1, 'A12');
-SET &DATP7 = TRIM('L', &DATP7, 12, ' ', 1, 'A12');
-SET &DATP8 = TRIM('L', &DATP8, 12, ' ', 1, 'A12');

-SET &TATP1 = TRIM('L', &TATP1, 12, ' ', 1, 'A12');
-SET &TATP2 = TRIM('L', &TATP2, 12, ' ', 1, 'A12');
-SET &TATP3 = TRIM('L', &TATP3, 12, ' ', 1, 'A12');
-SET &TATP4 = TRIM('L', &TATP4, 12, ' ', 1, 'A12');
-SET &TATP5 = TRIM('L', &TATP5, 12, ' ', 1, 'A12');
-SET &TATP6 = TRIM('L', &TATP6, 12, ' ', 1, 'A12');
-SET &TATP7 = TRIM('L', &TATP7, 12, ' ', 1, 'A12');
-SET &TATP8 = TRIM('L', &TATP8, 12, ' ', 1, 'A12');

-SET &FDLEN1 = ARGLEN(12, &DATP1, 'I1');
-SET &FDLEN2 = ARGLEN(12, &DATP2, 'I1');
-SET &FDLEN3 = ARGLEN(12, &DATP3, 'I1');
-SET &FDLEN4 = ARGLEN(12, &DATP4, 'I1');
-SET &FDLEN5 = ARGLEN(12, &DATP5, 'I1');
-SET &FDLEN6 = ARGLEN(12, &DATP6, 'I1');
-SET &FDLEN7 = ARGLEN(12, &DATP7, 'I1');
-SET &FDLEN8 = ARGLEN(12, &DATP8, 'I1');

-SET &FTLEN1 = ARGLEN(12, &TATP1, 'I1');
-SET &FTLEN2 = ARGLEN(12, &TATP2, 'I1');
-SET &FTLEN3 = ARGLEN(12, &TATP3, 'I1');
-SET &FTLEN4 = ARGLEN(12, &TATP4, 'I1');
-SET &FTLEN5 = ARGLEN(12, &TATP5, 'I1');
-SET &FTLEN6 = ARGLEN(12, &TATP6, 'I1');
-SET &FTLEN7 = ARGLEN(12, &TATP7, 'I1');
-SET &FTLEN8 = ARGLEN(12, &TATP8, 'I1');

-SET &DATP1 = IF &FDLEN1 EQ 12 THEN '$' | EDIT(&DATP1, '999,999,999,999')
- ELSE IF &FDLEN1 EQ 11 THEN '$' | EDIT (&DATP1, '99,999,999,999')
- ELSE IF &FDLEN1 EQ 10 THEN '$' | EDIT (&DATP1, '9,999,999,999')
- ELSE IF &FDLEN1 EQ 9 THEN '$' | EDIT (&DATP1, '99,999,999')
- ELSE IF &FDLEN1 EQ 8 THEN '$' | EDIT (&DATP1, '9,999,999')
- ELSE IF &FDLEN1 EQ 7 THEN '$' | EDIT (&DATP1, '999,999')
- ELSE IF &FDLEN1 EQ 6 THEN '$' | EDIT (&DATP1, '99,999')
- ELSE IF &FDLEN1 EQ 5 THEN '$' | EDIT (&DATP1, '9,999')
- ELSE IF &FDLEN1 EQ 4 THEN '$' | EDIT (&DATP1, '999')
- ELSE IF &FDLEN1 EQ 3 THEN '$' | EDIT (&DATP1, '99')
- ELSE IF &FDLEN1 EQ 2 THEN '$' | EDIT (&DATP1, '9')
- ELSE IF &FDLEN1 EQ 1 AND &DATP1 NE '0' THEN '$' | EDIT (&DATP1, '9')
- ELSE ' ';

-SET &DATP2 = IF &FDLEN2 EQ 12 THEN '$' | EDIT(&DATP2, '999,999,999,999')
- ELSE IF &FDLEN2 EQ 11 THEN '$' | EDIT (&DATP2, '99,999,999,999')
- ELSE IF &FDLEN2 EQ 10 THEN '$' | EDIT (&DATP2, '9,999,999,999')
- ELSE IF &FDLEN2 EQ 9 THEN '$' | EDIT (&DATP2, '99,999,999')
- ELSE IF &FDLEN2 EQ 8 THEN '$' | EDIT (&DATP2, '9,999,999')
- ELSE IF &FDLEN2 EQ 7 THEN '$' | EDIT (&DATP2, '999,999')
- ELSE IF &FDLEN2 EQ 6 THEN '$' | EDIT (&DATP2, '99,999')
- ELSE IF &FDLEN2 EQ 5 THEN '$' | EDIT (&DATP2, '9,999')
- ELSE IF &FDLEN2 EQ 4 THEN '$' | EDIT (&DATP2, '999')
- ELSE IF &FDLEN2 EQ 3 THEN '$' | EDIT (&DATP2, '99')
- ELSE IF &FDLEN2 EQ 2 THEN '$' | EDIT (&DATP2, '9')
- ELSE IF &FDLEN2 EQ 1 AND &DATP2 NE '0' THEN '$' | EDIT (&DATP2, '9')
- ELSE ' ';

-SET &DATP3 = IF &FDLEN3 EQ 12 THEN '$' | EDIT(&DATP3, '999,999,999,999')
- ELSE IF &FDLEN3 EQ 11 THEN '$' | EDIT (&DATP3, '99,999,999,999')
- ELSE IF &FDLEN3 EQ 10 THEN '$' | EDIT (&DATP3, '9,999,999,999')
- ELSE IF &FDLEN3 EQ 9 THEN '$' | EDIT (&DATP3, '99,999,999')
- ELSE IF &FDLEN3 EQ 8 THEN '$' | EDIT (&DATP3, '9,999,999')
- ELSE IF &FDLEN3 EQ 7 THEN '$' | EDIT (&DATP3, '999,999')
- ELSE IF &FDLEN3 EQ 6 THEN '$' | EDIT (&DATP3, '99,999')
- ELSE IF &FDLEN3 EQ 5 THEN '$' | EDIT (&DATP3, '9,999')
- ELSE IF &FDLEN3 EQ 4 THEN '$' | EDIT (&DATP3, '999')
- ELSE IF &FDLEN3 EQ 3 THEN '$' | EDIT (&DATP3, '99')
- ELSE IF &FDLEN3 EQ 2 THEN '$' | EDIT (&DATP3, '9')
- ELSE IF &FDLEN3 EQ 1 AND &DATP3 NE '0' THEN '$' | EDIT (&DATP3, '9')
- ELSE ' ';

-SET &DATP4 = IF &FDLEN4 EQ 12 THEN '$' | EDIT(&DATP4, '999,999,999,999')
- ELSE IF &FDLEN4 EQ 11 THEN '$' | EDIT (&DATP4, '99,999,999,999')
- ELSE IF &FDLEN4 EQ 10 THEN '$' | EDIT (&DATP4, '9,999,999,999')
- ELSE IF &FDLEN4 EQ 9 THEN '$' | EDIT (&DATP4, '99,999,999')
- ELSE IF &FDLEN4 EQ 8 THEN '$' | EDIT (&DATP4, '9,999,999')
- ELSE IF &FDLEN4 EQ 7 THEN '$' | EDIT (&DATP4, '999,999')
- ELSE IF &FDLEN4 EQ 6 THEN '$' | EDIT (&DATP4, '99,999')
- ELSE IF &FDLEN4 EQ 5 THEN '$' | EDIT (&DATP4, '9,999')
- ELSE IF &FDLEN4 EQ 4 THEN '$' | EDIT (&DATP4, '999')
- ELSE IF &FDLEN4 EQ 3 THEN '$' | EDIT (&DATP4, '99')
- ELSE IF &FDLEN4 EQ 2 THEN '$' | EDIT (&DATP4, '9')
- ELSE IF &FDLEN4 EQ 1 AND &DATP4 NE '0' THEN '$' | EDIT (&DATP4, '9')
- ELSE ' ';


-SET &DATP5 = IF &FDLEN5 EQ 12 THEN '$' | EDIT(&DATP5, '999,999,999,999')
- ELSE IF &FDLEN5 EQ 11 THEN '$' | EDIT (&DATP5, '99,999,999,999')
- ELSE IF &FDLEN5 EQ 10 THEN '$' | EDIT (&DATP5, '9,999,999,999')
- ELSE IF &FDLEN5 EQ 9 THEN '$' | EDIT (&DATP5, '99,999,999')
- ELSE IF &FDLEN5 EQ 8 THEN '$' | EDIT (&DATP5, '9,999,999')
- ELSE IF &FDLEN5 EQ 7 THEN '$' | EDIT (&DATP5, '999,999')
- ELSE IF &FDLEN5 EQ 6 THEN '$' | EDIT (&DATP5, '99,999')
- ELSE IF &FDLEN5 EQ 5 THEN '$' | EDIT (&DATP5, '9,999')
- ELSE IF &FDLEN5 EQ 4 THEN '$' | EDIT (&DATP5, '999')
- ELSE IF &FDLEN5 EQ 3 THEN '$' | EDIT (&DATP5, '99')
- ELSE IF &FDLEN5 EQ 2 THEN '$' | EDIT (&DATP5, '9')
- ELSE IF &FDLEN5 EQ 1 AND &DATP5 NE '0' THEN '$' | EDIT (&DATP5, '9')
- ELSE ' ';

-SET &DATP6 = IF &FDLEN6 EQ 12 THEN '$' | EDIT(&DATP6, '999,999,999,999')
- ELSE IF &FDLEN6 EQ 11 THEN '$' | EDIT (&DATP6, '99,999,999,999')
- ELSE IF &FDLEN6 EQ 10 THEN '$' | EDIT (&DATP6, '9,999,999,999')
- ELSE IF &FDLEN6 EQ 9 THEN '$' | EDIT (&DATP6, '99,999,999')
- ELSE IF &FDLEN6 EQ 8 THEN '$' | EDIT (&DATP6, '9,999,999')
- ELSE IF &FDLEN6 EQ 7 THEN '$' | EDIT (&DATP6, '999,999')
- ELSE IF &FDLEN6 EQ 6 THEN '$' | EDIT (&DATP6, '99,999')
- ELSE IF &FDLEN6 EQ 5 THEN '$' | EDIT (&DATP6, '9,999')
- ELSE IF &FDLEN6 EQ 4 THEN '$' | EDIT (&DATP6, '999')
- ELSE IF &FDLEN6 EQ 3 THEN '$' | EDIT (&DATP6, '99')
- ELSE IF &FDLEN6 EQ 2 THEN '$' | EDIT (&DATP6, '9')
- ELSE IF &FDLEN6 EQ 1 AND &DATP6 NE '0' THEN '$' | EDIT (&DATP6, '9')
- ELSE ' ';

-SET &DATP7 = IF &FDLEN7 EQ 12 THEN '$' | EDIT(&DATP7, '999,999,999,999')
- ELSE IF &FDLEN7 EQ 11 THEN '$' | EDIT (&DATP7, '99,999,999,999')
- ELSE IF &FDLEN7 EQ 10 THEN '$' | EDIT (&DATP7, '9,999,999,999')
- ELSE IF &FDLEN7 EQ 9 THEN '$' | EDIT (&DATP7, '99,999,999')
- ELSE IF &FDLEN7 EQ 8 THEN '$' | EDIT (&DATP7, '9,999,999')
- ELSE IF &FDLEN7 EQ 7 THEN '$' | EDIT (&DATP7, '999,999')
- ELSE IF &FDLEN7 EQ 6 THEN '$' | EDIT (&DATP7, '99,999')
- ELSE IF &FDLEN7 EQ 5 THEN '$' | EDIT (&DATP7, '9,999')
- ELSE IF &FDLEN7 EQ 4 THEN '$' | EDIT (&DATP7, '999')
- ELSE IF &FDLEN7 EQ 3 THEN '$' | EDIT (&DATP7, '99')
- ELSE IF &FDLEN7 EQ 2 THEN '$' | EDIT (&DATP7, '9')
- ELSE IF &FDLEN7 EQ 1 AND &DATP7 NE '0' THEN '$' | EDIT (&DATP7, '9')
- ELSE ' ';

-SET &DATP8 = IF &FDLEN8 EQ 12 THEN '$' | EDIT(&DATP8, '999,999,999,999')
- ELSE IF &FDLEN8 EQ 11 THEN '$' | EDIT (&DATP8, '99,999,999,999')
- ELSE IF &FDLEN8 EQ 10 THEN '$' | EDIT (&DATP8, '9,999,999,999')
- ELSE IF &FDLEN8 EQ 9 THEN '$' | EDIT (&DATP8, '99,999,999')
- ELSE IF &FDLEN8 EQ 8 THEN '$' | EDIT (&DATP8, '9,999,999')
- ELSE IF &FDLEN8 EQ 7 THEN '$' | EDIT (&DATP8, '999,999')
- ELSE IF &FDLEN8 EQ 6 THEN '$' | EDIT (&DATP8, '99,999')
- ELSE IF &FDLEN8 EQ 5 THEN '$' | EDIT (&DATP8, '9,999')
- ELSE IF &FDLEN8 EQ 4 THEN '$' | EDIT (&DATP8, '999')
- ELSE IF &FDLEN8 EQ 3 THEN '$' | EDIT (&DATP8, '99')
- ELSE IF &FDLEN8 EQ 2 THEN '$' | EDIT (&DATP8, '9')
- ELSE IF &FDLEN8 EQ 1 AND &DATP8 NE '0' THEN '$' | EDIT (&DATP8, '9')
- ELSE ' ';


TABLE FILE BRPTINST
BY INST_KEY NOPRINT
ON TABLE SET PAGE-NUM OFF
&&OUTLINE1
&&OUTLINE2
FOOTING
"</24"
" ___________________________________________________________________________________________________________"
"| <9 | <&POS1 &Q1&TD1 <&POS2A | <&POS2 &Q2&TD2 <&POS3A | <&POS3 &Q3&TD3 <&POS4A | <&POS4 &Q4&TD4 <&POS5A | <&POS5 &Q5&TD5 <&POS6A | <&POS6 &Q6&TD6 <&POS7A | <&POS7 &Q7&TD7 <&POS8A | <&POS8 &Q8&TD8 <58 | "
"|___________________________________________________________________________________________________________<58 | "
-* "|Domestic ATP <9 | <&POS1 &DATP1 <&POS2A | <&POS2 &DATP2 <&POS3A | <&POS3 &DATP3 <&POS4A | <&POS4 &DATP4 <&POS5A | <&POS5 &DATP5 <&POS6A | <&POS6 &DATP6 <&POS7A | <&POS7 &DATP7 <&POS8A | <&POS8 &DATP8 <58 | "
-* "|___________________________________________________________________________________________________________<58 | <60 |________________________________________________________________________________________________________<58 |"
-* "|Total ATP  <9 | 
-* <&POS1 &TATP1 <&POS2A | <&POS2 &TATP2 <&POS3A | <&POS3 &TATP3 <&POS4A | <&POS4 &TATP4 <&POS5A | <&POS5 &TATP5 <&POS6A | <&POS6 &TATP6 <&POS7A | <&POS7 &TATP7 <&POS8A | <&POS8 &TATP8 <58 | "
-* "|___________________________________________________________________________________________________________<58 |"

ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.150000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=7, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=FOOTING, SIZE=7, LINE=21, OBJECT=TEXT, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=20, OBJECT=TEXT, STYLE=BOLD,
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=19, OBJECT=TEXT, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=1, STYLE=NORMAL,
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=2, STYLE=BOLD,
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=3, STYLE=NORMAL,  
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=4, STYLE=BOLD,  
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=5, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=6, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=7, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=8, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=9, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=10, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=11, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=12, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=13, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=14, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=15, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=16, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=17, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=18, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=19, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=20, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=21, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=22, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=23, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=24, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=25, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=26, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=27, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=28, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=29, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=30, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=31, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=32, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=33, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=34, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=35, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=36, STYLE=NORMAL, 
COLOR=RGB(145 207 255), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=22, OBJECT=TEXT, ITEM=37, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=23, OBJECT=TEXT, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=1, STYLE=NORMAL,
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=2, STYLE=BOLD,
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=3, STYLE=NORMAL,  
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=4, STYLE=BOLD,  
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=5, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=6, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=7, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=8, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=9, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=10, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=11, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=12, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=13, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=14, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=15, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=16, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=17, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=18, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=19, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=20, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=21, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=22, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=23, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=24, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=25, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=26, STYLE=NORMAL, 
COLOR=RGB (125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=27, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=28, STYLE=NORMAL, 
COLOR=RGB(125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=29, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=30, STYLE=NORMAL, 
COLOR=RGB (125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=31, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=32, STYLE=NORMAL, 
COLOR=RGB (125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=33, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=34, STYLE=NORMAL, 
COLOR=RGB (125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=35, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=36, STYLE=NORMAL, 
COLOR=RGB (125 0 0), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=24, OBJECT=TEXT, ITEM=37, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=25, OBJECT=TEXT, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=7, LINE=26, OBJECT=TEXT, STYLE=BOLD, 
COLOR=BLACK, FONT=TIMES NEW ROMAN,$
TYPE=REPORT, IMAGE=TrendingData.GIF,POSITION=(0.1 0.1), SIZE=(10.75 .75), $
-IF &&G_TDG1 EQ 'N' GOTO SKIP_DGAT;
TYPE=REPORT,
IMAGE=TDG1.SVG,
    POSITION=(5.5  0.9), SIZE=(5.5 2.5), $
-SKIP_DGAT
ENDSTYLE
END
-RUN
