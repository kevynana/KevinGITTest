-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-INCLUDE SETECHO

-* File TKTSMRY.FEX
-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR  
-*                                  DRILLABLE REPORTS.
-*11/28/01     TANDT-JK             CARRIED THROUGH THE FOLLOWING FIELDS:
-*                                  XPSNGR_NM, TKT_NUM, TKT_TYPE, REFUSE_CODE
-*                                  XDPT_DT, SEG_DESIG, TOUR_CODE
-*12/04/01     TANDT-DB             CARRIED THROUGH DISSAVINGS
-*07/03/02   STEVE              CHANGED TO eTTek Review and Copyright
-*10/14/02     TANDT-JK             CARRIED THROUGH FARE_BAS
-*03/17/03     TANDT-DV             CARRIED THROUGH PNR_LOCATOR
-*07/16/03     TANDT-DV             CARRIED THROUGH LEVEL2
-*07/30/03     TANDT-DV             CARRIED THROUGH MXEXC1
-*02/23/04     TANDT-DV             CARRIED THROUGH CLASS1
-*8/23/04      TANDT-JK             CARRIED THROUGH CITY
-*10/18/04     TANDT-DV             ADDED CODE FOR GLOBAL CURRENCY
-*04/08/04     TANDT-DV             CARRIED THROUGH MXEXC2
-*1/10/07        DEB                CARRIED THROUGH ARLN_NAME
-*6/26/08   ADDED Fields for CH2M UA/LH request JK 
-*10/22/14  CARRIED THRU FLIGHT_TYPE/LEVEL4/AROLL_DSC6 - JK
-*7/01/15 - JEK - STORY ID - S-09964 - updated programs/created new routine for add collects and airline fees for request and to balance to other reports
-*7/06/15 - JEK - S-10087 - Removed goto for any version other than Kiewit...skipping around the EXCHADDC program completley if not Kiewit
-*11/23/15  Joy    S-07987  Corrected for running Currency Enabled Version
-*12/02/15 - JEM - S-13286 Updated to allow reports to sort/subtotal by id-levels
-*11/07/16-JEM-S-24567-carried through aa_spend/ua_spend
-*01/23/17 - RSB - S-23084 Contract Savings by Alliance - ABVASAVA
-*05/25/17 - RSB - S-34625 Place Post-Trip Report datetime stamp at bottom of reports (AVIEW6)
-* 08/01/2017 RSB S-38044 Place the footer datetime stamp text in a separate file to be -INCLUDED in the stylesheets
-*                         Backed out changes for S-34625
-**********************************************************************
-*
-* FTR_DateTimePosit sets the position of the Post-trip date/time stamp text within the footer image.
-* The default line number (&FTR_DateTimeLine) in the FOOTING for the date/time stamp text is: 4.
-INCLUDE FTR_DateTimePosit
-*
SET ASNAMES = ON

-* ? &&
-* -? &

-IF (&&SETF EQ 'ABVASAV' OR 'ABVASAVA' OR 'ABCLVSAV') AND (&&CURRENCY NE 'USD') THEN GOTO VASAV ELSE GOTO NEXT;
-RUN

-VASAV;

-SET &&SUBHEAD = <NAMEC;
-SET &MKTF_CUR = 'MARKET,FARE, (' | &&CURRENCY || ')';
-SET &FPAID_CUR = 'FARE PAID, (' | &&CURRENCY || ')';
-SET &ADVSV_CUR = 'AGENCY,DISCOUNT,SAVINGS, (' | &&CURRENCY || ')';
-SET &ADVSV1_CUR = 'AGENCY,DISCOUNT,SAVINGS%, (' | &&CURRENCY || ')';
-SET &NFVSV_CUR = 'CONTRACT,SAVINGS, (' | &&CURRENCY || ')';
-SET &NFVSV1_CUR = 'CONTRACT,SAVINGS%, (' | &&CURRENCY || ')';


-* -SET &&S_SUBJ7='COMPUTE VASAVPCT1/D14.1S = IF ((NEW_SEGD1 LT 1) AND';
-* -SET &&S_SUBJ8='(NEW_SEGD1 GT (-1))) THEN 0 ELSE';
-* -SET &&S_SUBJ9='(VASAVE1/NEW_SEGD1)*100; AS ''VALUE,ADDED,SAVINGS %''';
-SET &&S_SUBJ1='SUM TKT_PURCH/P8CS AS ''TICKETS, PURCH'' PCT.TKT_PURCH AS '' % OF, PURCH'' REF_EXCH_CNT/P8CS AS ''REFUNDS/,EXCHGS'' PCT.REF_EXCH_CNT AS ''% OF TTL,RFD/EXCH''';
-SET &&S_SUBJ2='NEW_SEGD1/D16.2CS AS ' | '''&MKTF_CUR.EVAL''';
-SET &&S_SUBJ3='PAID_FARE1/D16.2CS AS ' | '''&FPAID_CUR.EVAL''' ;
-SET &&S_SUBJ4='NFVSV/D16.2CS AS ' | '''&NFVSV_CUR.EVAL''' ;
-SET &&S_SUBJ5='COMPUTE NFVPCT/D8.1S =IF ((NEW_SEG_DISC LT 1) AND (NEW_SEG_DISC GT (-1))) THEN 0 ELSE (NFVSV/NEW_SEG_DISC)*100; AS ' | '''&NFVSV1_CUR.EVAL''' ;
-SET &&S_SUBJ6='ADVSV/D16.2CS AS ' | '''&ADVSV_CUR.EVAL''' ;
-SET &&S_SUBJ7='COMPUTE ADVPCT/D8.1S =IF ((NEW_SEG_DISC LT 1) AND (NEW_SEG_DISC GT (-1))) THEN 0 ELSE (ADVSV/NEW_SEG_DISC)*100; AS ' | '''&ADVSV1_CUR.EVAL''' ;
-SET &&S_SUBJ8=' ';
-SET &&S_SUBJ9=' ';
-SET &&S_SUBJ10=' ';

-NEXT;

-IF &&SETF EQ 'ABVASAVA' GOTO ABVASAVAS;

TABLE FILE VASAV1
SUM DISSAVINGS AS 'DTSAVE'
    FARE_PAID1/D12.2CS AS 'TFARE'
    NEW_SEG_DISC AS 'TSDISC'
    NEW_SEGD1/D20.6 AS 'GTSDISC'
    REF_EXCH_CNT AS 'TRFEX'
    TKT_PURCH AS 'TTKT'
    VASAVINGS AS 'VASAV'
    VASAVE1/D16.2CS AS 'GVASAV'
    NET_TKT_CNT AS 'NTTKT'
    PAID_FARE1/D16.2CS AS 'GFARE'
BY LEVEL_DESC  
ON TABLE HOLD AS HOLDONE
END
-RUN

-IF &&SETF EQ 'MTVASAV' OR 'KBCLVSV' THEN GOTO FlownAir;


DEFINE FILE VASAV1
CG_TCNT/P12CS = CG_PCNT+EXG_ISS;
END
TABLE FILE VASAV1
PRINT 
  ADVSV
  AIRLINE
  ADV_PURCH
  ALN_NAME
  AROLL_DSC6
  BR_CL_IDX
  CITY
  CLASS
  CLASS1
  CLASS_CAT
  COMM_SEG
  DISSAVINGS
  FARE_BAS
  FARE_PAID1
  FLT_TYPE
  INT_CODE
  LEVEL2
  LEVEL4
  MXEXC1
  MXEXC2
  MRK_TKT_CNT
  NAMEC
  NET_FARE
  NET_TKT_CNT
  NEW_AP
  NEW_ADV_PURCH
  NEW_SEG_DISC
  NEW_SEGD1
  NFVSV
  PAID_FARE1
  PNR_LOCATOR
  SEG_DESIG
  REFUSE_CODE
  REF_EXCH_CNT
  RESV_BRANCH
  SEG_DESIG
  SEG_NBR
  TAX
  TKT_NUM
  TKT_PURCH
  TKT_SORT
  TKT_TYPE
  TOUR_CODE
  VASAVINGS
  VASAVE1
  XDPT_DT
  XPSNGR_NM
  XTRAN_DT
-* Kiewit Defines
    ADDCOLLECT
    AIRLINE_FEE
    EXG_ISS
    FEXG_AMT    
    NET_AMT
    PEXG_ISS
    CG_PCNT
    CG_TCNT
-*BOOZ FLIGHT TYPE
    DOM_TKT
    SHORT_TKT
    LONG_TKT   
-*AMN SPEND
    AA_SPEND
    UA_SPEND    
BY LEVEL_DESC
BY AIRLINE_NAME
ON TABLE HOLD AS XTWO
END
-RUN


MATCH FILE XTWO
PRINT 
  ADVSV
  AIRLINE
  ALN_NAME
  ADV_PURCH
  AROLL_DSC6
  BR_CL_IDX
  CITY
  CLASS
  CLASS1
  CLASS_CAT
  COMM_SEG
  DISSAVINGS
  FARE_BAS
  FARE_PAID1
  FLT_TYPE
  INT_CODE
  LEVEL2
  LEVEL4
  MRK_TKT_CNT
  MXEXC1
  MXEXC2
  NAMEC
  NET_FARE
  NET_TKT_CNT
  NEW_AP
  NEW_ADV_PURCH
  NEW_SEG_DISC
  NEW_SEGD1
  NFVSV
  PAID_FARE1
  PNR_LOCATOR
  SEG_DESIG
  REFUSE_CODE
  REF_EXCH_CNT
  RESV_BRANCH
  SEG_DESIG
  SEG_NBR
  TAX
  TKT_NUM
  TKT_PURCH
  TKT_SORT
  TKT_TYPE
  TOUR_CODE
  VASAVINGS
  VASAVE1
  XDPT_DT
  XPSNGR_NM
  XTRAN_DT
-* Kiewit Defines
    ADDCOLLECT
    AIRLINE_FEE
    EXG_ISS
    FEXG_AMT 
    NET_AMT
    PEXG_ISS
    CG_PCNT
    CG_TCNT
-*BOOZ FLIGHT TYPE
    DOM_TKT
    SHORT_TKT
    LONG_TKT  
-*AMN SPEND
    AA_SPEND
    UA_SPEND    
BY LEVEL_DESC
BY AIRLINE_NAME 
ON TABLE HOLD
RUN
FILE HOLDONE
SUM DTSAVE
    GFARE
    GTSDISC
    GVASAV
    NTTKT
    TFARE
    TRFEX
    TSDISC
    TTKT
    VASAV
 BY LEVEL_DESC
-IF &&SETF EQ 'KWEXSM' GOTO KWH;
AFTER MATCH HOLD AS XTHREE OLD-OR-NEW
-GOTO ENDHLD;
-KWH; 
AFTER MATCH HOLD AS XTHREEA OLD-OR-NEW 
-ENDHLD;
END
-RUN

-IF &&SETF NE 'KWEXSM' GOTO FinishRpt;

-INCLUDE EXCHADDC
-RUN

TABLE FILE EXHOLD2
SUM AC_AMT PNLTY_AMT
BY LEVEL_DESC
BY AIRLINE_NAME
ON TABLE HOLD AS EXCAIR2
END
-RUN 


MATCH FILE XTHREEA
PRINT 
  ADVSV
  AIRLINE
  AIRLINE_NAME
  ALN_NAME
  ADV_PURCH
  AROLL_DSC6
  BR_CL_IDX
  CITY
  CLASS
  CLASS1
  CLASS_CAT
  COMM_SEG
  DISSAVINGS
  FARE_BAS
  FARE_PAID1
  FLT_TYPE
  INT_CODE
  LEVEL2
  LEVEL4
  MRK_TKT_CNT
  MXEXC1
  MXEXC2
  NAMEC
  NET_FARE
  NET_TKT_CNT
  NEW_AP
  NEW_ADV_PURCH
  NEW_SEG_DISC
  NEW_SEGD1
  NFVSV
  PAID_FARE1
  PNR_LOCATOR
  SEG_DESIG
  REFUSE_CODE
  REF_EXCH_CNT
  RESV_BRANCH
  SEG_DESIG
  SEG_NBR
  TAX
  TKT_NUM
  TKT_PURCH
  TKT_SORT
  TKT_TYPE
  TOUR_CODE
  VASAVINGS
  VASAVE1
  XDPT_DT
  XPSNGR_NM
  XTRAN_DT
-* Kiewit Defines
    ADDCOLLECT
    AIRLINE_FEE
    EXG_ISS
    FEXG_AMT 
    NET_AMT
    PEXG_ISS
    CG_PCNT
    CG_TCNT
-*BOOZ FLIGHT TYPE
    DOM_TKT
    SHORT_TKT
    LONG_TKT  
-*AMN SPEND
    AA_SPEND
    UA_SPEND    
    DTSAVE
    GFARE
    GTSDISC
    GVASAV
    NTTKT
    TFARE
    TRFEX
    TSDISC
    TTKT
    VASAV
    
BY LEVEL_DESC
BY AIRLINE_NAME
ON TABLE HOLD
RUN
FILE EXCAIR2
PRINT AC_AMT PNLTY_AMT
BY LEVEL_DESC
BY AIRLINE_NAME
AFTER MATCH HOLD AS XTHREE OLD-OR-NEW
END
-RUN


-GOTO FinishRpt;

-FlownAir

DEFINE FILE VASAV1
AC_AMT/D12.2CS = 0;
PNLTY_AMT/D12.2CS = 0;
END
TABLE FILE VASAV1
PRINT ADVSV 
  AIRLINE
  ADV_PURCH
  ALN_NAME
  AROLL_DSC6
  BR_CL_IDX
  CITY
  CLASS
  CLASS1
  CLASS_CAT
  COMM_SEG
  DISSAVINGS
  FARE_BAS
  FARE_PAID1
  FLT_TYPE
  INT_CODE
  LEVEL2
  LEVEL4
  MXEXC1
  MXEXC2
  MRK_TKT_CNT
  NAMEC
  NET_FARE
  NET_TKT_CNT
  NEW_ADV_PURCH
  NEW_SEG_DISC
  NEW_SEGD1
  NFVSV
  PAID_FARE1
  PNR_LOCATOR
  SEG_DESIG
  REFUSE_CODE
  REF_EXCH_CNT
  RESV_BRANCH
  SEG_DESIG
  SEG_NBR
  TAX
  TKT_NUM
  TKT_PURCH
  TKT_SORT
  TKT_TYPE
  TOUR_CODE
  VASAVINGS
  VASAVE1
  XDPT_DT
  XPSNGR_NM
  XTRAN_DT
-*BOOZ FLIGHT TYPE
    DOM_TKT
    SHORT_TKT
    LONG_TKT  
-*AMN SPEND
    AA_SPEND
    UA_SPEND    
BY LEVEL_DESC
BY ARLN_NAME
ON TABLE HOLD AS XTWO
END
-RUN

MATCH FILE XTWO
PRINT ADVSV 
  AIRLINE
  ADV_PURCH
  ALN_NAME
  AROLL_DSC6
  BR_CL_IDX
  CITY
  CLASS
  CLASS1
  CLASS_CAT
  COMM_SEG
  DISSAVINGS
  FARE_BAS
  FARE_PAID1
  FLT_TYPE
  INT_CODE
  LEVEL2
  LEVEL4
  MRK_TKT_CNT
  MXEXC1
  MXEXC2
  NAMEC
  NET_FARE
  NET_TKT_CNT
  NEW_ADV_PURCH
  NEW_SEG_DISC
  NEW_SEGD1
  NFVSV
  PAID_FARE1
  PNR_LOCATOR
  SEG_DESIG
  REFUSE_CODE
  REF_EXCH_CNT
  RESV_BRANCH
  SEG_DESIG
  SEG_NBR
  TAX
  TKT_NUM
  TKT_PURCH
  TKT_SORT
  TKT_TYPE
  TOUR_CODE
  VASAVINGS
  VASAVE1
  XDPT_DT
  XPSNGR_NM
  XTRAN_DT
-*BOOZ FLIGHT TYPE
    DOM_TKT
    SHORT_TKT
    LONG_TKT    
-*AMN SPEND
    AA_SPEND
    UA_SPEND    
BY LEVEL_DESC
BY ARLN_NAME
ON TABLE HOLD
RUN
FILE HOLDONE
SUM DTSAVE
    GFARE
    GTSDISC
    GVASAV
    NTTKT
    TFARE
    TRFEX
    TSDISC
    TTKT
    VASAV
 BY LEVEL_DESC
 AFTER MATCH HOLD AS XTHREE OLD-OR-NEW 
 END
-RUN





-FinishRpt

DEFINE FILE XTHREE
  AFLAG/A1 = IF ALN_NAME EQ 'OTHER' THEN '2' ELSE '1';
  PCTFARE/D8.1S = IF ((TFARE LT 1) AND (TFARE GT (-1))) THEN 0
                  ELSE ((FARE_PAID1/TFARE)*100);
  PCTNETTKT/D8.1S = IF ((NTTKT LT 1) AND (NTTKT GT (-1))) THEN 0
                    ELSE ((NET_TKT_CNT/NTTKT)*100);
  PCTRFEX/D8.1S = IF ((TRFEX LT 1) AND (TRFEX GT (-1))) THEN 0
                  ELSE ((REF_EXCH_CNT/TRFEX)*100);
  PCTTKT/D8.1S = IF ((TTKT LT 1) AND (TTKT GT (-1))) THEN 0
                 ELSE ((TKT_PURCH/TTKT)*100);
  RADV_PURCH/I8CS = IF (TKT_TYPE EQ 'P-RF' OR 'P-EX') THEN 0 ELSE 
                    IF (FARE_PAID1 GE 0) THEN NEW_ADV_PURCH ELSE
                    IF (FARE_PAID1 LT 0) THEN NEW_ADV_PURCH * (-1) ELSE 0;
  ADV_PUR/I8CS = IF SEG_NBR EQ '01' THEN RADV_PURCH ELSE 0;
  NEW_AP1/D9 = IF EXG_ISS NE 0 THEN NEW_AP ELSE
               IF CG_PCNT NE 0 THEN NEW_AP ELSE 0;
  CGEX_CNT/D8CS = EXG_ISS + CG_PCNT;               
-* **********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-**********************************************************************
  NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
END

-IF &&SETF EQ 'KWEXSM' OR 'CGEXSM1' GOTO KWRPT;

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&SMSTY;
-RUN

TABLE FILE XTHREE
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3   
    &&S_SUBJ4    
    &&S_SUBJ5    
    &&S_SUBJ6
    &&S_SUBJ7   
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
&&BREAKOPTION
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10


-INCLUDE FOOTERSM
-* ON TABLE COLUMN-TOTAL
-*ON TABLE SET STYLE &&SMSTY
-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *

-INCLUDE &&PASTYS

-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************



-IF &&DRILLABLE EQ 'N' OR &&SETF EQ 'CHUAGB' OR 'CHEURMES' GOTO SKIP_DRILL;
-INCLUDE &&DSTY

-SKIP_DRILL

ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN

-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3;

EX REPORT_3

-SKIP_R3
-GOTO XXITA;

-KWRPT


-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN


TABLE FILE XTHREE
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
-IF &&SETF NE 'CGEXSM1' GOTO NOCOMPUTE;  
COMPUTE AVG_AP/D9 = IF CGEX_CNT EQ 0 THEN 0 ELSE NEW_AP1/CGEX_CNT; AS 'EXCHANGE,AVG ADV,PURCH DAYS'   
-NOCOMPUTE;    
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10

-*ON
&&BREAKOPTION
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10


-INCLUDE FOOTERSM
-* ON TABLE COLUMN-TOTAL
-*ON TABLE SET STYLE &&SMSTY
-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

-IF &&PASTYS EQ 'SMEXL' GOTO EXL;

ON TABLE SET STYLE *
-*
-INCLUDE GLOBAL_LOGO_SM
-INCLUDE &&PASTYS
-*
-GOTO SKIP_AVIEW6STYLE1;
-*
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.500000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, JUSTIFY=LEFT, $
TYPE=HEADING, OBJECT=TEXT, SIZE=8, COLOR=BLACK, $
TYPE=HEADING, LINE=4, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBFOOT, SIZE=8, JUSTIFY=LEFT, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=8, JUSTIFY=LEFT, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=8, JUSTIFY=LEFT, STYLE=BOLD, $
TYPE=REPORT, COLUMN=N1, JUSTIFY=LEFT, SQUEEZE=1.2, $
TYPE=REPORT, COLUMN=N2, JUSTIFY=LEFT, SQUEEZE=1.2, $
TYPE=REPORT, COLUMN=N3, JUSTIFY=LEFT, SQUEEZE=.6, $
TYPE=REPORT, COLUMN=N4, JUSTIFY=LEFT, SQUEEZE=.6, $
TYPE=REPORT, COLUMN=N5, JUSTIFY=LEFT, SQUEEZE=.7, $
TYPE=REPORT, COLUMN=N6, JUSTIFY=LEFT, SQUEEZE=.6, $
TYPE=REPORT, COLUMN=N7, JUSTIFY=LEFT, SQUEEZE=.6, $
TYPE=REPORT, COLUMN=N8, JUSTIFY=LEFT, SQUEEZE=1.2, $
TYPE=REPORT, COLUMN=N9, JUSTIFY=LEFT, SQUEEZE=1.2, $
TYPE=REPORT, COLUMN=N10, JUSTIFY=LEFT, SQUEEZE=1.2, $
TYPE=REPORT, COLUMN=N11, JUSTIFY=LEFT, SQUEEZE=1.2, $
-*****************
-SKIP_AVIEW6STYLE1
-*****************
ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN
-GOTO NXT;

-EXL;


ON TABLE SET STYLE *

-INCLUDE GLOBAL_LOGO_SM
-INCLUDE &&PASTYS
-*
-GOTO SKIP_AVIEW6STYLE2;
-*
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.500000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=HEADING, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(31 114 164), BACKCOLOR=NONE, $
TYPE=HEADING, HEADALIGN=BODY, $
TYPE=HEADING, LINE=1, COLSPAN=2, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=2, COLSPAN=2, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=3, COLSPAN=10, SIZE=9, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=4, COLSPAN=10, SIZE=9,JUSTIFY=CENTER, $
TYPE=HEADING, LINE=5, COLSPAN=2, JUSTIFY=LEFT, $

TYPE=TABFOOTING, FONT=ARIAL, COLOR=GRAY,$
     
TYPE=FOOTING, FONT=ARIAL, COLOR=GRAY,$

TYPE=SUBHEAD,
     SIZE=9,
     STYLE=BOLD,
$

TYPE=DATA,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8, 
     BACKCOLOR=(RGB(242 242 242) 'WHITE' ),$

TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=9,
     COLOR='WHITE',
     BACKCOLOR=RGB(31 114 164),
     STYLE=BOLD,$


TYPE=SUBFOOT, SIZE=8, JUSTIFY=LEFT, STYLE=BOLD, $

TYPE=SUBTOTAL, 
     STYLE=BOLD, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER', $
     
TYPE=GRANDTOTAL, JUSTIFY=LEFT, STYLE=BOLD, $
-*****************
-SKIP_AVIEW6STYLE2
-*****************
-IF &&SETF EQ 'CGEXSM1' GOTO CONG;
-GOTO XXITSTY;
-*
TYPE=REPORT, COLUMN=N1, JUSTIFY=LEFT, SQUEEZE=1, $
TYPE=REPORT, COLUMN=N2, JUSTIFY=LEFT, SQUEEZE=1, $
TYPE=REPORT, COLUMN=N3, JUSTIFY=LEFT, SQUEEZE=.6, $
TYPE=REPORT, COLUMN=N4, JUSTIFY=LEFT, SQUEEZE=.6, $
TYPE=REPORT, COLUMN=N5, JUSTIFY=LEFT, SQUEEZE=.7, $
TYPE=REPORT, COLUMN=N6, JUSTIFY=LEFT, SQUEEZE=.6, $
TYPE=REPORT, COLUMN=N7, JUSTIFY=LEFT, SQUEEZE=.6, $
TYPE=REPORT, COLUMN=N8, JUSTIFY=LEFT, SQUEEZE=1, $
TYPE=REPORT, COLUMN=N9, JUSTIFY=LEFT, SQUEEZE=1, $
-GOTO XXITSTY;
-CONG
TYPE=REPORT, COLUMN=N1, JUSTIFY=LEFT, SQUEEZE=2.5, $
TYPE=REPORT, COLUMN=N2, JUSTIFY=LEFT, SQUEEZE=1, $
TYPE=REPORT, COLUMN=N3, JUSTIFY=LEFT, SQUEEZE=1, $
TYPE=REPORT, COLUMN=N4, JUSTIFY=LEFT, SQUEEZE=1, $
TYPE=REPORT, COLUMN=N5, JUSTIFY=LEFT, SQUEEZE=1, $
TYPE=REPORT, COLUMN=N6, JUSTIFY=LEFT, SQUEEZE=1, $
TYPE=REPORT, COLUMN=N7, JUSTIFY=LEFT, SQUEEZE=1, $
TYPE=REPORT, COLUMN=N8, JUSTIFY=LEFT, SQUEEZE=1, $
TYPE=REPORT, COLUMN=N9, JUSTIFY=LEFT, SQUEEZE=1, $



-XXITSTY

ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN


-NXT;
-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3K;

EX REPORT_3

-SKIP_R3K
-GOTO XXITA;
-*
-*********
-ABVASAVAS
-*********
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS= IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL'  ELSE &&SMSTY;
-*
JOIN CLEAR *
JOIN INNER VAL_AIRLINE IN VASAV1 TO UNIQUE VAL_AIRLINE IN AIRLINE_ALLIANCE AS J0
-*
DEFINE FILE VASAV1
  NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
END
-*
TABLE FILE VASAV1
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-******
-NOSPC
-******
SUM    
        TKT_PURCH/P8CS    AS 'TICKETS, PURCH' 
    PCT.TKT_PURCH         AS '% OF,PURCH' 
        REF_EXCH_CNT/P8CS AS 'REFUNDS/,EXCHGS'
    PCT.REF_EXCH_CNT      AS '% OF TTL,RFD/EXCH' 
        NEW_SEG_DISC      AS 'MARKET,FARE' 
        FARE_PAID         AS 'FARE,PAID' 
        NFVSV             AS 'CONTRACT,SAVINGS' 
      COMPUTE VASAVEPCT/D8.1S = IF ((NEW_SEG_DISC LT 1) AND (NEW_SEG_DISC GT (-1))) THEN 0 ELSE
                                 (NFVSV / NEW_SEG_DISC) * 100;                                  AS 'CONTRACT,SAVINGS %'
        ADVSV             AS 'AGENCY,DISCOUNT,SAVINGS'
      COMPUTE VSVPCT1/D8.1S= IF ((NEW_SEG_DISC LT 1) AND (NEW_SEG_DISC GT (-1))) THEN 0 ELSE
                              (ADVSV / NEW_SEG_DISC) * 100;                                     AS 'AGENCY,DISCOUNT %'
BY ALLIANCE AS 'ALLIANCE'
ON ALLIANCE RECOMPUTE MULTILINES AS 'TOTAL'
-*
WHERE ALLIANCE NE ' ';
-*
-SET &FTR_AddlLines = 3;
FOOTING BOTTOM
" "
" "
"Alliance membership current as of &DATEMDYY."
-*
-INCLUDE FOOTERSM
-*
-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *
-*
-INCLUDE &&PASTYS
-*
-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-*
-IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILL;
-INCLUDE &&DSTY
-*
-*********
-SKIP_DRILL
-*********

ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN
-*
-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3A;
-*
EX REPORT_3
-*
-*********
-SKIP_R3A
-*********
-GOTO XXITA;
-*
-XXITA;