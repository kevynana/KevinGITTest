-*-------------------------------------------------------------------           
-*                                                                              
-* Copyright (c) 1998 Information Builders, Inc.  All rights reserved.          
-*                                                                              
-*                                                                              
-*                                                                              
-* _Name_        ===> MNTUWS   FOCEXEC     _Opsys_    ===> CMS                  
-*                                                                              
-* _Release_     ===> 70                   _Product_  ===> FOC                  
-*                                                                              
-* _Description_ ===>                                                           
-*                                                                              
-*               ===>                                                           
-*                                                                              
-* _Notes_       ===>                                                           
-*                                                                              
-*                                                                              
-*                                                                              
-* _History_:                                                                   
-*                                                                              
-*  Date  Time Who Proj      Project Title                                      
-*                                                                              
-* ====== ==== === ===== ==============================================         
-*                                                                              
-* 990420 1841 ERK 31410 MNTUWS CONTAINS GARBAGE CHARACTERS FOR CONCATENATIO    
-* N                                                                            
-* 980923 1946 KRA 28364 MAINTAIN: TODAY DOES NOT RETURN CENTURY                
-*                                                                              
-* 980522 1644 KRA 26735 Provide CACTUS version of UWS (client & server)        
-*                                                                              
-*                                                                              
-*                                                                              
-* END %&$                                                                      
-*                                                                              
-*---------------------------------------------------------------------         
-*                                                                              
MAINTAIN                                                                        
MODULE EXPORT MNTUWS FOCCOMP;                                                   
                                                                                
-*=======================================================================       
-*                                                                              
-* FILE NAME : MNTUWS                                                           
-*                                                                              
-*                                                                              
-*                                                                              
-* To use the functions in this file                                            
-*                                                                              
-* include the following line after the MAINTAIN line                           
-*                                                                              
-* MODULE IMPORT (MNTUWS);                                                      
-*                                                                              
-*                                                                              
-*                                                                              
-*                                                                              
-*                                                                              
-* BACKGROUND: MNTUWS = Maintain User Written Subroutines.                      
-*                                                                              
-* MNTUWS is of course a poor name for this file and the functionality          
-*                                                                              
-* it provides.  These are obviously NOT user written subroutines.              
-*                                                                              
-* However, many people (IBI and customers alike) have refered to               
-*                                                                              
-* a number of utility functions for string processing etc., as UWS.            
-*                                                                              
-* In order to indicate that the functions contained in this file provide       
-*                                                                              
-* the same or similar functionality to the 'traditional' FOCUS UWS the         
-*                                                                              
-* name of UWS has been retained.                                               
-*                                                                              
-*                                                                              
-*                                                                              
-* These functions were constructed by a number of programmers in the           
-*                                                                              
-* CACTUS division. Principaly Stu Altman - additionaly Eric Klein,             
-*                                                                              
-* Joshua Davis and Ken Allen.                                                  
-*                                                                              
-*                                                                              
-*                                                                              
-* This file attempts to provide a set of useful functions which can be         
-*                                                                              
-* used from within a CACTUS application.  These functions should               
-*                                                                              
-* operate on all Cactus client and server platforms.                           
-*                                                                              
-* The current (05/21/1998) functionality covers getting the date and           
-*                                                                              
-* time and a number of string processing functions.                            
-*                                                                              
-*                                                                              
-*                                                                              
-* In addition to the functions provided in this file there are a number        
-*                                                                              
-* of functions 'built in' to CACTUS/MAINTAIN (via the 'BootStrap')             
-*                                                                              
-* Over a period of time some of the functions provided in this file may        
-*                                                                              
-* be merged into the BootStrap.                                                
-*                                                                              
-* If you are using only built in functions then you do not need to             
-*                                                                              
-* import this file.                                                            
-*                                                                              
-*                                                                              
-*                                                                              
-*=======================================================================       
-*                                                                              
-* FUNCTIONS BUILT IN TO CACTUS/MAINTAIN (MNTUWS is not required)               
-*                                                                              
-*=======================================================================       
-*                                                                              
-* ----------------------------------------------------------------------       
-*                                                                              
-* Name     Title ( Parameters )   What it does                                 
-*                                                                              
-* -------- ---------------------- --------------------------------------       
-*                                                                              
-* LENGTH   Length                 Returns the length of the string.            
-*                                                                              
-*          ( str1 )                                                            
-*                                                                              
-* TRIM     Trim Blanks            Remove trailing blanks from the string       
-*                                                                              
-*          ( str1 )                                                            
-*                                                                              
-* TRIMLEN  Trimmed Length         Returns length of string as if TRIMmed       
-*                                                                              
-*          ( str1 )                                                            
-*                                                                              
-* SUBSTR   Trimmed Length         Returns the sub-string starting              
-*                                                                              
-*          ( str1, posn, leng)    at POSN for length LENG                      
-*                                                                              
-* RJUST    Right Justify          Moves the string right so that right         
-*                                                                              
-*          ( str1, width, pad)    most char is at WIDTH & left fills           
-*                                                                              
-*                                 with PAD.                                    
-*                                                                              
-* ----------------------------------------------------------------------       
-*                                                                              
                                                                                
-*=======================================================================       
-*                                                                              
-* FUNCTIONS PROVIDED IN THIS FILE (MNTUWS)                                     
-*                                                                              
-*=======================================================================       
-*                                                                              
-* ----------------------------------------------------------------------       
-*                                                                              
-* STRING functions: at least one input parameter - str1 -                      
-*                                                                              
-* the string to be processed. The input string is NOT changed                  
-*                                                                              
-* the modified string is return as the result of the function.                 
-*                                                                              
-* ----------------------------------------------------------------------       
-*                                                                              
-* Name     Title ( Parameters )   What it does                                 
-*                                                                              
-* -------- ---------------------- --------------------------------------       
-*                                                                              
-* LJUST    left Justify           Removes leading blanks.                      
-*                                                                              
-*          ( str1 )                                                            
-*                                                                              
-* STRAN    String Translate       Substitute str3 for str2 in str1.            
-*                                                                              
-*          ( str1, str2, str3 )                                                
-*                                                                              
-* POSIT    Position               Returns position of str2 in str1.            
-*                                                                              
-*          ( str1, str2 )                                                      
-*                                                                              
-* OVRLAY   Overlay                Overlays (part of) str1 with str2            
-*                                                                              
-*          ( str1, str2, posn )   at posn.                                     
-*                                                                              
-* SOUNDEX  Soundex                Returns encoded form of string, maps         
-*                                                                              
-*          ( str1 )               similar sounding strings to same code.       
-*                                                                              
-* LOWER    Lower Case             Converts string to lower case.               
-*                                                                              
-*          ( str1 )                                                            
-*                                                                              
-* UPCASE   Upper Case             Converts string to upper case.               
-*                                                                              
-*          ( str1 )                                                            
-*                                                                              
-* STRTOKEN String Token           Returns the next token in the string,        
-*                                                                              
-*          ( str1, btable )       btable string of chars NOT in a token.       
-*                                                                              
-* LCWORD   Lower Case each Word   For each word, upper cases 1st letter        
-*                                                                              
-*          ( str1 )               and lower cases the rest of the word.        
-*                                                                              
-* LCWORD2  LCWORD version 2       As LCWORD but different algorithm            
-*                                                                              
-*          ( str1 )               used to determine what is a word.            
-*                                                                              
-*                                                                              
-*                                                                              
-* ----------------------------------------------------------------------       
-*                                                                              
-* DATE and TIME functions: No input parameters.                                
-*                                                                              
-* ----------------------------------------------------------------------       
-*                                                                              
-* Name     Title                  What it does                                 
-*                                                                              
-* -------- ---------------------- --------------------------------------       
-*                                                                              
-* HHMMSS   Hours Minutes Seconds  Returns current time as HH:MM:SS             
-*                                                                              
-* TODAY    Today's Date           returns current date as mm/dd/yy             
-*                                                                              
-* TODAY2   Today's Date +century  returns current date as mm/dd/yyyy           
-*                                                                              
-* ----------------------------------------------------------------------       
-*                                                                              
-* There are also two functions Initial_HHMMSS and Initial_TODAY                
-*                                                                              
-* which are similar to HHMMSS and TODAY, but return the time & date            
-*                                                                              
-* when the Cactus module was started.                                          
-*                                                                              
-* ----------------------------------------------------------------------       
-*                                                                              
-*                                                                              
-*                                                                              
-* Add documentation of additional functions here.                              
-*                                                                              
-*                                                                              
-*                                                                              
-* Name     Title                  What it does                                 
-*                                                                              
-* -------- ---------------------- --------------------------------------       
-*                                                                              
-*                                                                              
-*                                                                              
-*=======================================================================       
-*                                                                              
                                                                                
-*=======================================================================       
-*                                                                              
-********************SECTION 1*******************************************       
-*                                                                              
-*=======================================================================       
-*                                                                              
-* Class & BINDs for string functions                                           
-*                                                                              
-*=======================================================================       
-*                                                                              
Describe sys_type_uws_CM1STR01 = ()                                             
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*  String Cfuns                                                                
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Cfun Upper     TAKES input/A0 RETURNS output/A0                               
                 BIND( "mmlUpper",  "MNTRT1" );                                 
                                                                                
  Cfun Lower     TAKES input/A0 RETURNS output/A0                               
                 BIND( "mmlLower",  "MNTRT1" );                                 
                                                                                
  Cfun LTrim     TAKES input/A0 RETURNS output/A0                               
                 BIND( "mmlLTrim",  "MNTRT1" );                                 
                                                                                
  Cfun AllTrim   TAKES input/A0 RETURNS output/A0                               
                 BIND( "mmlATrim",  "MNTRT1" );                                 
                                                                                
  Cfun RJust     TAKES input/A0, padChar/A1 RETURNS output/A0                   
                 BIND( "mmlRJust",  "MNTRT1" );                                 
                                                                                
  Cfun strFind   TAKES input/A0, string/A0 RETURNS index/I6                     
                 BIND( "mmlFind",   "MNTRT1" );                                 
                                                                                
  Cfun strToken  TAKES input/A0, breakTable/A0 RETURNS output/A0                
                 BIND( "mmlNextToken",  "MNTRT1" );                             
                                                                                
  Cfun Compress  TAKES input/A0 RETURNS output/A0                               
                 BIND( "mmlCompressSpaces", "MNTRT1" );                         
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
EndDescribe;                                                                    
-*=======================================================================       
-*                                                                              
                                                                                
-*=======================================================================       
-*                                                                              
-********************SECTION 1*******************************************       
-*                                                                              
-*=======================================================================       
-*                                                                              
-* Class & BINDs for date and time functions                                    
-*                                                                              
-*=======================================================================       
-*                                                                              
Describe sys_type_uws_CM1DAT01 = ()                                             
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*  Date and Time Cfuns                                                         
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Cfun mntCTime TAKES  sec  / I2L, min  / I2L, hour  / I2L,                     
                       mday / I2,  mon  / I2,  year  / I3,                      
                       wday / I1,  yday / I3,  isdst / I5                       
                BIND( "mntCTime", "MNTRT1" );                                   
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
EndDescribe;                                                                    
-*=======================================================================       
-*                                                                              
                                                                                
-*=======================================================================       
-*                                                                              
-********************SECTION 2*******************************************       
-*                                                                              
-*=======================================================================       
-*                                                                              
-* Class & Methods for string functions                                         
-*                                                                              
-*=======================================================================       
-*                                                                              
Describe sys_type_uws_CM2STR01 = (sys_type_uws_CM1STR01)                        
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*   Replace - Recursively Replaces key/value pair                              
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case Replace TAKES input/A0, key/A0, value/A0 RETURNS output/A0;              
    Declare ( temp1/A0; temp2/A0; );                                            
                                                                                
    temp1 = input;                                                              
                                                                                
    Repeat ALL                                                                  
      temp2 = ReplaceOne( temp1, key, value );                                  
      if ( temp1 EQ temp2 ) Goto ExitRepeat;                                    
      temp1 = temp2;                                                            
    EndRepeat                                                                   
                                                                                
    output = temp1;                                                             
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*   ReplaceOne - Replaces key/value pair (once)                                
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case ReplaceOne TAKES input/A0, key/A0, value/A0 RETURNS output/A0;           
    Declare index/I6;                                                           
                                                                                
    index = strFind( input, key );                                              
    if ( index LE 0 ) Begin output = input; goto EndCase; EndBegin;             
                                                                                
    output = substr( input, 1, index-1 ) | value |                              
             substr( input, index + length(key), length(input) );               
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*   String Overlay                                                             
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case StrOverlay takes input/a0, str/a0, pos/i6 returns ret/a0;                
    ret = substr( input, 1, pos-1 ) | str |                                     
          substr( input, pos + length(str), length(input) );                    
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*   String to Soundex                                                          
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case StrSoundex takes input/a0 returns ret/a0;                                
    Declare (thisChar/a1; prevChar/a1; upTemp/a0; code/a1;                      
             ipos/i4; ilen/i4; olen/i4; );                                      
                                                                                
    upTemp   = upper(input);                                                    
    prevChar = substr(upTemp, 1, 1);  -*                                        
-*  get first character of string                                               
    ret = prevChar;                   -*                                        
-*  save first character                                                        
    ilen = trimlen(upTemp);           -*                                        
-*  get (trimed) length of input                                                
    olen = 1;                         -*                                        
-*  set current output length                                                   
    ipos = 2;                         -*                                        
-*  set current input position                                                  
                                                                                
    Repeat while ipos le ilen;                                                  
      if (olen ge 4)                                                            
      then goto exitRepeat;                                                     
                                                                                
      code = ' ';                                                               
      thisChar = substr(upTemp, ipos, 1);                                       
                                                                                
      if (thisChar eq prevChar)                                                 
      then goto endRepeat;                                                      
                                                                                
      if ((strFind("BPFV", thisChar)) ne 0)                                     
      then code = "1";                                                          
      ELSE                                                                      
      if ((strFind("CSKGJQXZ", thisChar)) ne 0)                                 
      then code = "2";                                                          
      ELSE                                                                      
      if ((strFind("DT", thisChar)) ne 0)                                       
      then code = "3";                                                          
      ELSE                                                                      
      if (thisChar eq "L")                                                      
      then code = "4";                                                          
      ELSE                                                                      
      if ((strFind("MN", thisChar)) ne 0)                                       
      then code = "5";                                                          
      ELSE                                                                      
      if (thisChar eq "R")                                                      
      then code = "6";                                                          
                                                                                
      if (code ne ' ')                                                          
      then BEGIN                                                                
        ret = ret | code;                                                       
        olen = olen + 1;                                                        
      ENDBEGIN;                                                                 
                                                                                
      prevChar = thisChar;                                                      
    EndRepeat ipos = ipos+1;                                                    
                                                                                
    -*                                                                          
-*  add trailing zeros if not yet 4 characters.                                 
    Repeat while olen lt 4                                                      
      ret = ret | "0";                                                          
    EndRepeat olen = olen + 1;                                                  
                                                                                
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*  LCWORD - old ibi UWS - Lower Case (a string of) Words                       
-*                                                                              
  -*                                                                            
-*  The first word starts at the start of the string                            
-*                                                                              
  -*                                                                            
-*  and ends before a 'split' character, the next word starts after             
-*                                                                              
  -*                                                                            
-*  the 'split' character, there are three split characters                     
-*                                                                              
  -*                                                                            
-*  single quote, double quote and space. each word has it's first              
-*                                                                              
  -*                                                                            
-*  character upper cased and the rest is lower cased.                          
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case LCWORD takes str/a0 returns out/a0;                                      
    Declare (str2/a0; word/a0; wlen/i4; slen/i4; schr/a1; );                    
    Declare (split/a0;);                                                        
                                                                                
    split = '\'" ';                                                             
    str2  = trim(str);                                                          
    slen  = length(str2);                                                       
                                                                                
    Repeat ALL;                                                                 
     word = strToken(str2, split);                                              
     wlen = length(word);                                                       
     schr = substr(str2, wlen+1, 1);  -*                                        
-*  split on this character                                                     
     word = StrCap(word);                                                       
     str2 = substr(str2, wlen+2, slen);                                         
     slen = trimlen(str2);                                                      
     out = out | word | schr;                                                   
     if (slen le 0) then goto exitRepeat;                                       
    EndRepeat;                                                                  
  EndCase                                                                       
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*  LCWORD2 - similar to LCWORD above, except attempt to NOT capitalize         
-*                                                                              
  -*                                                                            
-*  when single quote has been used INSIDE a word!                              
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case LCWORD2 takes str/a0 returns out/a0;                                     
    Declare (str2/a0; word/a0; wlen/i4; slen/i4; schr/a1; );                    
    Declare (split/a0;);                                                        
    Declare (pchr/a1; psch/a1; i/i4;);                                          
                                                                                
    split = '\'" ';                                                             
    str2  = trim(str);                                                          
    slen  = length(str2);                                                       
    psch  = " ";                                                                
                                                                                
    repeat ALL;                                                                 
     word = strToken(str2, split);                                              
     wlen = length(word);                                                       
     schr = substr(str2, wlen+1, 1);  -*                                        
-*  split on this character                                                     
     if (psch eq "'")  -*                                                       
-*  if PREVIOUS split char was single quote                                     
     then Begin                                                                 
       pchr = lower(substr(str2, wlen, 1));                                     
       -*                                                                       
-*  if previous character is NOT alphabetic ...                                 
       i = self.strFind("abcdefghijklmnopqrstuvwxyz", pchr);                    
       if (i eq 0)                                                              
         then word = StrCap(word)                                               
     EndBegin                                                                   
     else  -*                                                                   
-*  if split character is NOT single quote                                      
       word = StrCap(word);                                                     
     psch = schr; -*                                                            
-*  save'previous' split character                                              
     str2 = substr(str2, wlen+2, slen);                                         
     slen = trimlen(str2);                                                      
     out = out | word | schr;                                                   
     if (slen le 0) then goto exitRepeat;                                       
    EndRepeat;                                                                  
  EndCase                                                                       
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*  StrCap = capitalize the first character, lower case the rest                
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case StrCap takes str/a0 returns ret/a0;                                      
    ret = upcase(substr(str, 1, 1))                                             
         | lower(substr(str, 2, length(str)-1));                                
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
EndDescribe;                                                                    
-*=======================================================================       
-*                                                                              
                                                                                
-*=======================================================================       
-*                                                                              
-********************SECTION 2*******************************************       
-*                                                                              
-*=======================================================================       
-*                                                                              
-* Class & Methods for date and time functions                                  
-*                                                                              
-*=======================================================================       
-*                                                                              
                                                                                
-*-----------------------------------------------------------------------       
-*                                                                              
-* Wrapper class for ANSI C Library localtime function                          
-*                                                                              
-*-----------------------------------------------------------------------       
-*                                                                              
Describe sys_type_uws_CM2DAT01                                                  
  = (sys_type_uws_CM1DAT01                                                      
   + sec   / I2L,  $$                                                           
$$  seconds after the minute -- 0,61                                          
     min   / I2L,  $$                                                           
$$  minutes after the hour   -- 0,59                                          
     hour  / I2L,  $$                                                           
$$  hours after midnight     -- 0,23                                          
     mday  / I2,   $$                                                           
$$  day of the month         -- 1,31                                          
     mon   / I2,   $$                                                           
$$  months since January     -- 0,11                                          
     year  / I3,   $$                                                           
$$  years since 1900                                                            
     wday  / I1,   $$                                                           
$$  days since Sunday        -- 0,6                                           
     yday  / I3,   $$                                                           
$$  days since January 1     -- 0,365                                         
     isdst / I5 )  $$                                                           
$$  Daylight Savings Time flag                                                  
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case StartUp;                                                                 
    self.getCurrentTime();                                                      
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case getCurrentTime                                                           
    mntCTime( sec, min, hour, mday, mon, year, wday, yday, isdst );             
  EndCase                                                                       
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case fmt_HHMMSS RETURNS hhmmss/A6;                                            
    hhmmss = hour | min | sec ;                                                 
  EndCase                                                                       
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case fmt_YYMD RETURNS yyyymmdd/A8;                                            
    Declare  ivYY / I4L;                                                        
             ivM  / I2L;                                                        
             ivD  / I2L;                                                        
                                                                                
    ivYY     = 1900 + year;                                                     
    ivM      = mon + 1;                                                         
    ivD      = mDay;                                                            
    yyyymmdd = ivYY | ivM | ivD ;                                               
  EndCase                                                                       
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case HHMMSS returns t/a8;                                                     
    declare (hh/a2; mm/a2; ss/a2;);                                             
    hh = hour; mm = min; ss=sec;                                                
                                                                                
    if (trimlen(hh) lt 2) then hh = "0" | hh;                                   
    if (trimlen(mm) lt 2) then mm = "0" | mm;                                   
    if (trimlen(ss) lt 2) then ss = "0" | ss;                                   
                                                                                
    t = hh | "." | mm | "." | ss;                                               
  EndCase                                                                       
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case TODAY  returns d/a8;                                                     
    declare (yy/a2; mm/a2; dd/a2;);                                             
    yy = year mod 100;  mm = (mon+1);  dd = mDay;                               
                                                                                
    if (trimlen(yy) lt 2) then yy = "0" | yy;                                   
    if (trimlen(mm) lt 2) then mm = "0" | mm;                                   
    if (trimlen(dd) lt 2) then dd = "0" | dd;                                   
                                                                                
    d = mm | "/" | dd | "/" | yy;                                               
  EndCase                                                                       
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*  PRJ=28364 MIP=32661091                                                      
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*    TODAY2 - similar to TODAY() but returns full four digit year              
-*                                                                              
  -*                                                                            
-*             *including* the century!                                         
-*                                                                              
  -*                                                                            
-*             (returns an A10 - whereas TODAY() returns an A8)                 
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case TODAY2  returns d/a10;                                                   
    declare (yy/a4; mm/a2; dd/a2; zz/i4;);                                      
    zz = 1900 + year;                                                           
    yy = zz;    mm = (mon+1);  dd = mDay;                                       
                                                                                
    if (trimlen(mm) lt 2) then mm = "0" | mm;                                   
    if (trimlen(dd) lt 2) then dd = "0" | dd;                                   
                                                                                
    d = mm | "/" | dd | "/" | yy;                                               
  EndCase                                                                       
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
EndDescribe;                                                                    
-*=======================================================================       
-*                                                                              
                                                                                
-* NOTE: Users of these functions only need to look at the global CASEs         
-*                                                                              
-*       The global CASEs are all in SECTION 3                                  
-*                                                                              
                                                                                
                                                                                
-*=======================================================================       
-*                                                                              
-********************SECTION 3*******************************************       
-*                                                                              
-*=======================================================================       
-*                                                                              
-* Global Cases & Declares for string functions                                 
-*                                                                              
-*=======================================================================       
-*                                                                              
                                                                                
  -*                                                                            
-* *********************************************************************        
-*                                                                              
  DECLARE sys_inst_uws_cm2str01/sys_type_uws_cm2str01;                          
  -*                                                                            
-* *********************************************************************        
-*                                                                              
                                                                                
  Case LJUST  takes input/a0 returns ret/a0;                                    
    ret = sys_inst_uws_cm2str01.LTrim(input);                                   
  EndCase                                                                       
                                                                                
  Case STRAN  takes input/a0, key/a0, rep/a0 returns ret/a0;                    
    ret = sys_inst_uws_cm2str01.replace(input, key, rep);                       
  EndCase;                                                                      
                                                                                
  Case POSIT  takes input/a0, str/a0 returns ret/i6;                            
    ret = sys_inst_uws_cm2str01.strFind(input, str);                            
  EndCase;                                                                      
                                                                                
  Case OVRLAY takes input/a0, str/a0,pos/i6 returns ret/a0;                     
    ret = sys_inst_uws_cm2str01.strOverlay(input, str, pos);                    
  EndCase;                                                                      
                                                                                
  Case SOUNDEX takes input/a0 returns ret/a0;                                   
    ret = sys_inst_uws_cm2str01.strSoundex(input);                              
  EndCase;                                                                      
                                                                                
  Case LOWER  takes input/a0 returns ret/a0;                                    
    ret = sys_inst_uws_cm2str01.Lower(input);                                   
  EndCase;                                                                      
                                                                                
  Case UPCASE takes input/a0 returns ret/a0;                                    
    ret = sys_inst_uws_cm2str01.Upper(input);                                   
  EndCase;                                                                      
                                                                                
  Case STRTOKEN takes input/a0, brktbl/a0 returns ret/a0;                       
    ret = sys_inst_uws_cm2str01.StrToken(input, brkTbl);                        
  EndCase;                                                                      
                                                                                
  Case LCWORD takes input/a0 returns ret/a0;                                    
    ret = sys_inst_uws_cm2str01.LCWORD(input);                                  
  EndCase;                                                                      
                                                                                
  Case LCWORD2 takes input/a0 returns ret/a0;                                   
    ret = sys_inst_uws_cm2str01.LCWORD2(input);                                 
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
-*=======================================================================       
-*                                                                              
                                                                                
-*=======================================================================       
-*                                                                              
-********************SECTION 3*******************************************       
-*                                                                              
-*=======================================================================       
-*                                                                              
-* Global Cases & Declares for date and time functions                          
-*                                                                              
-*=======================================================================       
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  DECLARE sys_inst_uws_CM2DAT01_initial/sys_type_uws_CM2DAT01;                  
  DECLARE sys_inst_uws_CM2DAT01_current/sys_type_uws_CM2DAT01;                  
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case HHMMSS returns t/a8;                                                     
        sys_inst_uws_CM2DAT01_current.GetCurrentTime();                         
    t = sys_inst_uws_CM2DAT01_current.HHMMSS();                                 
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case TODAY  returns t/a8;                                                     
        sys_inst_uws_CM2DAT01_current.GetCurrentTime();                         
    t = sys_inst_uws_CM2DAT01_current.TODAY();                                  
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  -*                                                                            
-*  PRJ=28364 MIP=32661091                                                      
-*                                                                              
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case TODAY2  returns t/a10;                                                   
        sys_inst_uws_CM2DAT01_current.GetCurrentTime();                         
    t = sys_inst_uws_CM2DAT01_current.TODAY2();                                 
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case Initial_HHMMSS returns t/a8;                                             
    t = sys_inst_uws_CM2DAT01_initial.HHMMSS();                                 
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
  -*                                                                            
-* ---------------------------------------------------------------------        
-*                                                                              
  Case Initial_TODAY  returns t/a8;                                             
    t = sys_inst_uws_CM2DAT01_initial.TODAY();                                  
  EndCase;                                                                      
  -*                                                                            
-* =====================================================================        
-*                                                                              
                                                                                
-*=======================================================================       
-*                                                                              
END                                                                             
