JOIN INST_KEY IN RPT_INST TO INST_KEY IN IHIER_BK
TABLE FILE RPT_INST 
PRINT INST_KEY HIER_LEVEL
BY ROLLUP_CODE
WHERE GLOBAL_PARM EQ 'CHEXCHG'
WHERE SET_KEY CONTAINS '20011023111531'
ON TABLE HOLD AS DEBHOLD
END

TABLE FILE DEBHOLD
PRINT INST_KEY HIER_LEVEL
BY INST_KEY NOPRINT
ON TABLE HOLD AS PHOLD
END

MODIFY FILE IHIER_BK
FIXFORM FROM PHOLD
MATCH INST_KEY HIER_LEVEL
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON PHOLD
END
-* JOIN CLEAR *



JOIN INST_KEY IN RPT_INST TO INST_KEY IN I_SUMM
TABLE FILE RPT_INST
PRINT INST_KEY
BY ROLLUP_CODE
WHERE GLOBAL_PARM EQ 'CHEXCHG'
WHERE SET_KEY CONTAINS '20011023111531'
ON TABLE HOLD AS DEBHOLD
END

TABLE FILE DEBHOLD
PRINT INST_KEY 
BY INST_KEY NOPRINT
ON TABLE HOLD AS PHOLD
END

MODIFY FILE I_SUMM
FIXFORM FROM PHOLD
MATCH INST_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON PHOLD
END 
-* JOIN CLEAR *

JOIN INST_KEY IN RPT_INST TO INST_KEY IN IHIER_SL
TABLE FILE RPT_INST 
PRINT INST_KEY SEL_KEY
BY ROLLUP_CODE
WHERE GLOBAL_PARM EQ 'CHEXCHG'
WHERE SET_KEY CONTAINS '20011023111531'
ON TABLE HOLD AS DEBHOLD
END

TABLE FILE DEBHOLD
PRINT INST_KEY SEL_KEY
BY INST_KEY NOPRINT
ON TABLE HOLD AS PHOLD
END

MODIFY FILE IHIER_SL
FIXFORM FROM PHOLD
MATCH INST_KEY SEL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON PHOLD
END
-* JOIN CLEAR *



JOIN SET_KEY IN RPT_INST TO SET_KEY IN RPT_SET
TABLE FILE RPT_INST 
PRINT INST_KEY SET_KEY RPT_NAME SET_NAME
BY ROLLUP_CODE
WHERE GLOBAL_PARM EQ 'OTTRANP'
ON TABLE HOLD AS DEBHOLD
END

TABLE FILE DEBHOLD
PRINT INST_KEY 
BY INST_KEY NOPRINT
ON TABLE HOLD AS PHOLD
END



MODIFY FILE RPT_INST
FIXFORM FROM PHOLD
MATCH INST_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON PHOLD
END
-RUN
