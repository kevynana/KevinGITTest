-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Created for the new quarterly review - JK 8/2/05
-******************************************************************************
-INCLUDE SETECHO
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

-SET &POS0=0;
-SET &INC =  17;
-* -SET &INC1 = 18;
-SET &POS1T = &POS0 + 1 * &INC;
-* -SET &POS1T1 = &POS0 + 1 * &INC1;

-SET &POS1 = &POS1T + 0;
-SET &POS2 = &POS1 + 6;
-SET &POS3 = &POS2 + 6;
-SET &POS4 = &POS3 + 6;
-SET &POS5 = &POS4 + 6;
-SET &POS6 = &POS5 + 6;
-SET &POS7 = &POS6 + 6;
-SET &POS8 = &POS7 + 6;
-SET &POS9 = &POS8 + 6;
-SET &POS10 = &POS9 + 6;
-SET &POS11 = &POS10 + 6;
-SET &POS12 = &POS11 + 6;
-SET &POS13 = &POS12 - 4;
-SET &POS14 = &POS12 + 4;
-SET &POS15 = &POS14 + 2;

-SET &POS1A = &POS1+1 ;
-SET &POS2A = &POS2+1 ;
-SET &POS3A = &POS3+1 ;
-SET &POS4A = &POS4+1 ;
-SET &POS5A = &POS5+1 ;
-SET &POS6A = &POS6+1 ;
-SET &POS7A = &POS7+1 ;
-SET &POS8A = &POS8+1 ;
-*-SET &POS9A = &POS9+2 ;
-*-SET &POS10A = &POS10+2 ;
-SET &POS9A = &POS9 ;
-SET &POS10A = &POS10 ;
-SET &POS11A = &POS11+1 ;
-SET &POS12A = &POS12+1 ;

-* Base Tran Dates by quarter
-SET &TD1 = ' ';
-SET &TD2 = ' ';
-SET &TD3 = ' ';
-SET &TD4 = ' ';
-SET &TD5 = ' ';
-SET &TD6 = ' ';
-SET &TD7 = ' ';
-SET &TD8 = ' ';
-* Base Tran Dates by Year
-SET &TDY1 = ' ';
-SET &TDY2 = ' ';
-* Advanced Purchase %'s 
-* Base 0-6 by quarter
-SET &BAPA1 = '';
-SET &BAPA2 = '';
-SET &BAPA3 = '';
-SET &BAPA4 = '';
-SET &BAPA5 = '';
-SET &BAPA6 = '';
-SET &BAPA7 = '';
-SET &BAPA8 = '';
-* Peer 0-6 by quarter
-SET &PAPA1 = '';
-SET &PAPA2 = '';
-SET &PAPA3 = '';
-SET &PAPA4 = '';
-SET &PAPA5 = '';
-SET &PAPA6 = '';
-SET &PAPA7 = '';
-SET &PAPA8 = '';
-* Base 0-6 by year 
-SET &BAPAY1 = '';
-SET &BAPAY2 = '';
-* Peer 0-6 by year 
-SET &PAPAY1 = '';
-SET &PAPAY2 = '';
-* Base 7-13 by quarter
-SET &BAPB1 = '';
-SET &BAPB2 = '';
-SET &BAPB3 = '';
-SET &BAPB4 = '';
-SET &BAPB5 = '';
-SET &BAPB6 = '';
-SET &BAPB7 = '';
-SET &BAPB8 = '';
-* Peer 7-13 by quarter
-SET &PAPB1 = '';
-SET &PAPB2 = '';
-SET &PAPB3 = '';
-SET &PAPB4 = '';
-SET &PAPB5 = '';
-SET &PAPB6 = '';
-SET &PAPB7 = '';
-SET &PAPB8 = '';
-* Base 7-13 by year 
-SET &BAPBY1 = '';
-SET &BAPBY2 = '';
-* Peer 0-6 by year 
-SET &PAPBY1 = '';
-SET &PAPBY2 = '';
-* Base 14+ by quarter
-SET &BAPC1 = '';
-SET &BAPC2 = '';
-SET &BAPC3 = '';
-SET &BAPC4 = '';
-SET &BAPC5 = '';
-SET &BAPC6 = '';
-SET &BAPC7 = '';
-SET &BAPC8 = '';
-* Peer 14+ by quarter
-SET &PAPC1 = '';
-SET &PAPC2 = '';
-SET &PAPC3 = '';
-SET &PAPC4 = '';
-SET &PAPC5 = '';
-SET &PAPC6 = '';
-SET &PAPC7 = '';
-SET &PAPC8 = '';
-* Base 14+ by year 
-SET &BAPCY1 = '';
-SET &BAPCY2 = '';
-* Peer 14+ by year 
-SET &PAPCY1 = '';
-SET &PAPCY2 = '';
-* Average Ticket Price
-* 0-6 by quarter
-SET &ATA1 = '';
-SET &ATA2 = '';
-SET &ATA3 = '';
-SET &ATA4 = '';
-SET &ATA5 = '';
-SET &ATA6 = '';
-SET &ATA7 = '';
-SET &ATA8 = '';
-* 0-6 by year
-SET &ATAY1 = '';
-SET &ATAY2 = '';
-* 7-13 by quarter
-SET &ATB1 = '';
-SET &ATB2 = '';
-SET &ATB3 = '';
-SET &ATB4 = '';
-SET &ATB5 = '';
-SET &ATB6 = '';
-SET &ATB7 = '';
-SET &ATB8 = '';
-* 7-13 by year
-SET &ATBY1 = '';
-SET &ATBY2 = '';
-* 14 + by quarter
-SET &ATC1 = '';
-SET &ATC2 = '';
-SET &ATC3 = '';
-SET &ATC4 = '';
-SET &ATC5 = '';
-SET &ATC6 = '';
-SET &ATC7 = '';
-SET &ATC8 = '';
-* 14 + by year
-SET &ATCY1 = '';
-SET &ATCY2 = '';

-* Base Roll Average Advance Purchase Days
-SET &AAB1 = '';
-SET &AAB2 = '';
-SET &AAB3 = '';
-SET &AAB4 = '';
-SET &AAB5 = '';
-SET &AAB6 = '';
-SET &AAB7 = '';
-SET &AAB8 = '';
-* Peer Group Average Advance Purchase Days
-SET &AAP1 = '';
-SET &AAP2 = '';
-SET &AAP3 = '';
-SET &AAP4 = '';
-SET &AAP5 = '';
-SET &AAP6 = '';
-SET &AAP7 = '';
-SET &AAP8 = '';
-* Base Non Refundable Tickets Percentage
-SET &NRB1 = '';
-SET &NRB2 = '';
-SET &NRB3 = '';
-SET &NRB4 = '';
-SET &NRB5 = '';
-SET &NRB6 = '';
-SET &NRB7 = '';
-SET &NRB8 = '';
-SET &NRBY1 = '';
-SET &NRBY2 = '';
-* BASE Non Refundable Average Ticket Price
-SET &BNRTP = '';

-* Peer Non Refundable Tickets Percentage
-SET &NRP1 = '';
-SET &NRP2 = '';
-SET &NRP3 = '';
-SET &NRP4 = '';
-SET &NRP5 = '';
-SET &NRP6 = '';
-SET &NRP7 = '';
-SET &NRP8 = '';
-SET &NRPY1 = '';
-SET &NRPY2 = '';
-* Peer Non Refundable Average Ticket Price
-SET &PNRTP = '';

-* Base Refundable Average Ticket Price
-SET &BRTP = '' ;

-* Peer Refundable Average Ticket Price
-SET &PRTP = '';

DEFINE FILE QRADVPUR
ROLL/A12 = IF ROLLUP_CODE EQ '&&BASEROLL.EVAL' THEN 'Base Company' ELSE 'Peer Group';
END
TABLE FILE QRADVPUR
SUM ADV_FPA ADV_FPB ADV_FPC ADV_NTA ADV_NTB ADV_NTC FARE_PAID NET_TKT_CNT NON_FP 
    NON_NT REF_FP REF_NT REC_CNT TTLDAYS CURRENT PRIOR PYTD CQ
BY ROLL
BY YEAR
BY TRAN    
ON TABLE HOLD AS AP1
END
-RUN

-********************************************************************************
-* advanced Purchase % by year
-********************************************************************************
DEFINE FILE AP1
BADV_NTA = IF ROLL EQ 'Base Company' THEN ADV_NTA ELSE 0;
BADV_NTB = IF ROLL EQ 'Base Company' THEN ADV_NTB ELSE 0;
BADV_NTC = IF ROLL EQ 'Base Company' THEN ADV_NTC ELSE 0;
PADV_NTA = IF ROLL NE 'Base Company' THEN ADV_NTA ELSE 0;
PADV_NTB = IF ROLL NE 'Base Company' THEN ADV_NTB ELSE 0;
PADV_NTC = IF ROLL NE 'Base Company' THEN ADV_NTC ELSE 0;
BNTKT/D12 = IF ROLL EQ 'Base Company' THEN NET_TKT_CNT ELSE 0;
PNTKT/D12 = IF ROLL NE 'Base Company' THEN NET_TKT_CNT ELSE 0;
END
-RUN
TABLE FILE AP1
SUM 
COMPUTE BADVPA/D4 = IF ((BNTKT LT 1) AND (BNTKT GT (-1))) THEN 0 ELSE
                      (BADV_NTA/BNTKT)*100;   
        BADVPB/D4 = IF ((BNTKT LT 1) AND (BNTKT GT (-1))) THEN 0 ELSE
                      (BADV_NTB/BNTKT)*100;     
        BADVPV/D4 = IF ((BNTKT LT 1) AND (BNTKT GT (-1))) THEN 0 ELSE
                       (BADV_NTC/BNTKT)*100;      
        PADVPA/D4 = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE
                       (PADV_NTA/PNTKT)*100;   
        PADVPB/D4 = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE
                      (PADV_NTB/PNTKT)*100;     
        PADVPC/D4 = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE
                      (PADV_NTC/PNTKT)*100;     
BY ROLL
BY YEAR
WHERE CURRENT EQ 'Y' OR PYTD EQ 'Y'
ON TABLE HOLD AS AP2
END
-RUN

-*BADVPA: prior YTD(0-6 days); BADVPB:prior YTD (7-13days); BADVPV:(14+)
TABLE FILE AP1
BY TRAN
WHERE PRIOR EQ 'Y'
ON TABLE SAVE
END
-RUN

-SET &PYTDCOMP = IF &LINES LT 4 THEN 'N' ELSE 'Y';
-SET &CNT = IF &LINES LT 4 THEN 2 ELSE 1;

TABLE FILE AP2
-*PRINT YEAR BADVPA BADVPB BADVPV  
SUM BADVPA BADVPB BADVPV  
BY YEAR
WHERE ROLL EQ 'Base Company'
ON TABLE SAVE AS BADVPYR
END
-RUN

-REPEAT TOEND &LINES TIMES
-READ BADVPYR NOCLOSE &TDY.&CNT.4. &BAPAY.4. &BAPBY.4. &BAPCY.4. 

EX FMTNUMBER VALUE=&BAPAY,DOLLAR=N,LEN=4
-RUN
-SET &BAPAY.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&BAPBY,DOLLAR=N,LEN=4
-RUN
-SET &BAPBY.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&BAPCY,DOLLAR=N,LEN=4
-RUN
-SET &BAPCY.&CNT = '&&RETVAL.EVAL'||'%';

-SET &CNT = &CNT + 1;
-TOEND 
-CLOSE BADVPYR
-RUN

-*peer group
TABLE FILE AP2
SUM PADVPA PADVPB PADVPC
BY YEAR
WHERE ROLL NE 'Base Company'
ON TABLE SAVE AS BADVPYR2
END
-RUN

-SET &CNT = IF &PYTDCOMP EQ 'Y' THEN 1 ELSE 2;
-REPEAT TOEND11 &LINES TIMES
-READ BADVPYR2 NOCLOSE &TDY.&CNT.4. &PAPAY.4. &PAPBY.4. &PAPCY.4. 

EX FMTNUMBER VALUE=&PAPAY,DOLLAR=N,LEN=4
-RUN
-SET &PAPAY.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&PAPBY,DOLLAR=N,LEN=4
-RUN
-SET &PAPBY.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&PAPCY,DOLLAR=N,LEN=4
-RUN
-SET &PAPCY.&CNT = '&&RETVAL.EVAL'||'%';

-SET &CNT = &CNT + 1;
-TOEND11 
-CLOSE BADVPYR2
-RUN

-*****************************************************************************
-* Advanced Purchase % by quarter
-*****************************************************************************
DEFINE FILE AP1
BADV_NTA = IF ROLL EQ 'Base Company' THEN ADV_NTA ELSE 0;
BADV_NTB = IF ROLL EQ 'Base Company' THEN ADV_NTB ELSE 0;
BADV_NTC = IF ROLL EQ 'Base Company' THEN ADV_NTC ELSE 0;
PADV_NTA = IF ROLL NE 'Base Company' THEN ADV_NTA ELSE 0;
PADV_NTB = IF ROLL NE 'Base Company' THEN ADV_NTB ELSE 0;
PADV_NTC = IF ROLL NE 'Base Company' THEN ADV_NTC ELSE 0;
BNTKT/D12 = IF ROLL EQ 'Base Company' THEN NET_TKT_CNT ELSE 0;
PNTKT/D12 = IF ROLL NE 'Base Company' THEN NET_TKT_CNT ELSE 0;
END
-RUN
TABLE FILE AP1
SUM 
COMPUTE BADVPA/D4 = IF ((BNTKT LT 1) AND (BNTKT GT (-1))) THEN 0 ELSE
                      (BADV_NTA/BNTKT)*100;   
        BADVPB/D4 = IF ((BNTKT LT 1) AND (BNTKT GT (-1))) THEN 0 ELSE
                      (BADV_NTB/BNTKT)*100;     
        BADVPV/D4 = IF ((BNTKT LT 1) AND (BNTKT GT (-1))) THEN 0 ELSE
                       (BADV_NTC/BNTKT)*100;      
        PADVPA/D4 = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE
                       (PADV_NTA/PNTKT)*100;   
        PADVPB/D4 = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE
                      (PADV_NTB/PNTKT)*100;     
        PADVPV/D4 = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE
                      (PADV_NTC/PNTKT)*100;    
                    
BY ROLL
BY TRAN
ON TABLE HOLD AS AP3
END
-RUN


-*********************************************
TABLE FILE AP3
SUM BADVPA BADVPB BADVPV 
BY TRAN
WHERE ROLL EQ 'Base Company'
ON TABLE SAVE AS BADVPQ
END
-RUN
-SET &CNT = 0;
-REPEAT TOEND21 &LINES TIMES
-SET &CNT = &CNT + 1;
-READ BADVPQ NOCLOSE &TD.&CNT.7. &BAPA.4. &BAPB.4. &BAPC.4. 

EX FMTNUMBER VALUE=&BAPA,DOLLAR=N,LEN=5
-RUN
-SET &BAPA.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&BAPB,DOLLAR=N,LEN=5
-RUN
-SET &BAPB.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&BAPC,DOLLAR=N,LEN=5
-RUN
-SET &BAPC.&CNT = '&&RETVAL.EVAL'||'%';
-TOEND21
-CLOSE BADVPQ

TABLE FILE AP3
SUM  PADVPA PADVPB PADVPV
BY TRAN 
ON TABLE SAVE AS PADVPQ
END
-RUN

-SET &CNT = 0;
-REPEAT TOEND22 &LINES TIMES
-SET &CNT = &CNT + 1;
-*-READ PADVPQ NOCLOSE &TD.&CNT.7. &PAPA.4. &PAPB.4. &PAPC.4.
-READ PADVPQ NOCLOSE &X.7. &PAPA.4. &PAPB.4. &PAPC.4.

EX FMTNUMBER VALUE=&PAPA,DOLLAR=N,LEN=5
-RUN
-SET &PPA.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&PAPB,DOLLAR=N,LEN=5
-RUN
-SET &PAPB.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&PAPC,DOLLAR=N,LEN=5
-RUN
-SET &PAPC.&CNT = '&&RETVAL.EVAL'||'%';

-TOEND22 
-CLOSE PADVPQ
-RUN
-*********************************************
-GOTO TOEND23
TABLE FILE AP3
PRINT BADVPA BADVPB BADVPV PADVPA PADVPB PADVPV
BY TRAN
ON TABLE SAVE AS ADVPQ
END
-RUN

-SET &CNT = 0;
-REPEAT TOEND2 &LINES TIMES
-SET &CNT = &CNT + 1;
-READ ADVPQ NOCLOSE &TD.&CNT.7. &BAPA.4. &BAPB.4. &BAPC.4. &PAPA.4. &PAPB.4. &PAPC.4.

EX FMTNUMBER VALUE=&BAPA,DOLLAR=N,LEN=5
-RUN
-SET &BAPA.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&BAPB,DOLLAR=N,LEN=5
-RUN
-SET &BAPB.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&BAPC,DOLLAR=N,LEN=5
-RUN
-SET &BAPC.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&PAPA,DOLLAR=N,LEN=5
-RUN
-SET &PPA.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&PAPB,DOLLAR=N,LEN=5
-RUN
-SET &PAPB.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&PAPC,DOLLAR=N,LEN=5
-RUN
-SET &PAPC.&CNT = '&&RETVAL.EVAL'||'%';

-TOEND2 
-CLOSE ADVPQ
-RUN

-TOEND23
-************************************************************************************************
-* Average Ticket Price by Year
-************************************************************************************************
TABLE FILE AP1
SUM 
COMPUTE AVGTA/D12 = IF ((ADV_NTA LT 1) AND (ADV_NTA GT (-1))) THEN 0 ELSE
                      (ADV_FPA/ADV_NTA);   
        AVGTB/D12 = IF ((ADV_NTB LT 1) AND (ADV_NTB GT (-1))) THEN 0 ELSE
                      (ADV_FPB/ADV_NTB);  
        AVGTC/D12 = IF ((ADV_NTC LT 1) AND (ADV_NTC GT (-1))) THEN 0 ELSE
                      (ADV_FPC/ADV_NTC);  
BY YEAR
BY ROLL
WHERE ROLL EQ 'Base Company'
WHERE CURRENT EQ 'Y' OR PYTD EQ 'Y'
ON TABLE HOLD AS AP2
END
-RUN

TABLE FILE AP2
PRINT AVGTA AVGTB AVGTC
BY YEAR
ON TABLE SAVE AS AVTPY
END
-RUN

-SET &BTDY1 = ' ';
-SET &BTDY2 = ' ';

-SET &CNT = IF &PYTDCOMP EQ 'Y' THEN 1 ELSE 2;

-REPEAT TOATY &LINES TIMES

-READ AVTPY NOCLOSE &BTDY.4. &ATAY.12. &ATBY.12. &ATCY.12. 

-SET &BTDY.&CNT = &BTDY || 'YTD';

EX FMTNUMBER VALUE=&ATAY,DOLLAR=Y,LEN=7
-RUN
-SET &ATAY.&CNT = &&RETVAL; 

EX FMTNUMBER VALUE=&ATBY,DOLLAR=Y,LEN=7
-RUN
-SET &ATBY.&CNT = &&RETVAL;

EX FMTNUMBER VALUE=&ATCY,DOLLAR=Y,LEN=7
-RUN
-SET &ATCY.&CNT = &&RETVAL;

-SET &CNT = &CNT + 1;
-TOATY
-CLOSE AVTPY
-RUN

-************************************************************************************************
-* Average Ticket Price by Quarter
-************************************************************************************************
TABLE FILE AP1
SUM 
COMPUTE AVGTA/D12 = IF ((ADV_NTA LT 1) AND (ADV_NTA GT (-1))) THEN 0 ELSE
                      (ADV_FPA/ADV_NTA);   
        AVGTB/D12 = IF ((ADV_NTB LT 1) AND (ADV_NTB GT (-1))) THEN 0 ELSE
                      (ADV_FPB/ADV_NTB);  
        AVGTC/D12 = IF ((ADV_NTC LT 1) AND (ADV_NTC GT (-1))) THEN 0 ELSE
                      (ADV_FPC/ADV_NTC); 
BY TRAN
WHERE ROLL EQ 'Base Company'
ON TABLE HOLD AS AP3
END
-RUN


TABLE FILE AP3
PRINT AVGTA AVGTB AVGTC
BY TRAN
ON TABLE SAVE AS AVTPQ
END
-RUN

-SET &BTD1 = ' ';
-SET &BTD2 = ' ';
-SET &BTD3 = ' ';
-SET &BTD4 = ' ';
-SET &BTD5 = ' ';
-SET &BTD6 = ' ';
-SET &BTD7 = ' ';
-SET &BTD8 = ' ';

-SET &CNT = 0;
-REPEAT TOATQ &LINES TIMES
-SET &CNT = &CNT + 1;
-READ AVTPQ NOCLOSE &BTD.&CNT.7. &ATA.12. &ATB.12. &ATC.12. 

EX FMTNUMBER VALUE=&ATA,DOLLAR=Y,LEN=6
-RUN
-SET &ATA.&CNT = &&RETVAL;

EX FMTNUMBER VALUE=&ATB,DOLLAR=Y,LEN=6
-RUN
-SET &ATB.&CNT = &&RETVAL;

EX FMTNUMBER VALUE=&ATC,DOLLAR=Y,LEN=6
-RUN
-SET &ATC.&CNT = &&RETVAL;

-TOATQ 
-CLOSE AVTPQ
-RUN

-************************************************************************************************
-* Average Advanced Purchase Days by Quarter
-************************************************************************************************
TABLE FILE AP1
SUM REC_CNT AS 'BREC_CNT'
    TTLDAYS AS 'BTTLDAYS'
BY TRAN
WHERE ROLL EQ 'Base Company'
ON TABLE HOLD AS BAV1 
END
-RUN

TABLE FILE AP1
SUM REC_CNT AS 'PREC_CNT'
    TTLDAYS AS 'PTTLDAYS'
BY TRAN
WHERE ROLL NE 'Base Company'
ON TABLE HOLD AS PAV1 
END
-RUN

MATCH FILE BAV1
PRINT BREC_CNT
      BTTLDAYS
BY TRAN
ON TABLE HOLD
RUN
FILE PAV1
SUM PREC_CNT  
    PTTLDAYS
BY TRAN
AFTER MATCH HOLD AS TAV1 OLD-OR-NEW
END
-RUN

TABLE FILE TAV1
SUM 
COMPUTE BAVD/D4 = IF ((BREC_CNT LT 1) AND (BREC_CNT GT (-1))) THEN 0 ELSE
                     (BTTLDAYS/BREC_CNT);  
COMPUTE PAVD/D4 = IF ((PREC_CNT LT 1) AND (PREC_CNT GT (-1))) THEN 0 ELSE
                     (PTTLDAYS/PREC_CNT);  
BY TRAN
ON TABLE HOLD AS AP3
END
-RUN

TABLE FILE AP3
PRINT BAVD PAVD
BY TRAN
ON TABLE SAVE AS BAVDAY
END
-RUN

-SET &CNT = 0;
-REPEAT TOBAV &LINES TIMES
-SET &CNT = &CNT + 1;
-READ BAVDAY NOCLOSE &TD.&CNT.7. &AAB.4. &AAP.4.

EX FMTNUMBER VALUE=&AAB,DOLLAR=N,LEN=4
-RUN
-SET &AAB.&CNT = &&RETVAL;

EX FMTNUMBER VALUE=&AAP,DOLLAR=N,LEN=4
-RUN
-SET &AAP.&CNT = &&RETVAL;

-TOBAV 
-CLOSE BAVDAY
-RUN


-********************************************************************************
-* Base Non Refundable %'S by Year
-********************************************************************************
DEFINE FILE AP1
BNTKT/D12 = IF ROLL EQ 'Base Company' THEN NET_TKT_CNT ELSE 0;
PNTKT/D12 = IF ROLL NE 'Base Company' THEN NET_TKT_CNT ELSE 0;
BNON_NT/D12 = IF ROLL EQ 'Base Company' THEN NON_NT ELSE 0;
PNON_NT/D12 = IF ROLL NE 'Base Company' THEN NON_NT ELSE 0;
END
-RUN
TABLE FILE AP1
SUM 
COMPUTE BNRP/D4 = IF ((BNTKT LT 1) AND (BNTKT GT (-1))) THEN 0 ELSE
                    (BNON_NT/BNTKT)*100;     
COMPUTE PNRP/D4 = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE
                    (PNON_NT/PNTKT)*100;        
BY YEAR
WHERE CURRENT EQ 'Y' OR PYTD EQ 'Y'
ON TABLE HOLD AS AP2
END
-RUN


TABLE FILE AP2
PRINT BNRP PNRP
BY YEAR
ON TABLE SAVE AS BNONYR
END
-RUN

-SET &CNT = IF &PYTDCOMP EQ 'Y' THEN 1 ELSE 2;

-REPEAT TONONYR &LINES TIMES
-READ BNONYR NOCLOSE &TDY.4. &NRBY.4. &NRPY.4. 
-SET &TDY.&CNT = &TDY | 'YTD';

EX FMTNUMBER VALUE=&NRBY,DOLLAR=N,LEN=4
-RUN
-SET &NRBY.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&NRPY,DOLLAR=N,LEN=4
-RUN
-SET &NRPY.&CNT = '&&RETVAL.EVAL'||'%';

-SET &CNT = &CNT + 1;
-TONONYR 
-CLOSE BNONYR
-RUN


-*****************************************************************************
-* Base Non Refundable % by quarter
-*****************************************************************************
DEFINE FILE AP1
BNTKT/D12 = IF ROLL EQ 'Base Company' THEN NET_TKT_CNT ELSE 0;
PNTKT/D12 = IF ROLL NE 'Base Company' THEN NET_TKT_CNT ELSE 0;
BNON_NT/D12 = IF ROLL EQ 'Base Company' THEN NON_NT ELSE 0;
PNON_NT/D12 = IF ROLL NE 'Base Company' THEN NON_NT ELSE 0;
END
-RUN
TABLE FILE AP1
SUM 
COMPUTE BNRP/D4 = IF ((BNTKT LT 1) AND (BNTKT GT (-1))) THEN 0 ELSE
                    (BNON_NT/BNTKT)*100;     
COMPUTE PNRP/D4 = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE
                    (PNON_NT/PNTKT)*100;        
BY TRAN
ON TABLE HOLD AS AP2
END
-RUN 


TABLE FILE AP2
PRINT BNRP PNRP
BY TRAN
ON TABLE SAVE AS BNONQ
END
-RUN

-SET &CNT = 0;
-REPEAT TOBNONQ &LINES TIMES
-SET &CNT = &CNT + 1;
-READ BNONQ NOCLOSE &TD.&CNT.7. &NRB.4. &NRP.4.

EX FMTNUMBER VALUE=&NRB,DOLLAR=N,LEN=5
-RUN
-SET &NRB.&CNT = '&&RETVAL.EVAL'||'%';

EX FMTNUMBER VALUE=&NRP,DOLLAR=N,LEN=5
-RUN
-SET &NRP.&CNT = '&&RETVAL.EVAL'||'%';

-TOBNONQ
-CLOSE BNONQ
-RUN

-GOTO JOYKK

-*****************************************************************************
-* Peer Non Refundable % by quarter
-*****************************************************************************

TABLE FILE AP1
SUM 
COMPUTE NRP/D4 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                    (NON_NT/NET_TKT_CNT)*100;     
BY TRAN
WHERE ROLL EQ 'Peer Group'
WHERE CQ EQ 'Y'
ON TABLE HOLD AS AP2
END
-RUN


TABLE FILE AP2
PRINT NRP
BY TRAN
ON TABLE SAVE AS PNONQ
END
-RUN

-SET &CNT = IF &PYTDCOMP EQ 'Y' THEN 1 ELSE 2;

-REPEAT TOPNONQ &LINES TIMES

-READ PNONQ NOCLOSE &TD.&CNT.7. &NRP.4. 

EX FMTNUMBER VALUE=&NRP,DOLLAR=N,LEN=5
-RUN
-SET &NRP.&CNT = '&&RETVAL.EVAL'||'%';
-SET &CNT = &CNT + 1;
-TOPNONQ
-CLOSE PNONQ
-RUN

-JOYKK
-********************************************************************************
-* Base Non Refundable Average Ticket Price
-********************************************************************************
DEFINE FILE AP1
FLAG/A10 = 'Avg $ YTD';
END
-RUN
TABLE FILE AP1
SUM 
COMPUTE BNRTP/D8 = IF ((NON_NT LT 1) AND (NON_NT GT (-1))) THEN 0 ELSE
                      (NON_FP/NON_NT);     
BY FLAG
WHERE ROLL EQ 'Base Company'
WHERE CURRENT EQ 'Y'
ON TABLE HOLD AS AP2
END
-RUN

TABLE FILE AP2
PRINT BNRTP
BY FLAG
ON TABLE SAVE AS BNRAVG
END
-RUN

-READ BNRAVG NOCLOSE &FLAG.10. &BNRTP.8. 

EX FMTNUMBER VALUE=&BNRTP,DOLLAR=Y
-RUN
-SET &BNRTP = '&&RETVAL.EVAL';

-CLOSE BNRAVG
-RUN

-********************************************************************************
-* Peer Non Refundable Average Ticket Price
-********************************************************************************
DEFINE FILE AP1
FLAG/A10 = 'Avg $ YTD';
END
-RUN
TABLE FILE AP1
SUM 
COMPUTE PNRTP/D8 = IF ((NON_NT LT 1) AND (NON_NT GT (-1))) THEN 0 ELSE
                      (NON_FP/NON_NT);     
BY FLAG
WHERE ROLL EQ 'Peer Group'
WHERE CURRENT EQ 'Y'
ON TABLE HOLD AS AP2
END
-RUN

TABLE FILE AP2
PRINT PNRTP
BY FLAG
ON TABLE SAVE AS PNRAVG
END
-RUN

-READ PNRAVG NOCLOSE &FLAG.10. &PNRTP.8. 

EX FMTNUMBER VALUE=&PNRTP,DOLLAR=Y
-RUN
-SET &PNRTP = '&&RETVAL.EVAL';

-TOPNRAVG
-CLOSE PNRAVG
-RUN


-********************************************************************************
-* Base Refundable Average Ticket Price
-********************************************************************************
DEFINE FILE AP1
FLAG/A10 = 'Avg $ YTD';
END
-RUN
TABLE FILE AP1
SUM 
COMPUTE BRTP/D8 = IF ((REF_NT LT 1) AND (REF_NT GT (-1))) THEN 0 ELSE
                      (REF_FP/REF_NT);     
BY FLAG
WHERE ROLL EQ 'Base Company'
WHERE CURRENT EQ 'Y'
ON TABLE HOLD AS AP2
END
-RUN

TABLE FILE AP2
PRINT BRTP
BY FLAG
ON TABLE SAVE AS BRAVG
END
-RUN

-READ BRAVG NOCLOSE &FLAG.10. &BRTP.8. 

EX FMTNUMBER VALUE=&BRTP,DOLLAR=Y
-RUN
-SET &BRTP = '&&RETVAL.EVAL';

-CLOSE BRAVG
-RUN

-********************************************************************************
-* Peer Refundable Average Ticket Price
-********************************************************************************
DEFINE FILE AP1
FLAG/A10 = 'Avg $ YTD';
END
-RUN
TABLE FILE AP1
SUM 
COMPUTE PRTP/D8 = IF ((REF_NT LT 1) AND (REF_NT GT (-1))) THEN 0 ELSE
                      (REF_FP/REF_NT);     
BY FLAG
WHERE ROLL EQ 'Peer Group'
WHERE CURRENT EQ 'Y'
ON TABLE HOLD AS AP2
END
-RUN

TABLE FILE AP2
PRINT PRTP
BY FLAG
ON TABLE SAVE AS PRAVG
END
-RUN

-READ PRAVG NOCLOSE &FLAG.10. &PRTP.8. 

EX FMTNUMBER VALUE=&PRTP,DOLLAR=Y
-RUN
-SET &PRTP = '&&RETVAL.EVAL';

-CLOSE PRAVG
-RUN

-SET &G_DADV='N';
-IF &&SKIPGRAPH EQ 'Y' THEN GOTO AROUNDG2;
-********************************************************************************
-*Average Advance Purchase Days Bar Graph
-*******************************************************************************
DEFINE FILE AP1
BREC_CNT/D12 = IF ROLL NE 'Peer Group' THEN REC_CNT ELSE 0;
BTTLDAYS/D12 = IF ROLL NE 'Peer Group' THEN TTLDAYS ELSE 0;
PREC_CNT/D12 = IF ROLL EQ 'Peer Group' THEN REC_CNT ELSE 0;
PTTLDAYS/D12 = IF ROLL EQ 'Peer Group' THEN TTLDAYS ELSE 0;
END
GRAPH FILE AP1
SUM 
COMPUTE BAVD/D4 = IF ((BREC_CNT LT 1) AND (BREC_CNT GT (-1))) THEN 0 ELSE
                     (BTTLDAYS/BREC_CNT); AS '&&SHORTNM.EVAL'
COMPUTE PAVD/D4 = IF ((PREC_CNT LT 1) AND (PREC_CNT GT (-1))) THEN 0 ELSE
                     (PTTLDAYS/PREC_CNT); AS 'Peer Group'
ACROSS TRAN AS ' '
ON GRAPH SET LOOKGRAPH VBAR
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D OFF
ON GRAPH SET VZERO ON
ON GRAPH SET GRID OFF
ON GRAPH SET GRAPHSTYLE *
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(1, new Color, 145 207 255));
setMarkerDisplay(true);
setUseSeriesShapes(true);
setConnectLineMarkers(true);
setSeriesType(0,2);
setSeriesType(1,2);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setY2MajorGridDisplay(false);
setY2MinorGridDisplay(false);
setO1LabelRotate(0);
setDataTextDisplay(false);
setFontSizeAbsolute(getDataText(),true);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(2);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(1);
setLegendTextAutofix(true);
setLegendMarkersPerRow(2);
setTitleString("Average Advance Purchase Days");
setY1LabelDisplay(true);
setY1LabelFormat(###,###);
setY1AxisSide(0);
setFontSizeAbsolute(getTitle(),false); 
setAutofit(getTitle(),true);
setTextJustHoriz(getTitle(),1);
setFontStyle(getTitle(),1);
setFontSize(getTitle(),32);
setFontSizeAbsolute(getLegendText(),true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getO1Title(),true);
-* setPlace(true);
ENDSTYLE
ON GRAPH HOLD AS TADV FORMAT SVG
END
-RUN
-SET &G_DADV=IF &LINES GT 0 THEN 'Y' ELSE 'N';
-AROUNDG2

-********************************************************************************
-*Advance Purchase YTD Graph
-*******************************************************************************
DEFINE FILE HOLDEX1
FLAG/A1 = 'A';
END
-RUN

TABLE FILE HOLDEX1
SUM NET_TKT_CNT AS 'NET_TKT_CNT1'
BY FLAG
WHERE CURRENT EQ 'Y'
ON TABLE HOLD AS APG1
END
-RUN

DEFINE FILE HOLDEX1
FLAG/A1 = 'A';
END
-RUN

TABLE FILE HOLDEX1
SUM NET_TKT_CNT
BY FLAG
BY ADV1
WHERE CURRENT EQ 'Y'
ON TABLE HOLD AS APG2
END
-RUN

MATCH FILE APG2
PRINT ADV1
      NET_TKT_CNT
BY FLAG
ON TABLE HOLD
RUN
FILE APG1
SUM NET_TKT_CNT1 
BY FLAG
AFTER MATCH HOLD AS APG3 OLD-OR-NEW
END
-RUN

TABLE FILE APG3
SUM 
COMPUTE ADVP/D4 = IF ((NET_TKT_CNT1 LT 1) AND (NET_TKT_CNT1 GT (-1))) THEN 0 ELSE
                      (NET_TKT_CNT/NET_TKT_CNT1)*100;   
BY ADV1
ON TABLE HOLD AS APG4
END
-RUN

-SET &G_DADV1= 'N';
-IF &&SKIPGRAPH EQ 'Y' THEN GOTO AROUNDG;

GRAPH FILE APG4
SUM ADVP AS ' '    
ACROSS ADV1 
ON GRAPH SET GRAPHEDIT OFF
ON GRAPH SET GRAPHSTYLE *
setGraphType(55);
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(1, new Color, 145 207 255));
setSeriesFillColor(2, new Color, 125 0 0));
setConnectLineMarkers(true);
setO1LabelDisplay(true);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1LabelDisplay(true);
setY1AxisSide(0);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setPieFeelerTextDisplay(1);
setPieFeelerTextFormat(2);
setPieLabelDisplay(3);
setPieDepth(90);
setFontSizeAbsolute(getPieLabelDisplay(),(true);
setAutofit(getPieLabelDisplay(),true);
setLegendDisplay(false);
setPieSliceDetach(getSeries(0), 100);
setPieSliceDetach(getSeries(1), 100);
setSubtitleString("Advance Purchase % YTD");
setFontSizeAbsolute(getSubtitle(),false); 
setAutofit(getSubtitle(),true);
setTextJustHoriz(getSubtitle(),1);
setFontStyle(getSubtitle(),1);
setFontSize(getSubtitle(),10);
setFontSize(getTitle(),32);
-* setPlace(true);
ENDSTYLE
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D OFF
ON GRAPH SET GRID ON
ON GRAPH HOLD AS TADV1 FORMAT SVG
END
-RUN

-SET &G_DADV1=IF &LINES GT 0 THEN 'Y' ELSE 'N';

-AROUNDG

-* Comments

-SET &PCT = ' ';
TABLE FILE BRPTFLDS
PRINT PERCENT PERCENT 
WHERE INST_KEY EQ '&&IKEY.EVAL'
WHERE RPTID EQ 1
ON TABLE SAVE
END
-RUN

-READ SAVE NOCLOSE &PCT.3. 
-CLOSE SAVE
-RUN


-* Moving % from 0-6 to 7-13 Comment

TABLE FILE AP1
SUM ADV_FPA ADV_FPB ADV_FPC ADV_NTA ADV_NTB ADV_NTC YEAR 
BY YEAR
WHERE ROLL EQ 'Base Company'
ON TABLE HOLD AS COMP1
END
-RUN

TABLE FILE COMP1
SUM LST.ADV_FPA LST.ADV_FPB LST.ADV_FPC LST.ADV_NTA LST.ADV_NTB LST.ADV_NTC LST.YEAR AS 'YR'
ON TABLE HOLD AS COMP2
END
-RUN

TABLE FILE COMP2
SUM ADV_NTA ADV_NTB 
COMPUTE AVGTA/P12 = IF ((ADV_NTA LT 1) AND (ADV_NTA GT (-1))) THEN 0 ELSE
                        (ADV_FPA/ADV_NTA);   
COMPUTE AVGTB/P12 = IF ((ADV_NTB LT 1) AND (ADV_NTB GT (-1))) THEN 0 ELSE
                      (ADV_FPB/ADV_NTB);  
COMPUTE AVGTC/P12 = IF ((ADV_NTC LT 1) AND (ADV_NTC GT (-1))) THEN 0 ELSE
                        (ADV_FPC/ADV_NTC);    
                        
BY YR
ON TABLE HOLD AS COMP2
END
-RUN

-SET &MOVEA = '$0';
-SET &MOVEB = '$0';
-SET &FLAG1 = ' ';
-SET &FLAG2 = ' ';

TABLE FILE COMP2
SUM AVGTA AVGTB AVGTC
-*COMPUTE MOVEA/D12 = (AVGTA - AVGTB) * &PCT;
-*COMPUTE MOVEB/D12 = (AVGTB - AVGTC) * &PCT;

COMPUTE MOVEA/P12 = (AVGTA - AVGTB) * &PCT/100 * ADV_NTA;
COMPUTE MOVEB/P12 = (AVGTB - AVGTC) * &PCT/100 * ADV_NTB;

COMPUTE FLAG1/A1 = IF MOVEA LE 0 THEN 'Y' ELSE 'N';
COMPUTE FLAG2/A1 = IF MOVEB LE 0 THEN 'Y' ELSE 'N';
ON TABLE HOLD AS COMMENT1
END
-RUN

TABLE FILE COMMENT1
PRINT MOVEA MOVEB FLAG1 FLAG2
ON TABLE SAVE 
END
-RUN

-READ SAVE NOCLOSE &MOVEA.12. &MOVEB.12. &FLAG1.1. &FLAG2.1. 

EX FMTNUMBER VALUE=&MOVEA,DOLLAR=Y,ALIGNED='N'
-RUN
-SET &MOVEA = '&&RETVAL.EVAL';

EX FMTNUMBER VALUE=&MOVEB,DOLLAR=Y,ALIGNED='N'
-RUN
-SET &MOVEB = '&&RETVAL.EVAL';

-CLOSE SAVE
-RUN

-SET &CLINEY1 =  IF '&FLAG1.EVAL' EQ 'Y' THEN ' ' ELSE 'Moving &PCT.EVAL% from 0-6 days to 7-13 days in advance would save &MOVEA.EVAL'|' YTD';
-SET &CLINEY2 =  IF '&FLAG2.EVAL' EQ 'Y' THEN ' ' ELSE 'Moving &PCT.EVAL% from 7-13 days to 14+ days in advance would save &MOVEB.EVAL'|' YTD';

-****************************************************************
-* Code Added to for prior 4 quarter change
-****************************************************************
-SET &BAPA1A = IF &TD1 EQ ' ' THEN ' ' ELSE &BAPA1;
-SET &BAPA2A = IF &TD2 EQ ' ' THEN ' ' ELSE &BAPA2;
-SET &BAPA3A = IF &TD3 EQ ' ' THEN ' ' ELSE &BAPA3;
-SET &BAPA4A = IF &TD4 EQ ' ' THEN ' ' ELSE &BAPA4;
-SET &BAPA5A = IF &TD5 EQ ' ' THEN ' ' ELSE &BAPA5;
-SET &BAPA6A = IF &TD6 EQ ' ' THEN ' ' ELSE &BAPA6;
-SET &BAPA7A = IF &TD7 EQ ' ' THEN ' ' ELSE &BAPA7;
-SET &BAPA8A = IF &TD8 EQ ' ' THEN ' ' ELSE &BAPA8;

-SET &BAPB1A = IF &TD1 EQ ' ' THEN ' ' ELSE &BAPB1;
-SET &BAPB2A = IF &TD2 EQ ' ' THEN ' ' ELSE &BAPB2;
-SET &BAPB3A = IF &TD3 EQ ' ' THEN ' ' ELSE &BAPB3;
-SET &BAPB4A = IF &TD4 EQ ' ' THEN ' ' ELSE &BAPB4;
-SET &BAPB5A = IF &TD5 EQ ' ' THEN ' ' ELSE &BAPB5;
-SET &BAPB6A = IF &TD6 EQ ' ' THEN ' ' ELSE &BAPB6;
-SET &BAPB7A = IF &TD7 EQ ' ' THEN ' ' ELSE &BAPB7;
-SET &BAPB8A = IF &TD8 EQ ' ' THEN ' ' ELSE &BAPB8;

-SET &BAPC1A = IF &TD1 EQ ' ' THEN ' ' ELSE &BAPC1;
-SET &BAPC2A = IF &TD2 EQ ' ' THEN ' ' ELSE &BAPC2;
-SET &BAPC3A = IF &TD3 EQ ' ' THEN ' ' ELSE &BAPC3;
-SET &BAPC4A = IF &TD4 EQ ' ' THEN ' ' ELSE &BAPC4;
-SET &BAPC5A = IF &TD5 EQ ' ' THEN ' ' ELSE &BAPC5;
-SET &BAPC6A = IF &TD6 EQ ' ' THEN ' ' ELSE &BAPC6;
-SET &BAPC7A = IF &TD7 EQ ' ' THEN ' ' ELSE &BAPC7;
-SET &BAPC8A = IF &TD8 EQ ' ' THEN ' ' ELSE &BAPC8;

-SET &ATA1A = IF &BTD1 EQ ' ' THEN ' ' ELSE &ATA1;
-SET &ATA2A = IF &BTD2 EQ ' ' THEN ' ' ELSE &ATA2;
-SET &ATA3A = IF &BTD3 EQ ' ' THEN ' ' ELSE &ATA3;
-SET &ATA4A = IF &BTD4 EQ ' ' THEN ' ' ELSE &ATA4;
-SET &ATA5A = IF &BTD5 EQ ' ' THEN ' ' ELSE &ATA5;
-SET &ATA6A = IF &BTD6 EQ ' ' THEN ' ' ELSE &ATA6;
-SET &ATA7A = IF &BTD7 EQ ' ' THEN ' ' ELSE &ATA7;
-SET &ATA8A = IF &BTD8 EQ ' ' THEN ' ' ELSE &ATA8;

-SET &ATB1A = IF &BTD1 EQ ' ' THEN ' ' ELSE &ATB1;
-SET &ATB2A = IF &BTD2 EQ ' ' THEN ' ' ELSE &ATB2;
-SET &ATB3A = IF &BTD3 EQ ' ' THEN ' ' ELSE &ATB3;
-SET &ATB4A = IF &BTD4 EQ ' ' THEN ' ' ELSE &ATB4;
-SET &ATB5A = IF &BTD5 EQ ' ' THEN ' ' ELSE &ATB5;
-SET &ATB6A = IF &BTD6 EQ ' ' THEN ' ' ELSE &ATB6;
-SET &ATB7A = IF &BTD7 EQ ' ' THEN ' ' ELSE &ATB7;
-SET &ATB8A = IF &BTD8 EQ ' ' THEN ' ' ELSE &ATB8;

-SET &ATC1A = IF &BTD1 EQ ' ' THEN ' ' ELSE &ATC1;
-SET &ATC2A = IF &BTD2 EQ ' ' THEN ' ' ELSE &ATC2;
-SET &ATC3A = IF &BTD3 EQ ' ' THEN ' ' ELSE &ATC3;
-SET &ATC4A = IF &BTD4 EQ ' ' THEN ' ' ELSE &ATC4;
-SET &ATC5A = IF &BTD5 EQ ' ' THEN ' ' ELSE &ATC5;
-SET &ATC6A = IF &BTD6 EQ ' ' THEN ' ' ELSE &ATC6;
-SET &ATC7A = IF &BTD7 EQ ' ' THEN ' ' ELSE &ATC7;
-SET &ATC8A = IF &BTD8 EQ ' ' THEN ' ' ELSE &ATC8;

-SET &AAB1A = IF &TD1 EQ ' ' THEN ' ' ELSE &AAB1;
-SET &AAB2A = IF &TD2 EQ ' ' THEN ' ' ELSE &AAB2;
-SET &AAB3A = IF &TD3 EQ ' ' THEN ' ' ELSE &AAB3;
-SET &AAB4A = IF &TD4 EQ ' ' THEN ' ' ELSE &AAB4;
-SET &AAB5A = IF &TD5 EQ ' ' THEN ' ' ELSE &AAB5;
-SET &AAB6A = IF &TD6 EQ ' ' THEN ' ' ELSE &AAB6;
-SET &AAB7A = IF &TD7 EQ ' ' THEN ' ' ELSE &AAB7;
-SET &AAB8A = IF &TD8 EQ ' ' THEN ' ' ELSE &AAB8;

-SET &AAP1A = IF &TD1 EQ ' ' THEN ' ' ELSE &AAP1;
-SET &AAP2A = IF &TD2 EQ ' ' THEN ' ' ELSE &AAP2;
-SET &AAP3A = IF &TD3 EQ ' ' THEN ' ' ELSE &AAP3;
-SET &AAP4A = IF &TD4 EQ ' ' THEN ' ' ELSE &AAP4;
-SET &AAP5A = IF &TD5 EQ ' ' THEN ' ' ELSE &AAP5;
-SET &AAP6A = IF &TD6 EQ ' ' THEN ' ' ELSE &AAP6;
-SET &AAP7A = IF &TD7 EQ ' ' THEN ' ' ELSE &AAP7;
-SET &AAP8A = IF &TD8 EQ ' ' THEN ' ' ELSE &AAP8;

-SET &NRB1A = IF &TD1 EQ ' ' THEN ' ' ELSE &NRB1;
-SET &NRB2A = IF &TD2 EQ ' ' THEN ' ' ELSE &NRB2;
-SET &NRB3A = IF &TD3 EQ ' ' THEN ' ' ELSE &NRB3;
-SET &NRB4A = IF &TD4 EQ ' ' THEN ' ' ELSE &NRB4;
-SET &NRB5A = IF &TD5 EQ ' ' THEN ' ' ELSE &NRB5;
-SET &NRB6A = IF &TD6 EQ ' ' THEN ' ' ELSE &NRB6;
-SET &NRB7A = IF &TD7 EQ ' ' THEN ' ' ELSE &NRB7;
-SET &NRB8A = IF &TD8 EQ ' ' THEN ' ' ELSE &NRB8;

-SET &NRP1A = IF &TD1 EQ ' ' THEN ' ' ELSE &NRP1;
-SET &NRP2A = IF &TD2 EQ ' ' THEN ' ' ELSE &NRP2;
-SET &NRP3A = IF &TD3 EQ ' ' THEN ' ' ELSE &NRP3;
-SET &NRP4A = IF &TD4 EQ ' ' THEN ' ' ELSE &NRP4;
-SET &NRP5A = IF &TD5 EQ ' ' THEN ' ' ELSE &NRP5;
-SET &NRP6A = IF &TD6 EQ ' ' THEN ' ' ELSE &NRP6;
-SET &NRP7A = IF &TD7 EQ ' ' THEN ' ' ELSE &NRP7;
-SET &NRP8A = IF &TD8 EQ ' ' THEN ' ' ELSE &NRP8;


TABLE FILE BRPTINST
BY INST_KEY NOPRINT
ON TABLE SET PAGE-NUM OFF
&&OUTLINE1
&&OUTLINE2
FOOTING
"Advance Purchase by Days <&POS13 Peer Group"
"<&POS1A &BTD1 <&POS2A &BTD2 <&POS3A &BTD3 <&POS4A &BTD4 <&POS5A &BTD5 <&POS6A &BTD6 <&POS7A &BTD7 <&POS8A &BTD8 <&POS9A &BTDY1 <&POS10A &BTDY2 <&POS11A &TDY1 <&POS12A &TDY2"  
"0 - 6   <&POS1 &BAPA1A <&POS2 &BAPA2A <&POS3 &BAPA3A <&POS4 &BAPA4A <&POS5 &BAPA5A <&POS6 &BAPA6A <&POS7 &BAPA7A <&POS8 &BAPA8A <&POS9 &BAPAY1 <&POS10 &BAPAY2 <&POS11 &PAPAY1 <&POS12 &PAPAY2"
"7 - 13  <&POS1 &BAPB1A <&POS2 &BAPB2A <&POS3 &BAPB3A <&POS4 &BAPB4A <&POS5 &BAPB5A <&POS6 &BAPB6A <&POS7 &BAPB7A <&POS8 &BAPB8A <&POS9 &BAPBY1 <&POS10 &BAPBY2 <&POS11 &PAPBY1 <&POS12 &PAPBY2"
"14+     <&POS1 &BAPC1A <&POS2 &BAPC2A <&POS3 &BAPC3A <&POS4 &BAPC4A <&POS5 &BAPC5A <&POS6 &BAPC6A <&POS7 &BAPC7A <&POS8 &BAPC8A <&POS9 &BAPCY1 <&POS10 &BAPCY2 <&POS11 &PAPCY1 <&POS12 &PAPCY2"
-*******************************************************************************************************************************************************************************
"</2"
"Average Ticket Price by Days"
"<&POS1A &BTD1 <&POS2A &BTD2 <&POS3A &BTD3 <&POS4A &BTD4 <&POS5A &BTD5 <&POS6A &BTD6 <&POS7A &BTD7 <&POS8A &BTD8 <&POS9A  &BTDY1 <&POS10A  &BTDY2"  
"0 - 6   <&POS1 &ATA1A <&POS2 &ATA2A <&POS3 &ATA3A <&POS4 &ATA4A <&POS5 &ATA5A <&POS6 &ATA6A <&POS7 &ATA7A <&POS8 &ATA8A <&POS9 &ATAY1 <&POS10 &ATAY2"
"7 - 13  <&POS1 &ATB1A <&POS2 &ATB2A <&POS3 &ATB3A <&POS4 &ATB4A <&POS5 &ATB5A <&POS6 &ATB6A <&POS7 &ATB7A <&POS8 &ATB8A <&POS9 &ATBY1 <&POS10 &ATBY2"
"14+     <&POS1 &ATC1A <&POS2 &ATC2A <&POS3 &ATC3A <&POS4 &ATC4A <&POS5 &ATC5A <&POS6 &ATC6A <&POS7 &ATC7A <&POS8 &ATC8A <&POS9 &ATCY1 <&POS10 &ATCY2"
-******************************************************************************************************************************************************************
"</2"
"Average Advance Purchase Days"
"<&POS1A &TD1 <&POS2A &TD2 <&POS3A &TD3 <&POS4A &TD4 <&POS5A &TD5 <&POS6A &TD6 <&POS7A &TD7 <&POS8A &TD8"  
"&&SHORTNM  <&POS1 &AAB1A <&POS2 &AAB2A <&POS3 &AAB3A <&POS4 &AAB4A <&POS5 &AAB5A <&POS6 &AAB6A <&POS7 &AAB7A <&POS8 &AAB8A"
"Peer Group <&POS1 &AAP1A <&POS2 &AAP2A <&POS3 &AAP3A <&POS4 &AAP4A <&POS5 &AAP5A <&POS6 &AAP6A <&POS7 &AAP7A <&POS8 &AAP8A"
-*******************************************************************************************************************
"</2"
"Nonrefundable Tickets <&POS11   Nonref <&POS12    Refundable"
"<&POS1A &TD1 <&POS2A &TD2 <&POS3A &TD3 <&POS4A &TD4 <&POS5A &TD5 <&POS6A &TD6 <&POS7A &TD7 <&POS8A &TD8 <&POS9A &TDY1 <&POS10A &TDY2 <&POS11A &FLAG <&POS12A &FLAG"  
"&&SHORTNM  <&POS1 &NRB1A <&POS2 &NRB2A <&POS3 &NRB3A <&POS4 &NRB4A <&POS5 &NRB5A <&POS6 &NRB6A <&POS7 &NRB7A <&POS8 &NRB8A <&POS9 &NRBY1 <&POS10 &NRBY2 <&POS11 &BNRTP <&POS12 &BRTP"
"Peer Group <&POS1 &NRP1A <&POS2 &NRP2A <&POS3 &NRP3A <&POS4 &NRP4A <&POS5 &NRP5A <&POS6 &NRP6A <&POS7 &NRP7A <&POS8 &NRP8A <&POS9 &NRPY1 <&POS10 &NRPY2 <&POS11 &PNRTP <&POS12 &PRTP"
"</2"
"&CLINEY1"
"</2"
"&CLINEY2"
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.150000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=9, BACKCOLOR=NONE, STYLE=NORMAL, $

TYPE=FOOTING,FONT=COURIER NEW,$
TYPE=FOOTING, LINE=1, SIZE=9, OBJECT=TEXT, FONT=ARIAL, STYLE=BOLD, $
TYPE=FOOTING, LINE=2, SIZE=9, OBJECT=TEXT, FONT=ARIAL, STYLE=BOLD, $
TYPE=FOOTING, LINE=9, SIZE=9, OBJECT=TEXT, FONT=ARIAL, STYLE=BOLD, $
TYPE=FOOTING, LINE=10, SIZE=9, OBJECT=TEXT, FONT=ARIAL, STYLE=BOLD, $
TYPE=FOOTING, LINE=17, SIZE=9, OBJECT=TEXT, FONT=ARIAL, STYLE=BOLD, $
TYPE=FOOTING, LINE=18, SIZE=9, OBJECT=TEXT, FONT=ARIAL, STYLE=BOLD, $
TYPE=FOOTING, LINE=24, SIZE=9, OBJECT=TEXT, FONT=ARIAL, STYLE=BOLD, $
TYPE=FOOTING, LINE=25, SIZE=9, OBJECT=TEXT, FONT=ARIAL, STYLE=BOLD, $
TYPE=FOOTING, LINE=31, SIZE=15, OBJECT=TEXT, FONT=TIMES NEW ROMAN, STYLE=BOLD, $
TYPE=FOOTING, LINE=32, SIZE=6, OBJECT=TEXT, FONT=ARIAL, STYLE=BOLD, $
TYPE=FOOTING, LINE=35, SIZE=15, OBJECT=TEXT, FONT=TIMES NEW ROMAN, STYLE=BOLD, $
TYPE=REPORT, IMAGE=AdvPurT.GIF,POSITION=(0.1 0.1), SIZE=(10.75 .75), $
TYPE=REPORT, IMAGE=BOX.GIF, POSITION=(0.10 0.95), SIZE=(10.73 .95), $
TYPE=REPORT, IMAGE=BOX.GIF, POSITION=(0.10 1.96), SIZE=(9.75 .92), $
TYPE=REPORT, IMAGE=BOX.GIF, POSITION=(0.10 2.95), SIZE=(8.50 0.75), $
TYPE=REPORT, IMAGE=BOX.GIF, POSITION=(0.10 3.85), SIZE=(10.73 0.75), $
-IF &&SKIPGRAPH EQ 'Y' OR &G_DADV EQ 'N' GOTO SKIP_DGAT1;
TYPE=REPORT,IMAGE=TADV.SVG,POSITION=(5.5  6.0), SIZE=(5.0 2.2), $
-SKIP_DGAT1
-IF &&SKIPGRAPH EQ 'Y' OR &G_DADV1 EQ 'N' GOTO SKIP_DGAT2;
TYPE=REPORT,IMAGE=TADV1.SVG, POSITION=(0.25  6.0), SIZE=(5.0 2.2), $
-SKIP_DGAT2
ENDSTYLE
END
-RUN
