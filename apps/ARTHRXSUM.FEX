-*11/13/17-S-39877-JEM- Creation of new program for setfile ARTCNTRY


SET ASNAMES=ON

-SET &&RPTSUF = 'SMY';
-INCLUDE FDEFRPTS


-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HNKA=&HLDPATH || 'HOLDA.FOC';
-SET &HNKB=&HLDPATH || 'HOLDH.FOC';
-SET &HNKC=&HLDPATH || 'HOLDC.FOC';
-RUN


-SET &FILENAME = 'HOLDA'; 
-RUN

-DOS STATE &HNKA
-SET &HOLDFILEA = IF &RETCODE.EVAL EQ 0 THEN &HNKA | ' AS ' | &FILENAME ELSE ' ';

-DOS STATE &HNKB
-SET &HOLDFILEH = IF &RETCODE.EVAL EQ 0 THEN &HNKB | ' AS ' | &FILENAME ELSE ' ';

-DOS STATE &HNKC
-SET &HOLDFILEC = IF &RETCODE.EVAL EQ 0 THEN &HNKC | ' AS ' | &FILENAME ELSE ' ';

USE ADD 
&HOLDFILEA
&HOLDFILEH
&HOLDFILEC
END



TABLE FILE HOLDA
SUM AIR_DSS
    FARE_PAID
    HRS_AMT
    NET_TKT_CNT
    NEW_SEG_COUNT
    NEW_SEG_MILES
    NEW_TOTAL_AMT
    NNROOMS
    PNR_CNT
    RENTAL_DAYS
BY LEVEL_DESC
ON TABLE HOLD AS HOLDE 
END
-RUN

-**************************************************************************
DEFINE FILE HOLDE
NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
-* COUNTRY_NAME1/A25 = IF COUNTRY_NAME GT ' ' THEN COUNTRY_NAME ELSE 'UNKNOWN COUNTRY';
END 


TABLE FILE HOLDE
-INCLUDE HDREXLS

SUM PNR_CNT AS '# PNRS' 
FARE_PAID AS 'Air Spend,(USD)'
AIR_DSS AS 'Airfare,Research,Savings,(USD)'
NEW_SEG_COUNT AS '# Flights'
NEW_TOTAL_AMT AS 'Hotel,Spend,(USD)'
NNROOMS AS '# Hotel,Nights'
HRS_AMT AS 'Hotel,Research,Savings,(USD)'
RENTAL_DAYS AS 'Car,Rental,Days'
NEW_SEG_MILES AS 'Miles Flown'

BY LEVEL_DESC AS ''

ON TABLE SUMMARIZE AS 'Total WW'

-*
-**********************************************************************
-* Report specific footer(s)
-**********************************************************************
-*
-INCLUDE FOOTERDT
-*
-*ON TABLE SET STYLE &&DTSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**************************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *

-INCLUDE SMEXL
TYPE=TITLE, JUSTIFY=CENTER, $
TYPE=DATA, JUSTIFY=CENTER, $
TYPE=GRANDTOTAL, 
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     JUSTIFY=CENTER,
     BACKCOLOR=RGB(197 217 241), $
     

ENDSTYLE
-*
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN

-XXIT