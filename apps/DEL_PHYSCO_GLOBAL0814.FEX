-INCLUDE SETECHO

 
-SET ASNAMES = ON

JOIN AIR_KEY IN S_PHYSCO TO AIR_KEY IN A_PHYSCO AS J1
END
TABLE FILE S_PHYSCO
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AIR_KEY CONTAINS SE963000 OR SE963001 OR SE963002 OR SE963003 OR SE963004 OR SE963005 OR SE963006 OR SE963007 OR SE963008 OR SE963009 OR SE963010 OR SE963011 OR SE963012 OR SE963013 OR SE963014 OR SE963015 OR SE963016 OR SE963017 OR SE963018 OR SE963019 OR SE963020 OR SE963021 OR SE963022 OR SE963023 OR SE963024 OR SE963025 OR SE963026 OR SE963027 OR SE963028 OR SE963029 OR SE963030
WHERE TRN_DATE GE '2014/08/01' 
WHERE TRN_DATE LE '2014/08/31'
ON TABLE HOLD
END
-RUN


TABLE FILE HOLD
SUM AIR_KEY
BY AIR_KEY NOPRINT
ON TABLE HOLD AS AHOLD
END
-RUN

MODIFY FILE A_PHYSCO
LOG NOMATCH MSG OFF
FIXFORM FROM AHOLD
MATCH AIR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON AHOLD
END
-RUN

MODIFY FILE T_PHYSCO
LOG NOMATCH MSG OFF
FIXFORM FROM AHOLD
MATCH AIR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON AHOLD
END
-RUN

MODIFY FILE UAPHYSCO
LOG NOMATCH MSG OFF
FIXFORM FROM AHOLD
MATCH AIR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON AHOLD
END
-RUN

 

MODIFY FILE S_PHYSCO
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN AIR_KEY IN D_PHYSCO TO AIR_KEY IN A_PHYSCO AS J1
END

TABLE FILE D_PHYSCO
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AIR_KEY CONTAINS SE963000 OR SE963001 OR SE963002 OR SE963003 OR SE963004 OR SE963005 OR SE963006 OR SE963007 OR SE963008 OR SE963009 OR SE963010 OR SE963011 OR SE963012 OR SE963013 OR SE963014 OR SE963015 OR SE963016 OR SE963017 OR SE963018 OR SE963019 OR SE963020 OR SE963021 OR SE963022 OR SE963023 OR SE963024 OR SE963025 OR SE963026 OR SE963027 OR SE963028 OR SE963029 OR SE963030  
WHERE TRN_DATE GE '2014/08/01' 
WHERE TRN_DATE LE '2014/08/31'
ON TABLE HOLD AS DHOLD
END
-RUN

MODIFY FILE D_PHYSCO
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN

JOIN AIR_KEY IN M_PHYSCO TO AIR_KEY IN A_PHYSCO AS J1
END

TABLE FILE M_PHYSCO
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF AIR_KEY CONTAINS SE963000 OR SE963001 OR SE963002 OR SE963003 OR SE963004 OR SE963005 OR SE963006 OR SE963007 OR SE963008 OR SE963009 OR SE963010 OR SE963011 OR SE963012 OR SE963013 OR SE963014 OR SE963015 OR SE963016 OR SE963017 OR SE963018 OR SE963019 OR SE963020 OR SE963021 OR SE963022 OR SE963023 OR SE963024 OR SE963025 OR SE963026 OR SE963027 OR SE963028 OR SE963029 OR SE963030  
WHERE TRN_DATE GE '2014/08/01' 
WHERE TRN_DATE LE '2014/08/31'
ON TABLE HOLD AS MHOLD
END
-RUN

MODIFY FILE M_PHYSCO
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

TABLE FILE C_PHYSCO
PRINT CAR_KEY
BY CAR_KEY NOPRINT
IF CAR_KEY CONTAINS SE963000 OR SE963001 OR SE963002 OR SE963003 OR SE963004 OR SE963005 OR SE963006 OR SE963007 OR SE963008 OR SE963009 OR SE963010 OR SE963011 OR SE963012 OR SE963013 OR SE963014 OR SE963015 OR SE963016 OR SE963017 OR SE963018 OR SE963019 OR SE963020 OR SE963021 OR SE963022 OR SE963023 OR SE963024 OR SE963025 OR SE963026 OR SE963027 OR SE963028 OR SE963029 OR SE963030  
WHERE INVOICE_DATE GE '2014/08/01' 
WHERE INVOICE_DATE LE '2014/08/31'
ON TABLE HOLD AS CHOLD
END
-RUN

MODIFY FILE C_PHYSCO
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN

MODIFY FILE UCPHYSCO
LOG NOMATCH MSG OFF
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN


TABLE FILE H_PHYSCO
PRINT HTL_KEY
BY HTL_KEY NOPRINT
IF HTL_KEY CONTAINS SE963000 OR SE963001 OR SE963002 OR SE963003 OR SE963004 OR SE963005 OR SE963006 OR SE963007 OR SE963008 OR SE963009 OR SE963010 OR SE963011 OR SE963012 OR SE963013 OR SE963014 OR SE963015 OR SE963016 OR SE963017 OR SE963018 OR SE963019 OR SE963020 OR SE963021 OR SE963022 OR SE963023 OR SE963024 OR SE963025 OR SE963026 OR SE963027 OR SE963028 OR SE963029 OR SE963030  
WHERE INVOICE_DATE GE '2014/08/01' 
WHERE INVOICE_DATE LE '2014/08/31'
ON TABLE HOLD AS HHOLD
END
-RUN

MODIFY FILE H_PHYSCO
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN

MODIFY FILE UHPHYSCO
 LOG NOMATCH MSG OFF
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN

TABLE FILE L_PHYSCO
PRINT CAR_KEY
BY CAR_KEY NOPRINT
IF CAR_KEY CONTAINS SE963000 OR SE963001 OR SE963002 OR SE963003 OR SE963004 OR SE963005 OR SE963006 OR SE963007 OR SE963008 OR SE963009 OR SE963010 OR SE963011 OR SE963012 OR SE963013 OR SE963014 OR SE963015 OR SE963016 OR SE963017 OR SE963018 OR SE963019 OR SE963020 OR SE963021 OR SE963022 OR SE963023 OR SE963024 OR SE963025 OR SE963026 OR SE963027 OR SE963028 OR SE963029 OR SE963030  
WHERE INVOICE_DATE GE '2014/08/01' 
WHERE INVOICE_DATE LE '2014/08/31'
ON TABLE HOLD AS LHOLD
END
-RUN

MODIFY FILE L_PHYSCO
FIXFORM FROM LHOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON LHOLD
END
-RUN

MODIFY FILE ULPHYSCO
 LOG NOMATCH MSG OFF
FIXFORM FROM LHOLD
MATCH CAR_KEY
ON MATCH DELETE
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN



