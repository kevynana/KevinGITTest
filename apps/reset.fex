-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-INCLUDE SETECHO
-TYPE IN RESET
-* File RESET.FEX
-*   Resets all LET, USE, JOIN, and FILEDEF assignments between report
-*     executions
-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            COMMENTED OUT CREATEMSG, SEQUENCE,
-*                                  FOCPATH, FOCEX, FOCDATA AND SORTTEMP
-*                                  SINCE THEY DO NOT APPLY IN WEBFOCUS.
-*                                  REPLACED TEMPDISK WITH TEMPDIR.
-*9/28/00      IBISTL-RJ            Removed the creation of CONTROL. This
-*                                  will be handled through the user.prf.
-*6/17/02      STEVE                Added TKT_MAIN (T_XXXX file).
-*3/18/14      DEB                  added routine for PETS
-*  02/05/2015  REJ  S-05681 Changes for Available Reports.  Adding code so that the
-*                           program will run in current Review and in Available Reports.
-*03/30/2015   DEB   S-08177 CHAANGED RETONE-R to display all in lowercase
-*  03/31/2015  REJ  S-05681 Changes made for Available Reports.
-*10/15/15 - Joy - S-12083 Added code to Correct mixed case for UNIF-R rollup code
-*10/27/15 - Joy - S-12230 Added code to correct mixed case for TPI-R rollup code
-*02/24/16 - JEM - S-15795  Corrected HDR being changed to mix case
-*12/13/16 - DLV - S-27345 - Added code to correct mixed case HBFULL-R
-*1/30/17-JEM-S-29460-Adding code for ER5 to create a variable for roll_contact_email that can be used in report headings.
-*2/03/17-REJ-S-29460-Changed the code to use the sql version of ROLLUP always.
-*02/20/17 - DLV-S-28324 - Added code to corrected mixed case CDIC-R
-*3/20/17 - JEM - S-31904 Added logic to not LCWORD Allstate's contact name
-*08/08/17 - DLV - S-37941 - Added code to correct mixed case CDK-R

-**********************************************************************
-DEFAULT &&FROMER5='';
-TYPE Before clear commands
USE CLEAR
-RUN
EX SUUSES
-RUN
FILEDEF * CLEAR
-RUN
 
-SET &&AIR_PATH = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\';
-SET &&CAR_PATH = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\';
-SET &&HTL_PATH = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\';
-SET &&LIM_PATH = '&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\';
-SET &&COM_PATH = '&&DATASRV.EVAL' || '\TNT\TTRACKER\SYSTEM\DATA\';
 
-SET &&SET_DONE = 'N';
-DEFAULT &&CHECKP = 'N';
-SET &&TT_CS='C';
 
-* Control ID is used to differentiate between Programmer, Report Spec, User
-* PGM, SPC, or USR
-SET &&USEID = '''PGM''';
-RUN
-**************END MACHINE SPECIFIC SECTION ****************
-***********************************************************
 
SET FIELDNAME = NEW
-RUN
 
-*-IF &&CHECKP EQ 'Y' GOTO SKIP_PATH;
-* Subroutine returns the TEMPDIR path
-SET &&WEB_PATH=TEMPPATH(50,'A50');
-*SET EDAPATH=+&&WEB_PATH;
-*-RUN
 
-*-SET &&CHECKP = 'Y';
-*-SKIP_PATH
 
DEFINE FILE CONTROL
DEPLOY/A1=IF WEB_RUN EQ 'Y' THEN 'W' ELSE 'L';
END
TABLE FILE CONTROL
PRINT ROLLUP_CODE USER_ID DEPLOY
ON TABLE SAVE AS PARMPASS
END
-RUN
 
-DEFAULT &&RTROLL = ' ';
 
-READ PARMPASS &&RTROLL.8 &&UNAME.20 &&DEPLOY.1
-SET &RTPOS = POSIT(&&RTROLL, 8, '-', 1, 'I1');
-SET &&RTCOMP = SUBSTR(8, &&RTROLL, 1, &RTPOS - 1, &RTPOS - 1, 'A6');
 
-SET &&RTC_INCL = 'RC' || &&RTCOMP;
-SET &&RTS_INCL = 'RS' || &&RTCOMP;
 
-IF &&TT_CS EQ 'C' THEN GOTO T_CLIENT;
-IF &&TT_CS EQ 'S' THEN GOTO T_SERVER;
 
-T_CLIENT
-DEFAULT &&NOW_CYC = '';
 
-TYPE Before FOCPATHing
-SET &&CLT_PATH = '&&DATASRV.EVAL' || 'tnt\TTRACKER\SYSTEM\DATA\';
-GOTO ALL_RESET
 
-T_SERVER
 
-DEFAULT &&NOW_CYC = '';
-SET &&TT_CS = 'S';
 
-TYPE Before FOCPATHing
-INCLUDE &&RTS_INCL
-GOTO ALL_RESET
 
-* The following are global control variables used throughout the interface
-SET &&CLT_PATH = '&&DATASRV.EVAL' || 'tnt\TTRACKER\SYSTEM\DATA\';
-GOTO ALL_RESET
 
-ALL_RESET
-SET &&RPTNAM = '                                      ';
-SET &&AUSEPASS = &&WEB_PATH || 'AUSEINCL.FTM';
-SET &&CUSEPASS = &&WEB_PATH || 'CUSEINCL.FTM';
-SET &&HUSEPASS = &&WEB_PATH || 'HUSEINCL.FTM';
-SET &&LUSEPASS = &&WEB_PATH || 'LUSEINCL.FTM';
 
TABLE FILE CONTROL
PRINT ROLLUP_CODE
ON TABLE SAVE AS PARMPASS
END
-RUN
 
-IF &RECORDS EQ 0 GOTO TRINIT;
-IF &RECORDS GT 0 GOTO TRLAST;
 
-TRINIT
-WRITE PARMPASS TRACKER1
-* -GOTO MODCNTL
 
-TRLAST
 
-* The previous Rollup has been written to PARMPASS
-*  here all relevant Rollup parameters are retrieved and set as
-*  global variables for use during the session
 
-READ PARMPASS &&ROLLUP.8
-RUN
 
-TYPE Before first Rollup query
TABLE FILE ROLLUP_SQL
ON TABLE SET PAGE-NUM OFF
PRINT ROLL_NAME AND COMP AND UPD_ENABLE AND QTR_ENABLE AND RKEY_LEN AND
ROLL_CONTACT AND ROLL_CITY AND ROLL_STATE AND ROLL_PHONE AGENCY UDIDUSED ALT_HIERARCHY
ROLL_CONTACT_EMAIL
ON TABLE NOTOTAL
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
ON TABLE SAVE AS TABLPASS
END
-RUN
 
-TYPE Before READ on Tablepass
-READ TABLPASS &&RPTNAM.25 &&COMPNY.6 &&UPDENB.1 &&QTRENAB.1 &&RKYLEN.3,
-, &&ROLLCNCT.25 &&ROLLCTY.15 &&ROLLSTA.2 &&ROLLFON.11 &AGENCY.11. &&UDIDUSED.1. &&ALTHIER.1. &&ROLLEMAIL.100.
 
-INCLUDE SETCOPYRIGHT
-RUN
 
-DEFAULT &&ROLLCTY = ' ';
-DEFAULT &&ROLLCNCT = ' ';
-DEFAULT &&ROLLSTA = ' ';
-DEFAULT &&ROLLFON = ' ';
-DEFAULT &&COMPNY = ' ';
-DEFAULT &&ROLLEMAIL = '';
 
-SET &&AgencyName = ' ';
 
-SET &&ROLLNME1 = IF '&&RPTNAM.EVAL' NE 'CCA' OR 'HDR' THEN LCWORD(25, '&&RPTNAM.EVAL', 'A25') ELSE &&RPTNAM;
-SET &&ROLLNMEB = IF '&&RPTNAM.EVAL' CONTAINS 'BINGHAM MCCUTCHEN LLP' THEN 'Bingham McCutchen LLP' ELSE &&ROLLNME1;
-SET &&ROLLNMEC = IF '&&RPTNAM.EVAL' CONTAINS 'METLIFE' THEN 'MetLife' ELSE &&ROLLNMEB;
-SET &&ROLLNMED = IF '&&RPTNAM.EVAL' CONTAINS 'T-M' THEN 'T-Mobile USA Inc' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'CFA INSTITUTE' THEN 'CFA Institute' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'JPOWER' THEN 'JPower USA Development' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'PETSMART' THEN 'PetSmart'  ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'CIT Group Inc' THEN 'CIT Group Inc.' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'DDJ CAPITAL' THEN 'DDJ Capital Management' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'PDI INC' THEN 'PDI Inc' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'PORTER MCGUFFIE' THEN 'Porter McGuffie Inc' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'retailone' THEN 'retailone' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'JACK & JACK' THEN 'Jack & Jack LLC' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'NW EVALUATION ASSOC-NWEA' THEN 'NW Evalutation Assoc-NWEA' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'SMT' THEN 'SMT' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'APOLLOMD' THEN 'ApolloMD' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'DATAGRAVITY' THEN 'DataGravity' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'UNIFIRST CORPORATION' THEN 'UniFirst Corporation' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'TPI COMPOSITES INC' THEN 'TPI Composites Inc' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'SLOANLED' THEN 'SloanLED' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'CoreCivic' THEN 'CoreCivic' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'RDG PLANNING' THEN 'RDg Planning and Design' ELSE
-                 IF '&&RPTNAM.EVAL' CONTAINS 'HB FULLER COMPANY' THEN 'HB Fuller Company' ELSE  
-                 IF '&&RPTNAM.EVAL' CONTAINS 'CDIC INC' THEN 'CDIC Inc' ELSE 
-                 IF '&&RPTNAM.EVAL' CONTAINS 'CDK GLOBAL' THEN 'CDK Global' ELSE &&ROLLNMEC;
 
 
-SET &&RSTATEB = ' ';
 
-SET &&ROLLNME = TRUNCATE(&&ROLLNMED);
-SET &&ROLLCTY1 = LCWORD(15, '&&ROLLCTY.EVAL', 'A15');
-SET &&ROLLCNCT1 = LCWORD(25, '&&ROLLCNCT.EVAL', 'A25');
-SET &&ROLLCNCTA = IF &&RPTNAM CONTAINS 'ALLSTATE' THEN &&ROLLCNCT ELSE &&ROLLCNCT1;
-SET &&ROLLCNCT = TRUNCATE(&&ROLLCNCTA);


-SET &&RSTATE = IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' THEN &&RSTATEB ELSE &&ROLLSTA;
-* -SET &&ROLLCS1 = TRUNCATE(&&ROLLCTY1) || EDIT(&&ROLLSTA,', 99');
-SET &&ROLLCS1 = TRUNCATE(&&ROLLCTY1) || EDIT(&&RSTATE,', 99');
 
-SET &&ROLLPHN = EDIT(&&ROLLFON,'9-999-999-9999');
-SET &&ROLLCS = IF &&ROLLCS1 EQ ',' THEN ' ' ELSE &&ROLLCS1;
-SET &&ROLLCS = IF &&RSTATE EQ ' ' THEN &&ROLLCTY1 ELSE &&ROLLCS1;
-SET &&ROLLPHN = IF &&ROLLPHN EQ ' -   -   -    ' THEN ' ' ELSE &&ROLLPHN;
-IF &&FROMAVRP EQ 'Y' OR &&FROMER5 EQ 'Y' GOTO VAREMAIL ELSE GOTO NOVAREMAIL;
-VAREMAIL
-SET &&ROLLEML=TRUNCATE(&&ROLLEMAIL);

 
-NOVAREMAIL;
 
-DBSETS
-SET &&AIR_DB = 'A_' || &&COMPNY || '.FOC';
-SET &&CAR_DB = 'C_' || &&COMPNY || '.FOC';
-SET &&HTL_DB = 'H_' || &&COMPNY || '.FOC';
-SET &&LIM_DB = 'L_' || &&COMPNY || '.FOC';
-SET &&SEG_DB = 'S_' || &&COMPNY || '.FOC';
-SET &&MRK_DB = 'M_' || &&COMPNY || '.FOC';
-SET &&DST_DB = 'D_' || &&COMPNY || '.FOC';
-SET &&TKT_DB = 'T_' || &&COMPNY || '.FOC';
-SET &&AH_DB = 'AL' || &&COMPNY || '.FOC';
-SET &&CH_DB = 'AL' || &&COMPNY || '.FOC';
-SET &&HH_DB = 'AL' || &&COMPNY || '.FOC';
-SET &&HIER = 'AL' || &&COMPNY || '.FOC';
-SET &&XHIER = 'AL' || &&COMPNY || '.FOC';
 
-SET &&UAUDID = 'UA' || &&COMPNY || '.FOC';
-SET &&UCUDID = 'UC' || &&COMPNY || '.FOC';
-SET &&UHUDID = 'UH' || &&COMPNY || '.FOC';
 
-SET &&USE_HIER = &&AIR_PATH || &&HIER;
-SET &&USE_XHIER = &&AIR_PATH || &&XHIER;
-SET &&LOCPATH = '&&WEBSRV.EVAL' || '\TT\ ' ||&&ROLLUP || '\ '||&&UNAME.EVAL|| '\';
-SET &&WEBPATH = '&&WEBSRV.EVAL' || '\TTWEB\ ' || &&ROLLUP || '\ '||&&UNAME.EVAL|| '\';
 
USE ADD
  &&USE_HIER AS AH_50
END
-RUN
 
-XEND
 
-DEFAULT &&SETZIP= 'N';
-DOS MKDIR &&WEBPATH

 
-TYPE Before final exit
