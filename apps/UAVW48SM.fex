-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-INCLUDE SETECHO
-* UAVW48SM
-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*3/3/14         JOY                CREATED A SUMMARY FOR THE METLIFE VTC UDID
-*5/23/14        DEB                ADDED EX5 TO NUMEROUS DEFINES 
-* 08/14/2017 RSB S-38044 Place the footer datetime stamp text in a separate file to be -INCLUDED in the stylesheets
-**********************************************************************
 

SET ASNAMES = ON
-RUN


-INCLUDE RETUDID
-RUN



-IF &&CURRENCY NE 'USD' THEN GOTO GLOBAL ELSE GOTO NEXT;



-GLOBAL;
-SET &&SUBHEAD = <NAMEC;
-SET &TAMT_CUR = 'FARE,PAID, (' | &&CURRENCY || ')';
-SET &&S_SUBJ3='GPAID_FARE/D16.2CS AS ' | '''&TAMT_CUR.EVAL''';



-NEXT

-IF &&SETF NE 'MXTRNVTC' GOTO NOUDID;
EX UDMXVTCS
-RUN
-IF &&MXVTCCHK EQ 'Y' THEN GOTO XXIT;
-GOTO CONTJOIN;


-NOUDID;
TABLE FILE &&RPT_HOLD
PRINT 
  ACCT_FLAG
  AGENT_NUM 
  AIRLINE
  BDGA_DPT
  BKD_ONLINE
  BR_CL_IDX	
  CLASS	
  CLIENT_NAME
  CURR1X
  DOC_TYPE
  DOD_TYPE
  DPT_DATE
  EMAIL_ADDR
  EMBARK	
  EX_FLAG	
  EXCHG_SALE
  GEOAREA
  GEO_FLAG
  GRAND_MSTR_CODE	
  GROUP_CODE
  GSEG_AMT/D16.2CS
  GSEG_COM/D16.2CS
  GSEG_TAX/D16.2CS
  IDFLAG
  INVOICE_NUM	
  LEVEL1	
  LEVEL2	
  LEVEL3
  LVL3
  LEVEL_DESC
  MCOS
  MTG_CODE	
  MSTR_GRP_CODE
  NAMEC
  ONLINE_TRADITIONAL
  PAID_FAREX/D16.2CS	
  PASSNGR_NAME	
  REFUSE_KEY	
  RESV_BRANCH	
  RF_FLAG
  SEG_AMT	
  SEG_COM	
  SEG_COUNT
  SEG_NBR 	
  SEG_TAX 
  TICKET_BRANCH	
  TKT_NUM
  TRAN_MYA
  TRAN_MY
  TRN_DATE	
  VAL_AIRLINE	
  VOID_DATE 	
  VOID_STATUS 
  XFST_DPT
  TKT_NUM
  SEG_COUNT
BY TKT_NUM
BY SEG_COUNT
ON TABLE HOLD AS TRANONE
END
-RUN

-CONTJOIN;
JOIN TRANONE.AGENT_NUM IN TRANONE TO AGENT.AGENT IN AGENT AS J2
-RUN



DEFINE FILE TRANONE
EMCO_TAX/D12 = IF DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E' THEN SEG_TAX 
  ELSE 0;
GEMCO_TAX/D16 = IF DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E' THEN GSEG_TAX 
  ELSE 0;	
EXCH_AMT/D12 = IF (DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E') THEN 0 ELSE IF 
  ((EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND (EMBARK NE 'DT1' OR 
  'RF1' OR 'FP3') AND (RF_FLAG EQ ' ')) OR ((SEG_COUNT GE 0) AND 
  (EXCHG_SALE NE ' ')) OR (EMBARK EQ 'EX1' OR 'EX5') THEN SEG_AMT ELSE 0;
GEXCH_AMT/D16 = IF (DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E') THEN 0 ELSE IF 
  ((EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND (EMBARK NE 'DT1' OR 
  'RF1' OR 'FP3') AND (RF_FLAG EQ ' ')) OR ((SEG_COUNT GE 0) AND 
  (EXCHG_SALE NE ' ')) OR (EMBARK EQ 'EX1' OR 'EX5') THEN GSEG_AMT ELSE 0;		
EXCH_MCO/D12 = IF DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E' THEN SEG_AMT 
  ELSE 0;
GEXCH_MCO/D16 = IF DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E' THEN GSEG_AMT 
  ELSE 0;	
EXCH_TAX/D12 = IF (DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E') THEN 0 ELSE IF 
  ((EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND (EMBARK NE 'DT1' OR 
  'RF1' OR 'FP3') AND (RF_FLAG EQ ' ')) OR ((SEG_COUNT GE 0) AND 
  (EXCHG_SALE NE ' ')) OR (EMBARK EQ 'EX1' OR 'EX5') THEN SEG_TAX ELSE 0;
GEXCH_TAX/D16 = IF (DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E') THEN 0 ELSE IF 
  ((EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND (EMBARK NE 'DT1' OR 
  'RF1' OR 'FP3') AND (RF_FLAG EQ ' ')) OR ((SEG_COUNT GE 0) AND 
  (EXCHG_SALE NE ' ')) OR (EMBARK EQ 'EX1' OR 'EX5') THEN GSEG_TAX ELSE 0;	
EXMCOS/D9 = IF (EX_FLAG NE ' ') AND (DOC_TYPE EQ '1') AND (EXCHG_SALE 
	NE ' ') THEN 1 ELSE 0;  
FARE_PAID/D12.2 = SEG_AMT + SEG_TAX;
GFARE_PAID/D16.2 = GSEG_AMT + GSEG_TAX; 	
FULL_RFNDS/D9 = IF ((VOID_DATE EQ 0) AND (RF_FLAG EQ 'F') AND (DOC_TYPE NE '1')
  AND (TKT_NUM NE LAST TKT_NUM) AND (SEG_COUNT LT 0)) THEN 1 ELSE 0;
  
  
WATLOW_FLAG/A41 = IF ONLINE_TRADITIONAL EQ 'ONLINE' THEN 'ONLINE BOOKINGS' ELSE 'TRADITIONAL BOOKINGS';   
NEW_SALES/D12 = IF (SEG_AMT GT 0) AND (SEG_COUNT GE 0) AND (EXCHG_SALE 
  EQ ' ') AND (EMBARK NE 'EX1' OR 'RF1' OR 'EX5') THEN SEG_AMT ELSE 0;
GNEW_SALES/D16 = IF (SEG_AMT GT 0) AND (SEG_COUNT GE 0) AND (EXCHG_SALE 
  EQ ' ') AND (EMBARK NE 'EX1' OR 'RF1' OR 'EX5') THEN GSEG_AMT ELSE 0;
	
NEW_SEG_AMT/D12.2 = IF VOID_STATUS EQ '0' THEN SEG_AMT ELSE 0;	
GNEW_SEG_AMT/D16.2 = IF VOID_STATUS EQ '0' THEN GSEG_AMT ELSE 0;	
NEW_SEG_COM/D12.2 = IF VOID_STATUS EQ '0' THEN SEG_COM ELSE 0;
GNEW_SEG_COM/D16.2 = IF VOID_STATUS EQ '0' THEN GSEG_COM ELSE 0;	
NEW_SEG_TAX/D12.2 = IF VOID_STATUS EQ '0' THEN SEG_TAX ELSE 0;
GNEW_SEG_TAX/D16.2 = IF VOID_STATUS EQ '0' THEN GSEG_TAX ELSE 0;	
NEW_TAX/D12 = IF ((SEG_TAX GT 0) AND (SEG_COUNT GE 0) AND (EXCHG_SALE EQ 
  ' ') AND (EMBARK NE 'EX1' OR 'RF1' OR 'EX5')) THEN SEG_TAX ELSE 0;
GNEW_TAX/D16 = IF ((SEG_TAX GT 0) AND (SEG_COUNT GE 0) AND (EXCHG_SALE EQ 
  ' ') AND (EMBARK NE 'EX1' OR 'RF1' OR 'EX5')) THEN GSEG_TAX ELSE 0;

	
NEW_TOTAL/D12 = NEW_SALES + NEW_TAX;
GNEW_TOTAL/D16 = GNEW_SALES + GNEW_TAX;	
ORIG_SALE/D9 = IF (SEG_NBR EQ '01') AND (FARE_PAID GE 0) AND (SEG_COUNT EQ 1) AND (EXCHG_SALE EQ ' ') THEN 1 ELSE IF (DOC_TYPE EQ '1') AND
          (EX_FLAG EQ ' ') AND (EXCHG_SALE NE ' ') AND (RF_FLAG EQ ' ') THEN 1 ELSE 0;	
 
-*  (EX_FLAG EQ ' ') AND (EXCHG_SALE NE ' ') AND (RF_FLAG EQ ' ') THEN 1 ELSE 0;	
OTH_SALES/D9 = IF DOC_TYPE EQ '5' OR '6' OR '7' OR '8' THEN ORIG_SALE 
  ELSE 0;
	
OTHR_AMT/D12 = IF DOC_TYPE EQ '5' OR '6' OR '7' OR '8' THEN NEW_SALES 
  ELSE 0;	
OTHR_TAX/D12 = IF DOC_TYPE EQ '5' OR '6' OR '7' OR '8' THEN NEW_TAX ELSE 
  0;	
OTHR_TOTAL/D12 = IF DOC_TYPE EQ '5' OR '6' OR '7' OR '8' THEN NEW_TOTAL 
  ELSE 0;


GOTHR_AMT/D16 = IF DOC_TYPE EQ '5' OR '6' OR '7' OR '8' THEN GNEW_SALES 
  ELSE 0;	
GOTHR_TAX/D16 = IF DOC_TYPE EQ '5' OR '6' OR '7' OR '8' THEN GNEW_TAX ELSE 
  0;	
GOTHR_TOTAL/D16 = IF DOC_TYPE EQ '5' OR '6' OR '7' OR '8' THEN GNEW_TOTAL 
  ELSE 0;	


	
PAID_FARE/D12.2 = IF VOID_DATE EQ 0 THEN FARE_PAID ELSE 0;
GPAID_FARE/D16.2 = IF VOID_DATE EQ 0 THEN GFARE_PAID ELSE 0;	
PART_RFNDS/D9 = IF ((VOID_DATE EQ 0) AND (RF_FLAG EQ 'P') AND (TKT_NUM 
  NE LAST TKT_NUM) AND (SEG_COUNT LE 0)) THEN 1 ELSE 0;
	
PTA_AMT/D12 = IF DOC_TYPE EQ '4' THEN NEW_SALES ELSE 0;
GPTA_AMT/D16 = IF DOC_TYPE EQ '4' THEN GNEW_SALES ELSE 0;	
	
PTA_CNT/D9 = IF DOC_TYPE EQ '4' THEN ORIG_SALE ELSE 0;
	
PTA_TAX/D12 = IF DOC_TYPE EQ '4' THEN NEW_TAX ELSE 0;
GPTA_TAX/D12 = IF DOC_TYPE EQ '4' THEN GNEW_TAX ELSE 0;	
	
PTA_TOTAL/D12 = IF DOC_TYPE EQ '4' THEN NEW_TOTAL ELSE 0;
GPTA_TOTAL/D16 = IF DOC_TYPE EQ '4' THEN GNEW_TOTAL ELSE 0;
	
REFUND_AMT/D12 = IF ((RF_FLAG EQ 'F' OR 'P') AND (EMBARK NE 'EX1' OR 
  'FP2' OR 'EX5') AND (SEG_COUNT LE 0)) OR (EMBARK EQ 'RF1') THEN SEG_AMT ELSE 
  0;	
REFUND_TAX/D12 = IF ((RF_FLAG EQ 'F' OR 'P') AND (EMBARK NE 'EX1' OR 
  'FP2' OR 'EX5') AND (SEG_COUNT LE 0)) OR (EMBARK EQ 'RF1') THEN SEG_TAX ELSE 
  0;	
REFUND_TOTAL/D12 = IF ((RF_FLAG EQ 'F' OR 'P') AND (EMBARK NE 'EX1' OR 
  'FP2' OR 'EX5') AND (SEG_COUNT LE 0)) OR (EMBARK EQ 'RF1') THEN FARE_PAID ELSE 
  0;


GREF_AMT/D16 = IF ((RF_FLAG EQ 'F' OR 'P') AND (EMBARK NE 'EX1' OR 
  'FP2' OR 'EX5') AND (SEG_COUNT LE 0)) OR (EMBARK EQ 'RF1') THEN GSEG_AMT ELSE 
  0;	
GREF_TAX/D16 = IF ((RF_FLAG EQ 'F' OR 'P') AND (EMBARK NE 'EX1' OR 
  'FP2' OR 'EX5') AND (SEG_COUNT LE 0)) OR (EMBARK EQ 'RF1') THEN GSEG_TAX ELSE 
  0;	
GREF_TTL/D16 = IF ((RF_FLAG EQ 'F' OR 'P') AND (EMBARK NE 'EX1' OR 
  'FP2' OR 'EX5') AND (SEG_COUNT LE 0)) OR (EMBARK EQ 'RF1') THEN GFARE_PAID ELSE 
  0;	


	
REFUNDS/D9 = FULL_RFNDS + PART_RFNDS;	
TKT_CNT/D8CS = IF (SEG_NBR EQ '01') AND (FARE_PAID GE 0) AND (SEG_COUNT 
  EQ 1) THEN 1 ELSE 0;	
TKTLESS/D9 = IF DOC_TYPE EQ '9' THEN ORIG_SALE ELSE 0;


	
TKTLS_AMT/D12 = IF DOC_TYPE EQ '9' THEN NEW_SALES ELSE 0;	
TKTLS_TAX/D12 = IF DOC_TYPE EQ '9' THEN NEW_TAX ELSE 0;	
TKTLS_TOTAL/D12 = IF DOC_TYPE EQ '9' THEN NEW_TOTAL ELSE 0;

GTKTLS_AMT/D16 = IF DOC_TYPE EQ '9' THEN GNEW_SALES ELSE 0;	
GTKTLS_TAX/D16 = IF DOC_TYPE EQ '9' THEN GNEW_TAX ELSE 0;	
GTKTLS_TOTAL/D16 = IF DOC_TYPE EQ '9' THEN GNEW_TOTAL ELSE 0;

		
TOT_ETAX/D12 = EXCH_TAX + EMCO_TAX;	
TOT_EXCH/D12 = EXCH_AMT + EXCH_MCO;


GTOT_ETAX/D16 = GEXCH_TAX + GEMCO_TAX;	
GTOT_EXCH/D16 = GEXCH_AMT + GEXCH_MCO;
	
TOUR_AMT/D12 = IF DOC_TYPE EQ '2' THEN NEW_SALES ELSE 0;	
TOUR_ORDERS/D9 = IF DOC_TYPE EQ '2' THEN ORIG_SALE ELSE 0;	
TOUR_TAX/D12 = IF DOC_TYPE EQ '2' THEN NEW_TAX ELSE 0;	
TOUR_TOTAL/D12 = IF DOC_TYPE EQ '2' THEN NEW_TOTAL ELSE 0;


GTOUR_AMT/D16 = IF DOC_TYPE EQ '2' THEN GNEW_SALES ELSE 0;	
GTOUR_TAX/D16 = IF DOC_TYPE EQ '2' THEN GNEW_TAX ELSE 0;	
GTOUR_TOTAL/D16 = IF DOC_TYPE EQ '2' THEN GNEW_TOTAL ELSE 0;
	
TRAN_DT/MDYY = TRN_DATE;
	
VOID_AMT/D12 = IF VOID_DATE NE 0 THEN SEG_AMT ELSE 0;	
VOID_TAX/D12 = IF VOID_DATE NE 0 THEN SEG_TAX ELSE 0;	
VOID_TOTAL/D12 = IF VOID_DATE NE 0 THEN FARE_PAID ELSE 0;

GVOID_AMT/D16 = IF VOID_DATE NE 0 THEN GSEG_AMT ELSE 0;	
GVOID_TAX/D16 = IF VOID_DATE NE 0 THEN GSEG_TAX ELSE 0;	
GVOID_TOTAL/D16 = IF VOID_DATE NE 0 THEN GFARE_PAID ELSE 0;
	
VOIDS/D9 = IF (VOID_DATE NE 0) AND (SEG_COUNT EQ 1) AND (SEG_NBR EQ '01')
 THEN 1 ELSE IF (DOC_TYPE EQ '1' AND VOID_DATE NE 0) THEN 1 ELSE 0;	

-* Defines on previous DEFINEs
EMCO_TOTAL/D12 = IF DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E' THEN FARE_PAID 
  ELSE 0;

GEMCO_TOTAL/D16 = IF DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E' THEN GFARE_PAID 
  ELSE 0;	
EXCHGS/D9 = IF (EX_FLAG EQ 'F' OR 'P') AND (SEG_COUNT LE 0) AND (EMBARK 
 NE 'DT1' OR 'RF1' OR 'FP3') THEN TKT_CNT ELSE IF (DOC_TYPE EQ '1') AND 
(EXCHG_SALE EQ 'E') THEN 0 ELSE IF (SEG_COUNT GE 0) AND (EXCHG_SALE NE 
  ' ') THEN TKT_CNT ELSE 0;

EXCH_TOTAL/D12 = IF (DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E') THEN 0 ELSE 
  IF (((EXCHG_SALE NE ' ') AND (SEG_COUNT GE 0)) OR ((EMBARK NE 'DT1' OR 
  'RF1' OR 'FP3') AND (RF_FLAG EQ ' ') AND (EX_FLAG EQ 'F' OR 'P') AND 
  (SEG_COUNT LE 0)) OR (EMBARK EQ 'EX1' OR 'EX5')) THEN FARE_PAID ELSE 0;

GEXCH_TOTAL/D16 = IF (DOC_TYPE EQ '1' AND EXCHG_SALE EQ 'E') THEN 0 ELSE 
  IF (((EXCHG_SALE NE ' ') AND (SEG_COUNT GE 0)) OR ((EMBARK NE 'DT1' OR 
  'RF1' OR 'FP3') AND (RF_FLAG EQ ' ') AND (EX_FLAG EQ 'F' OR 'P') AND 
  (SEG_COUNT LE 0)) OR (EMBARK EQ 'EX1' OR 'EX5')) THEN GFARE_PAID ELSE 0;

	
FRFND_AMT/D12 = IF RF_FLAG EQ 'F' THEN REFUND_AMT ELSE 0;	
FRFND_TAX/D12 = IF RF_FLAG EQ 'F' THEN REFUND_TAX ELSE 0;	
FRFND_TOTAL/D12 = IF RF_FLAG EQ 'F' THEN REFUND_TOTAL ELSE 0;

GFREF_AMT/D16 = IF RF_FLAG EQ 'F' THEN GREF_AMT ELSE 0;	
GFREF_TAX/D16 = IF RF_FLAG EQ 'F' THEN GREF_TAX ELSE 0;	
GFREF_TTL/D16 = IF RF_FLAG EQ 'F' THEN GREF_TTL ELSE 0;		

HNDWRT_AMT/D12 = IF DOC_TYPE EQ '3' THEN NEW_SALES ELSE 0;	
HNDWRT_TAX/D12 = IF DOC_TYPE EQ '3' THEN NEW_TAX ELSE 0;	
HNDWRT_TOTAL/D12 = IF DOC_TYPE EQ '3' THEN NEW_TOTAL ELSE 0;

GHNDWRT_AMT/D16 = IF DOC_TYPE EQ '3' THEN GNEW_SALES ELSE 0;	
GHNDWRT_TAX/D16 = IF DOC_TYPE EQ '3' THEN GNEW_TAX ELSE 0;	
GHNDWRT_TOTAL/D16 = IF DOC_TYPE EQ '3' THEN GNEW_TOTAL ELSE 0;
	
HNDWRTS/D9 = IF DOC_TYPE EQ '3' THEN ORIG_SALE ELSE 0;


	
MCO_AMT/D12 = IF DOC_TYPE EQ '1' THEN NEW_SALES ELSE 0;	
MCO_CNT/D9 = IF DOC_TYPE EQ '1' THEN ORIG_SALE ELSE 0;		
MCO_TAX/D12 = IF DOC_TYPE EQ '1' THEN NEW_TAX ELSE 0;	
MCO_TOTAL/D12 = IF DOC_TYPE EQ '1' THEN NEW_TOTAL ELSE 0;


GMCO_AMT/D16 = IF DOC_TYPE EQ '1' THEN GNEW_SALES ELSE 0;	
GMCO_TAX/D16 = IF DOC_TYPE EQ '1' THEN GNEW_TAX ELSE 0;	
GMCO_TOTAL/D16 = IF DOC_TYPE EQ '1' THEN GNEW_TOTAL ELSE 0;
		
NET_AMT/D12 = NEW_SALES + REFUND_AMT + TOT_EXCH - VOID_AMT;	
NET_TAX/D12 = NEW_TAX + REFUND_TAX + TOT_ETAX - VOID_TAX;

GNET_AMT/D16 = GNEW_SALES + GREF_AMT + GTOT_EXCH - GVOID_AMT;	
GNET_TAX/D16 = GNEW_TAX + GREF_TAX + GTOT_ETAX - GVOID_TAX;

	
PRFND_AMT/D12 = IF RF_FLAG EQ 'P' THEN REFUND_AMT ELSE 0;	
PRFND_TAX/D12 = IF RF_FLAG EQ 'P' THEN REFUND_TAX ELSE 0;	
PRFND_TOTAL/D12 = IF RF_FLAG EQ 'P' THEN REFUND_TOTAL ELSE 0;

GPREF_AMT/D16 = IF RF_FLAG EQ 'P' THEN GREF_AMT ELSE 0;	
GPREF_TAX/D16 = IF RF_FLAG EQ 'P' THEN GREF_TAX ELSE 0;	
GPREF_TTL/D16 = IF RF_FLAG EQ 'P' THEN GREF_TTL ELSE 0;
		
TOTAL_EXCHG/D12 = EXCH_TOTAL + EMCO_TOTAL;

GTOTAL_EXCHG/D16 = GEXCH_TOTAL + GEMCO_TOTAL;	
TOT_ECNT/D9 = EXCHGS + EXMCOS;	
TOT_TRANS/D9 = ORIG_SALE + VOIDS + TOT_ECNT + REFUNDS;
	
CHARGE_TRN/D9 = ORIG_SALE + VOIDS + EXCHGS + REFUNDS;
KW_TRN/D9 = ORIG_SALE + EXCHGS;
TRN_TYPE/A4 = IF (VOIDS EQ 1) THEN 'VOID' ELSE IF (ORIG_SALE EQ 1) THEN 
  'SALE' ELSE IF (TOT_ECNT EQ 1) THEN 'EXCH' ELSE IF (REFUNDS EQ 1) THEN 
  'RFND' ELSE ' ';	
FEE1/D12.2CS = 35.25;
FEE1X/D20.6 = FEE1 * CURR1X;

-* Defines on previous DEFINEs
NET_TOTAL/D12 = NEW_TOTAL + REFUND_TOTAL + TOTAL_EXCHG - VOID_TOTAL;
GNET_TOTAL/D16 = GNEW_TOTAL + GREF_TTL + GTOTAL_EXCHG - GVOID_TOTAL;
NET_TRAN/D12 = ORIG_SALE + EXCHGS - REFUNDS - VOIDS;	
FEE/D12.2CS = CHARGE_TRN * FEE1;
GFEE/D16.2CS = CHARGE_TRN * FEE1X;
OTOT_TRN/D9 = IF ONLINE_TRADITIONAL EQ 'ONLINE' THEN TOT_TRANS ELSE 0;
TTOT_TRN/D9 = IF ONLINE_TRADITIONAL EQ 'TRADITIONAL' THEN TOT_TRANS ELSE 0;

	
DI_FLAG/A13 = IF IDFLAG EQ 'I' THEN 'INTERNATIONAL' ELSE 'DOMESTIC';
-* New Principal Transaction Summary Defines
-*PRINC_FLAG/A55 = IF DOD_TYPE EQ 'I' OR 'J' OR 'M' OR 'X' OR 'A' OR 'L' OR 'N' OR 'S' OR 'H' THEN 'ONLINE BOOKINGS' ELSE
-*                 IF DOD_TYPE EQ 'K' AND PRWG EQ 'Y' THEN 'EXECUTIVE-WHITE GLOVE' ELSE
-*                 IF DOD_TYPE EQ 'K' AND PRWG EQ 'N' THEN 'EXECUTIVE-NON-WHITE GLOVE' ELSE 
-*                 IF DOD_TYPE EQ ' ' AND INT_DOM EQ 'D' THEN 'NON-EXECUTIVE DOMESTIC' ELSE
-*                 IF DOD_TYPE EQ ' ' AND INT_DOM EQ 'I' AND 4SEG_REC EQ 'Y' THEN 'NON-EXECUTIVE INTERNATIONAL - <4 SEGMENTS' ELSE
-*                 IF DOD_TYPE EQ ' ' AND INT_DOM EQ 'I' AND 4SEG_REC EQ 'N' THEN 'NON-EXECUTIVE INTERNATIONAL - >= 4 SEGMENTS' ELSE ' ';

-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-**********************************************************************
 NOWTOD/A8 WITH TKT_NUM = HHMMSS (NOWTOD);
END







-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

TABLE FILE TRANONE
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
-* &&BREAKOPTION
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10
ON TABLE COLUMN-TOTAL
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT   
FOOTING BOTTOM
-INCLUDE FOOTERTR


-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE SET STYLE *
-*
-* FTR_DateTimePosit sets the position of the Post-trip date/time stamp text within the footer image.
-* The default line number (&FTR_DateTimeLine) in the FOOTING for the date/time stamp text is: 4.
-INCLUDE FTR_DateTimePosit
-*
-INCLUDE GLOBAL_LOGO_SM
-IF &&OUTFMT NE 'PDF' OR 'PPT' OR 'COM' GOTO XLSTY;
 
-* UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.500000, RIGHTMARGIN=0.250000, 
-*     TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
-*     ORIENTATION=LANDSCAPE, $

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000, 
    TOPMARGIN=0.300000, BOTTOMMARGIN=0.050000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $
-GOTO JOY
TYPE=HEADING, OBJECT=TEXT, SIZE=8, COLOR=BLACK, $
TYPE=HEADING, LINE=4, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
-JOY
TYPE=HEADING, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$
TYPE=HEADING, LINE=8, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=9, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=FOOTING, SIZE=7, FONT='ARIAL', COLOR=RGB(70 136 177), $
TYPE=TABFOOTING, SIZE=7, FONT='ARIAL', COLOR=RGB(70 136 177),$
TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBFOOT, SIZE=9, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=9, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=9, STYLE=BOLD, $
TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0), SIZE=(2.8 .37),PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.0), SIZE=(10.5 .58), PRESERVERATIO=ON, $   
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&TNTDTPOS), SIZE=(&&ROLDTSIZ), $
-*
TYPE=FOOTING, LINE=&FTR_DateTimeLine, STYLE=BOLD,POSITION=(&FTR_DatePosit),$ 
-*
-* TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(&&TNTSMPOS), SIZE=(&&TNTSMSIZ), $
-* TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLSMPOS), SIZE=(&&ROLSMSIZ), $
-GOTO SKPEXSTY;

-XLSTY;
-INCLUDE &&PASTYS
TYPE=REPORT, COLUMN=N2, SQUEEZE=2.0, $

TYPE=REPORT, COLUMN=N10, SQUEEZE=1.0, $
TYPE=REPORT, COLUMN=N11, SQUEEZE=1.0, $

TYPE=TABFOOTING, SIZE=7, $
TYPE=FOOTING, SIZE=7, $

-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-SKPEXSTY;
-IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILL;
-INCLUDE &&DSTY

-SKIP_DRILL

ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN

JOIN CLEAR *
-RUN

-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3;

EX REPORT_3

-SKIP_R3

-XXIT;
