SET ASNAMES = ON

JOIN AIR_KEY IN S_ASAHIG TO AIR_KEY IN A_ASAHIG
TABLE FILE S_ASAHIG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF LEVEL1 EQ 'YP' 
-* OR 'YP' OR 'YP' OR 'YP' OR 'YP' OR 'YP' OR 'YP'
ON TABLE HOLD
END
-RUN


MODIFY FILE S_ASAHIG
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='AUTO';
ON MATCH COMPUTE AROLL_LEV4='YP';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN AIR_KEY IN M_ASAHIG TO AIR_KEY IN A_ASAHIG
TABLE FILE M_ASAHIG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF LEVEL1 EQ 'YP' 
-* OR 'YP' OR 'YP' OR 'YP' OR 'YP' OR 'YP' OR 'YP'
ON TABLE HOLD
END
-RUN

MODIFY FILE M_ASAHIG
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='AUTO';
ON MATCH COMPUTE AROLL_LEV4='YP';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

JOIN AIR_KEY IN D_ASAHIG TO AIR_KEY IN A_ASAHIG
TABLE FILE D_ASAHIG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF LEVEL1 EQ 'YP' 
-* OR 'YP' OR 'YP' OR 'YP' OR 'YP' OR 'YP' OR 'YP'
ON TABLE HOLD
END
-RUN


MODIFY FILE D_ASAHIG
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='AUTO';
ON MATCH COMPUTE AROLL_LEV4='YP';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

TABLE FILE C_ASAHIG
PRINT CAR_KEY
BY CAR_KEY NOPRINT
IF LEVEL1 EQ 'YP' 
-* OR 'YP' OR 'YP' OR 'YP' OR 'YP' OR 'YP' OR 'YP'

ON TABLE HOLD AS CHOLD
END
-RUN

MODIFY FILE C_ASAHIG
FIXFORM FROM CHOLD
MATCH CAR_KEY
ON MATCH COMPUTE AROLL_LEV3='AUTO';
ON MATCH COMPUTE AROLL_LEV4='YP';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN

TABLE FILE H_ASAHIG
PRINT HTL_KEY
BY HTL_KEY NOPRINT

IF LEVEL1 EQ 'YP' 
-* OR 'YP' OR 'YP' OR 'YP' OR 'YP' OR 'YP' OR 'YP'
ON TABLE HOLD AS HHOLD
END
-RUN

MODIFY FILE H_ASAHIG
FIXFORM FROM HHOLD
MATCH HTL_KEY
ON MATCH COMPUTE AROLL_LEV3='AUTO';
ON MATCH COMPUTE AROLL_LEV4='YP';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4  
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN

