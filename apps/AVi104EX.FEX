-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

SET ASNAMES = ON
-SET HOLDATTR = ON;

-SET &AIRDATES = &&WEB_PATH || 'AIRDATES.fex';


DEFINE FILE &&EXTRACT
  CITY/A6=SUBSTR (176, CDIR_STP, 1, 6, 176, CITY);
  FARE_PAID/D12.2CS   = SEG_AMT + SEG_TAX;
  LEVEL_DESC/A60      = &&LDESC;  
  ROLL/A1 = EDIT (AROLL_LEV4, '9$$$$$$$$$$$$$$');
  ROLL1/A25 = IF ROLL EQ '1' THEN 'STORES' ELSE
              IF ROLL EQ '2' THEN 'REGIONS' ELSE
              IF ROLL EQ '3' THEN 'TERRITORIES' ELSE
              IF ROLL EQ '4' THEN 'DISTRICTS' ELSE
              IF ROLL EQ '6' THEN 'DISTRBN_CENTERS' ELSE
              IF ROLL EQ '7' THEN 'SECURITY' ELSE AROLL_LEV4;
  ROLL2/A15 = IF ROLL EQ '1' THEN '1' ELSE
              IF ROLL EQ '2' THEN '2' ELSE
              IF ROLL EQ '3' THEN '3' ELSE
              IF ROLL EQ '4' THEN '4' ELSE
              IF ROLL EQ '5' THEN '5' ELSE
              IF ROLL EQ '6' THEN '6' ELSE
              IF ROLL EQ '7' THEN '7' ELSE AROLL_LEV4;
TP/A5 = EDIT (LEVEL3, '99999$$$$$$$$$$');
TP1/A15 = IF LEVEL3 EQ ' ' THEN 'OTHER' ELSE TP;
-* DEFINES ON PREVIOUS DEFINES

  TP_CDE/A30 = DECODE TP1 ('CONFR' 'CONFERENCE/SEMINAR' 
                          'CPMTG' 'CORPORATE MEETING'  
                          'CPTRN' 'CORPORATE TRAINING'
                          'DCVST' 'DISTRIBUTION CENTER VISIT' 
                          'INTER' 'INTERVIEW'
                          'MKTRP' 'MERCHANT MARKET TRIP'
                          'NSPRE' 'NEW STORE/PRE-OPENING TRAVEL'
                          'OTHER' 'OTHER'
                          'PANEL' 'PANEL INTERVIEWS'
                          'RELOC' 'RELOCATION'
                          'STVST' 'STORE VISIT'
                          'VNVST' 'VENDOR VISIT');

  XDPT_DT/MDYY         = DPT_DATE;
  XTRAN_DT/MDYY        = TRN_DATE;

-INCLUDE TRANTYPE  
END
-RUN

TABLEF FILE &&EXTRACT
PRINT
  AROLL_DSC4
  AROLL_LEV4
  CITY
  FARE_PAID
  LEVEL_DESC
  PASSNGR_NAME	
  ROLL
  ROLL1
  ROLL2
  SEG_COUNT
  SEG_NBR
  TP_CDE
  TKT_NUM	
  TKT_SORT
  XTRAN_DT
  XDPT_DT	

-INCLUDE &AIRDATES

WHERE VOID_DATE EQ 0
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10

-INCLUDE RPTPARMS

ON TABLE HOLD AS &&RPT_HOLD
END
-RUN


