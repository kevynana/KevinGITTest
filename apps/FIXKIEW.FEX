SET ASNAMES = ON


JOIN AIR_KEY IN SZKIEW TO AIR_KEY IN AZKIEW AS J1
DEFINE FILE SZKIEW
XL01/A15 = IF AROLL_LEV2 EQ 'LEISURE' THEN 'DEFL' ELSE
           IF AROLL_LEV2 EQ 'MEETING' THEN 'DEFM' ELSE
           IF AROLL_LEV2 EQ 'KIEWITS' THEN 'DEFS' ELSE
           IF AROLL_LEV2 EQ 'KIEWITP' THEN 'DEFP' ELSE
           IF AROLL_LEV2 EQ 'KIEWITB' AND AROLL_LEV3 EQ 'TIC' THEN 'TIC'
           ELSE 'KIEWIT';
XL02/A15= AROLL_LEV3;
END 
TABLE FILE SZKIEW
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL01 AS 'AROLL_LEV3' XL02 AS 'AROLL_LEV4'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD
END
-RUN


MODIFY FILE SZKIEW
FIXFORM FROM HOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN


JOIN AIR_KEY IN MZKIEW TO AIR_KEY IN AZKIEW AS J1
DEFINE FILE MZKIEW
XL01/A15 = IF AROLL_LEV2 EQ 'LEISURE' THEN 'DEFL' ELSE
           IF AROLL_LEV2 EQ 'MEETING' THEN 'DEFM' ELSE
           IF AROLL_LEV2 EQ 'KIEWITS' THEN 'DEFS' ELSE
           IF AROLL_LEV2 EQ 'KIEWITP' THEN 'DEFP' ELSE
           IF AROLL_LEV2 EQ 'KIEWITB' AND AROLL_LEV3 EQ 'TIC' THEN 'TIC'
           ELSE 'KIEWIT';
XL02/A15= AROLL_LEV3;
END 
TABLE FILE MZKIEW
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL01 AS 'AROLL_LEV3' XL02 AS 'AROLL_LEV4'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS MHOLD
END
-RUN


MODIFY FILE MZKIEW
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN

JOIN AIR_KEY IN DZKIEW TO AIR_KEY IN AZKIEW AS J1
DEFINE FILE DZKIEW
XL01/A15 = IF AROLL_LEV2 EQ 'LEISURE' THEN 'DEFL' ELSE
           IF AROLL_LEV2 EQ 'MEETING' THEN 'DEFM' ELSE
           IF AROLL_LEV2 EQ 'KIEWITS' THEN 'DEFS' ELSE
           IF AROLL_LEV2 EQ 'KIEWITP' THEN 'DEFP' ELSE
           IF AROLL_LEV2 EQ 'KIEWITB' AND AROLL_LEV3 EQ 'TIC' THEN 'TIC'
           ELSE 'KIEWIT';
XL02/A15= AROLL_LEV3;
END 
TABLE FILE DZKIEW
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR XL01 AS 'AROLL_LEV3' XL02 AS 'AROLL_LEV4'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS DHOLD
END
-RUN


MODIFY FILE DZKIEW
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN


DEFINE FILE CZKIEW
XL01/A15 = IF AROLL_LEV2 EQ 'LEISURE' THEN 'DEFL' ELSE
           IF AROLL_LEV2 EQ 'MEETING' THEN 'DEFM' ELSE
           IF AROLL_LEV2 EQ 'KIEWITS' THEN 'DEFS' ELSE
           IF AROLL_LEV2 EQ 'KIEWITP' THEN 'DEFP' ELSE
           IF AROLL_LEV2 EQ 'KIEWITB' AND AROLL_LEV3 EQ 'TIC' THEN 'TIC'
           ELSE 'KIEWIT';
XL02/A15= AROLL_LEV3;
END 
TABLE FILE CZKIEW
PRINT CAR_KEY XL01 AS 'AROLL_LEV3' XL02 AS 'AROLL_LEV4'
BY CAR_KEY NOPRINT

ON TABLE HOLD AS CHOLD
END
-RUN


MODIFY FILE CZKIEW
FIXFORM FROM CHOLD
MATCH CAR_KEY  
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN

DEFINE FILE HZKIEW
XL01/A15 = IF AROLL_LEV2 EQ 'LEISURE' THEN 'DEFL' ELSE
           IF AROLL_LEV2 EQ 'MEETING' THEN 'DEFM' ELSE
           IF AROLL_LEV2 EQ 'KIEWITS' THEN 'DEFS' ELSE
           IF AROLL_LEV2 EQ 'KIEWITP' THEN 'DEFP' ELSE
           IF AROLL_LEV2 EQ 'KIEWITB' AND AROLL_LEV3 EQ 'TIC' THEN 'TIC'
           ELSE 'KIEWIT';
XL02/A15= AROLL_LEV3;
END 
TABLE FILE HZKIEW
PRINT HTL_KEY XL01 AS 'AROLL_LEV3' XL02 AS 'AROLL_LEV4'
BY HTL_KEY NOPRINT

ON TABLE HOLD AS HHOLD
END
-RUN


MODIFY FILE HZKIEW
FIXFORM FROM HHOLD
MATCH HTL_KEY  
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN