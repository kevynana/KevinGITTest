-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Deb - 09/08/06 added dod_type K to fee
-* REMOVED SPLIT FEES TO 90201401 PER CHERYL COUGHLIN - DEB 8/18/2008

-*SET &ECHO=ALL;
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

-SET &CARDATES = &&WEB_PATH || 'CARDATES.fex';
DEFINE FILE &&EXTRACT

  XPSNGR_NM/A15        = 
    EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
  PAX/A5 = EDIT(XPSNGR_NM, '99999$$$$$$$$$$');
  ACCOUNT/A8 = '6022001';
  LINE_DESC/A38 = XPSNGR_NM||TKT_NUM||PNR_LOCATOR|' '|'C';
  FEE/P5.2S = IF DOD_TYPE NE ' '  OR 'K' AND TKT_NUM EQ '0000000000' THEN 5 ELSE 0;
  FEE1/P5.2S = IF DOD_TYPE NE ' ' OR 'K' AND TKT_NUM EQ '0000000000' THEN 2 ELSE 0;  

END
-RUN

TABLEF FILE &&EXTRACT
PRINT ACCOUNT
  FEE
  FEE1
  INVOICE_DATE
  LINE_DESC
  LEVEL1
  PAX
  PNR_LOCATOR
  XPSNGR_NM
  

-INCLUDE &CARDATES    
-********************************************************************
-* Where statements to select data specified in user profile
-* *******************************************************************
&&WHERE1
&&WHERE2
&&WHERE3
&&WHERE4
&&WHERE5
&&WHERE6
&&WHERE7
&&WHERE8
&&WHERE9
&&WHERE10
-INCLUDE RPTPARMS
ON TABLE HOLD AS CARHOLD
END
-RUN

DEFINE FILE CARHOLD
FLAG/A1 = 'C';
END
TABLE FILE CARHOLD
PRINT ACCOUNT 
      FEE
      INVOICE_DATE AS 'XTRAN_DT'
      LEVEL1 
      LINE_DESC
      PAX
      PNR_LOCATOR
      XPSNGR_NM
BY FLAG
ON TABLE HOLD AS HC1 FORMAT FOCUS
END
-RUN

-GOTO SkipItCar;

DEFINE FILE CARHOLD
FLAG/A1 = 'D';
LEVEL1/A15 = '90201401';
END
TABLE FILE CARHOLD
PRINT ACCOUNT 
      FEE1 AS 'FEE'
      INVOICE_DATE AS 'XTRAN_DT'
      LEVEL1
      LINE_DESC
      PAX
      PNR_LOCATOR
      XPSNGR_NM
BY FLAG
ON TABLE HOLD AS HC2 FORMAT FOCUS
END
-RUN


-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HA=&HLDPATH || 'HC1.FOC';
-SET &HB=&HLDPATH || 'HC2.FOC';
-RUN

USE CLEAR *
-RUN

EX SUUSES
-RUN 

USE ADD 
&HA AS HC1
&HB AS HC1
END
-RUN

-SkipItCar

TABLE FILE HC1
PRINT FEE LEVEL1 LINE_DESC XPSNGR_NM XTRAN_DT PNR_LOCATOR PAX
BY FLAG
BY ACCOUNT
ON TABLE HOLD AS HC2 FORMAT FOCUS
END
-RUN



