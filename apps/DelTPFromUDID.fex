-***********************************************************************************************
-* DelTPFromUDID.fex
-*
-* Delete TP- from UDID file for all clients
-***********************************************************************************************
-SET &ECHO = ALL;
TABLE FILE ROLLUP
PRINT ROLLUP_CODE COMP 
-*UPD_ENABLE UDIDUSED
WHERE UDIDUSED EQ 'Y' OR 'y'
ON TABLE SAVE AS SAVEUDID
END
-RUN
-SET &LOOPTIMES = &LINES;
-SET &COUNTER = 0;

-REPEAT TOEND &LOOPTIMES TIMES
-READ SAVEUDID NOCLOSE &ROLLUP.8. &COMP.6.

-SET &FILENAME='D:\TNT\TTRACKER\DATA\' | 'UF' || '&COMP.EVAL' || '.FOC';
-SET &MST = 'UF' | '&COMP.EVAL' || '';

USE
&FILENAME AS &MST
END
 
TABLE FILE &MST
PRINT *
WHERE UDID EQ 'TP-'
ON TABLE HOLD
END   
-RUN
-IF &LINES EQ 0 THEN GOTO SKIPMODIFY;
-SET &COUNTER = &COUNTER + 1;

MODIFY FILE &MST
FIXFORM FROM HOLD
MATCH UDID
  ON MATCH DELETE
  ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-SKIPMODIFY

-TOEND
-TYPE Number of &COUNTER 
-done