-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-INCLUDE SETECHO
-* File TKTSUM.FEX
-* 5/18/04 - DEB - ADDED AIRLINE_FEE COLUMN PER MONICA COLLIGAN
-*10/08/04 - DV - CHANGED PROGRAM SO SETFILE WOULD PRODUCE REPORT
-*                ADDED LEVEL1 LEVEL2 LEVEL3
-*01/04/05 - DV - ADDED CODE FOR GLOBAL CURRENCY
-*10/10/05 - DV - ADDED GEO_ZONE
-* 10/11/12 - DV- ADDED CODE FOR ALL-R TO USE SLACHD WITH NO ID- SORT
-* 1/3/14 - DV     CARRIED THROUGH CLASS_CAT 
-*1/27/14 - DV - ADDED ROUTINE FOR SLACHD AND IVAF-R 
-*4/29/14 - JK - TESTED WITH PROGRAM FOR PROGRESSIVE ERROR
-* 1/22/15 - DEB - S-07118 ADDED LEVEL5 LEVEL6 FOR LOWES-R LWACHTT
-*2/25/15 - DEB - S-07611 CHANGED PGACHDCC TO INCLUDE VOIDS
-*4/3/15 - DEB - S-08227 CHANGED TKTA DEFINE CAUSING ISSUES WITH PGACHDCC
-*12/01/15  Joy    S-07987  Corrected for running Currency Enabled Version
-*12/29/15 - JEM - S-13286 Updated to allow reports to sort/subtotal by id-levels
-*4/7/16 - JEM - S-17571 Removed &&SUBHEAD for KOACH report to correct error..level_desc is not used in that report
-*7/21/16 S-20630 DLV  Carried through EMP_ID
-* 02/24/17 DLV S-22486 - Changed spacing to insert 1 line
-* 03/14/17 JEM S-22486 - updated position of header and footer NEW_HDR NEW_FTR
-* 05/23/17 JEM S-34624 - Updating heading/stylesheet to standardize
-* 10/13/17 - DLV - S-40826 - Carroed through OTFLAG for TMACHDOT
-**********************************************************************

-**********************************************************************

SET ASNAMES=ON

 
-IF &&SETF.EVAL EQ 'KOACH' GOTO KOHLS;

-IF '&&SETF.EVAL' NE 'BZACHDCC' THEN GOTO CHECK1;

TABLE FILE BRPTINST
BY BREAK_LEVELS  
WHERE INST_KEY EQ &&IKEY
ON TABLE SAVE  
END
-RUN

-READ SAVE &BL.18.
-SET &LEN = ARGLEN(60, '&BL.EVAL', 'I2');
-SET &NBRLVL = &LEN / 3;
-SET &NR1 = 2 + &NBRLVL.EVAL;
-SET &RL1 = 'N' || '&NR1.EVAL';
-SET &NR2 = 4 + &NBRLVL.EVAL;
-SET &RL2 = 'N' || '&NR2.EVAL';
-SET &NR3 = 5 + &NBRLVL.EVAL;
-SET &RL3 = 'N' || '&NR3.EVAL';
-SET &NR4 = 11 + &NBRLVL.EVAL;
-SET &RL4 = 'N' || '&NR4.EVAL';
-SET &NR5 =  13 + &NBRLVL.EVAL; 
-SET &RL5 = 'N' || '&NR5.EVAL';
-SET &NR6 = 14 + &NBRLVL.EVAL;
-SET &RL6 = 'N' || '&NR6.EVAL';  
-SET &NR7 = 15 + &NBRLVL.EVAL;
-SET &RL7 = 'N' || '&NR7.EVAL';
-SET &NR8 = 16 + &NBRLVL.EVAL;
-SET &RL8 = 'N' || '&NR8.EVAL';
-SET &NR9 = 17 + &NBRLVL.EVAL;
-SET &RL9 = 'N' || '&NR9.EVAL';
-SET &NR10 = 18 + &NBRLVL.EVAL;
-SET &RL10 = 'N' || '&NR10.EVAL';
-SET &NR11 = 19 + &NBRLVL.EVAL;
-SET &RL11 = 'N' || '&NR11.EVAL';
-SET &NR12 = 20 + &NBRLVL.EVAL;
-SET &RL12 = 'N' || '&NR12.EVAL';
-SET &NR13 = 21 + &NBRLVL.EVAL;
-SET &RL13 = 'N' || '&NR13.EVAL';
-SET &NR14 = 22 + &NBRLVL.EVAL;
-SET &RL14 = 'N' || '&NR14.EVAL';
-SET &NR15 = 23 + &NBRLVL.EVAL;
-SET &RL15 = 'N' || '&NR15.EVAL';
-SET &NR16 = 24 + &NBRLVL.EVAL;
-SET &RL16 = 'N' || '&NR16.EVAL';
-CLOSE SAVE


-CHECK1

-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HNKA=&HLDPATH || 'HOLDA.FOC';
-SET &HNKB=&HLDPATH || 'HOLDH.FOC';
-SET &HNKC=&HLDPATH || 'HOLDC.FOC';
-SET &HNKL=&HLDPATH || 'HOLDL.FOC';

-RUN


-SET &FILENAME = 'HOLDA'; 


-DOS STATE &HNKA
-SET &HOLDFILEA = IF &RETCODE.EVAL EQ 0 THEN &HNKA | ' AS ' | &FILENAME ELSE ' ';

-DOS STATE &HNKB
-SET &HOLDFILEH = IF &RETCODE.EVAL EQ 0 THEN &HNKB | ' AS ' | &FILENAME ELSE ' ';

-DOS STATE &HNKC
-SET &HOLDFILEC = IF &RETCODE.EVAL EQ 0 THEN &HNKC | ' AS ' | &FILENAME ELSE ' ';

-DOS STATE &HNKL
-SET &HOLDFILEL = IF &RETCODE.EVAL EQ 0 THEN &HNKL | ' AS ' | &FILENAME ELSE ' ';


USE ADD 
&HOLDFILEA
&HOLDFILEH
&HOLDFILEC
&HOLDFILEL
END
-RUN


TABLE FILE HOLDA
PRINT
  AMOUNT
  GAMOUNT
  TTL_COUNT
  FEE
  FEEX
  GEO_ZONE
  PADV
  LOST_AMT
  LOW_AMT
  VASAV
  NEW_ADV_PURCH
-INCLUDE BYHIERARCHY  
BY LEVEL_DESC
BY PASSNGR_NAME
BY PNR_LOCATOR
BY TRAN_DATE
BY FDATE
BY TKT_NUM
BY TKTN
BY TSORT
BY SEG
BY TYPE
BY OTFLAG
BY NAME 
BY DATE
BY AIRT
BY CITY1
BY CITY2
BY EMP_ID
BY FLAG
BY LEVEL1
BY LEVEL2
BY LEVEL3
BY LEVEL4
BY LEVEL5
BY LEVEL6
BY REFUSE_CODE
BY NAMEC
BY TRIP_PURPOSE
BY CHG_COD
BY CCA_CARD
BY CC_NUM
BY CLASS
BY CLASS_CAT
BY CCNUM2
BY C_ITIN
BY DST_APC
BY AR_BRANCH
BY BR_CL_IDX
BY INVOICE_NUM 
BY NAME2
BY TKTN
BY RESV_STATUS
-IF &&SETF NE 'GAACHD' THEN GOTO NoWhere;
WHERE LEVEL2 EQ '146484' OR '146142' OR '146718' OR '146949' OR '146328' OR 
      '147706' OR '147405' OR '147346' OR '147734' OR '147261' OR '148292' OR
      '148550' OR '148782' OR '148337' OR '148869' OR '148601' OR '148875' OR
      '148956' OR '148400' OR '148686' OR '148405' OR '148026' OR '148311' OR 
      '148503' OR '149528' OR '149157' OR '149308' OR '149548' OR '149638' OR
      '149450' OR '149715' OR '149891' OR '149904' OR '149718' OR '149213' OR
      '149317' OR '149540' OR '149809' OR '149677' OR '149805' OR '149465' OR 
      '149371' OR '149508' OR '149954' OR '149156' OR '149906' OR '149529' OR 
      '149518' OR '149893' OR '149866' OR '149325' OR '149496' OR '149925' OR 
      '149407' OR '149318' OR '149121' OR '149190' OR '149782' OR '149362' OR 
      '149770' OR '149542' OR '149449' OR '149030' OR '149113' OR '149658' OR 
      '149674' OR '149409' OR '149717' OR '150664' OR '150586' OR '150576' OR
      '150911' OR '150724' OR '150270' OR '150776' OR '150251' OR '150599' OR 
      '150051' OR '150271' OR '150209' OR '150987' OR '150312' OR '150143' OR 
      '150527' OR '150274' OR '150338' OR '150985' OR '150963' OR '150721' OR 
      '150104' OR '150508' OR '150766' OR '150004' OR '150112' OR '150268' OR 
      '150330' OR '150489' OR '150289' OR '150301' OR '150598' OR '150100' OR 
      '150640' OR '151701' OR '151603' OR '151338' OR '151079' OR '151529' OR
      '151515' OR '151411' OR '151449' OR '151207' OR '151011' OR '151272' OR
      '151013' OR '151206' OR '151129' OR '151204'
-NoWhere
ON TABLE HOLD AS HOLDE 
END
-RUN


 

-IF &RECORDS EQ 0 THEN GOTO xxit;



-SET &&RPTSUF = 'DTL';
-INCLUDE FDEFRPTS
-RUN

-IF &&SETF EQ 'PGACHDCC' OR 'PGACHDC1' GOTO PROGR;

-**************************************************************************
DEFINE FILE HOLDE
COUNT1/D12CS = IF (FLAG EQ 'A') THEN TTL_COUNT ELSE 0;
COUNT2/D12CS = IF (FLAG EQ 'C') THEN TTL_COUNT ELSE 0;
COUNT3/D12CS = IF (FLAG EQ 'H') THEN TTL_COUNT ELSE 0;
COUNT4/D12CS = IF (FLAG EQ 'L') THEN TTL_COUNT ELSE 0;
AMT1/D12.2CS = IF (FLAG EQ 'A') THEN AMOUNT ELSE 0;
AMT2/D12.2CS = IF (FLAG EQ 'C') THEN AMOUNT ELSE 0;
AMT3/D12.2CS = IF (FLAG EQ 'H') THEN AMOUNT ELSE 0;
AMT4/D12.2CS = IF (FLAG EQ 'L') THEN AMOUNT ELSE 0;
FLAGA/A5 = DECODE FLAG ('A' 'AIR'   'C' 'CAR'  'H' 'HTL' 'L' 'LIM');                         
XPSNGR_NM/A15        = 
    EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
TICKET_NMBR/A10 = IF (TKT_NUM EQ '0000000000') THEN ' ' ELSE
                  TKT_NUM;
TKTN1/A10 = IF (TKT_NUM EQ '0000000000') THEN ' ' ELSE TKT_NUM;
TKTN2/A10 = IF TKTN1 EQ ' ' THEN ' ' ELSE TKTN1;
TKTNPG/A10 = IF (TKTN EQ '0000000000') THEN ' ' ELSE
                  TKTN;
TKTNPG1/A10 = IF TKTNPG EQ ' ' THEN ' ' ELSE TKTNPG;                  

-* CUR_DESC/A95 = LEVEL_DESC||'-'||NAMEC;
CUR_DESC/A50 = NAMEC;
  
                 
-*DEFINES ON PREVIOUS DEFINES 
PASNGR_NAME/A15 = IF TKT_NUM NE LAST TKT_NUM THEN XPSNGR_NM ELSE ' ';
LVL1/A15 = IF TKT_NUM NE LAST TKT_NUM THEN LEVEL1 ELSE ' ';
TRAN_MYA/I6MTYY = TRAN_DATE;
NOWTOD/A8 WITH TKT_NUM = HHMMSS (NOWTOD);
-* ITIN/A67 = IF SEG EQ '01' THEN C_ITIN ELSE ' ';

-INCLUDE DefineSubtotalFields  
END



-IF &&DRILLED_RUN EQ 'N' GOTO SKIP_DRIL;
-************************************************************
-* INCLUDE PROGRAM TO GEN WHERE STATEMENTS
-************************************************************
-SET &&DRILLRPT = 'HOLDE';
-INCLUDE DRILWHRS
-SKIP_DRIL
-************************************************************


-IF &&CURRENCY EQ 'USD' THEN GOTO NEXT;

-SET &&SUBHEAD = <CUR_DESC;
-SET &GFAR_CUR = 'AMOUNT, (' | &&CURRENCY || ')';
-SET &GFEE_CUR = 'ARLN, FEE, (' | &&CURRENCY || ')';
-SET &&PRINT3='CITY1/A20 AS ''ORG'' CITY2/A18 AS ''DST'' ';
-SET &&PRINT4='GAMOUNT/D16.2CS AS ' | '''&GFAR_CUR.EVAL''';
-SET &&PRINT5='FEEX/D16.2CS AS ' | '''&GFEE_CUR.EVAL''';
-SET &&PRINT7='COUNT2 AS ''CAR,DAY'' ';


-NEXT;

 
-IF '&&SETF.EVAL' NE 'ABACHDCC' OR 'AVACHDCC' THEN GOTO Checknext;
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXACH'; 
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&DTSTY;


 
-INCLUDE getLVLtitle

-IF '&&SETF.EVAL' NE 'AVACHDCC' THEN GOTO SkipSet;


-SET &LV2 = 'AS' | ' ' | '''DIV,DEPT''';
-RUN
-TYPE &LV2

-SkipSet


TABLE FILE HOLDE
HEADING
-INCLUDE &&PAHDR
"&&SUBHEAD"

-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</1"
-NOSPC;
PRINT 
LEVEL1 &LV1
LEVEL2 &LV2
LEVEL3 &LV3
TRAN_DATE AS 'TRAN,DATE' TICKET_NMBR AS  'TICKET,NUMBER'
 NAME/A18 AS 'NAME' DATE AS 'DATE'
CITY1/A17 AS 'ORG' CITY2/A17 AS 'DST'
GAMOUNT AS 'AMOUNT'
FEE AS 'AIRLN,FEE'
COUNT1 AS 'TKT,CNT
COUNT2 AS 'CAR,DAYS'
COUNT3 AS 'HTL,NTS'
COUNT4 AS 'LIMO,DAYS'
BY LEVEL_DESC NOPRINT BY CC_NUM NOPRINT

BY XPSNGR_NM AS  'PASSENGER,NAME'   BY TRAN_DATE NOPRINT 
BY PNR_LOCATOR AS ' PNR'  BY FLAGA AS  'TRAN,TYPE' 
BY TSORT NOPRINT BY DATE NOPRINT BY SEG NOPRINT 
BY TICKET_NMBR NOPRINT BY TKT_NUM NOPRINT BY TYPE AS 'TKT,TYPE' 
 
ON CC_NUM PAGE-BREAK
ON CC_NUM SUMMARIZE AS 'TOTAL FOR'

ON XPSNGR_NM RECOMPUTE MULTILINES AS 'TOTAL FOR'
ON FLAGA SKIP-LINE
ON TSORT SKIP-LINE 
-GOTO FOOTER

-Checknext
-IF '&&SETF.EVAL' NE 'ABACHCC2' THEN GOTO Checknext2;
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXACH'; 
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&DTSTY;

-INCLUDE getLVLtitle

TABLE FILE HOLDE
HEADING
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</1"
-NOSPC;
PRINT 
LEVEL1 &LV1
LEVEL2 &LV2
LEVEL3 &LV3
TRAN_DATE AS 'TRAN,DATE' TICKET_NMBR AS  'TICKET,NUMBER'
 NAME/A18 AS 'NAME' DATE AS 'DATE'
CITY1/A17 AS 'ORG' CITY2/A17 AS 'DST'
GAMOUNT AS 'AMOUNT'
FEE AS 'AIRLN,FEE'
COUNT1 AS 'TKT,CNT'
COUNT2 AS 'CAR,DAYS'
COUNT3 AS 'HTL,NTS'
COUNT4 AS 'LIMO,DAYS'

BY LEVEL_DESC NOPRINT BY CC_NUM AS 'CREDIT,CARD'
BY XPSNGR_NM AS  'PASSENGER,NAME'   BY TRAN_DATE NOPRINT 
BY PNR_LOCATOR AS ' PNR'  BY FLAGA AS  'TRAN,TYPE' 
BY TSORT NOPRINT BY DATE NOPRINT BY SEG NOPRINT 
BY TICKET_NMBR NOPRINT BY TKT_NUM NOPRINT BY TYPE AS 'TKT,TYPE' 
 
ON CC_NUM PAGE-BREAK
ON CC_NUM SUMMARIZE AS 'TOTAL FOR'
ON XPSNGR_NM RECOMPUTE MULTILINES AS 'TOTAL FOR'
ON FLAGA SKIP-LINE
ON TSORT SKIP-LINE
ON TABLE NOTOTAL

-GOTO FOOTER


-Checknext2

-*new code
-IF &&SETF.EVAL NE 'TZACHDCC' THEN GOTO Checknext3;
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXACH'; 
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&DTSTY;

-INCLUDE getLVLtitle
TABLE FILE HOLDE
HEADING
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</1"
-NOSPC;
PRINT 
LEVEL1 &LV1
LEVEL2 &LV2
LEVEL3 &LV3
TRAN_DATE AS 'TRAN,DATE' TICKET_NMBR AS  'TICKET,NUMBER'
 NAME/A18 AS 'NAME' DATE AS 'DATE'
CITY1/A17 AS 'ORG' CITY2/A17 AS 'DST'
GAMOUNT AS 'AMOUNT'
FEE AS 'AIRLN,FEE'
COUNT1 AS 'TKT,CNT
COUNT2 AS 'CAR,DAYS'
COUNT3 AS 'HTL,NTS'
COUNT4 AS 'LIMO,DAYS'
BY LEVEL_DESC NOPRINT BY CCNUM2 NOPRINT

BY XPSNGR_NM AS  'PASSENGER,NAME'   BY TRAN_DATE NOPRINT 
BY PNR_LOCATOR AS ' PNR'  BY FLAGA AS  'TRAN,TYPE' 
BY TSORT NOPRINT BY DATE NOPRINT BY SEG NOPRINT 
BY TICKET_NMBR NOPRINT BY TKT_NUM NOPRINT BY TYPE AS 'TKT,TYPE' 
 
ON CCNUM2 PAGE-BREAK
ON CCNUM2 SUMMARIZE AS 'TOTAL FOR'

ON XPSNGR_NM RECOMPUTE MULTILINES AS 'TOTAL FOR'
ON FLAGA SKIP-LINE
ON TSORT SKIP-LINE 
-GOTO FOOTER

-Checknext3


-KOHLS
-IF '&&SETF.EVAL' NE 'KOACH' THEN GOTO Checknext4;
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXACH'; 
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&DTSTY;

TABLE FILE AIRHOLD
SUM FDATE FARE_PAID AS 'AMTA' NET_TKT_CNT AS 'ACNT' NEW_SEG_MILES AS 'AMILES'
BY PASSNGR_NAME
BY LEVEL2
BY PNR_LOCATOR
BY TKT_NUM
BY DST_APC
BY C_ITIN
ON TABLE HOLD AS AIRH
END
-RUN

DEFINE FILE HTLHOLD
RES_ST/A1 = EDIT(RESV_STATUS, '9');
END
TABLE FILE HTLHOLD
PRINT NEW_TOTAL_AMT AS 'HAMT' HBOOK TTL_COUNT AS 'HCNT'
BY PASSNGR_NAME
BY LEVEL2
BY PNR_LOCATOR
BY TKT_NUM
BY HDATE
BY RES_ST
ON TABLE HOLD AS HTLHA
END
-RUN


TABLE FILE HTLHA
SUM HAMT HBOOK HCNT
BY PASSNGR_NAME
BY PNR_LOCATOR
BY RES_ST
ON TABLE HOLD AS HTLHA2
END
-RUN

TABLE FILE HTLHA2
SUM HAMT HBOOK HCNT HBOOK AS 'HPNRBK'
BY PASSNGR_NAME
BY PNR_LOCATOR
WHERE HBOOK GT 0
ON TABLE HOLD AS HPNR
END
-RUN

MATCH FILE HTLHA
SUM TKT_NUM HDATE PASSNGR_NAME LEVEL2 
BY PNR_LOCATOR
ON TABLE HOLD 
RUN
FILE HPNR
SUM HAMT HBOOK HCNT HPNRBK
BY PNR_LOCATOR
AFTER MATCH HOLD AS HTLH OLD-AND-NEW
END
-RUN


DEFINE FILE CARHOLD
RES_ST/A1 = EDIT(RESV_STATUS, '9');
END
-RUN
TABLE FILE CARHOLD
SUM NEW_RENTAL_AMT AS 'CAMT' CBOOK TTL_COUNT AS 'CCNT'
BY PASSNGR_NAME
BY LEVEL2
BY PNR_LOCATOR
BY TKT_NUM
BY CDATE
BY RES_ST
ON TABLE HOLD AS CARHA
END
-RUN


TABLE FILE CARHA
SUM CAMT CBOOK CCNT 
BY PASSNGR_NAME
BY PNR_LOCATOR
BY RES_ST
ON TABLE HOLD AS CPNR1
END
-RUN

TABLE FILE CPNR1
SUM CAMT CBOOK CCNT CBOOK AS 'CPNRBK'
BY PASSNGR_NAME
BY PNR_LOCATOR
WHERE CBOOK GT 0
ON TABLE HOLD AS CPNR
END
-RUN


MATCH FILE CARHA
SUM CDATE PASSNGR_NAME LEVEL2 TKT_NUM
BY PNR_LOCATOR
ON TABLE HOLD
RUN
FILE CPNR
SUM CAMT CBOOK CCNT CPNRBK
BY PNR_LOCATOR
AFTER MATCH HOLD AS CARH OLD-AND-NEW
END
-RUN



MATCH FILE AIRH
PRINT FDATE AMTA ACNT DST_APC C_ITIN AMILES
BY PASSNGR_NAME
BY LEVEL2
BY PNR_LOCATOR
BY TKT_NUM
ON TABLE HOLD
RUN
FILE HTLH
SUM HDATE HAMT HBOOK HCNT HPNRBK
BY PASSNGR_NAME
BY LEVEL2
BY PNR_LOCATOR
BY TKT_NUM
AFTER MATCH HOLD AS AHH1 OLD-OR-NEW
END
-RUN

DEFINE FILE AHH1
DATE/MDYY = IF FDATE EQ ' ' THEN HDATE ELSE FDATE;
END
-RUN
TABLE FILE AHH1
PRINT DATE AMTA ACNT DST_APC C_ITIN AMILES HAMT HBOOK HCNT HPNRBK
BY PASSNGR_NAME
BY LEVEL2
BY PNR_LOCATOR
BY TKT_NUM
ON TABLE HOLD AS AHH
END
-RUN


MATCH FILE AHH
PRINT DATE AMTA ACNT DST_APC C_ITIN AMILES HAMT HBOOK HCNT HPNRBK
BY PASSNGR_NAME
BY LEVEL2
BY PNR_LOCATOR
BY TKT_NUM
ON TABLE HOLD
RUN
FILE CARH
SUM CDATE CAMT CBOOK CCNT CPNRBK
BY PASSNGR_NAME
BY LEVEL2
BY PNR_LOCATOR
BY TKT_NUM
AFTER MATCH HOLD AS AHCH OLD-OR-NEW
END
-RUN


-SET &&RPTSUF = 'DTL';
-INCLUDE FDEFRPTS
-RUN


DEFINE FILE AHCH
DATE1/MDYY = IF DATE EQ ' ' THEN CDATE ELSE DATE;
NOWTOD/A8 WITH TKT_NUM = HHMMSS (NOWTOD);
END
-RUN
TABLE FILE AHCH
HEADING
-INCLUDE &&PAHDR
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</1"
-NOSPC;
SUM PASSNGR_NAME AS 'Traveler Name'
DATE1 AS 'Travel,Start,Date'
DST_APC AS 'Destination,Airport'
LEVEL2 AS 'Customer,Defined 20'
C_ITIN AS 'Itinerary'
ACNT AS 'Air/Rail,Net tickets'
AMTA AS 'Air/Rail,Net Ticket,Amount'
COMPUTE ATP/D12.2 = AMTA/ACNT; AS 'Air/Rail,Average,Ticket Price'
HAMT AS 'Hotel,Amount'  
COMPUTE ANR/D12.2 = HAMT/HCNT; AS 'Hotel Avg,Room Rate'
HBOOK AS 'Hotel,Bookings' 
HPNRBK AS 'Hotel,PNRS'
CAMT AS 'Car,Amount'
COMPUTE ADR/D12.2 = CAMT/CCNT; AS 'Car Avg,Daily Rate'
CBOOK AS 'Car,Bookings'
CPNRBK AS 'Car,PNRS'
AMILES AS 'Air/Rail,Miles'
BY PASSNGR_NAME NOPRINT
BY DATE1 NOPRINT
BY DST_APC NOPRINT
BY LEVEL2 NOPRINT
BY C_ITIN NOPRINT
FOOTING BOTTOM
-INCLUDE FOOTERDT
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *
-INCLUDE GLOBAL_LOGO

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.050000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
    
TYPE=REPORT, FONT='ARIAL', SIZE=8, BACKCOLOR=NONE, STYLE=NORMAL, $
-* TYPE=HEADING, LINE=9,  SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
-* TYPE=HEADING, LINE=10, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
-* TYPE=HEADING, LINE=11, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
-* TYPE=HEADING, LINE=12, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
-* TYPE=SUBHEAD, SIZE=7, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$
TYPE=HEADING, SIZE=9, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$
TYPE=HEADING, LINE=10, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=11, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $
TYPE=HEADING, LINE=12, SIZE=10, JUSTIFY=LEFT, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),  $

TYPE=SUBHEAD, SIZE=7, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(70 136 177),$

TYPE=FOOTING, SIZE=7, FONT='ARIAL', COLOR=RGB(70 136 177), $
TYPE=TABFOOTING, SIZE=7, FONT='ARIAL', COLOR=RGB(70 136 177),$

TYPE=TITLE, COLOR=WHITE, BACKCOLOR=RGB(70 136 177), JUSTIFY=LEFT, STYLE=BOLD, $
TYPE=DATA, JUSTIFY=LEFT, $
TYPE=REPORT, COLUMN=N7, SQUEEZE=.70, $
TYPE=REPORT, COLUMN=N8, SQUEEZE=.70, $
TYPE=REPORT, COLUMN=N9, SQUEEZE=.70, $
TYPE=REPORT, COLUMN=N11, SQUEEZE=.90, $
TYPE=REPORT, COLUMN=N12, SQUEEZE=.90, $
TYPE=REPORT, COLUMN=N13, SQUEEZE=.90, $
TYPE=REPORT, COLUMN=N14, SQUEEZE=.90, $
TYPE=REPORT, COLUMN=N15, SQUEEZE=.60, $
TYPE=REPORT, COLUMN=N16, SQUEEZE=.60, $
TYPE=REPORT, COLUMN=N17, SQUEEZE=.60, $
TYPE=REPORT, COLUMN=N18, SQUEEZE=.60, $
TYPE=REPORT, COLUMN=N19, SQUEEZE=.60, $
TYPE=REPORT, COLUMN=N20, SQUEEZE=.60, $
TYPE=REPORT, COLUMN=N21, SQUEEZE=.60, $
TYPE=REPORT, COLUMN=N22, SQUEEZE=.60, $

TYPE=SUBTOTAL, SIZE=7, STYLE=BOLD, $
TYPE=GRANDTOTAL, SIZE=7, STYLE=BOLD, $
TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0.2), SIZE=(2.8 .37),PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.0), SIZE=(10.5 .58), PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&TNTDTPOS), SIZE=(&&ROLDTSIZ), $
-* TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(&&TNTDTPOS), SIZE=(&&TNTDTSIZ), $
-* TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLDTPOS), SIZE=(&&ROLDTSIZ), $
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
-GOTO xxit


-*end of new code

-Checknext4


-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXACH'; 
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&DTSTY;

-IF '&&SETF.EVAL' EQ 'KNGNACHS' GOTO KNOT;
-IF '&&SETF.EVAL' EQ 'SLACHD' AND '&&ROLLUP.EVAL' EQ 'ALL-R' THEN GOTO ALLrpt;
-IF '&&SETF.EVAL' EQ 'SLACHD' AND '&&ROLLUP.EVAL' EQ 'IVAF-R' THEN GOTO IVrpt;

-IF '&&SETF.EVAL' NE 'SLACHD' THEN GOTO Report;
-INCLUDE getLVLtitle

 
TABLE FILE HOLDE
HEADING
-INCLUDE &&PAHDR

"&&SUBHEAD"

-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</1"
-NOSPC;
PRINT 

TRAN_DATE AS 'TRAN,DATE' TICKET_NMBR AS  'TICKET,NUMBER'
 NAME/A18 AS 'NAME' DATE AS 'DATE'
CITY1/A17 AS 'ORG' CITY2/A17 AS 'DST'
CLASS AS 'CLS,OF,SVC' 
GAMOUNT AS 'AMOUNT'
FEE AS 'AIRLN,FEE'
LOW_AMT AS 'LOW,FARE'
LOST_AM AS 'LOST,SVGS'
VASAV AS 'CONTRACT,SAVINGS'
COUNT1 AS 'TKT,CNT'
COUNT2 AS 'CAR,DAYS'
COUNT3 AS 'HTL,NTS'
COUNT4 AS 'LIM,DAYS'
BY LEVEL_DESC NOPRINT
BY LEVEL1 &LV1
BY LEVEL2 &LV2
BY LEVEL3 &LV3
BY LEVEL4 &LV4
BY XPSNGR_NM AS  'PASSENGER,NAME'   BY TRAN_DATE NOPRINT 
BY PNR_LOCATOR AS ' PNR'  BY FLAGA AS  'TRAN,TYPE' 
BY REFUSE_CODE AS 'RSN,CD'
BY TSORT NOPRINT BY DATE NOPRINT BY SEG NOPRINT 
BY TICKET_NMBR NOPRINT BY TKT_NUM NOPRINT BY TYPE AS 'TKT,TYPE' 
ON LEVEL1 RECOMPUTE MULTILINES AS 'TOTAL FOR'
ON LEVEL2 RECOMPUTE MULTILINES AS 'TOTAL FOR'
ON TABLE COLUMN-TOTAL
ON FLAGA SKIP-LINE
ON TSORT SKIP-LINE 
-GOTO FOOTER

-KNOT;


 
TABLE FILE HOLDE
HEADING
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</1"
-NOSPC;
PRINT 

TRAN_DATE AS 'TRAN,DATE' TICKET_NMBR AS  'TICKET,NUMBER'
NEW_ADV_PURCH AS 'ADV,PURCH,DAYS' 
NAME/A18 AS 'NAME' DATE AS 'DATE'
CITY1/A17 AS 'ORG' CITY2/A17 AS 'DST'
CLASS AS 'CLS,OF,SVC' 
CLASS_CAT AS 'CLASS,CAT'
GAMOUNT AS 'AMOUNT'
FEE AS 'AIRLN,FEE'
LOW_AMT AS 'LOW,FARE'
LOST_AM AS 'LOST,SVGS'
VASAV AS 'CONTRACT,SAVINGS'
COUNT1 AS 'TKT,CNT'
COUNT2 AS 'CAR,DAYS'
COUNT3 AS 'HTL,NTS'
COUNT4 AS 'LIM,DAYS'
BY LEVEL_DESC NOPRINT
BY XPSNGR_NM AS  'PASSENGER,NAME' 
BY LEVEL4 AS 'REASON,FOR,TRAVEL'
BY TRAN_DATE NOPRINT 
BY PNR_LOCATOR AS ' PNR'  BY FLAGA AS  'TRAN,TYPE' 
BY REFUSE_CODE AS 'RSN,CD' 
BY TSORT NOPRINT BY DATE NOPRINT BY SEG NOPRINT 
BY TICKET_NMBR NOPRINT BY TKT_NUM NOPRINT BY TYPE AS 'TKT,TYPE' 
ON LEVEL_DESC RECOMPUTE GAMOUNT FEE LOW_AMT LOST_AM VASAV COUNT1 COUNT2 COUNT3 COUNT4 AS 'TOTAL FOR'
 

-GOTO FOOTER


-ALLrpt
 
 
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXACH'; 
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&DTSTY;

-INCLUDE getLVLtitle

TABLE FILE HOLDE
HEADING
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</1"
-NOSPC;
PRINT 

TRAN_DATE AS 'TRAN,DATE' TICKET_NMBR AS  'TICKET,NUMBER'
 NAME/A18 AS 'NAME' DATE AS 'DATE'
CITY1/A17 AS 'ORG' CITY2/A17 AS 'DST'
CLASS AS 'CLS,OF,SVC' 
GAMOUNT AS 'AMOUNT'
FEE AS 'AIRLN,FEE'
LOW_AMT AS 'LOW,FARE'
LOST_AM AS 'LOST,SVGS'
VASAV AS 'CONTRACT,SAVINGS'
COUNT1 AS 'TKT,CNT'
COUNT2 AS 'CAR,DAYS'
COUNT3 AS 'HTL,NTS'
COUNT4 AS 'LIM,DAYS'
BY LEVEL_DESC NOPRINT

BY XPSNGR_NM AS  'PASSENGER,NAME'   BY TRAN_DATE NOPRINT 
BY LEVEL1 &LV1
BY LEVEL2 &LV2
BY LEVEL3 &LV3
BY LEVEL4 &LV4
BY PNR_LOCATOR AS ' PNR'  BY FLAGA AS  'TRAN,TYPE' 
BY REFUSE_CODE AS 'RSN,CD'
BY TSORT NOPRINT BY DATE NOPRINT BY SEG NOPRINT 
BY TICKET_NMBR NOPRINT BY TKT_NUM NOPRINT BY TYPE AS 'TKT,TYPE' 
ON TABLE COLUMN-TOTAL
ON FLAGA SKIP-LINE
ON TSORT SKIP-LINE 


-GOTO FOOTER


-IVrpt
 
 

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXACH'; 
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&DTSTY;

-INCLUDE getLVLtitle

TABLE FILE HOLDE
HEADING
-INCLUDE &&PAHDR
 -IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</1"
-NOSPC;
PRINT 

TRAN_DATE AS 'TRAN,DATE' TICKET_NMBR AS  'TICKET,NUMBER'
 NAME/A18 AS 'NAME' DATE AS 'DATE'
CITY1/A17 AS 'ORG' CITY2/A17 AS 'DST'
CLASS AS 'CLS,OF,SVC' 
GAMOUNT AS 'AMOUNT'
FEE AS 'AIRLN,FEE'
COUNT1 AS 'TKT,CNT'
COUNT2 AS 'CAR,DAYS'
COUNT3 AS 'HTL,NTS'
COUNT4 AS 'LIM,DAYS'
BY LEVEL2 NOPRINT
BY LEVEL_DESC NOPRINT

BY XPSNGR_NM AS  'PASSENGER,NAME'   BY TRAN_DATE NOPRINT 
BY LEVEL1 &LV1
BY LEVEL2 &LV2
BY LEVEL3 &LV3
BY LEVEL4 &LV4
BY PNR_LOCATOR AS ' PNR'  BY FLAGA AS  'TRAN,TYPE' 
BY REFUSE_CODE AS 'RSN,CD'
BY TSORT NOPRINT BY DATE NOPRINT BY SEG NOPRINT 
BY TICKET_NMBR NOPRINT BY TKT_NUM NOPRINT BY TYPE AS 'TKT,TYPE' 
ON LEVEL2 RECOMPUTE  AS 'TOTAL FOR'

ON FLAGA SKIP-LINE
ON TSORT SKIP-LINE 
 


-GOTO FOOTER

-PROGR

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXACH'; 
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&DTSTY;

DEFINE FILE HOLDA
TN/A1 = EDIT(TKTN, '9');
-* AFLAG/A1 = IF FLAG EQ 'A' AND TKTN EQ '0000000000' THEN 'N' ELSE 'Y';
TKTA/A10 = IF FLAG EQ 'A' AND TKTN EQ '0000000000' THEN TKT_NUM ELSE TKTN;
-*           IF FLAG EQ 'A' AND TN EQ '0' THEN TKT_NUM ELSE TKTN;
END
TABLE FILE HOLDA
PRINT AR_BRANCH LEVEL2 CC_NUM NAME2 PASSNGR_NAME TRAN_DATE GAMOUNT BR_CL_IDX INVOICE_NUM LEVEL_DESC FLAG TKTA TTL_COUNT AMOUNT TKT_NUM
      NAMEC LEVEL1 TSORT RESV_STATUS PNR_LOCATOR DATE SEG TYPE  
-INCLUDE BYHIERARCHY 
BY TKT_NUM
-* WHERE AFLAG EQ 'Y'
ON TABLE HOLD AS HOLDEA
END
-RUN


TABLE FILE HOLDEA
PRINT TKTA AS 'TKTNA'
-* BY PNR_LOCATOR
BY TKT_NUM
WHERE FLAG EQ 'A' OR 'V'
ON TABLE HOLD AS AHLD
END
-RUN


TABLE FILE HOLDEA
PRINT AR_BRANCH LEVEL2 CC_NUM NAME2 PASSNGR_NAME TRAN_DATE GAMOUNT BR_CL_IDX INVOICE_NUM LEVEL_DESC FLAG TKTA TTL_COUNT AMOUNT TKT_NUM
      NAMEC LEVEL1 TSORT RESV_STATUS DATE SEG TYPE  
BY PNR_LOCATOR
ON TABLE HOLD AS THLD
END

MATCH FILE THLD
PRINT AR_BRANCH LEVEL2 CC_NUM NAME2 PASSNGR_NAME TRAN_DATE GAMOUNT BR_CL_IDX INVOICE_NUM LEVEL_DESC FLAG TKTA TTL_COUNT AMOUNT TKT_NUM
      NAMEC LEVEL1 TSORT RESV_STATUS PNR_LOCATOR DATE SEG TYPE  
BY TKT_NUM
ON TABLE HOLD
RUN
FILE AHLD
SUM TKTNA
BY TKT_NUM
AFTER MATCH HOLD AS HOLDE OLD-OR-NEW
END


DEFINE FILE HOLDE
COUNT1/D12CS = IF (FLAG EQ 'A') THEN TTL_COUNT ELSE 0;
COUNT2/D12CS = IF (FLAG EQ 'C') THEN TTL_COUNT ELSE 0;
COUNT3/D12CS = IF (FLAG EQ 'H') THEN TTL_COUNT ELSE 0;
COUNT4/D12CS = IF (FLAG EQ 'L') THEN TTL_COUNT ELSE 0;
AMT1/D12.2CS = IF (FLAG EQ 'A') THEN AMOUNT ELSE 0;
AMT2/D12.2CS = IF (FLAG EQ 'C') THEN AMOUNT ELSE 0;
AMT3/D12.2CS = IF (FLAG EQ 'H') THEN AMOUNT ELSE 0;
AMT4/D12.2CS = IF (FLAG EQ 'L') THEN AMOUNT ELSE 0;
FLAGA/A5 = DECODE FLAG ('A' 'AIR'   'C' 'CAR'  'H' 'HTL' 'L' 'LIM' 'V' 'VOID');                         
XPSNGR_NM/A15        = 
    EDIT(PASSNGR_NAME,'999999999999999$$$$$$$$$$$$$$$$$$');
TICKET_NMBR/A10 = IF (TKT_NUM EQ '0000000000') THEN ' ' ELSE  TKT_NUM;
TKTN1/A10 = IF (TKT_NUM EQ '0000000000') THEN ' ' ELSE TKT_NUM;
TKTN2/A10 = IF TKTN1 EQ ' ' THEN ' ' ELSE TKTN1;
TKTNPG1/A10 = IF (TKTNA EQ ' ') THEN TKTA ELSE TKTNA;
-* TKTNPG1/A10 = IF TKTNPG EQ ' ' THEN ' ' ELSE TKTNPG;                  

-* CUR_DESC/A95 = LEVEL_DESC||'-'||NAMEC;
CUR_DESC/A50 = NAMEC;
  
                 
-*DEFINES ON PREVIOUS DEFINES 
PASNGR_NAME/A15 = IF TKT_NUM NE LAST TKT_NUM THEN XPSNGR_NM ELSE ' ';
LVL1/A15 = IF TKT_NUM NE LAST TKT_NUM THEN LEVEL1 ELSE ' ';
TRAN_MYA/I6MTYY = TRAN_DATE;
NOWTOD/A8 WITH TKTA = HHMMSS (NOWTOD);
-* ITIN/A67 = IF SEG EQ '01' THEN C_ITIN ELSE ' ';
-INCLUDE DefineSubtotalFields  
END





-* -GOTO FOOTER

-Report


TABLE FILE HOLDE
-INCLUDE &&PAHDR
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</1"
-NOSPC;
-*"&&SUBHEAD"
"</2"
-*
-**********************************************************************
-* Print statement with fields passed from the user profile database
-**********************************************************************
-*
&&PRINT1
&&PRINT2
&&PRINT3
&&PRINT4
&&PRINT5
&&PRINT6
&&PRINT7
&&PRINT8
&&PRINT9
&&PRINT10

-*
-**********************************************************************
-* By statements (one per field)
-**********************************************************************
-*
-IF &&MULTIBREAK NE 'Y' OR &&ALTHIER NE 'Y' THEN GOTO :NOMULTBREAK;
-INCLUDE LevelNOPRINT
-:NOMULTBREAK
&&BY1
&&BY2
&&BY3
&&BY4
&&BY5
&&BY6
&&BY7
&&BY8
&&BY9
&&BY10
-*
-*********************************************************************
-*DATE           NAME               DESCRIPTION 
-*8/18/00      IBISTL-KR            INCLUDE WHERE STATEMENTS WHEN
-*                                  DRILLED_RUN EQ 'Y'.
-*********************************************************************
-*
-**********************************************************************
-* Where statements for Drilled Report
-**********************************************************************
-*

-IF &&DRILLED_RUN EQ 'N' GOTO SKIP_WHR;
-INCLUDE &&DRILLWHR
-SKIP_WHR
-*
-**********************************************************************
-* On Table statements for code appropriate to On Table commands
-**********************************************************************
-*
-IF &&MULTIBREAK NE 'Y' OR &&ALTHIER NE 'Y' THEN GOTO :NOMULTOTAL;

-INCLUDE TOTALBYHIERARCHY
-GOTO SKIPBREAKOPT;
-:NOMULTOTAL
&&BREAKOPTION
&&ONTABLE1
&&ONTABLE2
&&ONTABLE3
-SKIPBREAKOPT
&&ONTABLE4
&&ONTABLE5
&&ONTABLE6
&&ONTABLE7
&&ONTABLE8
&&ONTABLE9
&&ONTABLE10
 

-FOOTER 
FOOTING BOTTOM
-*
-**********************************************************************
-* Report specific footer(s)
-**********************************************************************
-*
-INCLUDE FOOTERDT
-*
-*ON TABLE SET STYLE &&DTSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**************************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *

-IF '&&SETF.EVAL' EQ 'BZACHDCC' AND '&&OUTFMT' EQ 'EXL2K' THEN GOTO BOOZ;
-IF &&CURRENCY EQ 'TRL' THEN GOTO SMALLER;
-INCLUDE &&PASTYD
-* -INCLUDE &&SMSTY
-GOTO FINFONT;
-SMALLER
-INCLUDE DT7
-FINFONT


-* -INCLUDE &&DTSTY
ENDSTYLE
-*
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
-GOTO xxit;


-BOOZ
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=7, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=REPORT, WRAP=1,$
TYPE=REPORT, COLUMN=&RL1,  WRAP= 1.5,$
TYPE=REPORT, COLUMN=&RL2,  WRAP= .60,$
TYPE=REPORT, COLUMN=&RL3,  WRAP= .50,$
TYPE=REPORT, COLUMN=&RL4,  WRAP= .50,$
TYPE=REPORT, COLUMN=&RL5,  WRAP= .65,$
TYPE=REPORT, COLUMN=&RL6,  WRAP= .65,$
TYPE=REPORT, COLUMN=&RL7,  WRAP= 1.75,$
TYPE=REPORT, COLUMN=&RL8,  WRAP= 1.25,$
TYPE=REPORT, COLUMN=&RL9,  WRAP= .65,$
TYPE=REPORT, COLUMN=&RL10, WRAP= 1.15,$
TYPE=REPORT, COLUMN=&RL11, WRAP= 1.15,$
TYPE=REPORT, COLUMN=&RL12, WRAP= 1.0,$
TYPE=REPORT, COLUMN=&RL13, WRAP= .65,$
TYPE=REPORT, COLUMN=&RL14, WRAP= .65,$
TYPE=REPORT, COLUMN=&RL15, WRAP= .65,$
TYPE=REPORT, COLUMN=&RL16, WRAP= .65,$


TYPE=HEADING, LINE=4, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=5, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=6, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=7, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=8, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=10, SIZE=9, STYLE=BOLD, COLOR=GREY, $
TYPE=HEADING, LINE=11, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=12, SIZE=12, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $
TYPE=HEADING, LINE=13, SIZE=10, STYLE=BOLD+ITALIC, FONT=COURIER NEW, $

TYPE=FOOTING, SIZE=7, STYLE=BOLD, COLOR=GREY, $
TYPE=TITLE, STYLE=BOLD, $
TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD,$
-*TYPE=SUBTOTAL, SIZE=8, STYLE=BOLD, N=10, BACKCOLOR=RGB(128 255 255),$
TYPE=GRANDTOTAL, SIZE=8, STYLE=BOLD,$
TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(&&TNTDTPOS), SIZE=(&&TNTDTSIZ), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLDTPOS), SIZE=(&&ROLDTSIZ), $

ENDSTYLE

&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN







-xxit
