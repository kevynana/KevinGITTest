-******************************************************************************
-* The date fields in BRPTINST should not be altered in any way.  However,
-* the global date variables should be changed based on the specific report.
-* Date:  03/13/2006
-******************************************************************************
-INCLUDE SETECHO

DEFINE FILE BRPTINST
  XCYFMDT/YYMD = CYFM_DATE;
  XPYTODT/YYMD = DATEADD(CYFMDT,'D',-1);
  XPYTODT2/MDYY = XPYTODT;
END 



DEFINE FILE BRPTINST
  IQTR/I1 = IF CYFM_DATE EQ FM_DATE THEN 1
    ELSE IF DATEADD(CYFM_DATE,'M',3) EQ FM_DATE THEN 2
    ELSE IF DATEADD(CYFM_DATE,'M',6) EQ FM_DATE THEN 3 ELSE 4;
  
  XFM_DATE/YYMD = FM_DATE;
  XTO_DATE/YYMD = TO_DATE;
  XFXDATE/YYMD = FXDATE;
  XTXDATE/YYMD = TXDATE;
  XCMFM_DATE/YYMD = CMFM_DATE;
  XCMTO_DATE/YYMD = CMTO_DATE;
  XPMFM_DATE/YYMD = PMFM_DATE;
  XPMTO_DATE/YYMD = PMTO_DATE;
  XCYFM_DATE/YYMD = CYFM_DATE;
  XCYTO_DATE/YYMD = CYTO_DATE;
  XPYFM_DATE/YYMD = PYFM_DATE;
-*  XPYTO_DATE/YYMD = PYTO_DATE;

-*Change to 4 quarters in the prior year  
  PYTD_DATA/YYMD = PYTO_DATE;
  XPYTO_DATE/YYMD = DATEADD(CYFMDT,'D',-1);
  
END 

TABLE FILE BRPTINST
PRINT 
XFM_DATE
XTO_DATE
XFXDATE
XTXDATE
XCMFM_DATE
XCMTO_DATE
XPMFM_DATE
XPMTO_DATE
XCYFM_DATE
XCYTO_DATE
XPYFM_DATE
XPYTO_DATE
PYTD_DATA IQTR
WHERE INST_KEY EQ &&IKEY
ON TABLE SAVE
END
-RUN
-READ SAVE &&FROMDT.8. &&TODT.8. &&FXDATE.8. &&TXDATE.8. ,
- &&CMFMDT.8. &&CMTODT.8 &&PMFMDT.8. &&PMTODT.8. ,
- &&CYFMDT.8. &&CYTODT.8. &&PYFMDT.8. &&PYTODT.8. &&PYTDDATE.8. &&IQTR.1.
-SET &&FROMDT = EDIT('&&FROMDT.EVAL', '9999/99/99');
-SET &&TODT   = EDIT('&&TODT.EVAL', '9999/99/99');
-SET &&CMFMDT = EDIT('&&CMFMDT.EVAL', '9999/99/99');
-SET &&CMTODT = EDIT('&&CMTODT.EVAL', '9999/99/99');

-SET &&PMFMDT = EDIT('&&PMFMDT.EVAL', '9999/99/99');
-SET &&PMTODT = EDIT('&&PMTODT.EVAL', '9999/99/99');
-SET &&CYFMDT = EDIT('&&CYFMDT.EVAL', '9999/99/99');
-SET &&CYTODT = EDIT('&&CYTODT.EVAL', '9999/99/99');

-SET &&PYFMDT = EDIT('&&PYFMDT.EVAL', '9999/99/99');
-SET &&PYTODT = EDIT('&&PYTODT.EVAL', '9999/99/99');
-SET &&FXDATE = EDIT('&&FXDATE.EVAL', '9999/99/99');
-SET &&TXDATE = EDIT('&&TXDATE.EVAL', '9999/99/99');

-SET &&PYTDDATE = EDIT('&&PYTDDATE.EVAL', '9999/99/99');

-*REFORMAT
-SET &&FROMDT = '&&FROMDT.EVAL';
-SET &&TODT   = '&&TODT.EVAL';
-SET &&CMFMDT = '&&CMFMDT.EVAL';
-SET &&CMTODT = '&&CMTODT.EVAL';

-SET &&PMFMDT = '&&PMFMDT.EVAL';
-SET &&PMTODT = '&&PMTODT.EVAL';
-SET &&CYFMDT = '&&CYFMDT.EVAL';
-SET &&CYTODT = '&&CYTODT.EVAL';

-SET &&PQFMDT = '&&PMFMDT.EVAL';
-SET &&PQTODT = '&&PMTODT.EVAL';
-SET &&CQFMDT = '&&CMFMDT.EVAL';
-SET &&CQTODT = '&&CMTODT.EVAL';

-SET &&PYFMDT = '&&PYFMDT.EVAL';
-SET &&PYTODT = '&&PYTODT.EVAL';
-SET &&FXDATE = '&&FXDATE.EVAL';
-SET &&TXDATE = '&&TXDATE.EVAL';

-SET &&PYTDDATE = '&&PYTDDATE.EVAL';

-SET &&CURRYR = EDIT('&&FROMDT.EVAL', '9999');
-SET &&TOYR = EDIT('&&PYTODT.EVAL', '9999');
-SET &&PYFMYR = EDIT('&&PYFMDT.EVAL', '9999');
