-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES1
-*==========================================================================
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL1 HDES1
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL1 NE ' '
ON TABLE HOLD AS PASS01 FORMAT FOCUS INDEX HSEL1
END
-IF &RECORDS EQ 0 GOTO STEP2;
-* JOIN CLEAR *
JOIN HSEL1 IN PASS01 TO ROLL_LEV IN HIERORG
TABLE FILE PASS01
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      HSEL1    AS 'HSEL1'
      DEPTNAME AS 'HDES1'
WHERE DEPTNAME NE HDES1
ON TABLE HOLD AS HOLD01
END
-IF &RECORDS EQ 0 GOTO STEP2;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD01
MATCH INST_KEY
ON MATCH UPDATE HDES1
ON NOMATCH REJECT
DATA ON HOLD01
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES2
-*==========================================================================
-STEP2
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL2 HDES2
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL2 NE ' '
ON TABLE HOLD AS PASS02 FORMAT FOCUS INDEX HSEL2
END
-IF &RECORDS EQ 0 GOTO STEP3;
JOIN HSEL2 IN PASS02 TO ROLL_LEV IN HIERORG
TABLE FILE PASS02
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL2'
      DEPTNAME AS 'HDES2'
WHERE DEPTNAME NE HDES2
ON TABLE HOLD AS HOLD02
END
-IF &RECORDS EQ 0 GOTO STEP3;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD02
MATCH INST_KEY
ON MATCH UPDATE HDES2
ON NOMATCH REJECT
DATA ON HOLD02
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES3
-*==========================================================================
-STEP3
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL3 HDES3
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL3 NE ' '
ON TABLE HOLD AS PASS03 FORMAT FOCUS INDEX HSEL3
END
-IF &RECORDS EQ 0 GOTO STEP4;
JOIN HSEL3 IN PASS03 TO ROLL_LEV IN HIERORG
TABLE FILE PASS03
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL3'
      DEPTNAME AS 'HDES3'
WHERE DEPTNAME NE HDES3
ON TABLE HOLD AS HOLD03
END
-IF &RECORDS EQ 0 GOTO STEP4;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD03
MATCH INST_KEY
ON MATCH UPDATE HDES3
ON NOMATCH REJECT
DATA ON HOLD03
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES4
-*==========================================================================
-STEP4
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL4 HDES4
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL4 NE ' '
ON TABLE HOLD AS PASS04 FORMAT FOCUS INDEX HSEL4
END
-IF &RECORDS EQ 0 GOTO STEP5;
JOIN HSEL4 IN PASS04 TO ROLL_LEV IN HIERORG
TABLE FILE PASS04
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL4'
      DEPTNAME AS 'HDES4'
WHERE DEPTNAME NE HDES4
ON TABLE HOLD AS HOLD04
END
-IF &RECORDS EQ 0 GOTO STEP5;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD04
MATCH INST_KEY
ON MATCH UPDATE HDES4
ON NOMATCH REJECT
DATA ON HOLD04
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES5
-*==========================================================================
-STEP5
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL5 HDES5
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL5 NE ' '
ON TABLE HOLD AS PASS05 FORMAT FOCUS INDEX HSEL5
END
-IF &RECORDS EQ 0 GOTO STEP6;
JOIN HSEL5 IN PASS05 TO ROLL_LEV IN HIERORG
TABLE FILE PASS05
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL5'
      DEPTNAME AS 'HDES5'
WHERE DEPTNAME NE HDES5
ON TABLE HOLD AS HOLD05
END
-IF &RECORDS EQ 0 GOTO STEP6;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD05
MATCH INST_KEY
ON MATCH UPDATE HDES5
ON NOMATCH REJECT
DATA ON HOLD05
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES6
-*==========================================================================
-STEP6
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL6 HDES6
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL6 NE ' '
ON TABLE HOLD AS PASS06 FORMAT FOCUS INDEX HSEL6
END
-IF &RECORDS EQ 0 GOTO STEP7;
JOIN HSEL6 IN PASS06 TO ROLL_LEV IN HIERORG
TABLE FILE PASS06
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL6'
      DEPTNAME AS 'HDES6'
WHERE DEPTNAME NE HDES6
ON TABLE HOLD AS HOLD06
END
-IF &RECORDS EQ 0 GOTO STEP7;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD06
MATCH INST_KEY
ON MATCH UPDATE HDES6
ON NOMATCH REJECT
DATA ON HOLD06
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES7
-*==========================================================================
-STEP7
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL7 HDES7
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL7 NE ' '
ON TABLE HOLD AS PASS07 FORMAT FOCUS INDEX HSEL7
END
-IF &RECORDS EQ 0 GOTO STEP8;
JOIN HSEL7 IN PASS07 TO ROLL_LEV IN HIERORG
TABLE FILE PASS07
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL7'
      DEPTNAME AS 'HDES7'
WHERE DEPTNAME NE HDES7
ON TABLE HOLD AS HOLD07
END
-IF &RECORDS EQ 0 GOTO STEP8;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD07
MATCH INST_KEY
ON MATCH UPDATE HDES7
ON NOMATCH REJECT
DATA ON HOLD07
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES8
-*==========================================================================
-STEP8
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL8 HDES8
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL8 NE ' '
ON TABLE HOLD AS PASS08 FORMAT FOCUS INDEX HSEL8
END
-IF &RECORDS EQ 0 GOTO STEP9;
JOIN HSEL8 IN PASS08 TO ROLL_LEV IN HIERORG
TABLE FILE PASS08
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL8'
      DEPTNAME AS 'HDES8'
WHERE DEPTNAME NE HDES8
ON TABLE HOLD AS HOLD08
END
-IF &RECORDS EQ 0 GOTO STEP9;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD08
MATCH INST_KEY
ON MATCH UPDATE HDES8
ON NOMATCH REJECT
DATA ON HOLD08
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES9
-*==========================================================================
-STEP9
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL9 HDES9
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL9 NE ' '
ON TABLE HOLD AS PASS09 FORMAT FOCUS INDEX HSEL9
END
-IF &RECORDS EQ 0 GOTO STEP10;
JOIN HSEL9 IN PASS09 TO ROLL_LEV IN HIERORG
TABLE FILE PASS09
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL9'
      DEPTNAME AS 'HDES9'
WHERE DEPTNAME NE HDES9
ON TABLE HOLD AS HOLD09
END
-IF &RECORDS EQ 0 GOTO STEP10;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD09
MATCH INST_KEY
ON MATCH UPDATE HDES9
ON NOMATCH REJECT
DATA ON HOLD09
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES10
-*==========================================================================
-STEP10
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL10 HDES10
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL10 NE ' '
ON TABLE HOLD AS PASS10 FORMAT FOCUS INDEX HSEL10
END
-IF &RECORDS EQ 0 GOTO STEP11;
JOIN HSEL10 IN PASS10 TO ROLL_LEV IN HIERORG
TABLE FILE PASS10
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL10'
      DEPTNAME AS 'HDES10'
WHERE DEPTNAME NE HDES10
ON TABLE HOLD AS HOLD10
END
-IF &RECORDS EQ 0 GOTO STEP11;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD10
MATCH INST_KEY
ON MATCH UPDATE HDES10
ON NOMATCH REJECT
DATA ON HOLD10
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES11
-*==========================================================================
-STEP11
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL11 HDES11
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL11 NE ' '
ON TABLE HOLD AS PASS11 FORMAT FOCUS INDEX HSEL11
END
-IF &RECORDS EQ 0 GOTO STEP12;
JOIN HSEL11 IN PASS11 TO ROLL_LEV IN HIERORG
TABLE FILE PASS11
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL11'
      DEPTNAME AS 'HDES11'
WHERE DEPTNAME NE HDES11
ON TABLE HOLD AS HOLD11
END
-IF &RECORDS EQ 0 GOTO STEP12;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD11
MATCH INST_KEY
ON MATCH UPDATE HDES11
ON NOMATCH REJECT
DATA ON HOLD11
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES12
-*==========================================================================
-STEP12
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL12 HDES12
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL12 NE ' '
ON TABLE HOLD AS PASS12 FORMAT FOCUS INDEX HSEL12
END
-IF &RECORDS EQ 0 GOTO STEP13;
JOIN HSEL12 IN PASS12 TO ROLL_LEV IN HIERORG
TABLE FILE PASS12
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL12'
      DEPTNAME AS 'HDES12'
WHERE DEPTNAME NE HDES12
ON TABLE HOLD AS HOLD12
END
-IF &RECORDS EQ 0 GOTO STEP13;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD12
MATCH INST_KEY
ON MATCH UPDATE HDES12
ON NOMATCH REJECT
DATA ON HOLD12
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES13
-*==========================================================================
-STEP13
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL13 HDES13
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL13 NE ' '
ON TABLE HOLD AS PASS13 FORMAT FOCUS INDEX HSEL13
END
-IF &RECORDS EQ 0 GOTO STEP14;
JOIN HSEL13 IN PASS13 TO ROLL_LEV IN HIERORG
TABLE FILE PASS13
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL13'
      DEPTNAME AS 'HDES13'
WHERE DEPTNAME NE HDES13
ON TABLE HOLD AS HOLD13
END
-IF &RECORDS EQ 0 GOTO STEP14;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD13
MATCH INST_KEY
ON MATCH UPDATE HDES13
ON NOMATCH REJECT
DATA ON HOLD13
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES14
-*==========================================================================
-STEP14
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL14 HDES14
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL14 NE ' '
ON TABLE HOLD AS PASS14 FORMAT FOCUS INDEX HSEL14
END
-IF &RECORDS EQ 0 GOTO STEP15;
JOIN HSEL14 IN PASS14 TO ROLL_LEV IN HIERORG
TABLE FILE PASS14
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL14'
      DEPTNAME AS 'HDES14'
WHERE DEPTNAME NE HDES14
ON TABLE HOLD AS HOLD14
END
-IF &RECORDS EQ 0 GOTO STEP15;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD14
MATCH INST_KEY
ON MATCH UPDATE HDES14
ON NOMATCH REJECT
DATA ON HOLD14
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES15
-*==========================================================================
-STEP15
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL15 HDES15
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL15 NE ' '
ON TABLE HOLD AS PASS15 FORMAT FOCUS INDEX HSEL15
END
-IF &RECORDS EQ 0 GOTO STEP16;
JOIN HSEL15 IN PASS15 TO ROLL_LEV IN HIERORG
TABLE FILE PASS15
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL15'
      DEPTNAME AS 'HDES15'
WHERE DEPTNAME NE HDES15
ON TABLE HOLD AS HOLD15
END
-IF &RECORDS EQ 0 GOTO STEP16;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD15
MATCH INST_KEY
ON MATCH UPDATE HDES15
ON NOMATCH REJECT
DATA ON HOLD15
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES16
-*==========================================================================
-STEP16
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL16 HDES16
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL16 NE ' '
ON TABLE HOLD AS PASS16 FORMAT FOCUS INDEX HSEL16
END
-IF &RECORDS EQ 0 GOTO STEP17;
JOIN HSEL16 IN PASS16 TO ROLL_LEV IN HIERORG
TABLE FILE PASS16
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL16'
      DEPTNAME AS 'HDES16'
WHERE DEPTNAME NE HDES16
ON TABLE HOLD AS HOLD16
END
-IF &RECORDS EQ 0 GOTO STEP17;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD16
MATCH INST_KEY
ON MATCH UPDATE HDES16
ON NOMATCH REJECT
DATA ON HOLD16
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES17
-*==========================================================================
-STEP17
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL17 HDES17
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL17 NE ' '
ON TABLE HOLD AS PASS17 FORMAT FOCUS INDEX HSEL17
END
-IF &RECORDS EQ 0 GOTO STEP18;
JOIN HSEL17 IN PASS17 TO ROLL_LEV IN HIERORG
TABLE FILE PASS17
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL17'
      DEPTNAME AS 'HDES17'
WHERE DEPTNAME NE HDES17
ON TABLE HOLD AS HOLD17
END
-IF &RECORDS EQ 0 GOTO STEP18;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD17
MATCH INST_KEY
ON MATCH UPDATE HDES17
ON NOMATCH REJECT
DATA ON HOLD17
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES18
-*==========================================================================
-STEP18
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL18 HDES18
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL18 NE ' '
ON TABLE HOLD AS PASS18 FORMAT FOCUS INDEX HSEL18
END
-IF &RECORDS EQ 0 GOTO STEP19;
JOIN HSEL18 IN PASS18 TO ROLL_LEV IN HIERORG
TABLE FILE PASS18
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL18'
      DEPTNAME AS 'HDES18'
WHERE DEPTNAME NE HDES18
ON TABLE HOLD AS HOLD18
END
-IF &RECORDS EQ 0 GOTO STEP19;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD18
MATCH INST_KEY
ON MATCH UPDATE HDES18
ON NOMATCH REJECT
DATA ON HOLD18
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES19
-*==========================================================================
-STEP19
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL19 HDES19
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL19 NE ' '
ON TABLE HOLD AS PASS19 FORMAT FOCUS INDEX HSEL19
END
-IF &RECORDS EQ 0 GOTO STEP20;
JOIN HSEL19 IN PASS19 TO ROLL_LEV IN HIERORG
TABLE FILE PASS19
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL19'
      DEPTNAME AS 'HDES19'
WHERE DEPTNAME NE HDES19
ON TABLE HOLD AS HOLD19
END
-IF &RECORDS EQ 0 GOTO STEP20;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD19
MATCH INST_KEY
ON MATCH UPDATE HDES19
ON NOMATCH REJECT
DATA ON HOLD19
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES20
-*==========================================================================
-STEP20
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL20 HDES20
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL20 NE ' '
ON TABLE HOLD AS PASS20 FORMAT FOCUS INDEX HSEL20
END
-IF &RECORDS EQ 0 GOTO STEP21;
JOIN HSEL20 IN PASS20 TO ROLL_LEV IN HIERORG
TABLE FILE PASS20
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL20'
      DEPTNAME AS 'HDES20'
WHERE DEPTNAME NE HDES20
ON TABLE HOLD AS HOLD20
END
-IF &RECORDS EQ 0 GOTO STEP21;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD20
MATCH INST_KEY
ON MATCH UPDATE HDES20
ON NOMATCH REJECT
DATA ON HOLD20
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES21
-*==========================================================================
-STEP21
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL21 HDES21
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL21 NE ' '
ON TABLE HOLD AS PASS21 FORMAT FOCUS INDEX HSEL21
END
-IF &RECORDS EQ 0 GOTO STEP22;
JOIN HSEL21 IN PASS21 TO ROLL_LEV IN HIERORG
TABLE FILE PASS21
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL21'
      DEPTNAME AS 'HDES21'
WHERE DEPTNAME NE HDES21
ON TABLE HOLD AS HOLD21
END
-IF &RECORDS EQ 0 GOTO STEP22;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD21
MATCH INST_KEY
ON MATCH UPDATE HDES21
ON NOMATCH REJECT
DATA ON HOLD21
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES22
-*==========================================================================
-STEP22
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL22 HDES22
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL22 NE ' '
ON TABLE HOLD AS PASS22 FORMAT FOCUS INDEX HSEL22
END
-IF &RECORDS EQ 0 GOTO STEP23;
JOIN HSEL22 IN PASS22 TO ROLL_LEV IN HIERORG
TABLE FILE PASS22
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL22'
      DEPTNAME AS 'HDES22'
WHERE DEPTNAME NE HDES22
ON TABLE HOLD AS HOLD22
END
-IF &RECORDS EQ 0 GOTO STEP23;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD22
MATCH INST_KEY
ON MATCH UPDATE HDES22
ON NOMATCH REJECT
DATA ON HOLD22
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES23
-*==========================================================================
-STEP23
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL23 HDES23
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL23 NE ' '
ON TABLE HOLD AS PASS23 FORMAT FOCUS INDEX HSEL23
END
-IF &RECORDS EQ 0 GOTO STEP24;
JOIN HSEL23 IN PASS23 TO ROLL_LEV IN HIERORG
TABLE FILE PASS23
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL23'
      DEPTNAME AS 'HDES23'
WHERE DEPTNAME NE HDES23
ON TABLE HOLD AS HOLD23
END
-IF &RECORDS EQ 0 GOTO STEP24;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD23
MATCH INST_KEY
ON MATCH UPDATE HDES23
ON NOMATCH REJECT
DATA ON HOLD23
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES24
-*==========================================================================
-STEP24
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL24 HDES24
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL24 NE ' '
ON TABLE HOLD AS PASS24 FORMAT FOCUS INDEX HSEL24
END
-IF &RECORDS EQ 0 GOTO STEP25;
JOIN HSEL24 IN PASS24 TO ROLL_LEV IN HIERORG
TABLE FILE PASS24
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL24'
      DEPTNAME AS 'HDES24'
WHERE DEPTNAME NE HDES24
ON TABLE HOLD AS HOLD24
END
-IF &RECORDS EQ 0 GOTO STEP25;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD24
MATCH INST_KEY
ON MATCH UPDATE HDES24
ON NOMATCH REJECT
DATA ON HOLD24
END
-*==========================================================================
-* CHECK/UPDATE I_SUMM DATABASE - FIELD = HDES25
-*==========================================================================
-STEP25
SET ASNAMES=ON
TABLE FILE I_SUMM
BY INST_KEY NOPRINT
PRINT INST_KEY HSEL25 HDES25
IF INST_KEY CONTAINS 'BIC-R'
IF HSEL25 NE ' '
ON TABLE HOLD AS PASS25 FORMAT FOCUS INDEX HSEL25
END
-IF &RECORDS EQ 0 GOTO STEP26;
JOIN HSEL25 IN PASS25 TO ROLL_LEV IN HIERORG
TABLE FILE PASS25
BY INST_KEY NOPRINT
PRINT INST_KEY AS 'INST_KEY'
      DEPT     AS 'HSEL25'
      DEPTNAME AS 'HDES25'
WHERE DEPTNAME NE HDES25
ON TABLE HOLD AS HOLD25
END
-IF &RECORDS EQ 0 GOTO STEP26;
MODIFY FILE I_SUMM
FIXFORM FROM HOLD25
MATCH INST_KEY
ON MATCH UPDATE HDES25
ON NOMATCH REJECT
DATA ON HOLD25
END
-STEP26
-EXIT
