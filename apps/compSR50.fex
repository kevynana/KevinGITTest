-****************************************************************************
-* This program is used to load the organization file AH-50 (alXXX.foc file)
-*
-****************************************************************************
-*SET &ECHO=ALL;
SET MESSAGE =ON


-SET &FILENAME = 'D7CONG';
-GOTO SECONDPATH



SET EDAPATH=K:\tnt\ttracker\data;

-RUN

-SET &USEF1='K:\tnt\ttracker\data\' | &FILENAME | '.FOC';
USE
  &USEF1 AS &FILENAME
END
? PATH
-RUN

TABLE FILE &FILENAME
PRINT   TRN_DATE
	DPT_DATE
	SEG_DISCOUNT
	SEG_AMT
	SEG_TAX
	FLIGHT
BY	AIR_KEY
BY	EMBARK
BY	ROUTE
BY	TKT_SORT
BY	SEG_NBR
-*IF RECORDLIMIT EQ 1000
ON TABLE HOLD AS HOLD1
END
-RUN


-SECONDPATH
SET EDAPATH=K:\NEWDBS;

-RUN
-SET &USEF2='K:\NEWDBS\' | &FILENAME | '.FOC';

USE
  &USEF2 AS &FILENAME
END
? PATH
-RUN

TABLE FILE &FILENAME
PRINT   TRN_DATE
	DPT_DATE
	SEG_DISCOUNT
	SEG_AMT
	SEG_TAX
	FLIGHT
	AROLL_LEV1 AROLL_LEV2 AROLL_LEV5
BY	AIR_KEY
BY	EMBARK
BY	ROUTE
BY	TKT_SORT
BY	SEG_NBR
IF RECORDLIMIT EQ 100
-*ON TABLE HOLD AS HOLD2
END
-RUN

-EXIT

MATCH FILE HOLD1
PRINT   TRN_DATE
	DPT_DATE
	SEG_DISCOUNT
	SEG_AMT
	SEG_TAX
	FLIGHT
BY	AIR_KEY
BY	EMBARK
BY	ROUTE
BY	TKT_SORT
BY	SEG_NBR
ON TABLE HOLD
RUN
FILE HOLD2
BY	AIR_KEY
BY	EMBARK
BY	ROUTE
BY	TKT_SORT
BY	SEG_NBR
ON MATCH HOLD AS HOLD3 OLD-NOR-NEW
END
-RUN
