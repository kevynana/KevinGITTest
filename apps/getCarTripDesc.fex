
-INCLUDE SETECHO
SET ASNAMES = ON



DEFINE FILE TRP_REF
TRIPKEY/A2 = EDIT(TRP_KEY, '$$$$$$$$99');
END
TABLE FILE TRP_REF
PRINT  TRP_DESC
BY TRIPKEY AS 'TRIP_PURPOSE'
IF TRP_KEY CONTAINS '&&ROLLUP.EVAL'
ON TABLE HOLD AS CARTD
END
-RUN

DEFINE FILE CARHOLD
TRIP_PURPOSE/A2 = EDIT(LEVEL5, '99');
END
TABLE FILE CARHOLD
 PRINT ACCT
  TYPE
  TSORT
  CAR_KEY
  CURR_DATE
  CITY2  
  DATE2
  DV_NUM
  TRAN_DATE
  INVOICE_DATE
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3
  LEVEL4
  LEVEL5
  AMOUNT 
  PASSNGR_NAME
  CITY1
  DATE
  PNR_LOCATOR
  SEG
  STATUS
  TTL_COUNT
  TKT_NUM  
  NAME
  GEO_ZONE
BY  TRIP_PURPOSE
ON TABLE HOLD AS CARHLD2
END
-RUN


MATCH FILE CARHLD2
PRINT ACCT
  TYPE
  TSORT
  CAR_KEY
  CURR_DATE
  CITY2  
  DATE2
  DV_NUM
  TRAN_DATE
  INVOICE_DATE
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3
  LEVEL4
  LEVEL5
  AMOUNT 
  PASSNGR_NAME
  CITY1
  DATE
  PNR_LOCATOR
  SEG
  STATUS
  TTL_COUNT
  TKT_NUM  
  NAME
  GEO_ZONE
BY TRIP_PURPOSE
ON TABLE HOLD 
RUN
FILE CARTD
SUM TRP_DESC
BY TRIP_PURPOSE
AFTER MATCH HOLD AS XONE OLD 
END
-RUN

TABLE FILE XONE
PRINT ACCT
  TYPE
  TSORT
  CAR_KEY
  CURR_DATE
  CITY2  
  DATE2
  DV_NUM
  TRAN_DATE
  INVOICE_DATE
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3
  LEVEL4
  LEVEL5
  AMOUNT 
  PASSNGR_NAME
  CITY1
  DATE
  PNR_LOCATOR
  SEG
  STATUS
  TTL_COUNT
  TKT_NUM 
  TRIP_PURPOSE
  TRP_DESC
  NAME
  GEO_ZONE
ON TABLE HOLD AS CARHOLD  
END
-RUN
 
