-***************************************************************************************
-* fex name: SetDTRangeFiles.fex
-*   Translate the datetype into WHERE statement based on the value of &&DATETYPE
-*   and &&RPTTYPE
-*   IF DATATYPE IS travel date, use join air_key, else traditional way to pass dates
-*  03/31/2015  REJ  S-05681 Changes for Available Reports.  Adding code so that the
-*                           program will run in current Review and in Available Reports.
-***************************************************************************************
-INCLUDE SETECHO
 
DEFINE FILE BRPTINST
  FM_DATE/YYMD  = FM_DATE;
  TO_DATE/YYMD  = TO_DATE;
  FXDATE/YYMD   = FXDATE;
  TXDATE/YYMD   = TXDATE;
 
  CMFM_DATE/YYMD = CMFM_DATE;
  CMTO_DATE/YYMD = CMTO_DATE;
  PMFM_DATE/YYMD = PMFM_DATE;
  PMTO_DATE/YYMD = PMTO_DATE;
 
  CYFM_DATE/YYMD = CYFM_DATE;
  CYTO_DATE/YYMD = CYTO_DATE;
  PYFM_DATE/YYMD = PYFM_DATE;
  PYTO_DATE/YYMD = PYTO_DATE;
END
TABLE FILE BRPTINST
PRINT FM_DATE  TO_DATE   FXDATE    TXDATE
      CMFM_DATE CMTO_DATE PMFM_DATE PMTO_DATE
      CYFM_DATE CYTO_DATE PYFM_DATE PYTO_DATE
WHERE INST_KEY EQ &&IKEY
ON TABLE SAVE AS DATERANGE
END
-RUN
 
-READ DATERANGE &&FROMDT.8. &&TODT.8. &&FXDATE.8. &&TXDATE.8. ,
- &&CMFMDT.8. &&CMTODT.8. &&PMFMDT.8. &&PMTODT.8. ,
- &&CYFMDT.8. &&CYTODT.8. &&PYFMDT.8. &&PYTODT.8.
 
-SET &&FROMDT = IF &&FROMDT EQ ' ' THEN ' ' ELSE EDIT(&&FROMDT,'9999/99/99');
-SET &&TODT   = IF &&TODT EQ ' '   THEN ' ' ELSE EDIT(&&TODT,'9999/99/99');
-SET &&FXDATE = IF &&FXDATE EQ ' ' THEN ' ' ELSE EDIT(&&FXDATE,'9999/99/99');
-SET &&TXDATE = IF &&TXDATE EQ ' ' THEN ' ' ELSE EDIT(&&TXDATE,'9999/99/99');
 
-SET &&PYFMDT = IF &&PYFMDT EQ ' ' THEN ' ' ELSE EDIT(&&PYFMDT,'9999/99/99');
-SET &&PYTODT = IF &&PYTODT EQ ' ' THEN ' ' ELSE EDIT(&&PYTODT,'9999/99/99');
-SET &&CYFMDT = IF &&CYFMDT EQ ' ' THEN ' ' ELSE EDIT(&&CYFMDT,'9999/99/99');
-SET &&CYTODT = IF &&CYTODT EQ ' ' THEN ' ' ELSE EDIT(&&CYTODT,'9999/99/99');
 
-SET &&CMFMDT = IF &&CMFMDT EQ ' ' THEN ' ' ELSE EDIT(&&CMFMDT,'9999/99/99');
-SET &&CMTODT = IF &&CMTODT EQ ' ' THEN ' ' ELSE EDIT(&&CMTODT,'9999/99/99');
-SET &&PMFMDT = IF &&PMFMDT EQ ' ' THEN ' ' ELSE EDIT(&&PMFMDT,'9999/99/99');
-SET &&PMTODT = IF &&PMTODT EQ ' ' THEN ' ' ELSE EDIT(&&PMTODT,'9999/99/99');
 
-SET &AIRDATES  = &&WEB_PATH || 'AIRDATES.FEX';
-*-SET &AIRDATES1 = &&WEB_PATH || 'AIRDATES1.FEX';
-*-SET &AIRDATES2 = &&WEB_PATH || 'AIRDATES2.FEX';
 
-SET &CARDATES  = &&WEB_PATH || 'CARDATES.FEX';
-*-SET &CARDATES1 = &&WEB_PATH || 'CARDATES1.FEX';
-*-SET &CARDATES2 = &&WEB_PATH || 'CARDATES2.FEX';
 
-SET &HTLDATES  = &&WEB_PATH || 'HTLDATES.FEX';
-*-SET &HTLDATES1 = &&WEB_PATH || 'HTLDATES1.FEX';
-*-SET &HTLDATES2 = &&WEB_PATH || 'HTLDATES2.FEX';
 
FILEDEF AIRDATES  DISK &AIRDATES
-*FILEDEF AIRDATES1  DISK &AIRDATES1
-*FILEDEF AIRDATES2  DISK &AIRDATES2
 
FILEDEF CARDATES  DISK &CARDATES
-*FILEDEF CARDATES1  DISK &CARDATES1
-*FILEDEF CARDATES2  DISK &CARDATES2
 
FILEDEF HTLDATES  DISK &HTLDATES
-*FILEDEF HTLDATES1  DISK &HTLDATES1
-*FILEDEF HTLDATES2  DISK &HTLDATES2
 
-SET &PROFDATES  = &&WEB_PATH || 'PROFDATES.FEX';
FILEDEF PROFDATES  DISK &PROFDATES
-RUN
 
-SET &ADTDESC = IF &&DATETYPE EQ 'I' THEN 'TRN_DATE' ELSE 'FST_DPT_DATE';
-SET &CDTDESC = IF &&DATETYPE EQ 'I' THEN 'INVOICE_DATE' ELSE 'PICKUP_DATE';
-SET &HDTDESC = IF &&DATETYPE EQ 'I' THEN 'INVOICE_DATE' ELSE 'CHKIN_DATE';
-SET &PFTDESC = IF &&DATETYPE EQ 'I' THEN 'RPT_DATE' ELSE 'FST_DPT_DATE';
 
-SET &DTTYP='&&DATETYPE';
 
-*-IF '&&RPTTYPE.EVAL' EQ 'SPC' OR '&&RPTTYPE.EVAL' EQ 'STM' THEN GOTO WriteSigle;
-*-IF '&&RPTTYPE.EVAL' EQ 'SPD' OR '&&RPTTYPE.EVAL' EQ 'ETS' THEN GOTO WriteDual;
-*-IF '&&RPTTYPE.EVAL' EQ 'STS' THEN GOTO WriteQuart;
-IF '&&RPTTYPE.EVAL' EQ 'AIR' OR 'CAR' OR 'HTL' OR 'OTM' THEN GOTO WriteSigle;
-IF '&&RPTTYPE.EVAL' EQ 'ADD' OR 'CDD' OR 'HDD' OR 'EXC' THEN GOTO WriteDual;
-IF '&&RPTTYPE.EVAL' EQ 'OTH' THEN GOTO WriteQuart;
 
 
-WriteSigle
-WRITE AIRDATES WHERE &ADTDESC.EVAL GE '&&FROMDT.EVAL' AND &ADTDESC.EVAL LE '&&TODT.EVAL'
-WRITE CARDATES WHERE &CDTDESC.EVAL GE '&&FROMDT.EVAL' AND &CDTDESC.EVAL LE '&&TODT.EVAL'
-WRITE HTLDATES WHERE &HDTDESC.EVAL GE '&&FROMDT.EVAL' AND &HDTDESC.EVAL LE '&&TODT.EVAL'
-WRITE PROFDATES WHERE &PFTDESC.EVAL GE '&&FROMDT.EVAL' AND &PFTDESC.EVAL LE '&&TODT.EVAL'
-GOTO DTREND;
 
-WriteDual
-*-WRITE AIRDATES WHERE &ADTDESC.EVAL GE '&&FROMDT.EVAL' AND &ADTDESC.EVAL LE '&&TODT.EVAL'
-*-WRITE AIRDATES  OR &ADTDESC.EVAL GE '&&FXDATE.EVAL' AND &ADTDESC.EVAL LE '&&TXDATE.EVAL'
 
-*-WRITE AIRDATES1 WHERE &ADTDESC.EVAL GE '&&FROMDT.EVAL' AND &ADTDESC.EVAL LE '&&TODT.EVAL'
-*-WRITE AIRDATES2 WHERE &ADTDESC.EVAL GE '&&FXDATE.EVAL' AND &ADTDESC.EVAL LE '&&TXDATE.EVAL'
 
-*-WRITE CARDATES WHERE &CDTDESC.EVAL GE '&&FROMDT.EVAL' AND &CDTDESC.EVAL LE '&&TODT.EVAL'
-*-WRITE CARDATES    OR &CDTDESC.EVAL GE '&&FXDATE.EVAL' AND &CDTDESC.EVAL LE '&&TXDATE.EVAL'
 
-*-WRITE CARDATES1 WHERE &CDTDESC.EVAL GE '&&FROMDT.EVAL' AND &CDTDESC.EVAL LE '&&TODT.EVAL'
-*-WRITE CARDATES2 WHERE &CDTDESC.EVAL GE '&&FXDATE.EVAL' AND &CDTDESC.EVAL LE '&&TXDATE.EVAL'
 
-*-WRITE HTLDATES WHERE &HDTDESC.EVAL GE '&&FROMDT.EVAL' AND &HDTDESC.EVAL LE '&&TODT.EVAL'
-*-WRITE HTLDATES    OR &HDTDESC.EVAL GE '&&FXDATE.EVAL' AND &HDTDESC.EVAL LE '&&TXDATE.EVAL'
 
-*-WRITE HTLDATES1 WHERE &HDTDESC.EVAL GE '&&FROMDT.EVAL' AND &HDTDESC.EVAL LE '&&TODT.EVAL'
-*-WRITE HTLDATES2 WHERE &HDTDESC.EVAL GE '&&FXDATE.EVAL' AND &HDTDESC.EVAL LE '&&TXDATE.EVAL'
-GOTO DTREND;
 
-WriteQuart
-*-WRITE AIRDATES WHERE &ADTDESC.EVAL GE '&&PYFMDT.EVAL' AND &ADTDESC.EVAL LE '&&PYTODT.EVAL'
-*-WRITE AIRDATES  OR &ADTDESC.EVAL GE '&&CYFMDT.EVAL' AND &ADTDESC.EVAL LE '&&CYTODT.EVAL'
-*-WRITE AIRDATES  OR &ADTDESC.EVAL GE '&&CMFMDT.EVAL' AND &ADTDESC.EVAL LE '&&CMTODT.EVAL'
-*-WRITE AIRDATES  OR &ADTDESC.EVAL GE '&&PMFMDT.EVAL' AND &ADTDESC.EVAL LE '&&PMTODT.EVAL'
-*-WRITE AIRDATES -GOTO NOJOINING;
 
-*-WRITE CARDATES WHERE &CDTDESC.EVAL GE '&&PYFMDT.EVAL' AND &CDTDESC.EVAL LE '&&PYTODT.EVAL'
-*-WRITE CARDATES    OR &CDTDESC.EVAL GE '&&CYFMDT.EVAL' AND &CDTDESC.EVAL LE '&&CYTODT.EVAL'
-*-WRITE CARDATES    OR &CDTDESC.EVAL GE '&&CMFMDT.EVAL' AND &CDTDESC.EVAL LE '&&CMTODT.EVAL'
-*-WRITE CARDATES    OR &CDTDESC.EVAL GE '&&PMFMDT.EVAL' AND &CDTDESC.EVAL LE '&&PMTODT.EVAL'
 
-*-WRITE HTLDATES WHERE &HDTDESC.EVAL GE '&&PYFMDT.EVAL' AND &HDTDESC.EVAL LE '&&PYTODT.EVAL'
-*-WRITE HTLDATES    OR &HDTDESC.EVAL GE '&&CYFMDT.EVAL' AND &HDTDESC.EVAL LE '&&CYTODT.EVAL'
-*-WRITE HTLDATES    OR &HDTDESC.EVAL GE '&&CMFMDT.EVAL' AND &HDTDESC.EVAL LE '&&CMTODT.EVAL'
-*-WRITE HTLDATES    OR &HDTDESC.EVAL GE '&&PMFMDT.EVAL' AND &HDTDESC.EVAL LE '&&PMTODT.EVAL'
 
-DTREND
 
-CLOSE AIRDATES
-*-CLOSE AIRDATES1
-*-CLOSE AIRDATES2
-CLOSE CARDATES
-*-CLOSE CARDATES1
-*-CLOSE CARDATES2
-CLOSE HTLDATES
-*-CLOSE HTLDATES1
-*-CLOSE HTLDATES2
-CLOSE PROFDATES
 
