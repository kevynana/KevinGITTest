

USE CLEAR *
USE
    D:\TNT\TTRACKER\SUDATA\ROLLUP.FOC
END
FI CUSTS DISK D:\LOAD\FOCTEMP\CUSTS.DAT
SET MESSAGE=ON
-*=======================================================================
SET ASNAMES=ON
DEFINE FILE ROLLUP
XL01/A1 = 'W' ;
END
TABLE FILE ROLLUP
BY ROLLUP NOPRINT
PRINT ROLLUP AS 'ROLLUP_CODE'
      XL01   AS 'PR_STAMP'
IF UPD_ENABLE NE ' '
IF QTR_ENABLE NE ' '
IF LOAD_GRP NE 'X'
IF ROLLUP_CODE NE 'TOTAL-R' OR 'ABCD2-R'
ON TABLE HOLD
END
-RUN


MODIFY FILE ROLLUP
FIXFORM FROM HOLD
MATCH ROLLUP
ON MATCH UPDATE PR_STAMP
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-*======================================================================
USE CLEAR *
-RUN
SET TEMPDIR=K:\FOCTEMP
SET MESSAGE=ON
SET WARNING=OFF
SET YRTHRESH=30
SET DEFCENT=19
-RUN
-*=======================================================================
-TOP
TABLE FILE ROLLUP
BY ROLLUP NOPRINT
PRINT ROLLUP COMP
BY ROLLUP_CODE NOPRINT
IF UPD_ENABLE NE ' '
IF RECORDLIMIT EQ 1
IF QTR_ENABLE NE ' '
IF PR_STAMP EQ 'W'
ON TABLE SAVE AS CUSTS
END
-RUN

-READ CUSTS &&ROLLUP.A8 &&COMP.A6.
-RUN

-IF &RECORDS EQ 0 THEN GOTO STOP;
-RUN




-*=======================================================================
-*                 CREATE DATA FILES FOR PROCESSING
-*=======================================================================
-TYPE "BEFORE SETS"

-* TKT MAIN .FOC FILES
-SET &&DTBASE1 = 'K:\TNT\TTRACKER\DATA\'||'T1'||&&COMP|||'.FOC';
-SET &&DTBASE2 = 'K:\TNT\TTRACKER\DATA\'||'T2'||&&COMP|||'.FOC';
-SET &&DTBASE3 = 'K:\TNT\TTRACKER\DATA\'||'T3'||&&COMP|||'.FOC';
-SET &&DTBASE4 = 'K:\TNT\TTRACKER\DATA\'||'T4'||&&COMP|||'.FOC';
-SET &&DTBASE5 = 'K:\TNT\TTRACKER\DATA\'||'T5'||&&COMP|||'.FOC';
-SET &&DTBASE6 = 'K:\TNT\TTRACKER\DATA\'||'T6'||&&COMP|||'.FOC';
-SET &&DTBASE7 = 'K:\TNT\TTRACKER\DATA\'||'T7'||&&COMP|||'.FOC';
-SET &&DTBASE8 = 'K:\TNT\TTRACKER\DATA\'||'T8'||&&COMP|||'.FOC';
-SET &&DTBASE9 = 'K:\TNT\TTRACKER\DATA\'||'T9'||&&COMP|||'.FOC';
-SET &&DTBASE10 = 'K:\TNT\TTRACKER\DATA\'||'T0'||&&COMP|||'.FOC';
-SET &&DTBASE11 = 'K:\TNT\TTRACKER\DATA\'||'TY'||&&COMP|||'.FOC';
-SET &&DTBASE12 = 'K:\TNT\TTRACKER\DATA\'||'TZ'||&&COMP|||'.FOC';
-* DESTINATION .FOC FILES
-SET &&DDBASE1 = 'K:\TNT\TTRACKER\DATA\'||'D1'||&&COMP|||'.FOC';
-SET &&DDBASE2 = 'K:\TNT\TTRACKER\DATA\'||'D2'||&&COMP|||'.FOC';
-SET &&DDBASE3 = 'K:\TNT\TTRACKER\DATA\'||'D3'||&&COMP|||'.FOC';
-SET &&DDBASE4 = 'K:\TNT\TTRACKER\DATA\'||'D4'||&&COMP|||'.FOC';
-SET &&DDBASE5 = 'K:\TNT\TTRACKER\DATA\'||'D5'||&&COMP|||'.FOC';
-SET &&DDBASE6 = 'K:\TNT\TTRACKER\DATA\'||'D6'||&&COMP|||'.FOC';
-SET &&DDBASE7 = 'K:\TNT\TTRACKER\DATA\'||'D7'||&&COMP|||'.FOC';
-SET &&DDBASE8 = 'K:\TNT\TTRACKER\DATA\'||'D8'||&&COMP|||'.FOC';
-SET &&DDBASE9 = 'K:\TNT\TTRACKER\DATA\'||'D9'||&&COMP|||'.FOC';
-SET &&DDBASE10 = 'K:\TNT\TTRACKER\DATA\'||'D0'||&&COMP|||'.FOC';
-SET &&DDBASE11 = 'K:\TNT\TTRACKER\DATA\'||'DY'||&&COMP|||'.FOC';
-SET &&DDBASE12 = 'K:\TNT\TTRACKER\DATA\'||'DZ'||&&COMP|||'.FOC';
-* TKT MAIN .MAS FILES
-SET &&DTBMAS1 = 'K:\TNT\TTRACKER\DATA\'||'T1'||&&COMP|||'.MAS';
-SET &&DTBMAS2 = 'K:\TNT\TTRACKER\DATA\'||'T2'||&&COMP|||'.MAS';
-SET &&DTBMAS3 = 'K:\TNT\TTRACKER\DATA\'||'T3'||&&COMP|||'.MAS';
-SET &&DTBMAS4 = 'K:\TNT\TTRACKER\DATA\'||'T4'||&&COMP|||'.MAS';
-SET &&DTBMAS5 = 'K:\TNT\TTRACKER\DATA\'||'T5'||&&COMP|||'.MAS';
-SET &&DTBMAS6 = 'K:\TNT\TTRACKER\DATA\'||'T6'||&&COMP|||'.MAS';
-SET &&DTBMAS7 = 'K:\TNT\TTRACKER\DATA\'||'T7'||&&COMP|||'.MAS';
-SET &&DTBMAS8 = 'K:\TNT\TTRACKER\DATA\'||'T8'||&&COMP|||'.MAS';
-SET &&DTBMAS9 = 'K:\TNT\TTRACKER\DATA\'||'T9'||&&COMP|||'.MAS';
-SET &&DTBMAS10 = 'K:\TNT\TTRACKER\DATA\'||'T0'||&&COMP|||'.MAS';
-SET &&DTBMAS11 = 'K:\TNT\TTRACKER\DATA\'||'TY'||&&COMP|||'.MAS';
-SET &&DTBMAS12 = 'K:\TNT\TTRACKER\DATA\'||'TZ'||&&COMP|||'.MAS';
-* DESTINATION .MAS FILES
-SET &&DDBMAS1 = 'K:\TNT\TTRACKER\DATA\'||'D1'||&&COMP|||'.MAS';
-SET &&DDBMAS2 = 'K:\TNT\TTRACKER\DATA\'||'D2'||&&COMP|||'.MAS';
-SET &&DDBMAS3 = 'K:\TNT\TTRACKER\DATA\'||'D3'||&&COMP|||'.MAS';
-SET &&DDBMAS4 = 'K:\TNT\TTRACKER\DATA\'||'D4'||&&COMP|||'.MAS';
-SET &&DDBMAS5 = 'K:\TNT\TTRACKER\DATA\'||'D5'||&&COMP|||'.MAS';
-SET &&DDBMAS6 = 'K:\TNT\TTRACKER\DATA\'||'D6'||&&COMP|||'.MAS';
-SET &&DDBMAS7 = 'K:\TNT\TTRACKER\DATA\'||'D7'||&&COMP|||'.MAS';
-SET &&DDBMAS8 = 'K:\TNT\TTRACKER\DATA\'||'D8'||&&COMP|||'.MAS';
-SET &&DDBMAS9 = 'K:\TNT\TTRACKER\DATA\'||'D9'||&&COMP|||'.MAS';
-SET &&DDBMAS10 = 'K:\TNT\TTRACKER\DATA\'||'D0'||&&COMP|||'.MAS';
-SET &&DDBMAS11 = 'K:\TNT\TTRACKER\DATA\'||'DY'||&&COMP|||'.MAS';
-SET &&DDBMAS12 = 'K:\TNT\TTRACKER\DATA\'||'DZ'||&&COMP|||'.MAS';
-* TKT MAIN FILE NAMES
-SET &&FOCTNAME1 = 'T1'||&&COMP;
-SET &&FOCTNAME2 = 'T2'||&&COMP;
-SET &&FOCTNAME3 = 'T3'||&&COMP;
-SET &&FOCTNAME4 = 'T4'||&&COMP;
-SET &&FOCTNAME5 = 'T5'||&&COMP;
-SET &&FOCTNAME6 = 'T6'||&&COMP;
-SET &&FOCTNAME7 = 'T7'||&&COMP;
-SET &&FOCTNAME8 = 'T8'||&&COMP;
-SET &&FOCTNAME9 = 'T9'||&&COMP;
-SET &&FOCTNAME10 = 'T0'||&&COMP;
-SET &&FOCTNAME11 = 'TY'||&&COMP;
-SET &&FOCTNAME12 = 'TZ'||&&COMP;
-* DESTINATION FILE NAMES
-SET &&FOCDNAME1 = 'D1'||&&COMP;
-SET &&FOCDNAME2 = 'D2'||&&COMP;
-SET &&FOCDNAME3 = 'D3'||&&COMP;
-SET &&FOCDNAME4 = 'D4'||&&COMP;
-SET &&FOCDNAME5 = 'D5'||&&COMP;
-SET &&FOCDNAME6 = 'D6'||&&COMP;
-SET &&FOCDNAME7 = 'D7'||&&COMP;
-SET &&FOCDNAME8 = 'D8'||&&COMP;
-SET &&FOCDNAME9 = 'D9'||&&COMP;
-SET &&FOCDNAME10 = 'D0'||&&COMP;
-SET &&FOCDNAME11 = 'DY'||&&COMP;
-SET &&FOCDNAME12 = 'DZ'||&&COMP;
-TYPE "AFTER SETS"

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME1 TO ALL AIR_KEY IN &&FOCDNAME1
END

DEFINE FILE &&FOCTNAME1
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME1
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '  
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME1
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME2 TO ALL AIR_KEY IN &&FOCDNAME2
END

DEFINE FILE &&FOCTNAME2
GEO1/A3 = EDIT(GEO_ZONE, '999');
END
END

TABLE FILE &&FOCTNAME2
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END



MODIFY FILE &&FOCTNAME2
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME3 TO ALL AIR_KEY IN &&FOCDNAME3
END



DEFINE FILE &&FOCTNAME3
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME3
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME3
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME4 TO ALL AIR_KEY IN &&FOCDNAME4
END



DEFINE FILE &&FOCTNAME4
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME4
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME4
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME5 TO ALL AIR_KEY IN &&FOCDNAME5
END

DEFINE FILE &&FOCTNAME5
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME5
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME5
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN
JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME6 TO ALL AIR_KEY IN &&FOCDNAME6
END

DEFINE FILE &&FOCTNAME6
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME6
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME6
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN
JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME7 TO ALL AIR_KEY IN &&FOCDNAME7
END

DEFINE FILE &&FOCTNAME7
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME7
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME7
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME8 TO ALL AIR_KEY IN &&FOCDNAME8
END

DEFINE FILE &&FOCTNAME8
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME8
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME8
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME9 TO ALL AIR_KEY IN &&FOCDNAME9
END

DEFINE FILE &&FOCTNAME9
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME9
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME9
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME10 TO ALL AIR_KEY IN &&FOCDNAME10
END

DEFINE FILE &&FOCTNAME10
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME10
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME10
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN

JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME11 TO ALL AIR_KEY IN &&FOCDNAME11
END

DEFINE FILE &&FOCTNAME11
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME11
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME11
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN


JOIN CLEAR *
-RUN

JOIN AIR_KEY IN &&FOCTNAME12 TO ALL AIR_KEY IN &&FOCDNAME12
END

DEFINE FILE &&FOCTNAME12
GEO1/A3 = EDIT(GEO_ZONE, '999');
END

TABLE FILE &&FOCTNAME12
PRINT ROUTE
BY AIR_KEY
WHERE GEO1 NE 'USA' OR ' '
WHERE ORG_APC EQ DST_APC
WHERE SEG_NBR EQ '01'
WHERE ORG_APC NE 'DT1'
ON TABLE HOLD
END
-RUN

DEFINE FILE HOLD
DST_APC/A3 = ROUTE;
END
TABLE FILE HOLD
PRINT DST_APC
BY AIR_KEY
ON TABLE HOLD AS HOLD1
END


MODIFY FILE &&FOCTNAME12
FIXFORM FROM HOLD1
MATCH AIR_KEY
ON MATCH UPDATE DST_APC
ON NOMATCH REJECT
DATA ON HOLD1
END
-RUN






SET ASNAMES=ON
DEFINE FILE ROLLUP
XL01/A1 = 'Z' ;
END
TABLE FILE ROLLUP
BY ROLLUP NOPRINT
PRINT ROLLUP AS 'ROLLUP_CODE'
      XL01   AS 'PR_STAMP'
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
ON TABLE HOLD
END
MODIFY FILE ROLLUP
FIXFORM FROM HOLD
MATCH ROLLUP
ON MATCH UPDATE PR_STAMP
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-GOTO TOP
-RUN
-*======================================================================
-STOP
































