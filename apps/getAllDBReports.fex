-******************************************************************************
-* Program name:  getAllDBReports.fex
-* functions: To show all reports setup for the selected rollup code
-* Date: Jan 14, 2008
-******************************************************************************
-*-TYPE &ROLLUP
-*-TYPE &SECURITY
-*SET ASNAME = ON
SET PAGE = OFF
SET TEMPERASE = OFF
SET EMPTYREPORT = ON
-DEFAULT &SECURITY = 9;
-DEFAULT &ROLLUP = '*';


JOIN SELECTIONID IN PTREPORT TO ALL SELECTIONID IN PTSELHIER

TABLE FILE PTREPORT
PRINT ROLL_LEV  TNT_COMPANY 

BY ROLLUP_CODE

BY SELECTIONID 

BY RPTNAME 
BY MANAGERID 
BY RPTE01 
BY RPTS01 
BY RPTO01 
BY RPTA01 
BY RPTA02 
BY RPTA03 
BY RPTC01 
BY RPTH01 

BY HIER_LEVEL
BY WEEKLY
BY MONTHLY
BY MTD
BY QUARTERLY
BY QYTD
BY ANNUAL
BY ONLINE
BY DOMINTL
BY ADVSHIFT
BY ONLINESHIFT
BY BREAKLVL

-IF &SECURITY EQ 9 THEN GOTO ALLROLLUP;
WHERE ROLLUP_CODE EQ '&ROLLUP.EVAL'
-ALLROLLUP

ON TABLE HOLD AS HLDRPT FORMAT FOCUS 
END
-RUN



JOIN RECEIVERID IN PTUSER TO ALL RECEIVERID PTBATCH
DEFINE FILE PTUSER
  NAME/A41=LASTNAME || ',' | FIRSTNAME;
END

TABLE FILE PTUSER
PRINT NAME EMAIL

BY ROLLUP_CODE

BY SELECTIONID 

-IF &SECURITY EQ 9 THEN GOTO ALLROLLUP2;
WHERE ROLLUP_CODE EQ '&ROLLUP.EVAL'
-ALLROLLUP2

ON TABLE HOLD AS HLDUSR FORMAT FOCUS INDEX SELECTIONID
END
-RUN

JOIN SELECTIONID IN HLDRPT TO ALL SELECTIONID IN HLDUSR
DEFINE FILE HLDRPT
  OT/A3= IF ONLINE EQ '1' THEN 'All' ELSE IF ONLINE EQ '2' THEN 'O' ELSE 'T';
  DI/A3= IF DOMINTL EQ '1' THEN 'All' ELSE IF DOMINTL EQ '2' THEN 'D' ELSE 'I';
END

TABLE FILE HLDRPT
HEADING CENTER
-IF &SECURITY EQ 9 THEN GOTO ALLROLLUP3;
"All Reports Setup for &ROLLUP.EVAL In eTTekReview Dashboard Push Technology"
" (Note: value 1 means selected, 0 mean not selected) </1"
-GOTO ENDROLLUP;
-ALLROLLUP3
"All Reports Setup In eTTekReview Dashboard Push Technology"
" (Note: value 1 means selected, 0 mean not selected) </1"

-ENDROLLUP

-*PRINT 
-*NAME AS 'Receivers'

-IF &SECURITY NE 9 THEN GOTO NOROLLPRINT;
BY ROLLUP_CODE 
-NOROLLPRINT

BY SELECTIONID NOPRINT

BY RPTNAME 
BY MANAGERID AS 'Setup By' 
BY RPTE01 AS 'Executive,Summary'
BY RPTS01 AS 'Summary,By,Hierarchy'
BY RPTO01 AS 'Online vs,Traditional'
BY RPTA01 AS 'Advance,Purchase'
BY RPTA02 AS 'Performance'
BY RPTA03 AS 'City,Pair'
BY RPTC01 AS 'Car'
BY RPTH01 AS 'Hotel'

BY HIER_LEVEL AS 'Selected, Hier Level'
BY WEEKLY AS 'Weekly'
BY MONTHLY AS 'Monthly'
BY MTD  
BY QUARTERLY AS 'Quarterly'
BY QYTD
BY ANNUAL AS 'Annual'
-*BY OT AS 'Online/,Traditional'
-*BY DI AS 'Dom/,Intl'
-*BY ADVSHIFT AS '% Shift,AdvPur'
-*BY ONLINESHIFT AS '% Shift,Online'
-*BY BREAKLVL AS 'Break,Level'


BY ROLL_LEV AS 'Hierachy,Selection' 
BY EMAIL

-*BY TNT_COMPANY AS 'TNT,Company'
-IF &SECURITY NE 9 THEN GOTO NOPAGEBRK;
-*ON ROLLUP_CODE PAGE-BREAK 
-NOPAGEBRK

WHERE HLDRPT.SELECTIONID EQ HLDUSR.SELECTIONID

WHERE ROLLUP_CODE NE 'ABCD-R'

ON TABLE SET ONLINE-FMT EXL2K

ON TABLE SET STYLE *

TYPE=REPORT,GRID=ON, FONT='TIMES NEW ROMAN', SQUEEZE=ON, ORIENTATION=LANDSCAPE,$
TYPE=HEADING,STYLE=BOLD,SIZE=10,$
TYPE=DATA, FONT='TIMES NEW ROMAN', SIZE=9, $
-*TYPE=DATA, SIZE=9,BACKCOLOR=(RGB(191 218 255) 'PALE GREEN'),  $
TYPE=TITLE,STYLE=BOLD,SIZE=9,$
TYPE=GRANDTOTAL,COLOR=BLUE,STYLE=BOLD,SIZE=9,$

ENDSTYLE

END
-RUN
-EXIT