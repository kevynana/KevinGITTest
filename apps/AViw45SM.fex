-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-*07/03/02   STEVE              CHANGED TO eTTek Review and Copyright
-*10/27/03   JOY                ADDED PSNGR_CNT TO VIEW
-*12/08/15 - JEM - S-13286 Updated to allow reports to sort/subtotal by id-levels

-* File SMRYRPT.FEX


SET ASNAMES = ON
-RUN


TABLE FILE &&RPT_HOLD

SUM NEW_TRIP_LENGTH AS 'TRIPD'
    CNT.XPSNGR_NM AS 'PSNGR_CNT'
BY LEVEL_DESC
BY NEW_TRIP_LENGTH
ON TABLE HOLD AS HOLDONE
END
-RUN

TABLE FILE HOLDONE
SUM TRIPD
    PSNGR_CNT
COMPUTE TRIPS/D9 = IF ((NEW_TRIP_LENGTH LT 1) AND (NEW_TRIP_LENGTH GT (-1))) 
                   THEN 0 ELSE (TRIPD/NEW_TRIP_LENGTH);
BY LEVEL_DESC
BY NEW_TRIP_LENGTH
ON TABLE HOLD AS HOLDTWO
END
-RUN

DEFINE FILE HOLDTWO
NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
END

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN

TABLE FILE HOLDTWO
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
&&BREAKOPTION
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10

-INCLUDE FOOTERSM
ON TABLE COLUMN-TOTAL
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *

-INCLUDE &&PASTYS
ENDSTYLE

&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN

EX REPORT_3
