-**********************************************************************
-* regenerate DBCONCAT, and update BRPTINST
-**********************************************************************
-INCLUDE SETECHO
-*-SET &&RPTTYP='ADD';

-DEFAULT &&CMFMDT='1900/01/01';
-DEFAULT &&CMTODT='1900/01/01';
-DEFAULT &&PMFMDT='1900/01/01';
-DEFAULT &&PMTODT='1900/01/01';
-DEFAULT &&CYFMDT='1900/01/01';
-DEFAULT &&CYTODT='1900/01/01';
-DEFAULT &&PYFMDT='1900/01/01';
-DEFAULT &&PYTODT='1900/01/01';
-DEFAULT &&FROMDT='1900/01/01';
-DEFAULT &&TODT='1900/01/01';
-DEFAULT &&FXDATE='1900/01/01';
-DEFAULT &&TXDATE='1900/01/01';

DEFINE FILE CONTROL
USER_ID/A20 = '&&UNAME.EVAL';
IN_KEY/I7= &&IKEY;
FM_DATE/YYMD='&&FROMDT.EVAL';
TO_DATE/YYMD='&&TODT.EVAL';
CMFMDT/YYMD='&&CMFMDT.EVAL';
CMTODT/YYMD='&&CMTODT.EVAL';
PMFMDT/YYMD='&&PMFMDT.EVAL';
PMTODT/YYMD='&&PMTODT.EVAL';
CYFMDT/YYMD='&&CYFMDT.EVAL';
CYTODT/YYMD='&&CYTODT.EVAL';
PYFMDT/YYMD='&&PYFMDT.EVAL';
PYTODT/YYMD='&&PYTODT.EVAL';
FXDATE/YYMD='&&FXDATE.EVAL';
TXDATE/YYMD='&&TXDATE.EVAL';
RPTTYPE/A8='&&RPTTYP';
END
TABLE FILE CONTROL
PRINT IN_KEY 
      FM_DATE
      TO_DATE
      CMFMDT
      CMTODT
      PMFMDT
      PMTODT
      CYFMDT
      CYTODT
      PYFMDT
      PYTODT
      RPTTYPE
      FXDATE
      TXDATE
BY USER_ID
BY ROLLUP_CODE
ON TABLE HOLD AS DBCONCAT
END
-RUN

SET ASNAME = ON
DEFINE FILE BRPTINST
  SELDB/A1 = '&&SMD.EVAL';
  RPTTYPE/A3='&&RPTTYP.EVAL';
  ROLL/A8 = '&&ROLLUP.EVAL';
END
TABLE FILE BRPTINST
PRINT RPTTYPE AS 'RPT_TYPE'
SELDB AS 'PAIR_DB' ROLL AS 'ROLLUP_CODE'
BY INST_KEY
-*ON TABLE HOLD
ON TABLE SAVE
END
-RUN

MODIFY FILE BRPTINST
-*FIXFORM FROM HOLD
FIXFORM INST_KEY/7 RPT_TYPE/3 PAIR_DB/1 ROLLUP_CODE/8
MATCH INST_KEY 
  ON MATCH UPDATE ROLLUP_CODE RPT_TYPE PAIR_DB
-*DATA ON HOLD
DATA ON SAVE
END
-RUN
-SET &&CATQTRPR = 'CATQTR';