
SET ASNAMES=ON

USE 
D:\TNT\TTRACKER\DATA\S7BOOZ.FOC AS SR_50
D:\TNT\TTRACKER\DATA\S8BOOZ.FOC AS SR_50
D:\TNT\TTRACKER\DATA\A7BOOZ.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A8BOOZ.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\T7BOOZ.FOC AS TKT_MAIN
D:\TNT\TTRACKER\DATA\T8BOOZ.FOC AS TKT_MAIN
END

DEFINE FILE SR_50
FARE_PAID/D12.2CS = SEG_AMT + SEG_TAX;
NET_TKT_CNT/D8CS    = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') THEN (-1) ELSE 
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
NEW_STAY/D12 = STAY;
END
TABLE FILE SR_50
SUM NET_TKT_CNT STAY
BY PASSNGR_NAME
BY LEVEL4
BY TKT_NUM
BY TKT_SORT
BY SEG_NBR
BY FST_DEST_STATE_CODE
BY FNL_DEST_STATE_CODE
WHERE LEVEL4 EQ '548716' OR '550015'
END
-RUN
-QUIT