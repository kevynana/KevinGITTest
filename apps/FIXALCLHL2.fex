-* File UPDAL.FEX

-***************************************************************************
-* This program will update the AL, CL and HL databases when there is a blank
-* AROLL_LEV1 or AROLL_DSC1 - based off of the TTPHIERA0 file.
-* DATE           NAME
-* 03/27/02       Steve Cords - Initial Creation
-***************************************************************************

-GOTO HDRR

-* -GOTO UPDATEA

USE
D:\TNT\TTRACKER\DATA\A1CONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A2CONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A3CONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A4CONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A5CONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A6CONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A7CONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A8CONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A9CONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\A0CONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\AYCONG.FOC AS AIR_MAIN
D:\TNT\TTRACKER\DATA\AZCONG.FOC AS AIR_MAIN
END
-RUN

TABLE FILE AIR_MAIN
PRINT AIR_KEY LEVEL1
BY AIR_KEY NOPRINT
IF LEVEL1 EQ 'MEAT';
IF BR_CL_IDX EQ 'RF740258';
ON TABLE HOLD
END
-RUN

MODIFY FILE A1CONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE A2CONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE A3CONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE A4CONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE A5CONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE A6CONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE A7CONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE A8CONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE A9CONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE A0CONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE AYCONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE AZCONG
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

USE
D:\TNT\TTRACKER\DATA\C1CONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C2CONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C3CONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C4CONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C5CONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C6CONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C7CONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C8CONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C9CONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\C0CONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\CYCONG.FOC AS CAR_MAIN
D:\TNT\TTRACKER\DATA\CZCONG.FOC AS CAR_MAIN
END
-RUN

-* CAR

TABLE FILE CAR_MAIN
PRINT CAR_KEY LEVEL1
BY CAR_KEY NOPRINT
IF LEVEL1 EQ 'MEAT';
IF BR_CL_IDX EQ 'RF740258';
ON TABLE HOLD
END
-RUN

MODIFY FILE C1CONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE C2CONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE C3CONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE C4CONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE C5CONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE C6CONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE C7CONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE C8CONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE C9CONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE C0CONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE CYCONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE CZCONG
FIXFORM FROM HOLD
MATCH CAR_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

-* HOTEL

USE
D:\TNT\TTRACKER\DATA\H1CONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H2CONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H3CONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H4CONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H5CONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H6CONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H7CONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H8CONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H9CONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\H0CONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\HYCONG.FOC AS HTL_MAIN
D:\TNT\TTRACKER\DATA\HZCONG.FOC AS HTL_MAIN
END
-RUN

TABLE FILE HTL_MAIN
PRINT HTL_KEY LEVEL1
BY HTL_KEY NOPRINT
IF LEVEL1 EQ 'MEAT';
IF BR_CL_IDX EQ 'RF740258';
ON TABLE HOLD
END
-RUN

MODIFY FILE H1CONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE H2CONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE H3CONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE H4CONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE H5CONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE H6CONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE H7CONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE H8CONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE H9CONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE H0CONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE HYCONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN

MODIFY FILE HZCONG
FIXFORM FROM HOLD
MATCH HTL_KEY
ON MATCH COMPUTE LEVEL1='PORK';
ON MATCH UPDATE LEVEL1
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT

-UPDATEA
-*AIR

-SET &&COMPNY = 'CONG';

EX AIRXUSEZ
END
-RUN

SET ASNAMES=ON

-* TABLE FILE ALCONG
-* PRINT AIR_KEY
-* BY AIR_KEY NOPRINT
-* IF AROLL_LEV1 EQ ' ';
-* ON TABLE HOLD AS ALHOLD
-* END
-* -RUN

-* USE
-* D:\TNT\TTRACKER\DATA\A1CONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\A2CONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\A3CONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\A4CONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\A5CONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\A6CONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\A7CONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\A8CONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\A9CONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\A0CONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\AYCONG.FOC AS AIR_MAIN
-* D:\TNT\TTRACKER\DATA\AZCONG.FOC AS AIR_MAIN
-* END
-* -RUN

-* TABLE FILE AIR_MAIN
-* PRINT AIR_KEY LEVEL1
-* BY AIR_KEY NOPRINT
-* ON TABLE HOLD AS AIRHOLD
-* END
-* -RUN

-* MATCH FILE AIRHOLD
-* PRINT AIR_KEY LEVEL1
-* BY AIR_KEY NOPRINT
-* RUN
-* FILE ALHOLD
-* SUM AIR_KEY
-* BY AIR_KEY NOPRINT
-* AFTER MATCH HOLD NEW
-* END
-* -RUN

TABLE FILE SR_50
PRINT AIR_KEY LEVEL1 AS 'AROLL_LEV5'
BY LEVEL1 NOPRINT
IF AROLL_LEV1 EQ ' ';
-* ON TABLE HOLD AS HOLD2
END
-RUN
-EXIT

-*=======================================================================
-* DECLARE FILEDEFS FOR AS400 FILES USED FOR DATA EXTRACT
-*=======================================================================
FI TTPHIERA DISK D:\AS400\TTPHIERA.TXT

TABLE FILE TTPHIERA
PRINT *
BY AROLL_LEV5 NOPRINT
IF AROLL_LEV1 EQ 'CONG-R'
ON TABLE HOLD AS TMPHOLDA
END
-RUN

MATCH FILE HOLD2
PRINT AIR_KEY
BY AROLL_LEV5 NOPRINT
RUN
FILE TMPHOLDA
SUM
AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2
AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4
AROLL_LEV5 AROLL_DSC5 AROLL_LEV6 AROLL_DSC6
AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8
AROLL_LEV9 AROLL_DSC9
BY AROLL_LEV5 NOPRINT
AFTER MATCH HOLD OLD
END
-RUN

TABLE FILE HOLD
PRINT *
BY AIR_KEY NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE ALCONG
FIXFORM FROM HOLD3
MATCH AIR_KEY
ON NOMATCH REJECT
ON MATCH UPDATE AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2
ON MATCH UPDATE AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4
ON MATCH UPDATE AROLL_LEV5 AROLL_DSC5 AROLL_LEV6 AROLL_DSC6
ON MATCH UPDATE AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8
ON MATCH UPDATE AROLL_LEV9 AROLL_DSC9
DATA ON HOLD3
END
-RUN

-UPDATEC
-*CAR
-SET &&COMPNY = 'CONG';

EX CARXUSEZ
END
-RUN

SET ASNAMES=ON

-* TABLE FILE CLCONG
-* PRINT CAR_KEY
-* BY CAR_KEY NOPRINT
-* IF AROLL_LEV1 EQ ' ';
-* ON TABLE HOLD AS CLHOLD
-* END
-* -RUN

-* USE
-* D:\TNT\TTRACKER\DATA\C1CONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\C2CONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\C3CONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\C4CONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\C5CONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\C6CONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\C7CONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\C8CONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\C9CONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\C0CONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\CYCONG.FOC AS CAR_MAIN
-* D:\TNT\TTRACKER\DATA\CZCONG.FOC AS CAR_MAIN
-* END
-* -RUN

-* TABLE FILE CAR_MAIN
-* PRINT CAR_KEY LEVEL1
-* BY CAR_KEY NOPRINT
-* ON TABLE HOLD AS CARHOLD
-* END
-* -RUN

-* MATCH FILE CARHOLD
-* PRINT CAR_KEY LEVEL1
-* BY CAR_KEY NOPRINT
-* RUN
-* FILE CLHOLD
-* SUM CAR_KEY
-* BY CAR_KEY NOPRINT
-* AFTER MATCH HOLD NEW
-* END
-* -RUN

TABLE FILE CR_50
PRINT CAR_KEY LEVEL1 AS 'AROLL_LEV5'
BY LEVEL1 NOPRINT
IF AROLL_LEV1 EQ ' ';
ON TABLE HOLD AS HOLD2
END
-RUN

-*=======================================================================
-* DECLARE FILEDEFS FOR AS400 FILES USED FOR DATA EXTRACT
-*=======================================================================
FI TTPHIERA DISK D:\AS400\TTPHIERA.TXT

TABLE FILE TTPHIERA
PRINT *
BY AROLL_LEV5 NOPRINT
IF AROLL_LEV1 EQ 'CONG-R'
ON TABLE HOLD AS TMPHOLDA
END
-RUN

MATCH FILE HOLD2
PRINT CAR_KEY
BY AROLL_LEV5 NOPRINT
RUN
FILE TMPHOLDA
SUM
AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2
AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4
AROLL_LEV5 AROLL_DSC5 AROLL_LEV6 AROLL_DSC6
AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8
AROLL_LEV9 AROLL_DSC9
BY AROLL_LEV5 NOPRINT
AFTER MATCH HOLD OLD
END
-RUN

TABLE FILE HOLD
PRINT *
BY CAR_KEY NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE CLCONG
FIXFORM FROM HOLD3
MATCH CAR_KEY
ON NOMATCH REJECT
ON MATCH UPDATE AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2
ON MATCH UPDATE AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4
ON MATCH UPDATE AROLL_LEV5 AROLL_DSC5 AROLL_LEV6 AROLL_DSC6
ON MATCH UPDATE AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8
ON MATCH UPDATE AROLL_LEV9 AROLL_DSC9
DATA ON HOLD3
END
-RUN

-UPDATEH
-*HOTEL

-SET &&COMPNY = 'CONG';

EX HTLXUSEZ
END
-RUN

SET ASNAMES=ON

-* TABLE FILE HLCONG
-* PRINT HTL_KEY
-* BY HTL_KEY NOPRINT
-* IF AROLL_LEV1 EQ ' ';
-* ON TABLE HOLD AS HLHOLD
-* END
-* -RUN

-* USE
-* D:\TNT\TTRACKER\DATA\H1CONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\H2CONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\H3CONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\H4CONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\H5CONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\H6CONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\H7CONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\H8CONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\H9CONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\H0CONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\HYCONG.FOC AS HTL_MAIN
-* D:\TNT\TTRACKER\DATA\HZCONG.FOC AS HTL_MAIN
-* END
-* -RUN

-* TABLE FILE HTL_MAIN
-* PRINT HTL_KEY LEVEL1
-* BY HTL_KEY NOPRINT
-* ON TABLE HOLD AS HTLHOLD
-* END
-* -RUN

-* MATCH FILE HTLHOLD
-* PRINT HTL_KEY LEVEL1
-* BY HTL_KEY NOPRINT
-* RUN
-* FILE HLHOLD
-* SUM HTL_KEY
-* BY HTL_KEY NOPRINT
-* AFTER MATCH HOLD NEW
-* END
-* -RUN

TABLE FILE HR_50
PRINT HTL_KEY LEVEL1 AS 'AROLL_LEV5'
BY LEVEL1 NOPRINT
IF AROLL_LEV1 EQ ' ';
ON TABLE HOLD AS HOLD2
END
-RUN

-*=======================================================================
-* DECLARE FILEDEFS FOR AS400 FILES USED FOR DATA EXTRACT
-*=======================================================================
FI TTPHIERA DISK D:\AS400\TTPHIERA.TXT

TABLE FILE TTPHIERA
PRINT *
BY AROLL_LEV5 NOPRINT
IF AROLL_LEV1 EQ 'CONG-R'
ON TABLE HOLD AS TMPHOLDA
END
-RUN

MATCH FILE HOLD2
PRINT HTL_KEY
BY AROLL_LEV5 NOPRINT
RUN
FILE TMPHOLDA
SUM
AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2
AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4
AROLL_LEV5 AROLL_DSC5 AROLL_LEV6 AROLL_DSC6
AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8
AROLL_LEV9 AROLL_DSC9
BY AROLL_LEV5 NOPRINT
AFTER MATCH HOLD OLD
END
-RUN

TABLE FILE HOLD
PRINT *
BY HTL_KEY NOPRINT
ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE HLCONG
FIXFORM FROM HOLD3
MATCH HTL_KEY
ON NOMATCH REJECT
ON MATCH UPDATE AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2
ON MATCH UPDATE AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4
ON MATCH UPDATE AROLL_LEV5 AROLL_DSC5 AROLL_LEV6 AROLL_DSC6
ON MATCH UPDATE AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8
ON MATCH UPDATE AROLL_LEV9 AROLL_DSC9
DATA ON HOLD3
END
-RUN
-EXIT

-HDRR

TABLE FILE A_DUNN
PRINT AIR_KEY TKT_NUM CONJ_INV_CNT
CONJ_CNT CONJ_REL CONJ_GROUP
WHERE TKT_NUM EQ '7266009926';
ON TABLE HOLD
END
-RUN

MODIFY FILE A_DUNN
FIXFORM FROM HOLD
MATCH AIR_KEY
ON MATCH COMPUTE CONJ_INV_CNT=1;
ON MATCH COMPUTE CONJ_REL=1;
ON MATCH COMPUTE CONJ_CNT=1;
ON MATCH COMPUTE CONJ_GROUP=TKTNBR;
ON MATCH UPDATE CONJ_INV_CNT CONJ_REL CONJ_CNT CONJ_GROUP
ON NOMATCH REJECT
DATA ON HOLD
END
-RUN
-EXIT
