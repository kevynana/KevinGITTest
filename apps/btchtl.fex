-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-* File BTCTKT.FEX
-********************************************************************
-* MODIFICAIONS:
-********************************************************************
-*
-* This program extracts data for the series of basic hotel location listing
-* reports.  Based on the user profile selected, one of many report
-* formats will be produced.  
 
-********************************************************************
-INCLUDE SETECHO 

SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

-SET &HTLDATES = &&WEB_PATH || 'HTLDATES.fex';

DEFINE FILE &&EXTRACT
  LEVEL_DESC/A60 = &&LDESC;
  
  IN_DATE/MDYY = CHKIN_DATE;
  NBR_DAYS/D12 =  NUM_DAYS; 
  NNROOMS/D12 = IF (NBR_DAYS LT 0) AND (NUM_ROOMS LT 0)
                THEN ((NBR_DAYS*NUM_ROOMS)*(-1))
                ELSE NBR_DAYS*NUM_ROOMS;
  NEW_TOTAL_AMT/D12.2CS = TOTAL_AMT;
  ROOM_RT/D12.2 = ROOM_RATE;
  PRP_CITY/A25 = PROP_CITY;
  PRP_ST/A25 = PROP_STATE_CD;
  XFST_DPT/MDYY = IN_DATE;  

END
-RUN 

TABLEF FILE &&EXTRACT
PRINT 
  IN_DATE  
  INVOICE_NUM
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3 
  LEVEL4
  LEVEL5
  LEVEL6
  LEVEL7
  NEW_TOTAL_AMT
  NNROOMS  
  PASSNGR_NAME
  PNR_LOCATOR
  PROP_NAME  
  ROOM_RT AS 'ROOM_RATE'
  TKT_NUM 
  XFST_DPT
 -INCLUDE &HTLDATES 

-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
-* &&WHERE1
-* &&WHERE2
-* &&WHERE3
-* &&WHERE4
-* &&WHERE5
-* &&WHERE6
-* &&WHERE7
-* &&WHERE8
&&WHERE9
&&WHERE10


-INCLUDE RPTPARMS
ON TABLE HOLD AS HTLHOLD

END
-RUN



TABLE FILE HTLHOLD
PRINT 
  IN_DATE  
  INVOICE_NUM
  LEVEL1
  LEVEL2
  LEVEL3 
  LEVEL4
  LEVEL5
  LEVEL6
  LEVEL7
  NEW_TOTAL_AMT
  NNROOMS  
  PROP_NAME  
  ROOM_RATE 
  TKT_NUM 
  XFST_DPT
BY LEVEL_DESC
BY PASSNGR_NAME
BY PNR_LOCATOR
ON TABLE HOLD AS HTLHLD1
END
-RUN


TABLE FILE HTLHLD1
PRINT 
   NEW_TOTAL_AMT
   PROP_NAME
   IN_DATE
   ROOM_RATE
BY LEVEL_DESC
BY PASSNGR_NAME
BY PNR_LOCATOR
BY TKT_NUM
BY INVOICE_NUM
BY LEVEL1
BY LEVEL2
BY LEVEL3
BY LEVEL4
BY LEVEL5
BY LEVEL6
BY LEVEL7
ON TABLE HOLD AS BTCH
END
-RUN
 
