
-DEFAULT &DTRANGE = 1;
-DEFAULT &&CPFLAG = ' ';
-DEFAULT &&EXTRACT='SR_50';

-SET &AIRDATES  = &&WEB_PATH || 'AIRDATES.fex';
-SET &ATDATES   = &&WEB_PATH || 'ATDATES.fex';
-SET &ATDATES1  = &&WEB_PATH || 'ATDATES1.fex';
-SET &ATDATES2  = &&WEB_PATH || 'ATDATES2.fex';

-SET &RLIMIT = IF '&&DATETYPE.EVAL' EQ 'I' THEN 'WHERE RECORDLIMIT EQ 1' ELSE '';

TABLE FILE &&EXTRACT
BY AIR_KEY

-IF &DTRANGE EQ 2 GOTO 2DTRANGES;
-IF '&&CPFLAG.EVAL' EQ 'CY' GOTO CYDPTDATE 
- ELSE IF '&&CPFLAG.EVAL' EQ 'PY' GOTO PYDPTDATE; 

-2DTRANGES
-INCLUDE &ATDATES
-GOTO CYPYDONE;

-CYDPTDATE
-INCLUDE &ATDATES1
-GOTO CYPYDONE;

-PYDPTDATE
-INCLUDE &ATDATES2

-CYPYDONE

&RLIMIT
ON TABLE HOLD AS INITHOLD FORMAT FOCUS INDEX AIR_KEY
END        
-RUN


-IF '&&DATETYPE.EVAL' EQ 'I' THEN GOTO NOJOIN;

JOIN AIR_KEY IN &&EXTRACT.EVAL TO AIR_KEY IN INITHOLD
-NOJOIN