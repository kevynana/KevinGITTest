
-*01/04/05 - DV - ADDED CODE FOR GLOBAL CURRENCY
-*5/8/07 - DV - ADDED CODE SO UDID SELECTION WOULD WORK CORRECTLY
-INCLUDE SETECHO 

EX SETDBLS SETFILE=&&SETF
-RUN
-INCLUDE OTHPARMS
-SET &&DRILLABLE = 'N';

-* -SET &&RPT_HOLD = 'RPTHOLD';

-INCLUDE SetParmtime
-RUN
-**********************************************************************
-* DETERMINE IF WE HAVE WEB DEPLOYMENT OR LOCAL STAND ALONE
-* SET PATH FOR SAVING THE SETFILE
-**********************************************************************
-******LOCAL DEPLOYMENT
-IF &&DEPLOY EQ 'W' GOTO SETWEB;
-SET &&SETFNM= &&LOCPATH || &&DTTMSTRM ||'.FTM';
COPY &&SETF &&SETFNM
-RUN

-******WEB DEPLOYMENT
-SETWEB
-SET &&WEBPATH = '&&WEBSRV.EVAL' || '\TTWEB\ ' || &&ROLLUP || '\ '||&&UNAME.EVAL|| '\';
-SET &&SETFNM = &&WEBPATH || &&DTTMSTRM ||'.FTM';

COPY &&VARFWEB &&SETFNM
-INCLUDE SetBDBsForDrill
-RUN

FILEDEF AUSEINCL DISK &&AUSEPASS
-RUN
FILEDEF CUSEINCL DISK &&CUSEPASS
-RUN
FILEDEF HUSEINCL DISK &&HUSEPASS
-RUN
FILEDEF LUSEINCL DISK &&LUSEPASS
-RUN

-INCLUDE SELCATQT
-RUN

EX &&CATQTRPR
-RUN

FILEDEF AUSEINCL CLEAR
-RUN
FILEDEF CUSEINCL CLEAR
-RUN
FILEDEF HUSEINCL CLEAR
-RUN
FILEDEF LUSEINCL CLEAR
-RUN

-*set default value for pro fee
-SET &AIRPROF = 'N';
-SET &CARPROF = 'N';
-SET &HTLPROF = 'N';
-SET &LIMPROF = 'N';
-SET &MISCPROF = 'N';
-DEFAULT &&NOAIR = 'Y';
-DEFAULT &&NOHTL = 'Y';
-DEFAULT &&NOCAR = 'Y';
-DEFAULT &&NOLIM = 'Y';
 
-IF '&&SETF.EVAL' EQ 'HREXPNS' THEN GOTO HROM;


-INCLUDE PFXUSE
-RUN
-GOTO AirExtract;

-HROM
-INCLUDE HROM_PFXUSE
-RUN


-AirExtract
 

EX AIRUSE
-RUN

-SET &&RPTGRP = 'AIR';



EX DVAIREX
-RUN


EX CARUSE
-RUN

-SET &&RPTGRP = 'CAR'; 

-* INSERT OF NEW CODE
EX UDIDGEN
-RUN


EX DVCAREX
-RUN


EX LIMUSE
-RUN


EX DVLIMEX
-RUN

EX HTLUSE
-RUN

-SET &&RPTGRP = 'HTL';
-*EX UDIDGEN
-*-RUN


EX UDIDGEN
-RUN

EX DVHTLEX
-RUN

-*-IF &&NOAIR EQ 'Y' AND &&NOHTL EQ 'Y' AND &&NOCAR EQ 'Y' THEN GOTO NORECORDS;

-IF  '&MISCPROF.EVAL' EQ 'N' THEN GOTO Summary;  


EX DVMISCEX
-RUN


-Summary
-IF '&&SETF.EVAL' EQ 'DVEXPFEE' THEN GOTO FeeOnly;

-*- IF '&&ROLLUP.EVAL' EQ 'APTECH-R' OR 'AVIONS-R' OR 'BEECHE-R' OR 'BKV-R' OR 
-*- 'CLARKN-R' OR 'COALIT-R' OR 'CYQUEST-R' OR 'DATASH-R' OR 'DELTAA-R' OR  
-*- 'FACETT-R' OR 'IHEALT-R' OR 'JOHNMA-R' OR 'MTXRES-R' OR 'NFICON-R' OR 
-*- 'RAMPAR-R' OR 'REFORM-R' OR 'RIMASY-R' OR 'ROYSTO-R' OR 'THOMCO-R' OR   
-*- 'TSSPHO-R' OR 'TUGTEC-R' OR 'VANGUA-R' OR 'WELLST-R' AND 
-*- '&&SETF.EVAL' EQ 'DVEXPNS' THEN GOTO FeeOnly;

EX DVSUM
-RUN
-GOTO Cont



-FeeOnly

EX DVSUM2
-RUN


-Cont
-* REJ ADDED TO TRAP ERRORS
-SET &&FEXNOW=&&EXPARM;
-INCLUDE ERRORCHK
-IF &&RET GT 1 GOTO XXIT;
-* REJ ADDED TO TRAP ERRORS

-IF &RECORDS GT 0 THEN GOTO DOIT;

-NORECORDS
-SET &&RPTSUF = 'MSG';
-INCLUDE FDEFRPTS
-RUN
DEFINE FILE BRPTINST
EMPTY/A35 = 'NO RECORDS FOUND FOR THIS SELECTION';
NOWTOD/A8 WITH ROLLUP_CODE = HHMMSS (NOWTOD);
END
TABLE FILE BRPTINST
-INCLUDE HEADAIR
PRINT EMPTY AS 'REPORT,MESSAGE' 
BY ROLLUP_CODE AS 'ROLLUP,CODE'
BY RPT_NAME AS 'REPORT,NAME'
BY SELECT_LEV AS 'BREAK,LEVEL'
IF INST_KEY EQ &&IKEY
IF RECORDLIMIT EQ 1
-INCLUDE FOOTERDT
ON TABLE SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET PAGE-NUM OFF
ON TABLE SET STYLE *
-INCLUDE &&DTSTY
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
-GOTO XXIT

-DOIT

-XXIT

