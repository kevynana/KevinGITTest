-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Created for the new quarterly review -  DV
-* Fixed Average Daily Rate % to include space after increase/decrease
-******************************************************************************
-INCLUDE SETECHO
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

-SET &POS =  1;
-SET &POS1 = &POS + 8;
-SET &POS2 = &POS1 + 10; 
-SET &POS3 = &POS2 + 10 ;
-SET &POS4 = &POS3 + 4;
-SET &POS5 = &POS4 + 11;
-SET &POS6 = &POS5 + 20;
-SET &POS7 = &POS6 + 10;
-SET &POS8 = &POS7 + 9;
-SET &POS9 = &POS8 + 4;

-* Set up QTRLY average daily rate variables

-SET &CNT = 1;
-REPEAT QtrAdr 8 TIMES
-SET &TRAN.&CNT = ' ';
-SET &QDAY.&CNT = ' ';
-SET &QDAYA.&CNT = ' ';
-SET &BQADR.&CNT = ' ';
-SET &PQADR.&CNT = ' ';
-SET &QAMTA.&CNT = ' ';
-SET &BQADRA.&CNT = ' ';
-SET &PQADRA.&CNT = ' ';
-SET &CNT = &CNT + 1;
-QtrAdr


-* Set up ytd average daily rate variables

-SET &CNT = 1;
-REPEAT YrAdr 2 TIMES
-SET &XY.&CNT = ' ';
-SET &YDAY.&CNT = ' ';
-SET &YDAYA.&CNT = ' ';
-SET &BYADR.&CNT = ' ';
-SET &PYADR.&CNT = ' ';
-SET &YAMTA.&CNT = ' ';
-SET &BYADRA.&CNT = ' ';
-SET &PYADRA.&CNT = ' ';
-SET &CNT = &CNT + 1;
-YrAdr



-* Set up ADR by city variables


-SET &CNT = 1;
-REPEAT CityAdr 10 TIMES
-SET &PNAME.&CNT = ' ';
-SET &CDAY.&CNT = 0;
-SET &CDAYA.&CNT = ' ';
-SET &CAMT.&CNT = 0O' ;
-SET &CAMTA.&CNT = ' ' ;
-SET &CADRB.&CNT = 0;
-SET &CADRBA.&CNT = ' ' ;
-SET &CADRP.&CNT = 0;
-SET &CADRPA.&CNT = ' ';

-SET &CNT = &CNT + 1;
-CityAdr
 

 -* Initialize footing variables
 -SET &LN1P1 = ' ';
 -SET &LN2P1 = ' ';
 -SET &LN3P1 = ' ';
 -SET &LN4P1 = ' ';
 -SET &LN5P1 = ' ';
 -SET &LN6P1 = ' ';
 -SET &LN7P1 = ' ';
 -SET &LN8P1 = ' ';            
 -SET &LN9P1 = ' ';
 -SET &LN10P1 = ' '; 
 -SET &LN1P2 = ' ';
 -SET &LN2P2 = ' '; 
 -SET &LN3P2 = ' ';
 -SET &LN4P2 = ' '; 
 -SET &LN5P2 = ' '; 
 -SET &LN6P2 = ' ';
 -SET &LN7P2 = ' ';  
 -SET &LN8P2 = ' '; 
 -SET &LN9P2 = ' '; 
 -SET &LN10P2 = ' ';  
 -SET &CSPL1 = ' '; 
 -SET &BCSPL1 = ' ';  
 -SET &CDPL1 = ' '; 
 -SET &BCDPL1 = ' ';  
 -SET &ADRPL1 = ' '; 
 -SET &BADRPL1 = ' '; 
 -SET &YQCNT1 = ' ';
 -SET &YQCNT2 = ' ';
 -SET &PYFLG = 'N';
 

-* Compute ADR for Peer 
 
DEFINE FILE QRCVDR
ROLL/A8 = IF ROLLUP_CODE EQ '&&BASEROLL.EVAL' THEN '&&BASEROLL.EVAL' ELSE
           'PEER-R';
END
TABLE FILE QRCVDR
SUM CDAY
    CBOOKINGS
    CAMT
COMPUTE PADR/D6M = IF ((CDAY LT 0) AND (CDAY GT (-1))) THEN 0 ELSE
                  CAMT/CDAY;
COMPUTE PALR/D6.1 = IF ((CBOOKINGS LT 0) AND (CBOOKING GT (-1))) THEN 0 ELSE
                  CDAY/CBOOKINGS;
BY ROLL
BY VENDOR_NAME
WHERE ROLLUP_CODE NE '&&BASEROLL.EVAL'
ON TABLE HOLD AS PVDR
END
-RUN


-* Compute ADR for BaseRoll
TABLE FILE QRCVDR
SUM CDAY
    CBOOKINGS
    CAMT
    PDAY
    PBOOKINGS
    PAMT
COMPUTE BCADR/D6M = IF ((CDAY LT 0) AND (CDAY GT (-1))) THEN 0 ELSE
                  CAMT/CDAY;
COMPUTE BCALR/D6.1 = IF ((CBOOKINGS LT 0) AND (CBOOKING GT (-1))) THEN 0 ELSE
                  CDAY/CBOOKINGS; 
COMPUTE BPADR/D6M = IF ((PDAY LT 0) AND (PDAY GT (-1))) THEN 0 ELSE
                  PAMT/PDAY;                  
BY RANK
BY ROLL
BY VENDOR_NAME
WHERE ROLL EQ '&&BASEROLL.EVAL'
ON TABLE HOLD AS BVDR
END
-RUN


MATCH FILE BVDR
PRINT CDAY
      CBOOKINGS
      CAMT
      PDAY
      PBOOKINGS
      PAMT
      BCADR
      BCALR
      BPADR
      RANK
BY VENDOR_NAME
ON TABLE HOLD
RUN
FILE PVDR
SUM PADR
    PALR
BY VENDOR_NAME
AFTER MATCH HOLD AS BVDR2 OLD-OR-NEW
END
-RUN

DEFINE FILE BVDR2
RANK/A9 = IF VENDOR_NAME EQ 'ALL OTHER' THEN 'OTHER' ELSE RANK;
END
TABLE FILE BVDR2
SUM CDAY
    PCT.CDAY/D6.2 AS 'CDAYPCT'
    CBOOKINGS
    CAMT
    PDAY
    PCT.PDAY/D6.2 AS 'PDAYPCT'
    PBOOKINGS
    PAMT
    BCADR
    BCALR
    BPADR
    PADR
    PALR    
BY RANK 
BY VENDOR_NAME    
ON TABLE HOLD AS BVDR3
END
-RUN


TABLE FILE BVDR3
PRINT CDAY
    CDAYPCT
    CBOOKINGS
    CAMT
    PDAY
    PDAYPCT
    PBOOKINGS
    PAMT
    BCADR
    BCALR
    BPADR
    PADR
    PALR    
BY RANK
BY VENDOR_NAME
ON TABLE HOLD AS BVDR4 FORMAT FOCUS
END
-RUN


-*Compute BaseRoll total

DEFINE FILE BVDR
VENDOR_NAME/A12 = 'TOTAL';
RANK/A9 = 'TOTAL';
END
TABLE FILE BVDR
SUM CDAY 
    CBOOKINGS 
    CAMT  
    PDAY 
    PBOOKINGS
    PAMT
COMPUTE BCADR/D6M= IF ((CDAY LT 0) AND (CDAY GT (-1))) THEN 0 ELSE
                  CAMT/CDAY;
COMPUTE BCALR/D6.1 = IF ((CBOOKINGS LT 0) AND (CBOOKING GT (-1))) THEN 0 ELSE
                  CDAY/CBOOKINGS; 
COMPUTE BPADR/D6M = IF ((PDAY LT 0) AND (PDAY GT (-1))) THEN 0 ELSE
                  PAMT/PDAY; 
BY RANK
BY VENDOR_NAME
ON TABLE HOLD AS BVDRTOT
END
-RUN

-* Compute Peer ADR and Avg length of rental for total Peer

DEFINE FILE PVDR
VENDOR_NAME/A12 = 'TOTAL';
RANK/A9 = 'TOTAL';
END
TABLE FILE PVDR
SUM CDAY
    CBOOKINGS
    CAMT
COMPUTE PADR/D6M = IF ((CDAY LT 0) AND (CDAY GT (-1))) THEN 0 ELSE
                  CAMT/CDAY;
COMPUTE PALR/D6.1 = IF ((CBOOKINGS LT 0) AND (CBOOKING GT (-1))) THEN 0 ELSE
                  CDAY/CBOOKINGS;
BY RANK                  
BY VENDOR_NAME
ON TABLE HOLD AS PVDRTOT
END
-RUN

MATCH FILE BVDRTOT
PRINT CDAY
      CBOOKINGS
      CAMT
      PDAY
      PBOOKINGS
      PAMT
      BCADR
      BCALR
      BPADR
BY RANK      
BY VENDOR_NAME
ON TABLE HOLD
RUN
FILE PVDRTOT
SUM PADR
    PALR
BY RANK    
BY VENDOR_NAME
AFTER MATCH HOLD AS BVDRTOT2 OLD-OR-NEW
END
-RUN

TABLE FILE BVDRTOT2
SUM CDAY
    PCT.CDAY/D6.2 AS 'CDAYPCT' 
      CBOOKINGS
      CAMT
      PDAY
      PCT.PDAY/D6.2 AS 'PDAYPCT' 
      PBOOKINGS
      PAMT
      BCADR
      BCALR
      BPADR
      PADR
      PALR
BY RANK
BY VENDOR_NAME
ON TABLE HOLD AS BVDRTOT3  
END
-RUN

TABLE FILE BVDRTOT3
PRINT CDAY
    CDAYPCT
    CBOOKINGS
    CAMT
    PDAY
    PDAYPCT
    PBOOKINGS
    PAMT
    BCADR
    BCALR
    BPADR
    PADR
    PALR    
BY RANK
BY VENDOR_NAME
ON TABLE HOLD AS BVDRTOT4 FORMAT FOCUS
END
-RUN


-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HRANK1=&HLDPATH || 'BVDR4.FOC';
-SET &HRANK2=&HLDPATH || 'BVDRTOT4.FOC';
-RUN

USE CLEAR *

USE ADD 
&HRANK1 AS BVDR4
&HRANK2 AS BVDR4
END
-RUN

TABLE FILE HOLDCARB
BY TRAN
WHERE PRIOR EQ 'Y'
ON TABLE SAVE
END
-RUN


-SET &PYFLG = IF &LINES LT 4 THEN 'N' ELSE 'Y';



DEFINE FILE BVDR4
  APDAYPCT/A6 = FTOA(PDAYPCT,'(D6.2)',APDAYPCT);
  APDAYPCT1/A7 = APDAYPCT | '%';
  ACDAYPCT/A6 = FTOA(CDAYPCT,'(D6.2)',ACDAYPCT);
  ACDAYPCT1/A7 = ACDAYPCT | '%';
  VNDR/A12 = LCWORD(30, VENDOR_NAME, VNDR);
END 
TABLE FILE BVDR4
PRINT CDAY  
      ACDAYPCT1  
      CBOOKINGS  
      CAMT/D12M   
      BCADR  
      PADR  
      BCALR  
      PALR 
      PAMT
      APDAYPCT1
      BPADR 
BY RANK  
BY VNDR  
-* ON TABLE SET ONLINE-FMT PDF
ON TABLE HOLD AS TOPCVNDR  
END
-RUN
 

-* Average daily rate by qtr for baseroll

TABLE FILE QRCADR
SUM NBR_DAYS
    TC_AMT
COMPUTE BCADR/D6M = IF ((NBR_DAYS LT 0) AND (NBR_DAYS GT (-1))) THEN 0 ELSE
                  TC_AMT/NBR_DAYS;    
BY YEAR
BY TRAN

WHERE ROLLUP_CODE EQ '&&BASEROLL.EVAL'
ON TABLE HOLD AS BASEADR
END
-RUN

-* Average daily rate by qtr for peer

DEFINE FILE QRCADR
ROLL/A8 = IF ROLLUP_CODE EQ '&&BASEROLL.EVAL' THEN '&&BASEROLL.EVAL' ELSE 'PEER-R';
END
TABLE FILE QRCADR
SUM NBR_DAYS
    TC_AMT
COMPUTE PGADR/D6M = IF ((NBR_DAYS LT 0) AND (NBR_DAYS GT (-1))) THEN 0 ELSE
                  TC_AMT/NBR_DAYS; 
BY YEAR
BY TRAN
WHERE ROLL EQ 'PEER-R'
ON TABLE HOLD AS PEERADR
END
-RUN

MATCH FILE BASEADR
PRINT NBR_DAYS AS 'QDAY'
      TC_AMT AS 'QAMT'
      BCADR AS 'BQADR'
BY YEAR
BY TRAN
ON TABLE HOLD
RUN
FILE PEERADR
PRINT PGADR AS 'PQADR'
BY YEAR
BY TRAN
AFTER MATCH HOLD AS QRADRT OLD-OR-NEW
END
-RUN

TABLE FILE QRADRT
PRINT QDAY QAMT BQADR PQADR
BY YEAR NOPRINT
BY TRAN
ON TABLE SAVE AS QRADR
END
-RUN


-IF &LINES EQ 0 THEN GOTO NoQtr;

-SET &CNT = 0;
-REPEAT QREND &LINES TIMES
-READ QRADR NOCLOSE &TRAN.7. &QDAY.8. &QAMT.12. &BQADR.6. &PQADR.6. 
-SET &CNT = &CNT + 1;
-SET &TRAN.&CNT = '&TRAN.EVAL';
-SET &QDAY.&CNT = &QDAY;
-SET &QAMT.&CNT = &QAMT;
-SET &BQADR.&CNT = &BQADR;
-SET &PQADR.&CNT = &PQADR;

EX FMTNUMBER VALUE=&QDAY ,DOLLAR='N',LEN=6
-RUN
-SET &QDAYA.&CNT = &&RETVAL;
-RUN
EX FMTNUMBER VALUE=&QAMT,LEN=11  
-RUN
-SET &QAMTA.&CNT = &&RETVAL; 
EX FMTNUMBER VALUE=&BQADR, LEN=5
-RUN
-SET &BQADRA.&CNT = &&RETVAL; 
EX FMTNUMBER VALUE=&PQADR, LEN=5
-RUN
-SET &PQADRA.&CNT = &&RETVAL; 
-QREND

-CLOSE QRADR
-SET &NBQTRS = &LINES;


TABLE FILE QRADRT
COUNT TRAN AS 'YQCNT'
BY YEAR
ON TABLE HOLD AS YRTEST
END
-RUN

DEFINE FILE YRTEST
YQ_CNT/A1 = EDIT(YQCNT, '$$$$9');
END
TABLE FILE YRTEST
PRINT YQ_CNT AS 'YQCNT'
BY YEAR NOPRINT
ON TABLE SAVE AS YQCNT
END
-RUN


-SET &CNT = 0;
-REPEAT QCNTEND &LINES TIMES
-READ YQCNT NOCLOSE &YQCNT.1.
-SET &CNT = &CNT + 1;
-SET &YQCNT.&CNT = &YQCNT;
 
-QCNTEND
-CLOSE SAVE



-NoQtr
-* Average daily rate by year for baseroll
 
TABLE FILE QRCADR
SUM NBR_DAYS AS 'YDAY'
    TC_AMT AS 'YAMT'
COMPUTE BYADR/D6M = IF ((NBR_DAYS LT 0) AND (NBR_DAYS GT (-1))) THEN 0 ELSE
                  TC_AMT/NBR_DAYS;    
BY YEAR
WHERE ROLL EQ '&&BASEROLL.EVAL'
ON TABLE HOLD AS BYEAR
END
-RUN

-* Average daily rate by year for peer

DEFINE FILE QRCADR
ROLL/A8 = IF ROLLUP_CODE EQ '&&BASEROLL.EVAL' THEN '&&BASEROLL.EVAL' ELSE 'PEER-R';
END
TABLE FILE QRCADR
SUM NBR_DAYS
    TC_AMT
COMPUTE PYADR/D6M = IF ((NBR_DAYS LT 0) AND (NBR_DAYS GT (-1))) THEN 0 ELSE
                  TC_AMT/NBR_DAYS; 
BY YEAR
WHERE ROLL EQ 'PEER-R'
ON TABLE HOLD AS PYEAR
END
-RUN

MATCH FILE BYEAR
PRINT YDAY
      YAMT
      BYADR
BY YEAR
ON TABLE HOLD
RUN
FILE PYEAR
PRINT PYADR
BY YEAR
AFTER MATCH HOLD AS QRYADR OLD-OR-NEW
END
-RUN

DEFINE FILE QRYADR
YRLBL/A7 = 'YTD' || YEAR;
END
TABLE FILE QRYADR
PRINT YDAY YAMT BYADR PYADR 
BY YRLBL
ON TABLE SAVE AS YTDADR
END
-RUN



- IF &LINES EQ 0 THEN GOTO NoYear;
-SET &CNT = 0;
-REPEAT YTDEND &LINES TIMES
-READ YTDADR NOCLOSE &XY.7. &YDAY.8. &YAMT.12. &BYADR.6. &PYADR.6. 
-SET &CNT = &CNT + 1;
-SET &XY.&CNT = '&XY.EVAL';
-SET &YDAY.&CNT = &YDAY;
-SET &YAMT.&CNT = &YAMT;
-SET &BYADR.&CNT = &BYADR;
-SET &PYADR.&CNT = &PYADR;

EX FMTNUMBER VALUE=&YDAY ,DOLLAR='N',LEN=6

-RUN
-SET &YDAYA.&CNT = &&RETVAL; 
-RUN
EX FMTNUMBER VALUE=&YAMT,LEN=11
-RUN
-SET &YAMTA.&CNT = &&RETVAL; 
EX FMTNUMBER VALUE=&BYADR, LEN=5
-RUN
-SET &BYADRA.&CNT = &&RETVAL; 
EX FMTNUMBER VALUE=&PYADR, LEN=5
-RUN
-SET &PYADRA.&CNT = &&RETVAL; 
-YTDEND
-CLOSE YTDADR

-NoYear

-* Base roll ADR by city
DEFINE FILE QRCCTY
PC_NAME/A20 = LCWORD(20, PICK_CTY_NAME, PC_NAME);
ROLL/A8 = IF ROLLUP_CODE EQ '&&BASEROLL.EVAL' THEN '&&BASEROLL.EVAL' ELSE 'PEER-R';
END
TABLE FILE QRCCTY
SUM CAMT 
    CDAY
COMPUTE CADRB/D6M = IF ((CDAY LT 0) AND (CDAY GT (-1))) THEN 0 ELSE
                   CAMT/CDAY;
BY RANK                   
BY PC_NAME
WHERE ROLL EQ '&&BASEROLL.EVAL'
ON TABLE HOLD AS BCITY
END
-RUN

-* Peer group ADR by city

TABLE FILE QRCCTY
SUM CAMT 
    CDAY
COMPUTE CADRP/D6M = IF ((CDAY LT 0) AND (CDAY GT (-1))) THEN 0 ELSE
                   CAMT/CDAY;
BY PC_NAME
WHERE ROLL EQ 'PEER-R'
ON TABLE HOLD AS PCITY
END
-RUN

MATCH FILE BCITY
PRINT CDAY
      CAMT
      CADRB
      RANK
BY PC_NAME
ON TABLE HOLD
RUN
FILE PCITY
PRINT CADRP
BY PC_NAME
AFTER MATCH HOLD AS BCITY2 OLD-OR-NEW
END
-RUN

-SET &CNT = 1;
-REPEAT ENDINI 9 TIMES
-SET &PNAME.&CNT = ' ';
-SET &CDAYA.&CNT = ' ';
-SET &CAMTA.&CNT = ' ';
-SET &CADRBA.&CNT = ' ';
-SET &CADRPA.&CNT = ' ';
-SET &CNT = &CNT + 1;
-ENDINI

DEFINE FILE BCITY2
RANK/A9 = IF PC_NAME EQ 'All Other' THEN 'OTHER' ELSE RANK;
END
TABLE FILE BCITY2
PRINT CDAY
      CAMT
      CADRB
      CADRP
BY RANK NOPRINT
BY PC_NAME
ON TABLE SAVE AS BCITY3
END
-RUN

-SET &CBCLNS = &LINES;
-SET &TOTLNS = &CBCLNS + 1;



-IF &LINES EQ 0 THEN GOTO NoCvdr;

-SET &CNT = 0;
-REPEAT BASECEND &LINES TIMES
-READ BCITY3 NOCLOSE &PNAME.20. &CDAY.8. &CAMT.12. &CADRB.6. &CADRP.6. 
-SET &CNT = &CNT + 1;
-SET &PNAME.&CNT = '&PNAME.EVAL';
-SET &CDAY.&CNT = &CDAY;
-SET &CAMT.&CNT = &CAMT;
-SET &CADRB.&CNT = &CADRB;
-SET &CADRP.&CNT = &CADRP;
EX FMTNUMBER VALUE=&CDAY, DOLLAR='N',LEN=6
-RUN
-SET &CDAYA.&CNT = &&RETVAL; 
EX FMTNUMBER VALUE=&CAMT, LEN=11
-RUN
-SET &CAMTA.&CNT = &&RETVAL; 
EX FMTNUMBER VALUE=&CADRB, LEN=5
-RUN
-SET &CADRBA.&CNT = &&RETVAL; 
EX FMTNUMBER VALUE=&CADRP, LEN=5
-RUN
-SET &CADRPA.&CNT = &&RETVAL; 
-BASECEND
-CLOSE BCITY3

-NoCvdr
 
DEFINE FILE BCITY
PC_NAME/A20 = 'Total';
END
TABLE FILE BCITY
SUM CAMT AS 'CYAMT'
    CDAY AS 'CYDAY'
COMPUTE YADRB/D6M = IF ((CDAY LT 0) AND (CDAY GT (-1))) THEN 0 ELSE
                   CAMT/CDAY;                   
BY PC_NAME
ON TABLE HOLD AS YBCITY
END
-RUN

DEFINE FILE PCITY
PC_NAME/A20 = 'Total';
END
TABLE FILE PCITY
SUM CAMT
    CDAY
COMPUTE YADRP/D6M = IF ((CDAY LT 0) AND (CDAY GT (-1))) THEN 0 ELSE
                   CAMT/CDAY;        
BY PC_NAME
ON TABLE HOLD AS YPCITY
END
-RUN 

MATCH FILE YBCITY
PRINT CYAMT
      CYDAY
      YADRB
BY PC_NAME
ON TABLE HOLD
RUN
FILE YPCITY
PRINT YADRP
BY PC_NAME
AFTER MATCH HOLD AS YRCITY OLD-OR-NEW
END
-RUN

TABLE FILE YRCITY
PRINT CYDAY CYAMT YADRB YADRP
BY PC_NAME
ON TABLE SAVE AS YRCITY1
END
-RUN

-IF &LINES EQ 0 THEN GOTO NoCity

-SET &CNT = &TOTLNS;
-REPEAT YYEND &LINES TIMES
-READ YRCITY1 NOCLOSE &PCNAME.20. &CYDAY.8. &CYAMT.12. &YADRB.6. &YADRP.6. 

-SET &PNAME.&CNT = '&PCNAME.EVAL';
-SET &CDAY.&CNT = &CYDAY;
-SET &CAMT.&CNT = &CYAMT;
-SET &CADRB.&CNT = &YADRB;
-SET &CADRP.&CNT = &YADRP;
EX FMTNUMBER VALUE=&CYAMT, LEN=11
-RUN
-SET &CAMTA.&CNT = &&RETVAL; 
EX FMTNUMBER VALUE=&CYDAY, DOLLAR='N',LEN=6
-RUN
-SET &CDAYA.&CNT = &&RETVAL; 

EX FMTNUMBER VALUE=&YADRB, LEN=5
-RUN
-SET &CADRBA.&CNT = &&RETVAL; 
EX FMTNUMBER VALUE=&YADRP, LEN=5
-RUN
-SET &CADRPA.&CNT = &&RETVAL; 
-YYEND
-CLOSE YRCITY1


-NoCity
-* Get pcts of current year over prior year for comment section

TABLE FILE HOLDCARB
BY TRAN
WHERE PRIOR EQ 'Y'
ON TABLE SAVE 
END
-RUN

-*NOT sufficient prior data for comparison
-IF &LINES LT 4 THEN GOTO NoCmt;



TABLE FILE BVDRTOT
SUM CDAY 
    CBOOKINGS 
    CAMT  
    PDAY 
    PBOOKINGS
    PAMT
    BCALR
    BCADR/D6
    BPADR/D6
COMPUTE CSP/D6 = IF ((CAMT LT 1) AND (CAMT GT (-1))) THEN 0 ELSE
                   (((CAMT - PAMT)/PAMT) * 100);
COMPUTE CSVAR/D12 = CAMT - PAMT;
COMPUTE CDVAR/D12 = CDAY - PDAY;
COMPUTE CDP/D6 = IF ((CDAY LT 1) AND (CDAY GT (-1))) THEN 0 ELSE
                   (((CDAY - PDAY)/PDAY) * 100);  
COMPUTE ADRVAR/D6M  = (BCADR - BPADR);                 
COMPUTE ADRP/D6.1  = IF ((BCADR LT 1) AND (BCADR GT (-1))) THEN 0 ELSE
                   (((BCADR - BPADR)/BPADR) * 100);
ON TABLE HOLD AS YTDPCT
END
-RUN
 

TABLE FILE YTDPCT
PRINT CSP CSVAR CDVAR CDP ADRVAR ADRP
ON TABLE HOLD AS YTDPCT1
END
-RUN


-IF &LINES EQ 0 THEN GOTO NoCmt;

DEFINE FILE YTDPCT1
ABSCSP/D6 = ABS(CSP);
ABSCDP/D6 = ABS(CDP);
ABSADR/D6.1 = ABS(ADRP);
END
TABLE FILE YTDPCT1
PRINT CSP CSVAR CDVAR CDP ADRVAR ADRP ABSCSP ABSCDP ABSADR
ON TABLE SAVE
END
-RUN
 
-READ SAVE NOCLOSE &CSP.6. &CSVAR.12. &CDVAR.12 &CDP.6. &ADRVAR.6. &ADRP.6 &ABSCSP.6. &ABSCDP.6. &ABSADR.6.

-CLOSE SAVE

-* Footing lines for comments

-*Comment lines

-IF &ABSCSP EQ 100  THEN GOTO NoCspcmt;

EX FMTNUMBER VALUE=&ABSCSP,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSCSP = &&RETVAL;

EX FMTNUMBER VALUE=&ABSCDP,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSCDP = &&RETVAL;

EX FMTNUMBER VALUE=&ABSADR,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSADR = &&RETVAL;
 
-SET &CSPL1 = IF &CSVAR GT 0 THEN ' increased' | '&ABSCSP.EVAL%' ELSE IF &CSVAR LT 0 THEN ' decreased' | '&ABSCSP.EVAL%' ELSE ' remains same';
-SET &BCSPL1 = 'Car spend' | '&CSPL1.EVAL' | ' year to date.';

-NoCspcmt;
 
-IF &ABSCDP EQ 100 THEN GOTO NoCdrcmt;
-SET &CDPL1 = IF &CDVAR GT 0 THEN ' increased' | '&ABSCDP.EVAL%' ELSE IF &CDVAR LT 0 THEN ' decreased' | '&ABSCDP.EVAL%' ELSE ' remains same';
-SET &BCDPL1 = 'Car rental days' | '&CDPL1.EVAL' | ' year to date.';

-NoCdrcmt

-IF &ABSADR EQ 100 THEN GOTO NoADRcmt;
-SET &ADRPL1 = IF &ADRVAR GT 0 THEN ' increased ' | '&ABSADR.EVAL%' ELSE IF &ADRVAR LT 0 THEN ' decreased ' | '&ABSADR.EVAL%' ELSE ' remains same ';
-SET &BADRPL1 = 'Average daily rate' | '&ADRPL1.EVAL' | ' year to date.';

-NoADRcmt
-*** The end of comment section ***
-NoCmt;
-GOTO NEWTEST;
-* Footing lines
-SET &LN1P1 = '<&POS.EVAL &TRAN1.EVAL <&POS1.EVAL &QDAYA1.EVAL <&POS2.EVAL &QAMTA1.EVAL <&POS3.EVAL &BQADRA1.EVAL <&POS4.EVAL &PQADRA1.EVAL';
-SET &LN2P1 = IF &NBQTRS EQ 2 THEN '<&POS.EVAL &XY1.EVAL <&POS1.EVAL &YDAYA1.EVAL <&POS2.EVAL &YAMTA1.EVAL <&POS3.EVAL &BYADRA1.EVAL <&POS4.EVAL &PYADRA1.EVAL' ELSE
-               '<&POS.EVAL &TRAN2.EVAL <&POS1.EVAL &QDAYA2.EVAL <&POS2.EVAL &QAMTA2.EVAL <&POS3.EVAL &BQADRA2.EVAL <&POS4.EVAL &PQADRA2.EVAL' ;
-SET &LN3P1 = IF &NBQTRS EQ 2 THEN '<&POS.EVAL &TRAN2.EVAL <&POS1.EVAL &QDAYA2.EVAL <&POS2.EVAL &QAMTA2.EVAL <&POS3.EVAL &BQADRA2.EVAL <&POS4.EVAL &PQADRA2.EVAL' ELSE
-               IF &NBQTRS EQ 4 THEN '<&POS.EVAL &XY1.EVAL <&POS1.EVAL &YDAYA1.EVAL <&POS2.EVAL &YAMTA1.EVAL <&POS3.EVAL &BYADRA1.EVAL <&POS4.EVAL &PYADRA1.EVAL' ELSE
-               '<&POS.EVAL &TRAN3.EVAL <&POS1.EVAL &QDAYA3.EVAL <&POS2.EVAL &QAMTA3.EVAL <&POS3.EVAL &BQADRA3.EVAL <&POS4.EVAL &PQADRA3.EVAL';
-SET &LN4P1 = IF &NBQTRS EQ 2 THEN '<&POS.EVAL &XY2.EVAL <&POS1.EVAL &YDAYA2.EVAL <&POS2.EVAL &YAMTA2.EVAL <&POS3.EVAL &BYADRA2.EVAL <&POS4.EVAL &PYADRA2.EVAL' ELSE
-              IF &NBQTRS  EQ 4 THEN '<&POS.EVAL &TRAN3.EVAL <&POS1.EVAL &QDAYA3.EVAL <&POS2.EVAL &QAMTA3.EVAL <&POS3.EVAL &BQADRA3.EVAL <&POS4.EVAL &PQADRA3.EVAL' ELSE
-              IF &NBQTRS EQ 6 THEN '<&POS.EVAL &XY1.EVAL <&POS1.EVAL &YDAYA1.EVAL <&POS2.EVAL &YAMTA1.EVAL <&POS3.EVAL &BYADRA1.EVAL <&POS4.EVAL &PYADRA1.EVAL' ELSE
-              '<&POS.EVAL &TRAN4.EVAL <&POS1.EVAL &QDAYA4.EVAL <&POS2.EVAL &QAMTA4.EVAL <&POS3.EVAL &BQADRA4.EVAL <&POS4.EVAL &PQADRA4.EVAL';
-SET &LN5P1 = IF &NBQTRS EQ 2 THEN ' ' ELSE
-              IF &NBQTRS GE 4 AND &NBQTRS LE 6 THEN '<&POS.EVAL &TRAN4.EVAL <&POS1.EVAL &QDAYA4.EVAL <&POS2.EVAL &QAMTA4.EVAL <&POS3.EVAL &BQADRA4.EVAL <&POS4.EVAL &PQADRA4.EVAL' ELSE
-               '<&POS.EVAL &XY1.EVAL <&POS1.EVAL &YDAYA1.EVAL <&POS2.EVAL &YAMTA1.EVAL <&POS3.EVAL &BYADRA1.EVAL <&POS4.EVAL &PYADRA1.EVAL';
-SET &LN6P1 = IF &NBQTRS EQ 2 THEN ' ' ELSE
-              IF &NBQTRS EQ 4 THEN '<&POS.EVAL &XY2.EVAL <&POS1.EVAL &YDAYA2.EVAL <&POS2.EVAL &YAMTA2.EVAL <&POS3.EVAL &BYADRA2.EVAL <&POS4.EVAL &PYADRA2.EVAL' ELSE
-              '<&POS.EVAL &TRAN5.EVAL <&POS1.EVAL &QDAYA5.EVAL <&POS2.EVAL &QAMTA5.EVAL <&POS3.EVAL &BQADRA5.EVAL <&POS4.EVAL &PQADRA5.EVAL';
-SET &LN7P1 = IF &NBQTRS GE 2 AND &NBQTRS LE 4  THEN ' ' ELSE
-               '<&POS.EVAL &TRAN6.EVAL <&POS1.EVAL &QDAYA6.EVAL <&POS2.EVAL &QAMTA6.EVAL <&POS3.EVAL &BQADRA6.EVAL <&POS4.EVAL &PQADRA6.EVAL' ;
-SET &LN8P1 = IF &NBQTRS GE 2 AND &NBQTRS LE 4 THEN ' ' ELSE
-              IF &NBQTRS EQ 6 THEN '<&POS.EVAL &XY2.EVAL <&POS1.EVAL &YDAYA2.EVAL <&POS2.EVAL &YAMTA2.EVAL <&POS3.EVAL &BYADRA2.EVAL <&POS4.EVAL &PYADRA2.EVAL' ELSE
-              '<&POS.EVAL &TRAN7.EVAL <&POS1.EVAL &QDAYA7.EVAL <&POS2.EVAL &QAMTA7.EVAL <&POS3.EVAL &BQADRA7.EVAL <&POS4.EVAL &PQADRA7.EVAL';
-SET &LN9P1 = IF &NBQTRS GE 2 AND &NBQTRS LE 6 THEN ' ' ELSE
-                '<&POS.EVAL &TRAN8.EVAL <&POS1.EVAL &QDAYA8.EVAL <&POS2.EVAL &QAMTA8.EVAL <&POS3.EVAL &BQADRA8.EVAL <&POS4.EVAL &PQADRA8.EVAL';
-SET &LN10P1 = IF &NBQTRS GE 2 AND &NBQTRS LE 6 THEN ' ' ELSE
-                 '<&POS.EVAL &XY2.EVAL <&POS1.EVAL &YDAYA2.EVAL <&POS2.EVAL &YAMTA2.EVAL <&POS3.EVAL &BYADRA2.EVAL <&POS4.EVAL &PYADRA2.EVAL';
-NEWTEST;

-SET &LN1P1 = '<&POS.EVAL &TRAN1.EVAL <&POS1.EVAL &QDAYA1.EVAL <&POS2.EVAL &QAMTA1.EVAL <&POS3.EVAL &BQADRA1.EVAL <&POS4.EVAL &PQADRA1.EVAL';
-SET &LN2P1 = IF &NBQTRS EQ 2 THEN '<&POS.EVAL &XY1.EVAL <&POS1.EVAL &YDAYA1.EVAL <&POS2.EVAL &YAMTA1.EVAL <&POS3.EVAL &BYADRA1.EVAL <&POS4.EVAL &PYADRA1.EVAL' ELSE
-               '<&POS.EVAL &TRAN2.EVAL <&POS1.EVAL &QDAYA2.EVAL <&POS2.EVAL &QAMTA2.EVAL <&POS3.EVAL &BQADRA2.EVAL <&POS4.EVAL &PQADRA2.EVAL' ;
-SET &LN3P1 = IF &NBQTRS EQ 2 THEN '<&POS.EVAL &TRAN2.EVAL <&POS1.EVAL &QDAYA2.EVAL <&POS2.EVAL &QAMTA2.EVAL <&POS3.EVAL &BQADRA2.EVAL <&POS4.EVAL &PQADRA2.EVAL' ELSE
-               IF &NBQTRS GE 3 AND &NBQTRS LE 4 THEN '<&POS.EVAL &XY1.EVAL <&POS1.EVAL &YDAYA1.EVAL <&POS2.EVAL &YAMTA1.EVAL <&POS3.EVAL &BYADRA1.EVAL <&POS4.EVAL &PYADRA1.EVAL' ELSE
-               '<&POS.EVAL &TRAN3.EVAL <&POS1.EVAL &QDAYA3.EVAL <&POS2.EVAL &QAMTA3.EVAL <&POS3.EVAL &BQADRA3.EVAL <&POS4.EVAL &PQADRA3.EVAL';
-SET &LN4P1 = IF &NBQTRS EQ 2 THEN '<&POS.EVAL &XY2.EVAL <&POS1.EVAL &YDAYA2.EVAL <&POS2.EVAL &YAMTA2.EVAL <&POS3.EVAL &BYADRA2.EVAL <&POS4.EVAL &PYADRA2.EVAL' ELSE
-              IF &NBQTRS GE 3 AND &NBQTRS LE 4 THEN '<&POS.EVAL &TRAN3.EVAL <&POS1.EVAL &QDAYA3.EVAL <&POS2.EVAL &QAMTA3.EVAL <&POS3.EVAL &BQADRA3.EVAL <&POS4.EVAL &PQADRA3.EVAL' ELSE
-              IF &NBQTRS GE 5 AND &NBQTRS LE 6 AND '&YQCNT1.EVAL' LT 4 THEN '<&POS.EVAL &XY1.EVAL <&POS1.EVAL &YDAYA1.EVAL <&POS2.EVAL &YAMTA1.EVAL <&POS3.EVAL &BYADRA1.EVAL <&POS4.EVAL &PYADRA1.EVAL' ELSE
-              '<&POS.EVAL &TRAN4.EVAL <&POS1.EVAL &QDAYA4.EVAL <&POS2.EVAL &QAMTA4.EVAL <&POS3.EVAL &BQADRA4.EVAL <&POS4.EVAL &PQADRA4.EVAL';
-SET &LN5P1 = IF &NBQTRS EQ 2 THEN ' ' ELSE
-              IF &NBQTRS GE 4 AND &NBQTRS LE 6 AND '&YQCNT1.EVAL' LT 4 THEN '<&POS.EVAL &TRAN4.EVAL <&POS1.EVAL &QDAYA4.EVAL <&POS2.EVAL &QAMTA4.EVAL <&POS3.EVAL &BQADRA4.EVAL <&POS4.EVAL &PQADRA4.EVAL' ELSE
-               '<&POS.EVAL &XY1.EVAL <&POS1.EVAL &YDAYA1.EVAL <&POS2.EVAL &YAMTA1.EVAL <&POS3.EVAL &BYADRA1.EVAL <&POS4.EVAL &PYADRA1.EVAL';
-SET &LN6P1 = IF &NBQTRS EQ 2 THEN ' ' ELSE
-              IF &NBQTRS GE 3 AND &NBQTRS LE 4 THEN '<&POS.EVAL &XY2.EVAL <&POS1.EVAL &YDAYA2.EVAL <&POS2.EVAL &YAMTA2.EVAL <&POS3.EVAL &BYADRA2.EVAL <&POS4.EVAL &PYADRA2.EVAL' ELSE
-              '<&POS.EVAL &TRAN5.EVAL <&POS1.EVAL &QDAYA5.EVAL <&POS2.EVAL &QAMTA5.EVAL <&POS3.EVAL &BQADRA5.EVAL <&POS4.EVAL &PQADRA5.EVAL';
-SET &LN7P1 = IF &NBQTRS GE 2 AND &NBQTRS LE 4  THEN ' ' ELSE
-              IF &NBQTRS GE 5 AND &NBQTRS LE 6 AND '&YQCNT2.EVAL' EQ 1 THEN '<&POS.EVAL &XY2.EVAL <&POS1.EVAL &YDAYA2.EVAL <&POS2.EVAL &YAMTA2.EVAL <&POS3.EVAL &BYADRA2.EVAL <&POS4.EVAL &PYADRA2.EVAL' ELSE
-               '<&POS.EVAL &TRAN6.EVAL <&POS1.EVAL &QDAYA6.EVAL <&POS2.EVAL &QAMTA6.EVAL <&POS3.EVAL &BQADRA6.EVAL <&POS4.EVAL &PQADRA6.EVAL' ;
-SET &LN8P1 = IF &NBQTRS GE 2 AND &NBQTRS LE 4 THEN ' ' ELSE
-              IF &NBQTRS GE 5 AND &NBQTRS LE 6 AND '&YQCNT2.EVAL' NE 1 THEN '<&POS.EVAL &XY2.EVAL <&POS1.EVAL &YDAYA2.EVAL <&POS2.EVAL &YAMTA2.EVAL <&POS3.EVAL &BYADRA2.EVAL <&POS4.EVAL &PYADRA2.EVAL' ELSE
-              '<&POS.EVAL &TRAN7.EVAL <&POS1.EVAL &QDAYA7.EVAL <&POS2.EVAL &QAMTA7.EVAL <&POS3.EVAL &BQADRA7.EVAL <&POS4.EVAL &PQADRA7.EVAL';
-SET &LN9P1 = IF &NBQTRS GE 2 AND &NBQTRS LE 6 THEN ' ' ELSE
-                IF &NBQTRS GE 7 AND &NBQTRS LE 8 AND '&YQCNT2.EVAL' EQ 4 THEN '<&POS.EVAL &TRAN8.EVAL <&POS1.EVAL &QDAYA8.EVAL <&POS2.EVAL &QAMTA8.EVAL <&POS3.EVAL &BQADRA8.EVAL <&POS4.EVAL &PQADRA8.EVAL' ELSE
-                 '<&POS.EVAL &XY2.EVAL <&POS1.EVAL &YDAYA2.EVAL <&POS2.EVAL &YAMTA2.EVAL <&POS3.EVAL &BYADRA2.EVAL <&POS4.EVAL &PYADRA2.EVAL';

-SET &LN10P1 = IF &NBQTRS GE 2 AND &NBQTRS LE 6 THEN ' ' ELSE
-               IF &NBQTRS GE 7 AND &NBQTRS LE 8 AND '&YQCNT2.EVAL' LE 3 THEN ' ' ELSE
-                 '<&POS.EVAL &XY2.EVAL <&POS1.EVAL &YDAYA2.EVAL <&POS2.EVAL &YAMTA2.EVAL <&POS3.EVAL &BYADRA2.EVAL <&POS4.EVAL &PYADRA2.EVAL';




-*-SET &LNJ = '<&POS5.EVAL'

-SET &LN1P2 = '<&POS5.EVAL &PNAME1.EVAL <&POS6.EVAL &CDAYA1.EVAL <&POS7.EVAL &CAMTA1.EVAL <&POS8.EVAL &CADRBA1.EVAL <&POS9.EVAL &CADRPA1.EVAL';
-SET &LN2P2 = '<&POS5.EVAL &PNAME2.EVAL <&POS6.EVAL &CDAYA2.EVAL <&POS7.EVAL &CAMTA2.EVAL <&POS8.EVAL &CADRBA2.EVAL <&POS9.EVAL &CADRPA2.EVAL';
-SET &LN3P2 = '<&POS5.EVAL &PNAME3.EVAL <&POS6.EVAL &CDAYA3.EVAL <&POS7.EVAL &CAMTA3.EVAL <&POS8.EVAL &CADRBA3.EVAL <&POS9.EVAL &CADRPA3.EVAL';
-SET &LN4P2 = '<&POS5.EVAL &PNAME4.EVAL <&POS6.EVAL &CDAYA4.EVAL <&POS7.EVAL &CAMTA4.EVAL <&POS8.EVAL &CADRBA4.EVAL <&POS9.EVAL &CADRPA4.EVAL';
-SET &LN5P2 = '<&POS5.EVAL &PNAME5.EVAL <&POS6.EVAL &CDAYA5.EVAL <&POS7.EVAL &CAMTA5.EVAL <&POS8.EVAL &CADRBA5.EVAL <&POS9.EVAL &CADRPA5.EVAL';
-SET &LN6P2 = '<&POS5.EVAL &PNAME6.EVAL <&POS6.EVAL &CDAYA6.EVAL <&POS7.EVAL &CAMTA6.EVAL <&POS8.EVAL &CADRBA6.EVAL <&POS9.EVAL &CADRPA6.EVAL';
-SET &LN7P2 = '<&POS5.EVAL &PNAME7.EVAL <&POS6.EVAL &CDAYA7.EVAL <&POS7.EVAL &CAMTA7.EVAL <&POS8.EVAL &CADRBA7.EVAL <&POS9.EVAL &CADRPA7.EVAL';
-SET &LN8P2 = '<&POS5.EVAL &PNAME8.EVAL <&POS6.EVAL &CDAYA8.EVAL <&POS7.EVAL &CAMTA8.EVAL <&POS8.EVAL &CADRBA8.EVAL <&POS9.EVAL &CADRPA8.EVAL';
-SET &LN9P2 = '<&POS5.EVAL &PNAME9.EVAL <&POS6.EVAL &CDAYA9.EVAL <&POS7.EVAL &CAMTA9.EVAL <&POS8.EVAL &CADRBA9.EVAL <&POS9.EVAL &CADRPA9.EVAL';
-SET &LN10P2= '<&POS5.EVAL &PNAME10.EVAL <&POS6.EVAL &CDAYA10.EVAL <&POS7.EVAL &CAMTA10.EVAL <&POS8.EVAL &CADRBA10.EVAL <&POS9.EVAL &CADRPA10.EVAL';

-* Report
DEFINE FILE TOPCVNDR
ALABEL1/A7 = IF VNDR EQ ' ' THEN '     ' ELSE '&XY1.EVAL';
ALABEL2/A7 = IF VNDR EQ ' ' THEN '     ' ELSE '&XY2.EVAL';
ALABEL3/A5 = 'Total';
ALABEL4/A4 = 'Peer';
ALABEL5/A6 = 'Rental';
ALABEL7/A5 = 'Group';
ALABEL8/A4 = 'Days';
ALABEL9/A6 = 'Amount';
ALABEL10/A7 = 'ADR';
ALABEL11/A4 = 'City';
FLAG/A1 = ' ';
END
TABLE FILE TOPCVNDR
HEADING
"</1"
"<56<ALABEL2 <85<ALABEL1" 
-IF '&PYFLG.EVAL' EQ 'N' THEN GOTO NoPryr;
PRINT CDAY AS 'Days' IN 40
      ACDAYPCT1 AS '% of,Total,Days' IN 45
      CBOOKINGS AS 'Net,Bookings' IN 49
      CAMT/D12M AS 'Total,Rental,Amount' IN 55
      BCADR AS 'Average,Daily,Rate,(ADR)' IN 61
      PADR AS 'Peer,Group' IN 66
      BCALR AS 'Avg,Length,of,Rental' IN 71
      PALR AS 'Peer,Group' IN 76      
      APDAYPCT1 AS '% of,Total,Days' IN 83
      BPADR AS 'ADR' IN 87 
-GOTO Finish
-NoPryr
PRINT CDAY AS 'Days' IN 40
      ACDAYPCT1 AS '% of,Total,Days' IN 45
      CBOOKINGS AS 'Net,Bookings' IN 49
      CAMT/D12M AS 'Total,Rental,Amount' IN 55
      BCADR AS 'Average,Daily,Rate,(ADR)' IN 61
      PADR AS 'Peer,Group' IN 66
      BCALR AS 'Avg,Length,of,Rental' IN 71
      PALR AS 'Peer,Group' IN 76      
      FLAG AS '% of,Total,Days' IN 83
      FLAG AS 'ADR' IN 87 
-Finish
BY RANK NOPRINT
BY VNDR AS 'Vendor' IN 35
WHERE VNDR NE ' '
-* ON TABLE SET ONLINE-FMT PDF
FOOTING
-*"</14"
"</3"
"<3 &BCSPL1.EVAL"
"<3 &BCDPL1.EVAL"
"<3 &BADRPL1.EVAL"
"</6>"
"<22< ALABEL3 <+0> <34< ALABEL4 <+0> <77< ALABEL3 <+0> <87< ALABEL4" 
"<22< ALABEL5 <+0> <34< ALABEL7 <+0> <77< ALABEL5 <+0> <87< ALABEL7"
"<10< ALABEL8 <22<ALABEL9 <28 <ALABEL10 <34<ALABEL10 <47<ALABEL11 <65<ALABEL8 <77<ALABEL9 <83<ALABEL10 <87<ALABEL10"
"&LN1P1   &LN1P2"
"&LN2P1   &LN2P2"
"&LN3P1   &LN3P2"
"&LN4P1   &LN4P2"
"&LN5P1   &LN5P2"
"&LN6P1   &LN6P2"
"&LN7P1   &LN7P2"
"&LN8P1   &LN8P2"
"&LN9P1   &LN9P2"
"&LN10P1  &LN10P2"
ON TABLE SET PAGE-NUM OFF
&&OUTLINE1
&&OUTLINE2

ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.150000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=9, BACKCOLOR=NONE, STYLE=NORMAL, $   

TYPE=HEADING, SIZE=9, LINE=3, OBJECT=FIELD, STYLE=BOLD,$ 
TYPE=TITLE, STYLE=BOLD, COLUMN=N2, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N3, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N4, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N5, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N6, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N7, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N8, BACKCOLOR=CYAN, $
TYPE=TITLE, STYLE=BOLD, COLUMN=N9, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N10, BACKCOLOR=CYAN, $
TYPE=TITLE, STYLE=BOLD, COLUMN=N11, BACKCOLOR=RGB(145 207 255), $
TYPE=TITLE, STYLE=BOLD, COLUMN=N12, BACKCOLOR=RGB(145 207 255), $

TYPE=FOOTING,FONT=COURIER NEW, COLOR=BLACK, BACKCOLOR=WHITE, $ 
TYPE=FOOTING, SIZE=15, LINE=5, OBJECT=TEXT, STYLE=BOLD, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=15, LINE=6, OBJECT=TEXT, STYLE=BOLD, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=15, LINE=7, OBJECT=TEXT, STYLE=BOLD, FONT=TIMES NEW ROMAN,$

TYPE=FOOTING, LINE=15, BACKCOLOR=RGB(234 234 234),$
TYPE=FOOTING, SIZE=9, LINE=15, OBJECT=FIELD, ITEM=1,COLOR=BLUE, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=15, OBJECT=FIELD, ITEM=2,COLOR=CYAN, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=15, OBJECT=FIELD, ITEM=3,COLOR=BLUE, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=15, OBJECT=FIELD, ITEM=4,COLOR=CYAN, FONT=TIMES NEW ROMAN,$

TYPE=FOOTING, LINE=16, BACKCOLOR=RGB(234 234 234),$
TYPE=FOOTING, SIZE=9, LINE=16, OBJECT=FIELD, ITEM=1,COLOR=BLUE, BACKCOLOR=RGB(234 234 234), FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=16, OBJECT=FIELD, ITEM=2,COLOR=CYAN, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=16, OBJECT=FIELD, ITEM=3,COLOR=BLUE, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=16, OBJECT=FIELD, ITEM=4,COLOR=CYAN, FONT=TIMES NEW ROMAN,$

TYPE=FOOTING, LINE=17, BACKCOLOR=RGB(234 234 234),$
TYPE=FOOTING, SIZE=9, LINE=17, OBJECT=FIELD, ITEM=1,COLOR=BLUE, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=17, OBJECT=FIELD, ITEM=2,COLOR=BLUE, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=17, OBJECT=FIELD, ITEM=3,COLOR=BLUE, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=17, OBJECT=FIELD, ITEM=4,COLOR=CYAN, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=17, OBJECT=FIELD, ITEM=5,COLOR=BLUE, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=17, OBJECT=FIELD, ITEM=6,COLOR=BLUE, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=17, OBJECT=FIELD, ITEM=7,COLOR=BLUE, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=17, OBJECT=FIELD, ITEM=8,COLOR=BLUE, FONT=TIMES NEW ROMAN,$
TYPE=FOOTING, SIZE=9, LINE=17, OBJECT=FIELD, ITEM=9,COLOR=CYAN, FONT=TIMES NEW ROMAN,$

TYPE=SUBTOTAL, SIZE=9, STYLE=BOLD,  $
TYPE=GRANDTOTAL, SIZE=9, STYLE=BOLD, $
TYPE=REPORT,GRID=OFF, $
TYPE=REPORT, IMAGE=CarSum.GIF,POSITION=(0.1 0.1), SIZE=(10.75 .75), $
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' THEN GOTO NOIMAGE;
-IF &&G_QRCAR EQ 'N' GOTO SKIP_QRCAR;
 TYPE=REPORT,
 IMAGE=QRCAR.SVG,
    POSITION=(0.25 0.9), SIZE=(4.05 3.0),$
-SKIP_QRCAR
-NOIMAGE

ENDSTYLE
END
-RUN


