-* File SEY_HIERU.FEX
SET ASNAMES=ON

FILEDEF SEY_VALF DISK D:\TNT\TTRACKER\SYSTEM\DATA\SEY_VALF.TXT

-* Validation File

TABLE FILE SEY_VALF
PRINT SEY_DEPT AS 'LEV3'
BY SEY_DEPT
ON TABLE HOLD AS DPTH1A
END
-RUN

TABLE FILE DPTH1A
BY LEV3
ON TABLE HOLD AS DPTH1
END
-RUN

-GOTO AIRMOD

USE ADD

D:\JOY\SEY-R\S1SEY.FOC AS SR_50
D:\JOY\SEY-R\S2SEY.FOC AS SR_50
D:\JOY\SEY-R\S3SEY.FOC AS SR_50
D:\JOY\SEY-R\S4SEY.FOC AS SR_50
D:\JOY\SEY-R\S5SEY.FOC AS SR_50
D:\JOY\SEY-R\S6SEY.FOC AS SR_50
D:\JOY\SEY-R\S7SEY.FOC AS SR_50
D:\JOY\SEY-R\S8SEY.FOC AS SR_50
D:\JOY\SEY-R\S9SEY.FOC AS SR_50
D:\JOY\SEY-R\S0SEY.FOC AS SR_50
D:\JOY\SEY-R\SYSEY.FOC AS SR_50
D:\JOY\SEY-R\SZSEY.FOC AS SR_50


D:\JOY\SEY-R\A1SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A2SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A3SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A4SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A5SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A6SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A7SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A8SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A9SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A0SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AYSEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AZSEY.FOC AS AIR_MAIN

END
-RUN



-* Air Records IN Validation File

DEFINE FILE SR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 = LEV3;
LEV_3/A15 = ' ';
AROLL3/A15 = LEV3;
END

TABLE FILE SR_50
PRINT LEV1 AS 'LEVEL1' LEVEL3 AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE LEV3 IN FILE DPTH1
ON TABLE HOLD AS SRH1
END

TABLE FILE SRH1
PRINT AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD AS SH1
END

-* -GOTO NOAIRUPD;
-* Update Air Records

TABLE FILE SRH1
PRINT LEVEL1 LEVEL3
BY AIR_KEY
-* ON TABLE HOLD AS AH1
END
-RUN
-QUIT

MODIFY FILE A1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END


MODIFY FILE A2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END


MODIFY FILE A3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END


MODIFY FILE A4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END

MODIFY FILE A5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END

MODIFY FILE A6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END

MODIFY FILE A7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END

MODIFY FILE A8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END

MODIFY FILE A9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END

MODIFY FILE A0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END

MODIFY FILE AYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END

MODIFY FILE AZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH1
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH1
END
-RUN
-QUIT

-NOAIRUPD;
-*  Update Segment/Market/Destination


MODIFY FILE S1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE S2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE S3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE S4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE S5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE S6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE S7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE S8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE S9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE S0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE SYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE SZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END
-RUN

-**** Market

USE CLEAR *
-RUN

USE ADD

D:\JOY\SEY-R\M1SEY.FOC AS MR_50
D:\JOY\SEY-R\M2SEY.FOC AS MR_50
D:\JOY\SEY-R\M3SEY.FOC AS MR_50
D:\JOY\SEY-R\M4SEY.FOC AS MR_50
D:\JOY\SEY-R\M5SEY.FOC AS MR_50
D:\JOY\SEY-R\M6SEY.FOC AS MR_50
D:\JOY\SEY-R\M7SEY.FOC AS MR_50
D:\JOY\SEY-R\M8SEY.FOC AS MR_50
D:\JOY\SEY-R\M9SEY.FOC AS MR_50
D:\JOY\SEY-R\M0SEY.FOC AS MR_50
D:\JOY\SEY-R\MYSEY.FOC AS MR_50
D:\JOY\SEY-R\MZSEY.FOC AS MR_50

D:\JOY\SEY-R\A1SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A2SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A3SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A4SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A5SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A6SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A7SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A8SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A9SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A0SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AYSEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AZSEY.FOC AS AIR_MAIN


END
-RUN

DEFINE FILE MR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 = LEV3;
LEV_3/A15 = ' ';
AROLL3/A15 = LEV3;
AROLL4/A15 = ' ';
AROLL5/A15 = ' ';
AROLL6/A15 = ' ';
END

TABLE FILE MR_50
PRINT AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE LEV3 IN FILE DPTH1
ON TABLE HOLD AS MH1A
END
-RUN


TABLE FILE MH1A
PRINT AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD AS MH1
END
-RUN

MODIFY FILE M1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END


MODIFY FILE M2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END

MODIFY FILE M3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END

MODIFY FILE M4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END

MODIFY FILE M5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END

MODIFY FILE M6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END

MODIFY FILE M7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END

MODIFY FILE M8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4/A15 = ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5/A15 = ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6/A15 = ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END

MODIFY FILE M9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END

MODIFY FILE M0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END

MODIFY FILE MYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END

MODIFY FILE MZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM MH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MH1
END
-RUN
-***** Destination


USE CLEAR *
-RUN

USE ADD

D:\JOY\SEY-R\D1SEY.FOC AS DR_50
D:\JOY\SEY-R\D2SEY.FOC AS DR_50
D:\JOY\SEY-R\D3SEY.FOC AS DR_50
D:\JOY\SEY-R\D4SEY.FOC AS DR_50
D:\JOY\SEY-R\D5SEY.FOC AS DR_50
D:\JOY\SEY-R\D6SEY.FOC AS DR_50
D:\JOY\SEY-R\D7SEY.FOC AS DR_50
D:\JOY\SEY-R\D8SEY.FOC AS DR_50
D:\JOY\SEY-R\D9SEY.FOC AS DR_50
D:\JOY\SEY-R\D0SEY.FOC AS DR_50
D:\JOY\SEY-R\DYSEY.FOC AS DR_50
D:\JOY\SEY-R\DZSEY.FOC AS DR_50

D:\JOY\SEY-R\A1SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A2SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A3SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A4SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A5SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A6SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A7SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A8SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A9SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A0SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AYSEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AZSEY.FOC AS AIR_MAIN


END
-RUN

DEFINE FILE DR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 = LEV3;
LEV_3/A15 = ' ';
AROLL3/A15 = LEV3;
AROLL4/A15 = ' ';
AROLL5/A15 = ' ';
AROLL6/A15 = ' ';
END

TABLE FILE DR_50
PRINT LEV1 AS 'LEVEL1' AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE LEV3 IN FILE DPTH1
ON TABLE HOLD AS DH1A
END
-RUN

TABLE FILE DH1A
PRINT AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6 
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD AS DH1
END
-RUN


MODIFY FILE D1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END

MODIFY FILE D2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END

MODIFY FILE D3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END

MODIFY FILE D4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH1
END

MODIFY FILE D5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END

MODIFY FILE D6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END

MODIFY FILE D7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END

MODIFY FILE D8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END

MODIFY FILE D9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END

MODIFY FILE D0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END

MODIFY FILE DYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END

MODIFY FILE DZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM DH1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DH1
END


-***************************** Air Records NOT in Validation File

USE CLEAR *
-RUN

-AIRMOD

USE ADD

D:\JOY\SEY-R\S1SEY.FOC AS SR_50
D:\JOY\SEY-R\S2SEY.FOC AS SR_50
D:\JOY\SEY-R\S3SEY.FOC AS SR_50
D:\JOY\SEY-R\S4SEY.FOC AS SR_50
D:\JOY\SEY-R\S5SEY.FOC AS SR_50
D:\JOY\SEY-R\S6SEY.FOC AS SR_50
D:\JOY\SEY-R\S7SEY.FOC AS SR_50
D:\JOY\SEY-R\S8SEY.FOC AS SR_50
D:\JOY\SEY-R\S9SEY.FOC AS SR_50
D:\JOY\SEY-R\S0SEY.FOC AS SR_50
D:\JOY\SEY-R\SYSEY.FOC AS SR_50
D:\JOY\SEY-R\SZSEY.FOC AS SR_50


D:\JOY\SEY-R\A1SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A2SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A3SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A4SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A5SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A6SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A7SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A8SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A9SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A0SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AYSEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AZSEY.FOC AS AIR_MAIN

END
-RUN


DEFINE FILE SR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 = 'DEFB3';
LEV_3/A15 = ' ';
AROLL3/A15 = 'DEFB3';
END

TABLE FILE SR_50
PRINT LEV1 AS 'LEVEL1' LEVEL3 AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6 AROLL_LEV2
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE NOT LEV3 IN FILE DPTH1
WHERE LEVEL3 NE ' '
ON TABLE HOLD AS SRH2
END
-RUN

-* -GOTO NOAIRUPD1;
-* Update Air Records


TABLE FILE SRH2
PRINT LEVEL1 LEVEL3
BY AIR_KEY
ON TABLE HOLD AS AH2
END

MODIFY FILE A1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE A2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE A3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE A4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE A5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE A6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE A7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE A8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE A9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE A0SEY
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE AYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END

MODIFY FILE AZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM AH2
MATCH AIR_KEY
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL1 LEVEL3
ON NOMATCH REJECT
DATA ON AH2
END
-RUN
-QUIT

-NOAIRUPD1;
-*  Update Segment/Market/Destination

TABLE FILE SRH2
PRINT AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD AS SH2
END

MODIFY FILE S1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE S2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE S3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE S4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE S5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE S6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE S7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE S8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE S9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE S0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE SYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

MODIFY FILE SZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM SH2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON SH2
END

-**** Market


USE CLEAR *
-RUN

USE ADD
D:\JOY\SEY-R\M1SEY.FOC AS MR_50
D:\JOY\SEY-R\M2SEY.FOC AS MR_50
D:\JOY\SEY-R\M3SEY.FOC AS MR_50
D:\JOY\SEY-R\M4SEY.FOC AS MR_50
D:\JOY\SEY-R\M5SEY.FOC AS MR_50
D:\JOY\SEY-R\M6SEY.FOC AS MR_50
D:\JOY\SEY-R\M7SEY.FOC AS MR_50
D:\JOY\SEY-R\M8SEY.FOC AS MR_50
D:\JOY\SEY-R\M9SEY.FOC AS MR_50
D:\JOY\SEY-R\M0SEY.FOC AS MR_50
D:\JOY\SEY-R\MYSEY.FOC AS MR_50
D:\JOY\SEY-R\MZSEY.FOC AS MR_50

D:\JOY\SEY-R\A1SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A2SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A3SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A4SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A5SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A6SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A7SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A8SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A9SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A0SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AYSEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AZSEY.FOC AS AIR_MAIN
END
-RUN



DEFINE FILE MR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 = LEV3;
LEV_3/A15 = ' ';
AROLL3/A15 = 'DEFB3';
AROLL4/A15 = ' ';
AROLL5/A15 = ' ';
AROLL6/A15 = ' ';
END

TABLE FILE MR_50
PRINT AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6 
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE NOT LEV3 IN FILE DPTH1
ON TABLE HOLD AS MHA
END
-RUN

TABLE FILE MHA
PRINT AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD AS MHA1
END
-RUN

MODIFY FILE M1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END

MODIFY FILE M2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END


MODIFY FILE M3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END

MODIFY FILE M4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END

MODIFY FILE M5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END

MODIFY FILE M6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END

MODIFY FILE M7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END

MODIFY FILE M8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END

MODIFY FILE M9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END

MODIFY FILE M0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END

MODIFY FILE MYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END

MODIFY FILE MZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM MHA1
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON MHA1
END
-RUN

-* Destination

USE CLEAR *
-RUN

USE ADD

D:\JOY\SEY-R\D1SEY.FOC AS DR_50
D:\JOY\SEY-R\D2SEY.FOC AS DR_50
D:\JOY\SEY-R\D3SEY.FOC AS DR_50
D:\JOY\SEY-R\D4SEY.FOC AS DR_50
D:\JOY\SEY-R\D5SEY.FOC AS DR_50
D:\JOY\SEY-R\D6SEY.FOC AS DR_50
D:\JOY\SEY-R\D7SEY.FOC AS DR_50
D:\JOY\SEY-R\D8SEY.FOC AS DR_50
D:\JOY\SEY-R\D9SEY.FOC AS DR_50
D:\JOY\SEY-R\D0SEY.FOC AS DR_50
D:\JOY\SEY-R\DYSEY.FOC AS DR_50
D:\JOY\SEY-R\DZSEY.FOC AS DR_50

D:\JOY\SEY-R\A1SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A2SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A3SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A4SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A5SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A6SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A7SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A8SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A9SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\A0SEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AYSEY.FOC AS AIR_MAIN
D:\JOY\SEY-R\AZSEY.FOC AS AIR_MAIN


END
-RUN


DEFINE FILE DR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 = LEV3;
LEV_3/A15 = ' ';
AROLL3/A15 = 'DEFB3';
AROLL4/A15 = ' ';
AROLL5/A15 = ' ';
AROLL6/A15 = ' ';
END

TABLE FILE DR_50
PRINT AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE NOT LEV3 IN FILE DPTH1
ON TABLE HOLD AS DHA2A
END
-RUN

TABLE FILE DHA2A
PRINT AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY AIR_KEY
BY EMBARK
BY ROUTE
BY TKT_SORT
BY SEG_NBR
ON TABLE HOLD AS DHA2
END
-RUN


-*** Destination

MODIFY FILE D1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END


MODIFY FILE D2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END

MODIFY FILE D3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END

MODIFY FILE D4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END

MODIFY FILE D5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END

MODIFY FILE D6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END

MODIFY FILE D7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END

MODIFY FILE D8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END

MODIFY FILE D9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END

MODIFY FILE D0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END

MODIFY FILE DYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END

MODIFY FILE DZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM DHA2
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON DHA2
END
-RUN
-QUIT

-********************* Hotel
-HOTEL
-******** Records IN Validation File

-* USE CLEAR *
-* -RUN

USE ADD
D:\JOY\SEY-R\H1SEY.FOC AS HR_50
D:\JOY\SEY-R\H2SEY.FOC AS HR_50
D:\JOY\SEY-R\H3SEY.FOC AS HR_50
D:\JOY\SEY-R\H4SEY.FOC AS HR_50
D:\JOY\SEY-R\H5SEY.FOC AS HR_50
D:\JOY\SEY-R\H6SEY.FOC AS HR_50
D:\JOY\SEY-R\H7SEY.FOC AS HR_50
D:\JOY\SEY-R\H8SEY.FOC AS HR_50
D:\JOY\SEY-R\H9SEY.FOC AS HR_50
D:\JOY\SEY-R\H0SEY.FOC AS HR_50
D:\JOY\SEY-R\HYSEY.FOC AS HR_50
D:\JOY\SEY-R\HZSEY.FOC AS HR_50
END
-RUN


DEFINE FILE HR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 = LEV3;
LEV_3/A15 = ' ';
AROLL3/A15 = LEV3;
END

TABLE FILE HR_50
PRINT LEV1 AS 'LEVEL1' LEVEL3 AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY HTL_KEY
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE LEV3 IN FILE DPTH1
ON TABLE HOLD AS HR1A
END
-RUN


TABLE FILE HR1A
PRINT LEVEL1 LEVEL3 AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY HTL_KEY
ON TABLE HOLD AS HR1
END
-RUN


-* Update Hotel Databases Aroll_levs

MODIFY FILE H1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END
-RUN

MODIFY FILE H2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE HYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE HZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR1
END




-******** Records Not IN Validation File aroll_levs


DEFINE FILE HR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 = 'DEFB3';
LEV_3/A15 = ' ';
AROLL3/A15 = 'DEFB3';
AROLL4/A15 = ' ';
AROLL5/A15 = ' ';
AROLL6/A15 = ' ';
END

TABLE FILE HR_50
PRINT LEV1 AS 'LEVEL1' LEVEL3 AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY HTL_KEY
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE NOT LEV3 IN FILE DPTH1
ON TABLE HOLD AS HR2A
END
-RUN

-* Update Hotel Databases

TABLE FILE HR2A
PRINT LEVEL1 LEVEL3 AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY HTL_KEY
ON TABLE HOLD AS HR2
END
-RUN


MODIFY FILE H1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE H2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE H3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE H4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE H5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE H6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE H7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE H8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE H9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE H0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE HYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END

MODIFY FILE HZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE AROLL_LEV3 
ON MATCH COMPUTE AROLL_LEV4=' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5=' ';
ON MATCH UPDATE AROLL_LEV5
ON MATCH COMPUTE AROLL_LEV6=' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON HR2
END
-RUN


-* Update Level1 and Level2
-* matching records in file


MODIFY FILE H1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
DATA ON HR1
END

MODIFY FILE H7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE H0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE HYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END

MODIFY FILE HZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR1
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR1
END




-* non matching records in file

MODIFY FILE H1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE H2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE H3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE H4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE H5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE H6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE H7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE H8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE H9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE H0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE HYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-RUN

MODIFY FILE HZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM HR2
MATCH HTL_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3=' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON HR2
END
-QUIT



-********************* Car
-CAR

-* USE CLEAR *
-* -RUN


USE ADD
D:\JOY\SEY-R\C1SEY.FOC AS CR_50
D:\JOY\SEY-R\C2SEY.FOC AS CR_50
D:\JOY\SEY-R\C3SEY.FOC AS CR_50
D:\JOY\SEY-R\C4SEY.FOC AS CR_50
D:\JOY\SEY-R\C5SEY.FOC AS CR_50
D:\JOY\SEY-R\C6SEY.FOC AS CR_50
D:\JOY\SEY-R\C7SEY.FOC AS CR_50
D:\JOY\SEY-R\C8SEY.FOC AS CR_50
D:\JOY\SEY-R\C9SEY.FOC AS CR_50
D:\JOY\SEY-R\C0SEY.FOC AS CR_50
D:\JOY\SEY-R\CYSEY.FOC AS CR_50
D:\JOY\SEY-R\CZSEY.FOC AS CR_50
END
-RUN


-******** Records IN Validation File


DEFINE FILE CR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 = LEV3;
AROLL3/A15 = LEV3;
END

TABLE FILE CR_50
PRINT LEV1 AS 'LEVEL1' LEVEL3 AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY CAR_KEY
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE LEV3 IN FILE DPTH1
ON TABLE HOLD AS CR1A
END

TABLE FILE CR1A
PRINT AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY CAR_KEY
ON TABLE HOLD AS CR1
END
-RUN

-* Update Car Databases

MODIFY FILE C1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE C2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE C3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE C4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE C5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE C6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE C7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE C8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE C9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE C0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE CYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END

MODIFY FILE CZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR1
END
-RUN



-******** Records Not IN Validation File


DEFINE FILE CR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15='DEFB3';
LEV_3/A15 = ' ';
AROLL3/A15='DEFB3';
END

TABLE FILE CR_50
PRINT LEV1 AS 'LEVEL1' LEVEL3 AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY CAR_KEY
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE NOT LEV3 IN FILE DPTH1
ON TABLE HOLD AS CR2A
END
-RUN

TABLE FILE CR2A
PRINT AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY CAR_KEY
ON TABLE HOLD AS CR2
END


-* Update Car Databases

MODIFY FILE C1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE C2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE C3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE C4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE C5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE C6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE C7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE C8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE C9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE C0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE CYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END

MODIFY FILE CZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON CR2
END
-RUN

-* Update Level1 Level3 matching

TABLE FILE CR1A
PRINT LEVEL1 LEVEL3
BY CAR_KEY
ON TABLE HOLD AS CR1L
END

MODIFY FILE C1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE C2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE C3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE C4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE C5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE C6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE C7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE C8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE C9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE C0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE CYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN

MODIFY FILE CZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR1L
END
-RUN


-* Update Level1 Level3 non-matching

TABLE FILE CR2A
PRINT LEVEL1 LEVEL3
BY CAR_KEY
ON TABLE HOLD AS CR2L
END

MODIFY FILE C1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE C2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE C3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE C4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE C5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE C6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE C7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE C8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE C9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE C0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE CYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END
-RUN

MODIFY FILE CZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM CR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON CR2L
END

TABLE FILE CR_50
SUM LEVEL1 LEVEL3 AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY LEVEL1 NOPRINT
BY LEVEL3 NOPRINT
BY AROLL_LEV3 NOPRINT
BY AROLL_LEV4 NOPRINT
BY AROLL_LEV5 NOPRINT
BY AROLL_LEV6 NOPRINT
END
-RUN
-QUIT


-********************* Limo
-LIMO

USE CLEAR *
-RUN

USE ADD
D:\JOY\SEY-R\L1SEY.FOC AS LR_50
D:\JOY\SEY-R\L2SEY.FOC AS LR_50
D:\JOY\SEY-R\L3SEY.FOC AS LR_50
D:\JOY\SEY-R\L4SEY.FOC AS LR_50
D:\JOY\SEY-R\L5SEY.FOC AS LR_50
D:\JOY\SEY-R\L6SEY.FOC AS LR_50
D:\JOY\SEY-R\L7SEY.FOC AS LR_50
D:\JOY\SEY-R\L8SEY.FOC AS LR_50
D:\JOY\SEY-R\L9SEY.FOC AS LR_50
D:\JOY\SEY-R\L0SEY.FOC AS LR_50
D:\JOY\SEY-R\LYSEY.FOC AS LR_50
D:\JOY\SEY-R\LZSEY.FOC AS LR_50
END
-RUN


-******** Records IN Validation File


DEFINE FILE LR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 = LEV3;
LEV_3/A15 = ' ';
AROLL3/A15 = LEV3;
END

TABLE FILE LR_50
PRINT LEV1 AS 'LEVEL1' LEV_3 AS 'LEVEL3' AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5  AROLL_LEV6
BY CAR_KEY
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE LEV3 IN FILE DPTH1
ON TABLE HOLD AS LR1A
END
-RUN

-* Update Limo Databases

TABLE FILE LR1A
PRINT AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY CAR_KEY
ON TABLE HOLD AS LR1
END
-RUN

MODIFY FILE L1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE L2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE L3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE L4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE L5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE L6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE L7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE L8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE L9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE L0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE LYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END

MODIFY FILE LZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR1
END



-******** Records Not IN Validation File


DEFINE FILE LR_50
LEV3A/A6 = EDIT(LEVEL3, '999999');
LEV3/A4 = EDIT(LEV3A, '$$9999');
LEV1/A15 ='DEFB3';
LEV_3/A15 = ' ';
AROLL3/A15 ='DEFB3';
END

TABLE FILE LR_50
PRINT LEV1 AS 'LEVEL1' LEV_3 AS 'LEVEL3' AROLL3 AS 'AROLL_LEV3' AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY CAR_KEY
WHERE AROLL_LEV2 EQ 'SEYB'
WHERE NOT LEV3 IN FILE DPTH1
ON TABLE HOLD AS LR2A
END
-RUN

-* Update Limo Databases

TABLE FILE LR2A
PRINT AROLL_LEV3 AROLL_LEV4 AROLL_LEV5 AROLL_LEV6
BY CAR_KEY
ON TABLE HOLD AS LR2
END

MODIFY FILE L1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE L2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE L3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE L4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE L5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE L6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE L7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE L8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE L9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE L0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE LYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END

MODIFY FILE LZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2
MATCH CAR_KEY
ON MATCH UPDATE AROLL_LEV3
ON MATCH COMPUTE AROLL_LEV4= ' ';
ON MATCH UPDATE AROLL_LEV4
ON MATCH COMPUTE AROLL_LEV5= ' ';
ON MATCH UPDATE AROLL_LEV5 
ON MATCH COMPUTE AROLL_LEV6= ' ';
ON MATCH UPDATE AROLL_LEV6
ON NOMATCH REJECT
DATA ON LR2
END



-* Level1 and Level3 update matching

TABLE FILE LR1A
PRINT LEVEL1 LEVEL3
BY CAR_KEY
ON TABLE HOLD AS LR1L
END

MODIFY FILE L1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE L1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE L2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE L3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE L4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE L5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE L6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE L7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE L8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE L9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE L0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE LYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END

MODIFY FILE LZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR1L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR1L
END
-RUN

-* Level1 and Level3 non-matching
TABLE FILE LR2A
PRINT LEVEL1 LEVEL3
BY CAR_KEY
ON TABLE HOLD AS LR2L
END

MODIFY FILE L1SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE L2SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE L3SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE L4SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE L5SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE L6SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE L7SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE L8SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE L9SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE L0SEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE LYSEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END

MODIFY FILE LZSEY
LOG NOMATCH MSG OFF
FIXFORM FROM LR2L
MATCH CAR_KEY
ON MATCH UPDATE LEVEL1 
ON MATCH COMPUTE LEVEL3= ' ';
ON MATCH UPDATE LEVEL3
ON NOMATCH REJECT
DATA ON LR2L
END
-QUIT





