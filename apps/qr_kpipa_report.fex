 
-INCLUDE SETECHO
SET ASNAMES = ON 
 
-SET &TARGET = 88;
-SET &THRES = 5;
-SET &RANKBY = 'B';

-*55BF3B = RGB(85 191 59) (GREEN)
-*DF5353  RGB(223 83 83) (RED)
-*DDDF0D  RGB(221 223 13) (YELLOW) 

TABLE FILE &&HXPFD001
SUM CURAMT CURNETT PRAMT PRNETT CPREF CPREFT PPREF PPREFT
COMPUTE CPRPCTX/P12.1%   = IF '&RANKBY.EVAL' EQ 'A' THEN IF ((CURAMT LT 1) AND (CURAMT GT (-1))) THEN 0 ELSE (CPREF/CURAMT) *100 ELSE
                      IF ((CURNETT LT 1) AND (CURNETT GT (-1))) THEN 0 ELSE (CPREFT/CURNETT) *100;
COMPUTE PPRPCTX/P12.1%   = IF '&RANKBY.EVAL' EQ 'A' THEN IF ((PRAMT LT 1) AND (PRAMT GT (-1))) THEN 0 ELSE (PPREF/PRAMT) *100 ELSE
                       IF ((PRNETT LT 1) AND (PRNETT GT (-1))) THEN 0 ELSE (PPREFT/PRNETT) *100; 
COMPUTE CPRPCT/P12%  = CPRPCTX;
COMPUTE PPRPCT/P12% = PPRPCTX;
COMPUTE VAR/P12 = CPRPCT - PPRPCT;  
COMPUTE DIRECTION/A1='H';
COMPUTE TREND/A15=IF VAR EQ 0 THEN 'equal_large.gif' ELSE
                  IF DIRECTION EQ 'L' AND VAR GT 0 THEN 'rau_large.gif' ELSE
	          IF DIRECTION EQ 'L' AND VAR LT 0 THEN 'gad_large.gif' ELSE
		  IF VAR GT 0 THEN 'gau_large.gif' ELSE 'rad_large.gif';

	COMPUTE RANGE1/P12=IF DIRECTION EQ 'L' THEN &TARGET ELSE &TARGET - &THRES;
	COMPUTE RANGE2/P12=IF DIRECTION EQ 'L' THEN &TARGET + &THRES ELSE &TARGET;
	COMPUTE COLOR1/A20=IF DIRECTION EQ 'L' THEN 'RGB(85 191 59)' ELSE 'RGB(223 83 83)'; NOPRINT
	COMPUTE COLOR2/A20='RGB(221 223 13)'; NOPRINT
	COMPUTE COLOR3/A20=IF DIRECTION EQ 'L' THEN 'RGB(223 83 83)' ELSE 'RGB(85 191 59)'; NOPRINT
    COMPUTE WCOLOR/A20=IF DIRECTION EQ 'L' AND CPRPCT LE RANGE1 THEN COLOR1 ELSE
	                   IF DIRECTION EQ 'L' AND CPRPCT LE RANGE2 THEN COLOR2 ELSE
					   IF DIRECTION EQ 'L' THEN COLOR3 ELSE
	                   IF DIRECTION EQ 'H' AND CPRPCT GE RANGE2 THEN COLOR3 ELSE
	                   IF DIRECTION EQ 'H' AND CPRPCT GE RANGE1 THEN COLOR2 ELSE
					   IF DIRECTION EQ 'H' THEN COLOR1;
    COMPUTE PCOLOR/A20=IF DIRECTION EQ 'L' AND PPRPCT LE RANGE1 THEN COLOR1 ELSE
	                   IF DIRECTION EQ 'L' AND PPRPCT LE RANGE2 THEN COLOR2 ELSE
					   IF DIRECTION EQ 'L' THEN COLOR3 ELSE
	                   IF DIRECTION EQ 'H' AND PPRPCT GE RANGE2 THEN COLOR3 ELSE
	                   IF DIRECTION EQ 'H' AND PPRPCT GE RANGE1 THEN COLOR2 ELSE
					   IF DIRECTION EQ 'H' THEN COLOR1;

 

BY ROLLUP_CODE
ON TABLE HOLD AS QRPREFPCT
END
-RUN













TABLE FILE QRPREFPCT
PRINT CPRPCT  PPRPCT  TREND WCOLOR PCOLOR
ON TABLE SAVE AS PREF001 FORMAT ALPHA
END
-RUN


-READ PREF001 &CPCT.12. &PPCT.12. &TREND.15. &WCOLOR.20. &PCOLOR.20.
-CLOSE PREF001

 

 



-TYPE &CPCT
-TYPE &PPCT
-TYPE &TREND
-TYPE &WCOLOR
-TYPE &PCOLOR

 
 
 

 

DEFINE FILE QRPREFPCT
FLAG/P1S = 0;
GPCT/P5% = 88;
TARGET/P5% = &TARGET;


END

 

TABLE FILE QRPREFPCT
HEADING CENTER
" "
" <7 Preferred Airline KPI"
" "
" "
"<+0> <3 Current <+0> <9 Previous <+0> <15 Trend <+0> <20 Goal" 
SUM 
CPRPCT AS ' ' 
FLAG AS ' '
PPRPCT AS ' '  IN 8
TREND  NOPRINT
TARGET AS ' ' IN 18
BY FLAG NOPRINT
ON TABLE PCHOLD FORMAT HTML
ON TABLE NOTOTAL
ON TABLE SET PAGE-NUM NOLEAD
ON TABLE SET SQUEEZE ON
ON TABLE SET HTMLCSS ON
ON TABLE SET HTMLENCODE OFF
ON TABLE PCHOLD FORMAT PDF
ON TABLE SET STYLE *
TYPE=REPORT, GRID=OFF, BORDER=OFF, BACKCOLOR=NONE, $

TYPE=HEADING, LINE=1, COLOR=BLACK, BORDER=OFF, SIZE=7, FONT=ARIAL,$
TYPE=HEADING, LINE=2, COLOR=BLACK, BORDER=OFF, SIZE=7, STYLE=BOLD,FONT=ARIAL,$
TYPE=HEADING, LINE=3, COLOR=RGB(88 88 88), BORDER=OFF, SIZE=6,FONT=ARIAL, STYLE=BOLD, $
TYPE=HEADING, LINE=4, COLOR=RGB(88 88 88), BORDER=OFF, $
TYPE=HEADING, LINE=5, COLOR=RGB(88 88 88), BORDER=OFF, SIZE=6,FONT=ARIAL, STYLE=BOLD+ITALIC, $ 


TYPE=TITLE, COLOR=BLACK, BORDER=OFF, JUSTIFY=CENTER,  SIZE=8, $
TYPE=DATA, COLUMN=N2,COLOR=BLACK, BORDER=OFF, JUSTIFY=CENTER, BACKCOLOR=&WCOLOR.EVAL, SIZE=15,FONT=ARIAL, STYLE=BOLD,$
TYPE=DATA, COLUMN=N4,COLOR=BLACK, BORDER=OFF, JUSTIFY=CENTER, BACKCOLOR=&PCOLOR.EVAL, SIZE=15,FONT=ARIAL, STYLE=BOLD,$
TYPE=DATA, COLUMN=N6, BORDER=ON, JUSTIFY=CENTER, COLOR=RGB(85 191 59), BORDER-COLOR=RGB(85 191 59),SIZE=15,FONT=ARIAL, STYLE=BOLD,$

-*TYPE=DATA, COLUMN=N5, IMAGE=d:\tnt\ttracker\system\image\&TREND, POSITION=(.25 .25),preserveratio=on,$  
 
TYPE=REPORT,
 IMAGE=&TREND,
-*POSITION=(+1.600000 +0.6000000),
POSITION=(+1.480000 +1.0000000),
-*POSITION=(+1.500000 +0.7700000),

SIZE=(0.145 0.145),$
$
ENDSTYLE
END
-*-RUN
 
TYPE=DATA, COLUMN=N144,  BACKCOLOR=RGB(239 239 239), $
-GOTO DEB
-SET &IBIAPPS = GETTOK(&FOCEXURL,&FOCEXURL.LENGTH,1,'/',64,'A64');
-SET &IBIAPPS = TRUNCATE(&IBIAPPS);
-HTMLFORM BEGIN
<script type="text/javascript" src="./jquery/js/jquery.min.js"></script>
<script>
$('body').css( { 'background-color':'!IBI.AMP.BACKCOLOR;' } );
$('body > table').width( '100%' );
$('.x6').width( '33%' );
</script>
-HTMLFORM END  

-DEB
 