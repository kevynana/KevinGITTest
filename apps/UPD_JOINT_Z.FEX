SET ASNAMES = ON


TABLE FILE S1JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE S1JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE M1JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE M1JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE D1JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE D1JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

-* QTR 2

TABLE FILE S2JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE S2JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE M2JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE M2JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE D2JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE D2JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END


-* QTR3
TABLE FILE S3JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE S3JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE M3JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE M3JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE D3JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE D3JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

-* QTR4

TABLE FILE S4JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE S4JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE M4JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE M4JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE D4JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE D4JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

-* QTR5
TABLE FILE S5JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE S5JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE M5JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE M5JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE D5JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE D5JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

-* QTR6
TABLE FILE S6JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE S6JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE M6JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE M6JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE D6JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE D6JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

-* QTR7
TABLE FILE S7JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE S7JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE M7JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE M7JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE D7JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE D7JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

-* QTR8


TABLE FILE S8JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE S8JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE M8JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE M8JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE D8JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE D8JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

-* QTR9



TABLE FILE S9JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE S9JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE M9JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE M9JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE D9JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE D9JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

-* QTR0



TABLE FILE S0JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE S0JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE M0JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE M0JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE D0JOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE D0JOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

-* QTRY



TABLE FILE SYJOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE SYJOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE MYJOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE MYJOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE DYJOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE DYJOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

-* QTRZ

TABLE FILE SZJOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS SEGHOLD
END

MODIFY FILE SZJOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON SEGHOLD
END

TABLE FILE MZJOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS MKTHOLD
END

MODIFY FILE MZJOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON MKTHOLD
END

TABLE FILE DZJOINT
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT 
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
IF CLASS EQ 'Z'
ON TABLE HOLD AS DSTHOLD
END

MODIFY FILE DZJOINT
FIXFORM FROM SEGHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE CL_CAT='B';
ON MATCH UPDATE CL_CAT
ON NOMATCH REJECT
DATA ON DSTHOLD
END

