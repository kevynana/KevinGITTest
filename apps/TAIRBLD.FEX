CREATE FILE TMPAIR
-RUN

TABLE FILE AIR_MAIN
PRINT AIR_KEY TKT_DATE
-* BY AIR_KEY
ON TABLE HOLD
END
-RUN

-IF &RECORDS EQ 0 THEN GOTO NORECS;

MODIFY FILE TMPAIR
FIXFORM AIR_KEY/A45 TKT_DATE/A8
MATCH AIR_KEY
ON MATCH UPDATE TKT_DATE
ON NOMATCH INCLUDE
DATA ON HOLD
END

DEFINE FILE AHNATB
  TICKET_CODE/A2 = SUBSTR(45, AIR_KEY, 11, 12, 2, 'A2');
END
-RUN

MATCH FILE AHNATB
PRINT ROLL_KEY
BY AIR_KEY
IF TICKET_CODE EQ '1';
ON TABLE HOLD
RUN
FILE TMPAIR
PRINT TKT_DATE
BY AIR_KEY
AFTER MATCH HOLD AS XTHREE OLD-NOT-NEW 
END
-RUN

DEFINE FILE TMPAIR
  TICKET_CODE/A2 = SUBSTR(45, AIR_KEY, 11, 12, 2, 'A2');
END
-RUN

MATCH FILE TMPAIR
PRINT TKT_DATE
BY AIR_KEY
ON TABLE HOLD
RUN
FILE TMPSEG
PRINT TRN_DATE
BY AIR_KEY
AFTER MATCH HOLD AS XTWO OLD-NOT-NEW 
END
-RUN


