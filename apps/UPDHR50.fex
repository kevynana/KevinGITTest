-*********************************************************************
-* This program will retrieve the AROLL_LEV# data from CH_50 and
-* update CR_50 (new) with hierarchy data
-*********************************************************************
-*SET &ECHO=ALL;
SET MESSAGE=ON

SET EDAPATH=d:\tnt\ttracker\data; -
            d:\tnt\ttracker\system\data; -
            d:\tnt\ttracker\SUData; -
            d:\tnt\ttracker\system\image;
-RUN
-SET &USEFILE1=&&OLDPATH || &FILENAME || '.FOC';
-SET &USEFILE2=&&OLDPATH || 'HL' || &&COMP || '.FOC';

USE
  &USEFILE1 AS HR_50
  &USEFILE2 AS HH_50
END

TABLE FILE HR_50
PRINT   HTL_HIER.AROLL_LEV1 HTL_HIER.AROLL_LEV2
	HTL_HIER.AROLL_LEV3 HTL_HIER.AROLL_LEV4
	HTL_HIER.AROLL_LEV5 HTL_HIER.AROLL_LEV6
	HTL_HIER.AROLL_LEV7 HTL_HIER.AROLL_LEV8
	HTL_HIER.AROLL_LEV9 HTL_HIER.AROLL_LEV10
BY HTL_MAIN.HTL_KEY
WHERE HTL_MAIN.HTL_KEY EQ HTL_HIER.HTL_KEY
ON TABLE HOLD
END
-RUN
-IF &LINES EQ 0 GOTO ENDIT;

SET EDAPATH=d:\NewDBs;
-RUN

-*New database structure
-SET &USEFILE = &&NEWPATH || &FILENAME || '.FOC';
USE
  &USEFILE AS &FILENAME
END

MODIFY FILE &FILENAME
FIXFORM FROM HOLD
MATCH HTL_KEY
  ON NOMATCH REJECT
  ON MATCH UPDATE AROLL_LEV1 AROLL_LEV2 AROLL_LEV3 AROLL_LEV4 AROLL_LEV5
  ON MATCH UPDATE AROLL_LEV6 AROLL_LEV7 AROLL_LEV8 AROLL_LEV9 AROLL_LEV10
DATA ON HOLD
END
-RUN


-ENDIT
