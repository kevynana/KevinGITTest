-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* Created for the new quarterly review - JK 8/2/05
-* Changed ONLP define to use DOMNT vs NET_TKT_CNT - Steve - 11/16/2006
-* Changed VARNR to not check for equal to 0 (since decimal) - Steve - 02/14/2007
-* Changed calculations for use of nonrefundable tickets 
-* and advance purchase < 13 - using difference in % only - Steve - 07/31/2007
-*1/30/14 UPDATED ONLINE/TRADITIONAL DEFINES TO USE ONLINE_TRADITIONAL FIELD INSTEAD OF DOD_TYPE

-******************************************************************************
-INCLUDE SETECHO
SET ASNAMES = ON
-SET HOLDATTR = ON;
-RUN

-SET &POS0=0;
-SET &INC = 69;
-SET &INC1 = 12;
-SET &POS1T = &POS0 + 1 * &INC;
-SET &POS1T1 = &POS0 + 1 * &INC1;

-SET &POS1 = &POS1T + 0;
-SET &POS2 = &POS1T + 6;
-SET &POS3 = &POS1T + 12;
-SET &POS4 = &POS1T + 18;
-SET &POS5 = &POS1T + 24;
-SET &POS6 = &POS1T + 30;
-SET &POS7 = &POS1T + 36;
-SET &POS8 = &POS1T + 42;

-SET &POS1A = &POS1 - 1;
-SET &POS2A = &POS2 - 1;
-SET &POS3A = &POS3 - 1;
-SET &POS4A = &POS4 - 1;
-SET &POS5A = &POS5 - 1;
-SET &POS6A = &POS6 - 1;
-SET &POS7A = &POS7 - 1;
-SET &POS8A = &POS8 - 1;

-SET &POSA1 = &POS1T1 + 0;
-SET &POSA2 = &POS1T1 + 6;
-SET &POSA3 = &POS1T1 + 12;
-SET &POSA4 = &POS1T1 + 18;
-SET &POSA5 = &POS1T1 + 24;
-SET &POSA6 = &POS1T1 + 30;
-SET &POSA7 = &POS1T1 + 36;
-SET &POSA8 = &POS1T1 + 42;
-SET &POSA9 = &POS1T1 + 48;

-SET &POS1AA = &POSA1 - 1;
-SET &POS2AA = &POSA2 - 1;
-SET &POS3AA = &POSA3 - 1;
-SET &POS4AA = &POSA4 - 1;
-SET &POS5AA = &POSA5 - 1;
-SET &POS6AA = &POSA6 - 1;
-SET &POS7AA = &POSA7 - 1;
-SET &POS8AA = &POSA8 - 1;
-SET &POS9AA = &POSA9 - 1;

-* These variables are for Peer Group Information
-SET &PCPMQ1 = ' ';
-SET &PCPMQ2 = ' ';
-SET &PCPMQ3 = ' ';
-SET &PCPMQ4 = ' ';
-SET &PCPMQ5 = ' ';
-SET &PCPMQ6 = ' ';
-SET &PCPMQ7 = ' ';
-SET &PCPMQ8 = ' ';
-SET &P1CPM1 = 0;
-SET &P1CPM2 = 0;
-SET &P2CPM1 = 0;
-SET &P2CPM2 = 0;

-* These variables are for Base Group Information
-SET &BCPMQ1 = ' ';
-SET &BCPMQ2 = ' ';
-SET &BCPMQ3 = ' ';
-SET &BCPMQ4 = ' ';
-SET &BCPMQ5 = ' ';
-SET &BCPMQ6 = ' ';
-SET &BCPMQ7 = ' ';
-SET &BCPMQ8 = ' ';
-SET &BCPML1 = ' '; 
-SET &BCPML2 = ' '; 
-SET &PCPML1 = ' '; 
-SET &PCPML2 = ' '; 

-SET &B1CPM1 = 0;
-SET &B1CPM2 = 0;
-SET &B2CPM1 = 0;
-SET &B2CPM2 = 0;

-SET &TD1 = ' ';
-SET &TD2 = ' ';
-SET &TD3 = ' ';
-SET &TD4 = ' ';
-SET &TD5 = ' ';
-SET &TD6 = ' ';
-SET &TD7 = ' ';
-SET &TD8 = ' ';
-SET &PRIORYR = 'Y';

-***************************************************
-* generate include file for database allocation
-***************************************************
DEFINE FILE &&EXTRACT
  FARE_PAID/D12.2 = SEG_AMT + SEG_TAX;
  NET_TKT_CNT/D6  =   IF (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) THEN 1 ELSE 
                        IF (SEG_NBR EQ '01') AND 
                           (EX_FLAG EQ 'F') AND (SEG_COUNT EQ -1)
			   THEN (-1) ELSE 
                        IF (DOC_TYPE NE '1') AND
                           (SEG_NBR EQ '01') AND
                           (RF_FLAG EQ 'F') AND
			   (SEG_COUNT EQ -1)
			   THEN (-1) ELSE 0;
 TKT_PURCH/D8CS      =   IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND 
                           (CONJ_REL EQ 1) THEN 1 ELSE 0;
-* Defines on Previous Defines
 DISSAVINGS/D12 = IF EMBARK EQ 'DT1' THEN 0 ELSE
                         FARE_PAID - SEG_LOWEST;
 ONL_T/D6 = IF (ONLINE_TRADITIONAL EQ 'ONLINE') THEN NET_TKT_CNT ELSE 0;
 ADV_T/D6 = IF ADV_PURCH LE 13 THEN NET_TKT_CNT ELSE 0;
 VASAVINGS/D12 = SEG_DISCOUNT - FARE_PAID;

-INCLUDE QRFTRANA 
END

TABLEF FILE &&EXTRACT
PRINT ADV_T
  AIR_MAIN.INTL_DOM AS 'INTL_DOM'
  DISSAVINGS
  DOC_TYPE	
  DOD_TYPE
  DPT_DATE	
  EMBARK	
  EX_FLAG	
  EXCHG_SALE
  FARE_PAID	
  NET_TKT_CNT
  NONREF_FLAG
  ONL_T
  REFUSE_CODE
  ROLLUP_CODE
  RF_FLAG
  SEG_AMT	
  SEG_COM	
  SEG_COUNT
  SEG_NBR 	
  SEG_TAX 
  TKT_NUM
  TKT_PURCH	
  TRN_DATE
  VASAVINGS
  VOID_DATE 	
  VOID_STATUS 
  YEAR	
  TRAN
  CURRENT PRIOR PYTD PQ CQ
  

WHERE (TRN_DATE GE '&&FROMDT.EVAL') AND (TRN_DATE LE '&&TODT.EVAL') OR
      (TRN_DATE GE '&&FXDATE.EVAL') AND (TRN_DATE LE '&&TXDATE.EVAL')
WHERE VOID_DATE EQ 0
-********************************************************************
-* Where statements to select data specified in user profile
-********************************************************************
-INCLUDE RPTPARMS
ON TABLE HOLD AS RPTH
END
-RUN

DEFINE FILE RPTH
DOMNT/D6 = IF INTL_DOM EQ 'D' THEN NET_TKT_CNT ELSE 0;
DOMFP/D12.2 = IF INTL_DOM EQ 'D' THEN FARE_PAID ELSE 0;
ONL_TKTS/D6 = IF INTL_DOM EQ 'D' THEN ONL_T ELSE 0;
-* NR_TKTS/D12 = IF NONREF_FLAG EQ 'N' THEN NET_TKT_CNT ELSE 0; 
NR_TKTS/D6 = IF NONREF_FLAG EQ 'N' THEN NET_TKT_CNT ELSE 0;
END

-* Report Data
TABLE FILE RPTH
SUM ADV_T
    DOMFP
    DOMNT
    FARE_PAID
    NET_TKT_CNT
    NR_TKTS
    ONL_TKTS   
-*Added current PYTD fields    
    CURRENT CURRENT PYTD PQ CQ
BY YEAR
BY TRAN
ON TABLE HOLD AS RPTH1
END
-RUN

TABLE FILE RPTH1
SUM 
COMPUTE DATP/D6 = IF ((DOMNT LT 1) AND (DOMNT GT (-1))) THEN 0 ELSE
                     (DOMFP/DOMNT);
        TATP/D6 = IF (NET_TKT_CNT EQ 0) THEN 0 ELSE
                     (FARE_PAID/NET_TKT_CNT);
        ONLP/D6 = IF (DOMNT EQ 0) THEN 0 
            ELSE IF (ONL_TKTS EQ 0) THEN 0 ELSE ((ONL_TKTS/DOMNT)*100);
        NRP/D6 = IF (NET_TKT_CNT EQ 0) THEN 0 ELSE ((NR_TKTS/NET_TKT_CNT)*100);
        APP/D6 = IF (NET_TKT_CNT EQ 0) THEN 0 ELSE ((ADV_T/NET_TKT_CNT)*100);
BY TRAN
ON TABLE HOLD AS RPTH2
END
-RUN

-SET &CNT = 1;
-REPEAT InitVar2 8 TIMES
-SET &TDB.&CNT = ' ';
-SET &DATP.&CNT = ' ';
-SET &TATP.&CNT = ' ';
-SET &ONLP.&CNT = ' ';
-SET &NRP.&CNT = ' ';
-SET &APP.&CNT = ' ';
-SET &CNT = &CNT + 1;
-InitVar2

TABLE FILE RPTH2
PRINT DATP
      TATP
      ONLP
      NRP
      APP
BY TRAN
ON TABLE SAVE AS ATP FORMAT ALPHA
END
-RUN

-IF &LINES EQ 0 THEN GOTO NoATPData;

-SET &CNT = 1;
-REPEAT TOEND &LINES TIMES
-READ ATP NOCLOSE &TDB.&CNT.7. &DATP.6. &TATP.6. &ONLP.6. &NRP.6. &APP.6.

EX FMTNUMBER VALUE=&DATP,DOLLAR='Y',LEN=8
-RUN
-SET &DATP.&CNT = '&&RETVAL.EVAL';

EX FMTNUMBER VALUE=&TATP,DOLLAR='Y',LEN=8
-RUN
-SET &TATP.&CNT = '&&RETVAL.EVAL';

EX FMTNUMBER VALUE=&ONLP,DOLLAR='N',LEN=8
-RUN
-SET &ONLP.&CNT = '&&RETVAL.EVAL';

EX FMTNUMBER VALUE=&NRP,DOLLAR='N',LEN=8
-RUN
-SET &NRP.&CNT = '&&RETVAL.EVAL';

EX FMTNUMBER VALUE=&APP,DOLLAR='N',LEN=8
-RUN
-SET &APP.&CNT = '&&RETVAL.EVAL';

-SET &CNT = &CNT + 1;
-TOEND 
-CLOSE ATP
-NoATPData


-*  ATP, Online %, NonRefundable %, Advanced Purchase % Graph
DEFINE FILE RPTH
DOMNT/D12 = IF INTL_DOM EQ 'D' THEN NET_TKT_CNT ELSE 0;
DOMFP/D12.2 = IF INTL_DOM EQ 'D' THEN FARE_PAID ELSE 0;
ONL_TKTS/D12 = IF INTL_DOM EQ 'D' THEN ONL_T ELSE 0;
NR_TKTS/D12 = IF NONREF_FLAG EQ 'N' THEN NET_TKT_CNT ELSE 0;       
END

TABLE FILE RPTH
SUM DOMNT DOMFP FARE_PAID NET_TKT_CNT ONL_TKTS NR_TKTS ADV_T
BY YEAR
BY TRAN
ON TABLE HOLD AS FIRST
END
-RUN

TABLE FILE FIRST
SUM 
COMPUTE DATP/D12 = IF ((DOMNT LT 1) AND (DOMNT GT (-1))) THEN 0 ELSE
                      (DOMFP/DOMNT);
        TATP/D12 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                      (FARE_PAID/NET_TKT_CNT);
        ONLP/D6 = IF ((DOMNT LT 1) AND (DOMNT GT (-1))) THEN 0 ELSE
                      ((ONL_TKTS/DOMNT)*100);
        NRP/D6 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                     ((NR_TKTS/NET_TKT_CNT)*100);
        APP/D6 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                    ((ADV_T/NET_TKT_CNT)*100);
BY YEAR BY TRAN
ON TABLE HOLD AS DGHOLD
END
-RUN

-SET &G_TDG1 = 'N';
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' THEN GOTO AROUNDG;

GRAPH FILE DGHOLD
SUM DATP AS 'Domestic ATP'
    TATP AS 'Total ATP'
    ONLP AS '% Domestic Online'
    NRP AS '% Non-Refundable'
    APP AS '% 0-13 Adv Purch'
ACROSS TRAN AS ' '
ON GRAPH SET LOOKGRAPH VBAR2AX
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D OFF
ON GRAPH SET VZERO ON
ON GRAPH SET GRID OFF
ON GRAPH SET GRAPHSTYLE *
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(1, new Color, 145 207 255));
setSeriesFillColor(2, new Color, 125 0 0));
setSeriesFillColor(3, new Color, 160 0 181));
setSeriesFillColor(4, new Color, 255 128 0));
-*setSeriesFillColor(4, new Color, 255 255 128));
setMarkerDisplay(true);
setUseSeriesShapes(true);
setConnectLineMarkers(true);
setSeriesType(2,2);
setSeriesType(3,2);
setSeriesType(4,2);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setY2MajorGridDisplay(false);
setY2MinorGridDisplay(false);
setO1LabelRotate(0);
setPieFeelerTextDisplay(1);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(2);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(1);
setLegendTextAutofix(true);
setLegendMarkersPerRow(3);
setTitleString("Average Ticket Price (ATP), Domestic Online %");
setSubtitleString("Nonrefundable % and Advanced Purchase %");
setY1LabelDisplay(true);
setY1LabelFormat(1);
setY2LabelDisplay(true);
setY2LabelFormat(6);
setY1AxisSide(0);
setY2AxisSide(1);
setAutofit(getTitle(),true);

setTextJustHoriz(getTitle(),1);
setFontSizeAbsolute(getTitle(),true); 
setFontStyle(getTitle(),0);
setFontSize(getTitle(),12);

setTextJustHoriz(getSubtitle(),1);
setFontSizeAbsolute(getSubtitle(),true); 
setFontStyle(getSubtitle(),0);
setFontSize(getSubtitle(),10);

setFontSizeAbsolute(getLegendText(),true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
ON GRAPH HOLD AS TDG1 FORMAT SVG
END
-RUN

-SET &G_TDG1 = IF &LINES EQ 0 THEN 'N' ELSE 'Y';

-AROUNDG

-******************************************************************************
-* tabular data portion - CPM
-******************************************************************************
DEFINE FILE QRTRND2
  ROLL/A15 = IF ROLLUP_CODE EQ '&&BASEROLL.EVAL' THEN 'Cost Per Mile' 
    ELSE 'Peer Group CPM';
  BFARE/D12.2 = IF ROLL EQ 'Cost Per Mile' THEN FARE_PAID ELSE 0;
  BMILES/D12.2 = IF ROLL EQ 'Cost Per Mile' THEN NEW_SEG_MILES ELSE 0;
  PFARE/D12.2 = IF ROLL NE 'Cost Per Mile' THEN FARE_PAID ELSE 0;
  PMILES/D12.2 = IF ROLL NE 'Cost Per Mile' THEN NEW_SEG_MILES ELSE 0;
END
-RUN

TABLE FILE QRTRND2
SUM BFARE BMILES PFARE PMILES
COMPUTE BCPM/P6.2 = IF ((BMILES LT 1) AND (BMILES GT (-1))) THEN 0 ELSE
                        (BFARE/BMILES);
        PCPM/P6.2 = IF ((PMILES LT 1) AND (PMILES GT (-1))) THEN 0 ELSE
                        (PFARE/PMILES);
CURRENT PRIOR PYTD CQ PQ                        
BY ROLL
BY YEAR
BY TRAN
ON TABLE HOLD AS PBHOLD1
END
-RUN


-*********************************CHANGES *******************

TABLE FILE PBHOLD1
SUM BCPM PCPM
BY ROLL
BY YEAR
BY TRAN
ON TABLE HOLD AS PBHOLDX
END
-RUN

TABLE FILE PBHOLDX
SUM BCPM PCPM
BY YEAR
BY TRAN
ON TABLE SAVE AS CPMSAVE
END
-RUN

-SET &CNT = 1;
-REPEAT BCPMEND &LINES TIMES
-READ CPMSAVE NOCLOSE &YEAR.4. &TRAN.7. &BCPM.6. &PCPM.6.
-SET &YEAR.&CNT = &YEAR;
-SET &TD.&CNT = &TRAN;
-SET &BCPMQ.&CNT = &BCPM;
-SET &PCPMQ.&CNT = &PCPM;
-SET &CNT = &CNT + 1;
-BCPMEND
-CLOSE CPMSAVE

-******************************************************************************
-* the start of comment lines - CPM
-******************************************************************************
TABLE FILE PBHOLD1
BY TRAN
WHERE PRIOR EQ 'Y'
WHERE ROLL EQ 'Cost Per Mile'
ON TABLE SAVE AS TOTTRANS
END
-RUN
-*NOT sufficient prior data for comparison
-SET &PRIORYR = IF &LINES LT 4 THEN 'N' ELSE 'Y';
-IF &LINES LT 4 THEN GOTO QTRCOMP1;

-*Calculate CPM variations for Base Company YTD
-*Adding addtl Cost per mile Compute to show variance 
TABLE FILE PBHOLD1
-* SUM BCPM
SUM 
COMPUTE BCPM/P6.2 = IF ((BMILES LT 1) AND (BMILES GT (-1))) THEN 0 ELSE
                        (BFARE/BMILES);
BY YEAR 
WHERE ROLL EQ 'Cost Per Mile'
WHERE CURRENT EQ 'Y' OR PYTD EQ 'Y'
ON TABLE HOLD AS BCPMVY1
END
-RUN

TABLE FILE BCPMVY1
SUM BCPM
BY YEAR
ON TABLE SAVE AS BCPMVY
END
-RUN

-*No historical data
-IF &LINES LT 2 THEN GOTO ENDCPMCMT;

-SET &CNT = 0;
-REPEAT BCPMVYEND &LINES TIMES
-READ BCPMVY NOCLOSE &X.4. &CPM.6.
-SET &CNT = &CNT + 1;
-SET &B1CPM.&CNT = &CPM;
-BCPMVYEND

-*Calculate CPM variations for Base Company Last Q over Last Q
-*To prevent the mismatched comparison first in the query.
-QTRCOMP1
TABLE FILE PBHOLD1
SUM TRAN 
BY YEAR 
WHERE ROLL EQ 'Cost Per Mile'
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
ON TABLE SAVE
END
-RUN

-SET &NOBQ = IF &LINES LT 2 THEN 'N' ELSE 'Y';
-IF &LINES LT 2 THEN GOTO NOBCPMV;

TABLE FILE PBHOLD1
SUM LST.TRAN LST.BCPM
BY YEAR 
WHERE ROLL EQ 'Cost Per Mile'
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
ON TABLE SAVE AS BCPMV
END
-RUN

-IF &LINES EQ 0 THEN GOTO NOBCPMV;

-SET &CNT = 0;
-REPEAT BCPMVEND &LINES TIMES
-READ BCPMV NOCLOSE &X.4. &TRAN.7. &CPM.6.
-SET &CNT = &CNT + 1;
-SET &B2CPM.&CNT = &CPM;
-SET &TRAN.&CNT = &TRAN;
-BCPMVEND
-NOBCPMV

-*Calculate CPM variations for Peer Group YTD
TABLE FILE PBHOLD1
SUM  
COMPUTE PCPM/P6.2 = IF ((PMILES LT 1) AND (PMILES GT (-1))) THEN 0 ELSE
                       (PFARE/PMILES);
BY YEAR 
WHERE ROLL EQ 'Peer Group CPM'
WHERE CURRENT EQ 'Y' OR PYTD EQ 'Y'
ON TABLE HOLD AS BCPMVY1
END
-RUN

TABLE FILE BCPMVY1
SUM PCPM
BY YEAR
ON TABLE SAVE AS BCPMVY
END
-RUN


-IF &LINES EQ 0 THEN GOTO NOBCPMVY;

-SET &CNT = 0;
-REPEAT PCPMVYEND &LINES TIMES
-READ BCPMVY NOCLOSE &X.4. &CPM.6.
-SET &CNT = &CNT + 1;
-SET &P1CPM.&CNT = &CPM;
-PCPMVYEND
-CLOSE BCPMVY
-NOBCPMVY

-*Calculate CPM variations for Peer Group Last Q vs PRIOR LAST Q
TABLE FILE PBHOLD1
SUM LST.TRAN LST.PCPM
BY YEAR 
WHERE ROLL EQ 'Peer Group CPM'
-*WHERE CURRENT EQ 'Y' OR PYTD EQ 'Y'
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
ON TABLE SAVE AS BCPMV
END
-RUN
-SET &NOPQ = IF &LINES LT 2 THEN 'N' ELSE 'Y';
-IF &LINES LT 2 THEN GOTO NOBCPMV2;

-SET &CNT = 0;
-REPEAT PCPMVEND &LINES TIMES
-READ BCPMV NOCLOSE &X.4. &TRAN.7. &CPM.6.
-SET &CNT = &CNT + 1;
-SET &TRAN.&CNT = &TRAN;
-SET &P2CPM.&CNT = &CPM;
-PCPMVEND
-CLOSE BCPMV
-NOBCPMV2

-IF &NOBQ EQ 'N' AND &NOPQ EQ 'N' THEN GOTO ENDCPMCMT;

DEFINE FILE BRPTINST
 BYCPM/P6.2 = (&B1CPM2 - &B1CPM1);
 BQCPM/P6.2 = (&B2CPM2 - &B2CPM1);
 PYCPM/P6.2 = (&P1CPM2 - &P1CPM1);
 PQCPM/P6.2 = (&P2CPM2 - &P2CPM1);
  
  ABSBY/P6.2 = ABS(BYCPM);
  ABSBQ/P6.2 = ABS(BQCPM);
  ABSPY/P6.2 = ABS(PYCPM);
  ABSPQ/P6.2 = ABS(PQCPM);
END

TABLE FILE BRPTINST
PRINT BYCPM BQCPM PYCPM PQCPM ABSBY ABSBQ ABSPY ABSPQ
BY INST_KEY NOPRINT
ON TABLE SAVE
END
-RUN

-IF &LINES EQ 0 THEN GOTO ENDCPMCMT;

-READ SAVE &BYCPM.6. &BQCPM.6. &PYCPM.6. &PQCPM.6. &ABSBY.6. &ABSBQ.6. &ABSPY.6. &ABSPQ.6.

EX FMTNUMBER VALUE=&BYCPM,DOLLAR='N',ALIGNED='N'
-RUN
-SET &BYCPM = &&RETVAL;

EX FMTNUMBER VALUE=&ABSBY,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSBY = &&RETVAL;

EX FMTNUMBER VALUE=&BQCPM,DOLLAR='N',ALIGNED='N'
-RUN
-SET &BQCPM = &&RETVAL;

EX FMTNUMBER VALUE=&ABSBQ,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSBQ = &&RETVAL;

EX FMTNUMBER VALUE=&PYCPM,DOLLAR='N',ALIGNED='N'
-RUN
-SET &PYCPM = &&RETVAL;

EX FMTNUMBER VALUE=&ABSPY,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSPY = &&RETVAL;

EX FMTNUMBER VALUE=&PQCPM,DOLLAR='N',ALIGNED='N'
-RUN
-SET &PQCPM = &&RETVAL;

EX FMTNUMBER VALUE=&ABSPQ,DOLLAR='N',ALIGNED='N'
-RUN
-SET &ABSPQ = &&RETVAL;


-SET &TEMP = IF &BYCPM GT .00 THEN ' increased $' | '&BYCPM.EVAL ' ELSE IF &BYCPM LT 0 THEN ' decreased $' | '&ABSBY.EVAL' ELSE 'remains same ';
-SET &BCPML1 = IF &PRIORYR EQ 'N' THEN '  ' ELSE 'Average cost per mile (CPM)'|' '| '&TEMP.EVAL' || ' year to date.';

-*-SET &TEMP = IF &BQCPM GT .00 THEN '(increased $' | '&BQCPM.EVAL ' ELSE IF &BQCPM LT 0 THEN '( decreased $' | '&ABSBQ.EVAL' ELSE '(remains same ';
-*-SET &BCPML2 = IF &NOBQ EQ 'N' THEN ' ' ELSE  '&TEMP.EVAL' | ' &TRAN2.EVAL' | ' over ' | '&TRAN1.EVAL' | ')';

-SET &TEMP = IF '&PRIORYR.EVAL' EQ 'Y' AND &BQCPM GT .00 THEN '(increased $' | '&BQCPM.EVAL ' 
- ELSE IF '&PRIORYR.EVAL' EQ 'Y' AND  &BQCPM LT 0 THEN '( decreased $' | '&ABSBQ.EVAL' 
- ELSE IF '&PRIORYR.EVAL' EQ 'Y' THEN '(remains same '
- ELSE IF '&PRIORYR.EVAL' EQ 'N' AND &BQCPM GT .00 THEN 'Average CPM increased $' | '&BQCPM.EVAL ' 
- ELSE IF '&PRIORYR.EVAL' EQ 'N' AND  &BQCPM LT 0 THEN 'Average CPM decreased $' | '&ABSBQ.EVAL' 
- ELSE 'Average cost per mile (CPM) remains same.';

-SET &BCPML2 = IF &NOBQ EQ 'N' THEN ' ' 
- ELSE IF &PRIORYR EQ 'N' THEN '&TEMP.EVAL' | '&TRAN2.EVAL' || ' over' | '&TRAN1.EVAL' | '.'
- ELSE '&TEMP.EVAL' | '&TRAN2.EVAL' || ' over' | '&TRAN1.EVAL' | ')';

-SET &TEMP = IF &PYCPM GT .00 THEN ' increased $' | '&PYCPM.EVAL ' ELSE IF &PYCPM LT 0 THEN ' decreased $' | '&ABSPY.EVAL ' ELSE ' remains same ';
-SET &PCPML1 = IF &&TOTPEERS EQ 0 THEN ' ' ELSE 'Peer group average (CPM)'|' '|'&TEMP.EVAL' || ' year to date.';

-SET &TEMP = IF &NOPQ EQ 'N'  THEN ' ' ELSE IF &PQCPM GT .00 THEN '(increased $' | '&PQCPM.EVAL ' ELSE IF &PQCPM LT 0 THEN '( decreased $' | '&ABSPQ.EVAL ' ELSE '(remains same ';
-SET &PCPML2 = IF &&TOTPEERS EQ 0 THEN ' ' ELSE '&TEMP.EVAL' | ' &TRAN2.EVAL' | ' over ' | '&TRAN1.EVAL' | ')';

-ENDCPMCMT
-******************************************************************************
-* the end of comment lines - CPM
-******************************************************************************


-SET &G_TDG2='N';
-IF &&SKIPGRAPH.EVAL EQ 'Y' THEN GOTO AROUNDG1;
-* COST PER MILE GRAPH
DEFINE FILE QRTRND2
BFARE/P12.2 = IF ROLLUP_CODE EQ '&&BASEROLL' THEN FARE_PAID ELSE 0;
PFARE/P12.2 = IF ROLLUP_CODE NE '&&BASEROLL' THEN FARE_PAID ELSE 0;
BMILE/P10 = IF ROLLUP_CODE EQ '&&BASEROLL' THEN NEW_SEG_MILES ELSE 0;
PMILE/P10 = IF ROLLUP_CODE NE '&&BASEROLL' THEN NEW_SEG_MILES ELSE 0;
END
-RUN

TABLE FILE QRTRND2
SUM BFARE BMILE PFARE PMILE
BY YEAR
BY TRAN
ON TABLE HOLD AS CPMG
END
-RUN

GRAPH FILE CPMG
SUM 
COMPUTE BCPM/P12.2CS = IF ((BMILE LT 1) AND (BMILE GT (-1))) THEN 0 ELSE
                          (BFARE/BMILE); AS 'Cost Per Mile'
COMPUTE PCPM/P12.2CS = IF ((PMILE LT 1) AND (PMILE GT (-1))) THEN 0 ELSE
                          (PFARE/PMILE); AS 'Peer Group CPM'
ACROSS TRAN AS ' '
ON GRAPH SET LOOKGRAPH VBAR
ON GRAPH SET BARNUMB OFF
ON GRAPH SET 3D OFF
ON GRAPH SET VZERO OFF
ON GRAPH SET GRID OFF
ON GRAPH SET GRAPHSTYLE *
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(1, new Color, 145 207 255));
setMarkerDisplay(true);
setUseSeriesShapes(true);
setConnectLineMarkers(true);
setSeriesType(1,2);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(false);
setY1MajorGridDisplay(false);
setY1MinorGridDisplay(false);
setY2MajorGridDisplay(false);
setY2MinorGridDisplay(false);
setO1LabelRotate(0);
setPieFeelerTextDisplay(1);
setPieLabelDisplay(0);
setTextFormatPreset(getPieSliceLabel(),1);
setRiserBorderMode(2);
setSeriesDefaultTransparentBorderColor(true);
setUseSeriesBorderDefaults(true);
setLegendDisplay(true);
setLegendPosition(1);
setLegendTextAutofix(true);
setLegendMarkersPerRow(3);
setTitleString("Cost Per Mile");
setSubtitleString(" ");
setY1LabelDisplay(true);
setY1LabelFormat(1);
setY2LabelDisplay(true);
setY2LabelFormat(6);
setY1AxisSide(0);
setY2AxisSide(1);
setAutofit(getTitle(),true);

setTextJustHoriz(getTitle(),1);
setFontSizeAbsolute(getTitle(),true); 
setFontStyle(getTitle(),0);
setFontSize(getTitle(),12);

setFontSizeAbsolute(getLegendText(),true);
setFontSizeAbsolute(getY1Title(),true);
setFontSizeAbsolute(getY1Label(),true);
setFontSizeAbsolute(getY2Title(),true);
setFontSizeAbsolute(getY2Label(),true);
setFontSizeAbsolute(getO1Title(),true);
setPlace(true);
ENDSTYLE
ON GRAPH HOLD AS TDG2 FORMAT SVG
END
-RUN

-SET &G_TDG2=IF &LINES GT 0 THEN 'Y' ELSE 'N';
-AROUNDG1


DEFINE FILE RPTH              
CFARE/D12.2 = IF CURRENT EQ 'Y' THEN FARE_PAID ELSE 0;
PFARE/D12.2 = IF PRIOR EQ 'Y' THEN FARE_PAID ELSE 0;
CNT/D6 = IF CURRENT EQ 'Y' THEN NET_TKT_CNT ELSE 0;
PNT/D6 = IF PRIOR EQ 'Y' THEN NET_TKT_CNT ELSE 0;
CNR/D6 = IF (CURRENT EQ 'Y') AND (NONREF_FLAG EQ 'N') THEN NET_TKT_CNT ELSE 0;
PNR/D6 = IF (PRIOR EQ 'Y') AND (NONREF_FLAG EQ 'N') THEN NET_TKT_CNT ELSE 0;
CADV/D12 = IF CURRENT EQ 'Y' THEN ADV_T ELSE 0;
PADV/D12 = IF PRIOR EQ 'Y' THEN ADV_T ELSE 0;
-* TRN2/YY = TRAN;
FLAG/A1 = 'A';
END
-RUN

-******************************************************************************
-* comment lines section 1 - YTD comparison and Current Qtr vs Prior Qtr
-******************************************************************************
-SET &CMTLINE1 = ' ';
-SET &CMTLINE2 = ' ';
-SET &CMTLINE3 = ' ';
-SET &CMTLINE4 = ' ';
-SET &CMTLINE5 = ' ';
-SET &CMTLINE6 = ' ';
-IF &PRIORYR EQ 'N' THEN GOTO QTRCOMP2;
TABLE FILE RPTH
SUM CFARE PFARE CNT PNT CNR PNR CADV PADV CQ PQ
BY FLAG
BY YEAR
BY TRAN
WHERE CURRENT EQ 'Y' OR PYTD EQ 'Y'
ON TABLE HOLD AS 1HOLD
END
-RUN

TABLE FILE 1HOLD
SUM COMPUTE CAVG/D6.2 = IF ((CNT LT 1) AND (CNT GT (-1))) THEN 0 ELSE
                           (CFARE/CNT);
    COMPUTE PAVG/D6.2 = IF ((PNT LT 1) AND (PNT GT (-1))) THEN 0 ELSE
                           (PFARE/PNT);
    COMPUTE CNRP/I6.2 = IF ((CNT LT 1) AND (CNT GT (-1))) THEN 0 ELSE
                           (CNR/CNT)*100;
    COMPUTE PNRP/I6.2 = IF ((PNT LT 1) AND (PNT GT (-1))) THEN 0 ELSE
                            (PNR/PNT)*100;
    COMPUTE CAPP/I6.2 = IF CNT EQ 0 THEN 0 ELSE (CADV/CNT)*100;
    COMPUTE PAPP/I6.2 = IF PNT EQ 0 THEN 0 ELSE (PADV/PNT)*100;
  
    COMPUTE VARAT/D3 = IF ((PAVG LT 1) AND (PAVG GT (-1))) THEN 0 ELSE
                         (((CAVG-PAVG)/PAVG)*100);                        

-*     COMPUTE VARNR/I3 =   IF PNRP EQ 0 THEN 0 ELSE ((CNRP-PNRP)/PNRP)*100;
-*     COMPUTE VARAP/I3 = IF PAPP EQ 0 THEN 0 ELSE (((CAPP-PAPP)/PAPP)*100);                                                       

     COMPUTE VARNR/I3 = CNRP-PNRP;
     COMPUTE VARAP/I3 = CAPP-PAPP;                                                       

        
      COMPUTE ABSVARAT/D3 = ABS(VARAT);
      COMPUTE ABSVARNR/I3 = ABS(VARNR);
      COMPUTE ABSVARAP/I3 = ABS(VARAP);
    
BY FLAG
ON TABLE HOLD AS 2HOLD
END
-RUN


DEFINE FILE 2HOLD
FIELD2/A13 = IF VARAT GT 0 THEN ' increased' ELSE IF VARAT LT 0 THEN ' decreased' ELSE ' remains same';
FIELD6/A13 = IF VARNR GT 0 THEN ' increased' ELSE IF VARNR LT 0 THEN ' decreased' ELSE ' remains same';
FIELD8/A13 = IF VARAP GT 0 THEN ' increased' ELSE IF VARAP LT 0 THEN ' decreased' ELSE ' remains same';

-*Y indicate "remains same".
FLAG2/A1= IF ABSVARAT NE 0 THEN 'N' ELSE 'Y';
FLAG6/A1= IF ABSVARNR NE 0 THEN 'N' ELSE 'Y';
FLAG8/A1= IF ABSVARAP NE 0 THEN 'N' ELSE 'Y';

END
-RUN

TABLE FILE 2HOLD
PRINT FIELD2 ABSVARAT FIELD6 ABSVARNR FIELD8 ABSVARAP FLAG2 FLAG6 FLAG8
ON TABLE SAVE AS COMMENT1 FORMAT ALPHA
END
-RUN

-READ COMMENT1 &FIELD2.13. &VARAT.3. &FIELD6.13. &VARNR.3. &FIELD8.13. &VARAP.3. &FLAG2.1. &FLAG6.1. &FLAG8.1.

EX FMTNUMBER VALUE=&VARAT,DOLLAR='N',ALIGNED='N'
-RUN
-SET &VARAT = &&RETVAL;

EX FMTNUMBER VALUE=&VARNR,DOLLAR='N',ALIGNED='N'
-RUN
-SET &VARNR = &&RETVAL;

EX FMTNUMBER VALUE=&VARAP,DOLLAR='N',ALIGNED='N'
-RUN
-SET &VARAP = &&RETVAL;

-SET &CMTLINE1 = IF &PRIORYR EQ 'N' THEN ' '
-     ELSE IF '&FLAG2.EVAL' EQ 'Y' THEN 'Average ticket price remains same year to date.'
-     ELSE 'Average ticket price ' | &FIELD2 || ' &VARAT.EVAL' || '% year to date.';
-SET &CMTLINE3 = IF &PRIORYR EQ 'N' THEN ' '
-     ELSE IF '&FLAG6.EVAL' EQ 'Y' THEN 'Use of nonrefundable tickets remains same year to date.'
-     ELSE 'Use of nonrefundable tickets ' | &FIELD6 || ' &VARNR.EVAL' || '% year to date.';
-SET &CMTLINE5 = IF &PRIORYR EQ 'N' THEN ' '
-     ELSE IF '&FLAG8.EVAL' EQ 'Y' THEN 'Advanced purchase within 13 days remains same year to date.'
-     ELSE 'Advanced purchase within 13 days ' | &FIELD8 || ' &VARAP.EVAL' || '% year to date.';

-****** Start to calculate the changes by quarter ***************
-QTRCOMP2
TABLE FILE RPTH1
SUM CURRENT PYTD
COMPUTE NRP1/D6 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                     ((NR_TKTS/NET_TKT_CNT)*100);
        APP1/D6 = IF ((NET_TKT_CNT LT 1) AND (NET_TKT_CNT GT (-1))) THEN 0 ELSE
                    ((ADV_T/NET_TKT_CNT)*100);    
        NRP/I3 = NRP1;
        APP/I3 = APP1;

BY YEAR
BY TRAN
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
ON TABLE HOLD
END
-RUN


TABLE FILE HOLD
SUM LST.NRP LST.APP
BY YEAR
ON TABLE SAVE
END
-RUN

-IF &LINES LT 2 THEN GOTO NOREAD2;
-SET &CNT = 1;
-REPEAT TOENDNRP &LINES TIMES
-READ SAVE NOCLOSE &X.4 &NRP.I3. &APP.I3.
-SET &NRPX.&CNT = &NRP;
-SET &APPX.&CNT = &APP;
-SET &CNT = &CNT + 1;
-TOENDNRP

-* -SET &VNR = (((&NRPX2 - &NRPX1)/&NRPX1)*100);
-* -SET &VAP = (((&APPX2 - &APPX1)/&APPX1)*100);
-SET &VNR = (&NRPX2 - &NRPX1);
-SET &VAP = (&APPX2 - &APPX1);
-SET &VNRA = ABS(&VNR);
-SET &VAPA = ABS(&VAP);
-RUN

EX FMTNUMBER VALUE=&VNRA,DOLLAR='N',ALIGNED='N'
-RUN
-SET &VNRA = &&RETVAL;

EX FMTNUMBER VALUE=&VAPA,DOLLAR='N',ALIGNED='N'
-RUN
-SET &VAPA = &&RETVAL;

-*-SET &TEMP = IF &VNR GT 0 THEN '( increased ' | '&VNRA.EVAL' || '% '
-*-  ELSE IF &VNR LT 0 THEN '( decreased ' | '&VNRA.EVAL' || '% '
-*-  ELSE '( remains same ';
-*-SET &CMTLINE4 = IF &NOBQ EQ 'N' THEN ' ' ELSE '&TEMP.EVAL' | '&TRAN2.EVAL' || ' over' | '&TRAN1.EVAL' | ')';

-SET &TEMP = IF &PRIORYR EQ 'N' AND &VNR GT 0 THEN 'Use of nonrefundable tickets increased ' | '&VNRA.EVAL' || '% '
-  ELSE IF &PRIORYR EQ 'N' AND &VNR LT 0 THEN 'Use of nonrefundable tickets decreased ' | '&VNRA.EVAL' || '% '
-  ELSE IF &PRIORYR EQ 'N' THEN 'Use of nonrefundable tickets remains same '
-  ELSE IF &VNR GT 0 THEN '( increased ' | '&VNRA.EVAL' || '% '
-  ELSE IF &VNR LT 0 THEN '( decreased ' | '&VNRA.EVAL' || '% '
-  ELSE '( remains same ';

-SET &CMTLINE4 = IF &NOBQ EQ 'N' THEN ' ' 
- ELSE IF &PRIORYR EQ 'N' THEN '&TEMP.EVAL' | '&TRAN2.EVAL' || ' over' | '&TRAN1.EVAL' | '.'
- ELSE '&TEMP.EVAL' | '&TRAN2.EVAL' || ' over' | '&TRAN1.EVAL' | ')';

-*-SET &TEMP = IF &VAP GT 0 THEN '( increased ' | '&VAPA.EVAL' || '% ' 
-*-  ELSE IF &VAP LT 0 THEN '( decreased ' | '&VAPA.EVAL' || '% '
-*-  ELSE '( remains same ';
-*-SET &CMTLINE6 = IF &NOBQ EQ 'N' THEN ' ' ELSE  '&TEMP.EVAL' | '&TRAN2.EVAL' || ' over' | '&TRAN1.EVAL' | ')';

-SET &TEMP = IF &PRIORYR EQ 'N' AND &VAP GT 0 THEN 'Advance purchase within 13 days increased ' | '&VAPA.EVAL' || '% '
-  ELSE IF &PRIORYR EQ 'N' AND &VAP LT 0 THEN 'Advance purchase within 13 days decreased ' | '&VAPA.EVAL' || '% '
-  ELSE IF &PRIORYR EQ 'N' THEN 'Advance purchase within 13 days remains same '
-  ELSE IF &VAP GT 0 THEN '( increased ' | '&VAPA.EVAL' || '% '
-  ELSE IF &VAP LT 0 THEN '( decreased ' | '&VAPA.EVAL' || '% '
-  ELSE '( remains same ';

-SET &CMTLINE6 = IF &NOBQ EQ 'N' THEN ' ' 
- ELSE IF &PRIORYR EQ 'N' THEN '&TEMP.EVAL' | '&TRAN2.EVAL' || ' over' | '&TRAN1.EVAL' | '.'
- ELSE '&TEMP.EVAL' | '&TRAN2.EVAL' || ' over' | '&TRAN1.EVAL' | ')';

-NOREAD2

TABLE FILE RPTH
SUM CFARE PFARE CNT PNT CNR PNR CADV PADV CQ PQ
BY FLAG
BY YEAR
BY TRAN
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
ON TABLE HOLD AS HOLDCQPQ
END
-RUN

TABLE FILE HOLDCQPQ
SUM COMPUTE CAVG/P7.2 = IF ((CNT LT 1) AND (CNT GT (-1))) THEN 0 ELSE
                           (CFARE/CNT);
    COMPUTE PAVG/P7.2 = IF ((PNT LT 1) AND (PNT GT (-1))) THEN 0 ELSE
                           (PFARE/PNT);
BY YEAR 
BY TRAN
WHERE CQ EQ 'Y' OR PQ EQ 'Y'
ON TABLE HOLD AS HOLD3
END
-RUN

TABLE FILE HOLD3
SUM LST.TRAN LST.CAVG LST.PAVG 
-*LST.CNRP LST.PNRP LST.CADV LST.PADV
BY YEAR
ON TABLE SAVE
END
-RUN

-IF &LINES LT 2 THEN GOTO ENDCOMMENT;
-SET &CNT = 1;
-REPEAT TOCEND &LINES TIMES
-READ SAVE NOCLOSE &YEAR.4. &TRAN.7. &CAVG.7. &PAVG.7. 
-SET &TRAN.&CNT = &TRAN;

-SET &CAVG.&CNT = &CAVG;
-SET &PAVG.&CNT = &PAVG;
-SET &CNT = &CNT + 1;
-TOCEND
-*the first record contains the value of previous Q.
-*the second contains the value of current Q.
DEFINE FILE BRPTINST
  FLAG1/A1 = IF &PAVG1 EQ 0 THEN 'Y' ELSE 'N';
  VAVG/D3 = IF FLAG1 EQ 'N' THEN (&CAVG2 - &PAVG1)/&PAVG1 * 100 ELSE 0;
     
  VAVGA/D3 = ABS(VAVG);
END
TABLE FILE BRPTINST
PRINT FLAG1 VAVG VAVGA
BY INST_KEY NOPRINT
ON TABLE SAVE
END
-RUN
-IF &LINES EQ 0 THEN GOTO ENDCOMMENT;

-READ SAVE &FG1.1. &VAVG.3. &VAVGA.3. 

EX FMTNUMBER VALUE=&VAVGA,DOLLAR='N',ALIGNED='N'
-RUN
-SET &VAVGA = &&RETVAL;


-*-SET &TEMP = IF &VAVG GT 0 THEN ' ( increased ' | '&VAVGA.EVAL' || '% ' 
-*-  ELSE IF &VAVG LT 0 THEN ' ( decreased ' | '&VAVGA.EVAL' || '% ' 
-*-  ELSE '( remains same';
-*-SET &CMTLINE2 = IF &NOBQ EQ 'N' THEN ' ' ELSE  '&TEMP.EVAL' | ' &TRAN2.EVAL' | ' over ' | ' &TRAN1.EVAL' | ')';

-SET &TEMP = IF &PRIORYR EQ 'N' AND &VAVG GT 0 THEN 'Average ticket price increased ' | '&VAVGA.EVAL' || '% '
-  ELSE IF &PRIORYR EQ 'N' AND &VAVG LT 0 THEN 'Average ticket price decreased ' | '&VAVGA.EVAL' || '% '
-  ELSE IF &PRIORYR EQ 'N' THEN 'Average ticket price remains same '
-  ELSE IF &VAVG GT 0 THEN '( increased ' | '&VAVGA.EVAL' || '% '
-  ELSE IF &VAVG LT 0 THEN '( decreased ' | '&VAVGA.EVAL' || '% '
-  ELSE '( remains same ';

-SET &CMTLINE2 = IF &NOBQ EQ 'N' THEN ' ' 
- ELSE IF &PRIORYR EQ 'N' THEN '&TEMP.EVAL' | '&TRAN2.EVAL' || ' over' | '&TRAN1.EVAL' | '.'
- ELSE '&TEMP.EVAL' | '&TRAN2.EVAL' || ' over' | '&TRAN1.EVAL' | ')';


-ENDCOMMENT
-******************************************************************************
-* end of comment lines section 1 - YTD comparison and Current Qtr vs Prior Qtr
-******************************************************************************


TABLE FILE BRPTINST
BY INST_KEY NOPRINT
ON TABLE SET PAGE-NUM OFF
&&OUTLINE1
FORMAT PDF OPEN
-* &&OUTLINE2
FOOTING
"</5"
"&CMTLINE1"
"&CMTLINE2"
"</2"
"&CMTLINE3"
"&CMTLINE4"
"</2"
"&CMTLINE5"
"&CMTLINE6"
"</1"
"<55 _________________________________________________________________________________________________"
"<55 |                    <&POS1A | <&POS1 &TDB1 <&POS2A | <&POS2 &TDB2 <&POS3A | <&POS3 &TDB3 <&POS4A | <&POS4 &TDB4 <&POS5A | <&POS5 &TDB5 <&POS6A | <&POS6 &TDB6 <&POS7A | <&POS7 &TDB7 <&POS8A | <&POS8 &TDB8 <116 |"
"<55 |_______________________________________________________________________________________________<116 | "
"<55 |Domestic ATP        <&POS1A | <&POS1 &DATP1 <&POS2A | <&POS2 &DATP2 <&POS3A | <&POS3 &DATP3 <&POS4A | <&POS4 &DATP4 <&POS5A | <&POS5 &DATP5 <&POS6A | <&POS6 &DATP6 <&POS7A | <&POS7 &DATP7 <&POS8A | <&POS8 &DATP8 <116 |"
"<55 |_______________________________________________________________________________________________<116 |"
"<55 |Total ATP           <&POS1A | <&POS1 &TATP1 <&POS2A | <&POS2 &TATP2 <&POS3A | <&POS3 &TATP3 <&POS4A | <&POS4 &TATP4 <&POS5A | <&POS5 &TATP5 <&POS6A | <&POS6 &TATP6 <&POS7A | <&POS7 &TATP7 <&POS8A | <&POS8 &TATP8 <116 |"
"<55 |_______________________________________________________________________________________________<116 |"
"<55 |% Domestic Online   <&POS1A | <&POS1 &ONLP1 <&POS2A | <&POS2 &ONLP2 <&POS3A | <&POS3 &ONLP3 <&POS4A | <&POS4 &ONLP4 <&POS5A | <&POS5 &ONLP5 <&POS6A | <&POS6 &ONLP6 <&POS7A | <&POS7 &ONLP7 <&POS8A | <&POS8 &ONLP8 <116 |"
"<55 |_______________________________________________________________________________________________<116 |"
"<55 |% Non-Refundable    <&POS1A | <&POS1 &NRP1 <&POS2A | <&POS2 &NRP2 <&POS3A | <&POS3 &NRP3 <&POS4A | <&POS4 &NRP4 <&POS5A | <&POS5 &NRP5 <&POS6A | <&POS6 &NRP6 <&POS7A | <&POS7 &NRP7 <&POS8A | <&POS8 &NRP8 <116 |"
"<55 |_______________________________________________________________________________________________<116 |"
"<55 |% 0-13 Adv Pur Days <&POS1A | <&POS1 &APP1 <&POS2A | <&POS2 &APP2 <&POS3A | <&POS3 &APP3 <&POS4A | <&POS4 &APP4 <&POS5A | <&POS5 &APP5 <&POS6A | <&POS6 &APP6 <&POS7A | <&POS7 &APP7 <&POS8A | <&POS8 &APP8 <116 |"
"<55 |________________________________________________________________________________________________<116 |"
"</5"
"<60 &BCPML1"
"<60 &BCPML2"
"</2"
"<60 &PCPML1"
"<60 &PCPML2"
"</8"
"__________________________________________________________________________________________________"
"|               <&POS1AA | <&POSA1 &TD1    <&POS2AA | <&POSA2 &TD2    <&POS3AA | <&POSA3 &TD3    <&POS4AA | <&POSA4 &TD4    <&POS5AA | <&POSA5 &TD5    <&POS6AA | <&POSA6 &TD6    <&POS7AA | <&POSA7 &TD7    <&POS8AA | <&POSA8 &TD8    <63 |"
"|_________________________________________________________________________________________________<63 | "
"|Cost Per Mile  <&POS1AA | <&POSA1 &BCPMQ1 <&POS2AA | <&POSA2 &BCPMQ2 <&POS3AA | <&POSA3 &BCPMQ3 <&POS4AA | <&POSA4 &BCPMQ4 <&POS5AA | <&POSA5 &BCPMQ5 <&POS6AA | <&POSA6 &BCPMQ6 <&POS7AA | <&POSA7 &BCPMQ7 <&POS8AA | <&POSA8 &BCPMQ8 <63 |"
"|_________________________________________________________________________________________________<63 | "
"|Peer Group CPM <&POS1AA | <&POSA1 &PCPMQ1 <&POS2AA | <&POSA2 &PCPMQ2 <&POS3AA | <&POSA3 &PCPMQ3 <&POS4AA | <&POSA4 &PCPMQ4 <&POS5AA | <&POSA5 &PCPMQ5 <&POS6AA | <&POSA6 &PCPMQ6 <&POS7AA | <&POSA7 &PCPMQ7 <&POS8AA | <&POSA8 &PCPMQ8 <63 |"
"|_________________________________________________________________________________________________<63 | "
ON TABLE SET STYLE *
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.250000, RIGHTMARGIN=0.150000, 
    TOPMARGIN=0.500000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FONT=TIMES NEW ROMAN, SIZE=7, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=FOOTING,FONT=COURIER NEW,$
TYPE=FOOTING, SIZE=15, LINE=7,  OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=8,  OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=12, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=13, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=17, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=18, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=40, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=41, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=45, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=FOOTING, SIZE=15, LINE=46, OBJECT=TEXT, FONT=TIMES NEW ROMAN, $
TYPE=REPORT, IMAGE=TrendingData.GIF,POSITION=(0.1 0.1), SIZE=(10.75 .75), $
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' OR &G_TDG1 EQ 'N' GOTO SKIP_DGAT1;
TYPE=REPORT,IMAGE=TDG1.SVG,POSITION=(5.5  1.0), SIZE=(5.5 2.5), $
-SKIP_DGAT1
-IF '&&SKIPGRAPH.EVAL' EQ 'Y' OR &G_TDG2 EQ 'N' GOTO SKIP_DGAT2;
TYPE=REPORT,IMAGE=TDG2.SVG,POSITION=(0.3  4.7), SIZE=(5.5 2.5), $
-SKIP_DGAT2
ENDSTYLE
END
-RUN
