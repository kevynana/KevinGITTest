-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**


SET ASNAMES=ON

DEFINE FILE CURRRF
NON_FLAG/A15 = IF NONREF_FLAG EQ 'N' THEN 'NON-REFUNDABLE' ELSE 
               'REFUNDABLE';
END

TABLE FILE CURRRF
SUM NET_TKT_CNT
    PCT.NET_TKT_CNT AS 'PCTTKT'
BY NON_FLAG
ON TABLE HOLD AS OVREF1
END
-RUN

DEFINE FILE OVREF1
CATEGORY/A30 = 'REF/NON-REF';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE OVREF1
PRINT CATEGORY/A30 AND NON_FLAG/A30 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKT_CNT/D15 AS 'VOL_CURR' AND 
PCTTKT/D15 AS 'TKT_CURR' AND 
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
ON TABLE HOLD AS OVREF2
END
-RUN

TABLE FILE OVREF2
PRINT CATEGORY AND ROW_LABEL AND CAT_ORDER
      AND ROW_ORDER AND VOL_CURR AND TKT_CURR
ON TABLE HOLD AS OVREF3
END
MODIFY FILE OV1_MAIN
FIXFORM FROM OVREF3
MATCH CATEGORY ROW_LABEL
ON MATCH REJECT
ON NOMATCH INCLUDE
DATA ON OVREF3
END
-RUN

DEFINE FILE PRRRF
NON_FLAG/A15 = IF NONREF_FLAG EQ 'N' THEN 'NON-REFUNDABLE' ELSE 
               'REFUNDABLE';
END

TABLE FILE PRRRF
SUM NET_TKT_CNT
    PCT.NET_TKT_CNT AS 'PCTTKT'
BY NON_FLAG
ON TABLE HOLD AS OVPRREF
END
-RUN

DEFINE FILE OVPRREF
CATEGORY/A30 = 'REF/NON-REF';
CAT_ORDER/I2 = 2;
END
-RUN

TABLE FILE OVPRREF
PRINT CATEGORY/A30 AND NON_FLAG/A30 AS 'ROW_LABEL' AND
CAT_ORDER/I2 AND NET_TKT_CNT/D15 AS 'VOL_PRIOR' AND 
PCTTKT/D15 AS 'TKT_PRIOR' AND 
COMPUTE ROW_ORDER/I2 = ROW_ORDER + 1;    
ON TABLE HOLD AS OVPRREF1
END
-RUN

TABLE FILE OVPRREF1
PRINT CATEGORY AND ROW_LABEL AND VOL_PRIOR AND TKT_PRIOR
ON TABLE HOLD AS OVPRREF2
END
MODIFY FILE OV1_MAIN
FIXFORM FROM OVPRREF2
MATCH CATEGORY ROW_LABEL
ON MATCH UPDATE VOL_PRIOR TKT_PRIOR
ON NOMATCH INCLUDE
DATA ON OVPRREF2
END
-RUN





