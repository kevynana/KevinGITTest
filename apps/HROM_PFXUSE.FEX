-*7/11/16  DLV  S-20630    Added EMP_ID TASF_TKT_NUM to extract

-INCLUDE SETECHO

 

-SET &COMPPF = 'PF' ||&&COMPNY || '.FOC';
-SET &PROFDATES = &&WEB_PATH || 'PROFDATES.fex';

-SET &DATAPATH='&&DATASRV.EVAL' || '\TNT\TTRACKER\DATA\';
 
-SET &FILE1A = '&DATAPATH.EVAL' || '&COMPPF.EVAL AS PROFFEE';

-RUN



 USE ADD
 &FILE1A
 END
 DEFINE FILE PROFFEE
  FLAG/A1 = 'M';
  CITY1/A25 = IF FEE_AMT EQ 25.00 THEN 'VOD' ELSE 'SVC FEE';
  CNT/D12 = 0;
 END
 TABLE FILE PROFFEE
 PRINT TRN_TYPE TRN_DATE FEE_SRC FEE_AMT PAY_METHOD CREDIT_CARD FST_DPT_DATE CNT CITY1 RPT_DATE TASF_TKT_NUM EMP_ID
 BY FLAG
 BY AIR_KEY
 WHERE AIR_KEY NE ''
 WHERE CREDIT_CARD CONTAINS '3122361602'
 -INCLUDE &PROFDATES
 -*ON TABLE COLUMN-TOTAL
 ON TABLE HOLD AS PFHOLDA FORMAT FOCUS INDEX AIR_KEY
 END
 -RUN
 
 
 -SET &&AIRPROF = IF &LINES GT 0 THEN 'Y' ELSE 'N';
 
 TABLE FILE PROFFEE
 PRINT TRN_TYPE TRN_DATE FEE_SRC FEE_AMT PAY_METHOD CREDIT_CARD FST_DPT_DATE CNT CITY1 TASF_TKT_NUM EMP_ID
 BY FLAG
 BY CAR_KEY
 WHERE CAR_KEY NE ''
 WHERE CREDIT_CARD CONTAINS '3122361602'
 -INCLUDE &PROFDATES
 ON TABLE HOLD AS PFHOLDC FORMAT FOCUS INDEX CAR_KEY
 END
 -RUN
 -SET &CARPROF = IF &LINES GT 0 THEN 'Y' ELSE 'N';
 
 
 TABLE FILE PROFFEE
 PRINT TRN_TYPE TRN_DATE FEE_SRC FEE_AMT PAY_METHOD CREDIT_CARD FST_DPT_DATE CNT CITY1 TASF_TKT_NUM EMP_ID
 BY FLAG
 BY HTL_KEY
 WHERE HTL_KEY NE ''
 WHERE CREDIT_CARD CONTAINS '3122361602'
 -INCLUDE &PROFDATES
 ON TABLE HOLD AS PFHOLDH FORMAT FOCUS INDEX HTL_KEY
 END
 -RUN
 -SET &HTLPROF = IF &LINES GT 0 THEN 'Y' ELSE 'N';
 
 TABLE FILE PROFFEE
 PRINT TRN_TYPE TRN_DATE FEE_SRC FEE_AMT PAY_METHOD CREDIT_CARD FST_DPT_DATE CNT CITY1 TASF_TKT_NUM EMP_ID
 BY MISC_KEY
 WHERE MISC_KEY NE ''
 WHERE CREDIT_CARD CONTAINS '3122361602'
 -INCLUDE &PROFDATES
 ON TABLE HOLD AS PFHOLDM FORMAT FOCUS INDEX MISC_KEY
 END
 -RUN
 
 -SET &MISCPROF = IF &LINES GT 0 THEN 'Y' ELSE 'N';


 
