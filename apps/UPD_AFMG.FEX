-INCLUDE SETECHO

SET ASNAMES = ON 


 
TABLE FILE S1AFMG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV10  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
IF AROLL_LEV13 EQ 5SC0049 OR SC0050 OR 5SC0051 OR 5SC0052

ON TABLE HOLD AS SHOLD
END
-RUN

MODIFY FILE S1AFMG
FIXFORM FROM SHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON NOMATCH REJECT
ON MATCH COMPUTE AROLL_LEV3='0EA0001';
ON MATCH COMPUTE AROLL_LEV4='0EA0001';
ON MATCH COMPUTE AROLL_LEV5='0EA0001';
ON MATCH COMPUTE AROLL_LEV6='0EA0016';
ON MATCH COMPUTE AROLL_LEV7='4SC0001';
ON MATCH COMPUTE AROLL_LEV8='4SC0116';
ON MATCH COMPUTE AROLL_LEV9='4SC0116';
ON MATCH COMPUTE AROLL_LEV10='1SC0101';
ON MATCH COMPUTE AROLL_LEV11='1SC0103';
ON MATCH COMPUTE AROLL_LEV12='5SC0048';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON MATCH UPDATE AROLL_LEV9
ON MATCH UPDATE AROLL_LEV10
ON MATCH UPDATE AROLL_LEV11
ON MATCH UPDATE AROLL_LEV12
ON NOMATCH REJECT
DATA ON SHOLD
END
-RUN

TABLE FILE M1AFMG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV10 
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
IF AROLL_LEV13 EQ 5SC0049 OR SC0050 OR 5SC0051 OR 5SC0052
ON TABLE HOLD AS MHOLD
END
-RUN

MODIFY FILE M1AFMG
FIXFORM FROM MHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='0EA0001';
ON MATCH COMPUTE AROLL_LEV4='0EA0001';
ON MATCH COMPUTE AROLL_LEV5='0EA0001';
ON MATCH COMPUTE AROLL_LEV6='0EA0016';
ON MATCH COMPUTE AROLL_LEV7='4SC0001';
ON MATCH COMPUTE AROLL_LEV8='4SC0116';
ON MATCH COMPUTE AROLL_LEV9='4SC0116';
ON MATCH COMPUTE AROLL_LEV10='1SC0101';
ON MATCH COMPUTE AROLL_LEV11='1SC0103';
ON MATCH COMPUTE AROLL_LEV12='5SC0048';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON MATCH UPDATE AROLL_LEV9
ON MATCH UPDATE AROLL_LEV10
ON MATCH UPDATE AROLL_LEV11
ON MATCH UPDATE AROLL_LEV12
ON NOMATCH REJECT
DATA ON MHOLD
END
-RUN


TABLE FILE D1AFMG
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR AROLL_LEV10  
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
IF AROLL_LEV13 EQ 5SC0049 OR SC0050 OR 5SC0051 OR 5SC0052
ON TABLE HOLD AS DHOLD
END
-RUN

MODIFY FILE D1AFMG
FIXFORM FROM DHOLD
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH COMPUTE AROLL_LEV3='0EA0001';
ON MATCH COMPUTE AROLL_LEV4='0EA0001';
ON MATCH COMPUTE AROLL_LEV5='0EA0001';
ON MATCH COMPUTE AROLL_LEV6='0EA0016';
ON MATCH COMPUTE AROLL_LEV7='4SC0001';
ON MATCH COMPUTE AROLL_LEV8='4SC0116';
ON MATCH COMPUTE AROLL_LEV9='4SC0116';
ON MATCH COMPUTE AROLL_LEV10='1SC0101';
ON MATCH COMPUTE AROLL_LEV11='1SC0103';
ON MATCH COMPUTE AROLL_LEV12='5SC0048';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON MATCH UPDATE AROLL_LEV9
ON MATCH UPDATE AROLL_LEV10
ON MATCH UPDATE AROLL_LEV11
ON MATCH UPDATE AROLL_LEV12
ON NOMATCH REJECT
DATA ON DHOLD
END
-RUN


TABLE FILE C1AFMG
PRINT CAR_KEY  AROLL_LEV10 
BY CAR_KEY NOPRINT
IF AROLL_LEV13 EQ 5SC0049 OR SC0050 OR 5SC0051 OR 5SC0052
ON TABLE HOLD AS CHOLD
END
-RUN

MODIFY FILE C1AFMG
FIXFORM FROM CHOLD
MATCH CAR_KEY  
ON MATCH COMPUTE AROLL_LEV3='0EA0001';
ON MATCH COMPUTE AROLL_LEV4='0EA0001';
ON MATCH COMPUTE AROLL_LEV5='0EA0001';
ON MATCH COMPUTE AROLL_LEV6='0EA0016';
ON MATCH COMPUTE AROLL_LEV7='4SC0001';
ON MATCH COMPUTE AROLL_LEV8='4SC0116';
ON MATCH COMPUTE AROLL_LEV9='4SC0116';
ON MATCH COMPUTE AROLL_LEV10='1SC0101';
ON MATCH COMPUTE AROLL_LEV11='1SC0103';
ON MATCH COMPUTE AROLL_LEV12='5SC0048';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON MATCH UPDATE AROLL_LEV9
ON MATCH UPDATE AROLL_LEV10
ON MATCH UPDATE AROLL_LEV11
ON MATCH UPDATE AROLL_LEV12
ON NOMATCH REJECT
DATA ON CHOLD
END
-RUN

TABLE FILE L1AFMG
PRINT CAR_KEY  AROLL_LEV10  
BY CAR_KEY NOPRINT
IF AROLL_LEV13 EQ 5SC0049 OR SC0050 OR 5SC0051 OR 5SC0052
ON TABLE HOLD AS LHOLD
END
-RUN

MODIFY FILE L1AFMG
FIXFORM FROM LHOLD
MATCH CAR_KEY  
ON MATCH COMPUTE AROLL_LEV3='0EA0001';
ON MATCH COMPUTE AROLL_LEV4='0EA0001';
ON MATCH COMPUTE AROLL_LEV5='0EA0001';
ON MATCH COMPUTE AROLL_LEV6='0EA0016';
ON MATCH COMPUTE AROLL_LEV7='4SC0001';
ON MATCH COMPUTE AROLL_LEV8='4SC0116';
ON MATCH COMPUTE AROLL_LEV9='4SC0116';
ON MATCH COMPUTE AROLL_LEV10='1SC0101';
ON MATCH COMPUTE AROLL_LEV11='1SC0103';
ON MATCH COMPUTE AROLL_LEV12='5SC0048';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON MATCH UPDATE AROLL_LEV9
ON MATCH UPDATE AROLL_LEV10
ON MATCH UPDATE AROLL_LEV11
ON MATCH UPDATE AROLL_LEV12
ON NOMATCH REJECT
DATA ON LHOLD
END
-RUN



TABLE FILE H1AFMG
PRINT HTL_KEY  AROLL_LEV10  
BY HTL_KEY NOPRINT
IF AROLL_LEV13 EQ 5SC0049 OR SC0050 OR 5SC0051 OR 5SC0052
ON TABLE HOLD AS HHOLD
END
-RUN

MODIFY FILE H1AFMG
FIXFORM FROM HHOLD
MATCH HTL_KEY  
ON MATCH COMPUTE AROLL_LEV3='0EA0001';
ON MATCH COMPUTE AROLL_LEV4='0EA0001';
ON MATCH COMPUTE AROLL_LEV5='0EA0001';
ON MATCH COMPUTE AROLL_LEV6='0EA0016';
ON MATCH COMPUTE AROLL_LEV7='4SC0001';
ON MATCH COMPUTE AROLL_LEV8='4SC0116';
ON MATCH COMPUTE AROLL_LEV9='4SC0116';
ON MATCH COMPUTE AROLL_LEV10='1SC0101';
ON MATCH COMPUTE AROLL_LEV11='1SC0103';
ON MATCH COMPUTE AROLL_LEV12='5SC0048';
ON MATCH UPDATE AROLL_LEV3
ON MATCH UPDATE AROLL_LEV4
ON MATCH UPDATE AROLL_LEV5
ON MATCH UPDATE AROLL_LEV6
ON MATCH UPDATE AROLL_LEV7
ON MATCH UPDATE AROLL_LEV8
ON MATCH UPDATE AROLL_LEV9
ON MATCH UPDATE AROLL_LEV10
ON MATCH UPDATE AROLL_LEV11
ON MATCH UPDATE AROLL_LEV12
ON NOMATCH REJECT
DATA ON HHOLD
END
-RUN


 