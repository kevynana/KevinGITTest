-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-INCLUDE SETECHO
-* File SMRYRPT.FEX
-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*8/29/02        DEB                CREATED FOR BLV REPORTS

-**********************************************************************

SET ASNAMES = ON
-RUN

TABLE FILE &&RPT_HOLD
SUM NET_TKT_CNT AS 'NTTKT'
    DISSAVINGS AS 'TLOSS'
    REF_EXCH_CNT AS 'TRFEX'
    TKT_PURCH AS 'TPURCH'	
BY LEVEL_DESC
BY REFUSE_CODE
BY REFUSAL_DESC
ON TABLE HOLD AS HOLDONE
END
-RUN

TABLE FILE &&RPT_HOLD
PRINT AIR_KEY	
  AIRLINE	
  AIRLINE_FEE	
  AIRLINE_NAME	
  AR_BRANCH
  ARR_DAY
  ARR_TIME
  AUX_NON_MIR	
  BR_CL_IDX	
  CLASS	
  CLASS_CAT	
  CLIENT_NAME
  CLIENT_NUM	
  CREDIT_CARD
  DEPT_MONTH	
  DIR_CP_CD	
  DIR_CP_NM	
  DISSAVINGS
  DPT_DAY
  DPT_TIME	
  FARE_BAS	
  FARE_PAID	
  GROUP_CODE
  GROSS_DSAVE	
  GROSS_FARE	
  INT_CODE
  INTL_DOM
  ISU_TKT	
  LEVEL1	
  LEVEL2	
  LEVEL3	
  MRK_TKT_CNT	
  ND_CITY_NM	
  NET_TKT_CNT	
  NET_TKT_CNT1	
  NEW_ADV_PURCH	
  NEW_SEG_COUNT	
  NEW_SEG_DISC	
  NEW_SEG_MILES	
  NOREF_SEG_COUNT
  PRIN_TKT	
  REF_E_CNT	
  REF_EXCH_CNT	
  REFEXCH	
  SAVINGS	
  SEG_AMT	
  SEG_LOWEST	
  SEG_STANDARD	
  STAY
  TKT_NUM	
  TKT_PURCH	
  VAL_AIRLINE
  XARR_DOW
  XPSNGR_NM	
  XTRAN_DT
  XDPT_DOW	
  XDPT_DT
 LEVEL_DESC
 REFUSE_CODE
 REFUSAL_DESC
BY LEVEL_DESC
BY REFUSE_CODE
BY REFUSAL_DESC
ON TABLE HOLD AS XTWO
END
-RUN

MATCH FILE XTWO
PRINT AIR_KEY	
  AIRLINE	
  AIRLINE_FEE	
  AIRLINE_NAME	
  AR_BRANCH
  ARR_DAY
  ARR_TIME
  AUX_NON_MIR	
  BR_CL_IDX	
  CLASS	
  CLASS_CAT	
  CLIENT_NAME	
  CLIENT_NUM	
  CREDIT_CARD
  DEPT_MONTH	
  DIR_CP_CD	
  DIR_CP_NM	
  DISSAVINGS
  DPT_DAY
  DPT_TIME	
  FARE_BAS	
  FARE_PAID	
  GROSS_DSAVE	
  GROSS_FARE	
  GROUP_CODE	
  INT_CODE
  INTL_DOM
  ISU_TKT	
  LEVEL1	
  LEVEL2	
  LEVEL3	
  MRK_TKT_CNT	
  ND_CITY_NM	
  NET_TKT_CNT	
  NET_TKT_CNT1	
  NEW_ADV_PURCH	
  NEW_SEG_COUNT	
  NEW_SEG_DISC	
  NEW_SEG_MILES	
  NOREF_SEG_COUNT
  PRIN_TKT	
  REF_E_CNT	
  REF_EXCH_CNT	
  REFEXCH	
  SAVINGS	
  SEG_AMT	
  SEG_LOWEST	
  SEG_STANDARD	
  STAY
  TKT_NUM	
  TKT_PURCH	
  VAL_AIRLINE
  XARR_DOW
  XPSNGR_NM	
  XTRAN_DT
  XDPT_DOW	
  XDPT_DT
 LEVEL_DESC
 REFUSE_CODE
 REFUSAL_DESC
BY LEVEL_DESC
ON TABLE HOLD
RUN
FILE HOLDONE
SUM NTTKT
    TLOSS
    TRFEX
    TPURCH
BY LEVEL_DESC
AFTER MATCH HOLD AS XTHREE OLD-OR-NEW 
END
-RUN

DEFINE FILE XTHREE ADD
PCTDSAVE/D8.1S= IF ((TLOSS LT 1) AND (TLOSS GT (-1))) THEN 0
                ELSE ((DISSAVINGS/TLOSS)*100);	
PCTRFEX/D8.1S=  IF ((TRFEX LT 1) AND (TRFEX GT (-1))) THEN 0
                ELSE ((REF_EXCH_CNT/TRFEX)*100);	
PCTTKT/D8.1S=   IF ((TPURCH LT 1) AND (TPURCH GT (-1))) THEN 0
                ELSE ((TKT_PURCH/TPURCH)*100);	
-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-**********************************************************************
  NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
END
TABLE FILE XTHREE
-INCLUDE HEADER
"&&SUBHEAD"
"</2"
    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10
    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10
ON TABLE COLUMN-TOTAL
-INCLUDE FOOTERSM
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *

-INCLUDE &&SMSTY

-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-* -IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILL;
-INCLUDE &&DSTY

-* -SKIP_DRILL

ENDSTYLE
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN

-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3;

EX REPORT_3

-SKIP_R3
