-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-INCLUDE SETECHO
-* File HVIEW3SM.FEX
-**********************************************************************
-*DATE           NAME               DESCRIPTION
-*7/31/00      IBISTL-KR            ADDED DEFINE FOR NOWTOD WHICH IS 
-*                                  USED IN FOOTERSM
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-*07/03/02   STEVE              CHANGED TO eTTek Review and Copyright
-*5/27/03    DEB                HARDCODED TO RANK BY HIGHEST NMBR_DAYS
-*4/1/04     DEB                CHANGED TO SUM DEFINE BOOKINGS FIELD
-*5/06/05    DEB                ADDED CODE FOR GLOBAL CURRENCY
-* 9/25/14 Updated to use exclude flags in % - JK
-*6/8/15 - joy - STORY ID - S-09493 - Updated footer to include more verbiage related to % omitting data based upon preferred/non-preferred setup
-* 08/14/2017 RSB S-38044 Place the footer datetime stamp text in a separate file to be -INCLUDED in the stylesheets
-*                         Added: -SET &FTR_AddlLines = 6;
-**********************************************************************

SET ASNAMES=ON


-IF &&CURRENCY EQ 'USD' THEN GOTO SKIPTHIS;


-SET &&SUBHEAD = <NAMEC;
-SET &TAMT_CUR = ' TOTAL,ROOM, AMOUNT, (' | &&CURRENCY || ')';
-SET &GADR_CUR = ' AVG,DAILY,RATE, (' | &&CURRENCY || ')';
-SET &GSAV_CUR = ' SAVINGS, (' | &&CURRENCY || ')';
-SET &GLSV_CUR = ' LOST,SVGS, (' | &&CURRENCY || ')';
-SET &&S_SUBJ2='GROOM_AMT/D16.2C AS ' | '''&TAMT_CUR.EVAL''';
-SET &&S_SUBJ3='COMPUTE GAVGAMT/D16.2CS=IF (GROOM_AMT LT 0) AND (NNROOMS LT 0)';
-SET &&S_SUBJ4='THEN ((GROOM_AMT/NNROOMS)*(-1)) ELSE IF ((NNROOMS LT 1) AND';
-SET &&S_SUBJ5='(NNROOMS GT (-1))) THEN 0 ELSE (GROOM_AMT/NNROOMS); ' ;
-SET &&S_SUBJ6='AS ' | '''&GADR_CUR.EVAL''' ;
-SET &&S_SUBJ9='SLSAV_TTL1/D16.2C AS ' | '''&GSAV_CUR.EVAL''' ;
-SET &&S_SUBJ10='GLSV/D16.2C AS ' | '''&GLSV_CUR.EVAL''' ;

-SKIPTHIS;


-SET &&RANK_LIMIT2 = 9999; 
 

TABLE FILE HTLHLD2
-* SUM CNT.NUM_DAYS AS 'BOOKINGS'	
SUM BOOKINGS
    NAMEC
    NEW_ROOM_RATE
    NEW_STD_RATE
    NEW_TOTAL_AMT
    NNROOMS	
    NNROOMSPN
    NNROOMS3
    NPREF_AMT
    AMT_NPREF1/D16.2
    NPREF_NGT
    PREF_AMT
    AMT_PREF1/D16.2
    PREF_NGT
    SAVINGS	
    TOTAL_AMT/D12.2 AS 'ROOM_AMT'
    AMT_TOTL1/D16.2 AS 'GROOM_AMT'
    TOTAL_STD
    TOTAL_SLSAV	
    SLSAV_TTL1/D16.2
    TTL_NGT AS 'NMBR_DAYS'
    TTL_NGT
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY PREF_NON
BY CHAIN_CODE
BY CHAIN_NAME
BY PROP_NAME
BY PROP_ADDRESS
BY HOTEL_PHONE
-*ON TABLE COLUMN-TOTAL
ON TABLE HOLD AS HOLD1 
END
-RUN
 
TABLE FILE HOLD1
PRINT 
    BOOKINGS
    NAMEC
    NEW_ROOM_RATE
    NEW_STD_RATE
    NEW_TOTAL_AMT
    NNROOMS
    NNROOMSPN
    NNROOMS3
    NPREF_AMT
    AMT_NPREF1
    NPREF_NGT
    PREF_AMT
    AMT_PREF1
    PREF_NGT
    SAVINGS	
    ROOM_AMT 
    GROOM_AMT 
    TOTAL_STD
    TOTAL_SLSAV	
    SLSAV_TTL1 
    NMBR_DAYS
    TTL_NGT
    PREF_NON
    CHAIN_NAME
    CHAIN_CODE
    PROP_NAME
    PROP_ADDRESS
    HOTEL_PHONE
    PROP_CITY
    PROP_STATE_CD
BY CITY_ST
-*BY PROP_CITY
-*BY PROP_STATE_CD
-* RANKED BY HIGHEST NMBR_DAYS NOPRINT
RANKED BY HIGHEST &&RANK_METH NOPRINT
WHERE PREF_NON EQ 'PREFERRED'
ON TABLE HOLD AS HOLD2
END
-RUN

DEFINE FILE HOLD2
 RANK_LIMIT/I5 = &&RANK_LIMIT2;
 DRANK/D5      = RANK;
 ARANKX/A6 = FTOA(DRANK, '(D5)', 'A6');
 ARANK/A5=EDIT(ARANKX,'$99999');
 RANK_VALUE/A5 = IF RANK_LIMIT EQ 0 THEN ARANK ELSE
                 IF RANK GT RANK_LIMIT THEN 'OTHER' ELSE ARANK;
END
-RUN


TABLE FILE HOLD2
PRINT 
     BOOKINGS
     NAMEC
     NEW_ROOM_RATE
     NEW_STD_RATE
     NEW_TOTAL_AMT
     NNROOMS	
     NNROOMSPN
     NNROOMS3
     NPREF_AMT
     AMT_NPREF1
     NPREF_NGT
     PREF_AMT
     AMT_PREF1
     PREF_NGT
     SAVINGS	
     ROOM_AMT 
     GROOM_AMT 
     TOTAL_STD
     TOTAL_SLSAV	
     SLSAV_TTL1 
     NMBR_DAYS
     TTL_NGT
     PREF_NON
     CHAIN_NAME
     CHAIN_CODE
     PROP_NAME
     PROP_ADDRESS
     HOTEL_PHONE
     PROP_CITY
     PROP_STATE_CD
BY CITY_ST
BY RANK_VALUE
ON TABLE HOLD AS HOLD2A  
END
-RUN

 
DEFINE FILE HOLD2A  
  CHAIN_NM/A35= IF RANK_VALUE NE 'OTHER' THEN CHAIN_NAME ELSE ' ';	
  CHAIN_CD/A2 = IF RANK_VALUE NE 'OTHER' THEN CHAIN_CODE ELSE ' ';
  HTL_ADDRESS/A35= IF RANK_VALUE NE 'OTHER' THEN PROP_ADDRESS ELSE ' ';	
  HTL_NAME/A35 = IF RANK_VALUE NE 'OTHER' THEN PROP_NAME ELSE 'ALL OTHER';
  PROP_PHONE/A15= IF RANK_VALUE NE 'OTHER' THEN HOTEL_PHONE ELSE ' ';
END
-RUN


TABLE FILE HOLD2A
SUM 
     BOOKINGS
     NAMEC
     NEW_ROOM_RATE
     NEW_STD_RATE
     NEW_TOTAL_AMT
     NNROOMS	
     NNROOMSPN
     NNROOMS3
     NPREF_AMT
     AMT_NPREF1
     NPREF_NGT
     PREF_AMT
     AMT_PREF1
     PREF_NGT
     SAVINGS	
     ROOM_AMT 
     GROOM_AMT 
     TOTAL_STD
     TOTAL_SLSAV	
     SLSAV_TTL1 
     NMBR_DAYS
     TTL_NGT
     PREF_NON
     CHAIN_NM
     PROP_CITY
     PROP_STATE_CD
BY CITY_ST
BY RANK_VALUE
BY HTL_NAME
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
ON TABLE HOLD AS HOLD3 FORMAT FOCUS
END
-RUN

TABLE FILE HOLD1
PRINT 
    BOOKINGS
    NAMEC
    NEW_ROOM_RATE
    NEW_STD_RATE
    NEW_TOTAL_AMT
    NNROOMS	
    NNROOMSPN
    NNROOMS3
    NPREF_AMT
    AMT_NPREF1
    NPREF_NGT
    PREF_AMT
    AMT_PREF1
    PREF_NGT
    SAVINGS	
    ROOM_AMT 
    GROOM_AMT 
    TOTAL_STD
    TOTAL_SLSAV	
    SLSAV_TTL1 
    NMBR_DAYS 
    TTL_NGT
    PREF_NON
    CHAIN_NAME
    CHAIN_CODE
    PROP_NAME
    PROP_ADDRESS
    HOTEL_PHONE
    PROP_CITY
    PROP_STATE_CD
BY CITY_ST
RANKED BY HIGHEST &&RANK_METH NOPRINT
WHERE PREF_NON EQ 'NON-PREFERRED'
ON TABLE HOLD AS HOLD4
END
-RUN


DEFINE FILE HOLD4
 RANK_LIMIT/I5 = &&RANK_LIMIT2;
 DRANK/D5      = RANK;
 ARANKX/A6 = FTOA(DRANK, '(D5)', 'A6');
 ARANK/A5=EDIT(ARANKX,'$99999');
 RANK_VALUE/A5 = IF RANK_LIMIT EQ 0 THEN ARANK ELSE
                 IF RANK GT RANK_LIMIT THEN 'OTHER' ELSE ARANK;
END
-RUN

TABLE FILE HOLD4
PRINT 
     BOOKINGS
     NAMEC
     NEW_ROOM_RATE
     NEW_STD_RATE
     NEW_TOTAL_AMT
     NNROOMS	
     NNROOMSPN
     NNROOMS3
     NPREF_AMT
     AMT_NPREF1
     NPREF_NGT
     PREF_AMT
     AMT_PREF1
     PREF_NGT
     SAVINGS	
     ROOM_AMT 
     GROOM_AMT 
     TOTAL_STD
     TOTAL_SLSAV	
     SLSAV_TTL1 
     NMBR_DAYS
     TTL_NGT
     PREF_NON
     CHAIN_NAME
     CHAIN_CODE
     PROP_NAME
     PROP_ADDRESS
     HOTEL_PHONE
     PROP_CITY
     PROP_STATE_CD
BY CITY_ST
BY RANK_VALUE
ON TABLE HOLD AS HOLD4A  
END
-RUN
 
DEFINE FILE HOLD4A  
  CHAIN_NM/A35= IF RANK_VALUE NE 'OTHER' THEN CHAIN_NAME ELSE ' ';
  CHAIN_CD/A2 = IF RANK_VALUE NE 'OTHER' THEN CHAIN_CODE ELSE ' ';
  HTL_ADDRESS/A35= IF RANK_VALUE NE 'OTHER' THEN PROP_ADDRESS ELSE ' ';	
 HTL_NAME/A35 = IF RANK_VALUE NE 'OTHER' THEN PROP_NAME ELSE 'ALL OTHER';
  PROP_PHONE/A15= IF RANK_VALUE NE 'OTHER' THEN HOTEL_PHONE ELSE ' ';
END
-RUN


TABLE FILE HOLD4A
SUM 
     BOOKINGS
     NAMEC
     NEW_ROOM_RATE
     NEW_STD_RATE
     NEW_TOTAL_AMT
     NNROOMS
     NNROOMSPN
     NNROOMS3
     NPREF_AMT
     AMT_NPREF1
     NPREF_NGT
     PREF_AMT
     AMT_PREF1
     PREF_NGT
     SAVINGS	
     ROOM_AMT 
     GROOM_AMT 
     TOTAL_STD
     TOTAL_SLSAV	
     SLSAV_TTL1 
     NMBR_DAYS
     TTL_NGT
     PREF_NON
     CHAIN_NM
     PROP_CITY
     PROP_STATE_CD
BY CITY_ST
BY RANK_VALUE
BY HTL_NAME
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
ON TABLE HOLD AS HOLD5 FORMAT FOCUS
END
-RUN
 

USE CLEAR *
-RUN


-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HNKA=&HLDPATH || 'HOLD3.FOC';
-SET &HNKB=&HLDPATH || 'HOLD5.FOC';

-RUN

-SET &FILENAME = 'HOLD3'; 
-RUN

-DOS STATE &HNKA
-SET &HOLDFILEA = IF &RETCODE.EVAL EQ 0 THEN &HNKA | ' AS ' | &FILENAME ELSE ' ';

-DOS STATE &HNKB
-SET &HOLDFILEB = IF &RETCODE.EVAL EQ 0 THEN &HNKB | ' AS ' | &FILENAME ELSE ' ';


USE ADD 
&HOLDFILEA
&HOLDFILEB 
END
-RUN



TABLE FILE HOLD3
SUM 
    BOOKINGS
     NAMEC
     NEW_ROOM_RATE
     NEW_STD_RATE
     NEW_TOTAL_AMT
     NNROOMS	
     NNROOMSPN
     NNROOMS3
     NPREF_AMT
     AMT_NPREF1
     NPREF_NGT
     PREF_AMT
     AMT_PREF1
     PREF_NGT
     SAVINGS	
     ROOM_AMT 
     GROOM_AMT 
     TOTAL_STD
     TOTAL_SLSAV	
     SLSAV_TTL1 
     NMBR_DAYS 
     TTL_NGT
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY PREF_NON
BY RANK_VALUE
BY HTL_NAME
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
ON TABLE HOLD AS HOLD6
END
-RUN

 
TABLE FILE HOLD1
SUM 
  BOOKINGS
    NAMEC
    NEW_ROOM_RATE
    NEW_STD_RATE
    NEW_TOTAL_AMT
    NNROOMS	
    NNROOMSPN
    NNROOMS3
    NPREF_AMT
    AMT_NPREF1/D16.2
    NPREF_NGT
    PREF_AMT
    AMT_PREF1/D16.2
    PREF_NGT
    SAVINGS	
    ROOM_AMT
    TOTAL_AMT/D12.2  
    AMT_TOTL1/D16.2  
    TOTAL_STD
    TOTAL_SLSAV	
    SLSAV_TTL1/D16.2
    TTL_NGT AS 'NMBR_DAYS'
    TTL_NGT
BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
ON TABLE HOLD AS RHOLD1
END
-RUN


TABLE FILE RHOLD1
PRINT *
-* RANKED BY HIGHEST NMBR_DAYS AS 'DAYS_RANK'
RANKED BY HIGHEST &&RANK_METH AS 'DAYS_RANK'
ON TABLE HOLD AS RHOLD2
END
-RUN


MATCH FILE HOLD6
PRINT *
BY CITY_ST
ON TABLE HOLD
RUN
FILE RHOLD2
SUM DAYS_RANK
BY CITY_ST
AFTER MATCH HOLD AS XONE OLD-OR-NEW
END
-RUN

TABLE FILE XONE
PRINT *
RANKED BY HIGHEST DAYS_RANK
ON TABLE HOLD AS HOLD7
END
-RUN

-SET &&RANK_LIMIT = 9999;

DEFINE FILE HOLD7
  CTY_LIMIT/I9 = &&RANK_LIMIT;
  CLIMIT/A11    = EDIT(CTY_LIMIT) ;
  CRANK/D9     = RANK;    
  BRANK/A11     = FTOA(CRANK, '(D9)', 'A11');
  LIST/D9 = IF CITY_ST NE LAST CITY_ST THEN (LAST LIST + 1) ELSE LAST LIST;
  FRANKX/A11 = FTOA(LIST, '(D9)', 'A11');
  FRANK/A6= EDIT(FRANKX,'$999999');
  CTY_VALUE/A11 = IF CTY_LIMIT EQ 0 THEN BRANK ELSE
                 IF RANK GT CTY_LIMIT THEN 'OTHER' ELSE BRANK;
  FLAG/A9 = IF CTY_VALUE EQ 'ALL OTHER' THEN 'ALL OTHER' ELSE 'A';                
 
END
-RUN

TABLE FILE HOLD7
PRINT
  BOOKINGS	
  CLIMIT
  CITY_ST	
  CTY_LIMIT	
  DAYS_RANK 	
     NAMEC
     NEW_ROOM_RATE
     NEW_STD_RATE
     NEW_TOTAL_AMT
     NNROOMS	
     NNROOMSPN
     NNROOMS3
     NPREF_AMT
     AMT_NPREF1
     NPREF_NGT
     PREF_AMT
     AMT_PREF1
     PREF_NGT
     SAVINGS	
     ROOM_AMT 
     GROOM_AMT 
     TOTAL_STD
     TOTAL_SLSAV	
     SLSAV_TTL1 
     NMBR_DAYS 
     TTL_NGT
  FLAG
  
BY CTY_VALUE
-* BY CITY_ST
BY PROP_CITY
BY PROP_STATE_CD
BY PREF_NON
BY RANK_VALUE
BY HTL_NAME
BY HTL_ADDRESS
BY PROP_PHONE
BY CHAIN_CD
BY CHAIN_NM
ON TABLE HOLD AS HOLD8
END
-RUN


TABLE FILE HTLHLD2
SUM TTL_NGT/D8 AS 'CTLDAYS'
   TOTAL_AMT AS 'CTLAMT'
   NNROOMS AS 'TNROOMS'
   NNROOMS3 AS 'TNROOMS1'
BY CITY_ST
ON TABLE HOLD AS HOLD9
END
-RUN

MATCH FILE HOLD8
PRINT 
  BOOKINGS	
  CLIMIT	
  CTY_LIMIT
  CTY_VALUE
  DAYS_RANK 
  FLAG
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  SAVINGS	
  ROOM_AMT 
  GROOM_AMT 
  TOTAL_STD
  TOTAL_SLSAV	
  SLSAV_TTL1 
  NMBR_DAYS 
  TTL_NGT
  PROP_CITY
  PROP_STATE_CD
  PREF_NON
  RANK_VALUE
  HTL_NAME
  HTL_ADDRESS
  PROP_PHONE
  CHAIN_CD
  CHAIN_NM
BY CITY_ST
ON TABLE HOLD
RUN
FILE HOLD9
SUM CTLDAYS
    CTLAMT
    TNROOMS
    TNROOMS1
BY CITY_ST
AFTER MATCH HOLD AS HOLD10 OLD-OR-NEW
END
-RUN

DEFINE FILE HOLD10 
 HTL_NAM/A35 = IF CTY_VALUE LT '&&RANK_LIMIT' THEN HTL_NAME ELSE 'ALL OTHER';
  CHN_CD/A2 = IF CTY_VALUE LT '&&RANK_LIMIT' THEN CHAIN_CD ELSE ' ';
  CHN_NM/A35= IF CTY_VALUE LT '&&RANK_LIMIT' THEN CHAIN_NM ELSE ' ' ;	
  HTL_ADDS/A35= IF CTY_VALUE LT '&&RANK_LIMIT' THEN HTL_ADDRESS ELSE ' ';
  PRP_PHONE/A15= IF CTY_VALUE LT '&&RANK_LIMIT'  THEN PROP_PHONE ELSE ' ';
  PROP_ST_CD/A3 = IF CTY_VALUE LT '&&RANK_LIMIT' THEN PROP_STATE_CD  ELSE ' ' ; 

CTY_PRINT/A35 = IF CTY_VALUE LT '&&RANK_LIMIT' THEN CITY_ST ELSE ' ';
  PROP_ST_CD/A3 = IF CTY_VALUE LT '&&RANK_LIMIT' THEN PROP_STATE_CD  ELSE ' ' ;
  PROP_CTY/A25 = IF CTY_VALUE LT '&&RANK_LIMIT' THEN PROP_CITY ELSE ' ';
 RANK_VAL/A5 = IF CTY_VALUE LT '&&RANK_LIMIT' THEN RANK_VALUE ELSE 'OTHER'; 
END
TABLE FILE HOLD10
SUM
  BOOKINGS	
  CLIMIT	
  CTY_LIMIT
  DAYS_RANK 
  FLAG
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  SAVINGS	
  ROOM_AMT 
  GROOM_AMT 
  TOTAL_STD
  TOTAL_SLSAV	
  SLSAV_TTL1 
  NMBR_DAYS 
  TTL_NGT
  CITY_ST
  CTLDAYS
  CTLAMT
  TNROOMS
  TNROOMS1
-*COMPUTE PCTTAMT/D8.1S = IF ((CTLAMT LT 1) AND (CTLAMT GT (-1))) THEN 0
-*                        ELSE ((NEW_TOTAL_AMT/CTLAMT)*100);
BY CTY_VALUE
BY CTY_PRINT
BY PROP_CTY
BY PROP_ST_CD
BY PREF_NON

BY RANK_VAL 
BY HTL_NAM
BY HTL_ADDS
BY PRP_PHONE
BY CHN_CD
BY CHN_NM
ON TABLE HOLD AS HOLD10F
END
-RUN




TABLE FILE HOLD10F
PRINT
  BOOKINGS	
  CLIMIT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  ROOM_AMT	
  GROOM_AMT
  SAVINGS
  TNROOMS	
  TNROOMS1
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
COMPUTE NAVG/P12.2 = IF ((NPREF_NGT LT 0) AND (NPREF_AMT LT 0)) THEN
((NPREF_AMT/NPREF_NGT)*(-1)) ELSE IF ((NPREF_NGT LT 1) AND
(NPREF_NGT GT (-1))) THEN 0 ELSE NPREF_AMT/NPREF_NGT; 
COMPUTE GNAVG/P16.2 = IF ((NPREF_NGT LT 0) AND (AMT_NPREF1 LT 0)) THEN
((AMT_NPREF1/NPREF_NGT)*(-1)) ELSE IF ((NPREF_NGT LT 1) AND
(NPREF_NGT GT (-1))) THEN 0 ELSE AMT_NPREF1/NPREF_NGT; 
COMPUTE PAVG/P12.2 = IF ((PREF_NGT LT 1) AND
(PREF_NGT GT (-1))) THEN 0 ELSE PREF_AMT/PREF_NGT; 
COMPUTE GPAVG/P12.2 = IF ((PREF_NGT LT 1) AND
(PREF_NGT GT (-1))) THEN 0 ELSE AMT_PREF1/PREF_NGT; 
BY CTY_VALUE
BY CTY_PRINT
BY PROP_CTY
BY PROP_ST_CD
BY PREF_NON
BY RANK_VAL 
BY HTL_NAM
-* BY PROP_ST_CD
BY HTL_ADDS
BY PRP_PHONE
BY CHN_CD
WHERE CTY_VALUE NE 'OTHER'
ON TABLE HOLD AS HOLD11 FORMAT FOCUS
END
-RUN


TABLE FILE HOLD10F
SUM BOOKINGS
  CLIMIT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  ROOM_AMT	
  GROOM_AMT
  SAVINGS
  TNROOMS
  TNROOMS1
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
COMPUTE NAVG/P12.2 = IF ((NPREF_NGT LT 0) AND (NPREF_AMT LT 0)) THEN
((NPREF_AMT/NPREF_NGT)*(-1)) ELSE IF ((NPREF_NGT LT 1) AND
(NPREF_NGT GT (-1))) THEN 0 ELSE NPREF_AMT/NPREF_NGT; 
COMPUTE GNAVG/P16.2 = IF ((NPREF_NGT LT 0) AND (AMT_NPREF1 LT 0)) THEN
((AMT_NPREF1/NPREF_NGT)*(-1)) ELSE IF ((NPREF_NGT LT 1) AND
(NPREF_NGT GT (-1))) THEN 0 ELSE AMT_NPREF1/NPREF_NGT; 
COMPUTE PAVG/P12.2 = IF ((PREF_NGT LT 1) AND
(PREF_NGT GT (-1))) THEN 0 ELSE PREF_AMT/PREF_NGT; 
COMPUTE GPAVG/P12.2 = IF ((PREF_NGT LT 1) AND
(PREF_NGT GT (-1))) THEN 0 ELSE AMT_PREF1/PREF_NGT; 
BY CTY_VALUE
BY CTY_PRINT
BY PROP_CTY
BY PROP_ST_CD
BY PREF_NON
BY RANK_VAL 
BY HTL_NAM
-* BY PROP_ST_CD
BY HTL_ADDS
BY PRP_PHONE
BY CHN_CD
WHERE CTY_VALUE EQ 'OTHER'
ON TABLE HOLD AS XTWO FORMAT ALPHA
END
-RUN

 

TABLE FILE XTWO
SUM NNROOMS AS 'TNROOMS' NNROOMS3 AS 'TNROOMS1'
BY CTY_VALUE
ON TABLE HOLD AS JHOLD FORMAT ALPHA
END
-RUN


MATCH FILE XTWO
PRINT BOOKINGS
  CHN_CD
  CLIMIT
  CTY_PRINT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  PREF_NON
  ROOM_AMT	
  GROOM_AMT
  SAVINGS
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
  PROP_CTY
  PROP_ST_CD
  HTL_NAM
  HTL_ADDS
  PRP_PHONE
  RANK_VAL 
BY CTY_VALUE 
ON TABLE HOLD
RUN
FILE JHOLD
SUM TNROOMS TNROOMS1
BY CTY_VALUE
AFTER MATCH HOLD AS JHOLD1 OLD-OR-NEW
END
-RUN

-* DEFINE FILE JHOLD1
-* CTY_PRINT/A35 = IF CTY_VALUE NE 'OTHER' THEN CITY_ST ELSE ' ';
-* END

TABLE FILE JHOLD1
PRINT
  BOOKINGS
  CLIMIT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  ROOM_AMT	
  GROOM_AMT
  SAVINGS
  TNROOMS
  TNROOMS1
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
COMPUTE NAVG/P12.2 = IF ((NPREF_NGT LT 0) AND (NPREF_AMT LT 0)) THEN
((NPREF_AMT/NPREF_NGT)*(-1)) ELSE IF ((NPREF_NGT LT 1) AND
(NPREF_NGT GT (-1))) THEN 0 ELSE NPREF_AMT/NPREF_NGT; 
COMPUTE GNAVG/P12.2 = IF ((NPREF_NGT LT 0) AND (AMT_NPREF1 LT 0)) THEN
((AMT_NPREF1/NPREF_NGT)*(-1)) ELSE IF ((NPREF_NGT LT 1) AND
(NPREF_NGT GT (-1))) THEN 0 ELSE AMT_NPREF1/NPREF_NGT; 
COMPUTE PAVG/P12.2 = IF ((PREF_NGT LT 1) AND
(PREF_NGT GT (-1))) THEN 0 ELSE PREF_AMT/PREF_NGT;
COMPUTE GPAVG/P16.2 = IF ((PREF_NGT LT 1) AND
(PREF_NGT GT (-1))) THEN 0 ELSE AMT_PREF1/PREF_NGT;
BY CTY_VALUE
BY CTY_PRINT
BY PROP_CTY
BY PROP_ST_CD
BY PREF_NON
BY RANK_VAL 
-* BY PROP_ST_CD
BY HTL_NAM
BY HTL_ADDS
BY PRP_PHONE
BY CHN_CD
ON TABLE HOLD AS XTHREE FORMAT FOCUS
END
-RUN


-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HNK=&HLDPATH || 'HOLD11.FOC';
-SET &HNORNK=&HLDPATH || 'XTHREE.FOC';
-RUN

USE CLEAR *
-RUN

EX SUUSES
-RUN

USE ADD
&HNK AS HOLD11
&HNORNK AS HOLD11
END
-RUN

TABLE FILE HOLD11
SUM  BOOKINGS
COMPUTE PAVG/P12.2 = IF ((PREF_NGT LT 1) AND
(PREF_NGT GT (-1))) THEN 0 ELSE PREF_AMT/PREF_NGT; 
COMPUTE GPAVG/P12.2 = IF ((PREF_NGT LT 1) AND
(PREF_NGT GT (-1))) THEN 0 ELSE AMT_PREF1/PREF_NGT; 
BY CTY_VALUE
BY CTY_PRINT
WHERE PREF_NON EQ 'PREFERRED'
ON TABLE HOLD AS HOLDPREF 
END
-RUN 

MATCH FILE HOLD11
PRINT
  BOOKINGS
  CHN_CD
  CLIMIT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  NAVG
  GNAVG
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  PREF_NON	
  ROOM_AMT	
  GROOM_AMT
  SAVINGS
  TNROOMS
  TNROOMS1
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
  PROP_CTY
  PROP_ST_CD
  HTL_NAM
  HTL_ADDS
  RANK_VAL 
  PRP_PHONE
BY CTY_VALUE
BY CTY_PRINT
ON TABLE HOLD
RUN
FILE HOLDPREF
SUM PAVG 
    GPAVG
BY CTY_VALUE
BY CTY_PRINT
AFTER MATCH HOLD AS HOLD12 OLD-OR-NEW
END
-RUN

DEFINE FILE HOLD12
PAVG1/D12.2 = IF PREF_NON EQ 'PREFERRED' THEN 0 ELSE PAVG;
GPAVG1/D12.2 = IF PREF_NON EQ 'PREFERRED' THEN 0 ELSE GPAVG;
FLAG/A1 = 'A';
END

TABLE FILE HOLD12
SUM BOOKINGS
  CLIMIT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  NAVG
  GNAVG
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  ROOM_AMT	
  GROOM_AMT
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
COMPUTE AVGAMT/D12.2=IF (ROOM_AMT LT 0) AND (NMBR_DAYS LT 0)
THEN ((ROOM_AMT/NMBR_DAYS)*(-1)) ELSE IF ((NMBR_DAYS LT 1)
AND (NMBR_DAYS GT (-1))) THEN 0 ELSE ROOM_AMT/NMBR_DAYS; 
COMPUTE GAVGAMT/D16.2=IF (GROOM_AMT LT 0) AND (NMBR_DAYS LT 0)
THEN ((GROOM_AMT/NMBR_DAYS)*(-1)) ELSE IF ((NMBR_DAYS LT 1)
AND (NMBR_DAYS GT (-1))) THEN 0 ELSE GROOM_AMT/NMBR_DAYS; 
COMPUTE NAVG2/P12.2 = IF ((NPREF_NGT LT 0) AND (NPREF_AMT LT 0)) THEN
((NPREF_AMT/NPREF_NGT)*(-1)) ELSE IF ((NPREF_NGT LT 1) AND
(NPREF_NGT GT (-1))) THEN 0 ELSE NPREF_AMT/NPREF_NGT;
COMPUTE GNAVG2/P16.2 = IF ((NPREF_NGT LT 0) AND (AMT_NPREF1 LT 0)) THEN
((AMT_NPREF1/NPREF_NGT)*(-1)) ELSE IF ((NPREF_NGT LT 1) AND
(NPREF_NGT GT (-1))) THEN 0 ELSE AMT_NPREF1/NPREF_NGT; 
COMPUTE PAVG2/P12.2 = IF ((PREF_NGT LT 1) AND
(PREF_NGT GT (-1))) THEN 0 ELSE PREF_AMT/PREF_NGT; 
COMPUTE GPAVG2/P12.2 = IF ((PREF_NGT LT 1) AND
(PREF_NGT GT (-1))) THEN 0 ELSE AMT_PREF1/PREF_NGT; 
COMPUTE PCTNBRN/D12.2 = IF ((TNROOMS1 LT 1) AND (TNROOMS1 GT (-1))) THEN 0 ELSE
                        IF NNROOMSPN GT TNROOMS1 THEN 0 ELSE ((NNROOMSPN/TNROOMS1)*100);
COMPUTE LSV/P12.2C= IF (PAVG1 EQ 0) THEN 0 ELSE ((NAVG-PAVG1)*NPREF_NGT);
COMPUTE GLSV/P16.2C= IF (GPAVG1 EQ 0) THEN 0 ELSE ((GNAVG-GPAVG1)*NPREF_NGT);
BY FLAG
BY CTY_VALUE
BY CTY_PRINT
BY PROP_CTY
BY PROP_ST_CD
BY PREF_NON
BY RANK_VAL 
BY HTL_NAM 
BY HTL_ADDS
BY PRP_PHONE
BY CHN_CD
ON TABLE HOLD AS HOLD13
END
-RUN

TABLE FILE HOLD13
PRINT BOOKINGS	
  CHN_CD
  CLIMIT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  NAVG
  GNAVG
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  ROOM_AMT	
  GROOM_AMT
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
  AVGAMT
  GAVGAMT
  NAVG2
  GNAVG2
  PAVG2
  GPAVG2
  PCTNBRN
  LSV
  GLSV
BY FLAG
BY CTY_VALUE
BY CTY_PRINT
BY PROP_CTY
BY PROP_ST_CD
BY PREF_NON
BY RANK_VAL 
-* BY PROP_ST_CD
BY HTL_NAM 
BY HTL_ADDS
BY PRP_PHONE
ON TABLE HOLD AS HLDONE FORMAT FOCUS
END
-RUN


DEFINE FILE HOLD12
FLAG1/A1 = 'C';
END
TABLE FILE HOLD12
SUM PREF_AMT AS 'PA' PREF_NGT AS 'PN'  NNROOMSPN AS 'TPNPN'
BY FLAG1 
ON TABLE HOLD AS PHLD
END
-RUN


DEFINE FILE HOLD12
-* PAVG1/D12.2 = IF PREF_NON EQ 'PREFERRED' THEN 0 ELSE PAVG;
-* GPAVG1/D12.2 = IF PREF_NON EQ 'PREFERRED' THEN 0 ELSE GPAVG;
FLAG1/A1 = 'C';
CTY_VALUE/A11 = 'GRAND TOTAL';
CTY_PRINT/A35 = ' ';
PROP_ST_CD/A3 = ' ';
HTL_NAM/A35 = ' ';
HTL_ADDS/A35 =  ' ';
PRP_PHONE/A15 = ' ';
RANK_VAL/A5 = ' ';
CHN_CD/A2 = ' ';
PROP_CTY/A25 = ' ';
PROP_ST_CD/A3 = ' ';
END

TABLE FILE HOLD12
SUM BOOKINGS	
  CLIMIT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  NAVG
  GNAVG
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  ROOM_AMT	
  GROOM_AMT
  SAVINGS	
  TNROOMS
  TNROOMS1
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
BY FLAG1
BY CTY_VALUE
BY CTY_PRINT
BY PROP_CTY
BY PROP_ST_CD
BY PREF_NON
BY RANK_VAL 
-* BY PROP_ST_CD
BY HTL_NAM
BY HTL_ADDS
BY PRP_PHONE
BY CHN_CD
ON TABLE HOLD AS TM
END



MATCH FILE TM
PRINT BOOKINGS	
  CLIMIT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  NAVG
  GNAVG
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  ROOM_AMT	
  GROOM_AMT
  SAVINGS
  TNROOMS
  TNROOMS1
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
  FLAG
  CTY_VALUE
  CTY_PRINT
  RANK_VAL 
  PROP_ST_CD
  HTL_NAM
  HTL_ADDS
  PRP_PHONE
BY FLAG1
BY CTY_VALUE
BY CTY_PRINT
BY PROP_CTY
BY PROP_ST_CD
BY PREF_NON
BY RANK_VAL 
-* BY PROP_ST_CD
BY HTL_NAM
BY HTL_ADDS
BY PRP_PHONE
BY CHN_CD
ON TABLE HOLD
RUN
FILE PHLD
SUM PA
    PN
    TPNPN
BY FLAG1
AFTER MATCH HOLD AS GRAND1 OLD-OR-NEW
END
-RUN

DEFINE FILE GRAND1
PAVG1/D12.2 = IF PREF_NON EQ 'PREFERRED' THEN 0 ELSE PAVG;
GPAVG1/D12.2 = IF PREF_NON EQ 'PREFERRED' THEN 0 ELSE GPAVG;
FLAG/A1 = 'C';
END
TABLE FILE GRAND1
SUM BOOKINGS
  CLIMIT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  NAVG
  GNAVG
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  ROOM_AMT	
  GROOM_AMT
  SAVINGS
  TNROOMS
  TNROOMS1
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
COMPUTE AVGAMT/D12.2=IF (ROOM_AMT LT 0) AND (NMBR_DAYS LT 0) THEN ((ROOM_AMT/NMBR_DAYS)*(-1)) ELSE 
                     IF ((NMBR_DAYS LT 1)AND (NMBR_DAYS GT (-1))) THEN 0 ELSE ROOM_AMT/NMBR_DAYS; 
                     
COMPUTE GAVGAMT/D16.2=IF (GROOM_AMT LT 0) AND (NMBR_DAYS LT 0)THEN ((GROOM_AMT/NMBR_DAYS)*(-1)) ELSE 
                      IF ((NMBR_DAYS LT 1) AND (NMBR_DAYS GT (-1))) THEN 0 ELSE GROOM_AMT/NMBR_DAYS; 

                      
COMPUTE NAVG2/P12.2 = IF ((NPREF_NGT LT 0) AND (NPREF_AMT LT 0)) THEN((NPREF_AMT/NPREF_NGT)*(-1)) ELSE 
                      IF ((NPREF_NGT LT 1) AND (NPREF_NGT GT (-1))) THEN 0 ELSE NPREF_AMT/NPREF_NGT; 
                      
                     
COMPUTE GNAVG2/P16.2 = IF ((NPREF_NGT LT 0) AND (AMT_NPREF1 LT 0)) THEN ((AMT_NPREF1/NPREF_NGT)*(-1)) ELSE 
                       IF ((NPREF_NGT LT 1) AND (NPREF_NGT GT (-1))) THEN 0 ELSE AMT_NPREF1/NPREF_NGT;
                       
COMPUTE PAVG2/P12.2 = IF ((PN LT 1) AND (PN GT (-1))) THEN 0 ELSE PA/PN; 

-* COMPUTE PAVG2/P12.2 = IF ((PREF_NGT LT 1) AND (PREF_NGT GT (-1))) THEN 0 ELSE PREF_AMT/PREF_NGT; 

COMPUTE GPAVG2/P16.2 = IF ((PREF_NGT LT 1) AND (PREF_NGT GT (-1))) THEN 0 ELSE AMT_PREF1/PREF_NGT; 

COMPUTE PCTNBRN/D12.2 = IF ((TPNPN LT 1) AND (TPNPN GT (-1))) THEN 0 ELSE ((NNROOMSPN/TPNPN)*100);

COMPUTE LSV/P12.2C= IF (PAVG2 EQ 0) THEN 0 ELSE ((NAVG2-PAVG2)*NPREF_NGT);
-*                     IF (NAVG2 - PAVG2 LT 0) THEN 0 ELSE ((NAVG2-PAVG2)*NPREF_NGT);
                    
COMPUTE GLSV/P16.2C= IF (GPAVG1 EQ 0) THEN 0 ELSE ((GNAVG2-GPAVG2)*NPREF_NGT); 
-*                     IF (GNAVG2 - GPAVG2 LT 0) THEN 0 ELSE   
BY FLAG
BY CTY_VALUE
BY CTY_PRINT
BY PROP_CTY
BY PROP_ST_CD
BY PREF_NON
BY RANK_VAL 
-* BY PROP_ST_CD
BY HTL_NAM
BY HTL_ADDS
BY PRP_PHONE
BY CHN_CD
ON TABLE HOLD AS HLDTWOA 
END
-RUN



TABLE FILE HLDTWOA
PRINT BOOKINGS	
  CHN_CD
  CLIMIT
  NAMEC
  NEW_ROOM_RATE
  NEW_STD_RATE
  NEW_TOTAL_AMT
  NMBR_DAYS	
  NNROOMS
  NNROOMSPN
  NNROOMS3
  NPREF_AMT
  AMT_NPREF1
  NPREF_NGT
  NAVG
  GNAVG
  PREF_AMT
  AMT_PREF1
  PREF_NGT
  ROOM_AMT	
  GROOM_AMT
  SAVINGS	
  TOTAL_STD
  TOTAL_SLSAV
  SLSAV_TTL1
  AVGAMT                      
  GAVGAMT
  NAVG2
  GNAVG2
  PAVG2  
  GPAVG2
  PCTNBRN           
  LSV
  GLSV   
BY FLAG
BY CTY_VALUE
BY CTY_PRINT
BY PROP_CTY
BY PROP_ST_CD
BY PREF_NON
BY RANK_VAL 
-* BY PROP_ST_CD
BY HTL_NAM
BY HTL_ADDS
BY PRP_PHONE

ON TABLE HOLD AS HLDTWO FORMAT FOCUS
END
-RUN
  
-SET &HLDPATH=TEMPPATH(50,'A50');
-SET &HRANK=&HLDPATH || 'HLDONE.FOC';
-SET &HNORANK=&HLDPATH || 'HLDTWO.FOC';
-RUN

USE CLEAR *
-RUN

EX SUUSES
-RUN

USE ADD
&HRANK AS HLDONE
&HNORANK AS HLDONE
END
-RUN

-GOTO JOY

TABLE FILE HLDONE
PRINT *
ON TABLE HOLD AS HLDMOD FORMAT FOCUS
END
-RUN


TABLE FILE HLDMOD
PRINT FOCLIST 
BY FOCLIST NOPRINT
WHERE FLAG EQ 'C'
ON TABLE HOLD AS HHLDFIX
END
-RUN

MODIFY FILE HLDMOD
FIXFORM FROM HHLDFIX
MATCH FOCLIST
ON MATCH COMPUTE PCTNBRN=100.00;
ON MATCH UPDATE PCTNBRN
ON NOMATCH REJECT
DATA ON HHLDFIX
END
-RUN
 
-JOY
DEFINE FILE HLDONE
NOWTOD/A11 WITH CTY_VALUE = HHMMSS (NOWTOD);
  HTL_NAM1/A20 = SUBSTR(35, HTL_NAM, 1, 20, 20, HTL_NAM1);
  HADDRS/A22 = SUBSTR(35, HTL_ADDS, 1, 20, 20, HADDRS);
  ADDRESS/A22 = IF CTY_VALUE LT '&&RANK_LIMIT'  THEN HADDRS ELSE ' ';	
  KEY/A1 = IF PREF_NON EQ 'PREFERRED' THEN 'A' ELSE 'B';
END

-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADER' ELSE 'HDREXLS'; 
-SET &&PASTYS = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'SMEXL' ELSE &&SMSTY;
-RUN


TABLE FILE HLDONE
-INCLUDE &&PAHDR
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;

    &&S_SUBJ1
    &&S_SUBJ2
    &&S_SUBJ3
    &&S_SUBJ4
    &&S_SUBJ5
    &&S_SUBJ6
    &&S_SUBJ7
    &&S_SUBJ8
    &&S_SUBJ9
    &&S_SUBJ10

    
-*BY
   &&S_TARG1
   &&S_TARG2
   &&S_TARG3
   &&S_TARG4
   &&S_TARG5
   &&S_TARG6
   &&S_TARG7
   &&S_TARG8
   &&S_TARG9
   &&S_TARG10
-*ON
   &&SUMM_ON1
   &&SUMM_ON2
   &&SUMM_ON3
   &&SUMM_ON4
   &&SUMM_ON5
   &&SUMM_ON6
   &&SUMM_ON7
   &&SUMM_ON8
   &&SUMM_ON9
   &&SUMM_ON10

-SET &FTR_AddlLines = 6;
FOOTING BOTTOM
" "
" "
"* BASED UPON PREFERRED VS. NON-PREFERRED CALCULATIONS SETUP FOR THE ACCOUNT, % ONLY MAY CONTAIN EXCLUSIONS"
"LOST SAVINGS IS BASED ON THE FOLLOWING CALCULATION:"
"NON-PREFERRED AVERAGE NIGHTLY RATE - PREFERRED AVERAGE NIGHTLY RATE"
"MULTIPLIED BY NON-PREFERRED NUMBER OF NIGHTS"
-*
-INCLUDE FOOTERSM
-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**********************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *

-INCLUDE &&PASTYS

-**********************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/18/00      IBISTL-KR            INCLUDE STYLESHEET PARAMS FOR 
-*                                  DRILLABLE REPORTS.
-**********************************************************************
-IF &&DRILLABLE EQ 'N' GOTO SKIP_DRILL;


-INCLUDE &&DSTY

-SKIP_DRILL

ENDSTYLE
-*
&&OUTLINE1
&&SUMMDEST
&&OUTLINE2
END
-RUN
-*

-IF &&DRILLABLE EQ 'Y' GOTO SKIP_R3;

EX REPORT_3

-SKIP_R3



-XXIT;
