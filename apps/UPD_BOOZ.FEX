
SET ASNAMES = ON

FILEDEF BOOZ_LVL DISK D:\AS400\BOOZ_LVL.TXT

TABLE FILE BOOZ_LVL
PRINT LEVEL9
BY EMP_NUM
ON TABLE HOLD AS FIXLVL9
END
-RUN


-GOTO NEXT; 
JOIN AIR_KEY IN SYBOOZ TO ALL AIR_KEY IN AYBOOZ AS J1
TABLE FILE SYBOOZ
PRINT LEVEL4 AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  
BY LEVEL4 NOPRINT
ON TABLE HOLD AS DEBHOLD
END
-RUN

JOIN CLEAR *
-RUN

JOIN EMP_NUM IN FIXLVL9 TO ALL LEVEL4 IN DEBHOLD AS J1
TABLE FILE FIXLVL9
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL9 AS 'AROLL_LEV9'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXSEG
END
-RUN


MODIFY FILE SYBOOZ
FIXFORM FROM FIXSEG
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV9
ON NOMATCH REJECT
DATA ON FIXSEG
END
-RUN

JOIN CLEAR *
-RUN
-NEXT 
-* Market
JOIN AIR_KEY IN MYBOOZ TO ALL AIR_KEY IN AYBOOZ AS J1
TABLE FILE MYBOOZ
PRINT LEVEL4 AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  
BY LEVEL4 NOPRINT
ON TABLE HOLD AS DEBHOLDM
END
-RUN

JOIN CLEAR *
-RUN

JOIN EMP_NUM IN FIXLVL9 TO ALL LEVEL4 IN DEBHOLDM AS J1
TABLE FILE FIXLVL9
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL9 AS 'AROLL_LEV9'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXMKT
END
-RUN

MODIFY FILE MYBOOZ
FIXFORM FROM FIXMKT
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV9
ON NOMATCH REJECT
DATA ON FIXMKT
END
-RUN


-*Destination 
JOIN AIR_KEY IN DYBOOZ TO ALL AIR_KEY IN AYBOOZ AS J1
TABLE FILE DYBOOZ
PRINT LEVEL4 AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR  
BY LEVEL4 NOPRINT
ON TABLE HOLD AS DEBHOLDD
END
-RUN

JOIN CLEAR *
-RUN

JOIN EMP_NUM IN FIXLVL9 TO ALL LEVEL4 IN DEBHOLDD AS J1
TABLE FILE FIXLVL9
PRINT AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR LEVEL9 AS 'AROLL_LEV9'
BY AIR_KEY NOPRINT
BY EMBARK NOPRINT
BY ROUTE NOPRINT
BY TKT_SORT NOPRINT
BY SEG_NBR NOPRINT
ON TABLE HOLD AS FIXDST
END
-RUN

MODIFY FILE DYBOOZ
FIXFORM FROM FIXDST
MATCH AIR_KEY EMBARK ROUTE TKT_SORT SEG_NBR
ON MATCH UPDATE AROLL_LEV9
ON NOMATCH REJECT
DATA ON FIXDST
END
-RUN

-*Car

TABLE FILE CYBOOZ
PRINT LEVEL4 CAR_KEY  
BY LEVEL4 NOPRINT
ON TABLE HOLD AS DEBHOLDC
END
-RUN

JOIN CLEAR *
-RUN

JOIN EMP_NUM IN FIXLVL9 TO ALL LEVEL4 IN DEBHOLDC AS J1
TABLE FILE FIXLVL9
PRINT CAR_KEY LEVEL9 AS 'AROLL_LEV9'
BY CAR_KEY NOPRINT
ON TABLE HOLD AS FIXCAR
END
-RUN

MODIFY FILE CYBOOZ
FIXFORM FROM FIXCAR
MATCH CAR_KEY 
ON MATCH UPDATE AROLL_LEV9
ON NOMATCH REJECT
DATA ON FIXCAR
END
-RUN

-* Hotel

TABLE FILE HYBOOZ
PRINT LEVEL4 HTL_KEY  
BY LEVEL4 NOPRINT
ON TABLE HOLD AS DEBHOLDH
END
-RUN

JOIN CLEAR *
-RUN

JOIN EMP_NUM IN FIXLVL9 TO ALL LEVEL4 IN DEBHOLDH AS J1
TABLE FILE FIXLVL9
PRINT HTL_KEY LEVEL9 AS 'AROLL_LEV9'
BY HTL_KEY NOPRINT
ON TABLE HOLD AS FIXHTL
END
-RUN

MODIFY FILE HYBOOZ
FIXFORM FROM FIXHTL
MATCH HTL_KEY 
ON MATCH UPDATE AROLL_LEV9
ON NOMATCH REJECT
DATA ON FIXHTL
END
-RUN
-XXIT