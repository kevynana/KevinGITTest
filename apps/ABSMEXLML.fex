 
-**********************************************************************
-*07/20/17 - JEM - S-22734 Created for ABSMHML (new summary by hierarchy that has multi level hierarchy sorting)

-**********************************************************************
-INCLUDE SETECHO
SET ASNAMES = ON
SET SPACE = 1
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');
-SET &&SP = '|';
-SET &&SP1A = IF &&ROLLNME EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP1 = IF &&ROLLCS EQ ' ' THEN ' ' ELSE &&SP1A;
-SET &&SP3 = IF &&ROLLCNCT EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP4 = IF &&ROLLPHN EQ ' ' THEN ' ' ELSE &&SP;
-SET &&RCNCT = &&ROLLCNCT.LENGTH;
-SET &&CSL = &&ROLLCS.LENGTH;
-SET &&REL = &&ROLLEMAIL.LENGTH;

-SET &&RCSL = &&RCNCT.EVAL + &&CSL.EVAL;

-SET &&CSLPA = IF '&&ROLLUP.EVAL' EQ 'ABCD-R' THEN 80 ELSE 
-              IF '&&ROLLEMAIL.EVAL' NE ' ' AND &&REL GT 20 THEN 68 ELSE
-              IF &&RCSL LE 21 THEN 80 ELSE 
-              IF &&RCSL LE 31 THEN 75 ELSE 68;

-* -SET &&CSLPA = IF &&RCNCT.EVAL GE 15 OR &&CSL.EVAL GE 10 THEN 68 ELSE 75;
-*-SET &&CSLP = IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' THEN 88 ELSE &&CSLPA;

-SET &&CSLP = IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' AND &&ORIENTATION LIKE 'L%' THEN 88 
- ELSE IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' AND &&ORIENTATION LIKE 'P%' THEN 68 
- ELSE IF '&&ROLLUP.EVAL' EQ 'HDRR-R' AND &&ORIENTATION LIKE 'L%' THEN 80
- ELSE IF &&ORIENTATION LIKE 'P%' THEN &&CSLPA-15 ELSE &&CSLPA;
-SET &&BLANK = ' ';
-SET &&ROLLPHNEML = IF '&&ROLLEMAIL.EVAL' GT ' ' THEN '&&ROLLEMAIL.EVAL' ELSE '&&ROLLPHN.EVAL';
-RUN

 
-SET &WHATDATE = IF '&&DATETYPE.EVAL' EQ 'I' THEN 'TRN_DATE' ELSE 'FST_DPT_DATE';
 

CREATE FILE SMHEXLML
-RUN

 
-*********************************************************************************
-* Gather/Add Air Info to QRHIER File
-*********************************************************************************
 
DEFINE FILE SR_50
  CURRENT/A1 = IF &WHATDATE.EVAL GE &&FROMDT.EVAL AND &WHATDATE.EVAL LE &&TODT.EVAL THEN 'Y' ELSE 'N';
  PRIOR/A1 = IF &WHATDATE.EVAL GE &&FXDATE.EVAL AND &WHATDATE.EVAL LE &&TXDATE.EVAL THEN 'Y' ELSE 'N';
  CGADV/A8 = IF (ADV_PURCH LT 7) THEN '0-6' ELSE
             IF (ADV_PURCH GE 7) AND (ADV_PURCH LE 13) THEN '7-13' ELSE
             IF (ADV_PURCH GE 14) AND (ADV_PURCH LE 20) THEN '14-20' ELSE
                '21+';
  BRK_LVL/I2 = &&BRK_LVL;
  FARE_PAID/P12.2 = SEG_AMT + SEG_TAX;
  AIRLINE_FEE/D8.2CS = IF EMBARK EQ 'FP2' OR 'FP3' THEN FARE_PAID ELSE 0;
 
  NET_TKT_CNT/P12    = IF (TICKET_CODE EQ '1') AND
                          (SEG_NBR EQ '01') AND
                          (FARE_PAID GE 0) AND
                          (SEG_COUNT EQ 1) AND
                          (CONJ_REL EQ 1) THEN 1 ELSE
                       IF (TICKET_CODE EQ '1') AND
                          (SEG_NBR EQ '01') AND
                          (EX_FLAG EQ 'F') THEN (-1) ELSE
                       IF (TICKET_CODE EQ '1') AND
                          (SEG_NBR EQ '01') AND
                          (RF_FLAG EQ 'F') THEN (-1) ELSE 0;
 
  SAVINGS/P12.2     = SEG_STANDARD - FARE_PAID;
  NEW_ADV_PURCH/D9    = ADV_PURCH;
 
  NEW_SEG_MILES/D12 = SEG_MILES;
 -* Defines on Previous Defines
  DISSAVINGS/P12.2 = IF EMBARK EQ 'DT1' THEN 0 ELSE
                   FARE_PAID-SEG_LOWEST;
 
-* Defines added for CCI exchange fields
TTLDAYS/P8 = NEW_ADV_PURCH*NET_TKT_CNT ;
 
F_EXCH_CNT/D8CS   = IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (FARE_PAID GE 0) AND
                           (SEG_COUNT EQ 1) AND
                           (CONJ_REL EQ 1) THEN 0 ELSE
                        IF (TICKET_CODE EQ '1') AND
                           (SEG_NBR EQ '01') AND
                           (EX_FLAG EQ 'F') THEN 1 ELSE 0;
CFEXCH/P12CS = IF CURRENT EQ 'Y' THEN F_EXCH_CNT ELSE 0;
CAIR_FEE/P12.2 = IF CURRENT EQ 'Y' THEN AIRLINE_FEE ELSE 0;
CTTLDAYS/P9 = IF CURRENT EQ 'Y' THEN TTLDAYS ELSE 0;
END
-RUN
 
TABLEF FILE SR_50
PRINT AROLL_LEV1
  AROLL_DSC1
  AROLL_LEV2
  AROLL_DSC2
  AROLL_LEV3
  AROLL_DSC3
  AROLL_LEV4
  AROLL_DSC4
  AROLL_LEV5
  AROLL_DSC5
  AROLL_LEV6
  AROLL_DSC6
  AROLL_LEV7
  AROLL_DSC7
  AROLL_LEV8
  AROLL_DSC8
  AROLL_LEV9
  AROLL_DSC9
  AROLL_LEV10
  AROLL_DSC10
  AROLL_LEV11
  AROLL_DSC11
  AROLL_LEV12
  AROLL_DSC12
  AROLL_LEV13
  AROLL_DSC13
  AROLL_LEV14
  AROLL_DSC14
  AROLL_LEV15
  AROLL_DSC15
  CGADV
  CURRENT
  PRIOR
  DISSAVINGS
  DOD_TYPE
  AIR_MAIN.INTL_DOM AS 'INTDOM'
  FARE_PAID
  NET_TKT_CNT
  NEW_ADV_PURCH
  NEW_SEG_MILES
  NONREF_FLAG
  ONLINE_TRADITIONAL
  SEG_COUNT
  SEG_NBR
  TKT_NUM
  TRN_DATE
  CFEXCH
  CAIR_FEE
  CTTLDAYS
  RF_FLAG
  EX_FLAG
WHERE (&WHATDATE.EVAL GE &&FROMDT.EVAL) AND (&WHATDATE.EVAL LE &&TODT.EVAL) OR
      (&WHATDATE.EVAL GE &&FXDATE.EVAL) AND (&WHATDATE.EVAL LE &&TXDATE.EVAL)
WHERE VOID_DATE EQ 0
-INCLUDE RPTPARMS
ON TABLE HOLD AS RPTHOLD
END
-RUN

TABLE FILE RPTHOLD
PRINT AROLL_LEV1
  AROLL_DSC1
  AROLL_LEV2
  AROLL_DSC2
  AROLL_LEV3
  AROLL_DSC3
  AROLL_LEV4
  AROLL_DSC4
  AROLL_LEV5
  AROLL_DSC5
  AROLL_LEV6
  AROLL_DSC6
  AROLL_LEV7
  AROLL_DSC7
  AROLL_LEV8
  AROLL_DSC8
  AROLL_LEV9
  AROLL_DSC9
  AROLL_LEV10
  AROLL_DSC10
  AROLL_LEV11
  AROLL_DSC11
  AROLL_LEV12
  AROLL_DSC12
  AROLL_LEV13
  AROLL_DSC13
  AROLL_LEV14
  AROLL_DSC14
  AROLL_LEV15
  AROLL_DSC15
  CGADV
  CFEXCH
  CAIR_FEE
  DISSAVINGS
  DOD_TYPE
  INTDOM
  FARE_PAID
  NET_TKT_CNT
  NEW_ADV_PURCH
  NEW_SEG_MILES
  NONREF_FLAG
  ONLINE_TRADITIONAL
  SEG_COUNT
  SEG_NBR
  TKT_NUM
  TRN_DATE
  RF_FLAG
  EX_FLAG
  CTTLDAYS
BY CURRENT
BY PRIOR
ON TABLE HOLD AS TRANONE
END
 
-IF &LINES EQ 0 THEN GOTO NOREC;
 
-SET &&RPTSUF = 'HIERSUM';
-INCLUDE FDEFRPTS
-RUN
 
 
DEFINE FILE TRANONE
NEW_ADV_PURCH1/D9 = IF RF_FLAG EQ ' ' THEN NEW_ADV_PURCH ELSE
                    IF EX_FLAG EQ ' ' THEN NEW_ADV_PURCH ELSE (NEW_ADV_PURCH * (-1));
REC_CNT/D8CS = IF NET_TKT_CNT EQ 1 THEN 1 ELSE 0;
TTLDAYS/D8 = NEW_ADV_PURCH*NET_TKT_CNT;
 
 
CAVOL/P12.2 = IF CURRENT EQ 'Y' THEN FARE_PAID ELSE 0;
CMILES/P12 = IF CURRENT EQ 'Y' THEN NEW_SEG_MILES ELSE 0;
PAVOL/P12.2 = IF PRIOR EQ 'Y' THEN FARE_PAID ELSE 0;
CNTKT/P12 = IF CURRENT EQ 'Y' THEN NET_TKT_CNT ELSE 0;
CNTKTD/P12 = IF CURRENT EQ 'Y' AND INTDOM EQ 'D' THEN NET_TKT_CNT ELSE 0;
PNTKT/P12 = IF PRIOR EQ 'Y' THEN NET_TKT_CNT ELSE 0;
CLSAV/P12.2 = IF CURRENT EQ 'Y' THEN DISSAVINGS ELSE 0;
CADVT/P12 = IF (CURRENT EQ 'Y') AND
                (CGADV EQ '0-6') THEN NET_TKT_CNT ELSE 0;
CADVT1/P12 = IF (CURRENT EQ 'Y') AND
                 (CGADV EQ '7-13') THEN NET_TKT_CNT ELSE 0;
CONL/P12 = IF (CURRENT EQ 'Y') AND (ONLINE_TRADITIONAL EQ 'ONLINE') AND (INTDOM EQ 'D') THEN
                  NET_TKT_CNT ELSE 0;
CNR/P12 = IF (CURRENT EQ 'Y') AND (NONREF_FLAG EQ 'N') THEN
              NET_TKT_CNT ELSE 0;
CTTLDAYS/P8 = IF CURRENT EQ 'Y' THEN TTLDAYS ELSE 0;

XROLL2/A15 = '';
XROLL3/A15 = '';
XROLL4/A15 = '';
XROLL5/A15 = '';
XROLL6/A15 = '';
XROLL7/A15 = '';
XROLL8/A15 = '';
XROLL9/A15 = '';
XROLL10/A15 = '';
XROLL11/A15 = '';
XROLL12/A15 = '';
XROLL13/A15 = '';
XROLL14/A15 = '';
XROLL15/A15 = '';

XDSC2/A60 = '';
XDSC3/A60 = '';
XDSC4/A60 = '';
XDSC5/A60 = '';
XDSC6/A60 = '';
XDSC7/A60 = '';
XDSC8/A60 = '';
XDSC9/A60 = '';
XDSC10/A60 = '';
XDSC11/A60 = '';
XDSC12/A60 = '';
XDSC13/A60 = '';
XDSC14/A60 = '';
XDSC15/A60 = '';
END
-RUN

TABLE FILE TRANONE
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
    XROLL2
    XROLL3
    XROLL4
    XROLL5
    XROLL6
    XROLL7
    XROLL8
    XROLL9
    XROLL10
    XROLL11
    XROLL12
    XROLL13
    XROLL14
    XROLL15    
    XDSC2
    XDSC3
    XDSC4
    XDSC5
    XDSC6
    XDSC7
    XDSC8
    XDSC9
    XDSC10
    XDSC11
    XDSC12
    XDSC13
    XDSC14
    XDSC15    
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY AROLL_LEV14
BY AROLL_DSC14
BY AROLL_LEV15
BY AROLL_DSC15
ON TABLE HOLD AS TRANTWO
END
-RUN

-* AROLL_LEV1 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY XROLL2 AS 'AROLL_LEV2'
BY XDSC2 AS 'AROLL_DSC2'
BY XROLL3 AS 'AROLL_LEV3'
BY XDSC3 AS 'AROLL_DSC3'
BY XROLL4 AS 'AROLL_LEV4'
BY XDSC3 AS 'AROLL_DSC4'
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV1 NE ' '
WHERE AROLL_DSC1 NE ' '
ON TABLE HOLD AS HOLD1 
END
-RUN


MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD1
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15             
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD1
END
-RUN


-* AROLL_LEV2 MODIFY 

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY XROLL3 AS 'AROLL_LEV3'
BY XDSC3 AS 'AROLL_DSC3'
BY XROLL4 AS 'AROLL_LEV4'
BY XDSC3 AS 'AROLL_DSC4'
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV2 NE ' '
WHERE AROLL_DSC2 NE ' '
ON TABLE HOLD AS HOLD2
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD2
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD2
END
-RUN


-* AROLL_LEV3 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY XROLL4 AS 'AROLL_LEV4'
BY XDSC3 AS 'AROLL_DSC4'
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XDSC9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV3 NE ' '
WHERE AROLL_DSC3 NE ' '

ON TABLE HOLD AS HOLD3
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD3
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD3
END
-RUN

-* AROLL_LEV4 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV4 NE ' '
WHERE AROLL_DSC4 NE ' '

ON TABLE HOLD AS HOLD4
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD4
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD4
END
-RUN

-* AROLL_LEV5 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV5 NE ' '
WHERE AROLL_DSC5 NE ' '
ON TABLE HOLD AS HOLD5
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD5
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD5
END
-RUN

-* AROLL_LEV6 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV6 NE ' '
WHERE AROLL_DSC6 NE ' '
ON TABLE HOLD AS HOLD6
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD6
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD6
END
-RUN

-* AROLL_LEV7 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV7 NE ' '
WHERE AROLL_DSC7 NE ' '
ON TABLE HOLD AS HOLD7
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD7
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD7
END
-RUN

-* AROLL_LEV8 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV8 NE ' '
WHERE AROLL_DSC8 NE ' '
ON TABLE HOLD AS HOLD8
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD8
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD8
END
-RUN

-* AROLL_LEV9 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV9 NE ' '
WHERE AROLL_DSC9 NE ' '
ON TABLE HOLD AS HOLD9
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD9
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD9
END
-RUN

-* AROLL_LEV10 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV10 NE ' '
WHERE AROLL_DSC10 NE ' '
ON TABLE HOLD AS HOLD10
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD10
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD10
END
-RUN

-* AROLL_LEV11 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11 
BY AROLL_DSC11
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV11 NE ' '
WHERE AROLL_DSC11 NE ' '
ON TABLE HOLD AS HOLD11
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD11
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD11
END
-RUN

-* AROLL_LEV12 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11 
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV12 NE ' '
WHERE AROLL_DSC12 NE ' '
ON TABLE HOLD AS HOLD12
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD12
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON MATCH REJECT
DATA ON HOLD12
END
-RUN

-* AROLL_LEV13 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11 
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV13 NE ' '
WHERE AROLL_DSC13 NE ' '
ON TABLE HOLD AS HOLD13
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD13
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD13
END
-RUN

-* AROLL_LEV14 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11 
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY AROLL_LEV14
BY AROLL_DSC14
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV14 NE ' '
WHERE AROLL_DSC14 NE ' '
ON TABLE HOLD AS HOLD14
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD14
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD14
END
-RUN

-* AROLL_LEV15 MODIFY

TABLE FILE TRANTWO
SUM CAVOL
    CADVT
    CADVT1
    CLSAV
    CMILES
    CNR
    CNTKT
    CONL
    PNTKT
    CNTKTD
    CNR
    PAVOL
    CFEXCH
    CAIR_FEE
    CTTLDAYS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11 
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY AROLL_LEV14
BY AROLL_DSC14
BY AROLL_LEV15
BY AROLL_DSC15
ON TABLE HOLD AS HOLD15
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HOLD15
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH REJECT
DATA ON HOLD15
END
-RUN

-* -INCLUDE OTHPARMS
-* -RUN
 
-*********************************************************************************
-* Gather/Add Car Info 
-*********************************************************************************
 
-SET &&RPTGRP_OVERRIDE='CAR';
EX CODEGEN
-INCLUDE SELCATQT
-RUN

 
EX CARUSE
-RUN
 
 
-SET &&RPTGRP = 'CAR';
EX UDIDGEN
-RUN

 
-* -INCLUDE RESETCPM
-* -RUN


 
-SET &WHATDATEC = IF '&&DATETYPE.EVAL' EQ 'I' THEN 'INVOICE_DATE' ELSE 'PICKUP_DATE';
 
 
 
DEFINE FILE CR_50
 RENTAL_DAYS/P12 = IF (NUM_DAYS LT 0) AND (NUM_CARS LT 0) THEN
                   ((NUM_DAYS * NUM_CARS) * (-1)) ELSE NUM_DAYS * NUM_CARS;
END
 
-RUN
TABLE FILE CR_50
SUM RENTAL_DAYS
    RENTAL_AMT
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY AROLL_LEV14
BY AROLL_DSC14
BY AROLL_LEV15
BY AROLL_DSC15


WHERE (&WHATDATEC.EVAL GE &&FROMDT.EVAL) AND (&WHATDATEC.EVAL LE &&TODT.EVAL)


-INCLUDE RPTPARMS
ON TABLE HOLD AS CAR1
END
-RUN
 
DEFINE FILE CAR1
XROLL2/A15 = '';
XROLL3/A15 = '';
XROLL4/A15 = '';
XROLL5/A15 = '';
XROLL6/A15 = '';
XROLL7/A15 = '';
XROLL8/A15 = '';
XROLL9/A15 = '';
XROLL10/A15 = '';
XROLL11/A15 = '';
XROLL12/A15 = '';
XROLL13/A15 = '';
XROLL14/A15 = '';
XROLL15/A15 = '';

XDSC2/A60 = '';
XDSC3/A60 = '';
XDSC4/A60 = '';
XDSC5/A60 = '';
XDSC6/A60 = '';
XDSC7/A60 = '';
XDSC8/A60 = '';
XDSC9/A60 = '';
XDSC10/A60 = '';
XDSC11/A60 = '';
XDSC12/A60 = '';
XDSC13/A60 = '';
XDSC14/A60 = '';
XDSC15/A60 = ''; 
END
-RUN
TABLE FILE CAR1
SUM RENTAL_AMT/P12.2 AS 'CARVOL'
    RENTAL_DAYS/P12 AS 'CARDAY'
XROLL2
XROLL3
XROLL4
XROLL5
XROLL6
XROLL7
XROLL8
XROLL9
XROLL10
XROLL11
XROLL12
XROLL13
XROLL14
XROLL15
XDSC2
XDSC3
XDSC4
XDSC5
XDSC6
XDSC7
XDSC8
XDSC9
XDSC10
XDSC11
XDSC12
XDSC13
XDSC14
XDSC15  
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY AROLL_LEV14
BY AROLL_DSC14
BY AROLL_LEV15
BY AROLL_DSC15
ON TABLE HOLD AS CAR2
END
-RUN


-* AROLL_LEV1 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY XROLL2 AS 'AROLL_LEV2'
BY XDSC2 AS 'AROLL_DSC2'
BY XROLL3 AS 'AROLL_LEV3'
BY XDSC3 AS 'AROLL_DSC3'
BY XROLL4 AS 'AROLL_LEV4'
BY XDSC3 AS 'AROLL_DSC4'
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV1 NE ' '
WHERE AROLL_DSC1 NE ' '
ON TABLE HOLD AS CHOLD1
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD1
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD1
END
-RUN

-* AROLL_LEV2 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY XROLL3 AS 'AROLL_LEV3'
BY XDSC3 AS 'AROLL_DSC3'
BY XROLL4 AS 'AROLL_LEV4'
BY XDSC3 AS 'AROLL_DSC4'
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV2 NE ' '
WHERE AROLL_DSC2 NE ' '
ON TABLE HOLD AS CHOLD2
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD2
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD2
END
-RUN

-* AROLL_LEV3 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY XROLL4 AS 'AROLL_LEV4'
BY XDSC3 AS 'AROLL_DSC4'
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV3 NE ' '
WHERE AROLL_DSC3 NE ' '
ON TABLE HOLD AS CHOLD3
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD3
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD3
END
-RUN

-* AROLL_LEV4 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV4 NE ' '
WHERE AROLL_DSC4 NE ' '
ON TABLE HOLD AS CHOLD4
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD4
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD4
END
-RUN

-* AROLL_LEV5 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV5 NE ' '
WHERE AROLL_DSC5 NE ' '
ON TABLE HOLD AS CHOLD5
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD5
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15   
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD5
END
-RUN

-* AROLL_LEV6 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV6 NE ' '
WHERE AROLL_DSC6 NE ' '
ON TABLE HOLD AS CHOLD6
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD6
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD6
END
-RUN

-* AROLL_LEV7 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY XROLL8 AS 'AROLL_DSC8'
BY XDSC8 AS 'AROLL_LEV8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV7 NE ' '
WHERE AROLL_DSC7 NE ' '
ON TABLE HOLD AS CHOLD7
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD7
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD7
END
-RUN

-* AROLL_LEV8 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_DSC8
BY AROLL_LEV8
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV8 NE ' '
WHERE AROLL_DSC8 NE ' '
ON TABLE HOLD AS CHOLD8
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD8
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD8
END
-RUN

-* AROLL_LEV9 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_DSC8
BY AROLL_LEV8
BY AROLL_LEV9
BY AROLL_DSC9
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV9 NE ' '
WHERE AROLL_DSC9 NE ' '
ON TABLE HOLD AS CHOLD9
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD9
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD9
END
-RUN

-* AROLL_LEV10 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_DSC8
BY AROLL_LEV8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV10 NE ' '
WHERE AROLL_DSC10 NE ' '
ON TABLE HOLD AS CHOLD10
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD10
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD10
END
-RUN

-* AROLL_LEV11 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_DSC8
BY AROLL_LEV8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV11 NE ' '
WHERE AROLL_DSC11 NE ' '
ON TABLE HOLD AS CHOLD11
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD11
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD11
END
-RUN

-* AROLL_LEV12 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_DSC8
BY AROLL_LEV8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV12 NE ' '
WHERE AROLL_DSC12 NE ' '
ON TABLE HOLD AS CHOLD12
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD12
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD12
END
-RUN

-* AROLL_LEV13 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_DSC8
BY AROLL_LEV8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV13 NE ' '
WHERE AROLL_DSC13 NE ' '
ON TABLE HOLD AS CHOLD13
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD13
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD13
END
-RUN


-* AROLL_LEV14 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_DSC8
BY AROLL_LEV8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY AROLL_LEV14
BY AROLL_DSC14
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV14 NE ' '
WHERE AROLL_DSC14 NE ' '
ON TABLE HOLD AS CHOLD14
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD14
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD14
END
-RUN

-* AROLL_LEV15 CAR MODIFY

TABLE FILE CAR2
SUM CARVOL
    CARDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_DSC8
BY AROLL_LEV8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY AROLL_LEV14
BY AROLL_DSC14
BY AROLL_LEV15
BY AROLL_DSC15
WHERE AROLL_LEV15 NE ' '
WHERE AROLL_DSC15 NE ' '
ON TABLE HOLD AS CHOLD15
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM CHOLD15
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE CARVOL CARDAY
DATA ON CHOLD15
END
-RUN


-INCLUDE OTHPARMS
-RUN
 
-*********************************************************************************
-* Gather/Add HTL Info 
-*********************************************************************************
FILEDEF RPTPARMS CLEAR
-RUN
 
-SET &&RPTGRP_OVERRIDE='HTL';
EX CODEGEN
-INCLUDE SELCATQT
-RUN

 
EX HTLUSE
-RUN
 
-SET &&RPTGRP = 'HTL';
EX UDIDGEN
-RUN
 
-INCLUDE RESETHPM
-RUN
 
-SET &WHATDATEH = IF '&&DATETYPE.EVAL' EQ 'I' THEN 'INVOICE_DATE' ELSE 'CHKIN_DATE';
 
 
 
DEFINE FILE HR_50
 NBR_DAYS/P12=NUM_DAYS;
 NEW_TOTAL_AMT/P12.2 = TOTAL_AMT;
 NNROOMS/P12 = IF ((NBR_DAYS LT 0) AND (NUM_ROOMS LT 0)) THEN
                ((NBR_DAYS*NUM_ROOMS) * (-1)) ELSE NBR_DAYS*NUM_ROOMS;
END
-RUN
 
TABLE FILE HR_50
SUM NEW_TOTAL_AMT
    NNROOMS
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY AROLL_LEV14
BY AROLL_DSC14
BY AROLL_LEV15
BY AROLL_DSC15
WHERE (&WHATDATEH.EVAL GE &&FROMDT.EVAL) AND (&WHATDATEH.EVAL LE &&TODT.EVAL)
-INCLUDE RPTPARMS
ON TABLE HOLD AS HTL1
END
-RUN
 
 
 
-**************************************************************************
-* Matching Hotel Records
-**************************************************************************
DEFINE FILE HTL1
XROLL2/A15 = '';
XROLL3/A15 = '';
XROLL4/A15 = '';
XROLL5/A15 = '';
XROLL6/A15 = '';
XROLL7/A15 = '';
XROLL8/A15 = '';
XROLL9/A15 = '';
XROLL10/A15 = '';
XROLL11/A15 = '';
XROLL12/A15 = '';
XROLL13/A15 = '';
XROLL14/A15 = '';
XROLL15/A15 = '';

XDSC2/A60 = '';
XDSC3/A60 = '';
XDSC4/A60 = '';
XDSC5/A60 = '';
XDSC6/A60 = '';
XDSC7/A60 = '';
XDSC8/A60 = '';
XDSC9/A60 = '';
XDSC10/A60 = '';
XDSC11/A60 = '';
XDSC12/A60 = '';
XDSC13/A60 = '';
XDSC14/A60 = '';
XDSC15/A60 = ''; 
END
-RUN
TABLE FILE HTL1
SUM NEW_TOTAL_AMT AS 'HTLVOL'
    NNROOMS AS 'HTLDAY'
XROLL2
XROLL3
XROLL4
XROLL5
XROLL6
XROLL7
XROLL8
XROLL9
XROLL10
XROLL11
XROLL12
XROLL13
XROLL14
XROLL15
XDSC2
XDSC3
XDSC4
XDSC5
XDSC6
XDSC7
XDSC8
XDSC9
XDSC10
XDSC11
XDSC12
XDSC13
XDSC14
XDSC15 
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY AROLL_LEV14
BY AROLL_DSC14
BY AROLL_LEV15
BY AROLL_DSC15

ON TABLE HOLD AS HTL2
END
-RUN

-* AROLL_LEV1 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY XROLL2 AS 'AROLL_LEV2'
BY XDSC2 AS 'AROLL_DSC2'
BY XROLL3 AS 'AROLL_LEV3'
BY XDSC3 AS 'AROLL_DSC3'
BY XROLL4 AS 'AROLL_LEV4'
BY XDSC3 AS 'AROLL_DSC4'
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV1 NE ' '
WHERE AROLL_DSC1 NE ' '
ON TABLE HOLD AS HHOLD1
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD1
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD1
END
-RUN

-* AROLL_LEV2 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY XROLL3 AS 'AROLL_LEV3'
BY XDSC3 AS 'AROLL_DSC3'
BY XROLL4 AS 'AROLL_LEV4'
BY XDSC3 AS 'AROLL_DSC4'
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV2 NE ' '
WHERE AROLL_DSC2 NE ' '
ON TABLE HOLD AS HHOLD2
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD2
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD2
END
-RUN

-* AROLL_LEV3 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY XROLL4 AS 'AROLL_LEV4'
BY XDSC3 AS 'AROLL_DSC4'
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV3 NE ' '
WHERE AROLL_DSC3 NE ' '
ON TABLE HOLD AS HHOLD3
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD3
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD3
END
-RUN

-* AROLL_LEV4 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY XROLL5 AS 'AROLL_LEV5'
BY XDSC5 AS 'AROLL_DSC5'
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV4 NE ' '
WHERE AROLL_DSC4 NE ' '
ON TABLE HOLD AS HHOLD4
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD4
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD4
END
-RUN

-* AROLL_LEV5 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY XROLL6 AS 'AROLL_LEV6'
BY XDSC6 AS 'AROLL_DSC6'
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV5 NE ' '
WHERE AROLL_DSC5 NE ' '
ON TABLE HOLD AS HHOLD5
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD5
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD5
END
-RUN

-* AROLL_LEV6 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY XROLL7 AS 'AROLL_LEV7'
BY XDSC7 AS 'AROLL_DSC7'
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV6 NE ' '
WHERE AROLL_DSC6 NE ' '
ON TABLE HOLD AS HHOLD6
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD6
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD6
END
-RUN

-* AROLL_LEV7 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY XROLL8 AS 'AROLL_LEV8'
BY XDSC8 AS 'AROLL_DSC8'
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV7 NE ' '
WHERE AROLL_DSC7 NE ' '
ON TABLE HOLD AS HHOLD7
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD7
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD7
END
-RUN

-* AROLL_LEV8 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY XROLL9 AS 'AROLL_LEV9'
BY XDSC9 AS 'AROLL_DSC9'
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV8 NE ' '
WHERE AROLL_DSC8 NE ' '
ON TABLE HOLD AS HHOLD8
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD8
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD8
END
-RUN

-* AROLL_LEV9 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY XROLL10 AS 'AROLL_LEV10'
BY XDSC10 AS 'AROLL_DSC10'
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV9 NE ' '
WHERE AROLL_DSC9 NE ' '
ON TABLE HOLD AS HHOLD9
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD9
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15  
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD9
END
-RUN

-* AROLL_LEV10 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY XROLL11 AS 'AROLL_LEV11' 
BY XDSC11 AS 'AROLL_DSC11'
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV10 NE ' '
WHERE AROLL_DSC10 NE ' '
ON TABLE HOLD AS HHOLD10
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD10
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD10
END
-RUN

-* AROLL_LEV11 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY XROLL12 AS 'AROLL_LEV12'
BY XDSC12 AS 'AROLL_DSC12'
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV11 NE ' '
WHERE AROLL_DSC11 NE ' '
ON TABLE HOLD AS HHOLD11
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD11
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD11
END
-RUN

-* AROLL_LEV12 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY XROLL13 AS 'AROLL_LEV13'
BY XDSC13 AS 'AROLL_DSC13'
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV12 NE ' '
WHERE AROLL_DSC12 NE ' '
ON TABLE HOLD AS HHOLD12
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD12
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD12
END
-RUN

-* AROLL_LEV13 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13 
BY XROLL14 AS 'AROLL_LEV14'
BY XDSC14 AS 'AROLL_DSC14'
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV13 NE ' '
WHERE AROLL_DSC13 NE ' '
ON TABLE HOLD AS HHOLD13
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD13
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD13
END
-RUN

-* AROLL_LEV14 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13 
BY AROLL_LEV14
BY AROLL_DSC14
BY XROLL15 AS 'AROLL_LEV15'
BY XDSC15 AS 'AROLL_DSC15'
WHERE AROLL_LEV14 NE ' '
WHERE AROLL_DSC14 NE ' '
ON TABLE HOLD AS HHOLD14
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD14
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15   
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD14
END
-RUN

-* AROLL_LEV15 HOTEL MODIFY

TABLE FILE HTL2
SUM HTLVOL
    HTLDAY
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13 
BY AROLL_LEV14
BY AROLL_DSC14
BY AROLL_LEV15
BY AROLL_DSC15
WHERE AROLL_LEV15 NE ' '
WHERE AROLL_DSC15 NE ' '
ON TABLE HOLD AS HHOLD15
END
-RUN

MODIFY FILE SMHEXLML
LOG DUPL MSG OFF
FIXFORM FROM HHOLD15
MATCH AROLL_LEV1 AROLL_DSC1 AROLL_LEV2 AROLL_DSC2 AROLL_LEV3 AROLL_DSC3 AROLL_LEV4 AROLL_DSC4 AROLL_LEV5 AROLL_DSC5
MATCH AROLL_LEV6 AROLL_DSC6 AROLL_LEV7 AROLL_DSC7 AROLL_LEV8 AROLL_DSC8 AROLL_LEV9 AROLL_DSC9 AROLL_LEV10 AROLL_DSC10
MATCH AROLL_LEV11 AROLL_DSC11 AROLL_LEV12 AROLL_DSC12 AROLL_LEV13 AROLL_DSC13 AROLL_LEV14 AROLL_DSC14 AROLL_LEV15 AROLL_DSC15 
ON NOMATCH INCLUDE
ON MATCH UPDATE HTLVOL HTLDAY
DATA ON HHOLD15
END
-RUN


TABLE FILE SMHEXLML
SUM CAVOL/P12.2M
  PCT.CAVOL/P4 AS 'PCTVOL'
  CNTKT
  CLSAV/P12.2M
  PCT.CFEXCH/P4 AS 'PCTEX'
  CAIR_FEE/P12.2M
  CTTLDAYS/P8
  CONL
  CNTKTD
 
COMPUTE ADVAP/P8 = IF ((CNTKT LT 1) AND ((CNTKT GT -1))) THEN 0 ELSE
                  (CTTLDAYS/CNTKT);
COMPUTE CTLS/P12 =  IF CAVOL EQ 0 THEN 0 ELSE ((CLSAV/CAVOL)*100);
COMPUTE CAVGT/P12.2M = IF ((CNTKT LT 1) AND (CNTKT GT (-1))) THEN 0 ELSE CAVOL/CNTKT;
COMPUTE PAVGT/P12.2M = IF ((PNTKT LT 1) AND (PNTKT GT (-1))) THEN 0 ELSE PAVOL/PNTKT; 
COMPUTE AAVGV/P12.2M = CAVGT - PAVGT; 
COMPUTE AAVGV1/P4% = IF (PAVGT EQ 0) THEN 0 ELSE (((CAVGT-PAVGT)/PAVGT)*100);
                     
COMPUTE CADVP1/P4% = IF CNTKT EQ 0 THEN 0 ELSE ((CADVT/CNTKT)*100);
COMPUTE CADVP2/P4% = IF CNTKT EQ 0 THEN 0 ELSE ((CADVT1/CNTKT)*100);
COMPUTE CONLP/P4%  = IF CNTKTD EQ 0 THEN 0 ELSE ((CONL/CNTKTD)*100);
COMPUTE CNRP/P4%  = IF CNTKT EQ 0 THEN 0 ELSE ((CNR/CNTKT)*100);
COMPUTE CPMILE/P4.2 = IF CMILES EQ 0 THEN 0 ELSE (CAVOL/CMILES);
COMPUTE CARAR/P12.2M = IF ((CARDAY LT 1) AND (CARDAY GT (-1))) THEN 0 ELSE CARVOL/CARDAY;
COMPUTE HTLARR/P12.2M = IF ((HTLDAY LT 1) AND (HTLDAY GT (-1))) THEN 0 ELSE HTLVOL/HTLDAY;
COMPUTE TACH/P12.2M = CAVOL + CARVOL + HTLVOL;
COMPUTE ZFLAG/A1 = IF TACH EQ 0 THEN 'Y' ELSE 'N';
BY AROLL_LEV1
BY AROLL_DSC1
BY AROLL_LEV2
BY AROLL_DSC2
BY AROLL_LEV3
BY AROLL_DSC3
BY AROLL_LEV4
BY AROLL_DSC4
BY AROLL_LEV5
BY AROLL_DSC5
BY AROLL_LEV6
BY AROLL_DSC6
BY AROLL_LEV7
BY AROLL_DSC7
BY AROLL_LEV8
BY AROLL_DSC8
BY AROLL_LEV9
BY AROLL_DSC9
BY AROLL_LEV10
BY AROLL_DSC10
BY AROLL_LEV11
BY AROLL_DSC11
BY AROLL_LEV12
BY AROLL_DSC12
BY AROLL_LEV13
BY AROLL_DSC13
BY AROLL_LEV14
BY AROLL_DSC14
BY AROLL_LEV15
BY AROLL_DSC15
ON TABLE HOLD AS SMHML
END
-RUN

-INCLUDE DATAHROLL
-RUN


TABLE FILE HIERORG
PRINT LEVEL 
WHERE ROLLUP_CODE EQ '&&ROLLUP.EVAL'
ON TABLE HOLD
END
-RUN


-SET &TOTAL_LEVELS = &LINES;

-* -SET &LEV_LEFT = &TOTAL_LEVELS - &CURR_LEVEL1;

-IF &TOTAL_LEVELS EQ 1 GOTO BY1 ELSE
-IF &TOTAL_LEVELS EQ 2 GOTO BY2 ELSE 
-IF &TOTAL_LEVELS EQ 3 GOTO BY3 ELSE
-IF &TOTAL_LEVELS EQ 4 GOTO BY4 ELSE
-IF &TOTAL_LEVELS EQ 5 GOTO BY5 ELSE 
-IF &TOTAL_LEVELS EQ 6 GOTO BY6 ELSE
-IF &TOTAL_LEVELS EQ 7 GOTO BY7 ELSE 
-IF &TOTAL_LEVELS EQ 8 GOTO BY8 ELSE
-IF &TOTAL_LEVELS EQ 9 GOTO BY9 ELSE
-IF &TOTAL_LEVELS EQ 10 GOTO BY10 ELSE 
-IF &TOTAL_LEVELS EQ 11 GOTO BY11 ELSE 
-IF &TOTAL_LEVELS EQ 12 GOTO BY12 ELSE 
-IF &TOTAL_LEVELS EQ 13 GOTO BY13 ELSE 
-IF &TOTAL_LEVELS EQ 14 GOTO BY14 ELSE
-IF &TOTAL_LEVELS EQ 15 GOTO BY15 ELSE GOTO BY1;

-BY1;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''Hierarchy1''';
-SET &SORT2=' ';
-SET &SORT3=' ';
-SET &SORT4=' ';
-SET &SORT5=' ';
-SET &SORT6=' ';
-SET &SORT7=' ';
-SET &SORT8=' ';
-SET &SORT9=' ';
-SET &SORT10=' ';
-SET &SORT11=' ';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;


-GOTO BYDNE;

-BY2;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3=' ';
-SET &SORT4=' ';
-SET &SORT5=' ';
-SET &SORT6=' ';
-SET &SORT7=' ';
-SET &SORT8=' ';
-SET &SORT9=' ';
-SET &SORT10=' ';
-SET &SORT11=' ';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;



-GOTO BYDNE;

-BY3;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4=' ';
-SET &SORT5=' ';
-SET &SORT6=' ';
-SET &SORT7=' ';
-SET &SORT8=' ';
-SET &SORT9=' ';
-SET &SORT10=' ';
-SET &SORT11=' ';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;


-GOTO BYDNE;
-BY4;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5= ' ';
-SET &SORT6=' ';
-SET &SORT7=' ';
-SET &SORT8=' ';
-SET &SORT9=' ';
-SET &SORT10=' ';
-SET &SORT11=' ';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;


-GOTO BYDNE;


-BY5;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6=' ';
-SET &SORT7=' ';
-SET &SORT8=' ';
-SET &SORT9=' ';
-SET &SORT10=' ';
-SET &SORT11=' ';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;



-GOTO BYDNE;



-BY6;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6='BY'|' '|'AROLL_DSC6'|' '|'AS'|' '|'''&HLVD6.EVAL''';
-SET &SORT7=' ';
-SET &SORT8=' ';
-SET &SORT9=' ';
-SET &SORT10=' ';
-SET &SORT11=' ';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;



-GOTO BYDNE;

-BY7;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6='BY'|' '|'AROLL_DSC6'|' '|'AS'|' '|'''&HLVD6.EVAL''';
-SET &SORT7='BY'|' '|'AROLL_DSC7'|' '|'AS'|' '|'''&HLVD7.EVAL''';
-SET &SORT8=' ';
-SET &SORT9=' ';
-SET &SORT10=' ';
-SET &SORT11=' ';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;



-GOTO BYDNE;

-BY8;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6='BY'|' '|'AROLL_DSC6'|' '|'AS'|' '|'''&HLVD6.EVAL''';
-SET &SORT7='BY'|' '|'AROLL_DSC7'|' '|'AS'|' '|'''&HLVD7.EVAL''';
-SET &SORT8='BY'|' '|'AROLL_DSC8'|' '|'AS'|' '|'''&HLVD8.EVAL''';
-SET &SORT9=' ';
-SET &SORT10=' ';
-SET &SORT11=' ';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;


-GOTO BYDNE;
-BY9;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6='BY'|' '|'AROLL_DSC6'|' '|'AS'|' '|'''&HLVD6.EVAL''';
-SET &SORT7='BY'|' '|'AROLL_DSC7'|' '|'AS'|' '|'''&HLVD7.EVAL''';
-SET &SORT8='BY'|' '|'AROLL_DSC8'|' '|'AS'|' '|'''&HLVD8.EVAL''';
-SET &SORT9='BY'|' '|'AROLL_DSC9'|' '|'AS'|' '|'''&HLVD9.EVAL''';
-SET &SORT10=' ';
-SET &SORT11=' ';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;



-GOTO BYDNE;

-BY10;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6='BY'|' '|'AROLL_DSC6'|' '|'AS'|' '|'''&HLVD6.EVAL''';
-SET &SORT7='BY'|' '|'AROLL_DSC7'|' '|'AS'|' '|'''&HLVD7.EVAL''';
-SET &SORT8='BY'|' '|'AROLL_DSC8'|' '|'AS'|' '|'''&HLVD8.EVAL''';
-SET &SORT9='BY'|' '|'AROLL_DSC9'|' '|'AS'|' '|'''&HLVD9.EVAL''';
-SET &SORT10='BY'|' '|'AROLL_DSC10'|' '|'AS'|' '|'''&HLVD10.EVAL''';
-SET &SORT11=' ';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;



-GOTO BYDNE;

-BY11;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6='BY'|' '|'AROLL_DSC6'|' '|'AS'|' '|'''&HLVD6.EVAL''';
-SET &SORT7='BY'|' '|'AROLL_DSC7'|' '|'AS'|' '|'''&HLVD7.EVAL''';
-SET &SORT8='BY'|' '|'AROLL_DSC8'|' '|'AS'|' '|'''&HLVD8.EVAL''';
-SET &SORT9='BY'|' '|'AROLL_DSC9'|' '|'AS'|' '|'''&HLVD9.EVAL''';
-SET &SORT10='BY'|' '|'AROLL_DSC10'|' '|'AS'|' '|'''&HLVD10.EVAL''';
-SET &SORT11='BY'|' '|'AROLL_DSC11'|' '|'AS'|' '|'''&HLVD11.EVAL''';
-SET &SORT12=' ';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;



-GOTO BYDNE;
-BY12;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6='BY'|' '|'AROLL_DSC6'|' '|'AS'|' '|'''&HLVD6.EVAL''';
-SET &SORT7='BY'|' '|'AROLL_DSC7'|' '|'AS'|' '|'''&HLVD7.EVAL''';
-SET &SORT8='BY'|' '|'AROLL_DSC8'|' '|'AS'|' '|'''&HLVD8.EVAL''';
-SET &SORT9='BY'|' '|'AROLL_DSC9'|' '|'AS'|' '|'''&HLVD9.EVAL''';
-SET &SORT10='BY'|' '|'AROLL_DSC10'|' '|'AS'|' '|'''&HLVD10.EVAL''';
-SET &SORT11='BY'|' '|'AROLL_DSC11'|' '|'AS'|' '|'''&HLVD11.EVAL''';
-SET &SORT12='BY'|' '|'AROLL_DSC12'|' '|'AS'|' '|'''&HLVD12.EVAL''';
-SET &SORT13=' ';
-SET &SORT14=' ';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;




-GOTO BYDNE;

-BY13;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6='BY'|' '|'AROLL_DSC6'|' '|'AS'|' '|'''&HLVD6.EVAL''';
-SET &SORT7='BY'|' '|'AROLL_DSC7'|' '|'AS'|' '|'''&HLVD7.EVAL''';
-SET &SORT8='BY'|' '|'AROLL_DSC8'|' '|'AS'|' '|'''&HLVD8.EVAL''';
-SET &SORT9='BY'|' '|'AROLL_DSC9'|' '|'AS'|' '|'''&HLVD9.EVAL''';
-SET &SORT10='BY'|' '|'AROLL_DSC10'|' '|'AS'|' '|'''&HLVD10.EVAL''';
-SET &SORT11='BY'|' '|'AROLL_DSC11'|' '|'AS'|' '|'''&HLVD11.EVAL''';
-SET &SORT12='BY'|' '|'AROLL_DSC12'|' '|'AS'|' '|'''&HLVD12.EVAL''';
-SET &SORT13='BY'|' '|'AROLL_DSC13'|' '|'AS'|' '|'''&HLVD13.EVAL''';
-SET &SORT14=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;




-GOTO BYDNE;


-BY14;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6='BY'|' '|'AROLL_DSC6'|' '|'AS'|' '|'''&HLVD6.EVAL''';
-SET &SORT7='BY'|' '|'AROLL_DSC7'|' '|'AS'|' '|'''&HLVD7.EVAL''';
-SET &SORT8='BY'|' '|'AROLL_DSC8'|' '|'AS'|' '|'''&HLVD8.EVAL''';
-SET &SORT9='BY'|' '|'AROLL_DSC9'|' '|'AS'|' '|'''&HLVD9.EVAL''';
-SET &SORT10='BY'|' '|'AROLL_DSC10'|' '|'AS'|' '|'''&HLVD10.EVAL''';
-SET &SORT11='BY'|' '|'AROLL_DSC11'|' '|'AS'|' '|'''&HLVD11.EVAL''';
-SET &SORT12='BY'|' '|'AROLL_DSC12'|' '|'AS'|' '|'''&HLVD12.EVAL''';
-SET &SORT13='BY'|' '|'AROLL_DSC13'|' '|'AS'|' '|'''&HLVD13.EVAL''';
-SET &SORT14='BY'|' '|'AROLL_DSC14'|' '|'AS'|' '|'''&HLVD14.EVAL''';
-SET &SORT15=' ';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;



-GOTO BYDNE;

-BY15;
-SET &SORT1='BY'|' '|'AROLL_DSC1'|' '|'AS'|' '|'''&HLVD1.EVAL''';
-SET &SORT2='BY'|' '|'AROLL_DSC2'|' '|'AS'|' '|'''&HLVD2.EVAL''';
-SET &SORT3='BY'|' '|'AROLL_DSC3'|' '|'AS'|' '|'''&HLVD3.EVAL''';
-SET &SORT4='BY'|' '|'AROLL_DSC4'|' '|'AS'|' '|'''&HLVD4.EVAL''';
-SET &SORT5='BY'|' '|'AROLL_DSC5'|' '|'AS'|' '|'''&HLVD5.EVAL''';
-SET &SORT6='BY'|' '|'AROLL_DSC6'|' '|'AS'|' '|'''&HLVD6.EVAL''';
-SET &SORT7='BY'|' '|'AROLL_DSC7'|' '|'AS'|' '|'''&HLVD7.EVAL''';
-SET &SORT8='BY'|' '|'AROLL_DSC8'|' '|'AS'|' '|'''&HLVD8.EVAL''';
-SET &SORT9='BY'|' '|'AROLL_DSC9'|' '|'AS'|' '|'''&HLVD9.EVAL''';
-SET &SORT10='BY'|' '|'AROLL_DSC10'|' '|'AS'|' '|'''&HLVD10.EVAL''';
-SET &SORT11='BY'|' '|'AROLL_DSC11'|' '|'AS'|' '|'''&HLVD11.EVAL''';
-SET &SORT12='BY'|' '|'AROLL_DSC12'|' '|'AS'|' '|'''&HLVD12.EVAL''';
-SET &SORT13='BY'|' '|'AROLL_DSC13'|' '|'AS'|' '|'''&HLVD13.EVAL''';
-SET &SORT14='BY'|' '|'AROLL_DSC14'|' '|'AS'|' '|'''&HLVD14.EVAL''';
-SET &SORT15='BY'|' '|'AROLL_DSC15'|' '|'AS'|' '|'''&HLVD15.EVAL''';
-SET &DRNUM = &TOTAL_LEVELS + 2;
-SET &DRNUM1 = &DRNUM + 2;
-SET &DRNUM2 = &DRNUM1 + 1;
-SET &DRNUM3 = &DRNUM2 + 2;
-SET &DRNUM4 = &DRNUM3 + 2;
-SET &DRNUM5 = &DRNUM4 + 1;
-SET &DRNUM6 = &DRNUM5 + 1;
-SET &DRNUM7 = &DRNUM6 + 1;
-SET &DRNUM8 = &DRNUM7 + 1;
-SET &DRNUM9 = &DRNUM8 + 2;
-SET &DRNUM10 = &DRNUM9 + 1;


-SET &DRCOL1 = 'N'||&DRNUM;
-SET &DRCOL2 = 'N'||&DRNUM1;
-SET &DRCOL3 = 'N'||&DRNUM2;
-SET &DRCOL4 = 'N'||&DRNUM3;
-SET &DRCOL5 = 'N'||&DRNUM4;
-SET &DRCOL6 = 'N'||&DRNUM5;
-SET &DRCOL7 = 'N'||&DRNUM6;
-SET &DRCOL8 = 'N'||&DRNUM7;
-SET &DRCOL9 = 'N'||&DRNUM8;
-SET &DRCOL10 = 'N'||&DRNUM9;
-SET &DRCOL11 = 'N'||&DRNUM10;



-GOTO BYDNE;



-BYDNE;

-INCLUDE OTHPARMS
-INCLUDE AVRP_SUBFOOT
-RUN
 
 
JOIN ROLL WITH AROLL_LEV1 IN SMHML TO ROLLUP_CODE IN ROLLUP_SQL AS J1
-RUN



DEFINE FILE SMHML
NOWTOD/A8 WITH AROLL_LEV1 = HHMMSS (NOWTOD);
ROLL/A8='&&ROLLUP.EVAL';
  RPHONE/A15=EDIT(ROLL_PHONE,'9-999-999-9999');
  RN/A60=TRIM('B', '&&RPT_TTL1.EVAL', 60, ' ', 1, 'A60');
  RN1/A60=TRIM('B', '&&RPT_TTL2.EVAL', 60, ' ', 1, 'A60');
  TDATE1/A8MDYY='&MDYY';
  TDATE2/A10=EDIT(TDATE1,'99/99/9999');
  TIME1/A8=HHMMSS('A8');
  TIME2/A8=EDIT(TIME1,'99$:99$:99');
  RD/A10 = 'Run Date:';
  RT/A10 = 'Run Time:';
  DTDESC/A20='Transaction Dates';
  CUR/A15='Current Period:';
  PRI/A15='Prior Period:';
  SPACE/A1 = 'A';
HIERK1/A15 = AROLL_LEV1;
HIERK2/A15 = AROLL_LEV2;
HIERK3/A15 = AROLL_LEV3;
HIERK4/A15 = AROLL_LEV4;
HIERK5/A15 = AROLL_LEV5;
HIERK6/A15 = AROLL_LEV6;
HIERK7/A15 = AROLL_LEV7;
HIERK8/A15 = AROLL_LEV8;
HIERK9/A15 = AROLL_LEV9;
HIERK10/A15 = AROLL_LEV10;
HIERK11/A15 = AROLL_LEV11;
HIERK12/A15 = AROLL_LEV12;
HIERK13/A15 = AROLL_LEV13;
HIERK14/A15 = AROLL_LEV14;
HIERK15/A15 = AROLL_LEV15;
HIERKT/A225 = HIERK1||HIERK2||HIERK3||HIERK4||HIERK5||HIERK6||HIERK7||HIERK8||HIERK9||HIERK10||HIERK11||HIERK12||HIERK13||HIERK14||HIERK15;  
HIERS5/A1 = IF HIERK5 GT ' ' THEN 'Y' ELSE 'N';
STYF/A1 = IF HIERK1 GT ' ' AND HIERK2 EQ ' ' AND HIERK3 EQ ' ' AND HIERK4 EQ ' ' AND HIERK5 EQ ' ' AND HIERK6 EQ ' ' AND HIERK7 EQ ' ' AND HIERK8 EQ ' ' AND HIERK9 EQ ' ' AND HIERK10 EQ ' ' AND HIERK11 EQ ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'A' ELSE
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 EQ ' ' AND HIERK4 EQ ' ' AND HIERK5 EQ ' ' AND HIERK6 EQ ' ' AND HIERK7 EQ ' ' AND HIERK8 EQ ' ' AND HIERK9 EQ ' ' AND HIERK10 EQ ' ' AND HIERK11 EQ ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'B' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 EQ ' ' AND HIERK5 EQ ' ' AND HIERK6 EQ ' ' AND HIERK7 EQ ' ' AND HIERK8 EQ ' ' AND HIERK9 EQ ' ' AND HIERK10 EQ ' ' AND HIERK11 EQ ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'C' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 EQ ' ' AND HIERK6 EQ ' ' AND HIERK7 EQ ' ' AND HIERK8 EQ ' ' AND HIERK9 EQ ' ' AND HIERK10 EQ ' ' AND HIERK11 EQ ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'D' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 EQ ' ' AND HIERK7 EQ ' ' AND HIERK8 EQ ' ' AND HIERK9 EQ ' ' AND HIERK10 EQ ' ' AND HIERK11 EQ ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'E' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 GT ' ' AND HIERK7 EQ ' ' AND HIERK8 EQ ' ' AND HIERK9 EQ ' ' AND HIERK10 EQ ' ' AND HIERK11 EQ ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'F' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 GT ' ' AND HIERK7 GT ' ' AND HIERK8 EQ ' ' AND HIERK9 EQ ' ' AND HIERK10 EQ ' ' AND HIERK11 EQ ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'G' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 GT ' ' AND HIERK7 GT ' ' AND HIERK8 GT ' ' AND HIERK9 EQ ' ' AND HIERK10 EQ ' ' AND HIERK11 EQ ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'H' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 GT ' ' AND HIERK7 GT ' ' AND HIERK8 GT ' ' AND HIERK9 GT ' ' AND HIERK10 EQ ' ' AND HIERK11 EQ ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'I' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 GT ' ' AND HIERK7 GT ' ' AND HIERK8 GT ' ' AND HIERK9 GT ' ' AND HIERK10 GT ' ' AND HIERK11 EQ ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'J' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 GT ' ' AND HIERK7 GT ' ' AND HIERK8 GT ' ' AND HIERK9 GT ' ' AND HIERK10 GT ' ' AND HIERK11 GT ' ' AND HIERK12 EQ ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'K' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 GT ' ' AND HIERK7 GT ' ' AND HIERK8 GT ' ' AND HIERK9 GT ' ' AND HIERK10 GT ' ' AND HIERK11 GT ' ' AND HIERK12 GT ' ' AND HIERK13 EQ ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'L' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 GT ' ' AND HIERK7 GT ' ' AND HIERK8 GT ' ' AND HIERK9 GT ' ' AND HIERK10 GT ' ' AND HIERK11 GT ' ' AND HIERK12 GT ' ' AND HIERK13 GT ' ' AND HIERK14 EQ ' ' AND HIERK15 EQ ' ' THEN 'M' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 GT ' ' AND HIERK7 GT ' ' AND HIERK8 GT ' ' AND HIERK9 GT ' ' AND HIERK10 GT ' ' AND HIERK11 GT ' ' AND HIERK12 GT ' ' AND HIERK13 GT ' ' AND HIERK14 GT ' ' AND HIERK15 EQ ' ' THEN 'N' ELSE 
          IF HIERK1 GT ' ' AND HIERK2 GT ' ' AND HIERK3 GT ' ' AND HIERK4 GT ' ' AND HIERK5 GT ' ' AND HIERK6 GT ' ' AND HIERK7 GT ' ' AND HIERK8 GT ' ' AND HIERK9 GT ' ' AND HIERK10 GT ' ' AND HIERK11 GT ' ' AND HIERK12 GT ' ' AND HIERK13 GT ' ' AND HIERK14 GT ' ' AND HIERK15 GT ' ' THEN 'O' ELSE 'N';
          
          

END
-RUN
 
TABLE FILE SMHML
HEADING
"&&ROLLNME &&SP1 &&ROLLCS &&SP3 &&ROLLCNCT &&SP4 &&ROLLPHNEML"
"&&DTDESC  Period1: &FMM/&FMD/&FMY - &TOM/&TOD/&TOY  Period2: &FXMM/&FXMD/&FXMY - &TXOM/&TXOD/&TXOY"
"&&RPT_TTL1"
"&&RPT_TTL2"

SUM CAVOL/P12CM AS 'Total,Volume'
    PCTVOL AS '% of,Total,Volume'
    CNTKT/P12C AS 'Net,Tickets'
    CLSAV/P12CM AS 'Total,Lost,Savings'
    CTLS AS '% of,LS to,Air,Volume'
    CAVGT/P12CM AS 'Avg,Ticket,Price'
    AAVGV1 AS 'Avg,Ticket,Price,Var %'
    CADVP1 AS '% Of,Net Tkts,Purchase,0-6 Days'
    CADVP2 AS '% of,Net Tkts,Purchase,7-13 Days'
    ADVAP/P8 AS 'Adv,Pur,Days' 
    CONLP AS '% Dom,Online'
    CNRP AS '% of,NR'
    CPMILE/P10.2M AS 'CPM'
    CARAR/P12CM AS 'Avg,Car,Rate'
    HTLARR/P12CM AS 'Avg,Hotel,Cost Per,Night'
    TACH/P12CM AS 'Total Air,Car &,Hotel,Spend'
 &SORT1
 &SORT2
 &SORT3
 &SORT4
 &SORT5
 &SORT6
 &SORT7
 &SORT8
 &SORT9
 &SORT10
 &SORT11
 &SORT12
 &SORT13
 &SORT14
 &SORT15
BY HIERKT NOPRINT
WHERE ZFLAG EQ 'N'

 
ON TABLE SET PAGE-NUM OFF
&&OUTLINE1
&&OUTLINE2
FOOTING BOTTOM
-INCLUDE CRIGHT_FOOTER
"<60 &M1.EVAL"
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET STYLE *

-* -SET &&OVERDRILL = 'Y';

-IF &&OVERDRILL EQ 'Y' GOTO OVERDRILL;


TYPE=DATA, COLUMN=&DRCOL1, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMAIRML' LSEL=HIERKT PARM1='A'    \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),
$
TYPE=DATA, COLUMN=&DRCOL2, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMAIRML' LSEL=HIERKT PARM1='N'    \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),
$

TYPE=DATA, COLUMN=&DRCOL3, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMAIRML' LSEL=HIERKT PARM1='L'     \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),
$

TYPE=DATA, COLUMN=&DRCOL4, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMAIRML' LSEL=HIERKT PARM1='T'    \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),
$


TYPE=DATA, COLUMN=&DRCOL5, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMAIRML' LSEL=HIERKT PARM1='6'    \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),
$

TYPE=DATA, COLUMN=&DRCOL6, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMAIRML' LSEL=HIERKT PARM1='7'    \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),
$


 
TYPE=DATA, COLUMN=&DRCOL7, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMAIRML' LSEL=HIERKT PARM1='P'    \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),



$
TYPE=DATA, COLUMN=&DRCOL8, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMAIRML' LSEL=HIERKT PARM1='O'    \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),
$

 
TYPE=DATA, COLUMN=&DRCOL9, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMAIRML' LSEL=HIERKT PARM1='R'    \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),
$


TYPE=DATA, COLUMN=&DRCOL10, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMCARML' LSEL=HIERKT   \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),
$



TYPE=DATA, COLUMN=&DRCOL11, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRSMHTLML' LSEL=HIERKT   \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
DTTYPE='&&DATETYPE.EVAL'\
ROLUP='&&ROLLUP' user='&&UNAME'),
$

-OVERDRILL

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.300000, BOTTOMMARGIN=0.050000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
 
TYPE=REPORT, FONT=ARIAL, SIZE=8, JUSTIFY=LEFT, BACKCOLOR=NONE, STYLE=NORMAL, $
TYPE=HEADING, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(31 114 164), BACKCOLOR=NONE, $
TYPE=HEADING, HEADALIGN=BODY, $
TYPE=HEADING, LINE=1, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=2, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=3, COLSPAN=8, SIZE=9, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=4, COLSPAN=8, SIZE=9,JUSTIFY=CENTER, $
-* TYPE=HEADING, LINE=5, COLSPAN=3, JUSTIFY=LEFT, $

-* TYPE=DATA,
-*      BORDER-TOP=LIGHT,
-*      BORDER-BOTTOM=LIGHT,
-*      BORDER-LEFT=LIGHT,
-*      BORDER-RIGHT=LIGHT,
-*      BORDER-TOP-COLOR='SILVER',
-*      BORDER-BOTTOM-COLOR='SILVER',
-*      BORDER-LEFT-COLOR='SILVER',
-*      BORDER-RIGHT-COLOR='SILVER',
-*      BACKCOLOR=(RGB(242 242 242) 'WHITE' ),$


-* TYPE=DATA, BACKCOLOR=RGB(247 251 255), WHEN=STYF EQ 'A', $
-* TYPE=DATA, BACKCOLOR=RGB(222 235 247), WHEN=STYF EQ 'B', $
-* TYPE=DATA, BACKCOLOR=RGB(198 219 239), WHEN=STYF EQ 'C', $
-* TYPE=DATA, BACKCOLOR=RGB(158 202 225), WHEN=STYF EQ 'D', $
-* TYPE=DATA, BACKCOLOR=RGB(107 174 214), WHEN=STYF EQ 'E', $
-* TYPE=DATA, BACKCOLOR=RGB(66 146 198),  WHEN=STYF EQ 'F', $
-* TYPE=DATA, BACKCOLOR=RGB(33 113 181),  WHEN=STYF EQ 'G', $
-* TYPE=DATA, BACKCOLOR=RGB(8 81 156),    WHEN=STYF EQ 'H', $
-* TYPE=DATA, BACKCOLOR=RGB(8 48 107),    WHEN=STYF EQ 'J', $
     
TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8,
     COLOR='WHITE',
     BACKCOLOR=RGB(31 114 164),
     STYLE=BOLD,$
 
 
TYPE=TABFOOTING, FONT=ARIAL, COLOR=GRAY,$
 
TYPE=FOOTING, FONT=ARIAL, COLOR=GRAY,$
 
TYPE=SUBHEAD,
     STYLE=BOLD,
$
 
TYPE=SUBTOTAL,
     STYLE=BOLD,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER', $
 
TYPE=GRANDTOTAL, STYLE=BOLD, $
ENDSTYLE
 
END
-RUN 
 

-GOTO XXIT;
 

 
 
 
 
-NOREC
-SET &&RPTSUF = 'MSG';
-INCLUDE FDEFRPTS
-RUN
JOIN SET_KEY IN BRPTINST TO SET_KEY IN BRPT_SET AS J1
DEFINE FILE BRPTINST
EMPTY/A35 = 'NO RECORDS FOUND FOR THIS SELECTION';
NOWTOD/A8 WITH INST_KEY = HHMMSS (NOWTOD);
END
TABLE FILE BRPTINST
-INCLUDE HEADAIR
PRINT EMPTY AS 'REPORT,MESSAGE'
BY ROLLUP_CODE AS 'ROLLUP,CODE'
BY RPT_NAME AS 'REPORT,NAME'
BY SELECT_LEV AS 'BREAK,LEVEL'
IF INST_KEY EQ &&IKEY
IF RECORDLIMIT EQ 1
-INCLUDE FOOTERDT
ON TABLE SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET PAGE-NUM OFF
ON TABLE SET STYLE *
-INCLUDE &&DTSTY
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
-EXIT
 
 
-XXIT
 
