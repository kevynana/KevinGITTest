-* 03/14/17 JEM S-22486 - updated position of header and footer NEW_HDR NEW_FTR

-INCLUDE SETECHO


-SET &&HEADING = 'Non-Compliance Overview'; 
-* CURRENT DATES
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');
-SET &&SP = '|';

-RUN

-IF &&OUTLINE1 CONTAINS 'ONLINE-FMT' OR 'PCHOLD' GOTO ONFMT;
-IF &&OUTFMT EQ 'PDF' THEN GOTO CFMT ELSE GOTO OFMT;
-RUN

-CFMT
-SET &&OUTLINE1 = 'ON TABLE SAVE AS SAVREP';
-SET &&OUTLINE2 = 'FORMAT PDF OPEN';
-SET &&RPTSUF = ' ';
-INCLUDE FDEFRPTS
-RUN
-GOTO NEXTPART

-OFMT
-SET &&RPTSUF = 'OVERVIEW';
-INCLUDE FDEFRPTS
-RUN
-GOTO NEXTPART

-ONFMT
-IF &&OUTFMT NE 'PDF' GOTO ONFMT1;
-SET &&OUTLINE1 = 'ON TABLE PCHOLD';
-SET &&OUTLINE2 = 'FORMAT PDF OPEN';
-SET &&RPTSUF = '';
-RUN
-GOTO NEXTPART

-ONFMT1
-SET &&RPTSUF = '';
-RUN
-GOTO NEXTPART

-NEXTPART
-SET &&RPTSUF = 'NONCOMPLIANCE';
-RUN


JOIN ROLL WITH CATEGORY IN OV_OFF TO ROLLUP_CODE IN ROLLUP AS J1.
-RUN

DEFINE FILE OV_OFF

KEY/A1 = IF OV_OFF.CAT_ORDER EQ 1 THEN 'A' ELSE
         IF OV_OFF.CAT_ORDER EQ 2 THEN 'B' ELSE
         IF OV_OFF.CAT_ORDER EQ 3 THEN 'C' ELSE
         IF OV_OFF.CAT_ORDER EQ 4 THEN 'D' ELSE
         IF OV_OFF.CAT_ORDER EQ 5 THEN 'E' ELSE 
         IF OV_OFF.CAT_ORDER EQ 6 THEN 'F' ELSE ' ';


ALABEL/A12='# Tickets   ';
ALABEL1/A12='Volume      ';
BLABEL/A12='Usage %     ';
MLABEL/A12='Markets     ';
HLABEL/A12='# Nights';
LLABEL/A12='Lost Savings';

FLABEL/A12= IF KEY EQ 'A' THEN ALABEL ELSE
            IF KEY EQ 'B' THEN ALABEL ELSE
            IF KEY EQ 'C' THEN ALABEL ELSE
            IF KEY EQ 'D' THEN ALABEL ELSE 
            IF KEY EQ 'E' THEN HLABEL ELSE  
            IF KEY EQ 'F' THEN HLABEL ELSE ' ';

FLABEL1/A12= IF KEY EQ 'A' THEN BLABEL ELSE
             IF KEY EQ 'B' THEN BLABEL ELSE 
             IF KEY EQ 'C' THEN BLABEL ELSE 
             IF KEY EQ 'D' THEN BLABEL ELSE
             IF KEY EQ 'E' THEN BLABEL ELSE 
             IF KEY EQ 'F' THEN BLABEL ELSE  ' ';
             
CFLAG/A1 = IF CAT_ORDER EQ 1 AND ROW_ORDER EQ 2 THEN 'Y' ELSE 
           IF CAT_ORDER EQ 1 AND ROW_ORDER EQ 4 THEN 'Y' ELSE 
           IF CAT_ORDER EQ 1 AND ROW_ORDER EQ 6 THEN 'Y' ELSE 
           IF CAT_ORDER EQ 6 AND ROW_ORDER EQ 2 THEN 'Y' ELSE
           IF CAT_ORDER EQ 6 AND ROW_ORDER EQ 4 THEN 'Y' ELSE 'N';             


TEST/A1='';
-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*7/31/00    IBISTL-KR          ADDED DEFINE FOR NOWTOD
-*************************************************************************
NOWTOD/A8 WITH CAT_ORDER = HHMMSS (NOWTOD);
ROLL/A8='&&ROLLUP.EVAL';
-* LVL/A60='&&LVL_DSC.EVAL';
LVL/A60=TRIM('B', '&&LVL_DSC.EVAL', 60, ' ', 1, 'A60');
RPHONE/A15=EDIT(ROLL_PHONE,'9-999-999-9999');
RN/A60=TRIM('B', '&&HEADING.EVAL', 60, ' ', 1, 'A60');
TDATE1/A8MDYY='&MDYY';
TDATE2/A10=EDIT(TDATE1,'99/99/9999');
TIME1/A8=HHMMSS('A8');
TIME2/A8=EDIT(TIME1,'99$:99$:99');
RD/A10 = 'Run Date:';
RT/A10 = 'Run Time:';
CR/A9 = 'Period 1:';
PR/A9 = 'Period 2:';
CR1/A8 = 'Period 1';
PR1/A8 = 'Period 2';
BLANK/A15 = '               ';
P1/A25=EDIT(&&FROMDT.EVAL,'$$$$$99999/') | EDIT(&&FROMDT.EVAL,'9999') | ' - ' | EDIT(&&TODT.EVAL,'$$$$$99999/') | EDIT(&&TODT.EVAL,'9999');

END
-RUN


TABLE FILE OV_OFF
SUM   VOL_CURR/D16CS   AS '' IN +3
      TKT_CURR/D16%    AS '' IN +5
      VOL_PRIOR/D16CS  AS '' IN +5
      TKT_PRIOR/D16%   AS '' IN +5  

BY CAT_ORDER NOPRINT
BY ROW_ORDER NOPRINT
BY CATEGORY NOPRINT
BY KEY NOPRINT
BY ROW_LABEL AS ' '
BY CFLAG NOPRINT
ON OV_OFF.CAT_ORDER SUBHEAD
-* " "
"<ST.OV_OFF.CATEGORY <18<CR1 <31<PR1"
" "
"<14<FLABEL <21<FLABEL1 <27<FLABEL <34<FLABEL1" 
-*  "
" "
ON TABLE NOTOTAL
ON TABLE SET PAGE-NUM OFF
ON CATEGORY UNDER-LINE
&&OUTLINE1
&&OUTLINE2
HEADING 
-* "Client: <6 <ROLL_NAME <35 <RN <85 &&DTDESC"
-* "Contact: <6 <ROLL_CONTACT <35 <LVL <85 <CR <90 &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
-* "Phone: <6 <RPHONE <85 <PR <90 &FXMM/&FXMD/&FXMY - &TXOM/&TXOD/&TXOY"
"<35 <RN <65 &&DTDESC"
"<35 <LVL  <65 <P1"
"<65 &&ROLLNME <+0> &&SP <+0> &&ROLLCS <+0> &&SP <+0> &&ROLLCNCT <+0> &&SP <+0> &&ROLLPHN"
"</4"
FOOTING BOTTOM
-* "</1"
-* " "
" "
-INCLUDE CRIGHT_FOOTER
"<75 &M1"
ON TABLE SET STYLE *

-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*10/4/00    IBISTL-SB          ADDED DRILL DOWN
-*************************************************************************
-* CURRENT LOST SAVINGS ROW 6********************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N7, WHEN=KEY EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
 (IBIF_ex='DRNONLST' PARM1='CY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
 ROLUP='&&ROLLUP' user='&&UNAME'), $
 

-* PRIOR LOST SAVINGS ROW 8************************************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N9, WHEN=KEY EQ 'A', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONLST' PARM1='PY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT ADVANCED PURCHASE ROW 6********************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N7, WHEN=KEY EQ 'B', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNADV' PARM1='CY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR ADVANCED PURCHASE ROW 8************************************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N9, WHEN=KEY EQ 'B', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNADV' PARM1='PY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT REF/NON ROW 6*****************************************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N7, WHEN=KEY EQ 'C', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNREF' PARM1='CY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR REF/NON ROW 8******************************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N9, WHEN=KEY EQ 'C', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNREF' PARM1='PY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT BOOKING TYPES ROW 6

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N7, WHEN=KEY EQ 'D', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNDOD' PARM1='CY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR BOOKING ROW 8******************************

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N9, WHEN=KEY EQ 'D', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNDOD' PARM1='PY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $


-* CURRENT PREFERRED HOTELS ROW 6

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N7, WHEN=KEY EQ 'E', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONHP' PARM1='CY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR PREFERRED HOTEL ROW 8 

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N9, WHEN=KEY EQ 'E', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONHP' PARM1='PY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* CURRENT HIGH HOTEL ROW 6

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N7, WHEN=KEY EQ 'F', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONHR' PARM1='CY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-* PRIOR HIGH HOTEL ROW 8 

TYPE=DATA, STYLE=-UNDERLINE, COLOR=RGB(0 0 138), SIZE=8, JUSTIFY=LEFT, COLUMN=N9, WHEN=KEY EQ 'F', \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONHR' PARM1='PY' ROW_LABEL=N5\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-******************DRILL DOWN END************************************
UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.100000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.050000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $


TYPE=REPORT, FOCEXEC=NONE, GRID=OFF, FONT=TIMES NEW ROMAN, SIZE=8, COLOR=BLACK,
             BACKCOLOR=NONE, STYLE=NORMAL, $

TYPE=HEADING,
     SIZE=8,
     JUSTIFY=LEFT,
     COLOR=RGB(70 136 177),
     STYLE=BOLD,
$

TYPE=FOOTING,
     SIZE=7, 
     FONT=ARIAL,
     STYLE=NORMAL,
     COLOR=RGB(70 136 177),
$

TYPE=SUBHEAD, 
     COLOR=RGB(0 0 138), 
     LINE=1, 
     ITEM=1,
     SIZE=9, 
-*     FONT=ARIAL,
     JUSTIFY=LEFT, 
     STYLE=BOLD, 
$

TYPE=SUBHEAD,
     COLOR=RGB(0 0 138), 
     LINE=1, 
     ITEM=2,
     OBJECT=FIELD,
     SIZE=8, 
     JUSTIFY=LEFT, 
     STYLE=BOLD, 
$

TYPE=SUBHEAD,
     COLOR=RGB(0 0 138), 
     LINE=1, 
     ITEM=3,
     OBJECT=FIELD,
     SIZE=8, 
     JUSTIFY=LEFT, 
     STYLE=BOLD, 
$


TYPE=SUBHEAD,
     COLOR=RGB(0 0 138), 
     LINE=3, 
     SIZE=8, 
     JUSTIFY=CENTER, 
     STYLE=BOLD+UNDERLINE, $
     
TYPE=DATA,
     COLUMN=N5,
     JUSTIFY=LEFT,
     STYLE=NORMAL, $
     

-*******************
-*******************
TYPE=REPORT, IMAGE=NEW_HDR.jpg, POSITION=(0 0), SIZE=(2.8 .37),PRESERVERATIO=ON, $ 
TYPE=REPORT, IMAGE=NEW_FTR.jpg, POSITION=(0 8.0), SIZE=(10.5 .58), PRESERVERATIO=ON, $ 
-IF &&A_GIF EQ 'N' GOTO SKIP_ADV;
TYPE=REPORT,IMAGE=ADVPUR.SVG, POSITION=(4.5 0.8), $
-SKIP_ADV
-IF &&N_GIF EQ 'N' GOTO SKIP_NON;
TYPE=REPORT,
IMAGE=REFNON.SVG, POSITION=(4.5 2.6),$
-SKIP_NON
-IF &&D_GIF EQ 'N' GOTO SKIP_DOD;
TYPE=REPORT,
IMAGE=DODTYP.SVG, POSITION=(4.5 4.4), $
-SKIP_DOD
-IF &&H_GIF EQ 'N' GOTO SKIP_HOT;
TYPE=REPORT,
 IMAGE=HTLPREF.SVG, POSITION=(4.5 6.2), $ 
-SKIP_HOT


-SKIP_STY
ENDSTYLE
END
-RUN

-IF &&OUTFMT NE 'PDF' GOTO XXIT1A;
EX OVERCOV
-RUN

-XXIT1A;
-EXIT






