-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**
-* 9/23/03 Added Hotel Nights to each of the Hotel Titles per Robin/Paul
-* 
-* 2/19/04  Changed logic to have either file be the host join file JK 
-INCLUDE SETECHO
SET ASNAMES=ON



-SET &&RPTSUF = 'NONCOMPLIANCE';
-SET &FMM=EDIT(&&FROMDT,'$$$$$$99');
-SET &FMD=EDIT(&&FROMDT,'$$$$$$$$$99');
-SET &FMY=EDIT(&&FROMDT,'$9999');
-SET &TOM=EDIT(&&TODT,'$$$$$$99');
-SET &TOD=EDIT(&&TODT,'$$$$$$$$$99');
-SET &TOY=EDIT(&&TODT,'$9999');
-* PRIOR DATES
-SET &FXMM=EDIT(&&FXDATE,'$$$$$$99');
-SET &FXMD=EDIT(&&FXDATE,'$$$$$$$$$99');
-SET &FXMY=EDIT(&&FXDATE,'$9999');
-SET &TXOM=EDIT(&&TXDATE,'$$$$$$99');
-SET &TXOD=EDIT(&&TXDATE,'$$$$$$$$$99');
-SET &TXOY=EDIT(&&TXDATE,'$9999');
-SET &&SP = '|';
-SET &&SP1A = IF &&ROLLNME EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP1 = IF &&ROLLCS EQ ' ' THEN ' ' ELSE &&SP1A;
-SET &&SP3 = IF &&ROLLCNCT EQ ' ' THEN ' ' ELSE &&SP;
-SET &&SP4 = IF &&ROLLPHN EQ ' ' THEN ' ' ELSE &&SP;
-SET &&RCNCT = &&ROLLCNCT.LENGTH;
-SET &&CSL = &&ROLLCS.LENGTH;
-SET &&CSLPA = IF &&RCNCT.EVAL GE 10 OR &&CSL.EVAL GE 10 THEN 60 ELSE 68;
-SET &&CSLP = IF '&&ROLLUP.EVAL' EQ 'BOOZ-R' THEN 78 ELSE &&CSLPA;
-SET &&ROLLCS11 = TRUNCATE(&&ROLLCS);
-SET &&RCNCT1 = TRUNCATE(&&ROLLCNCT);
-SET &&BLANK = ' ';

-INCLUDE FDEFRPTS
-RUN

TABLE FILE MXNONHLD
SUM ADV_TKT
    MXADV_TKT
    MXREF_TKT
    REF_TKT
    MXTRA_TKT
    TRA_TKT
BY LEVEL_DESC
ON TABLE HOLD AS JHOLD
END
-RUN

 


-IF &RECORDS EQ 0 THEN GOTO JOIN2 ELSE GOTO JOIN1;
-RUN

-JOIN1
JOIN MXNONHLD.LEVEL_DESC IN MXNONHLD TO MXNONHTL.LEVEL_DESC IN MXNONHTL AS J1
-RUN
JOIN ROLL WITH LEVEL_DESC IN MXNONHLD TO ROLLUP_CODE IN ROLLUP AS J2
-RUN
-GOTO JOINDONE

-JOIN2
JOIN MXNONHTL.LEVEL_DESC IN MXNONHTL TO MXNONHLD.LEVEL_DESC IN MXNONHLD AS J1
-RUN
JOIN ROLL WITH LEVEL_DESC IN MXNONHLD TO ROLLUP_CODE IN ROLLUP AS J2
-RUN
-GOTO JOINDONE1

-JOINDONE
DEFINE FILE MXNONHLD
NOWTOD/A8 WITH ADV_TKT = HHMMSS (NOWTOD);
BLANK/A1 = ' ';
BLANK1/A1 = '|';
ROLL/A8='&&ROLLUP.EVAL';
LVL/A60='&&LVL_DSC.EVAL';
RPHONE/A15=EDIT(ROLL_PHONE,'9-999-999-9999');
RD/A10 = 'Run Date:';
RT/A10 = 'Run Time:';  
LEV/A25 = EDIT(LEVEL_DESC, '9999999999999999999999999');
RN/A60=TRIM('B', '&&RPT_TTL1.EVAL', 60, ' ', 1, 'A60');
RN1/A60=TRIM('B', '&&RPT_TTL2.EVAL', 60, ' ', 1, 'A60');
TDATE1/A8MDYY='&MDYY';
TDATE2/A10=EDIT(TDATE1,'99/99/9999');
TIME1/A8=HHMMSS('A8');
TIME2/A8=EDIT(TIME1,'99$:99$:99');
DTDESC/A20='Transaction Dates';
END
-RUN

TABLE FILE MXNONHLD
HEADING
-IF &&OUTFMT NE 'PDF' THEN GOTO NOadlLines
"</5"
-NOadlLines
"&&ROLLNME &&SP1 &&ROLLCS11 &&SP3 &&RCNCT1 &&SP4 &&ROLLPHN"
"&&DTDESC &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
"&&RPT_TTL1"
"&&RPT_TTL2"
" "
" "
" "
"<+0> <+0> Advanced Purchase <+0> <+0> Refundable <+0> <+0> Traditional <+0> <+0> Hotels <+0> <+0> Hotel Rates"
"<+0> <+0> 0-6 <+0> <+0> <+0> <+0> <+0> <+0> Non-Preferred <+0> <+0> $150-$199 <+0> <+0> $200-$249 <+0> <+0> $250+"
SUM MXADV_TKT AS '# Of Tkts'
COMPUTE 
MXADVP/D5CS% = IF ((ADV_TKT LT 1) AND (ADV_TKT GT (-1))) THEN 0 ELSE ((MXADV_TKT/ADV_TKT)*100); AS '% Of Tkts'
BLANK AS ' '
MXREF_TKT AS '# Of Tkts'
COMPUTE
MXREFP/D5CS% = IF ((REF_TKT LT 1) AND (REF_TKT GT (-1))) THEN 0 ELSE ((MXREF_TKT/REF_TKT)*100); AS '% Of Tkts'
BLANK AS ' '
MXTRA_TKT AS '# Of Tkts'
COMPUTE
MXTRAP/D5CS% = IF ((TRA_TKT LT 1) AND (TRA_TKT GT (-1))) THEN 0 ELSE ((MXTRA_TKT/TRA_TKT)*100); AS '% Of Tkts'
BLANK AS ' '
NONPREF_RM AS '# Of Nights'
COMPUTE
NONPREFP/D5CS% = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
              ((NONPREF_RM/NNROOMS)*100); AS '% Of Nights'
BLANK AS ' '              
RATE_RM1 AS '# Of Nights'
COMPUTE 
RATERMP1/D5CS% = IF ((NNROOMS1 LT 1) AND (NNROOMS1 GT (-1))) THEN 0 ELSE
              ((RATE_RM1/NNROOMS1)*100); AS '% Of Nights'
BLANK AS ' '              
RATE_RM2 AS '# Of Nights'
COMPUTE
RATERMP2/D5CS% = IF ((NNROOMS1 LT 1) AND (NNROOMS1 GT (-1))) THEN 0 ELSE
              ((RATE_RM2/NNROOMS1)*100); AS '% Of Nights'
BLANK AS ' '              
RATE_RM3 AS '# Of Nights'
COMPUTE 
RATERMP3/D5CS% = IF ((NNROOMS1 LT 1) AND (NNROOMS1 GT (-1))) THEN 0 ELSE
             ((RATE_RM3/NNROOMS1)*100); AS '% Of Nights'
BY LEVEL_DESC AS ' '
FOOTING
"</2"
"THIS REPORT HAS THE FOLLOWING EXCLUSIONS/INCLUSIONS:"
"ALL PORTIONS EXCLUDE - AMTRAK, SHUTTLE FLIGHTS"
"REFUNDABLE TICKETS INCLUDE ONLINE EXCHANGES"
"0-6 TICKETS EXCLUDE ALL EXCHANGES"
"TRADITIONAL TICKETS EXCLUDE ONLINE EXCHANGES"
"ALL PORTIONS INCLUDE ONLY USA AND CANADA"
"NON-PREFERRED HOTELS ONLY INCLUDE CITIES IN THE MARKET FILE"
ON TABLE SET PAGE-NUM OFF
ON LEVEL_DESC RECOMPUTE MULTILINES AS 'TOTAL FOR'
ON TABLE PAGE-BREAK AND SUBFOOT
" "
-INCLUDE SBFOOT

ON TABLE SET STYLE *
TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N2, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONADV' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N5, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONREF' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N8, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONTRA' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N11, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONNON' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N14, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNON150' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N17, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNON200' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N20, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNON250' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.030000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.010000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
    

TYPE=REPORT, FOCEXEC=NONE, FONT=ARIAL, SIZE=8, COLOR=BLACK,
    BACKCOLOR=NONE, GRID=OFF, STYLE=NORMAL, $
    
TYPE=TITLE,
     JUSTIFY=LEFT,
     STYLE=BOLD+UNDERLINE,
     FONT=ARIAL,
     COLOR=RGB(5 76 149),
$     

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.030000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.010000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
    

TYPE=REPORT, FOCEXEC=NONE, FONT=ARIAL, SIZE=8, COLOR=BLACK,
    BACKCOLOR=NONE, GRID=OFF, STYLE=NORMAL, $
    
TYPE=TITLE,
     JUSTIFY=LEFT,
     STYLE=BOLD+UNDERLINE,
     FONT=ARIAL,
     COLOR=RGB(5 76 149),
$     
-IF '&&OUTFMT.EVAL' CONTAINS 'PDF' THEN GOTO SkipStyle;


TYPE=HEADING, SIZE=8, STYLE=BOLD, FONT='ARIAL', COLOR=RGB(31 114 164), BACKCOLOR=NONE, $
TYPE=HEADING, LINE=8, SIZE=9, GRID=OFF, STYLE=BOLD, COLOR=WHITE, BACKCOLOR=RGB(31 114 164),$
TYPE=HEADING, LINE=9, SIZE=9, GRID=OFF, STYLE=BOLD, BACKCOLOR=NONE,$

-* TYPE=HEADING, LINE=9, SIZE=8, GRID=OFF, STYLE=BOLD, COLOR=RGB(5 76 149), $
TYPE=HEADING, HEADALIGN=BODY,$
-* TYPE=HEADING, LINE=1, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
-* TYPE=HEADING, LINE=1, ITEM=2, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=1, COLSPAN=5, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=2, COLSPAN=5, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=3, COLSPAN=30, SIZE=9, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=4, COLSPAN=30, SIZE=9, JUSTIFY=CENTER, $


-* TYPE=HEADING, LINE=6, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
-* TYPE=HEADING, LINE=6, ITEM=2, COLSPAN=20, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=8, ITEM=1, COLSPAN=1,BACKCOLOR=NONE,$
TYPE=HEADING, LINE=8, ITEM=2, COLSPAN=5,JUSTIFY=CENTER, COLOR=WHITE, BACKCOLOR=RGB(31 114 164), $ 
TYPE=HEADING, LINE=8, ITEM=3, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=4, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=5, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=6, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=7, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=8, COLSPAN=8,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=9, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=10, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=11, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=12, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=13, COLSPAN=1,BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=8, ITEM=14, COLSPAN=2,JUSTIFY=CENTER,$ 
-* 
TYPE=HEADING, LINE=9, ITEM=1, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=2, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=9, ITEM=3, COLSPAN=1,BACKCOLOR=NONE, $ 
TYPE=HEADING, LINE=9, ITEM=4, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=9, ITEM=5, COLSPAN=1,$ 
TYPE=HEADING, LINE=9, ITEM=6, COLSPAN=2,$ 
TYPE=HEADING, LINE=9, ITEM=7, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=8, COLSPAN=2,$
TYPE=HEADING, LINE=9, ITEM=9, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=10, COLSPAN=2, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=9, ITEM=11, COLSPAN=1, BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=9, ITEM=12, COLSPAN=2, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=9, ITEM=13, COLSPAN=1, BACKCOLOR=NONE,$ 
TYPE=HEADING, LINE=9, ITEM=14, COLSPAN=2, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=9, ITEM=15, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=16, COLSPAN=2,JUSTIFY=CENTER, $
TYPE=HEADING, LINE=9, ITEM=17, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=18, COLSPAN=2,JUSTIFY=CENTER, $
TYPE=HEADING, LINE=9, ITEM=19, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=20, COLSPAN=2,JUSTIFY=CENTER, $

TYPE=REPORT, COLUMN=N1, JUSTIFY=LEFT, SQUEEZE=2.0,$
TYPE=REPORT, COLUMN=N2, JUSTIFY=LEFT, WRAP=.5,$
TYPE=REPORT, COLUMN=N3, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N4, JUSTIFY=LEFT, BACKCOLOR=NONE, WRAP=.1, $
TYPE=REPORT, COLUMN=N5, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N6, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N7, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N8, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N9, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N10, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N11, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N12, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N13, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N14, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N15, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N16, JUSTIFY=LEFT, BACKCOLOR=NONE, WRAP=.1, $
TYPE=REPORT, COLUMN=N17, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N18, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N19, JUSTIFY=LEFT, BACKCOLOR=NONE, WRAP=.1, $
TYPE=REPORT, COLUMN=N20, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N21, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N22, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N23, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N24, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N25, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N26, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N27, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N28, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N29, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N30, JUSTIFY=LEFT, WRAP=.5, $



TYPE=TITLE,
     SIZE=8,
     COLOR='WHITE',
     BACKCOLOR=RGB(31 114 164),
     STYLE=BOLD,$

     
TYPE=TABFOOTING, FONT=ARIAL, COLOR=GRAY,$
     
TYPE=FOOTING, FONT=ARIAL, COLOR=GRAY,$

     
TYPE=GRANDTOTAL, STYLE=BOLD, JUSTIFY=LEFT, $     

ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN
-GOTO XXIT

-JOINDONE1
DEFINE FILE MXNONHTL
NOWTOD/A8 WITH NNROOMS = HHMMSS (NOWTOD);
BLANK/A1 = ' ';
BLANK1/A1 = '|';
ROLL/A8='&&ROLLUP.EVAL';
LVL/A60='&&LVL_DSC.EVAL';
RPHONE/A15=EDIT(ROLL_PHONE,'9-999-999-9999');
RD/A10 = 'Run Date:';
RT/A10 = 'Run Time:';  
LEV/A25 = EDIT(LEVEL_DESC, '9999999999999999999999999');
RN/A60=TRIM('B', '&&RPT_TTL1.EVAL', 60, ' ', 1, 'A60');
RN1/A60=TRIM('B', '&&RPT_TTL2.EVAL', 60, ' ', 1, 'A60');
TDATE1/A8MDYY='&MDYY';
TDATE2/A10=EDIT(TDATE1,'99/99/9999');
TIME1/A8=HHMMSS('A8');
TIME2/A8=EDIT(TIME1,'99$:99$:99');
DTDESC/A20='Transaction Dates';
END
-RUN

TABLE FILE MXNONHTL
HEADING
"<+0> Client:<ROLL_NAME"
"<+0> Contact:<ROLL_CONTACT"
"<+0> Phone:<RPHONE "
"<+0> &&DTDESC <+0> &FMM/&FMD/&FMY - &TOM/&TOD/&TOY"
"<+0> <RN"
"<+0> <RN1"
" "
"<+0> <+0> Advanced Purchase <+0> <+0> Refundable <+0> <+0> Traditional <+0> <+0> Hotels <+0> <+0> Hotel Rates"
"<+0> <+0> 0-6 <+0> <+0> <+0> <+0> <+0> <+0> Non-Preferred <+0> <+0> $150-$199 <+0> <+0> $200-$249 <+0> <+0> $250+"
SUM MXADV_TKT AS '# Of Tkts'
COMPUTE 
MXADVP/D5CS% = IF ((ADV_TKT LT 1) AND (ADV_TKT GT (-1))) THEN 0 ELSE ((MXADV_TKT/ADV_TKT)*100); AS '% Of Tkts'
BLANK AS ' '
MXREF_TKT AS '# Of Tkts'
COMPUTE
MXREFP/D5CS% = IF ((REF_TKT LT 1) AND (REF_TKT GT (-1))) THEN 0 ELSE ((MXREF_TKT/REF_TKT)*100); AS '% Of Tkts'
BLANK AS ' '
MXTRA_TKT AS '# Of Tkts'
COMPUTE
MXTRAP/D5CS% = IF ((TRA_TKT LT 1) AND (TRA_TKT GT (-1))) THEN 0 ELSE ((MXTRA_TKT/TRA_TKT)*100); AS '% Of Tkts'
BLANK AS ' '
NONPREF_RM AS '# Of Nights'
COMPUTE
NONPREFP/D5CS% = IF ((NNROOMS LT 1) AND (NNROOMS GT (-1))) THEN 0 ELSE
              ((NONPREF_RM/NNROOMS)*100); AS '% Of Nights'
BLANK AS ' '              
RATE_RM1 AS '# Of Nights'
COMPUTE 
RATERMP1/D5CS% = IF ((NNROOMS1 LT 1) AND (NNROOMS1 GT (-1))) THEN 0 ELSE
              ((RATE_RM1/NNROOMS1)*100); AS '% Of Nights'
BLANK AS ' '              
RATE_RM2 AS '# Of Nights'
COMPUTE
RATERMP2/D5CS% = IF ((NNROOMS1 LT 1) AND (NNROOMS1 GT (-1))) THEN 0 ELSE
              ((RATE_RM2/NNROOMS1)*100); AS '% Of Nights'
BLANK AS ' '              
RATE_RM3 AS '# Of Nights'
COMPUTE 
RATERMP3/D5CS% = IF ((NNROOMS1 LT 1) AND (NNROOMS1 GT (-1))) THEN 0 ELSE
             ((RATE_RM3/NNROOMS1)*100); AS '% Of Nights'
BY LEVEL_DESC AS ' '
FOOTING
"</2"
"THIS REPORT HAS THE FOLLOWING EXCLUSIONS/INCLUSIONS:"
"ALL PORTIONS EXCLUDE - AMTRAK, SHUTTLE FLIGHTS"
"REFUNDABLE TICKETS INCLUDE ONLINE EXCHANGES"
"0-6 TICKETS EXCLUDE ALL EXCHANGES"
"TRADITIONAL TICKETS EXCLUDE ONLINE EXCHANGES"
"ALL PORTIONS INCLUDE ONLY USA AND CANADA"
"NON-PREFERRED HOTELS ONLY INCLUDE CITIES IN THE MARKET FILE"
ON TABLE SET PAGE-NUM OFF
ON LEVEL_DESC RECOMPUTE MULTILINES AS 'TOTAL FOR'
ON TABLE PAGE-BREAK AND SUBFOOT
" "
-INCLUDE SBFOOT

ON TABLE SET STYLE *
TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N2, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONADV' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N5, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONREF' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N8, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONTRA' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N11, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNONNON' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N14, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNON150' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N17, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNON200' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, COLOR=RGB(0 0 138), JUSTIFY=LEFT, COLUMN=N20, \
URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRNON250' ROW_LABEL=N1 LSEL=LEVEL_DESC\
 SETFNM='&&DTTMSTRM.EVAL' \
 FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=0.030000, RIGHTMARGIN=0.030000,
    TOPMARGIN=0.030000, BOTTOMMARGIN=0.010000, SQUEEZE=ON,
    ORIENTATION=LANDSCAPE, $
    

TYPE=REPORT, FOCEXEC=NONE, FONT=ARIAL, SIZE=8, COLOR=BLACK,
    BACKCOLOR=NONE, GRID=OFF, STYLE=NORMAL, $
    
TYPE=TITLE,
     JUSTIFY=LEFT,
     STYLE=BOLD+UNDERLINE,
     FONT=ARIAL,
     COLOR=RGB(5 76 149),
$     

TYPE=HEADING, SIZE=10, GRID=OFF, STYLE=BOLD, $
TYPE=HEADING, LINE=8, SIZE=9, GRID=OFF, STYLE=BOLD, COLOR=RGB(5 76 149), BACKCOLOR=RGB(192 192 192),$
TYPE=HEADING, LINE=9, SIZE=8, GRID=OFF, STYLE=BOLD, COLOR=RGB(5 76 149), $
TYPE=HEADING, HEADALIGN=BODY,$
TYPE=HEADING, LINE=1, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=1, ITEM=2, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=2, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=2, ITEM=2, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=3, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=3, ITEM=2, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=4, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=4, ITEM=2, COLSPAN=4, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=5, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=5, ITEM=2, COLSPAN=20, JUSTIFY=CENTER, $
TYPE=HEADING, LINE=6, ITEM=1, COLSPAN=1, JUSTIFY=LEFT, $
TYPE=HEADING, LINE=6, ITEM=2, COLSPAN=20, JUSTIFY=CENTER, $

TYPE=HEADING, LINE=8, ITEM=1, COLSPAN=1,BACKCOLOR=NONE,$
TYPE=HEADING, LINE=8, ITEM=2, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=3, COLSPAN=1,BACKCOLOR=NONE,$
TYPE=HEADING, LINE=8, ITEM=4, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=5, COLSPAN=1,BACKCOLOR=NONE,$
TYPE=HEADING, LINE=8, ITEM=6, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=7, COLSPAN=1,BACKCOLOR=NONE,$
TYPE=HEADING, LINE=8, ITEM=8, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=8, ITEM=9, COLSPAN=1,BACKCOLOR=NONE,$
TYPE=HEADING, LINE=8, ITEM=10, COLSPAN=8,JUSTIFY=CENTER,$ 

TYPE=HEADING, LINE=9, ITEM=1, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=2, COLSPAN=2,JUSTIFY=CENTER,$ 
TYPE=HEADING, LINE=9, ITEM=3, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=4, COLSPAN=2,JUSTIFY=CENTER,$
TYPE=HEADING, LINE=9, ITEM=5, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=6, COLSPAN=2,JUSTIFY=CENTER,$
TYPE=HEADING, LINE=9, ITEM=7, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=8, COLSPAN=2,JUSTIFY=CENTER,$
TYPE=HEADING, LINE=9, ITEM=9, COLSPAN=1,$
TYPE=HEADING, LINE=9, ITEM=10, COLSPAN=2,JUSTIFY=CENTER,$
TYPE=HEADING, LINE=9, ITEM=11, COLSPAN=1,BACKCOLOR=RGB(192 192 192),$
TYPE=HEADING, LINE=9, ITEM=12, COLSPAN=2,JUSTIFY=CENTER,$
TYPE=HEADING, LINE=9, ITEM=13, COLSPAN=1,BACKCOLOR=RGB(192 192 192),$
TYPE=HEADING, LINE=9, ITEM=14, COLSPAN=2,JUSTIFY=CENTER,$
TYPE=HEADING, LINE=9, ITEM=15, COLSPAN=1,BACKCOLOR=RGB(192 192 192),$
TYPE=HEADING, LINE=9, ITEM=16, COLSPAN=2,JUSTIFY=CENTER,$




TYPE=REPORT, COLUMN=N1, JUSTIFY=LEFT, SQUEEZE=2,$
TYPE=REPORT, COLUMN=N2, JUSTIFY=LEFT, WRAP=.5,$
TYPE=REPORT, COLUMN=N3, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N4, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N5, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N6, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N7, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N8, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N9, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N10, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N11, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N12, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N13, JUSTIFY=LEFT, WRAP=.1, $
TYPE=REPORT, COLUMN=N14, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N15, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N16, JUSTIFY=LEFT, BACKCOLOR=RGB(192 192 192), WRAP=.1, $
TYPE=REPORT, COLUMN=N17, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N18, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N19, JUSTIFY=LEFT, BACKCOLOR=RGB(192 192 192), WRAP=.1, $
TYPE=REPORT, COLUMN=N20, JUSTIFY=LEFT, WRAP=.5, $
TYPE=REPORT, COLUMN=N21, JUSTIFY=LEFT, WRAP=.5, $


-* 


TYPE=GRANDTOTAL, SIZE=8, JUSTIFY=LEFT, STYLE=BOLD, $
     
TYPE=FOOTING, FONT=ARIAL, SIZE=7, STYLE=BOLD,$
TYPE=REPORT, IMAGE=TSMHEAD.jpg, POSITION=(0 0), $
TYPE=REPORT, IMAGE=FOOTER.jpg, POSITION=(0 8.2), $ 
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN




-XXIT










