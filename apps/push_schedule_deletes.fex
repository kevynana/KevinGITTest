-* File push_schedule_deletes.fex
-*
-* 03/22/2017   S-32171 REJ   Updated the descriptions for ER5 schedules.
-*
-*-SET &ECHO=OFF;
 
SET LINES=99999
SET BASEURL='&&SRVR.EVAL'
 
-INCLUDE CLASSPATH
-SET &&WPATH1=TEMPPATH(50,'A50');
-SET &&JPATH=STRREP(50,'&&WPATH1.EVAL',1,'\',2,'\\',150,'A150');
 
DEFINE FILE BOTSCHED
TDAY/YYMD='&YYMD';
LWEEK/YYMD=TDAY - 14;
LWEEK_ALPHA/A8YYMD=LWEEK;
SID/A12=SCHEDULEID;
END
TABLE FILE BOTSCHED
PRINT SID JOBDESC MAILSUBJECT CASTER_USER STARTDATE LWEEK_ALPHA
BY SCHEDULEID NOPRINT
WHERE ((MAILSUBJECT CONTAINS 'eTTek Review Scheduled Reports for' OR
       MAILSUBJECT CONTAINS 'eTTek Review Push Reports for ' OR
       MAILSUBJECT CONTAINS 'eTTek Review Push My Dashboards for ' OR
        MAILSUBJECT CONTAINS 'eTTek Dashboard Push Reports for ' OR
      MAILSUBJECT CONTAINS 'eTTek Review Burst Push Reports for ' OR
	  MAILSUBJECT CONTAINS 'Your eTTek Review Reports for' OR
       JOBDESC CONTAINS 'eTTek Push by ' OR
       JOBDESC CONTAINS 'eTTek Schedule by ' OR
	   JOBDESC CONTAINS 'My Dashboard Push ' OR
       MAILSUBJECT CONTAINS 'eTTek Review Databases Load on server' AND
	   MAILSUBJECT CONTAINS 'Post-trip Scheduled Reports')) OR
-*	   AND
-*      (CASTER_USER EQ 'admin')) OR
   JOBDESC CONTAINS 'wrunindv by'
WHERE STARTDATE LT LWEEK_ALPHA
ON TABLE SET HOLDLIST PRINTONLY
ON TABLE HOLD AS HRC0001
END
-RUN
 
DEFINE FILE HRC0001
TDAY/MDYY='&MDYY';
END
TABLE FILE HRC0001
" "
"eTTek Review"
"ReportCaster Schedules Being Deleted"
"for <TDAY"
PRINT SID AS 'Schedule,ID'
      JOBDESC AS 'Job Description'
   MAILSUBJECT AS 'Mail Subject'
   CASTER_USER AS 'Owner'
   STARTDATE AS 'Scheduled,Date'
BY SID NOPRINT
ON TABLE SET PAGE-NUM OFF
ON TABLE NOTOTAL
ON TABLE PCHOLD FORMAT HTML
ON TABLE SET HTMLCSS ON
ON TABLE SET STYLE *
     UNITS=IN,
     PAGESIZE='Letter',
     LEFTMARGIN=0.250000,
     RIGHTMARGIN=0.250000,
     TOPMARGIN=0.250000,
     BOTTOMMARGIN=0.250000,
     SQUEEZE=ON,
     ORIENTATION=PORTRAIT,
$
TYPE=REPORT,
     FONT='ARIAL',
     SIZE=10,
     COLOR='BLACK',
     BACKCOLOR='NONE',
     STYLE=NORMAL,
$
TYPE=DATA,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=8,
     BACKCOLOR=( RGB(242 242 242) 'WHITE' ),
$
TYPE=TITLE,
     COLUMN=N9,
     JUSTIFY=CENTER,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
$
TYPE=TITLE,
     COLUMN=N7,
     JUSTIFY=CENTER,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
$
TYPE=TITLE,
     BORDER-TOP=LIGHT,
     BORDER-BOTTOM=LIGHT,
     BORDER-LEFT=LIGHT,
     BORDER-RIGHT=LIGHT,
     BORDER-TOP-STYLE=RIDGE,
     BORDER-BOTTOM-STYLE=RIDGE,
     BORDER-LEFT-STYLE=RIDGE,
     BORDER-RIGHT-STYLE=RIDGE,
     BORDER-TOP-COLOR='SILVER',
     BORDER-BOTTOM-COLOR='SILVER',
     BORDER-LEFT-COLOR='SILVER',
     BORDER-RIGHT-COLOR='SILVER',
     SIZE=9,
     COLOR='WHITE',
     BACKCOLOR=RGB(154 175 212),
     STYLE=BOLD,
$
TYPE=HEADING,
     SIZE=12,
     COLOR=RGB(36 43 114),
     STYLE=BOLD,
     JUSTIFY=CENTER,
$
TYPE=FOOTING,
     STYLE=BOLD,
$
TYPE=SUBHEAD,
     SIZE=9,
     STYLE=BOLD,
$
TYPE=REPORT,
     IMAGE=/image/TNTLogo.gif,
     POSITION=(0.027778 0.027778),
     SIZE=(1.902778 0.652778),
$
TYPE=REPORT,
     COLUMN=N13,
     WRAP=8.000000,
$
ENDSTYLE
END
-RUN
 
TABLE FILE HRC0001
BY SID
ON TABLE SAVE AS RCPARMS
END
-RUN
 
-SET &IFILE='&&JPATH.EVAL' || 'rcparms.ftm';
-RUN
 
-DOS java -cp "&CP.EVAL" com.tandt.rcaster.schedule.SchedDelete "&IFILE.EVAL"
-RUN
