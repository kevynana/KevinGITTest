-*****************THIS HEADER REPRESENTS THE 80 CHARACTER MAXIUM FOR PROGRAMS**

-* File MIDSIZE.FEX
-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*7/31/00    IBISTL-KR          ADDED DEFINE OF NOWTOD AND
-*                              REPLACED &FOCSYSTOD WITH HHMMSS SUBROUTINE
-*10/16/00   IBISTL-KR          ADDED CODE TO PASS DRILL PARAMS
-*10/17/00    IBISTL-SB         REPLACED &BITMP3 STATEMENT WITHOUT OUTPUT
-*                              DESTINATION FIELD CONCATENATION
-*10/17/00    IBISTL-SB         CHANGED THE FORMAT OF ON GRAPH STATEMENT
-*                              TO GIF FORMAT
-*10/17/00    IBISTL-SB         CHANGED THE DOS STATE STATEMENT WITH 
-*                              &&WEB_PATH FIELD TO LOCATE THE GIF FILE
-*10/17/00    IBISTL-SB         REPLACED THE IMAGE FIELD IN THE STYLE 
-*                              REPORT WITH THE &&WEB_PATH1 LOCATION
-*10/17/00    IBISTL-SB         ADDED WITH STATEMENT TO NOWTOD DEFINE
-* 3/16/01    TANDT-SS          CHANGED PAGE NUMBER FROM 16 TO 14
-* 1/29/02    TANDT-JK          CHANGED TO SORT BY CAR_CAT INSTEAD OF
-*                              DEFINED MIDSIZE FIELD.  PER PATTI SHE
-*                              ONLY WANTS MIDSIZE AND SMALLER GRAPHED.
-*4/26/02     TANDT-DB          CHANGED NUMBER OF BOOKINGS TO NUMBER OF CARS
-*07/03/02   STEVE              CHANGED TO eTTek Review and Copyright
-*08/26/02   STEVE              CHANGED % TO 2 DECIMAL PLACES
-*************************************************************************
-TYPE MIDSIZE

-SET &BITMP3 = 'MIDSIZE.SVG';
-RUN

-SET &&RPTSUF = 'MIDSIZE';
-INCLUDE FDEFRPTS
-RUN

DEFINE FILE &&EXTRACT
MIDSIZE/A19 = IF CAR_CAT EQ 'ECONOMY' OR 'INTERMEDIATE' OR 'COMPACT'
                THEN 'MIDSIZE AND SMALLER' ELSE 'OTHER';
CYBOOKING/D12S = IF (NUM_DAYS LT 0) AND (NUM_CARS LT 0) AND
                    INVOICE_DATE GE &&CYFMDT.EVAL AND 
                    INVOICE_DATE LE &&CYTODT.EVAL 
                    THEN ((NUM_DAYS*NUM_CARS) * (-1)) ELSE
                 IF INVOICE_DATE GE &&CYFMDT.EVAL AND
                    INVOICE_DATE LE &&CYTODT.EVAL
                    THEN NUM_DAYS*NUM_CARS ELSE 0;
PYBOOKING/D12S = IF (NUM_DAYS LT 0) AND (NUM_CARS LT 0) AND
                    INVOICE_DATE GE &&PYFMDT.EVAL AND 
                    INVOICE_DATE LE &&PYTODT.EVAL THEN
                    ((NUM_DAYS*NUM_CARS) * (-1)) ELSE 
                 IF INVOICE_DATE GE &&PYFMDT.EVAL AND
                    INVOICE_DATE LE &&PYTODT.EVAL THEN
                    NUM_DAYS*NUM_CARS ELSE 0;



CMBOOKING/D12S = IF (NUM_DAYS LT 0) AND (NUM_CARS LT 0) AND
                    INVOICE_DATE GE &&CMFMDT.EVAL AND 
                    INVOICE_DATE LE &&CMTODT.EVAL THEN
                    ((NUM_DAYS*NUM_CARS)*(-1)) ELSE
                 IF INVOICE_DATE GE &&CMFMDT.EVAL AND
                    INVOICE_DATE LE &&CMTODT.EVAL THEN
                    NUM_DAYS*NUM_CARS ELSE 0;
PMBOOKING/D12S = IF (NUM_DAYS LT 0) AND (NUM_CARS LT 0) AND
                    INVOICE_DATE GE &&PMFMDT.EVAL AND 
                    INVOICE_DATE LE &&PMTODT.EVAL THEN
                    ((NUM_DAYS*NUM_CARS)*(-1)) ELSE 
                 IF (NUM_DAYS LT 0) AND (NUM_CARS LT 0) AND
                    INVOICE_DATE GE &&PMFMDT.EVAL AND
                    INVOICE_DATE LE &&PMTODT.EVAL THEN 
                    NUM_DAYS*NUM_CARS ELSE 0;
PMMID/D12S = IF MIDSIZE NE 'OTHER' THEN PMBOOKING ELSE 0;
INV_MONTH/MT=INVOICE_DATE;
BITMAP/A12 WITH NUM_CARS='MIDSIZE.SVG';
END
-RUN

TABLE FILE &&EXTRACT
SUM CMBOOKING PMBOOKING
    CYBOOKING PYBOOKING
    BITMAP
BY CAR_CAT
&&WHERE1
&&WHERE2
&&WHERE3

WHERE ((INVOICE_DATE GE &&CMFMDT.EVAL AND INVOICE_DATE LE &&CMTODT.EVAL) 
   OR (INVOICE_DATE GE &&PMFMDT.EVAL AND INVOICE_DATE LE &&PMTODT.EVAL)
   OR (INVOICE_DATE GE &&CYFMDT.EVAL AND INVOICE_DATE LE &&CYTODT.EVAL) 
   OR (INVOICE_DATE GE &&PYFMDT.EVAL AND INVOICE_DATE LE &&PYTODT.EVAL))
ON TABLE HOLD AS CARHLD1
END
-RUN

TABLE FILE &&EXTRACT
PRINT CYBOOKING PYBOOKING 
BY INV_MONTH
&&WHERE1
&&WHERE2
&&WHERE3

WHERE ((INVOICE_DATE GE &&CYFMDT.EVAL AND INVOICE_DATE LE &&CYTODT.EVAL) 
   OR (INVOICE_DATE GE &&PYFMDT.EVAL AND INVOICE_DATE LE &&PYTODT.EVAL))
WHERE MIDSIZE EQ 'MIDSIZE AND SMALLER'
ON TABLE HOLD AS MIDSIZE
END
-RUN

-TYPE NUMBER OF RECORDS &RECORDS
-IF &RECORDS EQ 0 GOTO SKIP_GRAPH;


GRAPH FILE &&EXTRACT
SUM CYBOOKING AS 'CURRENT' PYBOOKING AS 'PRIOR' 
ACROSS INV_MONTH AS ' '
&&WHERE1
&&WHERE2
&&WHERE3

WHERE ((INVOICE_DATE GE &&CYFMDT.EVAL AND INVOICE_DATE LE &&CYTODT.EVAL) 
   OR (INVOICE_DATE GE &&PYFMDT.EVAL AND INVOICE_DATE LE &&PYTODT.EVAL))
WHERE MIDSIZE EQ 'MIDSIZE AND SMALLER'

-INCLUDE RPTPARMS

ON GRAPH SAVE AS MIDSIZE FORMAT SVG
ON GRAPH SET GRAPHSTYLE *
setGraphType(24);
setLegendDisplay(true);
setLegendPosition(2);
setFontSizeAbsolute(getLegendText(),true);
setAutofit(getLegendText(),false);
setFontSize(getLegendText(),12);
setFontStyle(getLegendText(),0);
setLegendMarkerPosition(1);
setO1LabelDisplay(true);
setFontSizeAbsolute(getO1Label(),true); 
setAutofit(getO1Label(),false);
setFontStyle(getO1Label(),0);
setFontSize(getO1Label(),15);
setO1LabelRotate(0);
setO1MajorGridDisplay(false);
setO1MinorGridDisplay(true);
setFontSizeAbsolute(getY1Label(),true);
setAutofit(getY1Label(),false);
setY1LabelDisplay(true);
setY1LabelFormat(1);
setFontSize(getY1Label(),15);
setFontStyle(getY1Label(),0);
setY1AxisSide(0);
setTextJustHoriz(getTitle(), 1);
setTitleString("Midsize and Smaller Bookings by Number of Days");
setFontSizeAbsolute(getTitle(),true);
setAutofit(getTitle(),false);
setFontSize(getTitle(),15);
setFontStyle(getTitle(),0);
setSubtitleString(" ");
setSeriesFillColor(0, new Color, 0 64 128));
setSeriesFillColor(1, new Color, 115 160 247));
ENDSTYLE 
END
-RUN

-SKIP_GRAPH
-RUN

-IF &LINES GT 0 GOTO THIS;
-IF &LINES EQ 0 GOTO THAT;
-THIS
-SET &THERE = 'THERE';
-RUN
-GOTO WHERE
-THAT
-SET &THERE = 'NOT THERE';
-RUN
-WHERE
-INCLUDE DTRANGE
-RUN



-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*7/31/00    IBISTL-KR          ADDED DEFINE OF NOWTOD 
-*************************************************************************
DEFINE FILE CARHLD1
NOWTOD/A8 WITH CYBOOKING = HHMMSS (NOWTOD);
END
-RUN

TABLE FILE CARHLD1
ON TABLE SET PAGE-NUM OFF
SUM PCT.CMBOOKING/P12.2 AS 'Current,Period 1 %'
    PCT.PMBOOKING/P12.2 AS ' Prior,Period 1 %'
    PCT.CYBOOKING/P12.2 AS 'Current,Period 2 %'
    PCT.PYBOOKING/P12.2 AS 'Prior,Period 2 %'
      BITMAP NOPRINT
BY CAR_CAT AS ''

&&OUTLINE1
&&OUTLINE2
HEADING 
"</5"
"<29 % OF CAR TYPES BOOKED"
"<12 &&LVL_DSC </1"
"<26 Current Period 1: <38 &CMFMM/&CMFMD/&CMFMY - &CMTOM/&CMTOD/&CMTOY"
"<26   Prior Period 1: <38 &PMFMM/&PMFMD/&PMFMY - &PMTOM/&PMTOD/&PMTOY"
"<26 Current Period 2: <38 &CYFMM/&CYFMD/&CYFMY - &CYTOM/&CYTOD/&CYTOY"
"<26   Prior Period 2: <38 &PYFMM/&PYFMD/&PYFMY - &PYTOM/&PYTOD/&PYTOY"
"</3"
-*************************************************************************
-*DATE         NAME             DESCRIPTION
-*7/31/00    IBISTL-KR          REPLACED &FOCSYSTOD WITH NOWTOD
-*************************************************************************
FOOTING BOTTOM
"&&FOOTER"
"MIDSIZE AND SMALLER CONSISTS OF ECONOMY, INTERMEDIATE, AND COMPACT"
"MIDSIZE
<36 PAGE 14 <50 A REPORT FROM eTTek Review RUN ON &DATE AT <NOWTOD"
ON TABLE SET STYLE *

-***********************IBISTL DRILLDOWN**********************
TYPE=DATA, STYLE=-UNDERLINE, COLUMN=N2, \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRMIDSIZ' CPFLAG='C1' CATGRY=CAR_CAT \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLUMN=N3, \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRMIDSIZ' CPFLAG='P1' CATGRY=CAR_CAT \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLUMN=N4, \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRMIDSIZ' CPFLAG='C2' CATGRY=CAR_CAT \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

TYPE=DATA, STYLE=-UNDERLINE, COLUMN=N5, \
 URL=&&SRVR.EVAL/ibi_apps/WFServlet? \
(IBIF_ex='DRMIDSIZ' CPFLAG='P2' CATGRY=CAR_CAT \
SETFNM='&&DTTMSTRM.EVAL' \
FPARM='&&DTTMID.EVAL' \
ROLUP='&&ROLLUP' user='&&UNAME'), $

-***********************IBISTL DRILLDOWN**********************


UNITS=IN, PAGESIZE='Letter', LEFTMARGIN=.60000, RIGHTMARGIN=0.250000, 
    TOPMARGIN=0.50000, BOTTOMMARGIN=0.250000, SQUEEZE=ON, 
    ORIENTATION=LANDSCAPE, $
TYPE=REPORT, FOCEXEC=NONE, FONT=TIMES NEW ROMAN, SIZE=9, COLOR=BLACK, 
    BACKCOLOR=NONE, STYLE=NORMAL, $
-IF &THERE EQ 'NOT THERE' GOTO SKIP_IT;
TYPE=REPORT,
 IMAGE=MIDSIZE.SVG ,
    POSITION=(+1.2 +4.0), SIZE=(6.5 3.2), $
-SKIP_IT
TYPE=TITLE, SIZE=10, STYLE=BOLD, $
TYPE=HEADING, LINE=7, SIZE=13, FONT=COURIER NEW,
    STYLE=BOLD+ITALIC, $
TYPE=HEADING, LINE=8, SIZE=13, FONT=COURIER NEW,
    STYLE=BOLD+ITALIC, $
TYPE=HEADING, LINE=10, FONT=COURIER NEW, STYLE=BOLD+ITALIC, $
TYPE=HEADING, LINE=11, FONT=COURIER NEW, STYLE=BOLD+ITALIC, $
TYPE=HEADING, LINE=12, FONT=COURIER NEW, STYLE=BOLD+ITALIC, $
TYPE=HEADING, LINE=13, FONT=COURIER NEW, STYLE=BOLD+ITALIC, $
TYPE=HEADING, LINE=21, STYLE=BOLD+UNDERLINE, $ 
TYPE=SUBTOTAL, STYLE=BOLD, $
TYPE=FOOTING, SIZE=6, $
TYPE=REPORT, COLUMN=N2, POSITION=+1.000, $
TYPE=REPORT, COLUMN=N3, POSITION=+1.000, $
TYPE=REPORT, COLUMN=N4, POSITION=+1.000, $
TYPE=REPORT, COLUMN=N5, POSITION=+1.000, $
TYPE=REPORT, IMAGE=&&TNTPIC,  POSITION=(&&TNTSMPOS), SIZE=(&&TNTSMSIZ), $
TYPE=REPORT, IMAGE=&&ROLLPIC, POSITION=(&&ROLSMPOS), SIZE=(&&ROLSMSIZ), $
ENDSTYLE

END
-*-EXIT

