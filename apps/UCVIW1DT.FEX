-*4/18/14 - DEB - ADDED PICK_DAY CC_NUM AND ROUTINE FOR TYCARDTL
-*4/23/14 - DEB - CARRIED THROUGH TRIP PURPOSE
-*7/10/14 - DEB - CORRECTED GLOBAL VARIABLE SHOWING &&&&
-*  02/02/2015  REJ  S-05681 Changes to the no data report to prepare for the Available
-*                           Report changes.  Rollup Code is being removed from BRPTINST in
-*                           ER5, so I'm removing the reference to the ROLLUP_CODE in that report.
-*2/19/15 - DEB - S-07532 CREATED ROUTINE FOR AMNUCDTL  
-* 4/9/15 - S-08224 -ADDED ROUTINE FOR CURTCDTL
-*2/29/16-JEM-S-15235 CREATED ROUTINE FOR ACCARTPO
-*7/11/16 S-20630 -DLV Carried through EMP_ID
-*8/9/17 DLV-S-33541- added routine for ABUDCAR
-* 10/25/17     JEM         S-39364 Carrying thru new field TRAVELER_EMAIL

-INCLUDE SETECHO  

-IF '&&SETF.EVAL' EQ ABUDCAR THEN GOTO SKIPthis;
-INCLUDE RETUDID 
-RUN

-SKIPthis; 
      
SET ASNAMES=ON
-RUN

TABLE FILE &&RPT_HOLD
PRINT ALPHA_PIK_DT
  ALPHA_RATE
  AROLL_LEV5
  AROLL_LEV6
  BR_CL_IDX
  BOOKINGS
  CAR_DSC
  CAR_TYPE 
  CCR_CONFIRM
  CC_NUM
  DAILY_RATE
  DOD_TYPE
  DROP_CTY_NAME
  DROP_DATE
  DROP_DAY
  DROP_OFF_DT
  EMP_ID
  FOP2
  INV_DATE
  INVOICE_DATE	
  INVOICE_NUM 	
  LEVEL_DESC
  LEVEL1
  LEVEL2
  LEVEL3
  LEVEL4
  LEVEL5
  LEVEL6
  NBR_CARS
  NBR_DAYS
  NEW_RENTAL_AMT
  PASSNGR_NAME
  PICK_CTY_NAME
  PICK_DAY
  PICKUP_CITY
  PICKUP_DATE
  PICK_UP_DT	
  PNR_LOCATOR 
  REFUSAL_DESC	
  REFUSE_CODE	
  RENTAL_AMT
  RENTAL_DAYS	
  RESV_STAT
  TRAVELER_EMAIL
  TRIP_PURPOSE
  VENDOR_NAME
  VENDOR_CODE
BY CAR_KEY
-INCLUDE CARRATE
ON TABLE HOLD AS CARHOLD3
END
-RUN

 


-IF &RECORDS EQ 0 THEN GOTO NORECORDS;

-IF '&&SETF.EVAL' EQ 'ABUCDTL' THEN GOTO ABUCDTL;
-IF '&&SETF.EVAL' EQ 'KWUCDTL' THEN GOTO EXKIEW;
-IF '&&SETF.EVAL' EQ 'UNVCDTL' THEN GOTO EXUNVM;
-IF '&&SETF.EVAL' EQ 'BZCLODTL' OR 'BZCLSDTL' OR 'UPCLSDTL' THEN GOTO BOOZ;
-IF '&&SETF.EVAL' EQ 'UPCARFIL' THEN GOTO UPTTL;
-IF '&&SETF.EVAL' EQ 'GRCGL' GOTO EXGROW;
-IF '&&SETF.EVAL' EQ 'TYCARDTL' THEN GOTO TYSON;
-IF '&&SETF.EVAL' EQ 'AMNUCDTL' THEN GOTO AMN;
-IF '&&SETF.EVAL' EQ 'CURTCDTL' THEN GOTO CURT;
-IF '&&SETF.EVAL' EQ 'ACCARTPO' THEN GOTO ACTU;
-IF '&&SETF.EVAL' EQ 'ABUDCAR' THEN GOTO UDCAR;
-ABUCDTL

EX UDUSGC
-RUN

-IF '&&NORECPRN.EVAL' EQ 'Y' THEN GOTO NORECORDS;

-GOTO ENDIT;


-EXKIEW
 
EX UDKIEWC
-RUN



-IF '&&NORECLSTSV.EVAL' EQ 'Y' THEN GOTO NORECORDS;

-GOTO ENDIT;

-EXUNVM

EX UDUNVMC
-RUN


-GOTO ENDIT;
 

-BOOZ

EX UDCBOOZ
-RUN

-IF '&&NORECBZ.EVAL' EQ 'Y' THEN GOTO NORECORDS;

-GOTO ENDIT;

-UPTTL

EX UDUPCFIL
-RUN

-GOTO ENDIT;

-EXGROW
EX UDCGROW
-RUN

-IF '&&NORECGR.EVAL' EQ 'Y' THEN GOTO NORECORDS;


-GOTO ENDIT;

-TYSON
EX UDCTYSON
-RUN

-GOTO ENDIT;


-AMN

EX UDCAMN
-RUN


-IF 'NORECAMN.EVAL' EQ 'Y' THEN GOTO NORECORDS;

-GOTO ENDIT;

-ACTU;
EX UDCACTUTPO
-RUN

-IF 'NORECACUTPO.EVAL' EQ 'Y' THEN GOTO NORECORDS;


-GOTO ENDIT;

-CURT

EX UDCCURT
-RUN
 


-IF '&&NORECCURT.EVAL' EQ 'Y' THEN GOTO NORECORDS;

-GOTO ENDIT;

-UDCAR

EX UDCARDT
-RUN

-IF '&&NORECUD.EVAL' EQ 'Y' THEN GOTO NORECORDS;

-SET &&PRINT3='NEWFLD AS ''&&UTITL.EVAL''';


-ENDIT;



 

-IF &&DRILLED_RUN EQ 'N' GOTO SKIP_DRIL;
-* 
-SET &&DRILLRPT = CARHOLD4;

-INCLUDE DRILWHRS

-SKIP_DRIL

DEFINE FILE CARHOLD4 ADD
NOWTOD/A8 WITH LEVEL_DESC = HHMMSS (NOWTOD);
-IF '&&SETF.EVAL' NE 'KWUCDTL' THEN GOTO NotThis;
-INCLUDE GNDEFINEC
-NotThis
-IF '&&SETF.EVAL' NE 'UPCARFIL' THEN GOTO NotThis2;

LOST_FLAG/A1 = IF LOWC_AMT EQ 0 THEN 'N' ELSE
               IF LOWC_AMT NE DAILY_RATE THEN 'Y' ELSE 'N';

-*LOW_VNAME/A12 = IF LOST_FLAG EQ 'Y' THEN LOWVC_NM ELSE '            ' ; 
 
LOW_VNAME/A12 = IF LOWC_AMT EQ 0 THEN '            ' ELSE
                IF LOWC_AMT NE DAILY_RATE THEN LOWVC_NM ELSE '            ' ; 

-NotThis2;
END
 
-SET &&PAHDR = IF '&&OUTFMT.EVAL' EQ 'PDF' OR 'PPT' OR 'COM' THEN 'HEADAIR' ELSE 'HDREXLS'; 
-SET &&PAHDR1 = IF '&&SETF.EVAL' EQ 'GRCGL' THEN 'GRHDR' ELSE &&PAHDR;
-SET &&PASTYD = IF '&&OUTFMT.EVAL' NE 'PDF' OR 'PPT' OR 'COM' THEN 'DTEXL' ELSE &&DTSTY;
-RUN

TABLE FILE CARHOLD4

-INCLUDE &&PAHDR1
"&&SUBHEAD"
-IF &&PAHDR EQ 'HDREXLS' GOTO NOSPC;
"</2"
-NOSPC;
-*

-**********************************************************************
-* Print statement with fields passed from the user profile database
-**********************************************************************
-*
&&PRINT1
&&PRINT2
&&PRINT3
&&PRINT4
&&PRINT5
&&PRINT6
&&PRINT7
&&PRINT8
&&PRINT9
&&PRINT10
-IF '&&SETF.EVAL' EQ 'GRCGL' GOTO NOAVG;
-* ADDED ON 02/06/2003
  COMPUTE AVGDR/D12.2CS=IF (RENTAL_AMT LT 0) AND (NBR_DAYS LT 0)
    THEN ((RENTAL_AMT/NBR_DAYS) * (-1)) ELSE  IF ((RENTAL_AMT LT 1) AND
    (RENTAL_AMT GT (-1))) THEN 0 ELSE 
    (RENTAL_AMT/NBR_DAYS); NOPRINT
  
-**********************************************************************
-* By statements (one per field)
-**********************************************************************
-*
-NOAVG;
&&BY1
&&BY2
&&BY3
&&BY4
&&BY5
&&BY6
&&BY7
&&BY8
&&BY9
&&BY10
-*
-*********************************************************************
-*DATE           NAME               DESCRIPTION 
-*8/18/00      IBISTL-KR            INCLUDE WHERE STATEMENTS WHEN
-*                                  DRILLED_RUN EQ 'Y'.
-*********************************************************************
-*
-**********************************************************************
-* Where statements for Drilled Report
-**********************************************************************


-*
-IF &&DRILLED_RUN EQ 'N' GOTO SKIP_WHR;
-INCLUDE &&DRILLWHR
-SKIP_WHR
-*
-**********************************************************************
-* On Table statements for code appropriate to On Table commands
-**********************************************************************
-*
&&ONTABLE1
&&ONTABLE2
&&ONTABLE3
&&ONTABLE4
&&ONTABLE5
&&ONTABLE6
&&ONTABLE7
&&ONTABLE8
&&ONTABLE9
&&ONTABLE10


-IF '&&SETF.EVAL' NE 'UPCARFIL' THEN GOTO FOOTER;

ON TABLE SET BYDISPLAY ON


-FOOTER

-*
-**********************************************************************
-* Report specific footer(s)
-**********************************************************************
-*
-INCLUDE FOOTERDT
-*
-*ON TABLE SET STYLE &&DTSTY
-**************************************************************************
-*DATE           NAME               DESCRIPTION OF CHANGE
-*----           ----               ---------------------
-*8/11/00      IBISTL-SB            CHANGED THE SET STYLE STATEMENT 
-*                                  WITH AN INCLUDE
-**************************************************************************
ON TABLE PAGE-BREAK AND SUBFOOT
-INCLUDE SBFOOT

ON TABLE SET STYLE *

-INCLUDE &&PASTYD
ENDSTYLE

-*
&&OUTLINE1 
&&OUTPUTDEST
&&OUTLINE2
END 
-RUN
-GOTO XXIT

-NORECORDS
-SET &&RPTSUF = 'MSG';
-INCLUDE FDEFRPTS
-RUN
JOIN SET_KEY IN BRPTINST TO SET_KEY IN BRPT_SET AS J1
DEFINE FILE BRPTINST
EMPTY/A35 = 'NO RECORDS FOUND FOR THIS SELECTION';
NOWTOD/A8 WITH INST_KEY = HHMMSS (NOWTOD);
END
TABLE FILE BRPTINST
-INCLUDE HEADAIR
PRINT EMPTY AS 'REPORT,MESSAGE' 
BY ROLLUP_CODE AS 'ROLLUP,CODE'
BY RPT_NAME AS 'REPORT,NAME'
BY SELECT_LEV AS 'BREAK,LEVEL'
IF INST_KEY EQ &&IKEY
IF RECORDLIMIT EQ 1
-INCLUDE FOOTERDT
ON TABLE SUBFOOT
-INCLUDE SBFOOT
ON TABLE SET PAGE-NUM OFF
ON TABLE SET STYLE *
-INCLUDE &&DTSTY
ENDSTYLE
&&OUTLINE1
&&OUTPUTDEST
&&OUTLINE2
END
-RUN

-XXIT

